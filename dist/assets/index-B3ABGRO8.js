(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function ES(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Kd={exports:{}},ja={},zd={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ag;function wS(){if(ag)return Ue;ag=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function g(N){return N===null||typeof N!="object"?null:(N=p&&N[p]||N["@@iterator"],typeof N=="function"?N:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,E={};function w(N,U,re){this.props=N,this.context=U,this.refs=E,this.updater=re||x}w.prototype.isReactComponent={},w.prototype.setState=function(N,U){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,U,"setState")},w.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function S(){}S.prototype=w.prototype;function T(N,U,re){this.props=N,this.context=U,this.refs=E,this.updater=re||x}var k=T.prototype=new S;k.constructor=T,y(k,w.prototype),k.isPureReactComponent=!0;var I=Array.isArray,L=Object.prototype.hasOwnProperty,O={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function j(N,U,re){var de,ue={},he=null,pe=null;if(U!=null)for(de in U.ref!==void 0&&(pe=U.ref),U.key!==void 0&&(he=""+U.key),U)L.call(U,de)&&!P.hasOwnProperty(de)&&(ue[de]=U[de]);var ge=arguments.length-2;if(ge===1)ue.children=re;else if(1<ge){for(var Ne=Array(ge),Ge=0;Ge<ge;Ge++)Ne[Ge]=arguments[Ge+2];ue.children=Ne}if(N&&N.defaultProps)for(de in ge=N.defaultProps,ge)ue[de]===void 0&&(ue[de]=ge[de]);return{$$typeof:n,type:N,key:he,ref:pe,props:ue,_owner:O.current}}function F(N,U){return{$$typeof:n,type:N.type,key:U,ref:N.ref,props:N.props,_owner:N._owner}}function D(N){return typeof N=="object"&&N!==null&&N.$$typeof===n}function $(N){var U={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(re){return U[re]})}var J=/\/+/g;function ne(N,U){return typeof N=="object"&&N!==null&&N.key!=null?$(""+N.key):U.toString(36)}function se(N,U,re,de,ue){var he=typeof N;(he==="undefined"||he==="boolean")&&(N=null);var pe=!1;if(N===null)pe=!0;else switch(he){case"string":case"number":pe=!0;break;case"object":switch(N.$$typeof){case n:case e:pe=!0}}if(pe)return pe=N,ue=ue(pe),N=de===""?"."+ne(pe,0):de,I(ue)?(re="",N!=null&&(re=N.replace(J,"$&/")+"/"),se(ue,U,re,"",function(Ge){return Ge})):ue!=null&&(D(ue)&&(ue=F(ue,re+(!ue.key||pe&&pe.key===ue.key?"":(""+ue.key).replace(J,"$&/")+"/")+N)),U.push(ue)),1;if(pe=0,de=de===""?".":de+":",I(N))for(var ge=0;ge<N.length;ge++){he=N[ge];var Ne=de+ne(he,ge);pe+=se(he,U,re,Ne,ue)}else if(Ne=g(N),typeof Ne=="function")for(N=Ne.call(N),ge=0;!(he=N.next()).done;)he=he.value,Ne=de+ne(he,ge++),pe+=se(he,U,re,Ne,ue);else if(he==="object")throw U=String(N),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return pe}function X(N,U,re){if(N==null)return N;var de=[],ue=0;return se(N,de,"","",function(he){return U.call(re,he,ue++)}),de}function Z(N){if(N._status===-1){var U=N._result;U=U(),U.then(function(re){(N._status===0||N._status===-1)&&(N._status=1,N._result=re)},function(re){(N._status===0||N._status===-1)&&(N._status=2,N._result=re)}),N._status===-1&&(N._status=0,N._result=U)}if(N._status===1)return N._result.default;throw N._result}var ie={current:null},G={transition:null},Q={ReactCurrentDispatcher:ie,ReactCurrentBatchConfig:G,ReactCurrentOwner:O};function W(){throw Error("act(...) is not supported in production builds of React.")}return Ue.Children={map:X,forEach:function(N,U,re){X(N,function(){U.apply(this,arguments)},re)},count:function(N){var U=0;return X(N,function(){U++}),U},toArray:function(N){return X(N,function(U){return U})||[]},only:function(N){if(!D(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Ue.Component=w,Ue.Fragment=t,Ue.Profiler=s,Ue.PureComponent=T,Ue.StrictMode=r,Ue.Suspense=d,Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,Ue.act=W,Ue.cloneElement=function(N,U,re){if(N==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+N+".");var de=y({},N.props),ue=N.key,he=N.ref,pe=N._owner;if(U!=null){if(U.ref!==void 0&&(he=U.ref,pe=O.current),U.key!==void 0&&(ue=""+U.key),N.type&&N.type.defaultProps)var ge=N.type.defaultProps;for(Ne in U)L.call(U,Ne)&&!P.hasOwnProperty(Ne)&&(de[Ne]=U[Ne]===void 0&&ge!==void 0?ge[Ne]:U[Ne])}var Ne=arguments.length-2;if(Ne===1)de.children=re;else if(1<Ne){ge=Array(Ne);for(var Ge=0;Ge<Ne;Ge++)ge[Ge]=arguments[Ge+2];de.children=ge}return{$$typeof:n,type:N.type,key:ue,ref:he,props:de,_owner:pe}},Ue.createContext=function(N){return N={$$typeof:a,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},N.Provider={$$typeof:i,_context:N},N.Consumer=N},Ue.createElement=j,Ue.createFactory=function(N){var U=j.bind(null,N);return U.type=N,U},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(N){return{$$typeof:l,render:N}},Ue.isValidElement=D,Ue.lazy=function(N){return{$$typeof:h,_payload:{_status:-1,_result:N},_init:Z}},Ue.memo=function(N,U){return{$$typeof:u,type:N,compare:U===void 0?null:U}},Ue.startTransition=function(N){var U=G.transition;G.transition={};try{N()}finally{G.transition=U}},Ue.unstable_act=W,Ue.useCallback=function(N,U){return ie.current.useCallback(N,U)},Ue.useContext=function(N){return ie.current.useContext(N)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(N){return ie.current.useDeferredValue(N)},Ue.useEffect=function(N,U){return ie.current.useEffect(N,U)},Ue.useId=function(){return ie.current.useId()},Ue.useImperativeHandle=function(N,U,re){return ie.current.useImperativeHandle(N,U,re)},Ue.useInsertionEffect=function(N,U){return ie.current.useInsertionEffect(N,U)},Ue.useLayoutEffect=function(N,U){return ie.current.useLayoutEffect(N,U)},Ue.useMemo=function(N,U){return ie.current.useMemo(N,U)},Ue.useReducer=function(N,U,re){return ie.current.useReducer(N,U,re)},Ue.useRef=function(N){return ie.current.useRef(N)},Ue.useState=function(N){return ie.current.useState(N)},Ue.useSyncExternalStore=function(N,U,re){return ie.current.useSyncExternalStore(N,U,re)},Ue.useTransition=function(){return ie.current.useTransition()},Ue.version="18.3.1",Ue}var og;function kh(){return og||(og=1,zd.exports=wS()),zd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg;function bS(){if(lg)return ja;lg=1;var n=kh(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(l,d,u){var h,p={},g=null,x=null;u!==void 0&&(g=""+u),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(x=d.ref);for(h in d)r.call(d,h)&&!i.hasOwnProperty(h)&&(p[h]=d[h]);if(l&&l.defaultProps)for(h in d=l.defaultProps,d)p[h]===void 0&&(p[h]=d[h]);return{$$typeof:e,type:l,key:g,ref:x,props:p,_owner:s.current}}return ja.Fragment=t,ja.jsx=a,ja.jsxs=a,ja}var cg;function SS(){return cg||(cg=1,Kd.exports=bS()),Kd.exports}var f=SS(),Rl={},Wd={exports:{}},rr={},Yd={exports:{}},Qd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ug;function TS(){return ug||(ug=1,(function(n){function e(G,Q){var W=G.length;G.push(Q);e:for(;0<W;){var N=W-1>>>1,U=G[N];if(0<s(U,Q))G[N]=Q,G[W]=U,W=N;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Q=G[0],W=G.pop();if(W!==Q){G[0]=W;e:for(var N=0,U=G.length,re=U>>>1;N<re;){var de=2*(N+1)-1,ue=G[de],he=de+1,pe=G[he];if(0>s(ue,W))he<U&&0>s(pe,ue)?(G[N]=pe,G[he]=W,N=he):(G[N]=ue,G[de]=W,N=de);else if(he<U&&0>s(pe,W))G[N]=pe,G[he]=W,N=he;else break e}}return Q}function s(G,Q){var W=G.sortIndex-Q.sortIndex;return W!==0?W:G.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var d=[],u=[],h=1,p=null,g=3,x=!1,y=!1,E=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(G){for(var Q=t(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=G)r(u),Q.sortIndex=Q.expirationTime,e(d,Q);else break;Q=t(u)}}function I(G){if(E=!1,k(G),!y)if(t(d)!==null)y=!0,Z(L);else{var Q=t(u);Q!==null&&ie(I,Q.startTime-G)}}function L(G,Q){y=!1,E&&(E=!1,S(j),j=-1),x=!0;var W=g;try{for(k(Q),p=t(d);p!==null&&(!(p.expirationTime>Q)||G&&!$());){var N=p.callback;if(typeof N=="function"){p.callback=null,g=p.priorityLevel;var U=N(p.expirationTime<=Q);Q=n.unstable_now(),typeof U=="function"?p.callback=U:p===t(d)&&r(d),k(Q)}else r(d);p=t(d)}if(p!==null)var re=!0;else{var de=t(u);de!==null&&ie(I,de.startTime-Q),re=!1}return re}finally{p=null,g=W,x=!1}}var O=!1,P=null,j=-1,F=5,D=-1;function $(){return!(n.unstable_now()-D<F)}function J(){if(P!==null){var G=n.unstable_now();D=G;var Q=!0;try{Q=P(!0,G)}finally{Q?ne():(O=!1,P=null)}}else O=!1}var ne;if(typeof T=="function")ne=function(){T(J)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,X=se.port2;se.port1.onmessage=J,ne=function(){X.postMessage(null)}}else ne=function(){w(J,0)};function Z(G){P=G,O||(O=!0,ne())}function ie(G,Q){j=w(function(){G(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||x||(y=!0,Z(L))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(G){switch(g){case 1:case 2:case 3:var Q=3;break;default:Q=g}var W=g;g=Q;try{return G()}finally{g=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,Q){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var W=g;g=G;try{return Q()}finally{g=W}},n.unstable_scheduleCallback=function(G,Q,W){var N=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?N+W:N):W=N,G){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=W+U,G={id:h++,callback:Q,priorityLevel:G,startTime:W,expirationTime:U,sortIndex:-1},W>N?(G.sortIndex=W,e(u,G),t(d)===null&&G===t(u)&&(E?(S(j),j=-1):E=!0,ie(I,W-N))):(G.sortIndex=U,e(d,G),y||x||(y=!0,Z(L))),G},n.unstable_shouldYield=$,n.unstable_wrapCallback=function(G){var Q=g;return function(){var W=g;g=Q;try{return G.apply(this,arguments)}finally{g=W}}}})(Qd)),Qd}var dg;function _S(){return dg||(dg=1,Yd.exports=TS()),Yd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fg;function kS(){if(fg)return rr;fg=1;var n=kh(),e=_S();function t(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,m=1;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(o,c){a(o,c),a(o+"Capture",c)}function a(o,c){for(s[o]=c,o=0;o<c.length;o++)r.add(c[o])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function g(o){return d.call(p,o)?!0:d.call(h,o)?!1:u.test(o)?p[o]=!0:(h[o]=!0,!1)}function x(o,c,m,v){if(m!==null&&m.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:m!==null?!m.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function y(o,c,m,v){if(c===null||typeof c>"u"||x(o,c,m,v))return!0;if(v)return!1;if(m!==null)switch(m.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function E(o,c,m,v,b,_,A){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=b,this.mustUseProperty=m,this.propertyName=o,this.type=c,this.sanitizeURL=_,this.removeEmptyString=A}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){w[o]=new E(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];w[c]=new E(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){w[o]=new E(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){w[o]=new E(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){w[o]=new E(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){w[o]=new E(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){w[o]=new E(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){w[o]=new E(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){w[o]=new E(o,5,!1,o.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function T(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(S,T);w[c]=new E(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(S,T);w[c]=new E(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(S,T);w[c]=new E(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){w[o]=new E(o,1,!1,o.toLowerCase(),null,!1,!1)}),w.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){w[o]=new E(o,1,!1,o.toLowerCase(),null,!0,!0)});function k(o,c,m,v){var b=w.hasOwnProperty(c)?w[c]:null;(b!==null?b.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,m,b,v)&&(m=null),v||b===null?g(c)&&(m===null?o.removeAttribute(c):o.setAttribute(c,""+m)):b.mustUseProperty?o[b.propertyName]=m===null?b.type===3?!1:"":m:(c=b.attributeName,v=b.attributeNamespace,m===null?o.removeAttribute(c):(b=b.type,m=b===3||b===4&&m===!0?"":""+m,v?o.setAttributeNS(v,c,m):o.setAttribute(c,m))))}var I=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),O=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),$=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ie=Symbol.for("react.offscreen"),G=Symbol.iterator;function Q(o){return o===null||typeof o!="object"?null:(o=G&&o[G]||o["@@iterator"],typeof o=="function"?o:null)}var W=Object.assign,N;function U(o){if(N===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);N=c&&c[1]||""}return`
`+N+o}var re=!1;function de(o,c){if(!o||re)return"";re=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Y){var v=Y}Reflect.construct(o,[],c)}else{try{c.call()}catch(Y){v=Y}o.call(c.prototype)}else{try{throw Error()}catch(Y){v=Y}o()}}catch(Y){if(Y&&v&&typeof Y.stack=="string"){for(var b=Y.stack.split(`
`),_=v.stack.split(`
`),A=b.length-1,M=_.length-1;1<=A&&0<=M&&b[A]!==_[M];)M--;for(;1<=A&&0<=M;A--,M--)if(b[A]!==_[M]){if(A!==1||M!==1)do if(A--,M--,0>M||b[A]!==_[M]){var B=`
`+b[A].replace(" at new "," at ");return o.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",o.displayName)),B}while(1<=A&&0<=M);break}}}finally{re=!1,Error.prepareStackTrace=m}return(o=o?o.displayName||o.name:"")?U(o):""}function ue(o){switch(o.tag){case 5:return U(o.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return o=de(o.type,!1),o;case 11:return o=de(o.type.render,!1),o;case 1:return o=de(o.type,!0),o;default:return""}}function he(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case O:return"Portal";case F:return"Profiler";case j:return"StrictMode";case ne:return"Suspense";case se:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case $:return(o.displayName||"Context")+".Consumer";case D:return(o._context.displayName||"Context")+".Provider";case J:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case X:return c=o.displayName||null,c!==null?c:he(o.type)||"Memo";case Z:c=o._payload,o=o._init;try{return he(o(c))}catch{}}return null}function pe(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(c);case 8:return c===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ge(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ne(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Ge(o){var c=Ne(o)?"checked":"value",m=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),v=""+o[c];if(!o.hasOwnProperty(c)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var b=m.get,_=m.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return b.call(this)},set:function(A){v=""+A,_.call(this,A)}}),Object.defineProperty(o,c,{enumerable:m.enumerable}),{getValue:function(){return v},setValue:function(A){v=""+A},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Vt(o){o._valueTracker||(o._valueTracker=Ge(o))}function ke(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var m=c.getValue(),v="";return o&&(v=Ne(o)?o.checked?"true":"false":o.value),o=v,o!==m?(c.setValue(o),!0):!1}function je(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function le(o,c){var m=c.checked;return W({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??o._wrapperState.initialChecked})}function Pe(o,c){var m=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;m=ge(c.value!=null?c.value:m),o._wrapperState={initialChecked:v,initialValue:m,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function we(o,c){c=c.checked,c!=null&&k(o,"checked",c,!1)}function Fe(o,c){we(o,c);var m=ge(c.value),v=c.type;if(m!=null)v==="number"?(m===0&&o.value===""||o.value!=m)&&(o.value=""+m):o.value!==""+m&&(o.value=""+m);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?Ke(o,c.type,m):c.hasOwnProperty("defaultValue")&&Ke(o,c.type,ge(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function He(o,c,m){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,m||c===o.value||(o.value=c),o.defaultValue=c}m=o.name,m!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,m!==""&&(o.name=m)}function Ke(o,c,m){(c!=="number"||je(o.ownerDocument)!==o)&&(m==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+m&&(o.defaultValue=""+m))}var Ve=Array.isArray;function Xe(o,c,m,v){if(o=o.options,c){c={};for(var b=0;b<m.length;b++)c["$"+m[b]]=!0;for(m=0;m<o.length;m++)b=c.hasOwnProperty("$"+o[m].value),o[m].selected!==b&&(o[m].selected=b),b&&v&&(o[m].defaultSelected=!0)}else{for(m=""+ge(m),c=null,b=0;b<o.length;b++){if(o[b].value===m){o[b].selected=!0,v&&(o[b].defaultSelected=!0);return}c!==null||o[b].disabled||(c=o[b])}c!==null&&(c.selected=!0)}}function bt(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return W({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function On(o,c){var m=c.value;if(m==null){if(m=c.children,c=c.defaultValue,m!=null){if(c!=null)throw Error(t(92));if(Ve(m)){if(1<m.length)throw Error(t(93));m=m[0]}c=m}c==null&&(c=""),m=c}o._wrapperState={initialValue:ge(m)}}function dn(o,c){var m=ge(c.value),v=ge(c.defaultValue);m!=null&&(m=""+m,m!==o.value&&(o.value=m),c.defaultValue==null&&o.defaultValue!==m&&(o.defaultValue=m)),v!=null&&(o.defaultValue=""+v)}function Zi(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function jn(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ys(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?jn(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Qs,Ji=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,m,v,b){MSApp.execUnsafeLocalFunction(function(){return o(c,m,v,b)})}:o})(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(Qs=Qs||document.createElement("div"),Qs.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Qs.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function Mn(o,c){if(c){var m=o.firstChild;if(m&&m===o.lastChild&&m.nodeType===3){m.nodeValue=c;return}}o.textContent=c}var Ar={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tw=["Webkit","ms","Moz","O"];Object.keys(Ar).forEach(function(o){Tw.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),Ar[c]=Ar[o]})});function w0(o,c,m){return c==null||typeof c=="boolean"||c===""?"":m||typeof c!="number"||c===0||Ar.hasOwnProperty(o)&&Ar[o]?(""+c).trim():c+"px"}function b0(o,c){o=o.style;for(var m in c)if(c.hasOwnProperty(m)){var v=m.indexOf("--")===0,b=w0(m,c[m],v);m==="float"&&(m="cssFloat"),v?o.setProperty(m,b):o[m]=b}}var _w=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function su(o,c){if(c){if(_w[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function iu(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var au=null;function ou(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var lu=null,Xs=null,Zs=null;function S0(o){if(o=wa(o)){if(typeof lu!="function")throw Error(t(280));var c=o.stateNode;c&&(c=Ko(c),lu(o.stateNode,o.type,c))}}function T0(o){Xs?Zs?Zs.push(o):Zs=[o]:Xs=o}function _0(){if(Xs){var o=Xs,c=Zs;if(Zs=Xs=null,S0(o),c)for(o=0;o<c.length;o++)S0(c[o])}}function k0(o,c){return o(c)}function C0(){}var cu=!1;function I0(o,c,m){if(cu)return o(c,m);cu=!0;try{return k0(o,c,m)}finally{cu=!1,(Xs!==null||Zs!==null)&&(C0(),_0())}}function ea(o,c){var m=o.stateNode;if(m===null)return null;var v=Ko(m);if(v===null)return null;m=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(m&&typeof m!="function")throw Error(t(231,c,typeof m));return m}var uu=!1;if(l)try{var ta={};Object.defineProperty(ta,"passive",{get:function(){uu=!0}}),window.addEventListener("test",ta,ta),window.removeEventListener("test",ta,ta)}catch{uu=!1}function kw(o,c,m,v,b,_,A,M,B){var Y=Array.prototype.slice.call(arguments,3);try{c.apply(m,Y)}catch(oe){this.onError(oe)}}var ra=!1,To=null,_o=!1,du=null,Cw={onError:function(o){ra=!0,To=o}};function Iw(o,c,m,v,b,_,A,M,B){ra=!1,To=null,kw.apply(Cw,arguments)}function Aw(o,c,m,v,b,_,A,M,B){if(Iw.apply(this,arguments),ra){if(ra){var Y=To;ra=!1,To=null}else throw Error(t(198));_o||(_o=!0,du=Y)}}function vs(o){var c=o,m=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(m=c.return),o=c.return;while(o)}return c.tag===3?m:null}function A0(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function L0(o){if(vs(o)!==o)throw Error(t(188))}function Lw(o){var c=o.alternate;if(!c){if(c=vs(o),c===null)throw Error(t(188));return c!==o?null:o}for(var m=o,v=c;;){var b=m.return;if(b===null)break;var _=b.alternate;if(_===null){if(v=b.return,v!==null){m=v;continue}break}if(b.child===_.child){for(_=b.child;_;){if(_===m)return L0(b),o;if(_===v)return L0(b),c;_=_.sibling}throw Error(t(188))}if(m.return!==v.return)m=b,v=_;else{for(var A=!1,M=b.child;M;){if(M===m){A=!0,m=b,v=_;break}if(M===v){A=!0,v=b,m=_;break}M=M.sibling}if(!A){for(M=_.child;M;){if(M===m){A=!0,m=_,v=b;break}if(M===v){A=!0,v=_,m=b;break}M=M.sibling}if(!A)throw Error(t(189))}}if(m.alternate!==v)throw Error(t(190))}if(m.tag!==3)throw Error(t(188));return m.stateNode.current===m?o:c}function R0(o){return o=Lw(o),o!==null?N0(o):null}function N0(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=N0(o);if(c!==null)return c;o=o.sibling}return null}var D0=e.unstable_scheduleCallback,P0=e.unstable_cancelCallback,Rw=e.unstable_shouldYield,Nw=e.unstable_requestPaint,yt=e.unstable_now,Dw=e.unstable_getCurrentPriorityLevel,fu=e.unstable_ImmediatePriority,O0=e.unstable_UserBlockingPriority,ko=e.unstable_NormalPriority,Pw=e.unstable_LowPriority,j0=e.unstable_IdlePriority,Co=null,Gr=null;function Ow(o){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(Co,o,void 0,(o.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:Fw,jw=Math.log,Mw=Math.LN2;function Fw(o){return o>>>=0,o===0?32:31-(jw(o)/Mw|0)|0}var Io=64,Ao=4194304;function na(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Lo(o,c){var m=o.pendingLanes;if(m===0)return 0;var v=0,b=o.suspendedLanes,_=o.pingedLanes,A=m&268435455;if(A!==0){var M=A&~b;M!==0?v=na(M):(_&=A,_!==0&&(v=na(_)))}else A=m&~b,A!==0?v=na(A):_!==0&&(v=na(_));if(v===0)return 0;if(c!==0&&c!==v&&(c&b)===0&&(b=v&-v,_=c&-c,b>=_||b===16&&(_&4194240)!==0))return c;if((v&4)!==0&&(v|=m&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=v;0<c;)m=31-Lr(c),b=1<<m,v|=o[m],c&=~b;return v}function Uw(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bw(o,c){for(var m=o.suspendedLanes,v=o.pingedLanes,b=o.expirationTimes,_=o.pendingLanes;0<_;){var A=31-Lr(_),M=1<<A,B=b[A];B===-1?((M&m)===0||(M&v)!==0)&&(b[A]=Uw(M,c)):B<=c&&(o.expiredLanes|=M),_&=~M}}function hu(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function M0(){var o=Io;return Io<<=1,(Io&4194240)===0&&(Io=64),o}function mu(o){for(var c=[],m=0;31>m;m++)c.push(o);return c}function sa(o,c,m){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-Lr(c),o[c]=m}function $w(o,c){var m=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<m;){var b=31-Lr(m),_=1<<b;c[b]=0,v[b]=-1,o[b]=-1,m&=~_}}function pu(o,c){var m=o.entangledLanes|=c;for(o=o.entanglements;m;){var v=31-Lr(m),b=1<<v;b&c|o[v]&c&&(o[v]|=c),m&=~b}}var We=0;function F0(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var U0,gu,B0,$0,V0,xu=!1,Ro=[],Fn=null,Un=null,Bn=null,ia=new Map,aa=new Map,$n=[],Vw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G0(o,c){switch(o){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":Un=null;break;case"mouseover":case"mouseout":Bn=null;break;case"pointerover":case"pointerout":ia.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":aa.delete(c.pointerId)}}function oa(o,c,m,v,b,_){return o===null||o.nativeEvent!==_?(o={blockedOn:c,domEventName:m,eventSystemFlags:v,nativeEvent:_,targetContainers:[b]},c!==null&&(c=wa(c),c!==null&&gu(c)),o):(o.eventSystemFlags|=v,c=o.targetContainers,b!==null&&c.indexOf(b)===-1&&c.push(b),o)}function Gw(o,c,m,v,b){switch(c){case"focusin":return Fn=oa(Fn,o,c,m,v,b),!0;case"dragenter":return Un=oa(Un,o,c,m,v,b),!0;case"mouseover":return Bn=oa(Bn,o,c,m,v,b),!0;case"pointerover":var _=b.pointerId;return ia.set(_,oa(ia.get(_)||null,o,c,m,v,b)),!0;case"gotpointercapture":return _=b.pointerId,aa.set(_,oa(aa.get(_)||null,o,c,m,v,b)),!0}return!1}function H0(o){var c=ys(o.target);if(c!==null){var m=vs(c);if(m!==null){if(c=m.tag,c===13){if(c=A0(m),c!==null){o.blockedOn=c,V0(o.priority,function(){B0(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){o.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}o.blockedOn=null}function No(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var m=yu(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(m===null){m=o.nativeEvent;var v=new m.constructor(m.type,m);au=v,m.target.dispatchEvent(v),au=null}else return c=wa(m),c!==null&&gu(c),o.blockedOn=m,!1;c.shift()}return!0}function q0(o,c,m){No(o)&&m.delete(c)}function Hw(){xu=!1,Fn!==null&&No(Fn)&&(Fn=null),Un!==null&&No(Un)&&(Un=null),Bn!==null&&No(Bn)&&(Bn=null),ia.forEach(q0),aa.forEach(q0)}function la(o,c){o.blockedOn===c&&(o.blockedOn=null,xu||(xu=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Hw)))}function ca(o){function c(b){return la(b,o)}if(0<Ro.length){la(Ro[0],o);for(var m=1;m<Ro.length;m++){var v=Ro[m];v.blockedOn===o&&(v.blockedOn=null)}}for(Fn!==null&&la(Fn,o),Un!==null&&la(Un,o),Bn!==null&&la(Bn,o),ia.forEach(c),aa.forEach(c),m=0;m<$n.length;m++)v=$n[m],v.blockedOn===o&&(v.blockedOn=null);for(;0<$n.length&&(m=$n[0],m.blockedOn===null);)H0(m),m.blockedOn===null&&$n.shift()}var Js=I.ReactCurrentBatchConfig,Do=!0;function qw(o,c,m,v){var b=We,_=Js.transition;Js.transition=null;try{We=1,vu(o,c,m,v)}finally{We=b,Js.transition=_}}function Kw(o,c,m,v){var b=We,_=Js.transition;Js.transition=null;try{We=4,vu(o,c,m,v)}finally{We=b,Js.transition=_}}function vu(o,c,m,v){if(Do){var b=yu(o,c,m,v);if(b===null)ju(o,c,v,Po,m),G0(o,v);else if(Gw(b,o,c,m,v))v.stopPropagation();else if(G0(o,v),c&4&&-1<Vw.indexOf(o)){for(;b!==null;){var _=wa(b);if(_!==null&&U0(_),_=yu(o,c,m,v),_===null&&ju(o,c,v,Po,m),_===b)break;b=_}b!==null&&v.stopPropagation()}else ju(o,c,v,null,m)}}var Po=null;function yu(o,c,m,v){if(Po=null,o=ou(v),o=ys(o),o!==null)if(c=vs(o),c===null)o=null;else if(m=c.tag,m===13){if(o=A0(c),o!==null)return o;o=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return Po=o,null}function K0(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dw()){case fu:return 1;case O0:return 4;case ko:case Pw:return 16;case j0:return 536870912;default:return 16}default:return 16}}var Vn=null,Eu=null,Oo=null;function z0(){if(Oo)return Oo;var o,c=Eu,m=c.length,v,b="value"in Vn?Vn.value:Vn.textContent,_=b.length;for(o=0;o<m&&c[o]===b[o];o++);var A=m-o;for(v=1;v<=A&&c[m-v]===b[_-v];v++);return Oo=b.slice(o,1<v?1-v:void 0)}function jo(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Mo(){return!0}function W0(){return!1}function or(o){function c(m,v,b,_,A){this._reactName=m,this._targetInst=b,this.type=v,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var M in o)o.hasOwnProperty(M)&&(m=o[M],this[M]=m?m(_):_[M]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Mo:W0,this.isPropagationStopped=W0,this}return W(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Mo)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Mo)},persist:function(){},isPersistent:Mo}),c}var ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wu=or(ei),ua=W({},ei,{view:0,detail:0}),zw=or(ua),bu,Su,da,Fo=W({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_u,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==da&&(da&&o.type==="mousemove"?(bu=o.screenX-da.screenX,Su=o.screenY-da.screenY):Su=bu=0,da=o),bu)},movementY:function(o){return"movementY"in o?o.movementY:Su}}),Y0=or(Fo),Ww=W({},Fo,{dataTransfer:0}),Yw=or(Ww),Qw=W({},ua,{relatedTarget:0}),Tu=or(Qw),Xw=W({},ei,{animationName:0,elapsedTime:0,pseudoElement:0}),Zw=or(Xw),Jw=W({},ei,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),eb=or(Jw),tb=W({},ei,{data:0}),Q0=or(tb),rb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ib(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=sb[o])?!!c[o]:!1}function _u(){return ib}var ab=W({},ua,{key:function(o){if(o.key){var c=rb[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=jo(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?nb[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_u,charCode:function(o){return o.type==="keypress"?jo(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?jo(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),ob=or(ab),lb=W({},Fo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X0=or(lb),cb=W({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_u}),ub=or(cb),db=W({},ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),fb=or(db),hb=W({},Fo,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),mb=or(hb),pb=[9,13,27,32],ku=l&&"CompositionEvent"in window,fa=null;l&&"documentMode"in document&&(fa=document.documentMode);var gb=l&&"TextEvent"in window&&!fa,Z0=l&&(!ku||fa&&8<fa&&11>=fa),J0=" ",em=!1;function tm(o,c){switch(o){case"keyup":return pb.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rm(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ti=!1;function xb(o,c){switch(o){case"compositionend":return rm(c);case"keypress":return c.which!==32?null:(em=!0,J0);case"textInput":return o=c.data,o===J0&&em?null:o;default:return null}}function vb(o,c){if(ti)return o==="compositionend"||!ku&&tm(o,c)?(o=z0(),Oo=Eu=Vn=null,ti=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Z0&&c.locale!=="ko"?null:c.data;default:return null}}var yb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nm(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!yb[o.type]:c==="textarea"}function sm(o,c,m,v){T0(v),c=Go(c,"onChange"),0<c.length&&(m=new wu("onChange","change",null,m,v),o.push({event:m,listeners:c}))}var ha=null,ma=null;function Eb(o){bm(o,0)}function Uo(o){var c=ai(o);if(ke(c))return o}function wb(o,c){if(o==="change")return c}var im=!1;if(l){var Cu;if(l){var Iu="oninput"in document;if(!Iu){var am=document.createElement("div");am.setAttribute("oninput","return;"),Iu=typeof am.oninput=="function"}Cu=Iu}else Cu=!1;im=Cu&&(!document.documentMode||9<document.documentMode)}function om(){ha&&(ha.detachEvent("onpropertychange",lm),ma=ha=null)}function lm(o){if(o.propertyName==="value"&&Uo(ma)){var c=[];sm(c,ma,o,ou(o)),I0(Eb,c)}}function bb(o,c,m){o==="focusin"?(om(),ha=c,ma=m,ha.attachEvent("onpropertychange",lm)):o==="focusout"&&om()}function Sb(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Uo(ma)}function Tb(o,c){if(o==="click")return Uo(c)}function _b(o,c){if(o==="input"||o==="change")return Uo(c)}function kb(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Rr=typeof Object.is=="function"?Object.is:kb;function pa(o,c){if(Rr(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var m=Object.keys(o),v=Object.keys(c);if(m.length!==v.length)return!1;for(v=0;v<m.length;v++){var b=m[v];if(!d.call(c,b)||!Rr(o[b],c[b]))return!1}return!0}function cm(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function um(o,c){var m=cm(o);o=0;for(var v;m;){if(m.nodeType===3){if(v=o+m.textContent.length,o<=c&&v>=c)return{node:m,offset:c-o};o=v}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=cm(m)}}function dm(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?dm(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function fm(){for(var o=window,c=je();c instanceof o.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)o=c.contentWindow;else break;c=je(o.document)}return c}function Au(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function Cb(o){var c=fm(),m=o.focusedElem,v=o.selectionRange;if(c!==m&&m&&m.ownerDocument&&dm(m.ownerDocument.documentElement,m)){if(v!==null&&Au(m)){if(c=v.start,o=v.end,o===void 0&&(o=c),"selectionStart"in m)m.selectionStart=c,m.selectionEnd=Math.min(o,m.value.length);else if(o=(c=m.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var b=m.textContent.length,_=Math.min(v.start,b);v=v.end===void 0?_:Math.min(v.end,b),!o.extend&&_>v&&(b=v,v=_,_=b),b=um(m,_);var A=um(m,v);b&&A&&(o.rangeCount!==1||o.anchorNode!==b.node||o.anchorOffset!==b.offset||o.focusNode!==A.node||o.focusOffset!==A.offset)&&(c=c.createRange(),c.setStart(b.node,b.offset),o.removeAllRanges(),_>v?(o.addRange(c),o.extend(A.node,A.offset)):(c.setEnd(A.node,A.offset),o.addRange(c)))}}for(c=[],o=m;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<c.length;m++)o=c[m],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Ib=l&&"documentMode"in document&&11>=document.documentMode,ri=null,Lu=null,ga=null,Ru=!1;function hm(o,c,m){var v=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Ru||ri==null||ri!==je(v)||(v=ri,"selectionStart"in v&&Au(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),ga&&pa(ga,v)||(ga=v,v=Go(Lu,"onSelect"),0<v.length&&(c=new wu("onSelect","select",null,c,m),o.push({event:c,listeners:v}),c.target=ri)))}function Bo(o,c){var m={};return m[o.toLowerCase()]=c.toLowerCase(),m["Webkit"+o]="webkit"+c,m["Moz"+o]="moz"+c,m}var ni={animationend:Bo("Animation","AnimationEnd"),animationiteration:Bo("Animation","AnimationIteration"),animationstart:Bo("Animation","AnimationStart"),transitionend:Bo("Transition","TransitionEnd")},Nu={},mm={};l&&(mm=document.createElement("div").style,"AnimationEvent"in window||(delete ni.animationend.animation,delete ni.animationiteration.animation,delete ni.animationstart.animation),"TransitionEvent"in window||delete ni.transitionend.transition);function $o(o){if(Nu[o])return Nu[o];if(!ni[o])return o;var c=ni[o],m;for(m in c)if(c.hasOwnProperty(m)&&m in mm)return Nu[o]=c[m];return o}var pm=$o("animationend"),gm=$o("animationiteration"),xm=$o("animationstart"),vm=$o("transitionend"),ym=new Map,Em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gn(o,c){ym.set(o,c),i(c,[o])}for(var Du=0;Du<Em.length;Du++){var Pu=Em[Du],Ab=Pu.toLowerCase(),Lb=Pu[0].toUpperCase()+Pu.slice(1);Gn(Ab,"on"+Lb)}Gn(pm,"onAnimationEnd"),Gn(gm,"onAnimationIteration"),Gn(xm,"onAnimationStart"),Gn("dblclick","onDoubleClick"),Gn("focusin","onFocus"),Gn("focusout","onBlur"),Gn(vm,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rb=new Set("cancel close invalid load scroll toggle".split(" ").concat(xa));function wm(o,c,m){var v=o.type||"unknown-event";o.currentTarget=m,Aw(v,c,void 0,o),o.currentTarget=null}function bm(o,c){c=(c&4)!==0;for(var m=0;m<o.length;m++){var v=o[m],b=v.event;v=v.listeners;e:{var _=void 0;if(c)for(var A=v.length-1;0<=A;A--){var M=v[A],B=M.instance,Y=M.currentTarget;if(M=M.listener,B!==_&&b.isPropagationStopped())break e;wm(b,M,Y),_=B}else for(A=0;A<v.length;A++){if(M=v[A],B=M.instance,Y=M.currentTarget,M=M.listener,B!==_&&b.isPropagationStopped())break e;wm(b,M,Y),_=B}}}if(_o)throw o=du,_o=!1,du=null,o}function st(o,c){var m=c[Vu];m===void 0&&(m=c[Vu]=new Set);var v=o+"__bubble";m.has(v)||(Sm(c,o,2,!1),m.add(v))}function Ou(o,c,m){var v=0;c&&(v|=4),Sm(m,o,v,c)}var Vo="_reactListening"+Math.random().toString(36).slice(2);function va(o){if(!o[Vo]){o[Vo]=!0,r.forEach(function(m){m!=="selectionchange"&&(Rb.has(m)||Ou(m,!1,o),Ou(m,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Vo]||(c[Vo]=!0,Ou("selectionchange",!1,c))}}function Sm(o,c,m,v){switch(K0(c)){case 1:var b=qw;break;case 4:b=Kw;break;default:b=vu}m=b.bind(null,c,m,o),b=void 0,!uu||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(b=!0),v?b!==void 0?o.addEventListener(c,m,{capture:!0,passive:b}):o.addEventListener(c,m,!0):b!==void 0?o.addEventListener(c,m,{passive:b}):o.addEventListener(c,m,!1)}function ju(o,c,m,v,b){var _=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var A=v.tag;if(A===3||A===4){var M=v.stateNode.containerInfo;if(M===b||M.nodeType===8&&M.parentNode===b)break;if(A===4)for(A=v.return;A!==null;){var B=A.tag;if((B===3||B===4)&&(B=A.stateNode.containerInfo,B===b||B.nodeType===8&&B.parentNode===b))return;A=A.return}for(;M!==null;){if(A=ys(M),A===null)return;if(B=A.tag,B===5||B===6){v=_=A;continue e}M=M.parentNode}}v=v.return}I0(function(){var Y=_,oe=ou(m),ce=[];e:{var ae=ym.get(o);if(ae!==void 0){var ve=wu,be=o;switch(o){case"keypress":if(jo(m)===0)break e;case"keydown":case"keyup":ve=ob;break;case"focusin":be="focus",ve=Tu;break;case"focusout":be="blur",ve=Tu;break;case"beforeblur":case"afterblur":ve=Tu;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=Y0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=Yw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=ub;break;case pm:case gm:case xm:ve=Zw;break;case vm:ve=fb;break;case"scroll":ve=zw;break;case"wheel":ve=mb;break;case"copy":case"cut":case"paste":ve=eb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=X0}var Se=(c&4)!==0,Et=!Se&&o==="scroll",K=Se?ae!==null?ae+"Capture":null:ae;Se=[];for(var V=Y,z;V!==null;){z=V;var fe=z.stateNode;if(z.tag===5&&fe!==null&&(z=fe,K!==null&&(fe=ea(V,K),fe!=null&&Se.push(ya(V,fe,z)))),Et)break;V=V.return}0<Se.length&&(ae=new ve(ae,be,null,m,oe),ce.push({event:ae,listeners:Se}))}}if((c&7)===0){e:{if(ae=o==="mouseover"||o==="pointerover",ve=o==="mouseout"||o==="pointerout",ae&&m!==au&&(be=m.relatedTarget||m.fromElement)&&(ys(be)||be[fn]))break e;if((ve||ae)&&(ae=oe.window===oe?oe:(ae=oe.ownerDocument)?ae.defaultView||ae.parentWindow:window,ve?(be=m.relatedTarget||m.toElement,ve=Y,be=be?ys(be):null,be!==null&&(Et=vs(be),be!==Et||be.tag!==5&&be.tag!==6)&&(be=null)):(ve=null,be=Y),ve!==be)){if(Se=Y0,fe="onMouseLeave",K="onMouseEnter",V="mouse",(o==="pointerout"||o==="pointerover")&&(Se=X0,fe="onPointerLeave",K="onPointerEnter",V="pointer"),Et=ve==null?ae:ai(ve),z=be==null?ae:ai(be),ae=new Se(fe,V+"leave",ve,m,oe),ae.target=Et,ae.relatedTarget=z,fe=null,ys(oe)===Y&&(Se=new Se(K,V+"enter",be,m,oe),Se.target=z,Se.relatedTarget=Et,fe=Se),Et=fe,ve&&be)t:{for(Se=ve,K=be,V=0,z=Se;z;z=si(z))V++;for(z=0,fe=K;fe;fe=si(fe))z++;for(;0<V-z;)Se=si(Se),V--;for(;0<z-V;)K=si(K),z--;for(;V--;){if(Se===K||K!==null&&Se===K.alternate)break t;Se=si(Se),K=si(K)}Se=null}else Se=null;ve!==null&&Tm(ce,ae,ve,Se,!1),be!==null&&Et!==null&&Tm(ce,Et,be,Se,!0)}}e:{if(ae=Y?ai(Y):window,ve=ae.nodeName&&ae.nodeName.toLowerCase(),ve==="select"||ve==="input"&&ae.type==="file")var _e=wb;else if(nm(ae))if(im)_e=_b;else{_e=Sb;var Ce=bb}else(ve=ae.nodeName)&&ve.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(_e=Tb);if(_e&&(_e=_e(o,Y))){sm(ce,_e,m,oe);break e}Ce&&Ce(o,ae,Y),o==="focusout"&&(Ce=ae._wrapperState)&&Ce.controlled&&ae.type==="number"&&Ke(ae,"number",ae.value)}switch(Ce=Y?ai(Y):window,o){case"focusin":(nm(Ce)||Ce.contentEditable==="true")&&(ri=Ce,Lu=Y,ga=null);break;case"focusout":ga=Lu=ri=null;break;case"mousedown":Ru=!0;break;case"contextmenu":case"mouseup":case"dragend":Ru=!1,hm(ce,m,oe);break;case"selectionchange":if(Ib)break;case"keydown":case"keyup":hm(ce,m,oe)}var Ie;if(ku)e:{switch(o){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else ti?tm(o,m)&&(Le="onCompositionEnd"):o==="keydown"&&m.keyCode===229&&(Le="onCompositionStart");Le&&(Z0&&m.locale!=="ko"&&(ti||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&ti&&(Ie=z0()):(Vn=oe,Eu="value"in Vn?Vn.value:Vn.textContent,ti=!0)),Ce=Go(Y,Le),0<Ce.length&&(Le=new Q0(Le,o,null,m,oe),ce.push({event:Le,listeners:Ce}),Ie?Le.data=Ie:(Ie=rm(m),Ie!==null&&(Le.data=Ie)))),(Ie=gb?xb(o,m):vb(o,m))&&(Y=Go(Y,"onBeforeInput"),0<Y.length&&(oe=new Q0("onBeforeInput","beforeinput",null,m,oe),ce.push({event:oe,listeners:Y}),oe.data=Ie))}bm(ce,c)})}function ya(o,c,m){return{instance:o,listener:c,currentTarget:m}}function Go(o,c){for(var m=c+"Capture",v=[];o!==null;){var b=o,_=b.stateNode;b.tag===5&&_!==null&&(b=_,_=ea(o,m),_!=null&&v.unshift(ya(o,_,b)),_=ea(o,c),_!=null&&v.push(ya(o,_,b))),o=o.return}return v}function si(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Tm(o,c,m,v,b){for(var _=c._reactName,A=[];m!==null&&m!==v;){var M=m,B=M.alternate,Y=M.stateNode;if(B!==null&&B===v)break;M.tag===5&&Y!==null&&(M=Y,b?(B=ea(m,_),B!=null&&A.unshift(ya(m,B,M))):b||(B=ea(m,_),B!=null&&A.push(ya(m,B,M)))),m=m.return}A.length!==0&&o.push({event:c,listeners:A})}var Nb=/\r\n?/g,Db=/\u0000|\uFFFD/g;function _m(o){return(typeof o=="string"?o:""+o).replace(Nb,`
`).replace(Db,"")}function Ho(o,c,m){if(c=_m(c),_m(o)!==c&&m)throw Error(t(425))}function qo(){}var Mu=null,Fu=null;function Uu(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Bu=typeof setTimeout=="function"?setTimeout:void 0,Pb=typeof clearTimeout=="function"?clearTimeout:void 0,km=typeof Promise=="function"?Promise:void 0,Ob=typeof queueMicrotask=="function"?queueMicrotask:typeof km<"u"?function(o){return km.resolve(null).then(o).catch(jb)}:Bu;function jb(o){setTimeout(function(){throw o})}function $u(o,c){var m=c,v=0;do{var b=m.nextSibling;if(o.removeChild(m),b&&b.nodeType===8)if(m=b.data,m==="/$"){if(v===0){o.removeChild(b),ca(c);return}v--}else m!=="$"&&m!=="$?"&&m!=="$!"||v++;m=b}while(m);ca(c)}function Hn(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function Cm(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var m=o.data;if(m==="$"||m==="$!"||m==="$?"){if(c===0)return o;c--}else m==="/$"&&c++}o=o.previousSibling}return null}var ii=Math.random().toString(36).slice(2),Hr="__reactFiber$"+ii,Ea="__reactProps$"+ii,fn="__reactContainer$"+ii,Vu="__reactEvents$"+ii,Mb="__reactListeners$"+ii,Fb="__reactHandles$"+ii;function ys(o){var c=o[Hr];if(c)return c;for(var m=o.parentNode;m;){if(c=m[fn]||m[Hr]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(o=Cm(o);o!==null;){if(m=o[Hr])return m;o=Cm(o)}return c}o=m,m=o.parentNode}return null}function wa(o){return o=o[Hr]||o[fn],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function ai(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Ko(o){return o[Ea]||null}var Gu=[],oi=-1;function qn(o){return{current:o}}function it(o){0>oi||(o.current=Gu[oi],Gu[oi]=null,oi--)}function rt(o,c){oi++,Gu[oi]=o.current,o.current=c}var Kn={},Gt=qn(Kn),Xt=qn(!1),Es=Kn;function li(o,c){var m=o.type.contextTypes;if(!m)return Kn;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var b={},_;for(_ in m)b[_]=c[_];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=b),b}function Zt(o){return o=o.childContextTypes,o!=null}function zo(){it(Xt),it(Gt)}function Im(o,c,m){if(Gt.current!==Kn)throw Error(t(168));rt(Gt,c),rt(Xt,m)}function Am(o,c,m){var v=o.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return m;v=v.getChildContext();for(var b in v)if(!(b in c))throw Error(t(108,pe(o)||"Unknown",b));return W({},m,v)}function Wo(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Kn,Es=Gt.current,rt(Gt,o),rt(Xt,Xt.current),!0}function Lm(o,c,m){var v=o.stateNode;if(!v)throw Error(t(169));m?(o=Am(o,c,Es),v.__reactInternalMemoizedMergedChildContext=o,it(Xt),it(Gt),rt(Gt,o)):it(Xt),rt(Xt,m)}var hn=null,Yo=!1,Hu=!1;function Rm(o){hn===null?hn=[o]:hn.push(o)}function Ub(o){Yo=!0,Rm(o)}function zn(){if(!Hu&&hn!==null){Hu=!0;var o=0,c=We;try{var m=hn;for(We=1;o<m.length;o++){var v=m[o];do v=v(!0);while(v!==null)}hn=null,Yo=!1}catch(b){throw hn!==null&&(hn=hn.slice(o+1)),D0(fu,zn),b}finally{We=c,Hu=!1}}return null}var ci=[],ui=0,Qo=null,Xo=0,gr=[],xr=0,ws=null,mn=1,pn="";function bs(o,c){ci[ui++]=Xo,ci[ui++]=Qo,Qo=o,Xo=c}function Nm(o,c,m){gr[xr++]=mn,gr[xr++]=pn,gr[xr++]=ws,ws=o;var v=mn;o=pn;var b=32-Lr(v)-1;v&=~(1<<b),m+=1;var _=32-Lr(c)+b;if(30<_){var A=b-b%5;_=(v&(1<<A)-1).toString(32),v>>=A,b-=A,mn=1<<32-Lr(c)+b|m<<b|v,pn=_+o}else mn=1<<_|m<<b|v,pn=o}function qu(o){o.return!==null&&(bs(o,1),Nm(o,1,0))}function Ku(o){for(;o===Qo;)Qo=ci[--ui],ci[ui]=null,Xo=ci[--ui],ci[ui]=null;for(;o===ws;)ws=gr[--xr],gr[xr]=null,pn=gr[--xr],gr[xr]=null,mn=gr[--xr],gr[xr]=null}var lr=null,cr=null,ot=!1,Nr=null;function Dm(o,c){var m=wr(5,null,null,0);m.elementType="DELETED",m.stateNode=c,m.return=o,c=o.deletions,c===null?(o.deletions=[m],o.flags|=16):c.push(m)}function Pm(o,c){switch(o.tag){case 5:var m=o.type;return c=c.nodeType!==1||m.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,lr=o,cr=Hn(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,lr=o,cr=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(m=ws!==null?{id:mn,overflow:pn}:null,o.memoizedState={dehydrated:c,treeContext:m,retryLane:1073741824},m=wr(18,null,null,0),m.stateNode=c,m.return=o,o.child=m,lr=o,cr=null,!0):!1;default:return!1}}function zu(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Wu(o){if(ot){var c=cr;if(c){var m=c;if(!Pm(o,c)){if(zu(o))throw Error(t(418));c=Hn(m.nextSibling);var v=lr;c&&Pm(o,c)?Dm(v,m):(o.flags=o.flags&-4097|2,ot=!1,lr=o)}}else{if(zu(o))throw Error(t(418));o.flags=o.flags&-4097|2,ot=!1,lr=o}}}function Om(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;lr=o}function Zo(o){if(o!==lr)return!1;if(!ot)return Om(o),ot=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!Uu(o.type,o.memoizedProps)),c&&(c=cr)){if(zu(o))throw jm(),Error(t(418));for(;c;)Dm(o,c),c=Hn(c.nextSibling)}if(Om(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var m=o.data;if(m==="/$"){if(c===0){cr=Hn(o.nextSibling);break e}c--}else m!=="$"&&m!=="$!"&&m!=="$?"||c++}o=o.nextSibling}cr=null}}else cr=lr?Hn(o.stateNode.nextSibling):null;return!0}function jm(){for(var o=cr;o;)o=Hn(o.nextSibling)}function di(){cr=lr=null,ot=!1}function Yu(o){Nr===null?Nr=[o]:Nr.push(o)}var Bb=I.ReactCurrentBatchConfig;function ba(o,c,m){if(o=m.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(t(309));var v=m.stateNode}if(!v)throw Error(t(147,o));var b=v,_=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===_?c.ref:(c=function(A){var M=b.refs;A===null?delete M[_]:M[_]=A},c._stringRef=_,c)}if(typeof o!="string")throw Error(t(284));if(!m._owner)throw Error(t(290,o))}return o}function Jo(o,c){throw o=Object.prototype.toString.call(c),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function Mm(o){var c=o._init;return c(o._payload)}function Fm(o){function c(K,V){if(o){var z=K.deletions;z===null?(K.deletions=[V],K.flags|=16):z.push(V)}}function m(K,V){if(!o)return null;for(;V!==null;)c(K,V),V=V.sibling;return null}function v(K,V){for(K=new Map;V!==null;)V.key!==null?K.set(V.key,V):K.set(V.index,V),V=V.sibling;return K}function b(K,V){return K=ts(K,V),K.index=0,K.sibling=null,K}function _(K,V,z){return K.index=z,o?(z=K.alternate,z!==null?(z=z.index,z<V?(K.flags|=2,V):z):(K.flags|=2,V)):(K.flags|=1048576,V)}function A(K){return o&&K.alternate===null&&(K.flags|=2),K}function M(K,V,z,fe){return V===null||V.tag!==6?(V=Bd(z,K.mode,fe),V.return=K,V):(V=b(V,z),V.return=K,V)}function B(K,V,z,fe){var _e=z.type;return _e===P?oe(K,V,z.props.children,fe,z.key):V!==null&&(V.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Z&&Mm(_e)===V.type)?(fe=b(V,z.props),fe.ref=ba(K,V,z),fe.return=K,fe):(fe=Sl(z.type,z.key,z.props,null,K.mode,fe),fe.ref=ba(K,V,z),fe.return=K,fe)}function Y(K,V,z,fe){return V===null||V.tag!==4||V.stateNode.containerInfo!==z.containerInfo||V.stateNode.implementation!==z.implementation?(V=$d(z,K.mode,fe),V.return=K,V):(V=b(V,z.children||[]),V.return=K,V)}function oe(K,V,z,fe,_e){return V===null||V.tag!==7?(V=Ls(z,K.mode,fe,_e),V.return=K,V):(V=b(V,z),V.return=K,V)}function ce(K,V,z){if(typeof V=="string"&&V!==""||typeof V=="number")return V=Bd(""+V,K.mode,z),V.return=K,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case L:return z=Sl(V.type,V.key,V.props,null,K.mode,z),z.ref=ba(K,null,V),z.return=K,z;case O:return V=$d(V,K.mode,z),V.return=K,V;case Z:var fe=V._init;return ce(K,fe(V._payload),z)}if(Ve(V)||Q(V))return V=Ls(V,K.mode,z,null),V.return=K,V;Jo(K,V)}return null}function ae(K,V,z,fe){var _e=V!==null?V.key:null;if(typeof z=="string"&&z!==""||typeof z=="number")return _e!==null?null:M(K,V,""+z,fe);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case L:return z.key===_e?B(K,V,z,fe):null;case O:return z.key===_e?Y(K,V,z,fe):null;case Z:return _e=z._init,ae(K,V,_e(z._payload),fe)}if(Ve(z)||Q(z))return _e!==null?null:oe(K,V,z,fe,null);Jo(K,z)}return null}function ve(K,V,z,fe,_e){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return K=K.get(z)||null,M(V,K,""+fe,_e);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case L:return K=K.get(fe.key===null?z:fe.key)||null,B(V,K,fe,_e);case O:return K=K.get(fe.key===null?z:fe.key)||null,Y(V,K,fe,_e);case Z:var Ce=fe._init;return ve(K,V,z,Ce(fe._payload),_e)}if(Ve(fe)||Q(fe))return K=K.get(z)||null,oe(V,K,fe,_e,null);Jo(V,fe)}return null}function be(K,V,z,fe){for(var _e=null,Ce=null,Ie=V,Le=V=0,Dt=null;Ie!==null&&Le<z.length;Le++){Ie.index>Le?(Dt=Ie,Ie=null):Dt=Ie.sibling;var ze=ae(K,Ie,z[Le],fe);if(ze===null){Ie===null&&(Ie=Dt);break}o&&Ie&&ze.alternate===null&&c(K,Ie),V=_(ze,V,Le),Ce===null?_e=ze:Ce.sibling=ze,Ce=ze,Ie=Dt}if(Le===z.length)return m(K,Ie),ot&&bs(K,Le),_e;if(Ie===null){for(;Le<z.length;Le++)Ie=ce(K,z[Le],fe),Ie!==null&&(V=_(Ie,V,Le),Ce===null?_e=Ie:Ce.sibling=Ie,Ce=Ie);return ot&&bs(K,Le),_e}for(Ie=v(K,Ie);Le<z.length;Le++)Dt=ve(Ie,K,Le,z[Le],fe),Dt!==null&&(o&&Dt.alternate!==null&&Ie.delete(Dt.key===null?Le:Dt.key),V=_(Dt,V,Le),Ce===null?_e=Dt:Ce.sibling=Dt,Ce=Dt);return o&&Ie.forEach(function(rs){return c(K,rs)}),ot&&bs(K,Le),_e}function Se(K,V,z,fe){var _e=Q(z);if(typeof _e!="function")throw Error(t(150));if(z=_e.call(z),z==null)throw Error(t(151));for(var Ce=_e=null,Ie=V,Le=V=0,Dt=null,ze=z.next();Ie!==null&&!ze.done;Le++,ze=z.next()){Ie.index>Le?(Dt=Ie,Ie=null):Dt=Ie.sibling;var rs=ae(K,Ie,ze.value,fe);if(rs===null){Ie===null&&(Ie=Dt);break}o&&Ie&&rs.alternate===null&&c(K,Ie),V=_(rs,V,Le),Ce===null?_e=rs:Ce.sibling=rs,Ce=rs,Ie=Dt}if(ze.done)return m(K,Ie),ot&&bs(K,Le),_e;if(Ie===null){for(;!ze.done;Le++,ze=z.next())ze=ce(K,ze.value,fe),ze!==null&&(V=_(ze,V,Le),Ce===null?_e=ze:Ce.sibling=ze,Ce=ze);return ot&&bs(K,Le),_e}for(Ie=v(K,Ie);!ze.done;Le++,ze=z.next())ze=ve(Ie,K,Le,ze.value,fe),ze!==null&&(o&&ze.alternate!==null&&Ie.delete(ze.key===null?Le:ze.key),V=_(ze,V,Le),Ce===null?_e=ze:Ce.sibling=ze,Ce=ze);return o&&Ie.forEach(function(yS){return c(K,yS)}),ot&&bs(K,Le),_e}function Et(K,V,z,fe){if(typeof z=="object"&&z!==null&&z.type===P&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case L:e:{for(var _e=z.key,Ce=V;Ce!==null;){if(Ce.key===_e){if(_e=z.type,_e===P){if(Ce.tag===7){m(K,Ce.sibling),V=b(Ce,z.props.children),V.return=K,K=V;break e}}else if(Ce.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Z&&Mm(_e)===Ce.type){m(K,Ce.sibling),V=b(Ce,z.props),V.ref=ba(K,Ce,z),V.return=K,K=V;break e}m(K,Ce);break}else c(K,Ce);Ce=Ce.sibling}z.type===P?(V=Ls(z.props.children,K.mode,fe,z.key),V.return=K,K=V):(fe=Sl(z.type,z.key,z.props,null,K.mode,fe),fe.ref=ba(K,V,z),fe.return=K,K=fe)}return A(K);case O:e:{for(Ce=z.key;V!==null;){if(V.key===Ce)if(V.tag===4&&V.stateNode.containerInfo===z.containerInfo&&V.stateNode.implementation===z.implementation){m(K,V.sibling),V=b(V,z.children||[]),V.return=K,K=V;break e}else{m(K,V);break}else c(K,V);V=V.sibling}V=$d(z,K.mode,fe),V.return=K,K=V}return A(K);case Z:return Ce=z._init,Et(K,V,Ce(z._payload),fe)}if(Ve(z))return be(K,V,z,fe);if(Q(z))return Se(K,V,z,fe);Jo(K,z)}return typeof z=="string"&&z!==""||typeof z=="number"?(z=""+z,V!==null&&V.tag===6?(m(K,V.sibling),V=b(V,z),V.return=K,K=V):(m(K,V),V=Bd(z,K.mode,fe),V.return=K,K=V),A(K)):m(K,V)}return Et}var fi=Fm(!0),Um=Fm(!1),el=qn(null),tl=null,hi=null,Qu=null;function Xu(){Qu=hi=tl=null}function Zu(o){var c=el.current;it(el),o._currentValue=c}function Ju(o,c,m){for(;o!==null;){var v=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),o===m)break;o=o.return}}function mi(o,c){tl=o,Qu=hi=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&c)!==0&&(Jt=!0),o.firstContext=null)}function vr(o){var c=o._currentValue;if(Qu!==o)if(o={context:o,memoizedValue:c,next:null},hi===null){if(tl===null)throw Error(t(308));hi=o,tl.dependencies={lanes:0,firstContext:o}}else hi=hi.next=o;return c}var Ss=null;function ed(o){Ss===null?Ss=[o]:Ss.push(o)}function Bm(o,c,m,v){var b=c.interleaved;return b===null?(m.next=m,ed(c)):(m.next=b.next,b.next=m),c.interleaved=m,gn(o,v)}function gn(o,c){o.lanes|=c;var m=o.alternate;for(m!==null&&(m.lanes|=c),m=o,o=o.return;o!==null;)o.childLanes|=c,m=o.alternate,m!==null&&(m.childLanes|=c),m=o,o=o.return;return m.tag===3?m.stateNode:null}var Wn=!1;function td(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $m(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function xn(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Yn(o,c,m){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(qe&2)!==0){var b=v.pending;return b===null?c.next=c:(c.next=b.next,b.next=c),v.pending=c,gn(o,m)}return b=v.interleaved,b===null?(c.next=c,ed(v)):(c.next=b.next,b.next=c),v.interleaved=c,gn(o,m)}function rl(o,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194240)!==0)){var v=c.lanes;v&=o.pendingLanes,m|=v,c.lanes=m,pu(o,m)}}function Vm(o,c){var m=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,m===v)){var b=null,_=null;if(m=m.firstBaseUpdate,m!==null){do{var A={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};_===null?b=_=A:_=_.next=A,m=m.next}while(m!==null);_===null?b=_=c:_=_.next=c}else b=_=c;m={baseState:v.baseState,firstBaseUpdate:b,lastBaseUpdate:_,shared:v.shared,effects:v.effects},o.updateQueue=m;return}o=m.lastBaseUpdate,o===null?m.firstBaseUpdate=c:o.next=c,m.lastBaseUpdate=c}function nl(o,c,m,v){var b=o.updateQueue;Wn=!1;var _=b.firstBaseUpdate,A=b.lastBaseUpdate,M=b.shared.pending;if(M!==null){b.shared.pending=null;var B=M,Y=B.next;B.next=null,A===null?_=Y:A.next=Y,A=B;var oe=o.alternate;oe!==null&&(oe=oe.updateQueue,M=oe.lastBaseUpdate,M!==A&&(M===null?oe.firstBaseUpdate=Y:M.next=Y,oe.lastBaseUpdate=B))}if(_!==null){var ce=b.baseState;A=0,oe=Y=B=null,M=_;do{var ae=M.lane,ve=M.eventTime;if((v&ae)===ae){oe!==null&&(oe=oe.next={eventTime:ve,lane:0,tag:M.tag,payload:M.payload,callback:M.callback,next:null});e:{var be=o,Se=M;switch(ae=c,ve=m,Se.tag){case 1:if(be=Se.payload,typeof be=="function"){ce=be.call(ve,ce,ae);break e}ce=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Se.payload,ae=typeof be=="function"?be.call(ve,ce,ae):be,ae==null)break e;ce=W({},ce,ae);break e;case 2:Wn=!0}}M.callback!==null&&M.lane!==0&&(o.flags|=64,ae=b.effects,ae===null?b.effects=[M]:ae.push(M))}else ve={eventTime:ve,lane:ae,tag:M.tag,payload:M.payload,callback:M.callback,next:null},oe===null?(Y=oe=ve,B=ce):oe=oe.next=ve,A|=ae;if(M=M.next,M===null){if(M=b.shared.pending,M===null)break;ae=M,M=ae.next,ae.next=null,b.lastBaseUpdate=ae,b.shared.pending=null}}while(!0);if(oe===null&&(B=ce),b.baseState=B,b.firstBaseUpdate=Y,b.lastBaseUpdate=oe,c=b.shared.interleaved,c!==null){b=c;do A|=b.lane,b=b.next;while(b!==c)}else _===null&&(b.shared.lanes=0);ks|=A,o.lanes=A,o.memoizedState=ce}}function Gm(o,c,m){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var v=o[c],b=v.callback;if(b!==null){if(v.callback=null,v=m,typeof b!="function")throw Error(t(191,b));b.call(v)}}}var Sa={},qr=qn(Sa),Ta=qn(Sa),_a=qn(Sa);function Ts(o){if(o===Sa)throw Error(t(174));return o}function rd(o,c){switch(rt(_a,c),rt(Ta,o),rt(qr,Sa),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Ys(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=Ys(c,o)}it(qr),rt(qr,c)}function pi(){it(qr),it(Ta),it(_a)}function Hm(o){Ts(_a.current);var c=Ts(qr.current),m=Ys(c,o.type);c!==m&&(rt(Ta,o),rt(qr,m))}function nd(o){Ta.current===o&&(it(qr),it(Ta))}var ct=qn(0);function sl(o){for(var c=o;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var sd=[];function id(){for(var o=0;o<sd.length;o++)sd[o]._workInProgressVersionPrimary=null;sd.length=0}var il=I.ReactCurrentDispatcher,ad=I.ReactCurrentBatchConfig,_s=0,ut=null,_t=null,Rt=null,al=!1,ka=!1,Ca=0,$b=0;function Ht(){throw Error(t(321))}function od(o,c){if(c===null)return!1;for(var m=0;m<c.length&&m<o.length;m++)if(!Rr(o[m],c[m]))return!1;return!0}function ld(o,c,m,v,b,_){if(_s=_,ut=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,il.current=o===null||o.memoizedState===null?qb:Kb,o=m(v,b),ka){_=0;do{if(ka=!1,Ca=0,25<=_)throw Error(t(301));_+=1,Rt=_t=null,c.updateQueue=null,il.current=zb,o=m(v,b)}while(ka)}if(il.current=cl,c=_t!==null&&_t.next!==null,_s=0,Rt=_t=ut=null,al=!1,c)throw Error(t(300));return o}function cd(){var o=Ca!==0;return Ca=0,o}function Kr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?ut.memoizedState=Rt=o:Rt=Rt.next=o,Rt}function yr(){if(_t===null){var o=ut.alternate;o=o!==null?o.memoizedState:null}else o=_t.next;var c=Rt===null?ut.memoizedState:Rt.next;if(c!==null)Rt=c,_t=o;else{if(o===null)throw Error(t(310));_t=o,o={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Rt===null?ut.memoizedState=Rt=o:Rt=Rt.next=o}return Rt}function Ia(o,c){return typeof c=="function"?c(o):c}function ud(o){var c=yr(),m=c.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=o;var v=_t,b=v.baseQueue,_=m.pending;if(_!==null){if(b!==null){var A=b.next;b.next=_.next,_.next=A}v.baseQueue=b=_,m.pending=null}if(b!==null){_=b.next,v=v.baseState;var M=A=null,B=null,Y=_;do{var oe=Y.lane;if((_s&oe)===oe)B!==null&&(B=B.next={lane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),v=Y.hasEagerState?Y.eagerState:o(v,Y.action);else{var ce={lane:oe,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null};B===null?(M=B=ce,A=v):B=B.next=ce,ut.lanes|=oe,ks|=oe}Y=Y.next}while(Y!==null&&Y!==_);B===null?A=v:B.next=M,Rr(v,c.memoizedState)||(Jt=!0),c.memoizedState=v,c.baseState=A,c.baseQueue=B,m.lastRenderedState=v}if(o=m.interleaved,o!==null){b=o;do _=b.lane,ut.lanes|=_,ks|=_,b=b.next;while(b!==o)}else b===null&&(m.lanes=0);return[c.memoizedState,m.dispatch]}function dd(o){var c=yr(),m=c.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=o;var v=m.dispatch,b=m.pending,_=c.memoizedState;if(b!==null){m.pending=null;var A=b=b.next;do _=o(_,A.action),A=A.next;while(A!==b);Rr(_,c.memoizedState)||(Jt=!0),c.memoizedState=_,c.baseQueue===null&&(c.baseState=_),m.lastRenderedState=_}return[_,v]}function qm(){}function Km(o,c){var m=ut,v=yr(),b=c(),_=!Rr(v.memoizedState,b);if(_&&(v.memoizedState=b,Jt=!0),v=v.queue,fd(Ym.bind(null,m,v,o),[o]),v.getSnapshot!==c||_||Rt!==null&&Rt.memoizedState.tag&1){if(m.flags|=2048,Aa(9,Wm.bind(null,m,v,b,c),void 0,null),Nt===null)throw Error(t(349));(_s&30)!==0||zm(m,c,b)}return b}function zm(o,c,m){o.flags|=16384,o={getSnapshot:c,value:m},c=ut.updateQueue,c===null?(c={lastEffect:null,stores:null},ut.updateQueue=c,c.stores=[o]):(m=c.stores,m===null?c.stores=[o]:m.push(o))}function Wm(o,c,m,v){c.value=m,c.getSnapshot=v,Qm(c)&&Xm(o)}function Ym(o,c,m){return m(function(){Qm(c)&&Xm(o)})}function Qm(o){var c=o.getSnapshot;o=o.value;try{var m=c();return!Rr(o,m)}catch{return!0}}function Xm(o){var c=gn(o,1);c!==null&&jr(c,o,1,-1)}function Zm(o){var c=Kr();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:o},c.queue=o,o=o.dispatch=Hb.bind(null,ut,o),[c.memoizedState,o]}function Aa(o,c,m,v){return o={tag:o,create:c,destroy:m,deps:v,next:null},c=ut.updateQueue,c===null?(c={lastEffect:null,stores:null},ut.updateQueue=c,c.lastEffect=o.next=o):(m=c.lastEffect,m===null?c.lastEffect=o.next=o:(v=m.next,m.next=o,o.next=v,c.lastEffect=o)),o}function Jm(){return yr().memoizedState}function ol(o,c,m,v){var b=Kr();ut.flags|=o,b.memoizedState=Aa(1|c,m,void 0,v===void 0?null:v)}function ll(o,c,m,v){var b=yr();v=v===void 0?null:v;var _=void 0;if(_t!==null){var A=_t.memoizedState;if(_=A.destroy,v!==null&&od(v,A.deps)){b.memoizedState=Aa(c,m,_,v);return}}ut.flags|=o,b.memoizedState=Aa(1|c,m,_,v)}function ep(o,c){return ol(8390656,8,o,c)}function fd(o,c){return ll(2048,8,o,c)}function tp(o,c){return ll(4,2,o,c)}function rp(o,c){return ll(4,4,o,c)}function np(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function sp(o,c,m){return m=m!=null?m.concat([o]):null,ll(4,4,np.bind(null,c,o),m)}function hd(){}function ip(o,c){var m=yr();c=c===void 0?null:c;var v=m.memoizedState;return v!==null&&c!==null&&od(c,v[1])?v[0]:(m.memoizedState=[o,c],o)}function ap(o,c){var m=yr();c=c===void 0?null:c;var v=m.memoizedState;return v!==null&&c!==null&&od(c,v[1])?v[0]:(o=o(),m.memoizedState=[o,c],o)}function op(o,c,m){return(_s&21)===0?(o.baseState&&(o.baseState=!1,Jt=!0),o.memoizedState=m):(Rr(m,c)||(m=M0(),ut.lanes|=m,ks|=m,o.baseState=!0),c)}function Vb(o,c){var m=We;We=m!==0&&4>m?m:4,o(!0);var v=ad.transition;ad.transition={};try{o(!1),c()}finally{We=m,ad.transition=v}}function lp(){return yr().memoizedState}function Gb(o,c,m){var v=Jn(o);if(m={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null},cp(o))up(c,m);else if(m=Bm(o,c,m,v),m!==null){var b=Yt();jr(m,o,v,b),dp(m,c,v)}}function Hb(o,c,m){var v=Jn(o),b={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null};if(cp(o))up(c,b);else{var _=o.alternate;if(o.lanes===0&&(_===null||_.lanes===0)&&(_=c.lastRenderedReducer,_!==null))try{var A=c.lastRenderedState,M=_(A,m);if(b.hasEagerState=!0,b.eagerState=M,Rr(M,A)){var B=c.interleaved;B===null?(b.next=b,ed(c)):(b.next=B.next,B.next=b),c.interleaved=b;return}}catch{}finally{}m=Bm(o,c,b,v),m!==null&&(b=Yt(),jr(m,o,v,b),dp(m,c,v))}}function cp(o){var c=o.alternate;return o===ut||c!==null&&c===ut}function up(o,c){ka=al=!0;var m=o.pending;m===null?c.next=c:(c.next=m.next,m.next=c),o.pending=c}function dp(o,c,m){if((m&4194240)!==0){var v=c.lanes;v&=o.pendingLanes,m|=v,c.lanes=m,pu(o,m)}}var cl={readContext:vr,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useInsertionEffect:Ht,useLayoutEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useMutableSource:Ht,useSyncExternalStore:Ht,useId:Ht,unstable_isNewReconciler:!1},qb={readContext:vr,useCallback:function(o,c){return Kr().memoizedState=[o,c===void 0?null:c],o},useContext:vr,useEffect:ep,useImperativeHandle:function(o,c,m){return m=m!=null?m.concat([o]):null,ol(4194308,4,np.bind(null,c,o),m)},useLayoutEffect:function(o,c){return ol(4194308,4,o,c)},useInsertionEffect:function(o,c){return ol(4,2,o,c)},useMemo:function(o,c){var m=Kr();return c=c===void 0?null:c,o=o(),m.memoizedState=[o,c],o},useReducer:function(o,c,m){var v=Kr();return c=m!==void 0?m(c):c,v.memoizedState=v.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},v.queue=o,o=o.dispatch=Gb.bind(null,ut,o),[v.memoizedState,o]},useRef:function(o){var c=Kr();return o={current:o},c.memoizedState=o},useState:Zm,useDebugValue:hd,useDeferredValue:function(o){return Kr().memoizedState=o},useTransition:function(){var o=Zm(!1),c=o[0];return o=Vb.bind(null,o[1]),Kr().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,m){var v=ut,b=Kr();if(ot){if(m===void 0)throw Error(t(407));m=m()}else{if(m=c(),Nt===null)throw Error(t(349));(_s&30)!==0||zm(v,c,m)}b.memoizedState=m;var _={value:m,getSnapshot:c};return b.queue=_,ep(Ym.bind(null,v,_,o),[o]),v.flags|=2048,Aa(9,Wm.bind(null,v,_,m,c),void 0,null),m},useId:function(){var o=Kr(),c=Nt.identifierPrefix;if(ot){var m=pn,v=mn;m=(v&~(1<<32-Lr(v)-1)).toString(32)+m,c=":"+c+"R"+m,m=Ca++,0<m&&(c+="H"+m.toString(32)),c+=":"}else m=$b++,c=":"+c+"r"+m.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},Kb={readContext:vr,useCallback:ip,useContext:vr,useEffect:fd,useImperativeHandle:sp,useInsertionEffect:tp,useLayoutEffect:rp,useMemo:ap,useReducer:ud,useRef:Jm,useState:function(){return ud(Ia)},useDebugValue:hd,useDeferredValue:function(o){var c=yr();return op(c,_t.memoizedState,o)},useTransition:function(){var o=ud(Ia)[0],c=yr().memoizedState;return[o,c]},useMutableSource:qm,useSyncExternalStore:Km,useId:lp,unstable_isNewReconciler:!1},zb={readContext:vr,useCallback:ip,useContext:vr,useEffect:fd,useImperativeHandle:sp,useInsertionEffect:tp,useLayoutEffect:rp,useMemo:ap,useReducer:dd,useRef:Jm,useState:function(){return dd(Ia)},useDebugValue:hd,useDeferredValue:function(o){var c=yr();return _t===null?c.memoizedState=o:op(c,_t.memoizedState,o)},useTransition:function(){var o=dd(Ia)[0],c=yr().memoizedState;return[o,c]},useMutableSource:qm,useSyncExternalStore:Km,useId:lp,unstable_isNewReconciler:!1};function Dr(o,c){if(o&&o.defaultProps){c=W({},c),o=o.defaultProps;for(var m in o)c[m]===void 0&&(c[m]=o[m]);return c}return c}function md(o,c,m,v){c=o.memoizedState,m=m(v,c),m=m==null?c:W({},c,m),o.memoizedState=m,o.lanes===0&&(o.updateQueue.baseState=m)}var ul={isMounted:function(o){return(o=o._reactInternals)?vs(o)===o:!1},enqueueSetState:function(o,c,m){o=o._reactInternals;var v=Yt(),b=Jn(o),_=xn(v,b);_.payload=c,m!=null&&(_.callback=m),c=Yn(o,_,b),c!==null&&(jr(c,o,b,v),rl(c,o,b))},enqueueReplaceState:function(o,c,m){o=o._reactInternals;var v=Yt(),b=Jn(o),_=xn(v,b);_.tag=1,_.payload=c,m!=null&&(_.callback=m),c=Yn(o,_,b),c!==null&&(jr(c,o,b,v),rl(c,o,b))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var m=Yt(),v=Jn(o),b=xn(m,v);b.tag=2,c!=null&&(b.callback=c),c=Yn(o,b,v),c!==null&&(jr(c,o,v,m),rl(c,o,v))}};function fp(o,c,m,v,b,_,A){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,_,A):c.prototype&&c.prototype.isPureReactComponent?!pa(m,v)||!pa(b,_):!0}function hp(o,c,m){var v=!1,b=Kn,_=c.contextType;return typeof _=="object"&&_!==null?_=vr(_):(b=Zt(c)?Es:Gt.current,v=c.contextTypes,_=(v=v!=null)?li(o,b):Kn),c=new c(m,_),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=ul,o.stateNode=c,c._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=b,o.__reactInternalMemoizedMaskedChildContext=_),c}function mp(o,c,m,v){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,v),c.state!==o&&ul.enqueueReplaceState(c,c.state,null)}function pd(o,c,m,v){var b=o.stateNode;b.props=m,b.state=o.memoizedState,b.refs={},td(o);var _=c.contextType;typeof _=="object"&&_!==null?b.context=vr(_):(_=Zt(c)?Es:Gt.current,b.context=li(o,_)),b.state=o.memoizedState,_=c.getDerivedStateFromProps,typeof _=="function"&&(md(o,c,_,m),b.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(c=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),c!==b.state&&ul.enqueueReplaceState(b,b.state,null),nl(o,m,b,v),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308)}function gi(o,c){try{var m="",v=c;do m+=ue(v),v=v.return;while(v);var b=m}catch(_){b=`
Error generating stack: `+_.message+`
`+_.stack}return{value:o,source:c,stack:b,digest:null}}function gd(o,c,m){return{value:o,source:null,stack:m??null,digest:c??null}}function xd(o,c){try{console.error(c.value)}catch(m){setTimeout(function(){throw m})}}var Wb=typeof WeakMap=="function"?WeakMap:Map;function pp(o,c,m){m=xn(-1,m),m.tag=3,m.payload={element:null};var v=c.value;return m.callback=function(){xl||(xl=!0,Nd=v),xd(o,c)},m}function gp(o,c,m){m=xn(-1,m),m.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var b=c.value;m.payload=function(){return v(b)},m.callback=function(){xd(o,c)}}var _=o.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(m.callback=function(){xd(o,c),typeof v!="function"&&(Xn===null?Xn=new Set([this]):Xn.add(this));var A=c.stack;this.componentDidCatch(c.value,{componentStack:A!==null?A:""})}),m}function xp(o,c,m){var v=o.pingCache;if(v===null){v=o.pingCache=new Wb;var b=new Set;v.set(c,b)}else b=v.get(c),b===void 0&&(b=new Set,v.set(c,b));b.has(m)||(b.add(m),o=lS.bind(null,o,c,m),c.then(o,o))}function vp(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function yp(o,c,m,v,b){return(o.mode&1)===0?(o===c?o.flags|=65536:(o.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(c=xn(-1,1),c.tag=2,Yn(m,c,1))),m.lanes|=1),o):(o.flags|=65536,o.lanes=b,o)}var Yb=I.ReactCurrentOwner,Jt=!1;function Wt(o,c,m,v){c.child=o===null?Um(c,null,m,v):fi(c,o.child,m,v)}function Ep(o,c,m,v,b){m=m.render;var _=c.ref;return mi(c,b),v=ld(o,c,m,v,_,b),m=cd(),o!==null&&!Jt?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~b,vn(o,c,b)):(ot&&m&&qu(c),c.flags|=1,Wt(o,c,v,b),c.child)}function wp(o,c,m,v,b){if(o===null){var _=m.type;return typeof _=="function"&&!Ud(_)&&_.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(c.tag=15,c.type=_,bp(o,c,_,v,b)):(o=Sl(m.type,null,v,c,c.mode,b),o.ref=c.ref,o.return=c,c.child=o)}if(_=o.child,(o.lanes&b)===0){var A=_.memoizedProps;if(m=m.compare,m=m!==null?m:pa,m(A,v)&&o.ref===c.ref)return vn(o,c,b)}return c.flags|=1,o=ts(_,v),o.ref=c.ref,o.return=c,c.child=o}function bp(o,c,m,v,b){if(o!==null){var _=o.memoizedProps;if(pa(_,v)&&o.ref===c.ref)if(Jt=!1,c.pendingProps=v=_,(o.lanes&b)!==0)(o.flags&131072)!==0&&(Jt=!0);else return c.lanes=o.lanes,vn(o,c,b)}return vd(o,c,m,v,b)}function Sp(o,c,m){var v=c.pendingProps,b=v.children,_=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt(vi,ur),ur|=m;else{if((m&1073741824)===0)return o=_!==null?_.baseLanes|m:m,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,rt(vi,ur),ur|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=_!==null?_.baseLanes:m,rt(vi,ur),ur|=v}else _!==null?(v=_.baseLanes|m,c.memoizedState=null):v=m,rt(vi,ur),ur|=v;return Wt(o,c,b,m),c.child}function Tp(o,c){var m=c.ref;(o===null&&m!==null||o!==null&&o.ref!==m)&&(c.flags|=512,c.flags|=2097152)}function vd(o,c,m,v,b){var _=Zt(m)?Es:Gt.current;return _=li(c,_),mi(c,b),m=ld(o,c,m,v,_,b),v=cd(),o!==null&&!Jt?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~b,vn(o,c,b)):(ot&&v&&qu(c),c.flags|=1,Wt(o,c,m,b),c.child)}function _p(o,c,m,v,b){if(Zt(m)){var _=!0;Wo(c)}else _=!1;if(mi(c,b),c.stateNode===null)fl(o,c),hp(c,m,v),pd(c,m,v,b),v=!0;else if(o===null){var A=c.stateNode,M=c.memoizedProps;A.props=M;var B=A.context,Y=m.contextType;typeof Y=="object"&&Y!==null?Y=vr(Y):(Y=Zt(m)?Es:Gt.current,Y=li(c,Y));var oe=m.getDerivedStateFromProps,ce=typeof oe=="function"||typeof A.getSnapshotBeforeUpdate=="function";ce||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(M!==v||B!==Y)&&mp(c,A,v,Y),Wn=!1;var ae=c.memoizedState;A.state=ae,nl(c,v,A,b),B=c.memoizedState,M!==v||ae!==B||Xt.current||Wn?(typeof oe=="function"&&(md(c,m,oe,v),B=c.memoizedState),(M=Wn||fp(c,m,M,v,ae,B,Y))?(ce||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=B),A.props=v,A.state=B,A.context=Y,v=M):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{A=c.stateNode,$m(o,c),M=c.memoizedProps,Y=c.type===c.elementType?M:Dr(c.type,M),A.props=Y,ce=c.pendingProps,ae=A.context,B=m.contextType,typeof B=="object"&&B!==null?B=vr(B):(B=Zt(m)?Es:Gt.current,B=li(c,B));var ve=m.getDerivedStateFromProps;(oe=typeof ve=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(M!==ce||ae!==B)&&mp(c,A,v,B),Wn=!1,ae=c.memoizedState,A.state=ae,nl(c,v,A,b);var be=c.memoizedState;M!==ce||ae!==be||Xt.current||Wn?(typeof ve=="function"&&(md(c,m,ve,v),be=c.memoizedState),(Y=Wn||fp(c,m,Y,v,ae,be,B)||!1)?(oe||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(v,be,B),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(v,be,B)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||M===o.memoizedProps&&ae===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||M===o.memoizedProps&&ae===o.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=be),A.props=v,A.state=be,A.context=B,v=Y):(typeof A.componentDidUpdate!="function"||M===o.memoizedProps&&ae===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||M===o.memoizedProps&&ae===o.memoizedState||(c.flags|=1024),v=!1)}return yd(o,c,m,v,_,b)}function yd(o,c,m,v,b,_){Tp(o,c);var A=(c.flags&128)!==0;if(!v&&!A)return b&&Lm(c,m,!1),vn(o,c,_);v=c.stateNode,Yb.current=c;var M=A&&typeof m.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,o!==null&&A?(c.child=fi(c,o.child,null,_),c.child=fi(c,null,M,_)):Wt(o,c,M,_),c.memoizedState=v.state,b&&Lm(c,m,!0),c.child}function kp(o){var c=o.stateNode;c.pendingContext?Im(o,c.pendingContext,c.pendingContext!==c.context):c.context&&Im(o,c.context,!1),rd(o,c.containerInfo)}function Cp(o,c,m,v,b){return di(),Yu(b),c.flags|=256,Wt(o,c,m,v),c.child}var Ed={dehydrated:null,treeContext:null,retryLane:0};function wd(o){return{baseLanes:o,cachePool:null,transitions:null}}function Ip(o,c,m){var v=c.pendingProps,b=ct.current,_=!1,A=(c.flags&128)!==0,M;if((M=A)||(M=o!==null&&o.memoizedState===null?!1:(b&2)!==0),M?(_=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&(b|=1),rt(ct,b&1),o===null)return Wu(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((c.mode&1)===0?c.lanes=1:o.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(A=v.children,o=v.fallback,_?(v=c.mode,_=c.child,A={mode:"hidden",children:A},(v&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=A):_=Tl(A,v,0,null),o=Ls(o,v,m,null),_.return=c,o.return=c,_.sibling=o,c.child=_,c.child.memoizedState=wd(m),c.memoizedState=Ed,o):bd(c,A));if(b=o.memoizedState,b!==null&&(M=b.dehydrated,M!==null))return Qb(o,c,A,v,M,b,m);if(_){_=v.fallback,A=c.mode,b=o.child,M=b.sibling;var B={mode:"hidden",children:v.children};return(A&1)===0&&c.child!==b?(v=c.child,v.childLanes=0,v.pendingProps=B,c.deletions=null):(v=ts(b,B),v.subtreeFlags=b.subtreeFlags&14680064),M!==null?_=ts(M,_):(_=Ls(_,A,m,null),_.flags|=2),_.return=c,v.return=c,v.sibling=_,c.child=v,v=_,_=c.child,A=o.child.memoizedState,A=A===null?wd(m):{baseLanes:A.baseLanes|m,cachePool:null,transitions:A.transitions},_.memoizedState=A,_.childLanes=o.childLanes&~m,c.memoizedState=Ed,v}return _=o.child,o=_.sibling,v=ts(_,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=m),v.return=c,v.sibling=null,o!==null&&(m=c.deletions,m===null?(c.deletions=[o],c.flags|=16):m.push(o)),c.child=v,c.memoizedState=null,v}function bd(o,c){return c=Tl({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function dl(o,c,m,v){return v!==null&&Yu(v),fi(c,o.child,null,m),o=bd(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function Qb(o,c,m,v,b,_,A){if(m)return c.flags&256?(c.flags&=-257,v=gd(Error(t(422))),dl(o,c,A,v)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(_=v.fallback,b=c.mode,v=Tl({mode:"visible",children:v.children},b,0,null),_=Ls(_,b,A,null),_.flags|=2,v.return=c,_.return=c,v.sibling=_,c.child=v,(c.mode&1)!==0&&fi(c,o.child,null,A),c.child.memoizedState=wd(A),c.memoizedState=Ed,_);if((c.mode&1)===0)return dl(o,c,A,null);if(b.data==="$!"){if(v=b.nextSibling&&b.nextSibling.dataset,v)var M=v.dgst;return v=M,_=Error(t(419)),v=gd(_,v,void 0),dl(o,c,A,v)}if(M=(A&o.childLanes)!==0,Jt||M){if(v=Nt,v!==null){switch(A&-A){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(v.suspendedLanes|A))!==0?0:b,b!==0&&b!==_.retryLane&&(_.retryLane=b,gn(o,b),jr(v,o,b,-1))}return Fd(),v=gd(Error(t(421))),dl(o,c,A,v)}return b.data==="$?"?(c.flags|=128,c.child=o.child,c=cS.bind(null,o),b._reactRetry=c,null):(o=_.treeContext,cr=Hn(b.nextSibling),lr=c,ot=!0,Nr=null,o!==null&&(gr[xr++]=mn,gr[xr++]=pn,gr[xr++]=ws,mn=o.id,pn=o.overflow,ws=c),c=bd(c,v.children),c.flags|=4096,c)}function Ap(o,c,m){o.lanes|=c;var v=o.alternate;v!==null&&(v.lanes|=c),Ju(o.return,c,m)}function Sd(o,c,m,v,b){var _=o.memoizedState;_===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:m,tailMode:b}:(_.isBackwards=c,_.rendering=null,_.renderingStartTime=0,_.last=v,_.tail=m,_.tailMode=b)}function Lp(o,c,m){var v=c.pendingProps,b=v.revealOrder,_=v.tail;if(Wt(o,c,v.children,m),v=ct.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Ap(o,m,c);else if(o.tag===19)Ap(o,m,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(rt(ct,v),(c.mode&1)===0)c.memoizedState=null;else switch(b){case"forwards":for(m=c.child,b=null;m!==null;)o=m.alternate,o!==null&&sl(o)===null&&(b=m),m=m.sibling;m=b,m===null?(b=c.child,c.child=null):(b=m.sibling,m.sibling=null),Sd(c,!1,b,m,_);break;case"backwards":for(m=null,b=c.child,c.child=null;b!==null;){if(o=b.alternate,o!==null&&sl(o)===null){c.child=b;break}o=b.sibling,b.sibling=m,m=b,b=o}Sd(c,!0,m,null,_);break;case"together":Sd(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function fl(o,c){(c.mode&1)===0&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function vn(o,c,m){if(o!==null&&(c.dependencies=o.dependencies),ks|=c.lanes,(m&c.childLanes)===0)return null;if(o!==null&&c.child!==o.child)throw Error(t(153));if(c.child!==null){for(o=c.child,m=ts(o,o.pendingProps),c.child=m,m.return=c;o.sibling!==null;)o=o.sibling,m=m.sibling=ts(o,o.pendingProps),m.return=c;m.sibling=null}return c.child}function Xb(o,c,m){switch(c.tag){case 3:kp(c),di();break;case 5:Hm(c);break;case 1:Zt(c.type)&&Wo(c);break;case 4:rd(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,b=c.memoizedProps.value;rt(el,v._currentValue),v._currentValue=b;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(rt(ct,ct.current&1),c.flags|=128,null):(m&c.child.childLanes)!==0?Ip(o,c,m):(rt(ct,ct.current&1),o=vn(o,c,m),o!==null?o.sibling:null);rt(ct,ct.current&1);break;case 19:if(v=(m&c.childLanes)!==0,(o.flags&128)!==0){if(v)return Lp(o,c,m);c.flags|=128}if(b=c.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),rt(ct,ct.current),v)break;return null;case 22:case 23:return c.lanes=0,Sp(o,c,m)}return vn(o,c,m)}var Rp,Td,Np,Dp;Rp=function(o,c){for(var m=c.child;m!==null;){if(m.tag===5||m.tag===6)o.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Td=function(){},Np=function(o,c,m,v){var b=o.memoizedProps;if(b!==v){o=c.stateNode,Ts(qr.current);var _=null;switch(m){case"input":b=le(o,b),v=le(o,v),_=[];break;case"select":b=W({},b,{value:void 0}),v=W({},v,{value:void 0}),_=[];break;case"textarea":b=bt(o,b),v=bt(o,v),_=[];break;default:typeof b.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=qo)}su(m,v);var A;m=null;for(Y in b)if(!v.hasOwnProperty(Y)&&b.hasOwnProperty(Y)&&b[Y]!=null)if(Y==="style"){var M=b[Y];for(A in M)M.hasOwnProperty(A)&&(m||(m={}),m[A]="")}else Y!=="dangerouslySetInnerHTML"&&Y!=="children"&&Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(s.hasOwnProperty(Y)?_||(_=[]):(_=_||[]).push(Y,null));for(Y in v){var B=v[Y];if(M=b?.[Y],v.hasOwnProperty(Y)&&B!==M&&(B!=null||M!=null))if(Y==="style")if(M){for(A in M)!M.hasOwnProperty(A)||B&&B.hasOwnProperty(A)||(m||(m={}),m[A]="");for(A in B)B.hasOwnProperty(A)&&M[A]!==B[A]&&(m||(m={}),m[A]=B[A])}else m||(_||(_=[]),_.push(Y,m)),m=B;else Y==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,M=M?M.__html:void 0,B!=null&&M!==B&&(_=_||[]).push(Y,B)):Y==="children"?typeof B!="string"&&typeof B!="number"||(_=_||[]).push(Y,""+B):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&(s.hasOwnProperty(Y)?(B!=null&&Y==="onScroll"&&st("scroll",o),_||M===B||(_=[])):(_=_||[]).push(Y,B))}m&&(_=_||[]).push("style",m);var Y=_;(c.updateQueue=Y)&&(c.flags|=4)}},Dp=function(o,c,m,v){m!==v&&(c.flags|=4)};function La(o,c){if(!ot)switch(o.tailMode){case"hidden":c=o.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?o.tail=null:m.sibling=null;break;case"collapsed":m=o.tail;for(var v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function qt(o){var c=o.alternate!==null&&o.alternate.child===o.child,m=0,v=0;if(c)for(var b=o.child;b!==null;)m|=b.lanes|b.childLanes,v|=b.subtreeFlags&14680064,v|=b.flags&14680064,b.return=o,b=b.sibling;else for(b=o.child;b!==null;)m|=b.lanes|b.childLanes,v|=b.subtreeFlags,v|=b.flags,b.return=o,b=b.sibling;return o.subtreeFlags|=v,o.childLanes=m,c}function Zb(o,c,m){var v=c.pendingProps;switch(Ku(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(c),null;case 1:return Zt(c.type)&&zo(),qt(c),null;case 3:return v=c.stateNode,pi(),it(Xt),it(Gt),id(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(Zo(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Nr!==null&&(Od(Nr),Nr=null))),Td(o,c),qt(c),null;case 5:nd(c);var b=Ts(_a.current);if(m=c.type,o!==null&&c.stateNode!=null)Np(o,c,m,v,b),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(t(166));return qt(c),null}if(o=Ts(qr.current),Zo(c)){v=c.stateNode,m=c.type;var _=c.memoizedProps;switch(v[Hr]=c,v[Ea]=_,o=(c.mode&1)!==0,m){case"dialog":st("cancel",v),st("close",v);break;case"iframe":case"object":case"embed":st("load",v);break;case"video":case"audio":for(b=0;b<xa.length;b++)st(xa[b],v);break;case"source":st("error",v);break;case"img":case"image":case"link":st("error",v),st("load",v);break;case"details":st("toggle",v);break;case"input":Pe(v,_),st("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!_.multiple},st("invalid",v);break;case"textarea":On(v,_),st("invalid",v)}su(m,_),b=null;for(var A in _)if(_.hasOwnProperty(A)){var M=_[A];A==="children"?typeof M=="string"?v.textContent!==M&&(_.suppressHydrationWarning!==!0&&Ho(v.textContent,M,o),b=["children",M]):typeof M=="number"&&v.textContent!==""+M&&(_.suppressHydrationWarning!==!0&&Ho(v.textContent,M,o),b=["children",""+M]):s.hasOwnProperty(A)&&M!=null&&A==="onScroll"&&st("scroll",v)}switch(m){case"input":Vt(v),He(v,_,!0);break;case"textarea":Vt(v),Zi(v);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(v.onclick=qo)}v=b,c.updateQueue=v,v!==null&&(c.flags|=4)}else{A=b.nodeType===9?b:b.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=jn(m)),o==="http://www.w3.org/1999/xhtml"?m==="script"?(o=A.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=A.createElement(m,{is:v.is}):(o=A.createElement(m),m==="select"&&(A=o,v.multiple?A.multiple=!0:v.size&&(A.size=v.size))):o=A.createElementNS(o,m),o[Hr]=c,o[Ea]=v,Rp(o,c,!1,!1),c.stateNode=o;e:{switch(A=iu(m,v),m){case"dialog":st("cancel",o),st("close",o),b=v;break;case"iframe":case"object":case"embed":st("load",o),b=v;break;case"video":case"audio":for(b=0;b<xa.length;b++)st(xa[b],o);b=v;break;case"source":st("error",o),b=v;break;case"img":case"image":case"link":st("error",o),st("load",o),b=v;break;case"details":st("toggle",o),b=v;break;case"input":Pe(o,v),b=le(o,v),st("invalid",o);break;case"option":b=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},b=W({},v,{value:void 0}),st("invalid",o);break;case"textarea":On(o,v),b=bt(o,v),st("invalid",o);break;default:b=v}su(m,b),M=b;for(_ in M)if(M.hasOwnProperty(_)){var B=M[_];_==="style"?b0(o,B):_==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&Ji(o,B)):_==="children"?typeof B=="string"?(m!=="textarea"||B!=="")&&Mn(o,B):typeof B=="number"&&Mn(o,""+B):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(s.hasOwnProperty(_)?B!=null&&_==="onScroll"&&st("scroll",o):B!=null&&k(o,_,B,A))}switch(m){case"input":Vt(o),He(o,v,!1);break;case"textarea":Vt(o),Zi(o);break;case"option":v.value!=null&&o.setAttribute("value",""+ge(v.value));break;case"select":o.multiple=!!v.multiple,_=v.value,_!=null?Xe(o,!!v.multiple,_,!1):v.defaultValue!=null&&Xe(o,!!v.multiple,v.defaultValue,!0);break;default:typeof b.onClick=="function"&&(o.onclick=qo)}switch(m){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return qt(c),null;case 6:if(o&&c.stateNode!=null)Dp(o,c,o.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(t(166));if(m=Ts(_a.current),Ts(qr.current),Zo(c)){if(v=c.stateNode,m=c.memoizedProps,v[Hr]=c,(_=v.nodeValue!==m)&&(o=lr,o!==null))switch(o.tag){case 3:Ho(v.nodeValue,m,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Ho(v.nodeValue,m,(o.mode&1)!==0)}_&&(c.flags|=4)}else v=(m.nodeType===9?m:m.ownerDocument).createTextNode(v),v[Hr]=c,c.stateNode=v}return qt(c),null;case 13:if(it(ct),v=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(ot&&cr!==null&&(c.mode&1)!==0&&(c.flags&128)===0)jm(),di(),c.flags|=98560,_=!1;else if(_=Zo(c),v!==null&&v.dehydrated!==null){if(o===null){if(!_)throw Error(t(318));if(_=c.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[Hr]=c}else di(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;qt(c),_=!1}else Nr!==null&&(Od(Nr),Nr=null),_=!0;if(!_)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=m,c):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(o===null||(ct.current&1)!==0?kt===0&&(kt=3):Fd())),c.updateQueue!==null&&(c.flags|=4),qt(c),null);case 4:return pi(),Td(o,c),o===null&&va(c.stateNode.containerInfo),qt(c),null;case 10:return Zu(c.type._context),qt(c),null;case 17:return Zt(c.type)&&zo(),qt(c),null;case 19:if(it(ct),_=c.memoizedState,_===null)return qt(c),null;if(v=(c.flags&128)!==0,A=_.rendering,A===null)if(v)La(_,!1);else{if(kt!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(A=sl(o),A!==null){for(c.flags|=128,La(_,!1),v=A.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=m,m=c.child;m!==null;)_=m,o=v,_.flags&=14680066,A=_.alternate,A===null?(_.childLanes=0,_.lanes=o,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=A.childLanes,_.lanes=A.lanes,_.child=A.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=A.memoizedProps,_.memoizedState=A.memoizedState,_.updateQueue=A.updateQueue,_.type=A.type,o=A.dependencies,_.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),m=m.sibling;return rt(ct,ct.current&1|2),c.child}o=o.sibling}_.tail!==null&&yt()>yi&&(c.flags|=128,v=!0,La(_,!1),c.lanes=4194304)}else{if(!v)if(o=sl(A),o!==null){if(c.flags|=128,v=!0,m=o.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),La(_,!0),_.tail===null&&_.tailMode==="hidden"&&!A.alternate&&!ot)return qt(c),null}else 2*yt()-_.renderingStartTime>yi&&m!==1073741824&&(c.flags|=128,v=!0,La(_,!1),c.lanes=4194304);_.isBackwards?(A.sibling=c.child,c.child=A):(m=_.last,m!==null?m.sibling=A:c.child=A,_.last=A)}return _.tail!==null?(c=_.tail,_.rendering=c,_.tail=c.sibling,_.renderingStartTime=yt(),c.sibling=null,m=ct.current,rt(ct,v?m&1|2:m&1),c):(qt(c),null);case 22:case 23:return Md(),v=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(ur&1073741824)!==0&&(qt(c),c.subtreeFlags&6&&(c.flags|=8192)):qt(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function Jb(o,c){switch(Ku(c),c.tag){case 1:return Zt(c.type)&&zo(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return pi(),it(Xt),it(Gt),id(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 5:return nd(c),null;case 13:if(it(ct),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(t(340));di()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return it(ct),null;case 4:return pi(),null;case 10:return Zu(c.type._context),null;case 22:case 23:return Md(),null;case 24:return null;default:return null}}var hl=!1,Kt=!1,eS=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function xi(o,c){var m=o.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(v){pt(o,c,v)}else m.current=null}function _d(o,c,m){try{m()}catch(v){pt(o,c,v)}}var Pp=!1;function tS(o,c){if(Mu=Do,o=fm(),Au(o)){if("selectionStart"in o)var m={start:o.selectionStart,end:o.selectionEnd};else e:{m=(m=o.ownerDocument)&&m.defaultView||window;var v=m.getSelection&&m.getSelection();if(v&&v.rangeCount!==0){m=v.anchorNode;var b=v.anchorOffset,_=v.focusNode;v=v.focusOffset;try{m.nodeType,_.nodeType}catch{m=null;break e}var A=0,M=-1,B=-1,Y=0,oe=0,ce=o,ae=null;t:for(;;){for(var ve;ce!==m||b!==0&&ce.nodeType!==3||(M=A+b),ce!==_||v!==0&&ce.nodeType!==3||(B=A+v),ce.nodeType===3&&(A+=ce.nodeValue.length),(ve=ce.firstChild)!==null;)ae=ce,ce=ve;for(;;){if(ce===o)break t;if(ae===m&&++Y===b&&(M=A),ae===_&&++oe===v&&(B=A),(ve=ce.nextSibling)!==null)break;ce=ae,ae=ce.parentNode}ce=ve}m=M===-1||B===-1?null:{start:M,end:B}}else m=null}m=m||{start:0,end:0}}else m=null;for(Fu={focusedElem:o,selectionRange:m},Do=!1,Ee=c;Ee!==null;)if(c=Ee,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,Ee=o;else for(;Ee!==null;){c=Ee;try{var be=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var Se=be.memoizedProps,Et=be.memoizedState,K=c.stateNode,V=K.getSnapshotBeforeUpdate(c.elementType===c.type?Se:Dr(c.type,Se),Et);K.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var z=c.stateNode.containerInfo;z.nodeType===1?z.textContent="":z.nodeType===9&&z.documentElement&&z.removeChild(z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fe){pt(c,c.return,fe)}if(o=c.sibling,o!==null){o.return=c.return,Ee=o;break}Ee=c.return}return be=Pp,Pp=!1,be}function Ra(o,c,m){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var b=v=v.next;do{if((b.tag&o)===o){var _=b.destroy;b.destroy=void 0,_!==void 0&&_d(c,m,_)}b=b.next}while(b!==v)}}function ml(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do{if((m.tag&o)===o){var v=m.create;m.destroy=v()}m=m.next}while(m!==c)}}function kd(o){var c=o.ref;if(c!==null){var m=o.stateNode;switch(o.tag){case 5:o=m;break;default:o=m}typeof c=="function"?c(o):c.current=o}}function Op(o){var c=o.alternate;c!==null&&(o.alternate=null,Op(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[Hr],delete c[Ea],delete c[Vu],delete c[Mb],delete c[Fb])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function jp(o){return o.tag===5||o.tag===3||o.tag===4}function Mp(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||jp(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Cd(o,c,m){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?m.nodeType===8?m.parentNode.insertBefore(o,c):m.insertBefore(o,c):(m.nodeType===8?(c=m.parentNode,c.insertBefore(o,m)):(c=m,c.appendChild(o)),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=qo));else if(v!==4&&(o=o.child,o!==null))for(Cd(o,c,m),o=o.sibling;o!==null;)Cd(o,c,m),o=o.sibling}function Id(o,c,m){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?m.insertBefore(o,c):m.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(Id(o,c,m),o=o.sibling;o!==null;)Id(o,c,m),o=o.sibling}var jt=null,Pr=!1;function Qn(o,c,m){for(m=m.child;m!==null;)Fp(o,c,m),m=m.sibling}function Fp(o,c,m){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(Co,m)}catch{}switch(m.tag){case 5:Kt||xi(m,c);case 6:var v=jt,b=Pr;jt=null,Qn(o,c,m),jt=v,Pr=b,jt!==null&&(Pr?(o=jt,m=m.stateNode,o.nodeType===8?o.parentNode.removeChild(m):o.removeChild(m)):jt.removeChild(m.stateNode));break;case 18:jt!==null&&(Pr?(o=jt,m=m.stateNode,o.nodeType===8?$u(o.parentNode,m):o.nodeType===1&&$u(o,m),ca(o)):$u(jt,m.stateNode));break;case 4:v=jt,b=Pr,jt=m.stateNode.containerInfo,Pr=!0,Qn(o,c,m),jt=v,Pr=b;break;case 0:case 11:case 14:case 15:if(!Kt&&(v=m.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){b=v=v.next;do{var _=b,A=_.destroy;_=_.tag,A!==void 0&&((_&2)!==0||(_&4)!==0)&&_d(m,c,A),b=b.next}while(b!==v)}Qn(o,c,m);break;case 1:if(!Kt&&(xi(m,c),v=m.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=m.memoizedProps,v.state=m.memoizedState,v.componentWillUnmount()}catch(M){pt(m,c,M)}Qn(o,c,m);break;case 21:Qn(o,c,m);break;case 22:m.mode&1?(Kt=(v=Kt)||m.memoizedState!==null,Qn(o,c,m),Kt=v):Qn(o,c,m);break;default:Qn(o,c,m)}}function Up(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var m=o.stateNode;m===null&&(m=o.stateNode=new eS),c.forEach(function(v){var b=uS.bind(null,o,v);m.has(v)||(m.add(v),v.then(b,b))})}}function Or(o,c){var m=c.deletions;if(m!==null)for(var v=0;v<m.length;v++){var b=m[v];try{var _=o,A=c,M=A;e:for(;M!==null;){switch(M.tag){case 5:jt=M.stateNode,Pr=!1;break e;case 3:jt=M.stateNode.containerInfo,Pr=!0;break e;case 4:jt=M.stateNode.containerInfo,Pr=!0;break e}M=M.return}if(jt===null)throw Error(t(160));Fp(_,A,b),jt=null,Pr=!1;var B=b.alternate;B!==null&&(B.return=null),b.return=null}catch(Y){pt(b,c,Y)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Bp(c,o),c=c.sibling}function Bp(o,c){var m=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Or(c,o),zr(o),v&4){try{Ra(3,o,o.return),ml(3,o)}catch(Se){pt(o,o.return,Se)}try{Ra(5,o,o.return)}catch(Se){pt(o,o.return,Se)}}break;case 1:Or(c,o),zr(o),v&512&&m!==null&&xi(m,m.return);break;case 5:if(Or(c,o),zr(o),v&512&&m!==null&&xi(m,m.return),o.flags&32){var b=o.stateNode;try{Mn(b,"")}catch(Se){pt(o,o.return,Se)}}if(v&4&&(b=o.stateNode,b!=null)){var _=o.memoizedProps,A=m!==null?m.memoizedProps:_,M=o.type,B=o.updateQueue;if(o.updateQueue=null,B!==null)try{M==="input"&&_.type==="radio"&&_.name!=null&&we(b,_),iu(M,A);var Y=iu(M,_);for(A=0;A<B.length;A+=2){var oe=B[A],ce=B[A+1];oe==="style"?b0(b,ce):oe==="dangerouslySetInnerHTML"?Ji(b,ce):oe==="children"?Mn(b,ce):k(b,oe,ce,Y)}switch(M){case"input":Fe(b,_);break;case"textarea":dn(b,_);break;case"select":var ae=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!_.multiple;var ve=_.value;ve!=null?Xe(b,!!_.multiple,ve,!1):ae!==!!_.multiple&&(_.defaultValue!=null?Xe(b,!!_.multiple,_.defaultValue,!0):Xe(b,!!_.multiple,_.multiple?[]:"",!1))}b[Ea]=_}catch(Se){pt(o,o.return,Se)}}break;case 6:if(Or(c,o),zr(o),v&4){if(o.stateNode===null)throw Error(t(162));b=o.stateNode,_=o.memoizedProps;try{b.nodeValue=_}catch(Se){pt(o,o.return,Se)}}break;case 3:if(Or(c,o),zr(o),v&4&&m!==null&&m.memoizedState.isDehydrated)try{ca(c.containerInfo)}catch(Se){pt(o,o.return,Se)}break;case 4:Or(c,o),zr(o);break;case 13:Or(c,o),zr(o),b=o.child,b.flags&8192&&(_=b.memoizedState!==null,b.stateNode.isHidden=_,!_||b.alternate!==null&&b.alternate.memoizedState!==null||(Rd=yt())),v&4&&Up(o);break;case 22:if(oe=m!==null&&m.memoizedState!==null,o.mode&1?(Kt=(Y=Kt)||oe,Or(c,o),Kt=Y):Or(c,o),zr(o),v&8192){if(Y=o.memoizedState!==null,(o.stateNode.isHidden=Y)&&!oe&&(o.mode&1)!==0)for(Ee=o,oe=o.child;oe!==null;){for(ce=Ee=oe;Ee!==null;){switch(ae=Ee,ve=ae.child,ae.tag){case 0:case 11:case 14:case 15:Ra(4,ae,ae.return);break;case 1:xi(ae,ae.return);var be=ae.stateNode;if(typeof be.componentWillUnmount=="function"){v=ae,m=ae.return;try{c=v,be.props=c.memoizedProps,be.state=c.memoizedState,be.componentWillUnmount()}catch(Se){pt(v,m,Se)}}break;case 5:xi(ae,ae.return);break;case 22:if(ae.memoizedState!==null){Gp(ce);continue}}ve!==null?(ve.return=ae,Ee=ve):Gp(ce)}oe=oe.sibling}e:for(oe=null,ce=o;;){if(ce.tag===5){if(oe===null){oe=ce;try{b=ce.stateNode,Y?(_=b.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(M=ce.stateNode,B=ce.memoizedProps.style,A=B!=null&&B.hasOwnProperty("display")?B.display:null,M.style.display=w0("display",A))}catch(Se){pt(o,o.return,Se)}}}else if(ce.tag===6){if(oe===null)try{ce.stateNode.nodeValue=Y?"":ce.memoizedProps}catch(Se){pt(o,o.return,Se)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===o)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===o)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===o)break e;oe===ce&&(oe=null),ce=ce.return}oe===ce&&(oe=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:Or(c,o),zr(o),v&4&&Up(o);break;case 21:break;default:Or(c,o),zr(o)}}function zr(o){var c=o.flags;if(c&2){try{e:{for(var m=o.return;m!==null;){if(jp(m)){var v=m;break e}m=m.return}throw Error(t(160))}switch(v.tag){case 5:var b=v.stateNode;v.flags&32&&(Mn(b,""),v.flags&=-33);var _=Mp(o);Id(o,_,b);break;case 3:case 4:var A=v.stateNode.containerInfo,M=Mp(o);Cd(o,M,A);break;default:throw Error(t(161))}}catch(B){pt(o,o.return,B)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function rS(o,c,m){Ee=o,$p(o)}function $p(o,c,m){for(var v=(o.mode&1)!==0;Ee!==null;){var b=Ee,_=b.child;if(b.tag===22&&v){var A=b.memoizedState!==null||hl;if(!A){var M=b.alternate,B=M!==null&&M.memoizedState!==null||Kt;M=hl;var Y=Kt;if(hl=A,(Kt=B)&&!Y)for(Ee=b;Ee!==null;)A=Ee,B=A.child,A.tag===22&&A.memoizedState!==null?Hp(b):B!==null?(B.return=A,Ee=B):Hp(b);for(;_!==null;)Ee=_,$p(_),_=_.sibling;Ee=b,hl=M,Kt=Y}Vp(o)}else(b.subtreeFlags&8772)!==0&&_!==null?(_.return=b,Ee=_):Vp(o)}}function Vp(o){for(;Ee!==null;){var c=Ee;if((c.flags&8772)!==0){var m=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Kt||ml(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!Kt)if(m===null)v.componentDidMount();else{var b=c.elementType===c.type?m.memoizedProps:Dr(c.type,m.memoizedProps);v.componentDidUpdate(b,m.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var _=c.updateQueue;_!==null&&Gm(c,_,v);break;case 3:var A=c.updateQueue;if(A!==null){if(m=null,c.child!==null)switch(c.child.tag){case 5:m=c.child.stateNode;break;case 1:m=c.child.stateNode}Gm(c,A,m)}break;case 5:var M=c.stateNode;if(m===null&&c.flags&4){m=M;var B=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&m.focus();break;case"img":B.src&&(m.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Y=c.alternate;if(Y!==null){var oe=Y.memoizedState;if(oe!==null){var ce=oe.dehydrated;ce!==null&&ca(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kt||c.flags&512&&kd(c)}catch(ae){pt(c,c.return,ae)}}if(c===o){Ee=null;break}if(m=c.sibling,m!==null){m.return=c.return,Ee=m;break}Ee=c.return}}function Gp(o){for(;Ee!==null;){var c=Ee;if(c===o){Ee=null;break}var m=c.sibling;if(m!==null){m.return=c.return,Ee=m;break}Ee=c.return}}function Hp(o){for(;Ee!==null;){var c=Ee;try{switch(c.tag){case 0:case 11:case 15:var m=c.return;try{ml(4,c)}catch(B){pt(c,m,B)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var b=c.return;try{v.componentDidMount()}catch(B){pt(c,b,B)}}var _=c.return;try{kd(c)}catch(B){pt(c,_,B)}break;case 5:var A=c.return;try{kd(c)}catch(B){pt(c,A,B)}}}catch(B){pt(c,c.return,B)}if(c===o){Ee=null;break}var M=c.sibling;if(M!==null){M.return=c.return,Ee=M;break}Ee=c.return}}var nS=Math.ceil,pl=I.ReactCurrentDispatcher,Ad=I.ReactCurrentOwner,Er=I.ReactCurrentBatchConfig,qe=0,Nt=null,St=null,Mt=0,ur=0,vi=qn(0),kt=0,Na=null,ks=0,gl=0,Ld=0,Da=null,er=null,Rd=0,yi=1/0,yn=null,xl=!1,Nd=null,Xn=null,vl=!1,Zn=null,yl=0,Pa=0,Dd=null,El=-1,wl=0;function Yt(){return(qe&6)!==0?yt():El!==-1?El:El=yt()}function Jn(o){return(o.mode&1)===0?1:(qe&2)!==0&&Mt!==0?Mt&-Mt:Bb.transition!==null?(wl===0&&(wl=M0()),wl):(o=We,o!==0||(o=window.event,o=o===void 0?16:K0(o.type)),o)}function jr(o,c,m,v){if(50<Pa)throw Pa=0,Dd=null,Error(t(185));sa(o,m,v),((qe&2)===0||o!==Nt)&&(o===Nt&&((qe&2)===0&&(gl|=m),kt===4&&es(o,Mt)),tr(o,v),m===1&&qe===0&&(c.mode&1)===0&&(yi=yt()+500,Yo&&zn()))}function tr(o,c){var m=o.callbackNode;Bw(o,c);var v=Lo(o,o===Nt?Mt:0);if(v===0)m!==null&&P0(m),o.callbackNode=null,o.callbackPriority=0;else if(c=v&-v,o.callbackPriority!==c){if(m!=null&&P0(m),c===1)o.tag===0?Ub(Kp.bind(null,o)):Rm(Kp.bind(null,o)),Ob(function(){(qe&6)===0&&zn()}),m=null;else{switch(F0(v)){case 1:m=fu;break;case 4:m=O0;break;case 16:m=ko;break;case 536870912:m=j0;break;default:m=ko}m=eg(m,qp.bind(null,o))}o.callbackPriority=c,o.callbackNode=m}}function qp(o,c){if(El=-1,wl=0,(qe&6)!==0)throw Error(t(327));var m=o.callbackNode;if(Ei()&&o.callbackNode!==m)return null;var v=Lo(o,o===Nt?Mt:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||c)c=bl(o,v);else{c=v;var b=qe;qe|=2;var _=Wp();(Nt!==o||Mt!==c)&&(yn=null,yi=yt()+500,Is(o,c));do try{aS();break}catch(M){zp(o,M)}while(!0);Xu(),pl.current=_,qe=b,St!==null?c=0:(Nt=null,Mt=0,c=kt)}if(c!==0){if(c===2&&(b=hu(o),b!==0&&(v=b,c=Pd(o,b))),c===1)throw m=Na,Is(o,0),es(o,v),tr(o,yt()),m;if(c===6)es(o,v);else{if(b=o.current.alternate,(v&30)===0&&!sS(b)&&(c=bl(o,v),c===2&&(_=hu(o),_!==0&&(v=_,c=Pd(o,_))),c===1))throw m=Na,Is(o,0),es(o,v),tr(o,yt()),m;switch(o.finishedWork=b,o.finishedLanes=v,c){case 0:case 1:throw Error(t(345));case 2:As(o,er,yn);break;case 3:if(es(o,v),(v&130023424)===v&&(c=Rd+500-yt(),10<c)){if(Lo(o,0)!==0)break;if(b=o.suspendedLanes,(b&v)!==v){Yt(),o.pingedLanes|=o.suspendedLanes&b;break}o.timeoutHandle=Bu(As.bind(null,o,er,yn),c);break}As(o,er,yn);break;case 4:if(es(o,v),(v&4194240)===v)break;for(c=o.eventTimes,b=-1;0<v;){var A=31-Lr(v);_=1<<A,A=c[A],A>b&&(b=A),v&=~_}if(v=b,v=yt()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*nS(v/1960))-v,10<v){o.timeoutHandle=Bu(As.bind(null,o,er,yn),v);break}As(o,er,yn);break;case 5:As(o,er,yn);break;default:throw Error(t(329))}}}return tr(o,yt()),o.callbackNode===m?qp.bind(null,o):null}function Pd(o,c){var m=Da;return o.current.memoizedState.isDehydrated&&(Is(o,c).flags|=256),o=bl(o,c),o!==2&&(c=er,er=m,c!==null&&Od(c)),o}function Od(o){er===null?er=o:er.push.apply(er,o)}function sS(o){for(var c=o;;){if(c.flags&16384){var m=c.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var v=0;v<m.length;v++){var b=m[v],_=b.getSnapshot;b=b.value;try{if(!Rr(_(),b))return!1}catch{return!1}}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function es(o,c){for(c&=~Ld,c&=~gl,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var m=31-Lr(c),v=1<<m;o[m]=-1,c&=~v}}function Kp(o){if((qe&6)!==0)throw Error(t(327));Ei();var c=Lo(o,0);if((c&1)===0)return tr(o,yt()),null;var m=bl(o,c);if(o.tag!==0&&m===2){var v=hu(o);v!==0&&(c=v,m=Pd(o,v))}if(m===1)throw m=Na,Is(o,0),es(o,c),tr(o,yt()),m;if(m===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,As(o,er,yn),tr(o,yt()),null}function jd(o,c){var m=qe;qe|=1;try{return o(c)}finally{qe=m,qe===0&&(yi=yt()+500,Yo&&zn())}}function Cs(o){Zn!==null&&Zn.tag===0&&(qe&6)===0&&Ei();var c=qe;qe|=1;var m=Er.transition,v=We;try{if(Er.transition=null,We=1,o)return o()}finally{We=v,Er.transition=m,qe=c,(qe&6)===0&&zn()}}function Md(){ur=vi.current,it(vi)}function Is(o,c){o.finishedWork=null,o.finishedLanes=0;var m=o.timeoutHandle;if(m!==-1&&(o.timeoutHandle=-1,Pb(m)),St!==null)for(m=St.return;m!==null;){var v=m;switch(Ku(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&zo();break;case 3:pi(),it(Xt),it(Gt),id();break;case 5:nd(v);break;case 4:pi();break;case 13:it(ct);break;case 19:it(ct);break;case 10:Zu(v.type._context);break;case 22:case 23:Md()}m=m.return}if(Nt=o,St=o=ts(o.current,null),Mt=ur=c,kt=0,Na=null,Ld=gl=ks=0,er=Da=null,Ss!==null){for(c=0;c<Ss.length;c++)if(m=Ss[c],v=m.interleaved,v!==null){m.interleaved=null;var b=v.next,_=m.pending;if(_!==null){var A=_.next;_.next=b,v.next=A}m.pending=v}Ss=null}return o}function zp(o,c){do{var m=St;try{if(Xu(),il.current=cl,al){for(var v=ut.memoizedState;v!==null;){var b=v.queue;b!==null&&(b.pending=null),v=v.next}al=!1}if(_s=0,Rt=_t=ut=null,ka=!1,Ca=0,Ad.current=null,m===null||m.return===null){kt=1,Na=c,St=null;break}e:{var _=o,A=m.return,M=m,B=c;if(c=Mt,M.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var Y=B,oe=M,ce=oe.tag;if((oe.mode&1)===0&&(ce===0||ce===11||ce===15)){var ae=oe.alternate;ae?(oe.updateQueue=ae.updateQueue,oe.memoizedState=ae.memoizedState,oe.lanes=ae.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var ve=vp(A);if(ve!==null){ve.flags&=-257,yp(ve,A,M,_,c),ve.mode&1&&xp(_,Y,c),c=ve,B=Y;var be=c.updateQueue;if(be===null){var Se=new Set;Se.add(B),c.updateQueue=Se}else be.add(B);break e}else{if((c&1)===0){xp(_,Y,c),Fd();break e}B=Error(t(426))}}else if(ot&&M.mode&1){var Et=vp(A);if(Et!==null){(Et.flags&65536)===0&&(Et.flags|=256),yp(Et,A,M,_,c),Yu(gi(B,M));break e}}_=B=gi(B,M),kt!==4&&(kt=2),Da===null?Da=[_]:Da.push(_),_=A;do{switch(_.tag){case 3:_.flags|=65536,c&=-c,_.lanes|=c;var K=pp(_,B,c);Vm(_,K);break e;case 1:M=B;var V=_.type,z=_.stateNode;if((_.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Xn===null||!Xn.has(z)))){_.flags|=65536,c&=-c,_.lanes|=c;var fe=gp(_,M,c);Vm(_,fe);break e}}_=_.return}while(_!==null)}Qp(m)}catch(_e){c=_e,St===m&&m!==null&&(St=m=m.return);continue}break}while(!0)}function Wp(){var o=pl.current;return pl.current=cl,o===null?cl:o}function Fd(){(kt===0||kt===3||kt===2)&&(kt=4),Nt===null||(ks&268435455)===0&&(gl&268435455)===0||es(Nt,Mt)}function bl(o,c){var m=qe;qe|=2;var v=Wp();(Nt!==o||Mt!==c)&&(yn=null,Is(o,c));do try{iS();break}catch(b){zp(o,b)}while(!0);if(Xu(),qe=m,pl.current=v,St!==null)throw Error(t(261));return Nt=null,Mt=0,kt}function iS(){for(;St!==null;)Yp(St)}function aS(){for(;St!==null&&!Rw();)Yp(St)}function Yp(o){var c=Jp(o.alternate,o,ur);o.memoizedProps=o.pendingProps,c===null?Qp(o):St=c,Ad.current=null}function Qp(o){var c=o;do{var m=c.alternate;if(o=c.return,(c.flags&32768)===0){if(m=Zb(m,c,ur),m!==null){St=m;return}}else{if(m=Jb(m,c),m!==null){m.flags&=32767,St=m;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{kt=6,St=null;return}}if(c=c.sibling,c!==null){St=c;return}St=c=o}while(c!==null);kt===0&&(kt=5)}function As(o,c,m){var v=We,b=Er.transition;try{Er.transition=null,We=1,oS(o,c,m,v)}finally{Er.transition=b,We=v}return null}function oS(o,c,m,v){do Ei();while(Zn!==null);if((qe&6)!==0)throw Error(t(327));m=o.finishedWork;var b=o.finishedLanes;if(m===null)return null;if(o.finishedWork=null,o.finishedLanes=0,m===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var _=m.lanes|m.childLanes;if($w(o,_),o===Nt&&(St=Nt=null,Mt=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||vl||(vl=!0,eg(ko,function(){return Ei(),null})),_=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||_){_=Er.transition,Er.transition=null;var A=We;We=1;var M=qe;qe|=4,Ad.current=null,tS(o,m),Bp(m,o),Cb(Fu),Do=!!Mu,Fu=Mu=null,o.current=m,rS(m),Nw(),qe=M,We=A,Er.transition=_}else o.current=m;if(vl&&(vl=!1,Zn=o,yl=b),_=o.pendingLanes,_===0&&(Xn=null),Ow(m.stateNode),tr(o,yt()),c!==null)for(v=o.onRecoverableError,m=0;m<c.length;m++)b=c[m],v(b.value,{componentStack:b.stack,digest:b.digest});if(xl)throw xl=!1,o=Nd,Nd=null,o;return(yl&1)!==0&&o.tag!==0&&Ei(),_=o.pendingLanes,(_&1)!==0?o===Dd?Pa++:(Pa=0,Dd=o):Pa=0,zn(),null}function Ei(){if(Zn!==null){var o=F0(yl),c=Er.transition,m=We;try{if(Er.transition=null,We=16>o?16:o,Zn===null)var v=!1;else{if(o=Zn,Zn=null,yl=0,(qe&6)!==0)throw Error(t(331));var b=qe;for(qe|=4,Ee=o.current;Ee!==null;){var _=Ee,A=_.child;if((Ee.flags&16)!==0){var M=_.deletions;if(M!==null){for(var B=0;B<M.length;B++){var Y=M[B];for(Ee=Y;Ee!==null;){var oe=Ee;switch(oe.tag){case 0:case 11:case 15:Ra(8,oe,_)}var ce=oe.child;if(ce!==null)ce.return=oe,Ee=ce;else for(;Ee!==null;){oe=Ee;var ae=oe.sibling,ve=oe.return;if(Op(oe),oe===Y){Ee=null;break}if(ae!==null){ae.return=ve,Ee=ae;break}Ee=ve}}}var be=_.alternate;if(be!==null){var Se=be.child;if(Se!==null){be.child=null;do{var Et=Se.sibling;Se.sibling=null,Se=Et}while(Se!==null)}}Ee=_}}if((_.subtreeFlags&2064)!==0&&A!==null)A.return=_,Ee=A;else e:for(;Ee!==null;){if(_=Ee,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:Ra(9,_,_.return)}var K=_.sibling;if(K!==null){K.return=_.return,Ee=K;break e}Ee=_.return}}var V=o.current;for(Ee=V;Ee!==null;){A=Ee;var z=A.child;if((A.subtreeFlags&2064)!==0&&z!==null)z.return=A,Ee=z;else e:for(A=V;Ee!==null;){if(M=Ee,(M.flags&2048)!==0)try{switch(M.tag){case 0:case 11:case 15:ml(9,M)}}catch(_e){pt(M,M.return,_e)}if(M===A){Ee=null;break e}var fe=M.sibling;if(fe!==null){fe.return=M.return,Ee=fe;break e}Ee=M.return}}if(qe=b,zn(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(Co,o)}catch{}v=!0}return v}finally{We=m,Er.transition=c}}return!1}function Xp(o,c,m){c=gi(m,c),c=pp(o,c,1),o=Yn(o,c,1),c=Yt(),o!==null&&(sa(o,1,c),tr(o,c))}function pt(o,c,m){if(o.tag===3)Xp(o,o,m);else for(;c!==null;){if(c.tag===3){Xp(c,o,m);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Xn===null||!Xn.has(v))){o=gi(m,o),o=gp(c,o,1),c=Yn(c,o,1),o=Yt(),c!==null&&(sa(c,1,o),tr(c,o));break}}c=c.return}}function lS(o,c,m){var v=o.pingCache;v!==null&&v.delete(c),c=Yt(),o.pingedLanes|=o.suspendedLanes&m,Nt===o&&(Mt&m)===m&&(kt===4||kt===3&&(Mt&130023424)===Mt&&500>yt()-Rd?Is(o,0):Ld|=m),tr(o,c)}function Zp(o,c){c===0&&((o.mode&1)===0?c=1:(c=Ao,Ao<<=1,(Ao&130023424)===0&&(Ao=4194304)));var m=Yt();o=gn(o,c),o!==null&&(sa(o,c,m),tr(o,m))}function cS(o){var c=o.memoizedState,m=0;c!==null&&(m=c.retryLane),Zp(o,m)}function uS(o,c){var m=0;switch(o.tag){case 13:var v=o.stateNode,b=o.memoizedState;b!==null&&(m=b.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(c),Zp(o,m)}var Jp;Jp=function(o,c,m){if(o!==null)if(o.memoizedProps!==c.pendingProps||Xt.current)Jt=!0;else{if((o.lanes&m)===0&&(c.flags&128)===0)return Jt=!1,Xb(o,c,m);Jt=(o.flags&131072)!==0}else Jt=!1,ot&&(c.flags&1048576)!==0&&Nm(c,Xo,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;fl(o,c),o=c.pendingProps;var b=li(c,Gt.current);mi(c,m),b=ld(null,c,v,o,b,m);var _=cd();return c.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Zt(v)?(_=!0,Wo(c)):_=!1,c.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,td(c),b.updater=ul,c.stateNode=b,b._reactInternals=c,pd(c,v,o,m),c=yd(null,c,v,!0,_,m)):(c.tag=0,ot&&_&&qu(c),Wt(null,c,b,m),c=c.child),c;case 16:v=c.elementType;e:{switch(fl(o,c),o=c.pendingProps,b=v._init,v=b(v._payload),c.type=v,b=c.tag=fS(v),o=Dr(v,o),b){case 0:c=vd(null,c,v,o,m);break e;case 1:c=_p(null,c,v,o,m);break e;case 11:c=Ep(null,c,v,o,m);break e;case 14:c=wp(null,c,v,Dr(v.type,o),m);break e}throw Error(t(306,v,""))}return c;case 0:return v=c.type,b=c.pendingProps,b=c.elementType===v?b:Dr(v,b),vd(o,c,v,b,m);case 1:return v=c.type,b=c.pendingProps,b=c.elementType===v?b:Dr(v,b),_p(o,c,v,b,m);case 3:e:{if(kp(c),o===null)throw Error(t(387));v=c.pendingProps,_=c.memoizedState,b=_.element,$m(o,c),nl(c,v,null,m);var A=c.memoizedState;if(v=A.element,_.isDehydrated)if(_={element:v,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},c.updateQueue.baseState=_,c.memoizedState=_,c.flags&256){b=gi(Error(t(423)),c),c=Cp(o,c,v,m,b);break e}else if(v!==b){b=gi(Error(t(424)),c),c=Cp(o,c,v,m,b);break e}else for(cr=Hn(c.stateNode.containerInfo.firstChild),lr=c,ot=!0,Nr=null,m=Um(c,null,v,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(di(),v===b){c=vn(o,c,m);break e}Wt(o,c,v,m)}c=c.child}return c;case 5:return Hm(c),o===null&&Wu(c),v=c.type,b=c.pendingProps,_=o!==null?o.memoizedProps:null,A=b.children,Uu(v,b)?A=null:_!==null&&Uu(v,_)&&(c.flags|=32),Tp(o,c),Wt(o,c,A,m),c.child;case 6:return o===null&&Wu(c),null;case 13:return Ip(o,c,m);case 4:return rd(c,c.stateNode.containerInfo),v=c.pendingProps,o===null?c.child=fi(c,null,v,m):Wt(o,c,v,m),c.child;case 11:return v=c.type,b=c.pendingProps,b=c.elementType===v?b:Dr(v,b),Ep(o,c,v,b,m);case 7:return Wt(o,c,c.pendingProps,m),c.child;case 8:return Wt(o,c,c.pendingProps.children,m),c.child;case 12:return Wt(o,c,c.pendingProps.children,m),c.child;case 10:e:{if(v=c.type._context,b=c.pendingProps,_=c.memoizedProps,A=b.value,rt(el,v._currentValue),v._currentValue=A,_!==null)if(Rr(_.value,A)){if(_.children===b.children&&!Xt.current){c=vn(o,c,m);break e}}else for(_=c.child,_!==null&&(_.return=c);_!==null;){var M=_.dependencies;if(M!==null){A=_.child;for(var B=M.firstContext;B!==null;){if(B.context===v){if(_.tag===1){B=xn(-1,m&-m),B.tag=2;var Y=_.updateQueue;if(Y!==null){Y=Y.shared;var oe=Y.pending;oe===null?B.next=B:(B.next=oe.next,oe.next=B),Y.pending=B}}_.lanes|=m,B=_.alternate,B!==null&&(B.lanes|=m),Ju(_.return,m,c),M.lanes|=m;break}B=B.next}}else if(_.tag===10)A=_.type===c.type?null:_.child;else if(_.tag===18){if(A=_.return,A===null)throw Error(t(341));A.lanes|=m,M=A.alternate,M!==null&&(M.lanes|=m),Ju(A,m,c),A=_.sibling}else A=_.child;if(A!==null)A.return=_;else for(A=_;A!==null;){if(A===c){A=null;break}if(_=A.sibling,_!==null){_.return=A.return,A=_;break}A=A.return}_=A}Wt(o,c,b.children,m),c=c.child}return c;case 9:return b=c.type,v=c.pendingProps.children,mi(c,m),b=vr(b),v=v(b),c.flags|=1,Wt(o,c,v,m),c.child;case 14:return v=c.type,b=Dr(v,c.pendingProps),b=Dr(v.type,b),wp(o,c,v,b,m);case 15:return bp(o,c,c.type,c.pendingProps,m);case 17:return v=c.type,b=c.pendingProps,b=c.elementType===v?b:Dr(v,b),fl(o,c),c.tag=1,Zt(v)?(o=!0,Wo(c)):o=!1,mi(c,m),hp(c,v,b),pd(c,v,b,m),yd(null,c,v,!0,o,m);case 19:return Lp(o,c,m);case 22:return Sp(o,c,m)}throw Error(t(156,c.tag))};function eg(o,c){return D0(o,c)}function dS(o,c,m,v){this.tag=o,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(o,c,m,v){return new dS(o,c,m,v)}function Ud(o){return o=o.prototype,!(!o||!o.isReactComponent)}function fS(o){if(typeof o=="function")return Ud(o)?1:0;if(o!=null){if(o=o.$$typeof,o===J)return 11;if(o===X)return 14}return 2}function ts(o,c){var m=o.alternate;return m===null?(m=wr(o.tag,c,o.key,o.mode),m.elementType=o.elementType,m.type=o.type,m.stateNode=o.stateNode,m.alternate=o,o.alternate=m):(m.pendingProps=c,m.type=o.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=o.flags&14680064,m.childLanes=o.childLanes,m.lanes=o.lanes,m.child=o.child,m.memoizedProps=o.memoizedProps,m.memoizedState=o.memoizedState,m.updateQueue=o.updateQueue,c=o.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=o.sibling,m.index=o.index,m.ref=o.ref,m}function Sl(o,c,m,v,b,_){var A=2;if(v=o,typeof o=="function")Ud(o)&&(A=1);else if(typeof o=="string")A=5;else e:switch(o){case P:return Ls(m.children,b,_,c);case j:A=8,b|=8;break;case F:return o=wr(12,m,c,b|2),o.elementType=F,o.lanes=_,o;case ne:return o=wr(13,m,c,b),o.elementType=ne,o.lanes=_,o;case se:return o=wr(19,m,c,b),o.elementType=se,o.lanes=_,o;case ie:return Tl(m,b,_,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case D:A=10;break e;case $:A=9;break e;case J:A=11;break e;case X:A=14;break e;case Z:A=16,v=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return c=wr(A,m,c,b),c.elementType=o,c.type=v,c.lanes=_,c}function Ls(o,c,m,v){return o=wr(7,o,v,c),o.lanes=m,o}function Tl(o,c,m,v){return o=wr(22,o,v,c),o.elementType=ie,o.lanes=m,o.stateNode={isHidden:!1},o}function Bd(o,c,m){return o=wr(6,o,null,c),o.lanes=m,o}function $d(o,c,m){return c=wr(4,o.children!==null?o.children:[],o.key,c),c.lanes=m,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function hS(o,c,m,v,b){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mu(0),this.expirationTimes=mu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mu(0),this.identifierPrefix=v,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function Vd(o,c,m,v,b,_,A,M,B){return o=new hS(o,c,m,M,B),c===1?(c=1,_===!0&&(c|=8)):c=0,_=wr(3,null,null,c),o.current=_,_.stateNode=o,_.memoizedState={element:v,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},td(_),o}function mS(o,c,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:v==null?null:""+v,children:o,containerInfo:c,implementation:m}}function tg(o){if(!o)return Kn;o=o._reactInternals;e:{if(vs(o)!==o||o.tag!==1)throw Error(t(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Zt(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(o.tag===1){var m=o.type;if(Zt(m))return Am(o,m,c)}return c}function rg(o,c,m,v,b,_,A,M,B){return o=Vd(m,v,!0,o,b,_,A,M,B),o.context=tg(null),m=o.current,v=Yt(),b=Jn(m),_=xn(v,b),_.callback=c??null,Yn(m,_,b),o.current.lanes=b,sa(o,b,v),tr(o,v),o}function _l(o,c,m,v){var b=c.current,_=Yt(),A=Jn(b);return m=tg(m),c.context===null?c.context=m:c.pendingContext=m,c=xn(_,A),c.payload={element:o},v=v===void 0?null:v,v!==null&&(c.callback=v),o=Yn(b,c,A),o!==null&&(jr(o,b,A,_),rl(o,b,A)),A}function kl(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function ng(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var m=o.retryLane;o.retryLane=m!==0&&m<c?m:c}}function Gd(o,c){ng(o,c),(o=o.alternate)&&ng(o,c)}function pS(){return null}var sg=typeof reportError=="function"?reportError:function(o){console.error(o)};function Hd(o){this._internalRoot=o}Cl.prototype.render=Hd.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(t(409));_l(o,c,null,null)},Cl.prototype.unmount=Hd.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;Cs(function(){_l(null,o,null,null)}),c[fn]=null}};function Cl(o){this._internalRoot=o}Cl.prototype.unstable_scheduleHydration=function(o){if(o){var c=$0();o={blockedOn:null,target:o,priority:c};for(var m=0;m<$n.length&&c!==0&&c<$n[m].priority;m++);$n.splice(m,0,o),m===0&&H0(o)}};function qd(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Il(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function ig(){}function gS(o,c,m,v,b){if(b){if(typeof v=="function"){var _=v;v=function(){var Y=kl(A);_.call(Y)}}var A=rg(c,v,o,0,null,!1,!1,"",ig);return o._reactRootContainer=A,o[fn]=A.current,va(o.nodeType===8?o.parentNode:o),Cs(),A}for(;b=o.lastChild;)o.removeChild(b);if(typeof v=="function"){var M=v;v=function(){var Y=kl(B);M.call(Y)}}var B=Vd(o,0,!1,null,null,!1,!1,"",ig);return o._reactRootContainer=B,o[fn]=B.current,va(o.nodeType===8?o.parentNode:o),Cs(function(){_l(c,B,m,v)}),B}function Al(o,c,m,v,b){var _=m._reactRootContainer;if(_){var A=_;if(typeof b=="function"){var M=b;b=function(){var B=kl(A);M.call(B)}}_l(c,A,o,b)}else A=gS(m,c,o,b,v);return kl(A)}U0=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var m=na(c.pendingLanes);m!==0&&(pu(c,m|1),tr(c,yt()),(qe&6)===0&&(yi=yt()+500,zn()))}break;case 13:Cs(function(){var v=gn(o,1);if(v!==null){var b=Yt();jr(v,o,1,b)}}),Gd(o,1)}},gu=function(o){if(o.tag===13){var c=gn(o,134217728);if(c!==null){var m=Yt();jr(c,o,134217728,m)}Gd(o,134217728)}},B0=function(o){if(o.tag===13){var c=Jn(o),m=gn(o,c);if(m!==null){var v=Yt();jr(m,o,c,v)}Gd(o,c)}},$0=function(){return We},V0=function(o,c){var m=We;try{return We=o,c()}finally{We=m}},lu=function(o,c,m){switch(c){case"input":if(Fe(o,m),c=m.name,m.type==="radio"&&c!=null){for(m=o;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<m.length;c++){var v=m[c];if(v!==o&&v.form===o.form){var b=Ko(v);if(!b)throw Error(t(90));ke(v),Fe(v,b)}}}break;case"textarea":dn(o,m);break;case"select":c=m.value,c!=null&&Xe(o,!!m.multiple,c,!1)}},k0=jd,C0=Cs;var xS={usingClientEntryPoint:!1,Events:[wa,ai,Ko,T0,_0,jd]},Oa={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vS={bundleType:Oa.bundleType,version:Oa.version,rendererPackageName:Oa.rendererPackageName,rendererConfig:Oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=R0(o),o===null?null:o.stateNode},findFiberByHostInstance:Oa.findFiberByHostInstance||pS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ll.isDisabled&&Ll.supportsFiber)try{Co=Ll.inject(vS),Gr=Ll}catch{}}return rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xS,rr.createPortal=function(o,c){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qd(c))throw Error(t(200));return mS(o,c,null,m)},rr.createRoot=function(o,c){if(!qd(o))throw Error(t(299));var m=!1,v="",b=sg;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(b=c.onRecoverableError)),c=Vd(o,1,!1,null,null,m,!1,v,b),o[fn]=c.current,va(o.nodeType===8?o.parentNode:o),new Hd(c)},rr.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=R0(c),o=o===null?null:o.stateNode,o},rr.flushSync=function(o){return Cs(o)},rr.hydrate=function(o,c,m){if(!Il(c))throw Error(t(200));return Al(null,o,c,!0,m)},rr.hydrateRoot=function(o,c,m){if(!qd(o))throw Error(t(405));var v=m!=null&&m.hydratedSources||null,b=!1,_="",A=sg;if(m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(_=m.identifierPrefix),m.onRecoverableError!==void 0&&(A=m.onRecoverableError)),c=rg(c,null,o,1,m??null,b,!1,_,A),o[fn]=c.current,va(o),v)for(o=0;o<v.length;o++)m=v[o],b=m._getVersion,b=b(m._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[m,b]:c.mutableSourceEagerHydrationData.push(m,b);return new Cl(c)},rr.render=function(o,c,m){if(!Il(c))throw Error(t(200));return Al(null,o,c,!1,m)},rr.unmountComponentAtNode=function(o){if(!Il(o))throw Error(t(40));return o._reactRootContainer?(Cs(function(){Al(null,null,o,!1,function(){o._reactRootContainer=null,o[fn]=null})}),!0):!1},rr.unstable_batchedUpdates=jd,rr.unstable_renderSubtreeIntoContainer=function(o,c,m,v){if(!Il(m))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return Al(o,c,m,!1,v)},rr.version="18.3.1-next-f1338f8080-20240426",rr}var hg;function Hv(){if(hg)return Wd.exports;hg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Wd.exports=kS(),Wd.exports}var mg;function CS(){if(mg)return Rl;mg=1;var n=Hv();return Rl.createRoot=n.createRoot,Rl.hydrateRoot=n.hydrateRoot,Rl}var IS=CS(),R=kh();const _n=ES(R);/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var pg="popstate";function AS(n={}){function e(r,s){let{pathname:i,search:a,hash:l}=r.location;return Wf("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Ja(s)}return RS(e,t,null,n)}function mt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Vr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LS(){return Math.random().toString(36).substring(2,10)}function gg(n,e){return{usr:n.state,key:n.key,idx:e}}function Wf(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Yi(e):e,state:t,key:e&&e.key||r||LS()}}function Ja({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Yi(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function RS(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l="POP",d=null,u=h();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function h(){return(a.state||{idx:null}).idx}function p(){l="POP";let w=h(),S=w==null?null:w-u;u=w,d&&d({action:l,location:E.location,delta:S})}function g(w,S){l="PUSH";let T=Wf(E.location,w,S);u=h()+1;let k=gg(T,u),I=E.createHref(T);try{a.pushState(k,"",I)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(I)}i&&d&&d({action:l,location:E.location,delta:1})}function x(w,S){l="REPLACE";let T=Wf(E.location,w,S);u=h();let k=gg(T,u),I=E.createHref(T);a.replaceState(k,"",I),i&&d&&d({action:l,location:E.location,delta:0})}function y(w){return NS(w)}let E={get action(){return l},get location(){return n(s,a)},listen(w){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(pg,p),d=w,()=>{s.removeEventListener(pg,p),d=null}},createHref(w){return e(s,w)},createURL:y,encodeLocation(w){let S=y(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:g,replace:x,go(w){return a.go(w)}};return E}function NS(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),mt(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Ja(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function qv(n,e,t="/"){return DS(n,e,t,!1)}function DS(n,e,t,r){let s=typeof e=="string"?Yi(e):e,i=In(s.pathname||"/",t);if(i==null)return null;let a=Kv(n);PS(a);let l=null;for(let d=0;l==null&&d<a.length;++d){let u=qS(i);l=GS(a[d],u,r)}return l}function Kv(n,e=[],t=[],r="",s=!1){let i=(a,l,d=s,u)=>{let h={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&d)return;mt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Cn([r,h.relativePath]),g=t.concat(h);a.children&&a.children.length>0&&(mt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Kv(a.children,e,g,p,d)),!(a.path==null&&!a.index)&&e.push({path:p,score:$S(p,a.index),routesMeta:g})};return n.forEach((a,l)=>{if(a.path===""||!a.path?.includes("?"))i(a,l);else for(let d of zv(a.path))i(a,l,!0,d)}),e}function zv(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=zv(r.join("/")),l=[];return l.push(...a.map(d=>d===""?i:[i,d].join("/"))),s&&l.push(...a),l.map(d=>n.startsWith("/")&&d===""?"/":d)}function PS(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:VS(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var OS=/^:[\w-]+$/,jS=3,MS=2,FS=1,US=10,BS=-2,xg=n=>n==="*";function $S(n,e){let t=n.split("/"),r=t.length;return t.some(xg)&&(r+=BS),e&&(r+=MS),t.filter(s=>!xg(s)).reduce((s,i)=>s+(OS.test(i)?jS:i===""?FS:US),r)}function VS(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function GS(n,e,t=!1){let{routesMeta:r}=n,s={},i="/",a=[];for(let l=0;l<r.length;++l){let d=r[l],u=l===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=fc({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},h),g=d.route;if(!p&&u&&t&&!r[r.length-1].route.index&&(p=fc({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),a.push({params:s,pathname:Cn([i,p.pathname]),pathnameBase:YS(Cn([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=Cn([i,p.pathnameBase]))}return a}function fc(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=HS(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,{paramName:h,isOptional:p},g)=>{if(h==="*"){let y=l[g]||"";a=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const x=l[g];return p&&!x?u[h]=void 0:u[h]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:n}}function HS(n,e=!1,t=!0){Vr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,d)=>(r.push({paramName:l,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function qS(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Vr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function In(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var Wv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KS=n=>Wv.test(n);function zS(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Yi(n):n,i;if(t)if(KS(t))i=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),Vr(!1,`Pathnames cannot have embedded double slashes - normalizing ${a} -> ${t}`)}t.startsWith("/")?i=vg(t.substring(1),"/"):i=vg(t,e)}else i=e;return{pathname:i,search:QS(r),hash:XS(s)}}function vg(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Xd(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function WS(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Yv(n){let e=WS(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Qv(n,e,t,r=!1){let s;typeof n=="string"?s=Yi(n):(s={...n},mt(!s.pathname||!s.pathname.includes("?"),Xd("?","pathname","search",s)),mt(!s.pathname||!s.pathname.includes("#"),Xd("#","pathname","hash",s)),mt(!s.search||!s.search.includes("#"),Xd("#","search","hash",s)));let i=n===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=t;else{let p=e.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}l=p>=0?e[p]:"/"}let d=zS(s,l),u=a&&a!=="/"&&a.endsWith("/"),h=(i||a===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(u||h)&&(d.pathname+="/"),d}var Cn=n=>n.join("/").replace(/\/\/+/g,"/"),YS=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),QS=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,XS=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,ZS=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function JS(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function eT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Xv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Zv(n,e){let t=n;if(typeof t!="string"||!Wv.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,s=!1;if(Xv)try{let i=new URL(window.location.href),a=t.startsWith("//")?new URL(i.protocol+t):new URL(t),l=In(a.pathname,e);a.origin===i.origin&&l!=null?t=l+a.search+a.hash:s=!0}catch{Vr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Jv=["POST","PUT","PATCH","DELETE"];new Set(Jv);var tT=["GET",...Jv];new Set(tT);var Qi=R.createContext(null);Qi.displayName="DataRouter";var Bc=R.createContext(null);Bc.displayName="DataRouterState";var rT=R.createContext(!1),ey=R.createContext({isTransitioning:!1});ey.displayName="ViewTransition";var nT=R.createContext(new Map);nT.displayName="Fetchers";var sT=R.createContext(null);sT.displayName="Await";var _r=R.createContext(null);_r.displayName="Navigation";var ho=R.createContext(null);ho.displayName="Location";var an=R.createContext({outlet:null,matches:[],isDataRoute:!1});an.displayName="Route";var Ch=R.createContext(null);Ch.displayName="RouteError";var ty="REACT_ROUTER_ERROR",iT="REDIRECT",aT="ROUTE_ERROR_RESPONSE";function oT(n){if(n.startsWith(`${ty}:${iT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function lT(n){if(n.startsWith(`${ty}:${aT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new ZS(e.status,e.statusText,e.data)}catch{}}function cT(n,{relative:e}={}){mt(mo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=R.useContext(_r),{hash:s,pathname:i,search:a}=po(n,{relative:e}),l=i;return t!=="/"&&(l=i==="/"?t:Cn([t,i])),r.createHref({pathname:l,search:a,hash:s})}function mo(){return R.useContext(ho)!=null}function Hs(){return mt(mo(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(ho).location}var ry="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ny(n){R.useContext(_r).static||R.useLayoutEffect(n)}function Nn(){let{isDataRoute:n}=R.useContext(an);return n?ST():uT()}function uT(){mt(mo(),"useNavigate() may be used only in the context of a <Router> component.");let n=R.useContext(Qi),{basename:e,navigator:t}=R.useContext(_r),{matches:r}=R.useContext(an),{pathname:s}=Hs(),i=JSON.stringify(Yv(r)),a=R.useRef(!1);return ny(()=>{a.current=!0}),R.useCallback((d,u={})=>{if(Vr(a.current,ry),!a.current)return;if(typeof d=="number"){t.go(d);return}let h=Qv(d,JSON.parse(i),s,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Cn([e,h.pathname])),(u.replace?t.replace:t.push)(h,u.state,u)},[e,t,i,s,n])}R.createContext(null);function dT(){let{matches:n}=R.useContext(an),e=n[n.length-1];return e?e.params:{}}function po(n,{relative:e}={}){let{matches:t}=R.useContext(an),{pathname:r}=Hs(),s=JSON.stringify(Yv(t));return R.useMemo(()=>Qv(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function fT(n,e){return sy(n,e)}function sy(n,e,t,r,s){mt(mo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=R.useContext(_r),{matches:a}=R.useContext(an),l=a[a.length-1],d=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",p=l&&l.route;{let T=p&&p.path||"";ay(u,!p||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let g=Hs(),x;if(e){let T=typeof e=="string"?Yi(e):e;mt(h==="/"||T.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${T.pathname}" was given in the \`location\` prop.`),x=T}else x=g;let y=x.pathname||"/",E=y;if(h!=="/"){let T=h.replace(/^\//,"").split("/");E="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=qv(n,{pathname:E});Vr(p||w!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Vr(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let S=xT(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},d,T.params),pathname:Cn([h,i.encodeLocation?i.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:Cn([h,i.encodeLocation?i.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),a,t,r,s);return e&&S?R.createElement(ho.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},S):S}function hT(){let n=bT(),e=JS(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=R.createElement(R.Fragment,null,R.createElement("p",null," Hey developer "),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:i},"ErrorBoundary")," or"," ",R.createElement("code",{style:i},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),t?R.createElement("pre",{style:s},t):null,a)}var mT=R.createElement(hT,null),iy=class extends R.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=lT(n.digest);t&&(n=t)}let e=n!==void 0?R.createElement(an.Provider,{value:this.props.routeContext},R.createElement(Ch.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?R.createElement(pT,{error:n},e):e}};iy.contextType=rT;var Zd=new WeakMap;function pT({children:n,error:e}){let{basename:t}=R.useContext(_r);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=oT(e.digest);if(r){let s=Zd.get(e);if(s)throw s;let i=Zv(r.location,t);if(Xv&&!Zd.get(e))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const a=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw Zd.set(e,a),a}return R.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return n}function gT({routeContext:n,match:e,children:t}){let r=R.useContext(Qi);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),R.createElement(an.Provider,{value:n},t)}function xT(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,a=t?.errors;if(a!=null){let h=i.findIndex(p=>p.route.id&&a?.[p.route.id]!==void 0);mt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let l=!1,d=-1;if(t)for(let h=0;h<i.length;h++){let p=i[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:g,errors:x}=t,y=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!x||x[p.route.id]===void 0);if(p.route.lazy||y){l=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let u=t&&r?(h,p)=>{r(h,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:eT(t.matches),errorInfo:p})}:void 0;return i.reduceRight((h,p,g)=>{let x,y=!1,E=null,w=null;t&&(x=a&&p.route.id?a[p.route.id]:void 0,E=p.route.errorElement||mT,l&&(d<0&&g===0?(ay("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):d===g&&(y=!0,w=p.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,g+1)),T=()=>{let k;return x?k=E:y?k=w:p.route.Component?k=R.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=h,R.createElement(gT,{match:p,routeContext:{outlet:h,matches:S,isDataRoute:t!=null},children:k})};return t&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?R.createElement(iy,{location:t.location,revalidation:t.revalidation,component:E,error:x,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0},onError:u}):T()},null)}function Ih(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vT(n){let e=R.useContext(Qi);return mt(e,Ih(n)),e}function yT(n){let e=R.useContext(Bc);return mt(e,Ih(n)),e}function ET(n){let e=R.useContext(an);return mt(e,Ih(n)),e}function Ah(n){let e=ET(n),t=e.matches[e.matches.length-1];return mt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function wT(){return Ah("useRouteId")}function bT(){let n=R.useContext(Ch),e=yT("useRouteError"),t=Ah("useRouteError");return n!==void 0?n:e.errors?.[t]}function ST(){let{router:n}=vT("useNavigate"),e=Ah("useNavigate"),t=R.useRef(!1);return ny(()=>{t.current=!0}),R.useCallback(async(s,i={})=>{Vr(t.current,ry),t.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:e,...i}))},[n,e])}var yg={};function ay(n,e,t){!e&&!yg[n]&&(yg[n]=!0,Vr(!1,t))}R.memo(TT);function TT({routes:n,future:e,state:t,onError:r}){return sy(n,void 0,t,r,e)}function Qr(n){mt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _T({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:a}){mt(!mo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:l,navigator:s,static:i,unstable_useTransitions:a,future:{}}),[l,s,i,a]);typeof t=="string"&&(t=Yi(t));let{pathname:u="/",search:h="",hash:p="",state:g=null,key:x="default"}=t,y=R.useMemo(()=>{let E=In(u,l);return E==null?null:{location:{pathname:E,search:h,hash:p,state:g,key:x},navigationType:r}},[l,u,h,p,g,x,r]);return Vr(y!=null,`<Router basename="${l}"> is not able to match the URL "${u}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:R.createElement(_r.Provider,{value:d},R.createElement(ho.Provider,{children:e,value:y}))}function kT({children:n,location:e}){return fT(Yf(n),e)}function Yf(n,e=[]){let t=[];return R.Children.forEach(n,(r,s)=>{if(!R.isValidElement(r))return;let i=[...e,s];if(r.type===R.Fragment){t.push.apply(t,Yf(r.props.children,i));return}mt(r.type===Qr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Yf(r.props.children,i)),t.push(a)}),t}var ec="get",tc="application/x-www-form-urlencoded";function $c(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function CT(n){return $c(n)&&n.tagName.toLowerCase()==="button"}function IT(n){return $c(n)&&n.tagName.toLowerCase()==="form"}function AT(n){return $c(n)&&n.tagName.toLowerCase()==="input"}function LT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function RT(n,e){return n.button===0&&(!e||e==="_self")&&!LT(n)}var Nl=null;function NT(){if(Nl===null)try{new FormData(document.createElement("form"),0),Nl=!1}catch{Nl=!0}return Nl}var DT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Jd(n){return n!=null&&!DT.has(n)?(Vr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${tc}"`),null):n}function PT(n,e){let t,r,s,i,a;if(IT(n)){let l=n.getAttribute("action");r=l?In(l,e):null,t=n.getAttribute("method")||ec,s=Jd(n.getAttribute("enctype"))||tc,i=new FormData(n)}else if(CT(n)||AT(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=n.getAttribute("formaction")||l.getAttribute("action");if(r=d?In(d,e):null,t=n.getAttribute("formmethod")||l.getAttribute("method")||ec,s=Jd(n.getAttribute("formenctype"))||Jd(l.getAttribute("enctype"))||tc,i=new FormData(l,n),!NT()){let{name:u,type:h,value:p}=n;if(h==="image"){let g=u?`${u}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else u&&i.append(u,p)}}else{if($c(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ec,r=null,s=tc,a=n}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Lh(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function OT(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&In(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function jT(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function MT(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function FT(n,e,t){let r=await Promise.all(n.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await jT(i,t);return a.links?a.links():[]}return[]}));return VT(r.flat(1).filter(MT).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Eg(n,e,t,r,s,i){let a=(d,u)=>t[u]?d.route.id!==t[u].route.id:!0,l=(d,u)=>t[u].pathname!==d.pathname||t[u].route.path?.endsWith("*")&&t[u].params["*"]!==d.params["*"];return i==="assets"?e.filter((d,u)=>a(d,u)||l(d,u)):i==="data"?e.filter((d,u)=>{let h=r.routes[d.route.id];if(!h||!h.hasLoader)return!1;if(a(d,u)||l(d,u))return!0;if(d.route.shouldRevalidate){let p=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function UT(n,e,{includeHydrateFallback:t}={}){return BT(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function BT(n){return[...new Set(n)]}function $T(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function VT(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let i=JSON.stringify($T(s));return t.has(i)||(t.add(i),r.push({key:i,link:s})),r},[])}function oy(){let n=R.useContext(Qi);return Lh(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function GT(){let n=R.useContext(Bc);return Lh(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Rh=R.createContext(void 0);Rh.displayName="FrameworkContext";function ly(){let n=R.useContext(Rh);return Lh(n,"You must render this element inside a <HydratedRouter> element"),n}function HT(n,e){let t=R.useContext(Rh),[r,s]=R.useState(!1),[i,a]=R.useState(!1),{onFocus:l,onBlur:d,onMouseEnter:u,onMouseLeave:h,onTouchStart:p}=e,g=R.useRef(null);R.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let E=S=>{S.forEach(T=>{a(T.isIntersecting)})},w=new IntersectionObserver(E,{threshold:.5});return g.current&&w.observe(g.current),()=>{w.disconnect()}}},[n]),R.useEffect(()=>{if(r){let E=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(E)}}},[r]);let x=()=>{s(!0)},y=()=>{s(!1),a(!1)};return t?n!=="intent"?[i,g,{}]:[i,g,{onFocus:Ma(l,x),onBlur:Ma(d,y),onMouseEnter:Ma(u,x),onMouseLeave:Ma(h,y),onTouchStart:Ma(p,x)}]:[!1,g,{}]}function Ma(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function qT({page:n,...e}){let{router:t}=oy(),r=R.useMemo(()=>qv(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?R.createElement(zT,{page:n,matches:r,...e}):null}function KT(n){let{manifest:e,routeModules:t}=ly(),[r,s]=R.useState([]);return R.useEffect(()=>{let i=!1;return FT(n,e,t).then(a=>{i||s(a)}),()=>{i=!0}},[n,e,t]),r}function zT({page:n,matches:e,...t}){let r=Hs(),{manifest:s,routeModules:i}=ly(),{basename:a}=oy(),{loaderData:l,matches:d}=GT(),u=R.useMemo(()=>Eg(n,e,d,s,r,"data"),[n,e,d,s,r]),h=R.useMemo(()=>Eg(n,e,d,s,r,"assets"),[n,e,d,s,r]),p=R.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,E=!1;if(e.forEach(S=>{let T=s.routes[S.route.id];!T||!T.hasLoader||(!u.some(k=>k.route.id===S.route.id)&&S.route.id in l&&i[S.route.id]?.shouldRevalidate||T.hasClientLoader?E=!0:y.add(S.route.id))}),y.size===0)return[];let w=OT(n,a,"data");return E&&y.size>0&&w.searchParams.set("_routes",e.filter(S=>y.has(S.route.id)).map(S=>S.route.id).join(",")),[w.pathname+w.search]},[a,l,r,s,u,e,n,i]),g=R.useMemo(()=>UT(h,s),[h,s]),x=KT(h);return R.createElement(R.Fragment,null,p.map(y=>R.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),g.map(y=>R.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),x.map(({key:y,link:E})=>R.createElement("link",{key:y,nonce:t.nonce,...E})))}function WT(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var YT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{YT&&(window.__reactRouterVersion="7.11.0")}catch{}function QT({basename:n,children:e,unstable_useTransitions:t,window:r}){let s=R.useRef();s.current==null&&(s.current=AS({window:r,v5Compat:!0}));let i=s.current,[a,l]=R.useState({action:i.action,location:i.location}),d=R.useCallback(u=>{t===!1?l(u):R.startTransition(()=>l(u))},[t]);return R.useLayoutEffect(()=>i.listen(d),[i,d]),R.createElement(_T,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:i,unstable_useTransitions:t})}var cy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uy=R.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:l,target:d,to:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:g,...x},y){let{basename:E,unstable_useTransitions:w}=R.useContext(_r),S=typeof u=="string"&&cy.test(u),T=Zv(u,E);u=T.to;let k=cT(u,{relative:s}),[I,L,O]=HT(r,x),P=e_(u,{replace:a,state:l,target:d,preventScrollReset:h,relative:s,viewTransition:p,unstable_defaultShouldRevalidate:g,unstable_useTransitions:w});function j(D){e&&e(D),D.defaultPrevented||P(D)}let F=R.createElement("a",{...x,...O,href:T.absoluteURL||k,onClick:T.isExternal||i?e:j,ref:WT(y,L),target:d,"data-discover":!S&&t==="render"?"true":void 0});return I&&!S?R.createElement(R.Fragment,null,F,R.createElement(qT,{page:k})):F});uy.displayName="Link";var XT=R.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:l,children:d,...u},h){let p=po(a,{relative:u.relative}),g=Hs(),x=R.useContext(Bc),{navigator:y,basename:E}=R.useContext(_r),w=x!=null&&i_(p)&&l===!0,S=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,T=g.pathname,k=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;t||(T=T.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&E&&(k=In(k,E)||k);const I=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let L=T===S||!s&&T.startsWith(S)&&T.charAt(I)==="/",O=k!=null&&(k===S||!s&&k.startsWith(S)&&k.charAt(S.length)==="/"),P={isActive:L,isPending:O,isTransitioning:w},j=L?e:void 0,F;typeof r=="function"?F=r(P):F=[r,L?"active":null,O?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let D=typeof i=="function"?i(P):i;return R.createElement(uy,{...u,"aria-current":j,className:F,ref:h,style:D,to:a,viewTransition:l},typeof d=="function"?d(P):d)});XT.displayName="NavLink";var ZT=R.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:i,method:a=ec,action:l,onSubmit:d,relative:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:g,...x},y)=>{let{unstable_useTransitions:E}=R.useContext(_r),w=n_(),S=s_(l,{relative:u}),T=a.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&cy.test(l),I=L=>{if(d&&d(L),L.defaultPrevented)return;L.preventDefault();let O=L.nativeEvent.submitter,P=O?.getAttribute("formmethod")||a,j=()=>w(O||L.currentTarget,{fetcherKey:e,method:P,navigate:t,replace:s,state:i,relative:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:g});E&&t!==!1?R.startTransition(()=>j()):j()};return R.createElement("form",{ref:y,method:T,action:S,onSubmit:r?d:I,...x,"data-discover":!k&&n==="render"?"true":void 0})});ZT.displayName="Form";function JT(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dy(n){let e=R.useContext(Qi);return mt(e,JT(n)),e}function e_(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:i,viewTransition:a,unstable_defaultShouldRevalidate:l,unstable_useTransitions:d}={}){let u=Nn(),h=Hs(),p=po(n,{relative:i});return R.useCallback(g=>{if(RT(g,e)){g.preventDefault();let x=t!==void 0?t:Ja(h)===Ja(p),y=()=>u(n,{replace:x,state:r,preventScrollReset:s,relative:i,viewTransition:a,unstable_defaultShouldRevalidate:l});d?R.startTransition(()=>y()):y()}},[h,u,p,t,r,e,n,s,i,a,l,d])}var t_=0,r_=()=>`__${String(++t_)}__`;function n_(){let{router:n}=dy("useSubmit"),{basename:e}=R.useContext(_r),t=wT(),r=n.fetch,s=n.navigate;return R.useCallback(async(i,a={})=>{let{action:l,method:d,encType:u,formData:h,body:p}=PT(i,e);if(a.navigate===!1){let g=a.fetcherKey||r_();await r(g,t,a.action||l,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:h,body:p,formMethod:a.method||d,formEncType:a.encType||u,flushSync:a.flushSync})}else await s(a.action||l,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:h,body:p,formMethod:a.method||d,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,s,e,t])}function s_(n,{relative:e}={}){let{basename:t}=R.useContext(_r),r=R.useContext(an);mt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...po(n||".",{relative:e})},a=Hs();if(n==null){i.search=a.search;let l=new URLSearchParams(i.search),d=l.getAll("index");if(d.some(h=>h==="")){l.delete("index"),d.filter(p=>p).forEach(p=>l.append("index",p));let h=l.toString();i.search=h?`?${h}`:""}}return(!n||n===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Cn([t,i.pathname])),Ja(i)}function i_(n,{relative:e}={}){let t=R.useContext(ey);mt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=dy("useViewTransitionState"),s=po(n,{relative:e});if(!t.isTransitioning)return!1;let i=In(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=In(t.nextLocation.pathname,r)||t.nextLocation.pathname;return fc(s.pathname,a)!=null||fc(s.pathname,i)!=null}var a_=Hv();const Ps={p16308a80:"M14.9625 0H17.8763L11.5113 7.29329L19 17.2194H13.1371L8.54186 11.2005L3.28971 17.2194H0.373214L7.18064 9.41586L0 0.00135713H6.01214L10.1596 5.50186L14.9625 0ZM13.9379 15.4714H15.5529L5.13 1.65707H3.39829L13.9379 15.4714Z",p1e086000:"M5 3.5H19C19.3978 3.5 19.7792 3.65815 20.0605 3.93945C20.3419 4.22076 20.5 4.60218 20.5 5V19C20.5 19.3978 20.3419 19.7792 20.0605 20.0605C19.7792 20.3419 19.3978 20.5 19 20.5H5C4.60218 20.5 4.22076 20.3419 3.93945 20.0605C3.65815 19.7792 3.5 19.3978 3.5 19V5C3.5 4.60218 3.65815 4.22076 3.93945 3.93945C4.22076 3.65815 4.60218 3.5 5 3.5ZM5 19H8.76953V9.62988H5V19ZM15.2402 9.44043C14.6307 9.44043 13.9731 9.65806 13.4199 10.0322V9.62988H9.62988V19H13.4199V13.5703C13.4199 13.0719 13.8206 12.6702 14.3096 12.6699C14.5482 12.6699 14.7775 12.7648 14.9463 12.9336C15.1151 13.1024 15.21 13.3316 15.21 13.5703V19H19V13.2002C19 12.203 18.6036 11.2462 17.8984 10.541C17.1934 9.83611 16.2372 9.44049 15.2402 9.44043ZM6.87988 4.69043C6.2991 4.69046 5.74173 4.92038 5.33105 5.33105C4.92038 5.74173 4.69046 6.2991 4.69043 6.87988C4.69043 8.08984 5.67767 9.05951 6.87988 9.05957C7.45805 9.05957 8.01305 8.8307 8.42188 8.42188C8.8307 8.01305 9.05957 7.45805 9.05957 6.87988C9.05951 5.67767 8.08984 4.69043 6.87988 4.69043Z",p2c5f2300:"M7.8 2H16.2C19.4 2 22 4.6 22 7.8V16.2C22 17.7383 21.3889 19.2135 20.3012 20.3012C19.2135 21.3889 17.7383 22 16.2 22H7.8C4.6 22 2 19.4 2 16.2V7.8C2 6.26174 2.61107 4.78649 3.69878 3.69878C4.78649 2.61107 6.26174 2 7.8 2ZM7.6 4C6.64522 4 5.72955 4.37928 5.05442 5.05442C4.37928 5.72955 4 6.64522 4 7.6V16.4C4 18.39 5.61 20 7.6 20H16.4C17.3548 20 18.2705 19.6207 18.9456 18.9456C19.6207 18.2705 20 17.3548 20 16.4V7.6C20 5.61 18.39 4 16.4 4H7.6ZM17.25 5.5C17.5815 5.5 17.8995 5.6317 18.1339 5.86612C18.3683 6.10054 18.5 6.41848 18.5 6.75C18.5 7.08152 18.3683 7.39946 18.1339 7.63388C17.8995 7.8683 17.5815 8 17.25 8C16.9185 8 16.6005 7.8683 16.3661 7.63388C16.1317 7.39946 16 7.08152 16 6.75C16 6.41848 16.1317 6.10054 16.3661 5.86612C16.6005 5.6317 16.9185 5.5 17.25 5.5ZM12 7C13.3261 7 14.5979 7.52678 15.5355 8.46447C16.4732 9.40215 17 10.6739 17 12C17 13.3261 16.4732 14.5979 15.5355 15.5355C14.5979 16.4732 13.3261 17 12 17C10.6739 17 9.40215 16.4732 8.46447 15.5355C7.52678 14.5979 7 13.3261 7 12C7 10.6739 7.52678 9.40215 8.46447 8.46447C9.40215 7.52678 10.6739 7 12 7ZM12 9C11.2044 9 10.4413 9.31607 9.87868 9.87868C9.31607 10.4413 9 11.2044 9 12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12C15 11.2044 14.6839 10.4413 14.1213 9.87868C13.5587 9.31607 12.7956 9 12 9Z"};function fy(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=fy(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function ee(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=fy(n))&&(r&&(r+=" "),r+=e);return r}const xe=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},o_=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=l_},l_=Number.MAX_SAFE_INTEGER||9007199254740991;let Te=(function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n})({}),q=(function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n})({}),C=(function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n})({});var Be={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ye={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class wi{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class c_{constructor(e,t,r,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new wi(e),this.fast_=new wi(t),this.defaultTTFB_=s,this.ttfb_=new wi(e)}update(e,t){const{slow_:r,fast_:s,ttfb_:i}=this;r.halfLife!==e&&(this.slow_=new wi(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.fast_=new wi(t,s.getEstimate(),s.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new wi(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,s=e/1e3,i=r/s;this.fast_.sample(s,i),this.slow_.sample(s,i)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function u_(n,e,t){return(e=f_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ze(){return Ze=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ze.apply(null,arguments)}function wg(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Ye(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wg(Object(t),!0).forEach(function(r){u_(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wg(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function d_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function f_(n){var e=d_(n,"string");return typeof e=="symbol"?e:e+""}class kr{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=as,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const as=function(){},h_={trace:as,debug:as,log:as,warn:as,info:as,error:as};function Qf(){return Ze({},h_)}function m_(n,e){const t=self.console[n];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${n}] >`):as}function bg(n,e,t){return e[n]?e[n].bind(e):m_(n,t)}const Xf=Qf();function p_(n,e,t){const r=Qf();if(typeof console=="object"&&n===!0||typeof n=="object"){const s=["debug","log","info","warn","error"];s.forEach(i=>{r[i]=bg(i,n,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Qf()}s.forEach(i=>{Xf[i]=bg(i,n)})}else Ze(Xf,r);return r}const Qe=Xf;function fs(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function g_(n){return typeof self<"u"&&n===self.ManagedMediaSource}function hy(n,e){const t=Object.keys(n),r=Object.keys(e),s=t.length,i=r.length;return!s||!i||s===i&&!t.some(a=>r.indexOf(a)===-1)}function pr(n,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(n);if(e){const h=u.indexOf("\0");return h!==-1?u.substring(0,h):u}return u.replace(/\0/g,"")}const t=n.length;let r,s,i,a="",l=0;for(;l<t;){if(r=n[l++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:s=n[l++],a+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[l++],i=n[l++],a+=String.fromCharCode((r&15)<<12|(s&63)<<6|(i&63)<<0);break}}return a}function Ut(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function my(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function x_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ef={exports:{}},Sg;function v_(){return Sg||(Sg=1,(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(d,u,h){if(h=h||{},d=d.trim(),u=u.trim(),!u){if(!h.alwaysNormalize)return d;var p=l.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=l.normalizePath(p.path),l.buildURLFromParts(p)}var g=l.parseURL(u);if(!g)throw new Error("Error trying to parse relative URL.");if(g.scheme)return h.alwaysNormalize?(g.path=l.normalizePath(g.path),l.buildURLFromParts(g)):u;var x=l.parseURL(d);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var y=s.exec(x.path);x.netLoc=y[1],x.path=y[2]}x.netLoc&&!x.path&&(x.path="/");var E={scheme:x.scheme,netLoc:g.netLoc,path:null,params:g.params,query:g.query,fragment:g.fragment};if(!g.netLoc&&(E.netLoc=x.netLoc,g.path[0]!=="/"))if(!g.path)E.path=x.path,g.params||(E.params=x.params,g.query||(E.query=x.query));else{var w=x.path,S=w.substring(0,w.lastIndexOf("/")+1)+g.path;E.path=l.normalizePath(S)}return E.path===null&&(E.path=h.alwaysNormalize?l.normalizePath(g.path):g.path),l.buildURLFromParts(E)},parseURL:function(d){var u=r.exec(d);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(i,"");d.length!==(d=d.replace(a,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};n.exports=l})()})(ef)),ef.exports}var Nh=v_();class Dh{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var et={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class py{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,E_(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let s;r.length===1?s=t?.byteRangeEndOffset||0:s=parseInt(r[1]),this._byteRange=[s,parseInt(r[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[et.AUDIO]:null,[et.VIDEO]:null,[et.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Dh),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Nh.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[et.AUDIO]=null,e[et.VIDEO]=null,e[et.AUDIOVIDEO]=null}}function wt(n){return n.sn!=="initSegment"}class tf extends py{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(xe(e)&&xe(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const r=Object.keys(t);if(r.length===1){const s=this._decryptdata=t[r[0]]||null;s&&(this._decryptdata=s.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=xe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const r=Object.keys(this.levelkeys),s=r.length;if(s>1||s===1&&(t=this.levelkeys[r[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!xe(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return wt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var r;const s=t[e];s&&!((r=this._decryptdata)!=null&&r.keyId)&&(this._decryptdata=s.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,s,i,a=!1){const{elementaryStreams:l}=this,d=l[e];if(!d){l[e]={startPTS:t,endPTS:r,startDTS:s,endDTS:i,partial:a};return}d.startPTS=Math.min(d.startPTS,t),d.endPTS=Math.max(d.endPTS,r),d.startDTS=Math.min(d.startDTS,s),d.endDTS=Math.max(d.endDTS,i)}}class y_ extends py{constructor(e,t,r,s,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function gy(n,e){const t=Object.getPrototypeOf(n);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||gy(t,e)}}function E_(n,e){const t=gy(n,e);t&&(t.enumerable=!0,Object.defineProperty(n,e,t))}const Tg=Math.pow(2,32)-1,w_=[].push,xy={video:1,audio:2,id3:3,text:4};function Ct(n){return String.fromCharCode.apply(null,n)}function vy(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Re(n,e){const t=yy(n,e);return t<0?4294967296+t:t}function _g(n,e){let t=Re(n,e);return t*=Math.pow(2,32),t+=Re(n,e+4),t}function yy(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function b_(n){const e=n.byteLength;for(let t=0;t<e;){const r=Re(n,t);if(r>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=r>1?t+r:e}return!1}function Me(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let s=0;s<r;){const i=Re(n,s),a=Ct(n.subarray(s+4,s+8)),l=i>1?s+i:r;if(a===e[0])if(e.length===1)t.push(n.subarray(s+8,l));else{const d=Me(n.subarray(s+8,l),e.slice(1));d.length&&w_.apply(t,d)}s=l}return t}function S_(n){const e=[],t=n[0];let r=8;const s=Re(n,r);r+=4;let i=0,a=0;t===0?(i=Re(n,r),a=Re(n,r+4),r+=8):(i=_g(n,r),a=_g(n,r+8),r+=16),r+=2;let l=n.length+a;const d=vy(n,r);r+=2;for(let u=0;u<d;u++){let h=r;const p=Re(n,h);h+=4;const g=p&2147483647;if((p&2147483648)>>>31===1)return Qe.warn("SIDX has hierarchical references (not supported)"),null;const y=Re(n,h);h+=4,e.push({referenceSize:g,subsegmentDuration:y,info:{duration:y/s,start:l,end:l+g-1}}),l+=g,h+=4,r=h}return{earliestPresentationTime:i,timescale:s,version:t,referencesCount:d,references:e}}function Ey(n){const e=[],t=Me(n,["moov","trak"]);for(let s=0;s<t.length;s++){const i=t[s],a=Me(i,["tkhd"])[0];if(a){let l=a[0];const d=Re(a,l===0?12:20),u=Me(i,["mdia","mdhd"])[0];if(u){l=u[0];const h=Re(u,l===0?12:20),p=Me(i,["mdia","hdlr"])[0];if(p){const g=Ct(p.subarray(8,12)),x={soun:et.AUDIO,vide:et.VIDEO}[g],y=Me(i,["mdia","minf","stbl","stsd"])[0],E=T_(y);x?(e[d]={timescale:h,type:x,stsd:E},e[x]=Ye({timescale:h,id:d},E)):e[d]={timescale:h,type:g,stsd:E}}}}}return Me(n,["moov","mvex","trex"]).forEach(s=>{const i=Re(s,4),a=e[i];a&&(a.default={duration:Re(s,12),flags:Re(s,20)})}),e}function T_(n){const e=n.subarray(8),t=e.subarray(86),r=Ct(e.subarray(4,8));let s=r,i;const a=r==="enca"||r==="encv";if(a){const u=Me(e,[r])[0].subarray(r==="enca"?28:78);Me(u,["sinf"]).forEach(p=>{const g=Me(p,["schm"])[0];if(g){const x=Ct(g.subarray(4,8));if(x==="cbcs"||x==="cenc"){const y=Me(p,["frma"])[0];y&&(s=Ct(y))}}})}const l=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Me(t,["avcC"])[0];d&&d.length>3&&(s+="."+Pl(d[1])+Pl(d[2])+Pl(d[3]),i=Dl(l==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const d=Me(e,[r])[0],u=Me(d.subarray(28),["esds"])[0];if(u&&u.length>7){let h=4;if(u[h++]!==3)break;h=rf(u,h),h+=2;const p=u[h++];if(p&128&&(h+=2),p&64&&(h+=u[h++]),u[h++]!==4)break;h=rf(u,h);const g=u[h++];if(g===64)s+="."+Pl(g);else break;if(h+=12,u[h++]!==5)break;h=rf(u,h);const x=u[h++];let y=(x&248)>>3;y===31&&(y+=1+((x&7)<<3)+((u[h]&224)>>5)),s+="."+y}break}case"hvc1":case"hev1":{const d=Me(t,["hvcC"])[0];if(d&&d.length>12){const u=d[1],h=["","A","B","C"][u>>6],p=u&31,g=Re(d,2),x=(u&32)>>5?"H":"L",y=d[12],E=d.subarray(6,12);s+="."+h+p,s+="."+__(g).toString(16).toUpperCase(),s+="."+x+y;let w="";for(let S=E.length;S--;){const T=E[S];(T||w)&&(w="."+T.toString(16).toUpperCase()+w)}s+=w}i=Dl(l=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=Dl(s,t)||s;break}case"vp09":{const d=Me(t,["vpcC"])[0];if(d&&d.length>6){const u=d[4],h=d[5],p=d[6]>>4&15;s+="."+Zr(u)+"."+Zr(h)+"."+Zr(p)}break}case"av01":{const d=Me(t,["av1C"])[0];if(d&&d.length>2){const u=d[1]>>>5,h=d[1]&31,p=d[2]>>>7?"H":"M",g=(d[2]&64)>>6,x=(d[2]&32)>>5,y=u===2&&g?x?12:10:g?10:8,E=(d[2]&16)>>4,w=(d[2]&8)>>3,S=(d[2]&4)>>2,T=d[2]&3;s+="."+u+"."+Zr(h)+p+"."+Zr(y)+"."+E+"."+w+S+T+"."+Zr(1)+"."+Zr(1)+"."+Zr(1)+"."+0,i=Dl("dav1",t)}break}}return{codec:s,encrypted:a,supplemental:i}}function Dl(n,e){const t=Me(e,["dvvC"]),r=t.length?t[0]:Me(e,["dvcC"])[0];if(r){const s=r[2]>>1&127,i=r[2]<<5&32|r[3]>>3&31;return n+"."+Zr(s)+"."+Zr(i)}}function __(n){let e=0;for(let t=0;t<32;t++)e|=(n>>t&1)<<31-t;return e>>>0}function rf(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function Pl(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function Zr(n){return(n<10?"0":"")+n}function k_(n,e){if(!n||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&wy(n,(r,s)=>{const i=r.subarray(8,24);i.some(a=>a!==0)||(Qe.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${Ut(i)} -> ${Ut(t)}`),r.set(t,8))})}function C_(n){const e=[];return wy(n,t=>e.push(t.subarray(8,24))),e}function wy(n,e){Me(n,["moov","trak"]).forEach(r=>{const s=Me(r,["mdia","minf","stbl","stsd"])[0];if(!s)return;const i=s.subarray(8);let a=Me(i,["enca"]);const l=a.length>0;l||(a=Me(i,["encv"])),a.forEach(d=>{const u=l?d.subarray(28):d.subarray(78);Me(u,["sinf"]).forEach(p=>{const g=by(p);g&&e(g,l)})})})}function by(n){const e=Me(n,["schm"])[0];if(e){const t=Ct(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const r=Me(n,["schi","tenc"])[0];if(r)return r}}}function I_(n,e,t){const r={},s=Me(n,["moof","traf"]);for(let i=0;i<s.length;i++){const a=s[i],l=Me(a,["tfhd"])[0],d=Re(l,4),u=e[d];if(!u)continue;r[d]||(r[d]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});const h=r[d],p=Me(a,["tfdt"])[0];if(p){const k=p[0];let I=Re(p,4);k===1&&(I===Tg?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(I*=Tg+1,I+=Re(p,8))),xe(I)&&(!xe(h.start)||I<h.start)&&(h.start=I)}const g=u.default,x=Re(l,0)|g?.flags;let y=g?.duration||0;x&8&&(x&2?y=Re(l,12):y=Re(l,8));const E=Me(a,["trun"]);let w=h.start||0,S=0,T=y;for(let k=0;k<E.length;k++){const I=E[k],L=Re(I,4),O=h.sampleCount;h.sampleCount+=L;const P=I[3]&1,j=I[3]&4,F=I[2]&1,D=I[2]&2,$=I[2]&4,J=I[2]&8;let ne=8,se=L;for(P&&(ne+=4),j&&L&&(!(I[ne+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=O),ne+=4,F?(T=Re(I,ne),ne+=4):T=y,D&&(ne+=4),J&&(ne+=4),w+=T,S+=T,se--);se--;)F?(T=Re(I,ne),ne+=4):T=y,D&&(ne+=4),$&&(I[ne+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(se+1),h.keyFrameStart=w),ne+=4),J&&(ne+=4),w+=T,S+=T;!S&&y&&(S+=y*L)}h.duration+=S}if(!Object.keys(r).some(i=>r[i].duration)){let i=1/0,a=0;const l=Me(n,["sidx"]);for(let d=0;d<l.length;d++){const u=S_(l[d]);if(u!=null&&u.references){i=Math.min(i,u.earliestPresentationTime/u.timescale);const h=u.references.reduce((p,g)=>p+g.info.duration||0,0);a=Math.max(a,h+u.earliestPresentationTime/u.timescale)}}a&&xe(a)&&Object.keys(r).forEach(d=>{r[d].duration||(r[d].duration=a*r[d].timescale-r[d].start)})}return r}function A_(n){const e={valid:null,remainder:null},t=Me(n,["moof"]);if(t.length<2)return e.remainder=n,e;const r=t[t.length-1];return e.valid=n.slice(0,r.byteOffset-8),e.remainder=n.slice(r.byteOffset-8),e}function Tr(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function kg(n,e){const t=[],r=e.samples,s=e.timescale,i=e.id;let a=!1;return Me(r,["moof"]).map(d=>{const u=d.byteOffset-8;Me(d,["traf"]).map(p=>{const g=Me(p,["tfdt"]).map(x=>{const y=x[0];let E=Re(x,4);return y===1&&(E*=Math.pow(2,32),E+=Re(x,8)),E/s})[0];return g!==void 0&&(n=g),Me(p,["tfhd"]).map(x=>{const y=Re(x,4),E=Re(x,0)&16777215,w=(E&1)!==0,S=(E&2)!==0,T=(E&8)!==0;let k=0;const I=(E&16)!==0;let L=0;const O=(E&32)!==0;let P=8;y===i&&(w&&(P+=8),S&&(P+=4),T&&(k=Re(x,P),P+=4),I&&(L=Re(x,P),P+=4),O&&(P+=4),e.type==="video"&&(a=Vc(e.codec)),Me(p,["trun"]).map(j=>{const F=j[0],D=Re(j,0)&16777215,$=(D&1)!==0;let J=0;const ne=(D&4)!==0,se=(D&256)!==0;let X=0;const Z=(D&512)!==0;let ie=0;const G=(D&1024)!==0,Q=(D&2048)!==0;let W=0;const N=Re(j,4);let U=8;$&&(J=Re(j,U),U+=4),ne&&(U+=4);let re=J+u;for(let de=0;de<N;de++){if(se?(X=Re(j,U),U+=4):X=k,Z?(ie=Re(j,U),U+=4):ie=L,G&&(U+=4),Q&&(F===0?W=Re(j,U):W=yy(j,U),U+=4),e.type===et.VIDEO){let ue=0;for(;ue<ie;){const he=Re(r,re);if(re+=4,L_(a,r[re])){const pe=r.subarray(re,re+he);Ph(pe,a?2:1,n+W/s,t)}re+=he,ue+=he+4}}n+=X/s}}))})})}),t}function Vc(n){if(!n)return!1;const e=n.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function L_(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Ph(n,e,t,r){const s=Sy(n);let i=0;i+=e;let a=0,l=0,d=0;for(;i<s.length;){a=0;do{if(i>=s.length)break;d=s[i++],a+=d}while(d===255);l=0;do{if(i>=s.length)break;d=s[i++],l+=d}while(d===255);const u=s.length-i;let h=i;if(l<u)i+=l;else if(l>u){Qe.error(`Malformed SEI payload. ${l} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(s[h++]===181){const g=vy(s,h);if(h+=2,g===49){const x=Re(s,h);if(h+=4,x===1195456820){const y=s[h++];if(y===3){const E=s[h++],w=31&E,S=64&E,T=S?2+w*3:0,k=new Uint8Array(T);if(S){k[0]=E;for(let I=1;I<T;I++)k[I]=s[h++]}r.push({type:y,payloadType:a,pts:t,bytes:k})}}}}}else if(a===5&&l>16){const p=[];for(let y=0;y<16;y++){const E=s[h++].toString(16);p.push(E.length==1?"0"+E:E),(y===3||y===5||y===7||y===9)&&p.push("-")}const g=l-16,x=new Uint8Array(g);for(let y=0;y<g;y++)x[y]=s[h++];r.push({payloadType:a,pts:t,uuid:p.join(""),userData:pr(x),userDataBytes:x})}}}function Sy(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const s=e-t.length,i=new Uint8Array(s);let a=0;for(r=0;r<s;a++,r++)a===t[0]&&(a++,t.shift()),i[r]=n[a];return i}function R_(n){const e=n[0];let t="",r="",s=0,i=0,a=0,l=0,d=0,u=0;if(e===0){for(;Ct(n.subarray(u,u+1))!=="\0";)t+=Ct(n.subarray(u,u+1)),u+=1;for(t+=Ct(n.subarray(u,u+1)),u+=1;Ct(n.subarray(u,u+1))!=="\0";)r+=Ct(n.subarray(u,u+1)),u+=1;r+=Ct(n.subarray(u,u+1)),u+=1,s=Re(n,12),i=Re(n,16),l=Re(n,20),d=Re(n,24),u=28}else if(e===1){u+=4,s=Re(n,u),u+=4;const p=Re(n,u);u+=4;const g=Re(n,u);for(u+=4,a=2**32*p+g,o_(a)||(a=Number.MAX_SAFE_INTEGER,Qe.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=Re(n,u),u+=4,d=Re(n,u),u+=4;Ct(n.subarray(u,u+1))!=="\0";)t+=Ct(n.subarray(u,u+1)),u+=1;for(t+=Ct(n.subarray(u,u+1)),u+=1;Ct(n.subarray(u,u+1))!=="\0";)r+=Ct(n.subarray(u,u+1)),u+=1;r+=Ct(n.subarray(u,u+1)),u+=1}const h=n.subarray(u,n.byteLength);return{schemeIdUri:t,value:r,timeScale:s,presentationTime:a,presentationTimeDelta:i,eventDuration:l,id:d,payload:h}}function N_(n,...e){const t=e.length;let r=8,s=t;for(;s--;)r+=e[s].byteLength;const i=new Uint8Array(r);for(i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(n,4),s=0,r=8;s<t;s++)i.set(e[s],r),r+=e[s].byteLength;return i}function D_(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,s;r=0,s=new Uint8Array;let i;r>0?(i=new Uint8Array(4),e.length>0&&new DataView(i.buffer).setUint32(0,e.length,!1)):i=new Uint8Array;const a=new Uint8Array(4);return t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),N_([112,115,115,104],new Uint8Array([r,0,0,0]),n,i,s,a,t)}function P_(n){const e=[];if(n instanceof ArrayBuffer){const t=n.byteLength;let r=0;for(;r+32<t;){const s=new DataView(n,r),i=O_(s);e.push(i),r+=i.size}}return e}function O_(n){const e=n.getUint32(0),t=n.byteOffset,r=n.byteLength;if(r<e)return{offset:t,size:r};if(n.getUint32(4)!==1886614376)return{offset:t,size:e};const i=n.getUint32(8)>>>24;if(i!==0&&i!==1)return{offset:t,size:e};const a=n.buffer,l=Ut(new Uint8Array(a,t+12,16));let d=null,u=null,h=0;if(i===0)h=28;else{const g=n.getUint32(28);if(!g||r<32+g*16)return{offset:t,size:e};d=[];for(let x=0;x<g;x++)d.push(new Uint8Array(a,t+32+x*16,16));h=32+g*16}if(!h)return{offset:t,size:e};const p=n.getUint32(h);return e-32<p?{offset:t,size:e}:(u=new Uint8Array(a,t+h+4,p),{version:i,systemId:l,kids:d,data:u,offset:t,size:e})}const Ty=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Ui={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Oh(n,e){const t=Ui[e];return!!t&&!!t[n.slice(0,4)]}function eo(n,e,t=!0){return!n.split(",").some(r=>!jh(r,e,t))}function jh(n,e,t=!0){var r;const s=fs(t);return(r=s?.isTypeSupported(to(n,e)))!=null?r:!1}function to(n,e){return`${e}/mp4;codecs=${n}`}function Cg(n){if(n){const e=n.substring(0,4);return Ui.video[e]}return 2}function hc(n){const e=Ty();return n.split(",").reduce((t,r)=>{const i=e&&Vc(r)?9:Ui.video[r];return i?(i*2+t)/(t?3:2):(Ui.audio[r]+t)/(t?2:1)},0)}const nf={};function j_(n,e=!0){if(nf[n])return nf[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let s=0;s<t.length;s++){var r;if(jh(t[s],"audio",e))return nf[n]=t[s],t[s];if(t[s]==="mp3"&&(r=fs(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return n}const M_=/flac|opus|mp4a\.40\.34/i;function mc(n,e=!0){return n.replace(M_,t=>j_(t.toLowerCase(),e))}function F_(n,e){const t=[];if(n){const r=n.split(",");for(let s=0;s<r.length;s++)Oh(r[s],"video")||t.push(r[s])}return e&&t.push(e),t.join(",")}function rc(n,e){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1)&&(Ig(n,"audio")||Ig(n,"video")))return n;if(e){const t=e.split(",");if(t.length>1){if(n){for(let r=t.length;r--;)if(t[r].substring(0,4)===n.substring(0,4))return t[r]}return t[0]}}return e||n}function Ig(n,e){return Oh(n,e)&&jh(n,e)}function U_(n){const e=n.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function B_(n){if(n.startsWith("av01.")){const e=n.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return n}function Ag(n){const e=fs(n)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Zf(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const $_={supported:!0,powerEfficient:!0,smooth:!0},V_={supported:!1,smooth:!1,powerEfficient:!1},_y={supported:!0,configurations:[],decodingInfoResults:[$_]};function ky(n,e){return{supported:!1,configurations:e,decodingInfoResults:[V_],error:n}}function G_(n,e,t,r,s,i){const a=n.videoCodec,l=n.audioCodec?n.audioGroups:null,d=i?.audioCodec,u=i?.channels,h=u?parseInt(u):d?1/0:2;let p=null;if(l!=null&&l.length)try{l.length===1&&l[0]?p=e.groups[l[0]].channels:p=l.reduce((g,x)=>{if(x){const y=e.groups[x];if(!y)throw new Error(`Audio track group ${x} not found`);Object.keys(y.channels).forEach(E=>{g[E]=(g[E]||0)+y.channels[E]})}return g},{2:0})}catch{return!0}return a!==void 0&&(a.split(",").some(g=>Vc(g))||n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(r,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(s,8e6))||!!p&&xe(h)&&Object.keys(p).some(g=>parseInt(g)>h)}function Cy(n,e,t,r={}){const s=n.videoCodec;if(!s&&!n.audioCodec||!t)return Promise.resolve(_y);const i=[],a=H_(n),l=a.length,d=q_(n,e,l>0),u=d.length;for(let h=l||1*u||1;h--;){const p={type:"media-source"};if(l&&(p.video=a[h%l]),u){p.audio=d[h%u];const g=p.audio.bitrate;p.video&&g&&(p.video.bitrate-=g)}i.push(p)}if(s){const h=navigator.userAgent;if(s.split(",").some(p=>Vc(p))&&Ty())return Promise.resolve(ky(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${h})`),i))}return Promise.all(i.map(h=>{const p=z_(h);return r[p]||(r[p]=t.decodingInfo(h))})).then(h=>({supported:!h.some(p=>!p.supported),configurations:i,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:i,decodingInfoResults:[],error:h}))}function H_(n){var e;const t=(e=n.videoCodec)==null?void 0:e.split(","),r=Iy(n),s=n.width||640,i=n.height||480,a=n.frameRate||30,l=n.videoRange.toLowerCase();return t?t.map(d=>{const u={contentType:to(B_(d),"video"),width:s,height:i,bitrate:r,framerate:a};return l!=="sdr"&&(u.transferFunction=l),u}):[]}function q_(n,e,t){var r;const s=(r=n.audioCodec)==null?void 0:r.split(","),i=Iy(n);return s&&n.audioGroups?n.audioGroups.reduce((a,l)=>{var d;const u=l?(d=e.groups[l])==null?void 0:d.tracks:null;return u?u.reduce((h,p)=>{if(p.groupId===l){const g=parseFloat(p.channels||"");s.forEach(x=>{const y={contentType:to(x,"audio"),bitrate:t?K_(x,i):i};g&&(y.channels=""+g),h.push(y)})}return h},a):a},[]):[]}function K_(n,e){if(e<=1)return 1;let t=128e3;return n==="ec-3"?t=768e3:n==="ac-3"&&(t=64e4),Math.min(e/2,t)}function Iy(n){return Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)/1e3)*1e3||1}function z_(n){let e="";const{audio:t,video:r}=n;if(r){const s=Zf(r.contentType);e+=`${s}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(t){const s=Zf(t.contentType);e+=`${r?"_":""}${s}_c${t.channels}`}return e}const Jf=["NONE","TYPE-0","TYPE-1",null];function W_(n){return Jf.indexOf(n)>-1}const pc=["SDR","PQ","HLG"];function Y_(n){return!!n&&pc.indexOf(n)>-1}var nc={No:"",Yes:"YES",v2:"v2"};function Lg(n){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=n,s=r<e/2;return e&&s?t?nc.v2:nc.Yes:nc.No}class Rg{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class ro{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return Ng(this._audioGroups,e)}hasSubtitleGroup(e){return Ng(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function Ng(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function Q_(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function X_(n,e){let t=!1,r=[];if(n&&(t=n!=="SDR",r=[n]),e){r=e.allowedVideoRanges||pc.slice(0);const s=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&Q_(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const Z_=n=>{const e=new WeakSet;return(t,r)=>{if(n&&(r=n(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},tt=(n,e)=>JSON.stringify(n,Z_(e));function J_(n,e,t,r,s){const i=Object.keys(n),a=r?.channels,l=r?.audioCodec,d=s?.videoCodec,u=a&&parseInt(a)===2;let h=!1,p=!1,g=1/0,x=1/0,y=1/0,E=1/0,w=0,S=[];const{preferHDR:T,allowedVideoRanges:k}=X_(e,s);for(let j=i.length;j--;){const F=n[i[j]];h||(h=F.channels[2]>0),g=Math.min(g,F.minHeight),x=Math.min(x,F.minFramerate),y=Math.min(y,F.minBitrate),k.filter($=>F.videoRanges[$]>0).length>0&&(p=!0)}g=xe(g)?g:0,x=xe(x)?x:0;const I=Math.max(1080,g),L=Math.max(30,x);y=xe(y)?y:t,t=Math.max(y,t),p||(e=void 0);const O=i.length>1;return{codecSet:i.reduce((j,F)=>{const D=n[F];if(F===j)return j;if(S=p?k.filter($=>D.videoRanges[$]>0):[],O){if(D.minBitrate>t)return Wr(F,`min bitrate of ${D.minBitrate} > current estimate of ${t}`),j;if(!D.hasDefaultAudio)return Wr(F,"no renditions with default or auto-select sound found"),j;if(l&&F.indexOf(l.substring(0,4))%5!==0)return Wr(F,`audio codec preference "${l}" not found`),j;if(a&&!u){if(!D.channels[a])return Wr(F,`no renditions with ${a} channel sound found (channels options: ${Object.keys(D.channels)})`),j}else if((!l||u)&&h&&D.channels[2]===0)return Wr(F,"no renditions with stereo sound found"),j;if(D.minHeight>I)return Wr(F,`min resolution of ${D.minHeight} > maximum of ${I}`),j;if(D.minFramerate>L)return Wr(F,`min framerate of ${D.minFramerate} > maximum of ${L}`),j;if(!S.some($=>D.videoRanges[$]>0))return Wr(F,`no variants with VIDEO-RANGE of ${tt(S)} found`),j;if(d&&F.indexOf(d.substring(0,4))%5!==0)return Wr(F,`video codec preference "${d}" not found`),j;if(D.maxScore<w)return Wr(F,`max score of ${D.maxScore} < selected max of ${w}`),j}return j&&(hc(F)>=hc(j)||D.fragmentError>n[j].fragmentError)?j:(E=D.minIndex,w=D.maxScore,F)},void 0),videoRanges:S,preferHDR:T,minFramerate:x,minBitrate:y,minIndex:E}}function Wr(n,e){Qe.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function Ay(n){return n.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const s=t.channels||"2";return r.channels[s]=(r.channels[s]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ek(n,e,t,r){return n.slice(t,r+1).reduce((s,i,a)=>{if(!i.codecSet)return s;const l=i.audioGroups;let d=s[i.codecSet];d||(s[i.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,i.bitrate);const u=Math.min(i.height,i.width);return d.minHeight=Math.min(d.minHeight,u),d.minFramerate=Math.min(d.minFramerate,i.frameRate),d.minIndex=Math.min(d.minIndex,a),d.maxScore=Math.max(d.maxScore,i.score),d.fragmentError+=i.fragmentError,d.videoRanges[i.videoRange]=(d.videoRanges[i.videoRange]||0)+1,l&&l.forEach(h=>{if(!h)return;const p=e.groups[h];p&&(d.hasDefaultAudio=d.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(g=>{d.channels[g]=(d.channels[g]||0)+p.channels[g]}))}),s},{})}function Dg(n){if(!n)return n;const{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}=n;return{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}}function en(n,e,t){if("attrs"in n){const r=e.indexOf(n);if(r!==-1)return r}for(let r=0;r<e.length;r++){const s=e[r];if(Us(n,s,t))return r}return-1}function Us(n,e,t){const{groupId:r,name:s,lang:i,assocLang:a,default:l}=n,d=n.forced;return(r===void 0||e.groupId===r)&&(s===void 0||e.name===s)&&(i===void 0||tk(i,e.lang))&&(i===void 0||e.assocLang===a)&&(l===void 0||e.default===l)&&(d===void 0||e.forced===d)&&(!("characteristics"in n)||rk(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function tk(n,e="--"){return n.length===e.length?n===e:n.startsWith(e)||e.startsWith(n)}function rk(n,e=""){const t=n.split(","),r=e.split(",");return t.length===r.length&&!t.some(s=>r.indexOf(s)===-1)}function Os(n,e){const{audioCodec:t,channels:r}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function nk(n,e,t,r,s){const i=e[r],l=e.reduce((g,x,y)=>{const E=x.uri;return(g[E]||(g[E]=[])).push(y),g},{})[i.uri];l.length>1&&(r=Math.max.apply(Math,l));const d=i.videoRange,u=i.frameRate,h=i.codecSet.substring(0,4),p=Pg(e,r,g=>{if(g.videoRange!==d||g.frameRate!==u||g.codecSet.substring(0,4)!==h)return!1;const x=g.audioGroups,y=t.filter(E=>!x||x.indexOf(E.groupId)!==-1);return en(n,y,s)>-1});return p>-1?p:Pg(e,r,g=>{const x=g.audioGroups,y=t.filter(E=>!x||x.indexOf(E.groupId)!==-1);return en(n,y,s)>-1})}function Pg(n,e,t){for(let r=e;r>-1;r--)if(t(n[r]))return r;for(let r=e+1;r<n.length;r++)if(t(n[r]))return r;return-1}function gc(n,e){var t;return!!n&&n!==((t=e.loadLevelObj)==null?void 0:t.uri)}class sk extends kr{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:s,partCurrent:i,hls:a}=this,{autoLevelEnabled:l,media:d}=a;if(!s||!d)return;const u=performance.now(),h=i?i.stats:s.stats,p=i?i.duration:s.duration,g=u-h.loading.start,x=a.minAutoLevel,y=s.level,E=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||y<=x){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l)return;const w=E>-1&&E!==y,S=!!t||w;if(!S&&(d.paused||!d.playbackRate||!d.readyState))return;const T=a.mainForwardBufferInfo;if(!S&&T===null)return;const k=this.bwEstimator.getEstimateTTFB(),I=Math.abs(d.playbackRate);if(g<=Math.max(k,1e3*(p/(I*2))))return;const L=T?T.len/I:0,O=h.loading.first?h.loading.first-h.loading.start:-1,P=h.loaded&&O>-1,j=this.getBwEstimate(),F=a.levels,D=F[y],$=Math.max(h.loaded,Math.round(p*(s.bitrate||D.averageBitrate)/8));let J=P?g-O:g;J<1&&P&&(J=Math.min(g,h.loaded*8/j));const ne=P?h.loaded*1e3/J:0,se=k/1e3,X=ne?($-h.loaded)/ne:$*8/j+se;if(X<=L)return;const Z=ne?ne*8:j,ie=((r=t?.details||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,G=this.hls.config.abrBandWidthUpFactor;let Q=Number.POSITIVE_INFINITY,W;for(W=y-1;W>x;W--){const de=F[W].maxBitrate,ue=!F[W].details||ie;if(Q=this.getTimeToLoadFrag(se,Z,p*de,ue),Q<Math.min(L,p+se))break}if(Q>=X||Q>p*10)return;P?this.bwEstimator.sample(g-Math.min(k,O),h.loaded):this.bwEstimator.sampleTTFB(g);const N=F[W].maxBitrate;this.getBwEstimate()*G>N&&this.resetEstimator(N);const U=this.findBestLevel(N,x,W,0,L,1,1);U>-1&&(W=U),this.warn(`Fragment ${s.sn}${i?" part "+i.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${L.toFixed(3)} s
      Estimated load time for current fragment: ${X.toFixed(3)} s
      Estimated load time for down switch fragment: ${Q.toFixed(3)} s
      TTFB estimate: ${O|0} ms
      Current BW estimate: ${xe(j)?j|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${W} @ ${N|0} bps`),a.nextLoadLevel=a.nextAutoLevel=W,this.clearTimer();const re=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===W&&W>0){const de=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${W>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${de.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,W>x){let ue=this.findBestLevel(this.hls.levels[x].bitrate,x,W,0,de,1,1);ue===-1&&(ue=x),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ue,this.resetEstimator(this.hls.levels[ue].bitrate)}}};w||X>Q*2?re():this.timer=self.setInterval(re,Q*1e3),a.trigger(C.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:i,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new c_(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(C.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var s;this.fragCurrent=r,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case q.BUFFER_ADD_CODEC_ERROR:case q.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case q.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:s,partCurrent:i}=this;if(r&&s&&r.sn===s.sn&&r.level===s.level){const a=performance.now(),l=i?i.stats:r.stats,d=a-l.loading.start,u=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&u>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(p,u),l.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,t,r,s){const i=e+r/t,a=s?e+this.lastLevelLoadSec:0;return i+a}onLevelLoaded(e,t){const r=this.hls.config,{loading:s}=t.stats,i=s.end-s.first;xe(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const s=r?r.stats:t.stats;if(t.type===ye.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const i=r?r.duration:t.duration,a=this.hls.levels[t.level],l=(a.loaded?a.loaded.bytes:0)+s.loaded,d=(a.loaded?a.loaded.duration:0)+i;a.loaded={bytes:l,duration:d},a.realBitrate=Math.round(8*l/d)}if(t.bitrateTest){const i={stats:s,frag:t,part:r,id:t.type};this.onFragBuffered(C.FRAG_BUFFERED,i),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:s}=t,i=s!=null&&s.stats.loaded?s.stats:r.stats;if(i.aborted||this.ignoreFragment(r))return;const a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ye.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,i=this.findBestLevel(r,t,e,0,s,1,1);if(i>-1)return i;const a=this.hls.firstLevel,l=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=r&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,i)&&a[e].loadError<=a[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:s,config:i,minAutoLevel:a}=r,l=t?t.duration:e?e.duration:0,d=this.getBwEstimate(),u=this.getStarvationDelay();let h=i.abrBandWidthFactor,p=i.abrBandWidthUpFactor;if(u){const w=this.findBestLevel(d,a,s,u,0,h,p);if(w>=0)return this.rebufferNotice=-1,w}let g=l?Math.min(l,i.maxStarvationDelay):i.maxStarvationDelay;if(!u){const w=this.bitrateTestDelay;w&&(g=(l?Math.min(l,i.maxLoadingDelay):i.maxLoadingDelay)-w,this.info(`bitrate test took ${Math.round(1e3*w)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),h=p=1)}const x=this.findBestLevel(d,a,s,u,g,h,p);if(this.rebufferNotice!==x&&(this.rebufferNotice=x,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${x}`)),x>-1)return x;const y=r.levels[a],E=r.loadLevelObj;return E&&y?.bitrate<E.bitrate?a:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,s,i,a,l){var d;const u=s+i,h=this.lastLoadedFragLevel,p=h===-1?this.hls.firstLevel:h,{fragCurrent:g,partCurrent:x}=this,{levels:y,allAudioTracks:E,loadLevel:w,config:S}=this.hls;if(y.length===1)return 0;const T=y[p],k=!!((d=this.hls.latestLevelDetails)!=null&&d.live),I=w===-1||h===-1;let L,O="SDR",P=T?.frameRate||0;const{audioPreference:j,videoPreference:F}=S,D=this.audioTracksByGroup||(this.audioTracksByGroup=Ay(E));let $=-1;if(I){if(this.firstSelection!==-1)return this.firstSelection;const Z=this.codecTiers||(this.codecTiers=ek(y,D,t,r)),ie=J_(Z,O,e,j,F),{codecSet:G,videoRanges:Q,minFramerate:W,minBitrate:N,minIndex:U,preferHDR:re}=ie;$=U,L=G,O=re?Q[Q.length-1]:Q[0],P=W,e=Math.max(e,N),this.log(`picked start tier ${tt(ie)}`)}else L=T?.codecSet,O=T?.videoRange;const J=x?x.duration:g?g.duration:0,ne=this.bwEstimator.getEstimateTTFB()/1e3,se=[];for(let Z=r;Z>=t;Z--){var X;const ie=y[Z],G=Z>p;if(!ie)continue;if(S.useMediaCapabilities&&!ie.supportedResult&&!ie.supportedPromise){const ue=navigator.mediaCapabilities;typeof ue?.decodingInfo=="function"&&G_(ie,D,O,P,e,j)?(ie.supportedPromise=Cy(ie,D,ue,this.supportedCache),ie.supportedPromise.then(he=>{if(!this.hls)return;ie.supportedResult=he;const pe=this.hls.levels,ge=pe.indexOf(ie);he.error?this.warn(`MediaCapabilities decodingInfo error: "${he.error}" for level ${ge} ${tt(he)}`):he.supported?he.decodingInfoResults.some(Ne=>Ne.smooth===!1||Ne.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${ge} not smooth or powerEfficient: ${tt(he)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${ge} ${tt(he)}`),ge>-1&&pe.length>1&&(this.log(`Removing unsupported level ${ge}`),this.hls.removeLevel(ge),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(he=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${he}`)})):ie.supportedResult=_y}if((L&&ie.codecSet!==L||O&&ie.videoRange!==O||G&&P>ie.frameRate||!G&&P>0&&P<ie.frameRate||(X=ie.supportedResult)!=null&&(X=X.decodingInfoResults)!=null&&X.some(ue=>ue.smooth===!1))&&(!I||Z!==$)){se.push(Z);continue}const Q=ie.details,W=(x?Q?.partTarget:Q?.averagetargetduration)||J;let N;G?N=l*e:N=a*e;const U=J&&s>=J*2&&i===0?ie.averageBitrate:ie.maxBitrate,re=this.getTimeToLoadFrag(ne,N,U*W,Q===void 0);if(N>=U&&(Z===h||ie.loadError===0&&ie.fragmentError===0)&&(re<=ne||!xe(re)||k&&!this.bitrateTestDelay||re<u)){const ue=this.forcedAutoLevel;return Z!==w&&(ue===-1||ue!==w)&&(se.length&&this.trace(`Skipped level(s) ${se.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${y[se[0]].codecs}" ${y[se[0]].videoRange}; not compatible with "${L}" ${O}`),this.info(`switch candidate:${p}->${Z} adjustedbw(${Math.round(N)})-bitrate=${Math.round(N-U)} ttfb:${ne.toFixed(1)} avgDuration:${W.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${re.toFixed(1)} firstSelection:${I} codecSet:${ie.codecSet} videoRange:${ie.videoRange} hls.loadLevel:${w}`)),I&&(this.firstSelection=Z),Z}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const Ly={search:function(n,e){let t=0,r=n.length-1,s=null,i=null;for(;t<=r;){s=(t+r)/2|0,i=n[s];const a=e(i);if(a>0)t=s+1;else if(a<0)r=s-1;else return i}return null}};function ik(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!xe(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const s=n[n.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let i=0;i<n.length;++i){const a=n[i];if(ok(e,t,a))return a}return null}function Gs(n,e,t=0,r=0,s=.005){let i=null;if(n){i=e[1+n.sn-e[0].sn]||null;const l=n.endDTS-t;l>0&&l<15e-7&&(t+=15e-7),i&&n.level!==i.level&&i.end<=n.end&&(i=e[2+n.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(i=e[0]);if(i&&((!n||n.level===i.level)&&Og(t,r,i)===0||ak(i,n,Math.min(s,r))))return i;const a=Ly.search(e,Og.bind(null,t,r));return a&&(a!==n||!i)?a:i}function ak(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((s,i)=>(i[0]==="INF"&&(s+=parseFloat(i[1])),s),t);return n.start<=r}return!1}function Og(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function ok(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function Ry(n,e,t){if(n&&n.startCC<=e&&n.endCC>=e){let r=n.fragments;const{fragmentHint:s}=n;s&&(r=r.concat(s));let i;return Ly.search(r,a=>a.cc<e?1:a.cc>e?-1:(i=a,a.end<=t?1:a.start>t?-1:0)),i||null}return null}function xc(n){switch(n.details){case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_TIMEOUT:case q.LEVEL_LOAD_TIMEOUT:case q.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ny(n){return n.details.startsWith("key")}function Dy(n){return Ny(n)&&!!n.frag&&!n.frag.decryptdata}function jg(n,e){const t=xc(e);return n.default[`${t?"timeout":"error"}Retry`]}function Mh(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function Mg(n){return Ye(Ye({},n),{errorRetry:null,timeoutRetry:null})}function vc(n,e,t,r){if(!n)return!1;const s=r?.code,i=e<n.maxNumRetry&&(lk(s)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,r,i):i}function lk(n){return eh(n)||!!n&&(n<400||n>499)}function eh(n){return n===0&&navigator.onLine===!1}var Ft={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},fr={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class ck extends kr{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.ERROR,this.onError,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.ERROR,this.onError,this),e.off(C.ERROR,this.onErrorOut,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===ye.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,r=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||r===-1?t.loadLevel:r}variantHasKey(e,t){if(e){var r;if((r=e.details)!=null&&r.hasKey(t))return!0;const s=e.audioGroups;if(s)return this.hls.allAudioTracks.filter(a=>s.indexOf(a.groupId)>=0).some(a=>{var l;return(l=a.details)==null?void 0:l.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const s=this.hls,i=t.context;switch(t.details){case q.FRAG_LOAD_ERROR:case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_ERROR:case q.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case q.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=Ri();return}case q.FRAG_GAP:case q.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Ft.SendAlternateToPenaltyBox;return}case q.LEVEL_EMPTY_ERROR:case q.LEVEL_PARSING_ERROR:{var a;const d=t.parent===ye.MAIN?t.level:s.loadLevel;t.details===q.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(a=a.levelDetails)!=null&&a.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,d):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,d))}return;case q.LEVEL_LOAD_ERROR:case q.LEVEL_LOAD_TIMEOUT:typeof i?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level));return;case q.AUDIO_TRACK_LOAD_ERROR:case q.AUDIO_TRACK_LOAD_TIMEOUT:case q.SUBTITLE_LOAD_ERROR:case q.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const d=s.loadLevelObj;if(d&&(i.type===Be.AUDIO_TRACK&&d.hasAudioGroup(i.groupId)||i.type===Be.SUBTITLE_TRACK&&d.hasSubtitleGroup(i.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Ft.SendAlternateToPenaltyBox,t.errorAction.flags=fr.MoveAllAlternatesMatchingHost;return}}return;case q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Ft.SendAlternateToPenaltyBox,flags:fr.MoveAllAlternatesMatchingHDCP};return;case q.KEY_SYSTEM_SESSION_UPDATE_FAILED:case q.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case q.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Ft.SendAlternateToPenaltyBox,flags:fr.MoveAllAlternatesMatchingKey};return;case q.BUFFER_ADD_CODEC_ERROR:case q.REMUX_ALLOC_ERROR:case q.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:s.loadLevel)}return;case q.INTERNAL_EXCEPTION:case q.BUFFER_APPENDING_ERROR:case q.BUFFER_FULL_ERROR:case q.LEVEL_SWITCH_ERROR:case q.BUFFER_STALLED_ERROR:case q.BUFFER_SEEK_OVER_HOLE:case q.BUFFER_NUDGE_ON_STALL:t.errorAction=Ri();return}t.type===Te.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Ri())}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,s=jg(r.config.playlistLoadPolicy,e),i=this.playlistError++;if(vc(s,i,xc(e),e.response))return{action:Ft.RetryRequest,flags:fr.None,retryConfig:s,retryCount:i};const l=this.getLevelSwitchAction(e,t);return s&&(l.retryConfig=s,l.retryCount=i),l}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),s=t.levels[r],{fragLoadPolicy:i,keyLoadPolicy:a}=t.config,l=jg(Ny(e)?a:i,e),d=t.levels.reduce((h,p)=>h+p.fragmentError,0);if(s&&(e.details!==q.FRAG_GAP&&s.fragmentError++,!Dy(e)&&vc(l,d,xc(e),e.response)))return{action:Ft.RetryRequest,flags:fr.None,retryConfig:l,retryCount:d};const u=this.getLevelSwitchAction(e,r);return l&&(u.retryConfig=l,u.retryCount=d),u}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const s=this.hls.levels[t];if(s){var i,a;const u=e.details;s.loadError++,u===q.BUFFER_APPEND_ERROR&&s.fragmentError++;let h=-1;const{levels:p,loadLevel:g,minAutoLevel:x,maxAutoLevel:y}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const E=(i=e.frag)==null?void 0:i.type,S=(E===ye.AUDIO&&u===q.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===q.BUFFER_ADD_CODEC_ERROR||u===q.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:O})=>s.audioCodec!==O),k=e.sourceBufferName==="video"&&(u===q.BUFFER_ADD_CODEC_ERROR||u===q.BUFFER_APPEND_ERROR)&&p.some(({codecSet:O,audioCodec:P})=>s.codecSet!==O&&s.audioCodec===P),{type:I,groupId:L}=(a=e.context)!=null?a:{};for(let O=p.length;O--;){const P=(O+g)%p.length;if(P!==g&&P>=x&&P<=y&&p[P].loadError===0){var l,d;const j=p[P];if(u===q.FRAG_GAP&&E===ye.MAIN&&e.frag){const F=p[P].details;if(F){const D=Gs(e.frag,F.fragments,e.frag.start);if(D!=null&&D.gap)continue}}else{if(I===Be.AUDIO_TRACK&&j.hasAudioGroup(L)||I===Be.SUBTITLE_TRACK&&j.hasSubtitleGroup(L))continue;if(E===ye.AUDIO&&(l=s.audioGroups)!=null&&l.some(F=>j.hasAudioGroup(F))||E===ye.SUBTITLE&&(d=s.subtitleGroups)!=null&&d.some(F=>j.hasSubtitleGroup(F))||S&&s.audioCodec===j.audioCodec||k&&s.codecSet===j.codecSet||!S&&s.codecSet!==j.codecSet)continue}h=P;break}}if(h>-1&&r.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Ft.SendAlternateToPenaltyBox,flags:fr.None,nextAutoLevel:h}}return{action:Ft.SendAlternateToPenaltyBox,flags:fr.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case Ft.DoNothing:break;case Ft.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==q.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:s}=r,i=r.nextAutoLevel;switch(s){case fr.None:this.switchLevel(e,i);break;case fr.MoveAllAlternatesMatchingHDCP:{const d=this.getVariantLevelIndex(e.frag),u=t.levels[d],h=u?.attrs["HDCP-LEVEL"];if(r.hdcpLevel=h,h==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(h){t.maxHdcpLevel=Jf[Jf.indexOf(h)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case fr.MoveAllAlternatesMatchingKey:{const d=e.decryptdata;if(d){const u=this.hls.levels,h=u.length;for(let g=h;g--;)if(this.variantHasKey(u[g],d)){var a,l;this.log(`Banned key found in level ${g} (${u[g].bitrate}bps) or audio group "${(a=u[g].audioGroups)==null?void 0:a.join(",")}" (${(l=e.frag)==null?void 0:l.type} fragment) ${Ut(d.keyId||[])}`),u[g].fragmentError++,u[g].loadError++,this.log(`Removing level ${g} with key error (${e.error})`),this.hls.removeLevel(g)}const p=e.frag;if(this.hls.levels.length<h)r.resolved=!0;else if(p&&p.type!==ye.MAIN){const g=p.decryptdata;g&&!d.matches(g)&&(r.resolved=!0)}}break}}r.resolved||this.switchLevel(e,i)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===q.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=Zf(e.mimeType),s=this.hls.levels;for(let i=s.length;i--;)s[i][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${i} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(i))}}}function Ri(n){const e={action:Ft.DoNothing,flags:fr.None};return n&&(e.resolved=!0),e}var It={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class uk{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let s=r.length;s--;){const i=r[s];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:s}=this,i=Object.keys(s);for(let a=i.length;a--;){const l=s[i[a]];if(l?.body.type===t&&(!r||l.buffered)){const d=l.body;if(d.start<=e&&e<=d.end)return d}}return null}detectEvictedFragments(e,t,r,s,i){this.timeRanges&&(this.timeRanges[e]=t);const a=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(l=>{const d=this.fragments[l];if(!d||a>=d.body.sn)return;if(!d.buffered&&(!d.loaded||i)){d.body.type===r&&this.removeFragment(d.body);return}const u=d.range[e];if(u){if(u.time.length===0){this.removeFragment(d.body);return}u.time.some(h=>{const p=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return p&&this.removeFragment(d.body),p})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,s=bi(r),i=this.fragments[s];if(!i||i.buffered&&r.gap)return;const a=!r.relurl;Object.keys(t).forEach(l=>{const d=r.elementaryStreams[l];if(!d)return;const u=t[l],h=a||d.partial===!0;i.range[l]=this.getBufferedTimes(r,e.part,h,u)}),i.loaded=null,Object.keys(i.range).length?(this.bufferedEnd(i,r),Ol(i)||this.removeParts(r.sn-1,r.type)):this.removeFragment(i.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=Fg(r,s=>s.fragment.sn>=e))}fragBuffered(e,t){const r=bi(e);let s=this.fragments[r];!s&&t&&(s=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,this.bufferedEnd(s,e))}getBufferedTimes(e,t,r,s){const i={time:[],partial:r},a=e.start,l=e.end,d=e.minEndPTS||l,u=e.maxStartPTS||a;for(let h=0;h<s.length;h++){const p=s.start(h)-this.bufferPadding,g=s.end(h)+this.bufferPadding;if(u>=p&&d<=g){i.time.push({startPTS:Math.max(a,s.start(h)),endPTS:Math.min(l,s.end(h))});break}else if(a<g&&l>p){const x=Math.max(a,s.start(h)),y=Math.min(l,s.end(h));y>x&&(i.partial=!0,i.time.push({startPTS:x,endPTS:y}))}else if(l<=p)break}return i}getPartialFragment(e){let t=null,r,s,i,a=0;const{bufferPadding:l,fragments:d}=this;return Object.keys(d).forEach(u=>{const h=d[u];h&&Ol(h)&&(s=h.body.start-l,i=h.body.end+l,e>=s&&e<=i&&(r=Math.min(e-s,i-e),a<=r&&(t=h.body,a=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Ol(t))}getState(e){const t=bi(e),r=this.fragments[t];return r?r.buffered?Ol(r)?It.PARTIAL:It.OK:It.APPENDING:It.NOT_LOADED}isTimeBuffered(e,t,r){let s,i;for(let a=0;a<r.length;a++){if(s=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,e>=s&&t<=i)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,s=t.part?null:t,i=bi(r);this.fragments[i]={body:r,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:s,timeRanges:i,type:a}=t;if(r.sn==="initSegment")return;const l=r.type;if(s){let u=this.activePartLists[l];u||(this.activePartLists[l]=u=[]),u.push(s)}this.timeRanges=i;const d=i[a];this.detectEvictedFragments(a,d,l,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=bi(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let s=r.length;s--;){const i=t[r[s]];if(i?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,s,i){s&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const l=this.fragments[a];if(!l)return;const d=l.body;d.type!==r||s&&!d.gap||d.start<t&&d.end>e&&(l.buffered||i)&&this.removeFragment(d)})}removeFragment(e){const t=bi(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const s=e.sn;this.activePartLists[e.type]=Fg(r,i=>i.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(r=>r.clearElementaryStreamInfo())}}function Ol(n){var e,t,r;return n.buffered&&!!(n.body.gap||(e=n.range.video)!=null&&e.partial||(t=n.range.audio)!=null&&t.partial||(r=n.range.audiovideo)!=null&&r.partial)}function bi(n){return`${n.type}_${n.level}_${n.sn}`}function Fg(n,e){return n.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var hs={cbc:0,ctr:1};class dk{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case hs.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case hs.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function fk(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?n.slice(0,e-t):n}class hk{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let s=0;s<4;s++)r[s]=t.getUint32(s*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,s=r[0],i=r[1],a=r[2],l=r[3],d=this.invSubMix,u=d[0],h=d[1],p=d[2],g=d[3],x=new Uint32Array(256);let y=0,E=0,w=0;for(w=0;w<256;w++)w<128?x[w]=w<<1:x[w]=w<<1^283;for(w=0;w<256;w++){let S=E^E<<1^E<<2^E<<3^E<<4;S=S>>>8^S&255^99,e[y]=S,t[S]=y;const T=x[y],k=x[T],I=x[k];let L=x[S]*257^S*16843008;s[y]=L<<24|L>>>8,i[y]=L<<16|L>>>16,a[y]=L<<8|L>>>24,l[y]=L,L=I*16843009^k*65537^T*257^y*16843008,u[S]=L<<24|L>>>8,h[S]=L<<16|L>>>16,p[S]=L<<8|L>>>24,g[S]=L,y?(y=T^x[x[x[I^T]]],E^=x[x[E]]):y=E=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,s=0;for(;s<t.length&&r;)r=t[s]===this.key[s],s++;if(r)return;this.key=t;const i=this.keySize=t.length;if(i!==4&&i!==6&&i!==8)throw new Error("Invalid aes key size="+i);const a=this.ksRows=(i+6+1)*4;let l,d;const u=this.keySchedule=new Uint32Array(a),h=this.invKeySchedule=new Uint32Array(a),p=this.sBox,g=this.rcon,x=this.invSubMix,y=x[0],E=x[1],w=x[2],S=x[3];let T,k;for(l=0;l<a;l++){if(l<i){T=u[l]=t[l];continue}k=T,l%i===0?(k=k<<8|k>>>24,k=p[k>>>24]<<24|p[k>>>16&255]<<16|p[k>>>8&255]<<8|p[k&255],k^=g[l/i|0]<<24):i>6&&l%i===4&&(k=p[k>>>24]<<24|p[k>>>16&255]<<16|p[k>>>8&255]<<8|p[k&255]),u[l]=T=(u[l-i]^k)>>>0}for(d=0;d<a;d++)l=a-d,d&3?k=u[l]:k=u[l-4],d<4||l<=4?h[d]=k:h[d]=y[p[k>>>24]]^E[p[k>>>16&255]]^w[p[k>>>8&255]]^S[p[k&255]],h[d]=h[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const s=this.keySize+6,i=this.invKeySchedule,a=this.invSBox,l=this.invSubMix,d=l[0],u=l[1],h=l[2],p=l[3],g=this.uint8ArrayToUint32Array_(r);let x=g[0],y=g[1],E=g[2],w=g[3];const S=new Int32Array(e),T=new Int32Array(S.length);let k,I,L,O,P,j,F,D,$,J,ne,se,X,Z;const ie=this.networkToHostOrderSwap;for(;t<S.length;){for($=ie(S[t]),J=ie(S[t+1]),ne=ie(S[t+2]),se=ie(S[t+3]),P=$^i[0],j=se^i[1],F=ne^i[2],D=J^i[3],X=4,Z=1;Z<s;Z++)k=d[P>>>24]^u[j>>16&255]^h[F>>8&255]^p[D&255]^i[X],I=d[j>>>24]^u[F>>16&255]^h[D>>8&255]^p[P&255]^i[X+1],L=d[F>>>24]^u[D>>16&255]^h[P>>8&255]^p[j&255]^i[X+2],O=d[D>>>24]^u[P>>16&255]^h[j>>8&255]^p[F&255]^i[X+3],P=k,j=I,F=L,D=O,X=X+4;k=a[P>>>24]<<24^a[j>>16&255]<<16^a[F>>8&255]<<8^a[D&255]^i[X],I=a[j>>>24]<<24^a[F>>16&255]<<16^a[D>>8&255]<<8^a[P&255]^i[X+1],L=a[F>>>24]<<24^a[D>>16&255]<<16^a[P>>8&255]<<8^a[j&255]^i[X+2],O=a[D>>>24]<<24^a[P>>16&255]<<16^a[j>>8&255]<<8^a[F&255]^i[X+3],T[t]=ie(k^x),T[t+1]=ie(O^y),T[t+2]=ie(L^E),T[t+3]=ie(I^w),x=$,y=J,E=ne,w=se,t=t+4}return T.buffer}}class mk{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=pk(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function pk(n){switch(n){case hs.cbc:return"AES-CBC";case hs.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}const gk=16;class Fh{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?fk(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,s){return this.useSoftware?new Promise((i,a)=>{const l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,t,r,s);const d=this.flush();d?i(d.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,s)}softwareDecrypt(e,t,r,s){const{currentIV:i,currentResult:a,remainderData:l}=this;if(s!==hs.cbc||t.byteLength!==16)return Qe.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=Tr(l,e),this.remainderData=null);const d=this.getValidChunk(e);if(!d.length)return null;i&&(r=i);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new hk),u.expandKey(t);const h=a;return this.currentResult=u.decrypt(d.buffer,0,r),this.currentIV=d.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,r,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,s));this.key=t,this.fastAesKey=new mk(this.subtle,t,s)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new dk(this.subtle,new Uint8Array(r),s).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(Qe.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,r,s)))}onWebCryptoError(e,t,r,s){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,s);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%gk;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(Qe.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Ug=Math.pow(2,17);class xk{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new Sn({type:Te.NETWORK_ERROR,details:q.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((l,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){d($g(e));return}else e.gap=!1;const u=this.loader=i?new i(s):new a(s),h=Bg(e);e.loader=u;const p=Mg(s.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Ug};e.stats=u.stats;const x={onSuccess:(y,E,w,S)=>{this.resetLoader(e,u);let T=y.data;w.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),l({frag:e,part:null,payload:T,networkDetails:S})},onError:(y,E,w,S)=>{this.resetLoader(e,u),d(new Sn({type:Te.NETWORK_ERROR,details:q.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Ye({url:r,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:w,stats:S}))},onAbort:(y,E,w)=>{this.resetLoader(e,u),d(new Sn({type:Te.NETWORK_ERROR,details:q.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:w,stats:y}))},onTimeout:(y,E,w)=>{this.resetLoader(e,u),d(new Sn({type:Te.NETWORK_ERROR,details:q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:w,stats:y}))}};t&&(x.onProgress=(y,E,w,S)=>t({frag:e,part:null,payload:w,networkDetails:S})),u.load(h,g,x)})}loadPart(e,t,r){this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((l,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d($g(e,t));return}const u=this.loader=i?new i(s):new a(s),h=Bg(e,t);e.loader=u;const p=Mg(s.fragLoadPolicy.default),g={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Ug};t.stats=u.stats,u.load(h,g,{onSuccess:(x,y,E,w)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const S={frag:e,part:t,payload:x.data,networkDetails:w};r(S),l(S)},onError:(x,y,E,w)=>{this.resetLoader(e,u),d(new Sn({type:Te.NETWORK_ERROR,details:q.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Ye({url:h.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:E,stats:w}))},onAbort:(x,y,E)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),d(new Sn({type:Te.NETWORK_ERROR,details:q.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:E,stats:x}))},onTimeout:(x,y,E)=>{this.resetLoader(e,u),d(new Sn({type:Te.NETWORK_ERROR,details:q.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:E,stats:x}))}})})}updateStatsFromPart(e,t){const r=e.stats,s=t.stats,i=s.total;if(r.loaded+=s.loaded,i){const d=Math.round(e.duration/t.duration),u=Math.min(Math.round(r.loaded/i),d),p=(d-u)*Math.round(r.loaded/u);r.total=r.loaded+p}else r.total=Math.max(r.loaded,r.total);const a=r.loading,l=s.loading;a.start?a.first+=l.first-l.start:(a.start=l.start,a.first=l.first),a.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Bg(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,i=t.byteRangeEndOffset;if(xe(s)&&xe(i)){var a;let l=s,d=i;if(n.sn==="initSegment"&&vk((a=n.decryptdata)==null?void 0:a.method)){const u=i-s;u%16&&(d=i+(16-u%16)),s!==0&&(r.resetIV=!0,l=s-16)}r.rangeStart=l,r.rangeEnd=d}return r}function $g(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:Te.MEDIA_ERROR,details:q.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new Sn(r)}function vk(n){return n==="AES-128"||n==="AES-256"}class Sn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Py extends kr{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Uh{constructor(e,t,r,s=0,i=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=jl(),this.buffering={audio:jl(),video:jl(),audiovideo:jl()},this.level=e,this.sn=t,this.id=r,this.size=s,this.part=i,this.partial=a}}function jl(){return{start:0,executeStart:0,executeEnd:0,end:0}}const Vg={length:0,start:()=>0,end:()=>0};class Oe{static isBuffered(e,t){if(e){const r=Oe.getBuffered(e);for(let s=r.length;s--;)if(t>=r.start(s)&&t<=r.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=Oe.getBuffered(e);return Oe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const s=Oe.bufferedRanges(e);if(s.length)return Oe.bufferedInfo(s,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((h,p)=>h.start-p.start||p.end-h.end);let s=-1,i=[];if(r)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(s=h);const p=i.length;if(p){const g=i[p-1].end;e[h].start-g<r?e[h].end>g&&(i[p-1].end=e[h].end):i.push(e[h])}else i.push(e[h])}else i=e;let a=0,l,d=t,u=t;for(let h=0;h<i.length;h++){const p=i[h].start,g=i[h].end;if(s===-1&&t>=p&&t<=g&&(s=h),t+r>=p&&t<g)d=p,u=g,a=u-t;else if(t+r<p){l=p;break}}return{len:a,start:d||0,end:u||0,nextStart:l,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||Vg}catch(t){return Qe.log("failed to get media.buffered",t),Vg}}}const Oy=/\{\$([a-zA-Z0-9-_]+)\}/g;function Gg(n){return Oy.test(n)}function th(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(Oy,r=>{const s=r.substring(2,r.length-1),i=t?.[s];return i===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),r):i})}return e}function Hg(n,e,t){let r=n.variableList;r||(n.variableList=r={});let s,i;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(s))i=a.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(a){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else s=e.NAME,i=e.VALUE;s in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=i||""}function yk(n,e,t){const r=e.IMPORT;if(t&&r in t){let s=n.variableList;s||(n.variableList=s={}),s[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const Ek=/^(\d+)x(\d+)$/,qg=/(.+?)=(".*?"|.*?)(?:,|$)/g;class dt{constructor(e,t){typeof e=="string"&&(e=dt.parseAttrList(e,t)),Ze(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)r[s]=parseInt(t.slice(s*2,s*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((s,i)=>(s[i.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=Ek.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const s={};for(qg.lastIndex=0;(r=qg.exec(e))!==null;){const a=r[1].trim();let l=r[2];const d=l.indexOf('"')===0&&l.lastIndexOf('"')===l.length-1;let u=!1;if(d)l=l.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(d||u))l=th(t,l);else if(!u&&!d)switch(a){case"CLOSED-CAPTIONS":if(l==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Qe.warn(`${e}: attribute ${a} is missing quotes`)}s[a]=l}return s}}const wk="com.apple.hls.interstitial";function bk(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function Sk(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}class jy{constructor(e,t,r=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(s=t?.tagOrder)!=null?s:r,t){const i=t.attr;for(const a in i)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==i[a]){Qe.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=Ze(new dt({}),i,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=t?.endDate||new Date(this.attr["END-DATE"]);xe(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Qe.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(xe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===wk}get isValid(){return!!this.id&&!this._badValueForSameId&&xe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const Tk=10;class _k{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return this.fragments.length?xe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Tk}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function yc(n,e){return n.length===e.length?!n.some((t,r)=>t!==e[r]):!1}function Kg(n,e){return!n&&!e?!0:!n||!e?!1:yc(n,e)}function Ni(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function Bh(n){switch(n){case"AES-128":case"AES-256":return hs.cbc;case"AES-256-CTR":return hs.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function $h(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function rh(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}function kk(n){const e=rh(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function My(n){const e=function(r,s,i){const a=r[s];r[s]=r[i],r[i]=a};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function Fy(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),s=r[r.length-1].split(",");if(s.length===2){const i=s[0]==="base64",a=s[1];i?(r.splice(-1,1),t=$h(a)):t=kk(a)}}return t}const Ec=typeof self<"u"?self:void 0;var ht={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Bt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function sc(n){switch(n){case Bt.FAIRPLAY:return ht.FAIRPLAY;case Bt.PLAYREADY:return ht.PLAYREADY;case Bt.WIDEVINE:return ht.WIDEVINE;case Bt.CLEARKEY:return ht.CLEARKEY}}function sf(n){switch(n){case ht.FAIRPLAY:return Bt.FAIRPLAY;case ht.PLAYREADY:return Bt.PLAYREADY;case ht.WIDEVINE:return Bt.WIDEVINE;case ht.CLEARKEY:return Bt.CLEARKEY}}function Ga(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[ht.FAIRPLAY,ht.WIDEVINE,ht.PLAYREADY,ht.CLEARKEY].filter(s=>!!e[s]):[];return!r[ht.WIDEVINE]&&t&&r.push(ht.WIDEVINE),r}const Uy=(function(n){return Ec!=null&&(n=Ec.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function Ck(n,e,t,r){let s;switch(n){case ht.FAIRPLAY:s=["cenc","sinf"];break;case ht.WIDEVINE:case ht.PLAYREADY:s=["cenc"];break;case ht.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return Ik(s,e,t,r)}function Ik(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(i=>({contentType:`audio/mp4; codecs=${i}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(i=>({contentType:`video/mp4; codecs=${i}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function Ak(n){var e;return!!n&&(n.sessionType==="persistent-license"||!!((e=n.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function By(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(a){const l=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(l){const d=$h(l).subarray(0,16);return My(d),d}}return null}let Si={};class us{static clearKeyUriToKeyIdMap(){Si={}}static setKeyIdForUri(e,t){Si[e]=t}static addKeyIdForUri(e){const t=Object.keys(Si).length%Number.MAX_SAFE_INTEGER,r=new Uint8Array(16);return new DataView(r.buffer,12,4).setUint32(0,t),Si[e]=r,r}constructor(e,t,r,s=[1],i=null,a){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=s,this.iv=i,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Ni(e),a!=null&&a.startsWith("0x")&&(this.keyId=new Uint8Array(my(a)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&yc(e.keyFormatVersions,this.keyFormatVersions)&&Kg(e.iv,this.iv)&&Kg(e.keyId,this.keyId)}isSupported(){if(this.method){if(Ni(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Bt.FAIRPLAY:case Bt.WIDEVINE:case Bt.PLAYREADY:case Bt.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(Ni(this.method)){let i=this.iv;return i||(typeof e!="number"&&(Qe.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),i=Rk(e)),new us(this.method,this.uri,"identity",this.keyFormatVersions,i)}if(this.keyId){const i=Si[this.uri];if(i&&!yc(this.keyId,i)&&us.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const r=Fy(this.uri);if(r)switch(this.keyFormat){case Bt.WIDEVINE:if(this.pssh=r,!this.keyId){const i=P_(r.buffer);if(i.length){var s;const a=i[0];this.keyId=(s=a.kids)!=null&&s.length?a.kids[0]:null}}this.keyId||(this.keyId=zg(t));break;case Bt.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=D_(i,null,r),this.keyId=By(r);break}default:{let i=r.subarray(0,16);if(i.length!==16){const a=new Uint8Array(16);a.set(i,16-i.length),i=a}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i;i=Lk(t),i||(i=zg(t),i||(i=Si[this.uri])),i&&(this.keyId=i,us.setKeyIdForUri(this.uri,i))}return this}}function Lk(n){const e=n?.[Bt.WIDEVINE];return e?e.keyId:null}function zg(n){const e=n?.[Bt.PLAYREADY];if(e){const t=Fy(e.uri);if(t)return By(t)}return null}function Rk(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const Wg=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Yg=/#EXT-X-MEDIA:(.*)/g,Nk=/^#EXT(?:INF|-X-TARGETDURATION):/m,af=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Dk=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class tn{static findGroup(e,t){for(let r=0;r<e.length;r++){const s=e[r];if(s.id===t)return s}}static resolve(e,t){return Nh.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Nk.test(e)}static parseMasterPlaylist(e,t){const r=Gg(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},i=[];if(Wg.lastIndex=0,!e.startsWith("#EXTM3U"))return s.playlistParsingError=new Error("no EXTM3U delimiter"),s;let a;for(;(a=Wg.exec(e))!=null;)if(a[1]){var l;const u=new dt(a[1],s),h=th(s,a[2]),p={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:tn.resolve(h,t)},g=u.decimalResolution("RESOLUTION");g&&(p.width=g.width,p.height=g.height),Zg(u.CODECS,p);const x=u["SUPPLEMENTAL-CODECS"];x&&(p.supplemental={},Zg(x,p.supplemental)),(l=p.unknownCodecs)!=null&&l.length||i.push(p),s.levels.push(p)}else if(a[3]){const u=a[3],h=a[4];switch(u){case"SESSION-DATA":{const p=new dt(h,s),g=p["DATA-ID"];g&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[g]=p);break}case"SESSION-KEY":{const p=Qg(h,t,s);p.encrypted&&p.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(p)):Qe.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const p=new dt(h,s);Hg(s,p,t)}break}case"CONTENT-STEERING":{const p=new dt(h,s);s.contentSteering={uri:tn.resolve(p["SERVER-URI"],t),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=Xg(h);break}}}const d=i.length>0&&i.length<s.levels.length;return s.levels=d?i:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,r){let s;const i={},a=r.levels,l={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(Yg.lastIndex=0;(s=Yg.exec(e))!==null;){const u=new dt(s[1],r),h=u.TYPE;if(h){const p=l[h],g=i[h]||[];i[h]=g;const x=u.LANGUAGE,y=u["ASSOC-LANGUAGE"],E=u.CHANNELS,w=u.CHARACTERISTICS,S=u["INSTREAM-ID"],T={attrs:u,bitrate:0,id:d++,groupId:u["GROUP-ID"]||"",name:u.NAME||x||"",type:h,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:x,url:u.URI?tn.resolve(u.URI,t):""};if(y&&(T.assocLang=y),E&&(T.channels=E),w&&(T.characteristics=w),S&&(T.instreamId=S),p!=null&&p.length){const k=tn.findGroup(p,T.groupId)||p[0];Jg(T,k,"audioCodec"),Jg(T,k,"textCodec")}g.push(T)}}return i}static parseLevelPlaylist(e,t,r,s,i,a){var l;const d={url:t},u=new _k(t),h=u.fragments,p=[];let g=null,x=0,y=0,E=0,w=0,S=0,T=null,k=new tf(s,d),I,L,O,P=-1,j=!1,F=null,D;if(af.lastIndex=0,u.m3u8=e,u.hasVariableRefs=Gg(e),((l=af.exec(e))==null?void 0:l[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(I=af.exec(e))!==null;){j&&(j=!1,k=new tf(s,d),k.playlistOffset=E,k.setStart(E),k.sn=x,k.cc=w,S&&(k.bitrate=S),k.level=r,g&&(k.initSegment=g,g.rawProgramDateTime&&(k.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),F&&(k.setByteRange(F),F=null)));const se=I[1];if(se){k.duration=parseFloat(se);const X=(" "+I[2]).slice(1);k.title=X||null,k.tagList.push(X?["INF",se,X]:["INF",se])}else if(I[3]){if(xe(k.duration)){k.playlistOffset=E,k.setStart(E),O&&tx(k,O,u),k.sn=x,k.level=r,k.cc=w,h.push(k);const X=(" "+I[3]).slice(1);k.relurl=th(u,X),nh(k,T,p),T=k,E+=k.duration,x++,y=0,j=!0}}else{if(I=I[0].match(Dk),!I){Qe.warn("No matches on slow regex match for level playlist!");continue}for(L=1;L<I.length&&I[L]===void 0;L++);const X=(" "+I[L]).slice(1),Z=(" "+I[L+1]).slice(1),ie=I[L+2]?(" "+I[L+2]).slice(1):null;switch(X){case"BYTERANGE":T?k.setByteRange(Z,T):k.setByteRange(Z);break;case"PROGRAM-DATE-TIME":k.rawProgramDateTime=Z,k.tagList.push(["PROGRAM-DATE-TIME",Z]),P===-1&&(P=h.length);break;case"PLAYLIST-TYPE":u.type&&En(u,X,I),u.type=Z.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?En(u,X,I):h.length>0&&rx(u,X,I),x=u.startSN=parseInt(Z);break;case"SKIP":{u.skippedSegments&&En(u,X,I);const G=new dt(Z,u),Q=G.decimalInteger("SKIPPED-SEGMENTS");if(xe(Q)){u.skippedSegments+=Q;for(let N=Q;N--;)h.push(null);x+=Q}const W=G.enumeratedString("RECENTLY-REMOVED-DATERANGES");W&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(W.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&En(u,X,I),u.targetduration=Math.max(parseInt(Z),1);break;case"VERSION":u.version!==null&&En(u,X,I),u.version=parseInt(Z);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||En(u,X,I),u.live=!1;break;case"#":(Z||ie)&&k.tagList.push(ie?[Z,ie]:[Z]);break;case"DISCONTINUITY":w++,k.tagList.push(["DIS"]);break;case"GAP":k.gap=!0,k.tagList.push([X]);break;case"BITRATE":k.tagList.push([X,Z]),S=parseInt(Z)*1e3,xe(S)?k.bitrate=S:S=0;break;case"DATERANGE":{const G=new dt(Z,u),Q=new jy(G,u.dateRanges[G.ID],u.dateRangeTagCount);u.dateRangeTagCount++,Q.isValid||u.skippedSegments?u.dateRanges[Q.id]=Q:Qe.warn(`Ignoring invalid DATERANGE tag: "${Z}"`),k.tagList.push(["EXT-X-DATERANGE",Z]);break}case"DEFINE":{{const G=new dt(Z,u);"IMPORT"in G?yk(u,G,a):Hg(u,G,t)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?En(u,X,I):h.length>0&&rx(u,X,I),u.startCC=w=parseInt(Z);break;case"KEY":{const G=Qg(Z,t,u);if(G.isSupported()){if(G.method==="NONE"){O=void 0;break}O||(O={});const Q=O[G.keyFormat];Q!=null&&Q.matches(G)||(Q&&(O=Ze({},O)),O[G.keyFormat]=G)}else Qe.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${Z}"`);break}case"START":u.startTimeOffset=Xg(Z);break;case"MAP":{const G=new dt(Z,u);if(k.duration){const Q=new tf(s,d);ex(Q,G,r,O),g=Q,k.initSegment=g,g.rawProgramDateTime&&!k.rawProgramDateTime&&(k.rawProgramDateTime=g.rawProgramDateTime)}else{const Q=k.byteRangeEndOffset;if(Q){const W=k.byteRangeStartOffset;F=`${Q-W}@${W}`}else F=null;ex(k,G,r,O),g=k,j=!0}g.cc=w;break}case"SERVER-CONTROL":{D&&En(u,X,I),D=new dt(Z),u.canBlockReload=D.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=D.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&D.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=D.optionalFloat("PART-HOLD-BACK",0),u.holdBack=D.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&En(u,X,I);const G=new dt(Z);u.partTarget=G.decimalFloatingPoint("PART-TARGET");break}case"PART":{let G=u.partList;G||(G=u.partList=[]);const Q=y>0?G[G.length-1]:void 0,W=y++,N=new dt(Z,u),U=new y_(N,k,d,W,Q);G.push(U),k.duration+=U.duration;break}case"PRELOAD-HINT":{const G=new dt(Z,u);u.preloadHint=G;break}case"RENDITION-REPORT":{const G=new dt(Z,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(G);break}default:Qe.warn(`line parsed but not handled: ${I}`);break}}}T&&!T.relurl?(h.pop(),E-=T.duration,u.partList&&(u.fragmentHint=T)):u.partList&&(nh(k,T,p),k.cc=w,u.fragmentHint=k,O&&tx(k,O,u)),u.targetduration||(u.playlistParsingError=new Error("Missing Target Duration"));const $=h.length,J=h[0],ne=h[$-1];if(E+=u.skippedSegments*u.targetduration,E>0&&$&&ne){u.averagetargetduration=E/$;const se=ne.sn;u.endSN=se!=="initSegment"?se:0,u.live||(ne.endList=!0),P>0&&(Ok(h,P),J&&p.unshift(J))}return u.fragmentHint&&(E+=u.fragmentHint.duration),u.totalduration=E,p.length&&u.dateRangeTagCount&&J&&$y(p,u),u.endCC=w,u}}function $y(n,e){let t=n.length;if(!t)if(e.hasProgramDateTime){const l=e.fragments[e.fragments.length-1];n.push(l),t++}else return;const r=n[t-1],s=e.live?1/0:e.totalduration,i=Object.keys(e.dateRanges);for(let l=i.length;l--;){const d=e.dateRanges[i[l]],u=d.startDate.getTime();d.tagAnchor=r.ref;for(let h=t;h--;){var a;if(((a=n[h])==null?void 0:a.sn)<e.startSN)break;const p=Pk(e,u,n,h,s);if(p!==-1){d.tagAnchor=e.fragments[p].ref;break}}}}function Pk(n,e,t,r,s){const i=t[r];if(i){const l=i.programDateTime;if(e>=l||r===0){var a;const d=(((a=t[r+1])==null?void 0:a.start)||s)-i.start;if(e<=l+d*1e3){const u=t[r].sn-n.startSN;if(u<0)return-1;const h=n.fragments;if(h.length>t.length){const g=(t[r+1]||h[h.length-1]).sn-n.startSN;for(let x=g;x>u;x--){const y=h[x].programDateTime;if(e>=y&&e<y+h[x].duration*1e3)return x}}return u}}}return-1}function Qg(n,e,t){var r,s;const i=new dt(n,t),a=(r=i.METHOD)!=null?r:"",l=i.URI,d=i.hexadecimalInteger("IV"),u=i.KEYFORMATVERSIONS,h=(s=i.KEYFORMAT)!=null?s:"identity";l&&i.IV&&!d&&Qe.error(`Invalid IV: ${i.IV}`);const p=l?tn.resolve(l,e):"",g=(u||"1").split("/").map(Number).filter(Number.isFinite);return new us(a,p,h,g,d,i.KEYID)}function Xg(n){const t=new dt(n).decimalFloatingPoint("TIME-OFFSET");return xe(t)?t:null}function Zg(n,e){let t=(n||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const s=t.filter(i=>Oh(i,r));s.length&&(e[`${r}Codec`]=s.map(i=>i.split("/")[0]).join(","),t=t.filter(i=>s.indexOf(i)===-1))}),e.unknownCodecs=t}function Jg(n,e,t){const r=e[t];r&&(n[t]=r)}function Ok(n,e){let t=n[e];for(let r=e;r--;){const s=n[r];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function nh(n,e,t){n.rawProgramDateTime?t.push(n):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime)}function ex(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function tx(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&r.push(n)}function En(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function rx(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function of(n,e){const t=e.startPTS;if(xe(t)){let r=0,s;e.sn>n.sn?(r=t-n.start,s=n):(r=n.start-t,s=e),s.duration!==r&&s.setDuration(r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.setStart(n.start+(n.minEndPTS-n.start)):e.setStart(n.start+n.duration):e.setStart(Math.max(n.start-e.duration,0))}function Vy(n,e,t,r,s,i,a){r-t<=0&&(a.warn("Fragment should have a positive duration",e),r=t+e.duration,i=s+e.duration);let d=t,u=r;const h=e.startPTS,p=e.endPTS;if(xe(h)){const S=Math.abs(h-t);n&&S>n.totalduration?a.warn(`media timestamps and playlist times differ by ${S}s for level ${e.level} ${n.url}`):xe(e.deltaPTS)?e.deltaPTS=Math.max(S,e.deltaPTS):e.deltaPTS=S,d=Math.max(t,h),t=Math.min(t,h),s=e.startDTS!==void 0?Math.min(s,e.startDTS):s,u=Math.min(r,p),r=Math.max(r,p),i=e.endDTS!==void 0?Math.max(i,e.endDTS):i}const g=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=d,e.startDTS=s,e.endPTS=r,e.minEndPTS=u,e.endDTS=i;const x=e.sn;if(!n||x<n.startSN||x>n.endSN)return 0;let y;const E=x-n.startSN,w=n.fragments;for(w[E]=e,y=E;y>0;y--)of(w[y],w[y-1]);for(y=E;y<w.length-1;y++)of(w[y],w[y+1]);return n.fragmentHint&&of(w[w.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,g}function jk(n,e,t){if(n===e)return;let r=null;const s=n.fragments;for(let h=s.length-1;h>=0;h--){const p=s[h].initSegment;if(p){r=p;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let i;Uk(n,e,(h,p,g,x)=>{if((!e.startCC||e.skippedSegments)&&p.cc!==h.cc){const y=h.cc-p.cc;for(let E=g;E<x.length;E++)x[E].cc+=y;e.endCC=x[x.length-1].cc}xe(h.startPTS)&&xe(h.endPTS)&&(p.setStart(p.startPTS=h.startPTS),p.startDTS=h.startDTS,p.maxStartPTS=h.maxStartPTS,p.endPTS=h.endPTS,p.endDTS=h.endDTS,p.minEndPTS=h.minEndPTS,p.setDuration(h.endPTS-h.startPTS),p.duration&&(i=p),e.PTSKnown=e.alignedSliding=!0),h.hasStreams&&(p.elementaryStreams=h.elementaryStreams),p.loader=h.loader,h.hasStats&&(p.stats=h.stats),h.initSegment&&(p.initSegment=h.initSegment,r=h.initSegment)});const a=e.fragments,l=e.fragmentHint?a.concat(e.fragmentHint):a;if(r&&l.forEach(h=>{var p;h&&(!h.initSegment||h.initSegment.relurl===((p=r)==null?void 0:p.relurl))&&(h.initSegment=r)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(h=>!h),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let h=e.skippedSegments;h--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=Mk(n.dateRanges,e,t));const h=n.fragments.filter(p=>p.rawProgramDateTime);if(n.hasProgramDateTime&&!e.hasProgramDateTime)for(let p=1;p<l.length;p++)l[p].programDateTime===null&&nh(l[p],l[p-1],h);$y(h,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var d;const h=qy(n,e.startSN-1);e.startCC=(d=h?.cc)!=null?d:a[0].cc}Fk(n.partList,e.partList,(h,p)=>{p.elementaryStreams=h.elementaryStreams,p.stats=h.stats}),i?Vy(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS,t):Gy(n,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const h=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=h),e.driftEndTime=u,e.driftEnd=h}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=n.requestScheduled)}function Mk(n,e,t){const{dateRanges:r,recentlyRemovedDateranges:s}=e,i=Ze({},n);s&&s.forEach(d=>{delete i[d]});const l=Object.keys(i).length;return l?(Object.keys(r).forEach(d=>{const u=i[d],h=new jy(r[d].attr,u);h.isValid?(i[d]=h,u||(h.tagOrder+=l)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${tt(r[d].attr)}"`)}),i):r}function Fk(n,e,t){if(n&&e){let r=0;for(let s=0,i=n.length;s<=i;s++){const a=n[s],l=e[s+r];a&&l&&a.index===l.index&&a.fragment.sn===l.fragment.sn?t(a,l):r--}}}function Uk(n,e,t){const r=e.skippedSegments,s=Math.max(n.startSN,e.startSN)-e.startSN,i=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,a=e.startSN-n.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let u=s;u<=i;u++){const h=d[a+u];let p=l[u];if(r&&!p&&h&&(p=e.fragments[u]=h),h&&p){t(h,p,u,l);const g=h.relurl,x=p.relurl;if(g&&Bk(g,x)){e.playlistParsingError=nx(`media sequence mismatch ${p.sn}:`,n,e,h,p);return}else if(h.cc!==p.cc){e.playlistParsingError=nx(`discontinuity sequence mismatch (${h.cc}!=${p.cc})`,n,e,h,p);return}}}}function nx(n,e,t,r,s){return new Error(`${n} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function Gy(n,e,t=!0){const r=e.startSN+e.skippedSegments-n.startSN,s=n.fragments,i=r>=0;let a=0;if(i&&r<s.length)a=s[r].start;else if(i&&e.startSN===n.endSN+1)a=n.fragmentEnd;else if(i&&t)a=n.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=n.fragmentStart;else return;sh(e,a)}function sh(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].addStart(e);n.fragmentHint&&n.fragmentHint.addStart(e)}}function Hy(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments;if(r.length&&t*4>e){const i=r[r.length-1].duration*1e3;i<t&&(t=i)}}else t/=2;return Math.round(t)}function qy(n,e,t){if(!n)return null;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function sx(n,e,t){return n?Ky(n.partList,e,t):null}function Ky(n,e,t){if(n)for(let r=n.length;r--;){const s=n[r];if(s.index===t&&s.fragment.sn===e)return s}return null}function zy(n){n.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function Bk(n,e){return n!==e&&e?ix(n)!==ix(e):!1}function ix(n){return n.replace(/\?[^?]*$/,"")}function qa(n,e){for(let r=0,s=n.length;r<s;r++){var t;if(((t=n[r])==null?void 0:t.cc)===e)return n[r]}return null}function $k(n,e){return!!(n&&e.startCC<n.endCC&&e.endCC>n.startCC)}function ax(n,e){const t=n.start+e;n.startPTS=t,n.setStart(t),n.endPTS=t+n.duration}function Wy(n,e){const t=e.fragments;for(let r=0,s=t.length;r<s;r++)ax(t[r],n);e.fragmentHint&&ax(e.fragmentHint,n),e.alignedSliding=!0}function Vk(n,e){n&&(Yy(e,n),e.alignedSliding||wc(e,n),!e.alignedSliding&&!e.skippedSegments&&Gy(n,e,!1))}function Yy(n,e){if(!$k(e,n))return;const t=Math.min(e.endCC,n.endCC),r=qa(e.fragments,t),s=qa(n.fragments,t);if(!r||!s)return;Qe.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const i=r.start-s.start;Wy(i,n)}function wc(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;let s,i;const a=Math.min(e.endCC,n.endCC);e.startCC<a&&n.startCC<a&&(s=qa(r,a),i=qa(t,a)),(!s||!i)&&(s=r[Math.floor(r.length/2)],i=qa(t,s.cc)||t[Math.floor(t.length/2)]);const l=s.programDateTime,d=i.programDateTime;if(!l||!d)return;const u=(d-l)/1e3-(i.start-s.start);Wy(u,n)}function Qt(n,e,t){ir(n,e,t),n.addEventListener(e,t)}function ir(n,e,t){n.removeEventListener(e,t)}const Gk={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},te={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Vh extends Py{constructor(e,t,r,s,i){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=te.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:l,media:d,mediaBuffer:u,state:h}=this,p=d?d.currentTime:0,g=Oe.bufferInfo(u||d,p,a.maxBufferHole),x=!g.len;if(this.log(`Media seeking to ${xe(p)?p.toFixed(3):p}, state: ${h}, ${x?"out of":"in"} buffer`),this.state===te.ENDED)this.resetLoadingState();else if(l){const y=a.maxFragLookUpTolerance,E=l.start-y,w=l.start+l.duration+y;if(x||w<g.start||E>g.end){const S=p>w;(p<E||S)&&(S&&l.loader&&(this.log(`Cancelling fragment load for seek (sn: ${l.sn})`),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(p>y&&(this.lastCurrentTime=p),!this.loadingParts){const E=Math.max(g.end,p),w=this.shouldLoadParts(this.getLevelDetails(),E);w&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${E.toFixed(2)}`),this.loadingParts=w)}}this.hls.hasEnoughToStart||(this.log(`Setting ${x?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,x&&(this.startPosition=p)),x&&this.state===te.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=i,this.hls=e,this.fragmentLoader=new xk(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Fh(e.config)}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===te.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=te.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,s=this.config.timelineOffset||0;if(r<=s)return!1;const i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=Oe.bufferedInfo(i,e.start,0));const a=e.nextStart;if(a&&a>s&&a<t.edge||this.media.currentTime<e.start)return!1;const d=t.partList;if(d!=null&&d.length){const h=d[d.length-1];return Oe.isBuffered(this.media,h.start+h.duration/2)}const u=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;Qt(r,"seeking",this.onMediaSeeking),Qt(r,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===te.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ir(s,"seeking",this.onMediaSeeking),ir(s,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=te.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const s=i=>{const a=i.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(a,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(i)};this._doFragLoad(e,t,r,s).then(i=>{if(!i)return;const a=this.state,l=i.frag;if(this.fragContextChanged(l)){(a===te.FRAG_LOADING||!this.fragCurrent&&a===te.PARSING)&&(this.fragmentTracker.removeFragment(l),this.state=te.IDLE);return}"payload"in i&&(this.log(`Loaded ${l.type} sn: ${l.sn} of ${this.playlistLabel()} ${l.level}`),this.hls.trigger(C.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state===te.STOPPED||this.state===te.ERROR||(this.warn(`Frag error: ${i?.message||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===It.APPENDING){const i=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,i),l=Math.max(e.duration,a?a.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?e.sn-d.sn:0)===1||this.reduceMaxBufferLength(l,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===It.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:r};this.hls.trigger(C.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const s=r?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:s}=this,{frag:i,payload:a}=r,l=i.decryptdata;if(a&&a.byteLength>0&&l!=null&&l.key&&l.iv&&Ni(l.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),l.key.buffer,l.iv.buffer,Bh(l.method)).catch(u=>{throw s.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:i}),u}).then(u=>{const h=self.performance.now();return s.trigger(C.FRAG_DECRYPTED,{frag:i,payload:u,stats:{tstart:d,tdecrypt:h}}),r.payload=u,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===te.STOPPED||this.state===te.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==te.STOPPED&&(this.state=te.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var r,s;const i=e.tracks;if(i&&!t.encrypted&&((r=i.audio)!=null&&r.encrypted||(s=i.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const a=this.media,l=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${a?"attached mediaKeys: "+a.mediaKeys:"detached"})`);return this.warn(l.message),!a||a.mediaKeys?!1:(this.hls.trigger(C.ERROR,{type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_KEYS,fatal:!1,error:l,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?Gk.toString(Oe.getBuffered(r)):"(detached)"})`),wt(e)){var s;if(e.type!==ye.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(l=>!!a[l])){this.state=te.IDLE;return}}const i=(s=this.levels)==null?void 0:s[e.level];i!=null&&i.fragmentError&&(this.log(`Resetting level fragment error count of ${i.fragmentError} on frag buffered`),i.fragmentError=0)}this.state=te.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:s,partsLoaded:i}=e,a=!i||i.length===0||i.some(d=>!d),l=new Uh(r.level,r.sn,r.stats.chunkCount+1,0,s?s.index:-1,!a);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,s){var i;this.fragCurrent=e;const a=t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let l=null;if(e.encrypted&&!((i=e.decryptdata)!=null&&i.key)){if(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=te.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(C.KEY_LOADED,g),this.state===te.KEY_LOADING&&(this.state=te.IDLE),g}),this.hls.trigger(C.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(l=this.keyLoader.loadClear(e,a.encryptedFragments,this.startFragRequested),l&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(wt(e)&&(!d||e.sn!==d.sn)){const g=this.shouldLoadParts(t.details,e.end);g!==this.loadingParts&&(this.log(`LL-Part loading ${g?"ON":"OFF"} loading sn ${d?.sn}->${e.sn}`),this.loadingParts=g)}if(r=Math.max(e.start,r||0),this.loadingParts&&wt(e)){const g=a.partList;if(g&&s){r>a.fragmentEnd&&a.fragmentHint&&(e=a.fragmentHint);const x=this.getNextPart(g,e,r);if(x>-1){const y=g[x];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${x}/${g.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=te.FRAG_LOADING;let E;return l?E=l.then(w=>!w||this.fragContextChanged(w.frag)?null:this.doFragPartsLoad(e,y,t,s)).catch(w=>this.handleFragLoadError(w)):E=this.doFragPartsLoad(e,y,t,s).catch(w=>this.handleFragLoadError(w)),this.hls.trigger(C.FRAG_LOADING,{frag:e,part:y,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):E}else if(!e.url||this.loadedEndOfParts(g,r))return Promise.resolve(null)}}if(wt(e)&&this.loadingParts){var u;this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(u=a.partList)==null?void 0:u.filter(g=>g.loaded).map(g=>`[${g.start}-${g.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+a.startSN+"-"+a.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),xe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=te.FRAG_LOADING;const h=this.config.progressive&&e.type!==ye.SUBTITLE;let p;return h&&l?p=l.then(g=>!g||this.fragContextChanged(g.frag)?null:this.fragmentLoader.load(e,s)).catch(g=>this.handleFragLoadError(g)):p=Promise.all([this.fragmentLoader.load(e,h?s:void 0),l]).then(([g])=>(!h&&s&&s(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(C.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(e,t,r,s){return new Promise((i,a)=>{var l;const d=[],u=(l=r.details)==null?void 0:l.partList,h=p=>{this.fragmentLoader.loadPart(e,p,s).then(g=>{d[p.index]=g;const x=g.part;this.hls.trigger(C.FRAG_LOADED,g);const y=sx(r.details,e.sn,p.index+1)||Ky(u,e.sn,p.index+1);if(y)h(y);else return i({frag:e,part:x,partsLoaded:d})}).catch(a)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===q.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Te.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(C.ERROR,t)}else this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==te.PARSING){!this.fragCurrent&&this.state!==te.STOPPED&&this.state!==te.ERROR&&(this.state=te.IDLE);return}const{frag:r,part:s,level:i}=t,a=self.performance.now();r.stats.parsing.end=a,s&&(s.stats.parsing.end=a);const l=this.getLevelDetails(),u=l&&r.sn>l.endSN||this.shouldLoadParts(l,r.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(r,s,i,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r;const i=e.partList[0];if(i.fragment.type===ye.SUBTITLE)return!1;const a=i.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=a){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:s,sn:i,part:a}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const l=t[s],d=l.details,u=a>-1?sx(d,i,a):null,h=u?u.fragment:qy(d,i,r);return h?(r&&r!==h&&(h.stats=r.stats),{frag:h,part:u,level:l}):null}bufferFragmentData(e,t,r,s,i){if(this.state!==te.PARSING)return;const{data1:a,data2:l}=e;let d=a;if(l&&(d=Tr(a,l)),!d.length)return;const u=this.initPTS[t.cc],h=u?-u.baseTime/u.timescale:void 0,p={type:e.type,frag:t,part:r,chunkMeta:s,offset:h,parent:t.type,data:d};if(this.hls.trigger(C.BUFFER_APPENDING,p),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Oe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,s=Oe.bufferInfo(t,r,0),i=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),l=Math.max(Math.min(e.start-a,s.end-a),r+a);e.start-l>a&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){var r;const s=this.getLoadPosition();if(!xe(s))return null;const a=this.lastCurrentTime>s||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,a)}getFwdBufferInfoAtPos(e,t,r,s){const i=Oe.bufferInfo(e,t,s);if(i.len===0&&i.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(i.nextStart<=a.end||a.gap)){const l=Math.max(Math.min(i.nextStart,a.end)-t,s);return Oe.bufferInfo(e,t,l)}}return i}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,s=Math.max(Math.min(e-t,r.maxBufferLength),t),i=Math.max(e-t*3,r.maxMaxBufferLength/2,s);return i>=s?(r.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0):!1}getAppendedFrag(e,t=ye.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,s=r.length;if(!s)return null;const{config:i}=this,a=r[0].start,l=i.lowLatencyMode&&!!t.partList;let d=null;if(t.live){const p=i.initialLiveManifestSize;if(s<p)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${p})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var u;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(t);const g=this.hls.startPosition,x=this.hls.liveSyncPosition,y=d?(g!==-1&&g>=a?g:x)||d.start:e;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${g} liveSyncPosition: ${x} frag.start: ${(u=d)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=y}}else e<=a&&(d=r[0]);if(!d){const p=this.loadingParts?t.partEnd:t.fragmentEnd;d=this.getFragmentAtPosition(e,p,t)}let h=this.filterReplacedPrimary(d,t);if(!h&&d){const p=d.sn-t.startSN;h=this.filterReplacedPrimary(r[p+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===It.OK||r===It.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,s,i){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&r.nextStart)){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,s,0);if(l!==null&&r.len+l.len>=i){const d=a.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(ox(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(ox(this.config)&&e.type!==ye.SUBTITLE){const r=this.hls.interstitialsManager,s=r?.bufferingItem;if(s){const a=s.event;if(a){if(a.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&t?.live===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const i=r?.playerQueue;if(i)for(let a=i.length;a--;){const l=i[a].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let s=-1,i=!1,a=!0;for(let l=0,d=e.length;l<d;l++){const u=e[l];if(a=a&&!u.independent,s>-1&&r<u.start)break;const h=u.loaded;h?s=-1:(i||(u.independent||a)&&u.fragment===t)&&(u.fragment!==t&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${u.start}`),s=l),i=h}return s}loadedEndOfParts(e,t){let r;for(let s=e.length;s--;){if(r=e[s],!r.loaded)return!1;if(t>r.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let s=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),s=ik(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){const a=t[i-e.startSN];r.cc===a.cc&&(s=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=Ry(e,r.cc,r.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const i=this.hls.liveSyncPosition;i!==null&&(s=this.getFragmentAtPosition(i,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,r){const{config:s}=this;let{fragPrevious:i}=this,{fragments:a,endSN:l}=r;const{fragmentHint:d}=r,{maxFragLookUpTolerance:u}=s,h=r.partList,p=!!(this.loadingParts&&h!=null&&h.length&&d);p&&!this.bitrateTest&&h[h.length-1].fragment.sn===d.sn&&(a=a.concat(d),l=d.sn);let g;if(e<t){var x;const E=e<this.lastCurrentTime||e>t-u||(x=this.media)!=null&&x.paused||!this.startFragRequested?0:u;g=Gs(i,a,e,E)}else g=a[a.length-1];if(g){const y=g.sn-r.startSN,E=this.fragmentTracker.getState(g);if((E===It.OK||E===It.PARTIAL&&g.gap)&&(i=g),i&&g.sn===i.sn&&(!p||h[0].fragment.sn>g.sn||!r.live)&&g.level===i.level){const S=a[y+1];g.sn<l&&this.fragmentTracker.getState(S)!==It.OK?g=S:g=null}}return g}alignPlaylists(e,t,r){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const i=e.fragmentStart,a=!t,l=e.alignedSliding&&xe(i);if(a||!l&&!i){Vk(r,e);const d=e.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),d}return i}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const s=this.timelineOffset;if(r===-1){const i=this.startTimeOffset!==null,a=i?this.startTimeOffset:e.startTimeOffset;a!==null&&xe(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${a} found in ${i?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+s}this.nextLoadPosition=r+s}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&wt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==te.FRAG_LOADING_WAITING_RETRY)&&(this.state=te.IDLE)}onFragmentOrKeyLoadError(e,t){var r;if(t.chunkMeta&&!t.frag){const S=this.getCurrentContext(t.chunkMeta);S&&(t.frag=S.frag)}const s=t.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var i;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const a=t.details===q.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(s,!0);const l=t.errorAction;if(!l){this.state=te.ERROR;return}const{action:d,flags:u,retryCount:h=0,retryConfig:p}=l,g=!!p,x=g&&d===Ft.RetryRequest,y=g&&!l.resolved&&u===fr.MoveAllAlternatesMatchingHost,E=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!x&&y&&wt(s)&&!s.endList&&E&&!Dy(t))this.resetFragmentErrors(e),this.treatAsGap(s),l.resolved=!0;else if((x||y)&&h<p.maxNumRetry){var w;const S=eh((w=t.response)==null?void 0:w.code),T=Mh(p,h);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+T,this.state=te.FRAG_LOADING_WAITING_RETRY,l.resolved=!0,S){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${t.details}, retrying loading ${h+1}/${p.maxNumRetry} in ${T}ms`)}else if(p)if(this.resetFragmentErrors(e),h<p.maxNumRetry)!a&&d!==Ft.RemoveAlternatePermanently&&(l.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${h})`);return}else d===Ft.SendAlternateToPenaltyBox?this.state=te.WAITING_LEVEL:this.state=te.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!eh(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=te.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===te.PARSING||this.state===te.PARSED){const t=e.frag,r=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,r),i=s&&s.len>.5;i&&this.reduceMaxBufferLength(s.len,t?.duration||10);const a=!i;return a&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===ye.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==te.STOPPED&&(this.state=te.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const s=Oe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,r),this.state===te.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==te.STOPPED&&(this.state=te.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,s){const i=r.details;if(!i){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((d,u)=>{const h=e.elementaryStreams[u];if(h){const p=h.endPTS-h.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${p})`),d||!1;const g=s?0:Vy(i,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS,this);return this.hls.trigger(C.LEVEL_PTS_UPDATED,{details:i,level:r,drift:g,type:u,frag:e,start:h.startPTS,end:h.endPTS}),!0}return d},!1)){var l;const d=((l=this.transmuxer)==null?void 0:l.error)===null;if((r.fragmentError===0||d&&(r.fragmentError<2||e.endList))&&this.treatAsGap(e,r),d){const u=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(u.message),this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!1,error:u,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=te.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(C.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ye.MAIN?"level":"track"}fragInfo(e,t=!0,r){var s,i;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((s=t&&!r?e.startPTS:(r||e).start)!=null?s:NaN).toFixed(3)}-${((i=t&&!r?e.endPTS:(r||e).end)!=null?i:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function ox(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}class Qy{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=Hk(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function Hk(n,e){const t=new Uint8Array(e);let r=0;for(let s=0;s<n.length;s++){const i=n[s];t.set(i,r),r+=i.length}return t}var lf={exports:{}},lx;function qk(){return lx||(lx=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(d,u,h){this.fn=d,this.context=u,this.once=h||!1}function i(d,u,h,p,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new s(h,p||d,g),y=t?t+u:u;return d._events[y]?d._events[y].fn?d._events[y]=[d._events[y],x]:d._events[y].push(x):(d._events[y]=x,d._eventsCount++),d}function a(d,u){--d._eventsCount===0?d._events=new r:delete d._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],h,p;if(this._eventsCount===0)return u;for(p in h=this._events)e.call(h,p)&&u.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},l.prototype.listeners=function(u){var h=t?t+u:u,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,x=p.length,y=new Array(x);g<x;g++)y[g]=p[g].fn;return y},l.prototype.listenerCount=function(u){var h=t?t+u:u,p=this._events[h];return p?p.fn?1:p.length:0},l.prototype.emit=function(u,h,p,g,x,y){var E=t?t+u:u;if(!this._events[E])return!1;var w=this._events[E],S=arguments.length,T,k;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,p),!0;case 4:return w.fn.call(w.context,h,p,g),!0;case 5:return w.fn.call(w.context,h,p,g,x),!0;case 6:return w.fn.call(w.context,h,p,g,x,y),!0}for(k=1,T=new Array(S-1);k<S;k++)T[k-1]=arguments[k];w.fn.apply(w.context,T)}else{var I=w.length,L;for(k=0;k<I;k++)switch(w[k].once&&this.removeListener(u,w[k].fn,void 0,!0),S){case 1:w[k].fn.call(w[k].context);break;case 2:w[k].fn.call(w[k].context,h);break;case 3:w[k].fn.call(w[k].context,h,p);break;case 4:w[k].fn.call(w[k].context,h,p,g);break;default:if(!T)for(L=1,T=new Array(S-1);L<S;L++)T[L-1]=arguments[L];w[k].fn.apply(w[k].context,T)}}return!0},l.prototype.on=function(u,h,p){return i(this,u,h,p,!1)},l.prototype.once=function(u,h,p){return i(this,u,h,p,!0)},l.prototype.removeListener=function(u,h,p,g){var x=t?t+u:u;if(!this._events[x])return this;if(!h)return a(this,x),this;var y=this._events[x];if(y.fn)y.fn===h&&(!g||y.once)&&(!p||y.context===p)&&a(this,x);else{for(var E=0,w=[],S=y.length;E<S;E++)(y[E].fn!==h||g&&!y[E].once||p&&y[E].context!==p)&&w.push(y[E]);w.length?this._events[x]=w.length===1?w[0]:w:a(this,x)}return this},l.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&a(this,h)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l})(lf)),lf.exports}var Kk=qk(),Gh=x_(Kk);const no="1.6.15",Bi={};function zk(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Wk(){const n=Bi[no];if(n)return n.clientCount++,n;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return Bi[no]=s,s}function Yk(n){const e=Bi[n];if(e)return e.clientCount++,e;const t=new self.URL(n,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Bi[n]=s,s}function Qk(n){const e=Bi[n||no];if(e&&e.clientCount--===1){const{worker:r,objectURL:s}=e;delete Bi[n||no],s&&self.URL.revokeObjectURL(s),r.terminate()}}function Xy(n,e){return e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function Hh(n,e){return e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function Gc(n,e){let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t}function so(n,e){const t=e;let r=0;for(;Hh(n,e);){r+=10;const s=Gc(n,e+6);r+=s,Xy(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)}function Xk(n,e,t,r){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=e[t+2],a=i>>2&15;if(a>12){const x=new Error(`invalid ADTS sampling index:${a}`);n.emit(C.ERROR,C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!0,error:x,reason:x.message});return}const l=(i>>6&3)+1,d=e[t+3]>>6&3|(i&1)<<2,u="mp4a.40."+l,h=s[a];let p=a;(l===5||l===29)&&(p-=3);const g=[l<<3|(p&14)>>1,(p&1)<<7|d<<3];return Qe.log(`manifest codec:${r}, parsed codec:${u}, channels:${d}, rate:${h} (ADTS object type:${l} sampling index:${a})`),{config:g,samplerate:h,channelCount:d,codec:u,parsedCodec:u,manifestCodec:r}}function Zy(n,e){return n[e]===255&&(n[e+1]&246)===240}function Jy(n,e){return n[e+1]&1?7:9}function qh(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function Zk(n,e){return e+5<n.length}function bc(n,e){return e+1<n.length&&Zy(n,e)}function Jk(n,e){return Zk(n,e)&&Zy(n,e)&&qh(n,e)<=n.length-e}function eC(n,e){if(bc(n,e)){const t=Jy(n,e);if(e+t>=n.length)return!1;const r=qh(n,e);if(r<=t)return!1;const s=e+r;return s===n.length||bc(n,s)}return!1}function e1(n,e,t,r,s){if(!n.samplerate){const i=Xk(e,t,r,s);if(!i)return;Ze(n,i)}}function t1(n){return 1024*9e4/n}function tC(n,e){const t=Jy(n,e);if(e+t<=n.length){const r=qh(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function r1(n,e,t,r,s){const i=t1(n.samplerate),a=r+s*i,l=tC(e,t);let d;if(l){const{frameLength:p,headerLength:g}=l,x=g+p,y=Math.max(0,t+x-e.length);y?(d=new Uint8Array(x-g),d.set(e.subarray(t+g,e.length),0)):d=e.subarray(t+g,t+x);const E={unit:d,pts:a};return y||n.samples.push(E),{sample:E,length:x,missing:y}}const u=e.length-t;return d=new Uint8Array(u),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:a},length:u,missing:-1}}function rC(n,e){return Hh(n,e)&&Gc(n,e+6)+10<=n.length-e}function nC(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function cf(n,e=0,t=1/0){return sC(n,e,t,Uint8Array)}function sC(n,e,t,r){const s=iC(n);let i=1;"BYTES_PER_ELEMENT"in r&&(i=r.BYTES_PER_ELEMENT);const a=aC(n)?n.byteOffset:0,l=(a+n.byteLength)/i,d=(a+e)/i,u=Math.floor(Math.max(0,Math.min(d,l))),h=Math.floor(Math.min(u+Math.max(t,0),l));return new r(s,u,h-u)}function iC(n){return n instanceof ArrayBuffer?n:n.buffer}function aC(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function oC(n){const e={key:n.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(n.size<2)return;if(n.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=n.data.subarray(1).indexOf(0);if(r===-1)return;const s=pr(cf(n.data,1,r)),i=n.data[2+r],a=n.data.subarray(3+r).indexOf(0);if(a===-1)return;const l=pr(cf(n.data,3+r,a));let d;return s==="-->"?d=pr(cf(n.data,4+r+a)):d=nC(n.data.subarray(4+r+a)),e.mimeType=s,e.pictureType=i,e.description=l,e.data=d,e}function lC(n){if(n.size<2)return;const e=pr(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}}function cC(n){if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=pr(n.data.subarray(t),!0);t+=r.length+1;const s=pr(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=pr(n.data.subarray(1));return{key:n.type,info:"",data:e}}function uC(n){if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=pr(n.data.subarray(t),!0);t+=r.length+1;const s=pr(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=pr(n.data);return{key:n.type,info:"",data:e}}function dC(n){return n.type==="PRIV"?lC(n):n.type[0]==="W"?uC(n):n.type==="APIC"?oC(n):cC(n)}function fC(n){const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=Gc(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}}const Ml=10,hC=10;function n1(n){let e=0;const t=[];for(;Hh(n,e);){const r=Gc(n,e+6);n[e+5]>>6&1&&(e+=Ml),e+=Ml;const s=e+r;for(;e+hC<s;){const i=fC(n.subarray(e)),a=dC(i);a&&t.push(a),e+=i.size+Ml}Xy(n,e)&&(e+=Ml)}return t}function s1(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function mC(n){if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function Kh(n){const e=n1(n);for(let t=0;t<e.length;t++){const r=e[t];if(s1(r))return mC(r)}}let mr=(function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n})({});function Jr(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class zh{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=Tr(this.cachedData,e),this.cachedData=null);let r=so(e,0),s=r?r.length:0,i;const a=this._audioTrack,l=this._id3Track,d=r?Kh(r):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&xe(d))&&(this.basePTS=pC(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:mr.audioId3,duration:Number.POSITIVE_INFINITY});s<u;){if(this.canParse(e,s)){const h=this.appendFrame(a,e,s);h?(this.frameIndex++,this.lastPTS=h.sample.pts,s+=h.length,i=s):s=u}else rC(e,s)?(r=so(e,s),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:mr.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,i=s):s++;if(s===u&&i!==u){const h=e.slice(i);this.cachedData?this.cachedData=Tr(this.cachedData,h):this.cachedData=h}}return{audioTrack:a,videoTrack:Jr(),id3Track:l,textTrack:Jr()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Jr(),id3Track:this._id3Track,textTrack:Jr()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const pC=(n,e,t)=>{if(xe(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let Fl=null;const gC=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],xC=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],vC=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],yC=[0,1,1,4];function i1(n,e,t,r,s){if(t+24>e.length)return;const i=a1(e,t);if(i&&t+i.frameLength<=e.length){const a=i.samplesPerFrame*9e4/i.sampleRate,l=r+s*a,d={unit:e.subarray(t,t+i.frameLength),pts:l,dts:l};return n.config=[],n.channelCount=i.channelCount,n.samplerate=i.sampleRate,n.samples.push(d),{sample:d,length:i.frameLength,missing:0}}}function a1(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,s=n[e+2]>>4&15,i=n[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&i!==3){const a=n[e+2]>>1&1,l=n[e+3]>>6,d=t===3?3-r:r===3?3:4,u=gC[d*14+s-1]*1e3,p=xC[(t===3?0:t===2?1:2)*3+i],g=l===3?1:2,x=vC[t][r],y=yC[r],E=x*8*y,w=Math.floor(x*u/p+a)*y;if(Fl===null){const k=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Fl=k?parseInt(k[1]):0}return!!Fl&&Fl<=87&&r===2&&u>=224e3&&l===0&&(n[e+3]=n[e+3]|128),{sampleRate:p,channelCount:g,frameLength:w,samplesPerFrame:E}}}function Wh(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function o1(n,e){return e+1<n.length&&Wh(n,e)}function EC(n,e){return Wh(n,e)&&4<=n.length-e}function l1(n,e){if(e+1<n.length&&Wh(n,e)){const r=a1(n,e);let s=4;r!=null&&r.frameLength&&(s=r.frameLength);const i=e+s;return i===n.length||o1(n,i)}return!1}class wC extends zh{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=so(e,0);let s=r?.length||0;if(l1(e,s))return!1;for(let i=e.length;s<i;s++)if(eC(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return Jk(e,t)}appendFrame(e,t,r){e1(e,this.observer,t,r,e.manifestCodec);const s=r1(e,t,r,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const c1=(n,e)=>{let t=0,r=5;e+=r;const s=new Uint32Array(1),i=new Uint32Array(1),a=new Uint8Array(1);for(;r>0;){a[0]=n[e];const l=Math.min(r,8),d=8-l;i[0]=4278190080>>>24+d<<d,s[0]=(a[0]&i[0])>>d,t=t?t<<l|s[0]:s[0],e+=1,r-=l}return t};class bC extends zh{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const s=u1(e,t,r,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=so(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&Kh(t)!==void 0&&c1(e,r)<16}}function u1(n,e,t,r,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const i=e[t+4]>>6;if(i>=3)return-1;const l=[48e3,44100,32e3][i],d=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+i]*2;if(t+h>e.length)return-1;const p=e[t+6]>>5;let g=0;p===2?g+=2:(p&1&&p!==1&&(g+=2),p&4&&(g+=2));const x=(e[t+6]<<8|e[t+7])>>12-g&1,E=[2,1,2,3,3,4,4,5][p]+x,w=e[t+5]>>3,S=e[t+5]&7,T=new Uint8Array([i<<6|w<<1|S>>2,(S&3)<<6|p<<3|x<<2|d>>4,d<<4&224]),k=1536/l*9e4,I=r+s*k,L=e.subarray(t,t+h);return n.config=T,n.channelCount=E,n.samplerate=l,n.samples.push({unit:L,pts:I}),h}class SC extends zh{resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=so(e,0);let r=t?.length||0;if(t&&e[r]===11&&e[r+1]===119&&Kh(t)!==void 0&&c1(e,r)<=16)return!1;for(let s=e.length;r<s;r++)if(l1(e,r))return Qe.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return EC(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return i1(e,t,r,this.basePTS,this.frameIndex)}}const TC=/\/emsg[-/]ID3/i;class _C{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,s){const i=this.videoTrack=Jr("video",1),a=this.audioTrack=Jr("audio",1),l=this.txtTrack=Jr("text",1);if(this.id3Track=Jr("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=Ey(e);if(d.video){const{id:u,timescale:h,codec:p,supplemental:g}=d.video;i.id=u,i.timescale=l.timescale=h,i.codec=p,i.supplemental=g}if(d.audio){const{id:u,timescale:h,codec:p}=d.audio;a.id=u,a.timescale=h,a.codec=p}l.id=xy.text,i.sampleDuration=0,i.duration=a.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return b_(e)}demux(e,t){this.timeOffset=t;let r=e;const s=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Tr(this.remainderData,e));const l=A_(r);this.remainderData=l.remainder,s.samples=l.valid||new Uint8Array}else s.samples=r;const a=this.extractID3Track(s,t);return i.samples=kg(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return r.samples=kg(e,t),{videoTrack:t,audioTrack:Jr(),id3Track:s,textTrack:Jr()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const s=Me(e.samples,["emsg"]);s&&s.forEach(i=>{const a=R_(i);if(TC.test(a.schemeIdUri)){const l=cx(a,t);let d=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const u=a.payload;r.samples.push({data:u,len:u.byteLength,dts:l,pts:l,type:mr.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const l=cx(a,t);r.samples.push({data:a.payload,len:a.payload.byteLength,dts:l,pts:l,type:mr.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function cx(n,e){return xe(n.presentationTime)?n.presentationTime/n.timeScale:e+n.presentationTimeDelta/n.timeScale}class kC{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Fh(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,hs.cbc)}decryptAacSample(e,t,r){const s=e[t].unit;if(s.length<=16)return;const i=s.subarray(16,s.length-s.length%16),a=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(a).then(l=>{const d=new Uint8Array(l);s.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}).catch(r)}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)r.set(e.subarray(i,i+16),s);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)e.set(r.subarray(s,s+16),i);return e}decryptAvcSample(e,t,r,s,i){const a=Sy(i.data),l=this.getAvcEncryptedData(a);this.decryptBuffer(l.buffer).then(d=>{i.data=this.getAvcDecryptedUnit(a,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,s)}).catch(s)}decryptAvcSamples(e,t,r,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){s();return}const i=e[t].units;for(;!(r>=i.length);r++){const a=i[r];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,r,s,a),!this.decrypter.isSync()))return}}}}class d1{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,s;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const i=r.units;s=i[i.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,s=r.length;if(s){const i=r[s-1];e.pts=i.pts,e.dts=i.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const s=t.byteLength;let i=e.naluState||0;const a=i,l=[];let d=0,u,h,p,g=-1,x=0;for(i===-1&&(g=0,x=this.getNALuType(t,0),i=0,d=1);d<s;){if(u=t[d++],!i){i=u?0:1;continue}if(i===1){i=u?0:2;continue}if(!u)i=3;else if(u===1){if(h=d-i-1,g>=0){const y={data:t.subarray(g,h),type:x};l.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(a&&d<=4-a&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-a)),h>0&&(y.data=Tr(y.data,t.subarray(0,h)),y.state=0))}d<s?(p=this.getNALuType(t,d),g=d,x=p,i=0):i=-1}else i=0}if(g>=0&&i>=0){const y={data:t.subarray(g,s),type:x,state:i};l.push(y)}if(l.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=Tr(y.data,t))}return e.naluState=i,l}}class Ka{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,s=new Uint8Array(4),i=Math.min(4,t);if(i===0)throw new Error("no bytes available");s.set(e.subarray(r,r+i)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&Qe.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class CC extends d1{parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let a=this.VideoSample,l,d=!1;r.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(u=>{var h,p;switch(u.type){case 1:{let E=!1;l=!0;const w=u.data;if(d&&w.length>4){const S=this.readSliceType(w);(S===2||S===4||S===7||S===9)&&(E=!0)}if(E){var g;(g=a)!=null&&g.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.frame=!0,a.key=E;break}case 5:l=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 6:{l=!0,Ph(u.data,1,r.pts,t.samples);break}case 7:{var x,y;l=!0,d=!0;const E=u.data,w=this.readSPS(E);if(!e.sps||e.width!==w.width||e.height!==w.height||((x=e.pixelRatio)==null?void 0:x[0])!==w.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==w.pixelRatio[1]){e.width=w.width,e.height=w.height,e.pixelRatio=w.pixelRatio,e.sps=[E];const S=E.subarray(1,4);let T="avc1.";for(let k=0;k<3;k++){let I=S[k].toString(16);I.length<2&&(I="0"+I),T+=I}e.codec=T}break}case 8:l=!0,e.pps=[u.data];break;case 9:l=!0,e.audFound=!0,(p=a)!=null&&p.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:l=!0;break;default:l=!1;break}a&&l&&a.units.push(u)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Ka(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,s=8,i;for(let a=0;a<e;a++)s!==0&&(i=t.readEG(),s=(r+i+256)%256),r=s===0?r:s}readSPS(e){const t=new Ka(e);let r=0,s=0,i=0,a=0,l,d,u;const h=t.readUByte.bind(t),p=t.readBits.bind(t),g=t.readUEG.bind(t),x=t.readBoolean.bind(t),y=t.skipBits.bind(t),E=t.skipEG.bind(t),w=t.skipUEG.bind(t),S=this.skipScalingList.bind(this);h();const T=h();if(p(5),y(3),h(),w(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const j=g();if(j===3&&y(1),w(),w(),y(1),x())for(d=j!==3?8:12,u=0;u<d;u++)x()&&(u<6?S(16,t):S(64,t))}w();const k=g();if(k===0)g();else if(k===1)for(y(1),E(),E(),l=g(),u=0;u<l;u++)E();w(),y(1);const I=g(),L=g(),O=p(1);O===0&&y(1),y(1),x()&&(r=g(),s=g(),i=g(),a=g());let P=[1,1];if(x()&&x())switch(h()){case 1:P=[1,1];break;case 2:P=[12,11];break;case 3:P=[10,11];break;case 4:P=[16,11];break;case 5:P=[40,33];break;case 6:P=[24,11];break;case 7:P=[20,11];break;case 8:P=[32,11];break;case 9:P=[80,33];break;case 10:P=[18,11];break;case 11:P=[15,11];break;case 12:P=[64,33];break;case 13:P=[160,99];break;case 14:P=[4,3];break;case 15:P=[3,2];break;case 16:P=[2,1];break;case 255:{P=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((I+1)*16-r*2-s*2),height:(2-O)*(L+1)*16-(O?2:4)*(i+a),pixelRatio:P}}}class IC extends d1{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let a=this.VideoSample,l,d=!1;r.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(u=>{var h,p;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.frame=!0,l=!0;break;case 16:case 17:case 18:case 21:if(l=!0,d){var g;(g=a)!=null&&g.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:l=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 39:l=!0,Ph(u.data,2,r.pts,t.samples);break;case 32:l=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Ze(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(l=!0,d=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const x=this.readSPS(u.data);e.width=x.width,e.height=x.height,e.pixelRatio=x.pixelRatio,e.codec=x.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const y in x.params)e.params[y]=x.params[y]}this.pushParameterSet(e.sps,u.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0;break;case 34:if(l=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const x=this.readPPS(u.data);for(const y in x)e.params[y]=x[y]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:l=!0,e.audFound=!0,(p=a)!=null&&p.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:l=!1;break}a&&l&&a.units.push(u)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[r]=e[s],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Ka(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:s}}readSPS(e){const t=new Ka(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const s=t.readBits(2),i=t.readBoolean(),a=t.readBits(5),l=t.readUByte(),d=t.readUByte(),u=t.readUByte(),h=t.readUByte(),p=t.readUByte(),g=t.readUByte(),x=t.readUByte(),y=t.readUByte(),E=t.readUByte(),w=t.readUByte(),S=t.readUByte(),T=[],k=[];for(let we=0;we<r;we++)T.push(t.readBoolean()),k.push(t.readBoolean());if(r>0)for(let we=r;we<8;we++)t.readBits(2);for(let we=0;we<r;we++)T[we]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),k[we]&&t.readUByte();t.readUEG();const I=t.readUEG();I==3&&t.skipBits(1);const L=t.readUEG(),O=t.readUEG(),P=t.readBoolean();let j=0,F=0,D=0,$=0;P&&(j+=t.readUEG(),F+=t.readUEG(),D+=t.readUEG(),$+=t.readUEG());const J=t.readUEG(),ne=t.readUEG(),se=t.readUEG(),X=t.readBoolean();for(let we=X?0:r;we<=r;we++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Fe=0;Fe<4;Fe++)for(let He=0;He<(Fe===3?2:6);He++)if(!t.readBoolean())t.readUEG();else{const Ve=Math.min(64,1<<4+(Fe<<1));Fe>1&&t.readEG();for(let Xe=0;Xe<Ve;Xe++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const G=t.readUEG();let Q=0;for(let we=0;we<G;we++){let Fe=!1;if(we!==0&&(Fe=t.readBoolean()),Fe){we===G&&t.readUEG(),t.readBoolean(),t.readUEG();let He=0;for(let Ke=0;Ke<=Q;Ke++){const Ve=t.readBoolean();let Xe=!1;Ve||(Xe=t.readBoolean()),(Ve||Xe)&&He++}Q=He}else{const He=t.readUEG(),Ke=t.readUEG();Q=He+Ke;for(let Ve=0;Ve<He;Ve++)t.readUEG(),t.readBoolean();for(let Ve=0;Ve<Ke;Ve++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const we=t.readUEG();for(let Fe=0;Fe<we;Fe++){for(let He=0;He<se+4;He++)t.readBits(1);t.readBits(1)}}let N=0,U=1,re=1,de=!0,ue=1,he=0;t.readBoolean(),t.readBoolean();let pe=!1;if(t.readBoolean()){if(t.readBoolean()){const bt=t.readUByte(),On=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],dn=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];bt>0&&bt<16?(U=On[bt-1],re=dn[bt-1]):bt===255&&(U=t.readBits(16),re=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),pe=t.readBoolean(),pe&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ue=t.readBits(32),he=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const dn=t.readBoolean(),Zi=t.readBoolean();let jn=!1;(dn||Zi)&&(jn=t.readBoolean(),jn&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),jn&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Ys=0;Ys<=r;Ys++){de=t.readBoolean();const Qs=de||t.readBoolean();let Ji=!1;Qs?t.readEG():Ji=t.readBoolean();const Mn=Ji?1:t.readUEG()+1;if(dn)for(let Ar=0;Ar<Mn;Ar++)t.readUEG(),t.readUEG(),jn&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Zi)for(let Ar=0;Ar<Mn;Ar++)t.readUEG(),t.readUEG(),jn&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),N=t.readUEG())}let Ne=L,Ge=O;if(P){let we=1,Fe=1;I===1?we=Fe=2:I==2&&(we=2),Ne=L-we*F-we*j,Ge=O-Fe*$-Fe*D}const Vt=s?["A","B","C"][s]:"",ke=l<<24|d<<16|u<<8|h;let je=0;for(let we=0;we<32;we++)je=(je|(ke>>we&1)<<31-we)>>>0;let le=je.toString(16);return a===1&&le==="2"&&(le="6"),{codecString:`hvc1.${Vt}${a}.${le}.${i?"H":"L"}${S}.B0`,params:{general_tier_flag:i,general_profile_idc:a,general_profile_space:s,general_profile_compatibility_flags:[l,d,u,h],general_constraint_indicator_flags:[p,g,x,y,E,w],general_level_idc:S,bit_depth:J+8,bit_depth_luma_minus8:J,bit_depth_chroma_minus8:ne,min_spatial_segmentation_idc:N,chroma_format_idc:I,frame_rate:{fixed:de,fps:he/ue}},width:Ne,height:Ge,pixelRatio:[U,re]}}readPPS(e){const t=new Ka(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),i=t.readBoolean();let a=1;return i&&s?a=0:i?a=3:s&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Pt=188;class os{constructor(e,t,r,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=s,this.videoParser=null}static probe(e,t){const r=os.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Pt*5,t-Pt)+1,s=0;for(;s<r;){let i=!1,a=-1,l=0;for(let d=s;d<t;d+=Pt)if(e[d]===71&&(t-d===Pt||e[d+Pt]===71)){if(l++,a===-1&&(a=d,a!==0&&(r=Math.min(a+Pt*99,e.length-Pt)+1)),i||(i=ih(e,d)===0),i&&l>1&&(a===0&&l>2||d+Pt>r))return a}else{if(l)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:xy[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=os.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=os.createTrack("audio",s),this._id3Track=os.createTrack("id3"),this._txtTrack=os.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,s=!1){r||(this.sampleAes=null);let i;const a=this._videoTrack,l=this._audioTrack,d=this._id3Track,u=this._txtTrack;let h=a.pid,p=a.pesData,g=l.pid,x=d.pid,y=l.pesData,E=d.pesData,w=null,S=this.pmtParsed,T=this._pmtId,k=e.length;if(this.remainderData&&(e=Tr(this.remainderData,e),k=e.length,this.remainderData=null),k<Pt&&!s)return this.remainderData=e,{audioTrack:l,videoTrack:a,id3Track:d,textTrack:u};const I=Math.max(0,os.syncOffset(e));k-=(k-I)%Pt,k<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,k,e.buffer.byteLength-k));let L=0;for(let P=I;P<k;P+=Pt)if(e[P]===71){const j=!!(e[P+1]&64),F=ih(e,P),D=(e[P+3]&48)>>4;let $;if(D>1){if($=P+5+e[P+4],$===P+Pt)continue}else $=P+4;switch(F){case h:j&&(p&&(i=Ti(p,this.logger))&&(this.readyVideoParser(a.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(a,u,i,!1)),p={data:[],size:0}),p&&(p.data.push(e.subarray($,P+Pt)),p.size+=P+Pt-$);break;case g:if(j){if(y&&(i=Ti(y,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,i);break;case"mp3":this.parseMPEGPES(l,i);break;case"ac3":this.parseAC3PES(l,i);break}y={data:[],size:0}}y&&(y.data.push(e.subarray($,P+Pt)),y.size+=P+Pt-$);break;case x:j&&(E&&(i=Ti(E,this.logger))&&this.parseID3PES(d,i),E={data:[],size:0}),E&&(E.data.push(e.subarray($,P+Pt)),E.size+=P+Pt-$);break;case 0:j&&($+=e[$]+1),T=this._pmtId=AC(e,$);break;case T:{j&&($+=e[$]+1);const J=LC(e,$,this.typeSupported,r,this.observer,this.logger);h=J.videoPid,h>0&&(a.pid=h,a.segmentCodec=J.segmentVideoCodec),g=J.audioPid,g>0&&(l.pid=g,l.segmentCodec=J.segmentAudioCodec),x=J.id3Pid,x>0&&(d.pid=x),w!==null&&!S&&(this.logger.warn(`MPEG-TS PMT found at ${P} after unknown PID '${w}'. Backtracking to sync byte @${I} to parse all TS packets.`),w=null,P=I-188),S=this.pmtParsed=!0;break}case 17:case 8191:break;default:w=F;break}}else L++;L>0&&ah(this.observer,new Error(`Found ${L} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=p,l.pesData=y,d.pesData=E;const O={audioTrack:l,videoTrack:a,id3Track:d,textTrack:u};return s&&this.extractRemainingSamples(O),O}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:s,textTrack:i}=e,a=r.pesData,l=t.pesData,d=s.pesData;let u;if(a&&(u=Ti(a,this.logger))?(this.readyVideoParser(r.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(r,i,u,!0),r.pesData=null)):r.pesData=a,l&&(u=Ti(l,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else l!=null&&l.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=l;d&&(u=Ti(d,this.logger))?(this.parseID3PES(s,u),s.pesData=null):s.pesData=d}demuxSampleAes(e,t,r){const s=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new kC(this.observer,this.config,t);return this.decrypt(s,i)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new CC:e==="hevc"&&(this.videoParser=new IC))}decrypt(e,t){return new Promise(r=>{const{audioTrack:s,videoTrack:i}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{r(e)}):r(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const s=this.aacOverFlow;let i=t.data;if(s){this.aacOverFlow=null;const p=s.missing,g=s.sample.unit.byteLength;if(p===-1)i=Tr(s.sample.unit,i);else{const x=g-p;s.sample.unit.set(i.subarray(0,p),x),e.samples.push(s.sample),r=s.missing}}let a,l;for(a=r,l=i.length;a<l-1&&!bc(i,a);a++);if(a!==r){let p;const g=a<l-1;if(g?p=`AAC PES did not start with ADTS header,offset:${a}`:p="No ADTS header found in AAC PES",ah(this.observer,new Error(p),g,this.logger),!g)return}e1(e,this.observer,i,a,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(s){const p=t1(e.samplerate);d=s.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,h;for(;a<l;)if(h=r1(e,i,a,d,u),a+=h.length,h.missing){this.aacOverFlow=h;break}else for(u++;a<l-1&&!bc(i,a);a++);}parseMPEGPES(e,t){const r=t.data,s=r.length;let i=0,a=0;const l=t.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<s;)if(o1(r,a)){const d=i1(e,r,a,l,i);if(d)a+=d.length,i++;else break}else a++}parseAC3PES(e,t){{const r=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const i=r.length;let a=0,l=0,d;for(;l<i&&(d=u1(e,r,l,s,a++))>0;)l+=d}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Ze({},t,{type:this._videoTrack?mr.emsg:mr.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function ih(n,e){return((n[e+1]&31)<<8)+n[e+2]}function AC(n,e){return(n[e+10]&31)<<8|n[e+11]}function LC(n,e,t,r,s,i){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(n[e+1]&15)<<8|n[e+2],d=e+3+l-4,u=(n[e+10]&15)<<8|n[e+11];for(e+=12+u;e<d;){const h=ih(n,e),p=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!r){uf("ADTS AAC",i);break}case 15:a.audioPid===-1&&(a.audioPid=h);break;case 21:a.id3Pid===-1&&(a.id3Pid=h);break;case 219:if(!r){uf("H.264",i);break}case 27:a.videoPid===-1&&(a.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?i.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="mp3");break;case 193:if(!r){uf("AC-3",i);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&p>0){let g=e+5,x=p;for(;x>2;){switch(n[g]){case 106:t.ac3!==!0?i.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=h,a.segmentAudioCodec="ac3");break}const E=n[g+1]+2;g+=E,x-=E}}break;case 194:case 135:return ah(s,new Error("Unsupported EC-3 in M2TS found"),void 0,i),a;case 36:a.videoPid===-1&&(a.videoPid=h,a.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"));break}e+=p+5}return a}function ah(n,e,t,r){r.warn(`parsing error: ${e.message}`),n.emit(C.ERROR,C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function uf(n,e){e.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function Ti(n,e){let t=0,r,s,i,a,l;const d=n.data;if(!n||n.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Tr(d[0],d[1]),d.splice(1,1);if(r=d[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(s=(r[4]<<8)+r[5],s&&s>n.size-6)return null;const h=r[7];h&192&&(a=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,h&64?(l=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,a-l>60*9e4&&(e.warn(`${Math.round((a-l)/9e4)}s delta between PTS and DTS, align them`),a=l)):l=a),i=r[8];let p=i+9;if(n.size<=p)return null;n.size-=p;const g=new Uint8Array(n.size);for(let x=0,y=d.length;x<y;x++){r=d[x];let E=r.byteLength;if(p)if(p>E){p-=E;continue}else r=r.subarray(p),E-=p,p=0;g.set(r,t),t+=E}return s&&(s-=i+3),{data:g,pts:a,dts:l,len:s}}return null}class RC{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ns=Math.pow(2,32)-1;class H{static init(){H.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in H.types)H.types.hasOwnProperty(e)&&(H.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);H.HDLR_TYPES={video:t,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);H.STTS=H.STSC=H.STCO=i,H.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),H.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),H.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),H.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);H.FTYP=H.box(H.types.ftyp,a,d,a,l),H.DINF=H.box(H.types.dinf,H.box(H.types.dref,s))}static box(e,...t){let r=8,s=t.length;const i=s;for(;s--;)r+=t[s].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(e,4),s=0,r=8;s<i;s++)a.set(t[s],r),r+=t[s].byteLength;return a}static hdlr(e){return H.box(H.types.hdlr,H.HDLR_TYPES[e])}static mdat(e){return H.box(H.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(ns+1)),s=Math.floor(t%(ns+1));return H.box(H.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return H.box(H.types.mdia,H.mdhd(e.timescale||0,e.duration||0),H.hdlr(e.type),H.minf(e))}static mfhd(e){return H.box(H.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?H.box(H.types.minf,H.box(H.types.smhd,H.SMHD),H.DINF,H.stbl(e)):H.box(H.types.minf,H.box(H.types.vmhd,H.VMHD),H.DINF,H.stbl(e))}static moof(e,t,r){return H.box(H.types.moof,H.mfhd(e),H.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=H.trak(e[t]);return H.box.apply(null,[H.types.moov,H.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(H.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=H.trex(e[t]);return H.box.apply(null,[H.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(ns+1)),s=Math.floor(t%(ns+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return H.box(H.types.mvhd,i)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let s,i;for(s=0;s<t.length;s++)i=t[s].flags,r[s+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return H.box(H.types.sdtp,r)}static stbl(e){return H.box(H.types.stbl,H.stsd(e),H.box(H.types.stts,H.STTS),H.box(H.types.stsc,H.STSC),H.box(H.types.stsz,H.STSZ),H.box(H.types.stco,H.STCO))}static avc1(e){let t=[],r=[],s,i,a;for(s=0;s<e.sps.length;s++)i=e.sps[s],a=i.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(i));for(s=0;s<e.pps.length;s++)i=e.pps[s],a=i.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(i));const l=H.box(H.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),d=e.width,u=e.height,h=e.pixelRatio[0],p=e.pixelRatio[1];return H.box(H.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,H.box(H.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),H.box(H.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return H.box(H.types.mp4a,H.audioStsd(e),H.box(H.types.esds,H.esds(e)))}static mp3(e){return H.box(H.types[".mp3"],H.audioStsd(e))}static ac3(e){return H.box(H.types["ac-3"],H.audioStsd(e),H.box(H.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return H.box(H.types.stsd,H.STSD,H.mp4a(e));if(t==="ac3"&&e.config)return H.box(H.types.stsd,H.STSD,H.ac3(e));if(t==="mp3"&&e.codec==="mp3")return H.box(H.types.stsd,H.STSD,H.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return H.box(H.types.stsd,H.STSD,H.avc1(e));if(t==="hevc"&&e.vps)return H.box(H.types.stsd,H.STSD,H.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),s=e.width||0,i=e.height||0,a=Math.floor(r/(ns+1)),l=Math.floor(r%(ns+1));return H.box(H.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,i>>8&255,i&255,0,0]))}static traf(e,t){const r=H.sdtp(e),s=e.id,i=Math.floor(t/(ns+1)),a=Math.floor(t%(ns+1));return H.box(H.types.traf,H.box(H.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),H.box(H.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,a>>24,a>>16&255,a>>8&255,a&255])),H.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,H.box(H.types.trak,H.tkhd(e),H.mdia(e))}static trex(e){const t=e.id;return H.box(H.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],s=r.length,i=12+16*s,a=new Uint8Array(i);let l,d,u,h,p,g;for(t+=8+i,a.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),l=0;l<s;l++)d=r[l],u=d.duration,h=d.size,p=d.flags,g=d.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,g>>>24&255,g>>>16&255,g>>>8&255,g&255],12+16*l);return H.box(H.types.trun,a)}static initSegment(e){H.types||H.init();const t=H.moov(e);return Tr(H.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],s=4,i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let a=i.length;for(let y=0;y<r.length;y+=1){a+=3;for(let E=0;E<r[y].length;E+=1)a+=2+r[y][E].length}const l=new Uint8Array(a);l.set(i,0),a=i.length;const d=r.length-1;for(let y=0;y<r.length;y+=1){l.set(new Uint8Array([32+y|(y===d?128:0),0,r[y].length]),a),a+=3;for(let E=0;E<r[y].length;E+=1)l.set(new Uint8Array([r[y][E].length>>8,r[y][E].length&255]),a),a+=2,l.set(r[y][E],a),a+=r[y][E].length}const u=H.box(H.types.hvcC,l),h=e.width,p=e.height,g=e.pixelRatio[0],x=e.pixelRatio[1];return H.box(H.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,H.box(H.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),H.box(H.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,x>>24,x>>16&255,x>>8&255,x&255])))}}H.types=void 0;H.HDLR_TYPES=void 0;H.STTS=void 0;H.STSC=void 0;H.STCO=void 0;H.STSZ=void 0;H.VMHD=void 0;H.SMHD=void 0;H.STSD=void 0;H.FTYP=void 0;H.DINF=void 0;const f1=9e4;function Yh(n,e,t=1,r=!1){const s=n*e*t;return r?Math.round(s):s}function NC(n,e,t=1,r=!1){return Yh(n,e,1/t,r)}function Fa(n,e=!1){return Yh(n,1e3,1/f1,e)}function DC(n,e=1){return Yh(n,f1,1/e)}function ux(n){const{baseTime:e,timescale:t,trackId:r}=n;return`${e/t} (${e}/${t}) trackId: ${r}`}const PC=10*1e3,OC=1024,jC=1152,MC=1536;let _i=null,df=null;function dx(n,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class ic extends kr{constructor(e,t,r,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,_i===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);_i=a?parseInt(a[1]):0}if(df===null){const i=navigator.userAgent.match(/Safari\/(\d+)/i);df=i?parseInt(i[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&ux(t)} > ${e&&ux(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,s=e.reduce((i,a)=>{let l=a.pts,d=l-i;return d<-4294967296&&(t=!0,l=hr(l,r),d=l-i),d>0?i:l},r);return t&&this.debug("PTS rollover detected"),s}remux(e,t,r,s,i,a,l,d){let u,h,p,g,x,y,E=i,w=i;const S=e.pid>-1,T=t.pid>-1,k=t.samples.length,I=e.samples.length>0,L=l&&k>0||k>1;if((!S||I)&&(!T||L)||this.ISGenerated||l){if(this.ISGenerated){var P,j,F,D;const se=this.videoTrackConfig;(se&&(t.width!==se.width||t.height!==se.height||((P=t.pixelRatio)==null?void 0:P[0])!==((j=se.pixelRatio)==null?void 0:j[0])||((F=t.pixelRatio)==null?void 0:F[1])!==((D=se.pixelRatio)==null?void 0:D[1]))||!se&&L||this.nextAudioTs===null&&I)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(e,t,i,a));const $=this.isVideoContiguous;let J=-1,ne;if(L&&(J=FC(t.samples),!$&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,J>0){this.warn(`Dropped ${J} out of ${k} video samples due to a missing keyframe`);const se=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(J),t.dropped+=J,w+=(t.samples[0].pts-se)/t.inputTimeScale,ne=w}else J===-1&&(this.warn(`No keyframe found out of ${k} video samples`),y=!1);if(this.ISGenerated){if(I&&L){const se=this.getVideoStartPts(t.samples),Z=(hr(e.samples[0].pts,se)-se)/t.inputTimeScale;E+=Math.max(0,Z),w+=Math.max(0,-Z)}if(I){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(e,t,i,a)),h=this.remuxAudio(e,E,this.isAudioContiguous,a,T||L||d===ye.AUDIO?w:void 0),L){const se=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(e,t,i,a)),u=this.remuxVideo(t,w,$,se)}}else L&&(u=this.remuxVideo(t,w,$,0));u&&(u.firstKeyFrame=J,u.independent=J!==-1,u.firstKeyFramePTS=ne)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(x=h1(r,i,this._initPTS,this._initDTS)),s.samples.length&&(g=m1(s,i,this._initPTS))),{audio:h,video:u,initSegment:p,independent:y,text:g,id3:x}}computeInitPts(e,t,r,s){const i=Math.round(r*t);let a=hr(e,i);if(a<i+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(i-a)/t} ${s}`);a<i+t;)a+=8589934592;return a-i}generateIS(e,t,r,s){const i=e.samples,a=t.samples,l=this.typeSupported,d={},u=this._initPTS;let h=!u||s,p="audio/mp4",g,x,y,E=-1;if(h&&(g=x=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(p="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):H.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(E=e.id,y=e.inputTimeScale,!u||y!==u.timescale?g=x=this.computeInitPts(i[0].pts,y,r,"audio"):h=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:H.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(E=t.id,y=t.inputTimeScale,!u||y!==u.timescale){const w=this.getVideoStartPts(a),S=hr(a[0].dts,w),T=this.computeInitPts(S,y,r,"video"),k=this.computeInitPts(w,y,r,"video");x=Math.min(x,T),g=Math.min(g,k)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,h?(u&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${r} ${g/y} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${g/y} (${g}/${y}) trackId: ${E}`),this._initPTS={baseTime:g,timescale:y,trackId:E},this._initDTS={baseTime:x,timescale:y,trackId:E}):g=y=void 0,{tracks:d,initPTS:g,timescale:y,trackId:E}}remuxVideo(e,t,r,s){const i=e.inputTimeScale,a=e.samples,l=[],d=a.length,u=this._initPTS,h=u.baseTime*i/u.timescale;let p=this.nextVideoTs,g=8,x=this.videoSampleDuration,y,E,w=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,T=!1;if(!r||p===null){const N=h+t*i,U=a[0].pts-hr(a[0].dts,a[0].pts);_i&&p!==null&&Math.abs(N-U-(p+h))<15e3?r=!0:p=N-U-h}const k=p+h;for(let N=0;N<d;N++){const U=a[N];U.pts=hr(U.pts,k),U.dts=hr(U.dts,k),U.dts<a[N>0?N-1:N].dts&&(T=!0)}T&&a.sort(function(N,U){const re=N.dts-U.dts,de=N.pts-U.pts;return re||de}),y=a[0].dts,E=a[a.length-1].dts;const I=E-y,L=I?Math.round(I/(d-1)):x||e.inputTimeScale/30;if(r){const N=y-k,U=N>L,re=N<-1;if((U||re)&&(U?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Fa(N,!0)} ms (${N}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Fa(-N,!0)} ms (${N}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!re||k>=a[0].pts||_i)){y=k;const de=a[0].pts-N;if(U)a[0].dts=y,a[0].pts=de;else{let ue=!0;for(let he=0;he<a.length&&!(a[he].dts>de&&ue);he++){const pe=a[he].pts;if(a[he].dts-=N,a[he].pts-=N,he<a.length-1){const ge=a[he+1].pts,Ne=a[he].pts,Ge=ge<=Ne,Vt=ge<=pe;ue=Ge==Vt}}}this.log(`Video: Initial PTS/DTS adjusted: ${Fa(de,!0)}/${Fa(y,!0)}, delta: ${Fa(N,!0)} ms`)}}y=Math.max(0,y);let O=0,P=0,j=y;for(let N=0;N<d;N++){const U=a[N],re=U.units,de=re.length;let ue=0;for(let he=0;he<de;he++)ue+=re[he].data.length;P+=ue,O+=de,U.length=ue,U.dts<j?(U.dts=j,j+=L/4|0||1):j=U.dts,w=Math.min(U.pts,w),S=Math.max(U.pts,S)}E=a[d-1].dts;const F=P+4*O+8;let D;try{D=new Uint8Array(F)}catch(N){this.observer.emit(C.ERROR,C.ERROR,{type:Te.MUX_ERROR,details:q.REMUX_ALLOC_ERROR,fatal:!1,error:N,bytes:F,reason:`fail allocating video mdat ${F}`});return}const $=new DataView(D.buffer);$.setUint32(0,F),D.set(H.types.mdat,4);let J=!1,ne=Number.POSITIVE_INFINITY,se=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,Z=Number.NEGATIVE_INFINITY;for(let N=0;N<d;N++){const U=a[N],re=U.units;let de=0;for(let pe=0,ge=re.length;pe<ge;pe++){const Ne=re[pe],Ge=Ne.data,Vt=Ne.data.byteLength;$.setUint32(g,Vt),g+=4,D.set(Ge,g),g+=Vt,de+=4+Vt}let ue;if(N<d-1)x=a[N+1].dts-U.dts,ue=a[N+1].pts-U.pts;else{const pe=this.config,ge=N>0?U.dts-a[N-1].dts:L;if(ue=N>0?U.pts-a[N-1].pts:L,pe.stretchShortVideoTrack&&this.nextAudioTs!==null){const Ne=Math.floor(pe.maxBufferHole*i),Ge=(s?w+s*i:this.nextAudioTs+h)-U.pts;Ge>Ne?(x=Ge-ge,x<0?x=ge:J=!0,this.log(`It is approximately ${Ge/90} ms to the next segment; using duration ${x/90} ms for the last video frame.`)):x=ge}else x=ge}const he=Math.round(U.pts-U.dts);ne=Math.min(ne,x),X=Math.max(X,x),se=Math.min(se,ue),Z=Math.max(Z,ue),l.push(dx(U.key,x,de,he))}if(l.length){if(_i){if(_i<70){const N=l[0].flags;N.dependsOn=2,N.isNonSync=0}}else if(df&&Z-se<X-ne&&L/X<.025&&l[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let N=y;for(let U=0,re=l.length;U<re;U++){const de=N+l[U].duration,ue=N+l[U].cts;if(U<re-1){const he=de+l[U+1].cts;l[U].duration=he-ue}else l[U].duration=U?l[U-1].duration:L;l[U].cts=0,N=de}}}x=J||!x?L:x;const ie=E+x;this.nextVideoTs=p=ie-h,this.videoSampleDuration=x,this.isVideoContiguous=!0;const W={data1:H.moof(e.sequenceNumber++,y,Ze(e,{samples:l})),data2:D,startPTS:(w-h)/i,endPTS:(S+x-h)/i,startDTS:(y-h)/i,endDTS:p/i,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,W}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return jC;case"ac3":return MC;default:return OC}}remuxAudio(e,t,r,s,i){const a=e.inputTimeScale,l=e.samplerate?e.samplerate:a,d=a/l,u=this.getSamplesPerFrame(e),h=u*d,p=this._initPTS,g=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,x=[],y=i!==void 0;let E=e.samples,w=g?0:8,S=this.nextAudioTs||-1;const T=p.baseTime*a/p.timescale,k=T+t*a;if(this.isAudioContiguous=r=r||E.length&&S>0&&(s&&Math.abs(k-(S+T))<9e3||Math.abs(hr(E[0].pts,k)-(S+T))<20*h),E.forEach(function(Z){Z.pts=hr(Z.pts,k)}),!r||S<0){const Z=E.length;if(E=E.filter(ie=>ie.pts>=0),Z!==E.length&&this.warn(`Removed ${E.length-Z} of ${Z} samples (initPTS ${T} / ${a})`),!E.length)return;i===0?S=0:s&&!y?S=Math.max(0,k-T):S=E[0].pts-T}if(e.segmentCodec==="aac"){const Z=this.config.maxAudioFramesDrift;for(let ie=0,G=S+T;ie<E.length;ie++){const Q=E[ie],W=Q.pts,N=W-G,U=Math.abs(1e3*N/a);if(N<=-Z*h&&y)ie===0&&(this.warn(`Audio frame @ ${(W/a).toFixed(3)}s overlaps marker by ${Math.round(1e3*N/a)} ms.`),this.nextAudioTs=S=W-T,G=W);else if(N>=Z*h&&U<PC&&y){let re=Math.round(N/h);for(G=W-re*h;G<0&&re&&h;)re--,G+=h;ie===0&&(this.nextAudioTs=S=G-T),this.warn(`Injecting ${re} audio frames @ ${((G-T)/a).toFixed(3)}s due to ${Math.round(1e3*N/a)} ms gap.`);for(let de=0;de<re;de++){let ue=RC.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);ue||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ue=Q.unit.subarray()),E.splice(ie,0,{unit:ue,pts:G}),G+=h,ie++}}Q.pts=G,G+=h}}let I=null,L=null,O,P=0,j=E.length;for(;j--;)P+=E[j].unit.byteLength;for(let Z=0,ie=E.length;Z<ie;Z++){const G=E[Z],Q=G.unit;let W=G.pts;if(L!==null){const U=x[Z-1];U.duration=Math.round((W-L)/d)}else if(r&&e.segmentCodec==="aac"&&(W=S+T),I=W,P>0){P+=w;try{O=new Uint8Array(P)}catch(U){this.observer.emit(C.ERROR,C.ERROR,{type:Te.MUX_ERROR,details:q.REMUX_ALLOC_ERROR,fatal:!1,error:U,bytes:P,reason:`fail allocating audio mdat ${P}`});return}g||(new DataView(O.buffer).setUint32(0,P),O.set(H.types.mdat,4))}else return;O.set(Q,w);const N=Q.byteLength;w+=N,x.push(dx(!0,u,N,0)),L=W}const F=x.length;if(!F)return;const D=x[x.length-1];S=L-T,this.nextAudioTs=S+d*D.duration;const $=g?new Uint8Array(0):H.moof(e.sequenceNumber++,I/d,Ze({},e,{samples:x}));e.samples=[];const J=(I-T)/a,ne=this.nextAudioTs/a,X={data1:$,data2:O,startPTS:J,endPTS:ne,startDTS:J,endDTS:ne,type:"audio",hasAudio:!0,hasVideo:!1,nb:F};return this.isAudioContiguous=!0,X}}function hr(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function FC(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function h1(n,e,t,r){const s=n.samples.length;if(!s)return;const i=n.inputTimeScale;for(let l=0;l<s;l++){const d=n.samples[l];d.pts=hr(d.pts-t.baseTime*i/t.timescale,e*i)/i,d.dts=hr(d.dts-r.baseTime*i/r.timescale,e*i)/i}const a=n.samples;return n.samples=[],{samples:a}}function m1(n,e,t){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let a=0;a<r;a++){const l=n.samples[a];l.pts=hr(l.pts-t.baseTime*s/t.timescale,e*s)/s}n.samples.sort((a,l)=>a.pts-l.pts);const i=n.samples;return n.samples=[],{samples:i}}class UC extends kr{constructor(e,t,r,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,s){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,s),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:r,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:i,video:a}=this.initData=Ey(e);if(t)k_(e,t);else{const d=i||a;d!=null&&d.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${d.codec}")!`)}i&&(r=fx(i,et.AUDIO,this)),a&&(s=fx(a,et.VIDEO,this));const l={};i&&a?l.audiovideo={container:"video/mp4",codec:r+","+s,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:i?l.audio={container:"audio/mp4",codec:r,encrypted:i.encrypted,initSegment:e,id:"audio"}:a?l.video={container:"video/mp4",codec:s,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,t,r,s,i,a){var l,d;let{initPTS:u,lastEndTime:h}=this;const p={audio:void 0,video:void 0,text:s,id3:r,initSegment:void 0};xe(h)||(h=this.lastEndTime=i||0);const g=t.samples;if(!g.length)return p;const x={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((l=y)!=null&&l.length||(this.generateInitSegment(g),y=this.initData),!((d=y)!=null&&d.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const E=I_(g,y,this),w=y.audio?E[y.audio.id]:null,S=y.video?E[y.video.id]:null,T=Ul(S,1/0),k=Ul(w,1/0),I=Ul(S,0,!0),L=Ul(w,0,!0);let O=i,P=0;const j=w&&(!S||!u&&k<T||u&&u.trackId===y.audio.id),F=j?w:S;if(F){const G=F.timescale,Q=F.start-i*G,W=j?y.audio.id:y.video.id;O=F.start/G,P=j?L-k:I-T,(a||!u)&&(BC(u,O,i,P)||G!==u.timescale)&&(u&&this.warn(`Timestamps at playlist time: ${a?"":"~"}${i} ${Q/G} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${O-i} (${Q}/${G}) trackId: ${W}`),u=null,x.initPTS=Q,x.timescale=G,x.trackId=W)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${i}`);u?(x.initPTS=u.baseTime,x.timescale=u.timescale,x.trackId=u.trackId):((!x.timescale||x.trackId===void 0||x.initPTS===void 0)&&(this.warn("Could not set initPTS"),x.initPTS=O,x.timescale=1,x.trackId=-1),this.initPTS=u={baseTime:x.initPTS,timescale:x.timescale,trackId:x.trackId});const D=O-u.baseTime/u.timescale,$=D+P;P>0?this.lastEndTime=$:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const J=!!y.audio,ne=!!y.video;let se="";J&&(se+="audio"),ne&&(se+="video");const X=(y.audio?y.audio.encrypted:!1)||(y.video?y.video.encrypted:!1),Z={data1:g,startPTS:D,startDTS:D,endPTS:$,endDTS:$,type:se,hasAudio:J,hasVideo:ne,nb:1,dropped:0,encrypted:X};p.audio=J&&!ne?Z:void 0,p.video=ne?Z:void 0;const ie=S?.sampleCount;if(ie){const G=S.keyFrameIndex,Q=G!==-1;Z.nb=ie,Z.dropped=G===0||this.isVideoContiguous?0:Q?G:ie,Z.independent=Q,Z.firstKeyFrame=G,Q&&S.keyFrameStart&&(Z.firstKeyFramePTS=(S.keyFrameStart-u.baseTime)/u.timescale),this.isVideoContiguous||(p.independent=Q),this.isVideoContiguous||(this.isVideoContiguous=Q),Z.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${G}/${ie} dropped: ${Z.dropped} start: ${Z.firstKeyFramePTS||"NA"}`)}return p.initSegment=x,p.id3=h1(r,i,u,u),s.samples.length&&(p.text=m1(s,i,u)),p}}function Ul(n,e,t=!1){return n?.start!==void 0?(n.start+(t?n.duration:0))/n.timescale:e}function BC(n,e,t,r){if(n===null)return!0;const s=Math.max(r,1),i=e-n.baseTime/n.timescale;return Math.abs(i-t)>s}function fx(n,e,t){const r=n.codec;return r&&r.length>4?r:e===et.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?mc(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let Tn;try{Tn=self.performance.now.bind(self.performance)}catch{Tn=Date.now}const ac=[{demux:_C,remux:UC},{demux:os,remux:ic},{demux:wC,remux:ic},{demux:SC,remux:ic}];ac.splice(2,0,{demux:bC,remux:ic});class hx{constructor(e,t,r,s,i,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=i,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,s){const i=r.transmuxing;i.executeStart=Tn();let a=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:d}=this;s&&(this.currentTransmuxState=s);const{contiguous:u,discontinuity:h,trackSwitch:p,accurateTimeOffset:g,timeOffset:x,initSegmentChange:y}=s||l,{audioCodec:E,videoCodec:w,defaultInitPts:S,duration:T,initSegmentData:k}=d,I=$C(a,t);if(I&&Ni(I.method)){const j=this.getDecrypter(),F=Bh(I.method);if(j.isSync()){let D=j.softwareDecrypt(a,I.key.buffer,I.iv.buffer,F);if(r.part>-1){const J=j.flush();D=J&&J.buffer}if(!D)return i.executeEnd=Tn(),ff(r);a=new Uint8Array(D)}else return this.asyncResult=!0,this.decryptionPromise=j.webCryptoDecrypt(a,I.key.buffer,I.iv.buffer,F).then(D=>{const $=this.push(D,null,r);return this.decryptionPromise=null,$}),this.decryptionPromise}const L=this.needsProbing(h,p);if(L){const j=this.configureTransmuxer(a);if(j)return this.logger.warn(`[transmuxer] ${j.message}`),this.observer.emit(C.ERROR,C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,fatal:!1,error:j,reason:j.message}),i.executeEnd=Tn(),ff(r)}(h||p||y||L)&&this.resetInitSegment(k,E,w,T,t),(h||y||L)&&this.resetInitialTimestamp(S),u||this.resetContiguity();const O=this.transmux(a,I,x,g,r);this.asyncResult=io(O);const P=this.currentTransmuxState;return P.contiguous=!0,P.discontinuity=!1,P.trackSwitch=!1,i.executeEnd=Tn(),O}flush(e){const t=e.transmuxing;t.executeStart=Tn();const{decrypter:r,currentTransmuxState:s,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then(()=>this.flush(e));const a=[],{timeOffset:l}=s;if(r){const p=r.flush();p&&a.push(this.push(p.buffer,null,e))}const{demuxer:d,remuxer:u}=this;if(!d||!u){t.executeEnd=Tn();const p=[ff(e)];return this.asyncResult?Promise.resolve(p):p}const h=d.flush(l);return io(h)?(this.asyncResult=!0,h.then(p=>(this.flushRemux(a,p,e),a))):(this.flushRemux(a,h,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,r){const{audioTrack:s,videoTrack:i,id3Track:a,textTrack:l}=t,{accurateTimeOffset:d,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===ye.MAIN?"level":"track"} ${r.level}`);const h=this.remuxer.remux(s,i,a,l,u,d,!0,this.id);e.push({remuxResult:h,chunkMeta:r}),r.transmuxing.executeEnd=Tn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,s,i){const{demuxer:a,remuxer:l}=this;!a||!l||(a.resetInitSegment(e,t,r,s),l.resetInitSegment(e,t,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,s,i){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,r,s,i):a=this.transmuxUnencrypted(e,r,s,i),a}transmuxUnencrypted(e,t,r,s){const{audioTrack:i,videoTrack:a,id3Track:l,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,a,l,d,t,r,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,r,s,i){return this.demuxer.demuxSampleAes(e,t,r).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,r,s,!1,this.id),chunkMeta:i}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:s}=this;let i;for(let p=0,g=ac.length;p<g;p++){var a;if((a=ac[p].demux)!=null&&a.probe(e,this.logger)){i=ac[p];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,d=this.remuxer,u=i.remux,h=i.demux;(!d||!(d instanceof u))&&(this.remuxer=new u(r,t,s,this.logger)),(!l||!(l instanceof h))&&(this.demuxer=new h(r,t,s,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Fh(this.config)),e}}function $C(n,e){let t=null;return n.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const ff=n=>({remuxResult:{},chunkMeta:n});function io(n){return"then"in n&&n.then instanceof Function}class VC{constructor(e,t,r,s,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=s,this.defaultInitPts=i||null}}class GC{constructor(e,t,r,s,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=s,this.timeOffset=i,this.initSegmentChange=a}}let mx=0;class p1{constructor(e,t,r,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=mx++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const u=d.data,h=this.hls;if(!(!h||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var p;const g=(p=this.workerContext)==null?void 0:p.objectURL;g&&self.URL.revokeObjectURL(g);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{h.logger[u.data.logType]&&h.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,h.trigger(u.event,u.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const u=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=s;const a=(d,u)=>{u=u||{},u.frag=this.frag||void 0,d===C.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(d,u)};this.observer=new Gh,this.observer.on(C.FRAG_DECRYPTED,a),this.observer.on(C.ERROR,a);const l=Ag(i.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(i.workerPath||zk()){try{i.workerPath?(d.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=Yk(i.workerPath)):(d.log(`injecting Web Worker for "${t}"`),this.workerContext=Wk());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:tt(i)})}catch(h){d.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new hx(this.observer,l,i,"",t,e.logger)}return}}this.transmuxer=new hx(this.observer,l,i,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=mx++;const t=this.hls.config,r=Ag(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:tt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),Qk(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,s,i,a,l,d,u,h){var p,g;u.transmuxing.start=self.performance.now();const{instanceNo:x,transmuxer:y}=this,E=a?a.start:i.start,w=i.decryptdata,S=this.frag,T=!(S&&i.cc===S.cc),k=!(S&&u.level===S.level),I=S?u.sn-S.sn:-1,L=this.part?u.part-this.part.index:-1,O=I===0&&u.id>1&&u.id===S?.stats.chunkCount,P=!k&&(I===1||I===0&&(L===1||O&&L<=0)),j=self.performance.now();(k||I||i.stats.parsing.start===0)&&(i.stats.parsing.start=j),a&&(L||!P)&&(a.stats.parsing.start=j);const F=!(S&&((p=i.initSegment)==null?void 0:p.url)===((g=S.initSegment)==null?void 0:g.url)),D=new GC(T,P,d,k,E,F);if(!P||T||F){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===ye.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${T}
        trackSwitch: ${k}
        contiguous: ${P}
        accurateTimeOffset: ${d}
        timeOffset: ${E}
        initSegmentChange: ${F}`);const $=new VC(r,s,t,l,h);this.configureTransmuxer($)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:x,cmd:"demux",data:e,decryptdata:w,chunkMeta:u,state:D},e instanceof ArrayBuffer?[e]:[]);else if(y){const $=y.push(e,w,u,D);io($)?$.then(J=>{this.handleTransmuxComplete(J)}).catch(J=>{this.transmuxerError(J,u,"transmuxer-interface push error")}):this.handleTransmuxComplete($)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const s=r.flush(e);io(s)?s.then(i=>{this.handleFlushResult(i,e)}).catch(i=>{this.transmuxerError(i,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const px=100;class HC extends Vh{constructor(e,t,r){super(e,t,r,"audio-stream-controller",ye.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:a}){if(r===ye.MAIN){const l=t.cc,d=this.fragCurrent;if(this.initPTS[l]={baseTime:s,timescale:i,trackId:a},this.log(`InitPTS for cc: ${l} found from main: ${s/i} (${s}/${i}) trackId: ${a}`),this.mainAnchor=t,this.state===te.WAITING_INIT_PTS){const u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==l)&&this.syncWithAnchor(t,u?.frag)}else!this.hls.hasEnoughToStart&&d&&d.cc!==l?(d.abortRequests(),this.syncWithAnchor(t,d)):this.state===te.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const s=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&s?.cc===t.cc)return;const i=(s||e).cc,a=this.getLevelDetails(),l=this.getLoadPosition(),d=Ry(a,i,l);d&&(this.log(`Syncing with main frag at ${d.start} cc ${d.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===te.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=te.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(px),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=te.IDLE):this.state=te.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case te.IDLE:this.doTickIdle();break;case te.WAITING_TRACK:{const{levels:e,trackId:t}=this,r=e?.[t],s=r?.details;if(s&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(s))break;this.state=te.WAITING_INIT_PTS}break}case te.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case te.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:r,cache:s,complete:i}=e,a=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=te.FRAG_LOADING;const l=s.flush().buffer,d={frag:t,part:r,payload:l,networkDetails:null};this._handleFragmentLoadProgress(d),i&&super._handleFragmentLoadComplete(d)}else a&&a.cc!==e.frag.cc&&this.syncWithAnchor(a,e.frag)}else this.state=te.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:s,trackId:i}=this,a=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(r!=null&&r[i]))return;const l=r[i],d=l.details;if(!d||this.waitForLive(l)||this.waitForCdnTuneIn(d)){this.state=te.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,et.AUDIO,ye.AUDIO));const h=this.getFwdBufferInfo(u,ye.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,d)){t.trigger(C.BUFFER_EOS,{type:"audio"}),this.state=te.ENDED;return}const p=h.len,g=t.maxBufferLength,x=d.fragments,y=x[0].start,E=this.getLoadPosition(),w=this.flushing?E:h.end;if(this.switchingTrack&&s){const k=E;d.PTSKnown&&k<y&&(h.end>y||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=y+.05)}if(p>=g&&!this.switchingTrack&&w<x[x.length-1].start)return;let S=this.getNextFragment(w,d);if(S&&this.isLoopLoading(S,w)&&(S=this.getNextFragmentLoopLoading(S,d,h,ye.MAIN,g)),!S){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&wt(S)&&!S.endList&&(!d.live||!this.loadingParts&&w<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===It.OK&&(this.mainFragLoading=T=null),T&&wt(T))){if(S.start>T.end){const I=this.fragmentTracker.getFragAtPos(w,ye.MAIN);I&&I.end>T.end&&(T=I,this.mainFragLoading={frag:I,targetBufferTime:null})}if(S.start>T.end)return}this.loadFragment(S,l,w)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new ro(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==te.STOPPED&&(this.setInterval(px),this.state=te.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(C.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:s}=this,{details:i,id:a,groupId:l,track:d}=t;if(!s){this.warn(`Audio tracks reset while loading track ${a} "${d.name}" of "${l}"`);return}const u=this.mainDetails;if(!u||i.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=t,this.state!==te.STOPPED&&(this.state=te.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${d.name}" of "${l}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const h=s[a];let p=0;if(i.live||(r=h.details)!=null&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;if(h.details){var g;p=this.alignPlaylists(i,h.details,(g=this.levelLastLoaded)==null?void 0:g.details)}i.alignedSliding||(Yy(i,u),i.alignedSliding||wc(i,u),p=i.fragmentStart)}h.details=i,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(u,p),this.hls.trigger(C.AUDIO_TRACK_UPDATED,{details:i,id:a,groupId:t.groupId}),this.state===te.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=te.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{config:a,trackId:l,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const u=d[l];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const h=u.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const p=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let g=this.transmuxer;g||(g=this.transmuxer=new p1(this.hls,ye.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[r.cc],y=(t=r.initSegment)==null?void 0:t.data;if(x!==void 0){const w=s?s.index:-1,S=w!==-1,T=new Uh(r.level,r.sn,r.stats.chunkCount,i.byteLength,w,S);g.push(i,y,p,"",r,s,h.totalduration,!1,T,x)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${h.startSN} ,${h.endSN}],track ${l}`);const{cache:E}=this.waitingData=this.waitingData||{frag:r,part:s,cache:new Qy,complete:!1};E.push(new Uint8Array(i)),this.state!==te.STOPPED&&(this.state=te.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ye.MAIN&&wt(t.frag)&&(this.mainFragLoading=t,this.state===te.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r.type!==ye.AUDIO){!this.audioOnly&&r.type===ye.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(wt(r)){this.fragPrevious=r;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(C.AUDIO_TRACK_SWITCHED,Ye({},i)))}this.fragBufferedComplete(r,s),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=te.ERROR;return}switch(t.details){case q.FRAG_GAP:case q.FRAG_PARSING_ERROR:case q.FRAG_DECRYPT_ERROR:case q.FRAG_LOAD_ERROR:case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_ERROR:case q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ye.AUDIO,t);break;case q.AUDIO_TRACK_LOAD_ERROR:case q.AUDIO_TRACK_LOAD_TIMEOUT:case q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===te.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===Be.AUDIO_TRACK&&(this.state=te.IDLE);break;case q.BUFFER_ADD_CODEC_ERROR:case q.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case q.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==et.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==et.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===te.ENDED&&(this.state=te.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,ye.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:s}=this,{remuxResult:i,chunkMeta:a}=e,l=this.getCurrentContext(a);if(!l){this.resetWhenMissingContext(a);return}const{frag:d,part:u,level:h}=l,{details:p}=h,{audio:g,text:x,id3:y,initSegment:E}=i;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=te.PARSING,this.switchingTrack&&g&&this.completeAudioSwitch(this.switchingTrack),E!=null&&E.tracks){const w=d.initSegment||d;if(this.unhandledEncryptionError(E,d))return;this._bufferInitSegment(h,E.tracks,w,a),s.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:r,tracks:E.tracks})}if(g){const{startPTS:w,endPTS:S,startDTS:T,endDTS:k}=g;u&&(u.elementaryStreams[et.AUDIO]={startPTS:w,endPTS:S,startDTS:T,endDTS:k}),d.setElementaryStreamInfo(et.AUDIO,w,S,T,k),this.bufferFragmentData(g,d,u,a)}if(y!=null&&(t=y.samples)!=null&&t.length){const w=Ze({id:r,frag:d,details:p},y);s.trigger(C.FRAG_PARSING_METADATA,w)}if(x){const w=Ze({id:r,frag:d,details:p},x);s.trigger(C.FRAG_PARSING_USERDATA,w)}}_bufferInitSegment(e,t,r,s){if(this.state!==te.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const i=t.audio;i.id=ye.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${a}/${i.codec}]`),a&&a.split(",").length===1&&(i.levelCodec=a),this.hls.trigger(C.BUFFER_CODECS,t);const l=i.initSegment;if(l!=null&&l.byteLength){const d={type:"audio",frag:r,part:null,chunkMeta:s,parent:r.type,data:l};this.hls.trigger(C.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===It.NOT_LOADED||s===It.PARTIAL){var i;if(!wt(e))this._loadInitSegment(e,t);else if((i=t.details)!=null&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=te.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&wc(t.details,a)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:s,characteristics:i,audioCodec:a,channels:l}=this.bufferedTrack;Us({name:t,lang:r,assocLang:s,characteristics:i,audioCodec:a,channels:l},e,Os)||(gc(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(C.AUDIO_TRACK_SWITCHED,Ye({},e))}}class Qh extends kr{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const s=t?.renditionReports;if(s){let i=-1;for(let a=0;a<s.length;a++){const l=s[a];let d;try{d=new self.URL(l.URI,t.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),d=l.URI||""}if(d===e){i=a;break}else d===e.substring(0,d.length)&&(i=a)}if(i!==-1){const a=s[i],l=parseInt(a["LAST-MSN"])||t.lastPartSn;let d=parseInt(a["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);d>=0&&h>t.partTarget&&(d+=1)}const u=r&&Lg(r);return new Rg(l,d>=0?d:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:s,stats:i}=t,a=self.performance.now(),l=i.loading.first?Math.max(0,a-i.loading.first):0;s.advancedDateTime=Date.now()-l;const d=this.hls.config.timelineOffset;if(d!==s.appliedTimelineOffset){const h=Math.max(d||0,0);s.appliedTimelineOffset=h,s.fragments.forEach(p=>{p.setStart(p.playlistOffset+h)})}if(s.live||r!=null&&r.live){const h="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(r),r&&s.fragments.length>0){jk(r,s,this);const T=s.playlistParsingError;if(T){this.warn(T);const k=this.hls;if(!k.config.ignorePlaylistParsingErrors){var u;const{networkDetails:I}=t;k.trigger(C.ERROR,{type:Te.NETWORK_ERROR,details:q.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:T,reason:T.message,level:t.level||void 0,parent:(u=s.fragments[0])==null?void 0:u.type,networkDetails:I,stats:i});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=i.loading.start);const p=this.hls.mainForwardBufferInfo,g=p?p.end-p.len:0,x=(s.edge-g)*1e3,y=Hy(s,x);if(s.requestScheduled+y<a?s.requestScheduled=a:s.requestScheduled+=y,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let E,w,S;if(s.canBlockReload&&s.endSN&&s.advanced){const T=this.hls.config.lowLatencyMode,k=s.lastPartSn,I=s.endSN,L=s.lastPartIndex,O=L!==-1,P=k===I;O?P?(w=I+1,S=T?0:L):(w=k,S=T?L+1:s.maxPartIndex):w=I+1;const j=s.age,F=j+s.ageHeader;let D=Math.min(F-s.partTarget,s.targetduration*1.5);if(D>0){if(F>s.targetduration*3)this.log(`Playlist last advanced ${j.toFixed(2)}s ago. Omitting segment and part directives.`),w=void 0,S=void 0;else if(r!=null&&r.tuneInGoal&&F-s.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${D} with playlist age: ${s.age}`),D=0;else{const $=Math.floor(D/s.targetduration);if(w+=$,S!==void 0){const J=Math.round(D%s.targetduration/s.partTarget);S+=J}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${j.toFixed(2)}s goal: ${D} skip sn ${$} to part ${S}`)}s.tuneInGoal=D}if(E=this.getDeliveryDirectives(s,t.deliveryDirectives,w,S),T||!P){s.requestScheduled=a,this.loadingPlaylist(h,E);return}}else(s.canBlockReload||s.canSkipUntil)&&(E=this.getDeliveryDirectives(s,t.deliveryDirectives,w,S));E&&w!==void 0&&s.canBlockReload&&(s.requestScheduled=i.loading.first+Math.max(y-l*2,y/2)),this.scheduleLoading(h,E,s)}else this.clearTimer()}scheduleLoading(e,t,r){const s=r||e.details;if(!s){this.loadingPlaylist(e,t);return}const i=self.performance.now(),a=s.requestScheduled;if(i>=a){this.loadingPlaylist(e,t);return}const l=a-i;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),l)}getDeliveryDirectives(e,t,r,s){let i=Lg(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,s=t.part,i=nc.No),new Rg(r,s,i)}checkRetry(e){const t=e.details,r=xc(e),s=e.errorAction,{action:i,retryCount:a=0,retryConfig:l}=s||{},d=!!s&&!!l&&(i===Ft.RetryRequest||!s.resolved&&i===Ft.SendAlternateToPenaltyBox);if(d){var u;if(a>=l.maxNumRetry)return!1;if(r&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=Mh(l,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${a+1}/${l.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,s.resolved=!0}return d}}function g1(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!ao(n[t].attrs,e[t].attrs))return!1;return!0}function ao(n,e,t){const r=n["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>n[s]!==e[s])}function oh(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class qC extends Qh{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==s){this.warn(`Audio track with id:${r} and group:${s} not found in active group ${a?.groupId}`);return}const l=a.details;a.details=t.details,this.log(`Audio track ${r} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(l=>s?.indexOf(l)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(g=>!r||r.indexOf(g.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(g=>g.default)&&(this.selectDefaultTrack=!1),l.forEach((g,x)=>{g.id=x});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const d=this.hls.config.audioPreference;if(!i&&d){const g=en(d,l,Os);if(g>-1)i=l[g];else{const x=en(d,this.tracks);i=this.tracks[x]}}let u=this.findTrackId(i);u===-1&&i&&(u=this.findTrackId(null));const h={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${r?.join(",")}`),this.hls.trigger(C.AUDIO_TRACKS_UPDATED,h);const p=this.trackId;if(u!==-1&&p===-1)this.setAudioTrack(u);else if(l.length&&p===-1){var a;const g=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${l.length}`);this.warn(g.message),this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:g})}}}onError(e,t){t.fatal||!t.context||t.context.type===Be.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const s=this.currentTrack;if(s&&Us(e,s,Os))return s;const i=en(e,this.tracksInGroup,Os);if(i>-1){const a=this.tracksInGroup[i];return this.setAudioTrack(i),a}else if(s){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const l=nk(e,t.levels,r,a,Os);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){const a=en(e,r);if(a>-1)return r[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e],i=s.details&&!s.details.live;if(e===this.trackId&&s===r&&i||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(C.AUDIO_TRACK_SWITCHING,Ye({},s)),i))return;const a=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(!(this.selectDefaultTrack&&!s.default)&&(!e||Us(e,s,Os)))return r}if(e){const{name:r,lang:s,assocLang:i,characteristics:a,audioCodec:l,channels:d}=e;for(let u=0;u<t.length;u++){const h=t[u];if(Us({name:r,lang:s,assocLang:i,characteristics:a,audioCodec:l,channels:d},h,Os))return u}for(let u=0;u<t.length;u++){const h=t[u];if(ao(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const h=t[u];if(ao(e.attrs,h.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&gc(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),a=e.details,l=a?.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(C.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}}class KC{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(i){var r;if(s.onError(i),this.queues===null||this.tracks===null)return;const a=(r=this.tracks[e])==null?void 0:r.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],s=r?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const gx=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,x1="HlsJsTrackRemovedError";class zC extends Error{constructor(e){super(e),this.name=x1}}class WC extends kr{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:s,mediaSource:i}=this;r&&this.log("Media source opened"),!(!s||!i)&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(C.MEDIA_ATTACHED,{media:s,mediaSource:i}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:s}=this;r!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=g_(fs(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_APPENDING,this.onBufferAppending,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.BUFFER_EOS,this.onBufferEos,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.FRAG_PARSED,this.onFragParsed,this),e.on(C.FRAG_CHANGED,this.onFragChanged,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_APPENDING,this.onBufferAppending,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_EOS,this.onBufferEos,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.FRAG_PARSED,this.onFragParsed,this),e.off(C.FRAG_CHANGED,this.onFragChanged,this),e.off(C.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const i=this.isUpdating();i||this.operationQueue.removeBlockers();const a=this.isQueued();(i||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${i?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?Ze(r,s.tracks):this.sourceBuffers.forEach(i=>{const[a]=i;a&&(r[a]=Ze({},this.tracks[a]),this.removeBuffer(a)),i[0]=i[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media;this.transferData=this.overrides=void 0;const s=fs(this.appendSource);if(s){const i=!!t.mediaSource;(i||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(a),i)this._objectUrl=r.src,this.attachTransferred();else{const l=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");const d=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||d&&a instanceof d,xx(r),YC(r,l),r.load()}catch{r.src=l}else r.src=l}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,s=t.tracks,i=s?Object.keys(s):null,a=i?i.length:0,l=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&i&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${tt(r,(d,u)=>d==="initSegment"?void 0:u)};
transfer tracks: ${tt(s,(d,u)=>d==="initSegment"?void 0:u)}}`),!hy(s,r)){t.mediaSource=null,t.tracks=void 0;const d=e.currentTime,u=this.details,h=Math.max(d,u?.fragments[0].start||0);if(h-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(r)}") start time: ${h} currentTime: ${d}`),this.onMediaDetaching(C.MEDIA_DETACHING,{}),this.onMediaAttaching(C.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,i.forEach(d=>{const u=d,h=s[u];if(h){const p=h.buffer;if(p){const g=this.fragmentTracker,x=h.id;if(g.hasFragments(x)||g.hasParts(x)){const w=Oe.getBuffered(p);g.detectEvictedFragments(u,w,x,null,!0)}const y=hf(u),E=[u,p];this.sourceBuffers[y]=E,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,h)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:i,_objectUrl:a}=this;if(i){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const l=i.readyState==="open";try{const d=i.sourceBuffers;for(let u=d.length;u--;)l&&d[u].abort(),i.removeSourceBuffer(d[u]);l&&i.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),r||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(s.removeAttribute("src"),this.appendSource&&xx(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(C.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(i){this.warn(`onBufferReset ${e}`,i)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[hf(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new KC(this.tracks)}onBufferCodecs(e,t){var r;const s=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in t&&(s.audio||s.video)||s.audiovideo&&("audio"in t||"video"in t),l=!a&&this.sourceBufferCount&&this.media&&i.some(d=>!s[d]);if(a||l){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${i}" SourceBuffers`);return}i.forEach(d=>{var u,h;const p=t[d],{id:g,codec:x,levelCodec:y,container:E,metadata:w,supplemental:S}=p;let T=s[d];const k=(u=this.transferData)==null||(u=u.tracks)==null?void 0:u[d],I=k!=null&&k.buffer?k:T,L=I?.pendingCodec||I?.codec,O=I?.levelCodec;T||(T=s[d]={buffer:void 0,listeners:[],codec:x,supplemental:S,container:E,levelCodec:y,metadata:w,id:g});const P=rc(L,O),j=P?.replace(gx,"$1");let F=rc(x,y);const D=(h=F)==null?void 0:h.replace(gx,"$1");F&&P&&j!==D&&(d.slice(0,5)==="audio"&&(F=mc(F,this.appendSource)),this.log(`switching codec ${L} to ${F}`),F!==(T.pendingCodec||T.codec)&&(T.pendingCodec=F),T.container=E,this.appendChangeType(d,E,F))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((r=t.audio)==null?void 0:r.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const s=`${t};codecs=${r}`,i={label:`change-type=${s}`,execute:()=>{const a=this.tracks[e];if(a){const l=a.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),l.changeType(s),a.codec=r,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(i,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,s=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,ye.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var l;const d=this.tracks.video;(this.lastVideoAppendEnd>s||d!=null&&d.buffer&&Oe.isBuffered(d.buffer,s)||((l=this.fragmentTracker.getAppendedFrag(s,ye.MAIN))==null?void 0:l.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn("Error executing block-audio operation",l)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:s,type:i,parent:a,frag:l,part:d,chunkMeta:u,offset:h}=t,p=u.buffering[i],{sn:g,cc:x}=l,y=self.performance.now();p.start=y;const E=l.stats.buffering,w=d?d.stats.buffering:null;E.start===0&&(E.start=y),w&&w.start===0&&(w.start=y);const S=r.audio;let T=!1;i==="audio"&&S?.container==="audio/mpeg"&&(T=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const k=r.video,I=k?.buffer;if(I&&g!=="initSegment"){const P=d||l,j=this.blockedAudioAppend;if(i==="audio"&&a!=="main"&&!this.blockedAudioAppend&&!(k.ending||k.ended)){const D=P.start+P.duration*.05,$=I.buffered,J=this.currentOp("video");!$.length&&!J?this.blockAudio(P):!J&&!Oe.isBuffered(I,D)&&this.lastVideoAppendEnd<D&&this.blockAudio(P)}else if(i==="video"){const F=P.end;if(j){const D=j.frag.start;(F>D||F<this.lastVideoAppendEnd||Oe.isBuffered(I,D))&&this.unblockAudio()}this.lastVideoAppendEnd=F}}const L=(d||l).start,O={label:`append-${i}`,execute:()=>{var P;p.executeStart=self.performance.now();const j=(P=this.tracks[i])==null?void 0:P.buffer;j&&(T?this.updateTimestampOffset(j,L,.1,i,g,x):h!==void 0&&xe(h)&&this.updateTimestampOffset(j,h,1e-6,i,g,x)),this.appendExecutor(s,i)},onStart:()=>{},onComplete:()=>{const P=self.performance.now();p.executeEnd=p.end=P,E.first===0&&(E.first=P),w&&w.first===0&&(w.first=P);const j={};this.sourceBuffers.forEach(([F,D])=>{F&&(j[F]=Oe.getBuffered(D))}),this.appendErrors[i]=0,i==="audio"||i==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(C.BUFFER_APPENDED,{type:i,frag:l,part:d,chunkMeta:u,parent:l.type,timeRanges:j})},onError:P=>{var j;const F={type:Te.MEDIA_ERROR,parent:l.type,details:q.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:l,part:d,chunkMeta:u,error:P,err:P,fatal:!1},D=(j=this.media)==null?void 0:j.error;if(P.code===DOMException.QUOTA_EXCEEDED_ERR||P.name=="QuotaExceededError"||"quota"in P)F.details=q.BUFFER_FULL_ERROR;else if(P.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!D)F.errorAction=Ri(!0);else if(P.name===x1&&this.sourceBufferCount===0)F.errorAction=Ri(!0);else{const $=++this.appendErrors[i];this.warn(`Failed ${$}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${i}" sourceBuffer (${D||"no media error"})`),($>=this.hls.config.appendErrorMaxRetry||D)&&(F.fatal=!0)}this.hls.trigger(C.ERROR,F)}};this.log(`queuing "${i}" append sn: ${g}${d?" p: "+d.index:""} of ${l.type===ye.MAIN?"level":"track"} ${l.level} cc: ${x}`),this.append(O,i,this.isPending(this.tracks[i]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(C.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:r,startOffset:s,endOffset:i}=t;r?this.append(this.getFlushOp(r,s,i),r):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,s,i),a)})}onFragParsed(e,t){const{frag:r,part:s}=t,i=[],a=s?s.elementaryStreams:r.elementaryStreams;a[et.AUDIOVIDEO]?i.push("audiovideo"):(a[et.AUDIO]&&i.push("audio"),a[et.VIDEO]&&i.push("video"));const l=()=>{const d=self.performance.now();r.stats.buffering.end=d,s&&(s.stats.buffering.end=d);const u=s?s.stats:r.stats;this.hls.trigger(C.FRAG_BUFFERED,{frag:r,part:s,stats:u,id:r.type})};i.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(l,i).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){const l=this.tracks[a];(!t.type||t.type===a)&&(l.ending=!0,l.ended||(l.ended=!0,this.log(`${a} buffer reached EOS`)))}});const s=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var l;return a&&!((l=this.tracks[a])!=null&&l.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(C.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(C.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===q.BUFFER_APPEND_ERROR&&t.frag){var r;const s=(r=t.errorAction)==null?void 0:r.nextAutoLevel;xe(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const s=e.config,i=r.currentTime,a=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(xe(l)&&l>=0){const u=Math.max(l,a),h=Math.floor(i/a)*a-u;this.flushBackBuffer(i,a,h)}const d=s.frontBufferFlushThreshold;if(xe(d)&&d>0){const u=Math.max(s.maxBufferLength,d),h=Math.max(u,a),p=Math.floor(i/a)*a+h;this.flushFrontBuffer(i,a,p)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const l=Oe.getBuffered(i);if(l.length>0&&r>l.start(0)){var a;this.hls.trigger(C.BACK_BUFFER_REACHED,{bufferEnd:r});const d=this.tracks[s];if((a=this.details)!=null&&a.live)this.hls.trigger(C.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(d!=null&&d.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:s})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const a=Oe.getBuffered(i),l=a.length;if(l<2)return;const d=a.start(l-1),u=a.end(l-1);if(r>d||e>=d&&e<=u)return;this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||r?.readyState!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){const u=Math.max(0,t.fragmentStart),h=Math.max(u,s);return{duration:1/0,start:u,end:h}}return{duration:1/0}}const i=(e=this.overrides)==null?void 0:e.duration;if(i)return xe(i)?{duration:i}:null;const a=this.media.duration,l=xe(r.duration)?r.duration:0;return s>l&&s>a||!xe(a)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:r}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(xe(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${r}.`),s.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${tt(r)}`),this.tracksReady){var s;const i=(s=this.transferData)==null?void 0:s.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const s=this.tracks[t];e[t]={buffer:r,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(C.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in e){const a=i,l=e[a];if(this.isPending(l)){const d=this.getTrackCodec(l,a),u=`${l.container};codecs=${d}`;l.codec=d,this.log(`creating sourceBuffer(${u})${this.currentOp(a)?" Queued":""} ${tt(l)}`);try{const h=r.addSourceBuffer(u),p=hf(a),g=[a,h];t[p]=g,l.buffer=h}catch(h){var s;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(a),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[a],this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:a,mimeType:u,parent:l.id});return}this.trackSourceBuffer(a,l)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let s=e.codec;r&&(t==="video"||t==="audiovideo")&&eo(r,"video")&&(s=F_(s,r));const i=rc(s,e.levelCodec);return i?t.slice(0,5)==="audio"?mc(i,this.appendSource):i:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(i,a)=>{const l=a.removedRanges;l!=null&&l.length&&this.hls.trigger(C.BUFFER_FLUSHED,{type:i})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${s}`,t),this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const i=this.currentOp(e);i&&i.onError(s)}updateTimestampOffset(e,t,r,s,i,a){const l=t-e.timestampOffset;Math.abs(l)>=r&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${t} (sn: ${i} cc: ${a})`),e.timestampOffset=t)}removeExecutor(e,t,r){const{media:s,mediaSource:i}=this,a=this.tracks[e],l=a?.buffer;if(!s||!i||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const d=xe(s.duration)?s.duration:1/0,u=xe(i.duration)?i.duration:1/0,h=Math.max(0,t),p=Math.min(r,d,u);p>h&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${h},${p}] from the ${e} SourceBuffer`),l.remove(h,p)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],s=r?.buffer;if(!s)throw new zC(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,s=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const s=(r=this.tracks[t])==null?void 0:r.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const s=this.tracks[e];if(!s)return;const i=s.buffer;if(!i)return;const a=r.bind(this,e);s.listeners.push({event:t,listener:a}),i.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(s=>{r.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function xx(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function YC(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}function hf(n){return n==="audio"?1:0}class Xh{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&xe(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((s,i)=>this.isLevelAllowed(s)&&i<=e);return this.clientRect=null,Xh.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const s=(l,d)=>d?l.width!==d.width||l.height!==d.height:!0;let i=e.length-1;const a=Math.max(t,r);for(let l=0;l<e.length;l+=1){const d=e[l];if((d.width>=a||d.height>=a)&&s(d,e[l+1])){i=l;break}}return i}}const QC={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},nr=QC,XC={HLS:"h"},ZC=XC;class rn{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof rn?r:new rn(r))),this.value=e,this.params=t}}const JC="Dict";function eI(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function tI(n,e,t,r){return new Error(`failed to ${n} "${eI(e)}" as ${t}`,{cause:r})}function nn(n,e,t){return tI("serialize",n,e,t)}class v1{constructor(e){this.description=e}}const vx="Bare Item",rI="Boolean";function nI(n){if(typeof n!="boolean")throw nn(n,rI);return n?"?1":"?0"}function sI(n){return btoa(String.fromCharCode(...n))}const iI="Byte Sequence";function aI(n){if(ArrayBuffer.isView(n)===!1)throw nn(n,iI);return`:${sI(n)}:`}const oI="Integer";function lI(n){return n<-999999999999999||999999999999999<n}function y1(n){if(lI(n))throw nn(n,oI);return n.toString()}function cI(n){return`@${y1(n.getTime()/1e3)}`}function E1(n,e){if(n<0)return-E1(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const s=Math.floor(n*t);return(s%2===0?s:s+1)/t}else return Math.round(n*t)/t}const uI="Decimal";function dI(n){const e=E1(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw nn(n,uI);const t=e.toString();return t.includes(".")?t:`${t}.0`}const fI="String",hI=/[\x00-\x1f\x7f]+/;function mI(n){if(hI.test(n))throw nn(n,fI);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function pI(n){return n.description||n.toString().slice(7,-1)}const gI="Token";function yx(n){const e=pI(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw nn(e,gI);return e}function lh(n){switch(typeof n){case"number":if(!xe(n))throw nn(n,vx);return Number.isInteger(n)?y1(n):dI(n);case"string":return mI(n);case"symbol":return yx(n);case"boolean":return nI(n);case"object":if(n instanceof Date)return cI(n);if(n instanceof Uint8Array)return aI(n);if(n instanceof v1)return yx(n);default:throw nn(n,vx)}}const xI="Key";function ch(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw nn(n,xI);return n}function Zh(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${ch(e)}`:`;${ch(e)}=${lh(t)}`).join("")}function w1(n){return n instanceof rn?`${lh(n.value)}${Zh(n.params)}`:lh(n)}function vI(n){return`(${n.value.map(w1).join(" ")})${Zh(n.params)}`}function yI(n,e={whitespace:!0}){if(typeof n!="object"||n==null)throw nn(n,JC);const t=n instanceof Map?n.entries():Object.entries(n),r=e?.whitespace?" ":"";return Array.from(t).map(([s,i])=>{i instanceof rn||(i=new rn(i));let a=ch(s);return i.value===!0?a+=Zh(i.params):(a+="=",Array.isArray(i.value)?a+=vI(i):a+=w1(i)),a}).join(`,${r}`)}function b1(n,e){return yI(n,e)}const Yr="CMCD-Object",gt="CMCD-Request",Rs="CMCD-Session",ss="CMCD-Status",EI={br:Yr,ab:Yr,d:Yr,ot:Yr,tb:Yr,tpb:Yr,lb:Yr,tab:Yr,lab:Yr,url:Yr,pb:gt,bl:gt,tbl:gt,dl:gt,ltc:gt,mtp:gt,nor:gt,nrr:gt,rc:gt,sn:gt,sta:gt,su:gt,ttfb:gt,ttfbb:gt,ttlb:gt,cmsdd:gt,cmsds:gt,smrt:gt,df:gt,cs:gt,ts:gt,cid:Rs,pr:Rs,sf:Rs,sid:Rs,st:Rs,v:Rs,msd:Rs,bs:ss,bsd:ss,cdn:ss,rtp:ss,bg:ss,pt:ss,ec:ss,e:ss},wI={REQUEST:gt};function bI(n){return Object.keys(n).reduce((e,t)=>{var r;return(r=n[t])===null||r===void 0||r.forEach(s=>e[s]=t),e},{})}function SI(n,e){const t={};if(!n)return t;const r=Object.keys(n),s=e?bI(e):{};return r.reduce((i,a)=>{var l;const d=EI[a]||s[a]||wI.REQUEST,u=(l=i[d])!==null&&l!==void 0?l:i[d]={};return u[a]=n[a],i},t)}function TI(n){return["ot","sf","st","e","sta"].includes(n)}function _I(n){return typeof n=="number"?xe(n):n!=null&&n!==""&&n!==!1}const S1="event";function kI(n,e){const t=new URL(n),r=new URL(e);if(t.origin!==r.origin)return n;const s=t.pathname.split("/").slice(1),i=r.pathname.split("/").slice(1,-1);for(;s[0]===i[0];)s.shift(),i.shift();for(;i.length;)i.shift(),s.unshift("..");return s.join("/")+t.search+t.hash}const oc=n=>Math.round(n),uh=(n,e)=>Array.isArray(n)?n.map(t=>uh(t,e)):n instanceof rn&&typeof n.value=="string"?new rn(uh(n.value,e),n.params):(e.baseUrl&&(n=kI(n,e.baseUrl)),e.version===1?encodeURIComponent(n):n),Bl=n=>oc(n/100)*100,CI=(n,e)=>{let t=n;return e.version>=2&&(n instanceof rn&&typeof n.value=="string"?t=new rn([n]):typeof n=="string"&&(t=[n])),uh(t,e)},II={br:oc,d:oc,bl:Bl,dl:Bl,mtp:Bl,nor:CI,rtp:Bl,tb:oc},T1="request",_1="response",Jh=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],AI=["e"],LI=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Hc(n){return LI.test(n)}function RI(n){return Jh.includes(n)||AI.includes(n)||Hc(n)}const k1=["d","dl","nor","ot","rtp","su"];function NI(n){return Jh.includes(n)||k1.includes(n)||Hc(n)}const DI=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function PI(n){return Jh.includes(n)||k1.includes(n)||DI.includes(n)||Hc(n)}const OI=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function jI(n){return OI.includes(n)||Hc(n)}const MI={[_1]:PI,[S1]:RI,[T1]:NI};function C1(n,e={}){const t={};if(n==null||typeof n!="object")return t;const r=e.version||n.v||1,s=e.reportingMode||T1,i=r===1?jI:MI[s];let a=Object.keys(n).filter(i);const l=e.filter;typeof l=="function"&&(a=a.filter(l));const d=s===_1||s===S1;d&&!a.includes("ts")&&a.push("ts"),r>1&&!a.includes("v")&&a.push("v");const u=Ze({},II,e.formatters),h={version:r,reportingMode:s,baseUrl:e.baseUrl};return a.sort().forEach(p=>{let g=n[p];const x=u[p];if(typeof x=="function"&&(g=x(g,h)),p==="v"){if(r===1)return;g=r}p=="pr"&&g===1||(d&&p==="ts"&&!xe(g)&&(g=Date.now()),_I(g)&&(TI(p)&&typeof g=="string"&&(g=new v1(g)),t[p]=g))}),t}function FI(n,e={}){const t={};if(!n)return t;const r=C1(n,e),s=SI(r,e?.customHeaderMap);return Object.entries(s).reduce((i,[a,l])=>{const d=b1(l,{whitespace:!1});return d&&(i[a]=d),i},t)}function UI(n,e,t){return Ze(n,FI(e,t))}const BI="CMCD";function $I(n,e={}){return n?b1(C1(n,e),{whitespace:!1}):""}function VI(n,e={}){if(!n)return"";const t=$I(n,e);return encodeURIComponent(t)}function GI(n,e={}){if(!n)return"";const t=VI(n,e);return`${BI}=${t}`}const Ex=/CMCD=[^&#]+/;function HI(n,e,t){const r=GI(e,t);if(!r)return n;if(Ex.test(n))return n.replace(Ex,r);const s=n.includes("?")?"&":"?";return`${n}${s}${r}`}class qI{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:nr.MANIFEST,su:!this.initialized})}catch(i){this.hls.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=s=>{try{const{frag:i,part:a}=s,l=this.hls.levels[i.level],d=this.getObjectType(i),u={d:(a||i).duration*1e3,ot:d};(d===nr.VIDEO||d===nr.AUDIO||d==nr.MUXED)&&(u.br=l.bitrate/1e3,u.tb=this.getTopBandwidth(d)/1e3,u.bl=this.getBufferLength(d));const h=a?this.getNextPart(a):this.getNextFrag(i);h!=null&&h.url&&h.url!==i.url&&(u.nor=h.url),this.apply(s,u)}catch(i){this.hls.logger.warn("Could not generate segment CMCD data.",i)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHED,this.onMediaDetached,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHED,this.onMediaDetached,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,s;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:ZC.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ze(t,this.createData());const r=t.ot===nr.INIT||t.ot===nr.VIDEO||t.ot===nr.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((a,l)=>(s.includes(l)&&(a[l]=t[l]),a),{}));const i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),UI(e.headers,t,i)):e.url=HI(e.url,t,i)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const s=e.sn-r.startSN;return r.fragments[s+1]}}getNextPart(e){var t;const{index:r,fragment:s}=e,i=(t=this.hls.levels[s.level])==null||(t=t.details)==null?void 0:t.partList;if(i){const{sn:a}=s;for(let l=i.length-1;l>=0;l--){const d=i[l];if(d.index===r&&d.fragment.sn===a)return i[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return nr.TIMED_TEXT;if(e.sn==="initSegment")return nr.INIT;if(t==="audio")return nr.AUDIO;if(t==="main")return this.hls.audioTracks.length?nr.VIDEO:nr.MUXED}getTopBandwidth(e){let t=0,r;const s=this.hls;if(e===nr.AUDIO)r=s.audioTracks;else{const i=s.maxAutoLevel,a=i>-1?i+1:s.levels.length;r=s.levels.slice(0,a)}return r.forEach(i=>{i.bitrate>t&&(t=i.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===nr.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Oe.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,l){t(i),this.loader.load(i,a,l)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,l){t(i),this.loader.load(i,a,l)}}}}const KI=3e5;class zI extends kr{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if(r?.action===Ft.SendAlternateToPenaltyBox&&r.flags===fr.MoveAllAlternatesMatchingHost){const s=this.levels;let i=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:l,pathwayId:d,type:u}=t.context;l&&s?a=this.getPathwayForGroupId(l,u,a):d&&(a=d)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!i&&s&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),r.resolved=this.pathwayId!==a),t.details===q.BUFFER_APPEND_ERROR&&!t.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${s&&s.length} priorities: ${tt(i)} penalized: ${tt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,s=performance.now();Object.keys(r).forEach(i=>{s-r[i]>KI&&delete r[i]});for(let i=0;i<e.length;i++){const a=e[i];if(a in r)continue;if(a===this.pathwayId)return;const l=this.hls.nextLoadLevel,d=this.hls.levels[l];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,zy(t),this.hls.trigger(C.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[l];d&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,r){const s=this.getLevelsForPathway(r).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(t===Be.AUDIO_TRACK&&s[i].hasAudioGroup(e)||t===Be.SUBTITLE_TRACK&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},s={};e.forEach(i=>{const{ID:a,"BASE-ID":l,"URI-REPLACEMENT":d}=i;if(t.some(h=>h.pathwayId===a))return;const u=this.getLevelsForPathway(l).map(h=>{const p=new dt(h.attrs);p["PATHWAY-ID"]=a;const g=p.AUDIO&&`${p.AUDIO}_clone_${a}`,x=p.SUBTITLES&&`${p.SUBTITLES}_clone_${a}`;g&&(r[p.AUDIO]=g,p.AUDIO=g),x&&(s[p.SUBTITLES]=x,p.SUBTITLES=x);const y=I1(h.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),E=new ro({attrs:p,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:y,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let w=1;w<h.audioGroups.length;w++)E.addGroupId("audio",`${h.audioGroups[w]}_clone_${a}`);if(h.subtitleGroups)for(let w=1;w<h.subtitleGroups.length;w++)E.addGroupId("text",`${h.subtitleGroups[w]}_clone_${a}`);return E});t.push(...u),wx(this.audioTracks,r,d,a),wx(this.subtitleTracks,s,d,a)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+h)}const i={responseType:"json",url:s.href},a=t.steeringManifestLoadPolicy.default,l=a.errorRetry||a.timeoutRetry||{},d={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},u={onSuccess:(h,p,g,x)=>{this.log(`Loaded steering manifest: "${s}"`);const y=h.data;if(y?.VERSION!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":E,"PATHWAY-CLONES":w,"PATHWAY-PRIORITY":S}=y;if(E)try{this.uri=new self.URL(E,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${E}`);return}this.scheduleRefresh(this.uri||g.url),w&&this.clonePathways(w);const T={steeringManifest:y,url:s.toString()};this.hls.trigger(C.STEERING_MANIFEST_LOADED,T),S&&this.updatePathwayPriority(S)},onError:(h,p,g,x)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${p.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let y=this.timeToLoad*1e3;if(h.code===429){const E=this.loader;if(typeof E?.getResponseHeader=="function"){const w=E.getResponseHeader("Retry-After");w&&(y=parseFloat(w)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,y)},onTimeout:(h,p,g)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(i,d,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const s=(r=this.hls)==null?void 0:r.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function wx(n,e,t,r){n&&Object.keys(e).forEach(s=>{const i=n.filter(a=>a.groupId===s).map(a=>{const l=Ze({},a);return l.details=void 0,l.attrs=new dt(l.attrs),l.url=l.attrs.URI=I1(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[s],l.attrs["PATHWAY-ID"]=r,l});n.push(...i)})}function I1(n,e,t,r){const{HOST:s,PARAMS:i,[t]:a}=r;let l;e&&(l=a?.[e],l&&(n=l));const d=new self.URL(n);return s&&!l&&(d.host=s),i&&Object.keys(i).sort().forEach(u=>{u&&d.searchParams.set(u,i[u])}),d.href}class Di extends kr{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Di.CDMCleanupPromise?[Di.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:r,initData:s}=t,i=`"${t.type}" event: init data type: "${r}"`;if(this.debug(i),s!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=Ga(this.config));const l=a.map(sf).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(a=>{const l=sc(a);if(r!=="sinf"||l!==ht.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${r}" for selected key-system ${l}`);return}let d;try{const x=Ct(new Uint8Array(s)),y=$h(JSON.parse(x).sinf),E=by(y);if(!E)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(E.subarray(8,24))}catch(x){this.warn(`${i} Failed to parse sinf: ${x}`);return}const u=Ut(d),{keyIdToKeySessionPromise:h,mediaKeySessions:p}=this;let g=h[u];for(let x=0;x<p.length;x++){const y=p[x],E=y.decryptdata;if(!E.keyId)continue;const w=Ut(E.keyId);if(yc(d,E.keyId)||E.uri.replace(/-/g,"").indexOf(u)!==-1){if(g=h[w],!g)continue;if(E.pssh)break;delete h[w],E.pssh=new Uint8Array(s),E.keyId=d,g=h[u]=g.then(()=>this.generateRequestWithPreferredKeySession(y,r,s,"encrypted-event-key-match")),g.catch(S=>this.handleError(S));break}}g||this.handleError(new Error(`Key ID ${u} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(a=>this.handleError(a))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(C.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(C.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,s=t?.[e];if(s)return s.licenseUrl;if(e===ht.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t?.[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(a,l,d)=>!!a&&d.indexOf(a)===l,s=t.map(a=>a.audioCodec).filter(r),i=t.map(a=>a.videoCodec).filter(r);return s.length+i.length===0&&i.push("avc1.42e01e"),new Promise((a,l)=>{const d=u=>{const h=u.shift();this.getMediaKeysPromise(h,s,i).then(p=>a({keySystem:h,mediaKeys:p})).catch(p=>{u.length?d(u):p instanceof dr?l(p):l(new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return Uy===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,t)}getMediaKeysPromise(e,t,r){var s;const i=Ck(e,t,r,this.config.drmSystemOptions||{});let a=this.keySystemAccessPromises[e],l=(s=a)==null?void 0:s.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${tt(i)}`),l=this.requestMediaKeySystemAccess(e,i);const d=a=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),l.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const h=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const p=d.mediaKeys=u.createMediaKeys().then(g=>(this.log(`Media-keys created for "${e}"`),d.hasMediaKeys=!0,h.then(x=>x?this.setMediaKeysServerCertificate(g,e,x):g)));return p.catch(g=>{this.error(`Failed to create media-keys for "${e}"}: ${g}`)}),p})}return l.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Ut(e.keyId||[])} keyUri: ${e.uri}`);const s=r.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),s=$l(t),i="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,i,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${Ut(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>sf(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const i=sf(s);i?t(i):r(new Error(`Unable to find format for key-system "${s}"`))}).catch(r)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Ga(this.config),r=e.map(sc).filter(s=>!!s&&t.indexOf(s)!==-1);return this.selectKeySystem(r)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let r=0;r<t.length;r++){const s=WI(e,t[r]);if(s)return s}}loadKey(e){const t=e.keyInfo.decryptdata,r=$l(t),s=this.bannedKeyIds[r];if(s||this.getKeyStatus(t)==="internal-error"){const l=bx(s||"internal-error",t);return this.handleError(l,e.frag),Promise.reject(l)}const i=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);const a=this.keyIdToKeySessionPromise[r];if(!a){const l=this.getKeySystemForKeyPromise(t).then(({keySystem:d,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(d,u).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:d,mediaKeys:u,decryptdata:t}))))).then(d=>{const u="cenc",h=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(d,u,h,"playlist-key")});return l.catch(d=>this.handleError(d,e.frag)),this.keyIdToKeySessionPromise[r]=l,l}return a.catch(l=>{if(l instanceof dr){const d=Ye({},l.data);this.getKeyStatus(t)==="internal-error"&&(d.decryptdata=t);const u=new dr(d,l.message);this.handleError(u,e.frag)}}),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof dr){t&&(e.data.frag=t);const r=e.data.decryptdata;this.error(`${e.message}${r?` (${Ut(r.keyId||[])})`:""}`),this.hls.trigger(C.ERROR,e.data)}else this.error(e.message),this.hls.trigger(C.ERROR,{type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=$l(e),r=this.keyIdToKeySessionPromise[t];if(!r){const s=sc(e.keyFormat),i=s?[s]:Ga(this.config);return this.attemptKeySystemAccess(i)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=Ga(this.config)),e.length===0)throw new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${tt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>this.media?this.media.setMediaKeys(t):new Promise((i,a)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return a(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(i).catch(a)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(i=>r.indexOf(i)===-1)})}generateRequestWithPreferredKeySession(e,t,r,s){var i;const a=(i=this.config.drmSystems)==null||(i=i[e.keySystem])==null?void 0:i.generateRequest;if(a)try{const y=a.call(this.hls,t,r,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,r=y.initData?y.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=$l(e.decryptdata),d=e.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${l} URI: ${d} (init data type: ${t} length: ${r.byteLength})`);const u=new Gh,h=e._onmessage=y=>{const E=e.mediaKeysSession;if(!E){u.emit("error",new Error("invalid state"));return}const{messageType:w,message:S}=y;this.log(`"${w}" message event for session "${E.sessionId}" message size: ${S.byteLength}`),w==="license-request"||w==="license-renewal"?this.renewLicense(e,S).catch(T=>{u.eventNames().length?u.emit("error",T):this.handleError(T)}):w==="license-release"?e.keySystem===ht.FAIRPLAY&&this.updateKeySession(e,rh("acknowledged")).then(()=>this.removeSession(e)).catch(T=>this.handleError(T)):this.warn(`unhandled media key message type "${w}"`)},p=(y,E)=>{E.keyStatus=y;let w;y.startsWith("usable")?u.emit("resolved"):y==="internal-error"||y==="output-restricted"||y==="output-downscaled"?w=bx(y,E.decryptdata):y==="expired"?w=new Error(`key expired (keyId: ${l})`):y==="released"?w=new Error("key released"):y==="status-pending"||this.warn(`unhandled key status change "${y}" (keyId: ${l})`),w&&(u.eventNames().length?u.emit("error",w):this.handleError(w))},g=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}const w=this.getKeyStatuses(e);if(!Object.keys(w).some(I=>w[I]!=="status-pending"))return;if(w[l]==="expired"){this.log(`Expired key ${tt(w)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let T=w[l];if(T)p(T,e);else{var k;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(k=e.keyStatusTimeouts)[l]||(k[l]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const L=this.getKeyStatus(e.decryptdata);if(L&&L!=="status-pending")return this.log(`No status for keyId ${l} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${L} from other session.`),p(L,e);this.log(`key status for ${l} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),T="internal-error",p(T,e)},1e3)),this.log(`No status for keyId ${l} (${tt(w)}).`)}};Qt(e.mediaKeysSession,"message",h),Qt(e.mediaKeysSession,"keystatuseschange",g);const x=new Promise((y,E)=>{u.on("error",E),u.on("resolved",y)});return e.mediaKeysSession.generateRequest(t,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l} URI: ${d}`)}).catch(y=>{throw new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>x).catch(y=>(u.removeAllListeners(),this.removeSession(e).then(()=>{throw y}))).then(()=>(u.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((r,s)=>{if(typeof s=="string"&&typeof r=="object"){const l=s;s=r,r=l}const i="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);if(e.keySystem===ht.PLAYREADY&&i.length===16){const l=Ut(i);t[l]=r,My(i)}const a=Ut(i);r==="internal-error"&&(this.bannedKeyIds[a]=r),this.log(`key status change "${r}" for keyStatuses keyId: ${a} key-session "${e.mediaKeysSession.sessionId}"`),t[a]=r}),t}fetchServerCertificate(e){const t=this.config,r=t.loader,s=new r(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,l)=>{const d={responseType:"arraybuffer",url:i},u=t.certLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,x,y,E)=>{a(g.data)},onError:(g,x,y,E)=>{l(new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:Ye({url:d.url,data:void 0},g)},`"${e}" certificate request failed (${i}). Status: ${g.code} (${g.text})`))},onTimeout:(g,x,y)=>{l(new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(g,x,y)=>{l(new Error("aborted"))}};s.load(d,h,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((s,i)=>{e.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r.byteLength}) on "${t}"`),s(e)}).catch(a=>{i(new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(r,"application/xml"),i=s.querySelectorAll("HttpHeader");if(i.length>0){let h;for(let p=0,g=i.length;p<g;p++){var a,l;h=i[p];const x=(a=h.querySelector("name"))==null?void 0:a.textContent,y=(l=h.querySelector("value"))==null?void 0:l.textContent;x&&y&&e.setRequestHeader(x,y)}}const d=s.querySelector("Challenge"),u=d?.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return rh(atob(u))}setupLicenseXHR(e,t,r,s){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,r,s)}).catch(a=>{if(!r.decryptdata)throw a;return e.open("POST",t,!0),i.call(this.hls,e,t,r,s)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((s,i)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let d=l.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const u=this.config.licenseResponseCallback;if(u)try{d=u.call(this.hls,l,a,e)}catch(h){this.error(h)}s(d)}else{const d=r.errorRetry,u=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500)i(new dr({type:Te.KEY_SYSTEM_ERROR,details:q.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:a,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${a}). Status: ${l.status} (${l.statusText})`));else{const h=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(s,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,a,e,t).then(({xhr:d,licenseChallenge:u})=>{e.keySystem==ht.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(d,u)),d.send(u)}).catch(i)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,Qt(r,"encrypted",this.onMediaEncrypted),Qt(r,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=r.mediaKeys}onMediaDetached(){const e=this.media;e&&(ir(e,"encrypted",this.onMediaEncrypted),ir(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const r=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,us.clearKeyUriToKeyIdMap();const i=s.length;Di.CDMCleanupPromise=Promise.all(s.map(a=>this.removeSession(a)).concat((r==null||(e=r.setMediaKeys(null))==null?void 0:e.catch(a=>{this.log(`Could not clear media keys: ${a}`),this.hls&&this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))||Promise.resolve())).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`),this.hls&&this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((s,i)=>(s.indexOf(i.keyFormat)===-1&&s.push(i.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r,decryptdata:s}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Ut(s?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{keyStatusTimeouts:a}=e;a&&Object.keys(a).forEach(u=>self.clearTimeout(a[u]));const{drmSystemOptions:l}=this.config;return(Ak(l)?new Promise((u,h)=>{self.setTimeout(()=>h(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(u).catch(h)}):Promise.resolve()).catch(u=>{this.log(`Could not remove session: ${u}`),this.hls&&this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${u}`)})}).then(()=>t.close()).catch(u=>{this.log(`Could not close session: ${u}`),this.hls&&this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${u}`)})})}return Promise.resolve()}}Di.CDMCleanupPromise=void 0;function $l(n){if(!n)throw new Error("Could not read keyId of undefined decryptdata");if(n.keyId===null)throw new Error("keyId is null");return Ut(n.keyId)}function WI(n,e){if(n.keyId&&e.mediaKeysSession.keyStatuses.has(n.keyId))return e.mediaKeysSession.keyStatuses.get(n.keyId);if(n.matches(e.decryptdata))return e.keyStatus}class dr extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function bx(n,e){const t=n==="output-restricted",r=t?q.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:q.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new dr({type:Te.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${n}"`)}class YI{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const s=performance.now();if(t){if(this.lastTime){const i=s-this.lastTime,a=r-this.lastDroppedFrames,l=t-this.lastDecodedFrames,d=1e3*a/i,u=this.hls;if(u.trigger(C.FPS_DROP,{currentDropped:a,currentDecoded:l,totalDroppedFrames:r}),d>0&&a>u.config.fpsDroppedMonitoringThreshold*l){let h=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=h)&&(h=h-1,u.trigger(C.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:u.currentLevel}),u.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function A1(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function L1(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){Qe.debug(`[texttrack-utils]: ${r}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,n.addCue(s)}catch(s){Qe.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(n.mode=t)}function Li(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues)for(let r=n.cues.length;r--;)e&&n.cues[r].removeEventListener("enter",e),n.removeCue(n.cues[r]);t==="disabled"&&(n.mode=t)}function dh(n,e,t,r){const s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const i=XI(n.cues,e,t);for(let a=0;a<i.length;a++)(!r||r(i[a]))&&n.removeCue(i[a])}s==="disabled"&&(n.mode=s)}function QI(n,e){if(e<=n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,s=t,i;for(;r<=s;)if(i=Math.floor((s+r)/2),e<n[i].startTime)s=i-1;else if(e>n[i].startTime&&r<t)r=i+1;else return i;return n[r].startTime-e<e-n[s].startTime?r:s}function XI(n,e,t){const r=[],s=QI(n,e);if(s>-1)for(let i=s,a=n.length;i<a;i++){const l=n[i];if(l.startTime>=e&&l.endTime<=t)r.push(l);else if(l.startTime>t)return r}return r}function lc(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class ZI extends Qh{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=lc(this.media.textTracks);for(let i=0;i<r.length;i++)if(r[i].mode==="hidden")t=r[i];else if(r[i].mode==="showing"){t=r[i];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;lc(r.textTracks).forEach(a=>{Li(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==s){this.warn(`Subtitle track with id:${r} and group:${s} not found in active group ${a?.groupId}`);return}const l=a.details;a.details=t.details,this.log(`Subtitle track ${r} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(a=>s?.indexOf(a)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(h=>!r||r.indexOf(h.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(h=>h.default)&&(this.selectDefaultTrack=!1),a.forEach((h,p)=>{h.id=p});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.subtitlePreference;if(!i&&l){this.selectDefaultTrack=!1;const h=en(l,a);if(h>-1)i=a[h];else{const p=en(l,this.tracks);i=this.tracks[p]}}let d=this.findTrackId(i);d===-1&&i&&(d=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${r?.join(",")}" group-id`),this.hls.trigger(C.SUBTITLE_TRACKS_UPDATED,u),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const i=t[s];if(!(r&&!i.default||!r&&!e)&&(!e||Us(i,e)))return s}if(e){for(let s=0;s<t.length;s++){const i=t[s];if(ao(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const i=t[s];if(ao(e.attrs,i.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(oh(s,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Be.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&Us(e,r))return r;const s=en(e,this.tracksInGroup);if(s>-1){const i=this.tracksInGroup[s];return this.setSubtitleTrack(s),i}else{if(r)return null;{const i=en(e,t);if(i>-1)return t[i]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),a=e.details,l=a?.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(C.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=lc(e.textTracks),r=this.currentTrack;let s;if(r&&(s=t.filter(i=>oh(r,i))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(i=>{i.mode!=="disabled"&&i!==s&&(i.mode="disabled")}),s){const i=this.subtitleDisplay?"showing":"hidden";s.mode!==i&&(s.mode=i)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!xe(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:e});return}const i=!!s.details&&!s.details.live;if(e===this.trackId&&s===r&&i)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:a,groupId:l="",name:d,type:u,url:h}=s;this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:a,groupId:l,name:d,type:u,url:h});const p=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(p)}}function JI(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?i:i&3|8).toString(16)})}}}function za(n){let e=5381,t=n.length;for(;t;)e=e*33^n.charCodeAt(--t);return(e>>>0).toString()}const Pi=.025;let Sc=(function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n})({});function eA(n,e,t){return`${n.identifier}-${t+1}-${za(e)}`}class tA{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return mf(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=mf(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=xe(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return mf(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Pi))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Sc.Range:Sc.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return rA(this)}}function mf(n,e){return n-e.start<e.duration/2&&!(Math.abs(n-(e.start+e.duration))<Pi)?e.start:e.start+e.duration}function R1(n,e,t){const r=new self.URL(n,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function pf(n,e){for(;(t=n.assetList[++e])!=null&&t.error;)var t;return e}function rA(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function Ci(n){const e=n.timelineStart,t=n.duration||0;return`["${n.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class nA{constructor(e,t,r,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(C.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new e(t);this.interstitial=r,this.assetItem=s;const a=()=>{this.hasDetails=!0};i.once(C.LEVEL_LOADED,a),i.once(C.AUDIO_TRACK_LOADED,a),i.once(C.SUBTITLE_TRACK_LOADED,a),i.on(C.MEDIA_ATTACHING,(l,{media:d})=>{this.removeMediaListeners(),this.mediaAttached=d,this.interstitial.playoutLimit&&(d.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(C.BUFFER_APPENDED,()=>{const h=this.bufferedEnd;this.reachedPlayout(h)&&(this._bufferedEosTime=h,i.trigger(C.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=R1(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,i=Oe.bufferInfo(e,s,0);return this.getAssetTime(i.end)>=r-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Oe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const r=t-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){var s;(s=this.hls)==null||s.on(e,t)}once(e,t,r){var s;(s=this.hls)==null||s.once(e,t)}off(e,t,r){var s;(s=this.hls)==null||s.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Ci(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const Sx=.033;class sA extends kr{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(i=s[r])!=null&&i.event;){var i;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let s=0;s<r.length;s++){let i=r[s];if(t&&t!=="primary"&&(i=i[t]),e===i.start||e>i.start&&e<i.end)return s}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let s=e;s<=t&&r[s];s++){const i=r[s].event;if(i!=null&&i.restrictions.jump&&!i.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var r;if(((r=t[s].event)==null?void 0:r.identifier)===e)return s}return-1}findAssetIndex(e,t){const r=e.assetList,s=r.length;if(s>1)for(let i=0;i<s;i++){const a=r[i];if(!a.error){const l=a.timelineStart;if(t===l||t>l&&(t<l+(a.duration||0)||i===s-1))return i}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const r=t.assetList,s=r[r.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:s}=r,i=this.events,a=this.parseDateRanges(s,{url:r.url},t),l=Object.keys(s),d=i?i.filter(u=>!l.includes(u.identifier)):[];a.length&&a.sort((u,h)=>{const p=u.cue.pre,g=u.cue.post,x=h.cue.pre,y=h.cue.post;if(p&&!x)return-1;if(x&&!p||g&&!y)return 1;if(y&&!g)return-1;if(!p&&!x&&!g&&!y){const E=u.startTime,w=h.startTime;if(E!==w)return E-w}return u.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=a,d.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,d)}updateSchedule(e,t=[],r=!1){const s=this.events||[];if(s.length||t.length||this.length<2){const i=this.items,a=this.parseSchedule(s,e);(r||t.length||i?.length!==a.length||a.some((d,u)=>Math.abs(d.playout.start-i[u].playout.start)>.005||Math.abs(d.playout.end-i[u].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,r){const s=[],i=Object.keys(e);for(let a=0;a<i.length;a++){const l=i[a],d=e[l];if(d.isInterstitial){let u=this.eventMap[l];u?u.setDateRange(d):(u=new tA(d,t),this.eventMap[l]=u,r===!1&&(u.appendInPlace=r)),s.push(u)}}return s}parseSchedule(e,t){const r=[],s=t.main.details,i=s.live?1/0:s.edge;let a=0;if(e=e.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),e.length){this.resolveOffsets(e,t);let d=0,u=0;if(e.forEach((h,p)=>{const g=h.cue.pre,x=h.cue.post,y=e[p-1]||null,E=h.appendInPlace,w=x?i:h.startOffset,S=h.duration,T=h.timelineOccupancy===Sc.Range?S:0,k=h.resumptionOffset,I=y?.startTime===w,L=w+h.cumulativeDuration;let O=E?L+S:w+k;if(g||!x&&w<=0){const j=u;u+=T,h.timelineStart=L;const F=a;a+=S,r.push({event:h,start:L,end:O,playout:{start:F,end:a},integrated:{start:j,end:u}})}else if(w<=i){if(!I){const D=w-d;if(D>Sx){const $=d,J=u;u+=D;const ne=a;a+=D;const se={previousEvent:e[p-1]||null,nextEvent:h,start:$,end:$+D,playout:{start:ne,end:a},integrated:{start:J,end:u}};r.push(se)}else D>0&&y&&(y.cumulativeDuration+=D,r[r.length-1].end=w)}x&&(O=L),h.timelineStart=L;const j=u;u+=T;const F=a;a+=S,r.push({event:h,start:L,end:O,playout:{start:F,end:a},integrated:{start:j,end:u}})}else return;const P=h.resumeTime;x||P>i?d=i:d=P}),d<i){var l;const h=d,p=u,g=i-d;u+=g;const x=a;a+=g,r.push({previousEvent:((l=r[r.length-1])==null?void 0:l.event)||null,nextEvent:null,start:d,end:h+g,playout:{start:x,end:a},integrated:{start:p,end:u}})}this.setDurations(i,a,u)}else r.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,s=r.live?1/0:r.edge;let i=0,a=-1;e.forEach((l,d)=>{const u=l.cue.pre,h=l.cue.post,p=u?0:h?s:l.startTime;this.updateAssetDurations(l),a===p?l.cumulativeDuration=i:(i=0,a=p),!h&&l.snapOptions.in&&(l.resumeAnchor=Gs(null,r.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),l.appendInPlace&&!l.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(l,t)||(l.appendInPlace=!1)),!l.appendInPlace&&d+1<e.length&&e[d+1].startTime-e[d].resumeTime<Sx&&(e[d+1].appendInPlace=!1,e[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));const x=xe(l.resumeOffset)?l.resumeOffset:l.duration;i+=x})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(r-s)>Pi?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${s}`),!1):!Object.keys(t).some(a=>{const l=t[a].details,d=l.edge;if(r>=d)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${d}`),!1;const u=Gs(null,l.fragments,r);if(!u)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${l.fragStart}-${l.fragmentEnd})`),!0;const h=a==="audio"?.175:0;return Math.abs(u.start-r)<Pi+h||Math.abs(u.end-r)<Pi+h?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,s=!1,i=!1;for(let a=0;a<e.assetList.length;a++){const l=e.assetList[a],d=t+r;l.startOffset=r,l.timelineStart=d,s||(s=l.duration===null),i||(i=!!l.error);const u=l.error?0:l.duration||0;r+=u}s&&!i?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Mr(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class iA{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let s;try{s=R1(r,this.hls.sessionId,e.baseUrl)}catch(g){const x=this.assignAssetListError(e,q.ASSET_LIST_LOAD_ERROR,g,r);this.hls.trigger(C.ERROR,x);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const i=this.hls.config,a=i.loader,l=new a(i),d={responseType:"json",url:s.href},u=i.interstitialAssetListLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,x,y,E)=>{const w=g.data,S=w?.ASSETS;if(!Array.isArray(S)){const T=this.assignAssetListError(e,q.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,x,E);this.hls.trigger(C.ERROR,T);return}e.assetListResponse=w,this.hls.trigger(C.ASSET_LIST_LOADED,{event:e,assetListResponse:w,networkDetails:E})},onError:(g,x,y,E)=>{const w=this.assignAssetListError(e,q.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${g.code} ${g.text} (${x.url})`),x.url,E,y);this.hls.trigger(C.ERROR,w)},onTimeout:(g,x,y)=>{const E=this.assignAssetListError(e,q.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${x.url})`),x.url,g,y);this.hls.trigger(C.ERROR,E)}};return l.load(d,h,p),this.hls.trigger(C.ASSET_LIST_LOADING,{event:e}),l}assignAssetListError(e,t,r,s,i,a){return e.error=r,{type:Te.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:r,networkDetails:a,stats:i}}}function Tx(n){var e;n==null||(e=n.play())==null||e.catch(()=>{})}function Vl(n,e){return`[${n}] Advancing timeline position to ${e}`}class aA extends kr{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled||!this.schedule)return;const s=r-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const a=s<=-.01;this.timelinePos=r,this.bufferedPos=r;const l=this.playingItem;if(!l){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(r,r-s)&&this.updateSchedule(!0),this.checkBuffer(),a&&r<l.start||r>=l.end){var d;const x=this.findItemIndex(l);let y=this.schedule.findItemIndexAtTime(r);if(y===-1&&(y=x+(a?-1:1),this.log(`seeked ${a?"back ":""}to position not covered by schedule ${r} (resolving from ${x} to ${y})`)),!this.isInterstitial(l)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!a&&y>x){const E=this.schedule.findJumpRestrictedIndex(x+1,y);if(E>x){this.setSchedulePosition(E);return}}this.setSchedulePosition(y);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(l)){const x=l.event.assetList[0];x&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,x))}return}const h=u.timelineStart,p=u.duration||0;if(a&&r<h||r>=h+p){var g;(g=l.event)!=null&&g.appendInPlace&&(this.clearAssetPlayers(l.event,l),this.flushFrontBuffer(r)),this.setScheduleToAssetAtTime(r,u)}},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(r>=s.end){this.timelinePos=s.end;const l=this.findItemIndex(s);this.setSchedulePosition(l+1)}const i=this.playingAsset;if(!i)return;const a=i.timelineStart+(i.duration||0);r>=a&&this.setScheduleToAssetAtTime(r,i)},this.onScheduleUpdate=(r,s)=>{const i=this.schedule;if(!i)return;const a=this.playingItem,l=i.events||[],d=i.items||[],u=i.durations,h=r.map(E=>E.identifier),p=!!(l.length||h.length);(p||s)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${d.map(E=>Mr(E))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`);let g=null,x=null;a&&(g=this.updateItem(a,this.timelinePos),this.itemsMatch(a,g)?this.playingItem=g:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y&&(x=this.updateItem(y,this.bufferedPos),this.itemsMatch(y,x)?this.bufferingItem=x:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))),r.forEach(E=>{E.assetList.forEach(w=>{this.clearAssetPlayer(w.identifier,null)})}),this.playerQueue.forEach(E=>{if(E.interstitial.appendInPlace){const w=E.assetItem.timelineStart,S=E.timelineOffset-w;if(S)try{E.timelineOffset=w}catch(T){Math.abs(S)>Pi&&this.warn(`${T} ("${E.assetId}" ${E.timelineOffset}->${w})`)}}}),p||s){if(this.hls.trigger(C.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:d.slice(0),durations:u,removedIds:h}),this.isInterstitial(a)&&h.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}a&&this.trimInPlace(g,a),y&&x!==g&&this.trimInPlace(x,y),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new iA(e),this.schedule=new sA(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(C.MEDIA_ENDED,this.onMediaEnded,this),e.on(C.ERROR,this.onError,this),e.on(C.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(C.MEDIA_ENDED,this.onMediaEnded,this),e.off(C.ERROR,this.onError,this),e.off(C.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){ir(e,"play",this.onPlay),ir(e,"pause",this.onPause),ir(e,"seeking",this.onSeeking),ir(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;Qt(r,"seeking",this.onSeeking),Qt(r,"timeupdate",this.onTimeupdate),Qt(r,"play",this.onPlay),Qt(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!s){this.clearScheduleState();const i=this.findItemIndex(r);this.setSchedulePosition(i)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(this.media=null,!r&&(s&&this.removeMediaListeners(s),this.detachedData)){const i=this.getBufferingPlayer();i&&(this.log(`Removing schedule state for detachedData and ${i}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=p=>p&&e.getAssetPlayer(p.identifier),s=(p,g,x,y,E)=>{if(p){let w=p[g].start;const S=p.event;if(S){if(g==="playout"||S.timelineOccupancy!==Sc.Point){const T=r(x);T?.interstitial===S&&(w+=T.assetItem.startOffset+T[E])}}else{const T=y==="bufferedPos"?a():e[y];w+=T-p.start}return w}return 0},i=(p,g)=>{var x;if(p!==0&&g!=="primary"&&(x=e.schedule)!=null&&x.length){var y;const E=e.schedule.findItemIndexAtTime(p),w=(y=e.schedule.items)==null?void 0:y[E];if(w){const S=w[g].start-w.start;return p+S}}return p},a=()=>{const p=e.bufferedPos;return p===Number.MAX_VALUE?l("primary"):Math.max(p,0)},l=p=>{var g,x;return(g=e.primaryDetails)!=null&&g.live?e.primaryDetails.edge:((x=e.schedule)==null?void 0:x.durations[p])||0},d=(p,g)=>{var x,y;const E=e.effectivePlayingItem;if(E!=null&&(x=E.event)!=null&&x.restrictions.skip||!e.schedule)return;e.log(`seek to ${p} "${g}"`);const w=e.effectivePlayingItem,S=e.schedule.findItemIndexAtTime(p,g),T=(y=e.schedule.items)==null?void 0:y[S],k=e.getBufferingPlayer(),I=k?.interstitial,L=I?.appendInPlace,O=w&&e.itemsMatch(w,T);if(w&&(L||O)){const P=r(e.playingAsset),j=P?.media||e.primaryMedia;if(j){const F=g==="primary"?j.currentTime:s(w,g,e.playingAsset,"timelinePos","currentTime"),D=p-F,$=(L?F:j.currentTime)+D;if($>=0&&(!P||L||$<=P.duration)){j.currentTime=$;return}}}if(T){let P=p;if(g!=="primary"){const F=T[g].start,D=p-F;P=T.start+D}const j=!e.isInterstitial(T);if((!e.isInterstitial(w)||w.event.appendInPlace)&&(j||T.event.appendInPlace)){const F=e.media||(L?k?.media:null);F&&(F.currentTime=P)}else if(w){const F=e.findItemIndex(w);if(S>F){const $=e.schedule.findJumpRestrictedIndex(F+1,S);if($>F){e.setSchedulePosition($);return}}let D=0;if(j)e.timelinePos=P,e.checkBuffer();else{const $=T.event.assetList,J=p-(T[g]||T).start;for(let ne=$.length;ne--;){const se=$[ne];if(se.duration&&J>=se.startOffset&&J<se.startOffset+se.duration){D=ne;break}}}e.setSchedulePosition(S,D)}}},u=()=>{const p=e.effectivePlayingItem;if(e.isInterstitial(p))return p;const g=t();return e.isInterstitial(g)?g:null},h={get bufferedEnd(){const p=t(),g=e.bufferingItem;if(g&&g===p){var x;return s(g,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-g.playout.start||((x=e.bufferingAsset)==null?void 0:x.startOffset)||0}return 0},get currentTime(){const p=u(),g=e.effectivePlayingItem;return g&&g===p?s(g,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-g.playout.start:0},set currentTime(p){const g=u(),x=e.effectivePlayingItem;x&&x===g&&d(p+x.playout.start,"playout")},get duration(){const p=u();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const g=(p=u())==null?void 0:p.event.assetList;return g?g.map(x=>e.getAssetPlayer(x.identifier)):[]},get playingIndex(){var p;const g=(p=u())==null?void 0:p.event;return g&&e.effectivePlayingAsset?g.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};return this.manager={get events(){var p;return((p=e.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=e.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return u()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const p=t();return e.findItemIndex(p)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const p=e.effectivePlayingItem;return e.findItemIndex(p)},primary:{get bufferedEnd(){return a()},get currentTime(){const p=e.timelinePos;return p>0?p:0},set currentTime(p){d(p,"primary")},get duration(){return l("primary")},get seekableStart(){var p;return((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){d(p,"integrated")},get duration(){return l("integrated")},get seekableStart(){var p;return i(((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=e.effectivePlayingItem,g=p?.event;if(g&&!g.restrictions.skip){const x=e.findItemIndex(p);if(g.appendInPlace){const y=p.playout.start+p.event.duration;d(y+.001,"playout")}else e.advanceAfterAssetEnded(g,x,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(s=this.primaryMedia);const i=(t=s)==null?void 0:t.currentTime;if(!(i===void 0||!xe(i)))return i}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,s=e.media;if(r&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${tt(i)}`),this.detachedData=i}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var r,s;if(e.media===t)return;let i=null;const a=this.hls,l=e!==a,d=l&&e.interstitial.appendInPlace,u=(r=this.detachedData)==null?void 0:r.mediaSource;let h;if(a.media)d&&(i=a.transferMedia(),this.detachedData=i),h="Primary";else if(u){const y=this.getBufferingPlayer();y?(i=y.transferMedia(),h=`${y}`):h="detached MediaSource"}else h="detached media";if(!i){if(u)i=this.detachedData,this.log(`using detachedData: MediaSource ${tt(i)}`);else if(!this.detachedData||a.media===t){const y=this.playerQueue;y.length>1&&y.forEach(E=>{if(l&&E.interstitial.appendInPlace!==d){const w=E.interstitial;this.clearInterstitial(E.interstitial,null),w.appendInPlace=!1,w.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${w}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const p=i&&"mediaSource"in i&&((s=i.mediaSource)==null?void 0:s.readyState)!=="closed",g=p&&i?i:t;this.log(`${p?"transfering MediaSource":"attaching media"} to ${l?e:"Primary"} from ${h} (media.currentTime: ${t.currentTime})`);const x=this.schedule;if(g===i&&x){const y=l&&e.assetId===x.assetIdAtEnd;g.overrides={duration:x.duration,endOfStream:!l||y,cueRemoval:!l}}e.attachMedia(g)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,s=this.effectivePlayingItem;if(r===-1){const i=this.hls.startPosition;if(this.log(Vl("checkStart",i)),this.timelinePos=i,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(i>=0||!this.primaryLive){const a=this.timelinePos=i>0?i:0,l=e.findItemIndexAtTime(a);this.setSchedulePosition(l)}}else if(s&&!this.playingItem){const i=e.findItemIndex(s);this.setSchedulePosition(i)}}advanceAssetBuffering(e,t){const r=e.event,s=r.findAssetIndex(t),i=pf(r,s);if(!r.isAssetPastPlayoutLimit(i))this.bufferedToEvent(e,i);else if(this.schedule){var a;const l=(a=this.schedule.items)==null?void 0:a[this.findItemIndex(e)+1];l&&this.bufferedToItem(l)}}advanceAfterAssetEnded(e,t,r){const s=pf(e,r);if(e.isAssetPastPlayoutLimit(s)){if(this.schedule){const i=this.schedule.items;if(i){const a=t+1,l=i.length;if(a>=l){this.setSchedulePosition(-1);return}const d=e.resumeTime;this.timelinePos<d&&(this.log(Vl("advanceAfterAssetEnded",d)),this.timelinePos=d,e.appendInPlace&&this.advanceInPlace(d),this.checkBuffer(this.bufferedPos<d)),this.setSchedulePosition(a)}}}else{if(e.appendInPlace){const i=e.assetList[s];i&&this.advanceInPlace(i.timelineStart)}this.setSchedulePosition(t,s)}}setScheduleToAssetAtTime(e,t){const r=this.schedule;if(!r)return;const s=t.parentIdentifier,i=r.getEvent(s);if(i){const a=r.findEventIndex(s),l=r.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,a,l-1)}}setSchedulePosition(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(!s||this.playbackDisabled)return;const i=e>=0?s[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${i&&Mr(i)}) pos: ${this.timelinePos}`);const a=this.waitingItem||this.playingItem,l=this.playingLastItem;if(this.isInterstitial(a)){const h=a.event,p=this.playingAsset,g=p?.identifier,x=g?this.getAssetPlayer(g):null;if(x&&g&&(!this.eventItemsMatch(a,i)||t!==void 0&&g!==h.assetList[t].identifier)){var d;const y=h.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${h.assetList.length} ${Ci(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(C.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:y,event:h,schedule:s.slice(0),scheduleIndex:e,player:x}),a!==this.playingItem){this.itemsMatch(a,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(h,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(g,i),x.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&x.detachMedia()}if(!this.eventItemsMatch(a,i)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${h} ${Mr(a)}`),h.hasPlayed=!0,this.hls.trigger(C.INTERSTITIAL_ENDED,{event:h,schedule:s.slice(0),scheduleIndex:e}),h.cue.once)){var u;this.updateSchedule();const y=(u=this.schedule)==null?void 0:u.items;if(i&&y){const E=this.findItemIndex(i);this.advanceSchedule(E,y,t,a,l)}return}}this.advanceSchedule(e,s,t,a,l)}advanceSchedule(e,t,r,s,i){const a=this.schedule;if(!a)return;const l=t[e]||null,d=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach(h=>{const p=h.interstitial,g=a.findEventIndex(p.identifier);(g<e||g>e+1)&&this.clearInterstitial(p,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);const h=l.event;if(r===void 0){r=a.findAssetIndex(h,this.timelinePos);const y=pf(h,r-1);if(h.isAssetPastPlayoutLimit(y)||h.appendInPlace&&this.timelinePos===l.end){this.advanceAfterAssetEnded(h,e,r);return}r=y}const p=this.waitingItem;this.assetsBuffered(l,d)||this.setBufferingItem(l);let g=this.preloadAssets(h,r);if(this.eventItemsMatch(l,p||s)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${Mr(l)} ${h.appendInPlace?"append in place":""}`),this.hls.trigger(C.INTERSTITIAL_STARTED,{event:h,schedule:t.slice(0),scheduleIndex:e})),!h.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${h}`);return}if(h.assetListLoader&&(h.assetListLoader.destroy(),h.assetListLoader=void 0),!d){this.log(`Waiting for attachMedia to start Interstitial ${h}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;const x=h.assetList[r];if(!x){this.advanceAfterAssetEnded(h,e,r||0);return}if(g||(g=this.getAssetPlayer(x.identifier)),g===null||g.destroyed){const y=h.assetList.length;this.warn(`asset ${r+1}/${y} player destroyed ${h}`),g=this.createAssetPlayer(h,x,r),g.loadSource()}if(!this.eventItemsMatch(l,this.bufferingItem)&&h.appendInPlace&&this.isAssetBuffered(x))return;this.startAssetPlayer(g,r,t,e,d),this.shouldPlay&&Tx(g.media)}else l?(this.resumePrimary(l,e,s),this.shouldPlay&&Tx(this.hls.media)):i&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(a.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var s,i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Mr(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,t),this.log(Vl("resumePrimary",l)),this.timelinePos=l),this.attachPrimary(l,e)}if(!r)return;const a=(i=this.schedule)==null?void 0:i.items;a&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Mr(e)}`),this.hls.trigger(C.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(r<s.fragmentStart||r>s.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Oe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,s),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Vl("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((r=s.mainForwardBufferInfo)==null?void 0:r.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(C.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(C.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const r=this.hls.levels[t.level];if(!r.details)return;const s=Ye(Ye({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Ye(Ye({},this.altSelection),{},{audio:r});return}const i=Ye(Ye({},s),{},{audio:r});this.mediaSelection=i}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Ye(Ye({},this.altSelection),{},{subtitles:r});return}const i=Ye(Ye({},s),{},{subtitles:r});this.mediaSelection=i}onAudioTrackSwitching(e,t){const r=Dg(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(t)||s.setAudioOption(r)))}onSubtitleTrackSwitch(e,t){const r=Dg(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(t)||t.id!==-1&&s.setSubtitleOption(r)))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const i=t[s];if(i.cue.post){var r;const a=this.schedule.findEventIndex(i.identifier),l=(r=this.schedule.items)==null?void 0:r[a];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(e&&s){const i=this.findItemIndex(e,t);return s[i]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((i,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(i.identifier,null)});const r=e.end+.25,s=Oe.bufferInfo(this.primaryMedia,r,0);(s.end>r||(s.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${Mr(e)} (was ${Mr(t)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const r=this.mediaSelection;r&&((t=this.schedule)==null||t.updateSchedule(r,[],e))}checkBuffer(e){var t;const r=(t=this.schedule)==null?void 0:t.items;if(!r)return;const s=Oe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=s.len<1),this.updateBufferedPos(s.end,r,e)}updateBufferedPos(e,t,r){const s=this.schedule,i=this.bufferingItem;if(this.bufferedPos>e||!s)return;if(t.length===1&&this.itemsMatch(t[0],i)){this.bufferedPos=e;return}const a=this.playingItem,l=this.findItemIndex(a);let d=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var u;const h=this.findItemIndex(i),p=Math.min(h+1,t.length-1),g=t[p];if((d===-1&&i&&e>=i.end||(u=g.event)!=null&&u.appendInPlace&&e+.01>=g.start)&&(d=p),this.isInterstitial(i)){const x=i.event;if(p-l>1&&x.appendInPlace===!1||x.assetList.length===0&&x.assetListLoader)return}if(this.bufferedPos=e,d>h&&d>l)this.bufferedToItem(g);else{const x=this.primaryDetails;this.primaryLive&&x&&e>x.edge-x.targetduration&&g.start<x.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else r&&a&&!this.itemsMatch(a,i)&&(d===l?this.bufferedToItem(a):d===l+1&&this.bufferedToItem(t[d]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const i=this.getAssetPlayer(s.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,t)&&r){const{items:s,events:i}=r;if(!s||!i)return t;const a=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const d=l?l.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Mr(e)}`+(t?` (${d.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(a){const u=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((h,p)=>{const g=this.getAssetPlayer(h.identifier);g&&(p===u&&g.loadSource(),g.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering());this.hls.trigger(C.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,s=r.assetList.length===0&&!r.assetListLoader,i=r.cue.once;if(s||!i){const a=this.preloadAssets(r,t);if(a!=null&&a.interstitial.appendInPlace){const l=this.primaryMedia;l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,t){const r=e.assetUrl,s=e.assetList.length,i=s===0&&!e.assetListLoader,a=e.cue.once;if(i){const d=e.timelineStart;if(e.appendInPlace){var l;const g=this.playingItem;!this.isInterstitial(g)&&(g==null||(l=g.nextEvent)==null?void 0:l.identifier)===e.identifier&&this.flushFrontBuffer(d+.25)}let u,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const g=h-d;g>0&&(u=Math.round(g*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:s} ${e}${u?` live-start: ${h} start-offset: ${u}`:""}`),r)return this.createAsset(e,0,0,d,e.duration,r);const p=this.assetListLoader.loadAssetList(e,u);p&&(e.assetListLoader=p)}else if(!a&&s){for(let u=t;u<s;u++){const h=e.assetList[u],p=this.getAssetPlayerQueueIndex(h.identifier);(p===-1||this.playerQueue[p].destroyed)&&!h.error&&this.createAssetPlayer(e,h,u)}const d=e.assetList[t];if(d){const u=this.getAssetPlayer(d.identifier);return u&&u.loadSource(),u}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,s,i,a){const l={parentIdentifier:e.identifier,identifier:eA(e,a,t),duration:i,startOffset:r,timelineStart:s,uri:a};return this.createAssetPlayer(e,l,t)}createAssetPlayer(e,t,r){const s=this.hls,i=s.userConfig;let a=i.videoPreference;const l=s.loadLevelObj||s.levels[s.currentLevel];(a||l)&&(a=Ze({},a),l.videoCodec&&(a.videoCodec=l.videoCodec),l.videoRange&&(a.allowedVideoRanges=[l.videoRange]));const d=s.audioTracks[s.audioTrack],u=s.subtitleTracks[s.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const I=this.timelinePos-t.timelineStart;if(I>1){const L=t.duration;L&&I<L&&(h=I)}}const p=t.identifier,g=Ye(Ye({},i),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:d||i.audioPreference,subtitlePreference:u||i.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(g.timelineOffset=t.timelineStart));const x=g.cmcd;x!=null&&x.sessionId&&x.contentId&&(g.cmcd=Ze({},x,{contentId:za(t.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${e} and asset ${p}`);const y=new nA(this.HlsPlayerClass,g,e,t);this.playerQueue.push(y),e.assetList[r]=t;let E=!0;const w=I=>{if(I.live){var L;const j=new Error(`Interstitials MUST be VOD assets ${e}`),F={fatal:!0,type:Te.OTHER_ERROR,details:q.INTERSTITIAL_ASSET_ITEM_ERROR,error:j},D=((L=this.schedule)==null?void 0:L.findEventIndex(e.identifier))||-1;this.handleAssetItemError(F,e,D,r,j.message);return}const O=I.edge-I.fragmentStart,P=t.duration;(E||P===null||O>P)&&(E=!1,this.log(`Interstitial asset "${p}" duration change ${P} > ${O}`),t.duration=O,this.updateSchedule())};y.on(C.LEVEL_UPDATED,(I,{details:L})=>w(L)),y.on(C.LEVEL_PTS_UPDATED,(I,{details:L})=>w(L)),y.on(C.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const S=(I,L)=>{const O=this.getAssetPlayer(p);if(O&&L.tracks){O.off(C.BUFFER_CODECS,S),O.tracks=L.tracks;const P=this.primaryMedia;this.bufferingAsset===O.assetItem&&P&&!O.media&&this.bufferAssetPlayer(O,P)}};y.on(C.BUFFER_CODECS,S);const T=()=>{var I;const L=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${L}`),!L||!this.schedule)return;const O=this.schedule.findEventIndex(e.identifier),P=(I=this.schedule.items)==null?void 0:I[O];this.isInterstitial(P)&&this.advanceAssetBuffering(P,t)};y.on(C.BUFFERED_TO_END,T);const k=I=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const O=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,O,I)};return y.once(C.MEDIA_ENDED,k(r)),y.once(C.PLAYOUT_LIMIT_REACHED,k(1/0)),y.on(C.ERROR,(I,L)=>{if(!this.schedule)return;const O=this.getAssetPlayer(p);if(L.details===q.BUFFER_STALLED_ERROR){if(O!=null&&O.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(L,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${L.error} ${e}`)}),y.on(C.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const L=new Error(`Asset player destroyed unexpectedly ${p}`),O={fatal:!0,type:Te.OTHER_ERROR,details:q.INTERSTITIAL_ASSET_ITEM_ERROR,error:L};this.handleAssetItemError(O,e,this.schedule.findEventIndex(e.identifier),r,L.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Ci(t)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:y}),y}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){const s=this.playerQueue[r];this.log(`clear ${s} toSegment: ${t&&Mr(t)}`),this.transferMediaFromPlayer(s,t),this.playerQueue.splice(r,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,s,i){const{interstitial:a,assetItem:l,assetId:d}=e,u=a.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=l,(!h||h.identifier!==d)&&(h&&(this.clearAssetPlayer(h.identifier,r[s]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${u} ${Ci(l)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,i)}bufferAssetPlayer(e,t){var r,s;if(!this.schedule)return;const{interstitial:i,assetItem:a}=e,l=this.schedule.findEventIndex(i.identifier),d=(r=this.schedule.items)==null?void 0:r[l];if(!d)return;e.loadSource(),this.setBufferingItem(d),this.bufferingAsset=a;const u=this.getBufferingPlayer();if(u===e)return;const h=i.appendInPlace;if(h&&u?.interstitial.appendInPlace===!1)return;const p=u?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(h&&a!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(p&&!hy(p,e.tracks)){const g=new Error(`Asset ${Ci(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),x={fatal:!0,type:Te.OTHER_ERROR,details:q.INTERSTITIAL_ASSET_ITEM_ERROR,error:g},y=i.findAssetIndex(a);this.handleAssetItemError(x,i,l,y,g.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,r=this.primaryMedia;if(!t||!r)return;const s=r.currentTime,i=t.findAssetIndex(e,s),a=e.assetList[i];if(a){const l=this.getAssetPlayer(a.identifier);if(l){const d=l.currentTime||s-a.timelineStart,u=l.duration-d;if(this.warn(`Stalled at ${d} of ${d+u} in ${l} ${e} (media.currentTime: ${s})`),d&&(u/r.playbackRate<.5||l.bufferedInPlaceToEnd(r))&&l.hls){const h=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,h,i)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,r,s,i){if(e.details===q.BUFFER_STALLED_ERROR)return;const a=t.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&Ci(a)} ${e.error}`),!this.schedule)return;const l=a?.identifier||"",d=this.getAssetPlayerQueueIndex(l),u=this.playerQueue[d]||null,h=this.schedule.items,p=Ze({},e,{fatal:!1,errorAction:Ri(!0),asset:a,assetListIndex:s,event:t,schedule:h,scheduleIndex:r,player:u});if(this.hls.trigger(C.INTERSTITIAL_ASSET_ERROR,p),!e.fatal)return;const g=this.playingAsset,x=this.bufferingAsset,y=new Error(i);if(a&&(this.clearAssetPlayer(l,null),a.error=y),!t.assetList.some(E=>!E.error))t.error=y;else for(let E=s;E<t.assetList.length;E++)this.resetAssetPlayer(t.assetList[E].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):g&&g.identifier===l?this.advanceAfterAssetEnded(t,r,s):x&&x.identifier===l&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,x)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;let s=this.timelinePos;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${s} playing: ${Mr(r)} error: ${e.error}`),s===-1&&(s=this.hls.startPosition);const a=this.updateItem(r,s);this.itemsMatch(r,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(s===-1){this.checkStart();return}if(!this.schedule)return;const i=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(i)}onAssetListLoaded(e,t){var r,s;const i=t.event,a=i.identifier,l=t.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(a)))return;const d=i.timelineStart,u=i.duration;let h=0;l.forEach((E,w)=>{const S=parseFloat(E.DURATION);this.createAsset(i,w,h,d+h,S,E.URI),h+=S}),i.duration=h,this.log(`Loaded asset-list with duration: ${h} (was: ${u}) ${i}`);const p=this.waitingItem,g=p?.event.identifier===a;this.updateSchedule();const x=(s=this.bufferingItem)==null?void 0:s.event;if(g){var y;const E=this.schedule.findEventIndex(a),w=(y=this.schedule.items)==null?void 0:y[E];if(w){if(!this.playingItem&&this.timelinePos>w.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==E){i.error=new Error(`Interstitial ${l.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${i}`),this.log(i.error.message),this.updateSchedule(!0),this.primaryFallback(i);return}this.setBufferingItem(w)}this.setSchedulePosition(E)}else if(x?.identifier===a){const E=i.assetList[0];if(E){const w=this.getAssetPlayer(E.identifier);if(x.appendInPlace){const S=this.primaryMedia;w&&S&&this.bufferAssetPlayer(w,S)}else w&&w.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case q.ASSET_LIST_PARSING_ERROR:case q.ASSET_LIST_LOAD_ERROR:case q.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case q.BUFFER_STALLED_ERROR:{const r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const _x=500;class oA extends Vh{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",ye.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=te.IDLE,this.setInterval(_x),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:s}=t;if(this.fragContextChanged(r)||(wt(r)&&(this.fragPrevious=r),this.state=te.IDLE),!s)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let a;const l=r.start;for(let u=0;u<i.length;u++)if(l>=i[u].start&&l<=i[u].end){a=i[u];break}const d=r.start+r.duration;a?a.end=d:(a={start:l,end:d},i.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:s}=t;if(r===0&&s!==Number.POSITIVE_INFINITY){const i=s-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach(a=>{for(let l=0;l<a.length;){if(a[l].end<=i){a.shift();continue}else if(a[l].start<i)a[l].start=i;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(r,i,ye.SUBTITLE)}}onError(e,t){const r=t.frag;r?.type===ye.SUBTITLE&&(t.details===q.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==te.STOPPED&&(this.state=te.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&g1(this.levels,t)){this.levels=t.map(r=>new ro(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const s=new ro(r);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ye.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==te.STOPPED&&this.setInterval(_x)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:s,levels:i}=this,{details:a,id:l}=t;if(!i){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const d=i[l];if(l>=i.length||!d)return;this.log(`Subtitle track ${l} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(r=d.details)!=null&&r.live){if(a.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const g=p.fragments[0];if(!d.details)a.hasProgramDateTime&&p.hasProgramDateTime?(wc(a,p),u=a.fragmentStart):g&&(u=g.start,sh(a,u));else{var h;u=this.alignPlaylists(a,d.details,(h=this.levelLastLoaded)==null?void 0:h.details),u===0&&g&&(u=g.start,sh(a,u))}p&&!this.startFragRequested&&this.setStartPosition(p,u)}d.details=a,this.levelLastLoaded=d,l===s&&(this.hls.trigger(C.SUBTITLE_TRACK_UPDATED,{details:a,id:l,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===te.IDLE&&(Gs(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,s=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&s!=null&&s.key&&s.iv&&Ni(s.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(r),s.key.buffer,s.iv.buffer,Bh(s.method)).catch(l=>{throw i.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{const d=performance.now();i.trigger(C.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:a,tdecrypt:d}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=te.IDLE})}}doTick(){if(!this.media){this.state=te.IDLE;return}if(this.state===te.IDLE){const{currentTrackId:e,levels:t}=this,r=t?.[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:s}=this,i=this.getLoadPosition(),a=Oe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,s.maxBufferHole),{end:l,len:d}=a,u=r.details,h=this.hls.maxBufferLength+u.levelTargetDuration;if(d>h)return;const p=u.fragments,g=p.length,x=u.edge;let y=null;const E=this.fragPrevious;if(l<x){const T=s.maxFragLookUpTolerance,k=l>x-T?0:T;y=Gs(E,p,Math.max(p[0].start,l),k),!y&&E&&E.start<p[0].start&&(y=p[0])}else y=p[g-1];if(y=this.filterReplacedPrimary(y,r.details),!y)return;const w=y.sn-u.startSN,S=p[w-1];if(S&&S.cc===y.cc&&this.fragmentTracker.getState(S)===It.NOT_LOADED&&(y=S),this.fragmentTracker.getState(y)===It.NOT_LOADED){const T=this.mapToInitFragWhenRequired(y);T&&this.loadFragment(T,r,l)}}}loadFragment(e,t,r){wt(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new lA(this.tracksBuffered[this.currentTrackId]||[])}}class lA{constructor(e){this.buffered=void 0;const t=(r,s,i)=>{if(s=s>>>0,s>i-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${i})`);return e[s][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const cA={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},N1=n=>String.fromCharCode(cA[n]||n),Br=15,wn=100,uA={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},dA={17:2,18:4,21:6,22:8,23:10,19:13,20:15},fA={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},hA={25:2,26:4,29:6,30:8,31:10,27:13,28:15},mA=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class pA{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;Qe.log(`${this.time} [${e}] ${r}`)}}}const Ns=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class D1{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const s=t[r];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class gA{constructor(){this.uchar=" ",this.penState=new D1}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class xA{constructor(e){this.chars=[],this.pos=0,this.currPenState=new D1,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<wn;t++)this.chars.push(new gA);this.logger=e}equals(e){for(let t=0;t<wn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<wn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<wn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>wn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=wn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=N1(e);if(this.pos>=wn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<wn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<wn;r++){const s=this.chars[r].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class gf{constructor(e){this.rows=[],this.currRow=Br-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Br;t++)this.rows.push(new xA(e));this.logger=e}reset(){for(let e=0;e<Br;e++)this.rows[e].clear();this.currRow=Br-1}equals(e){let t=!0;for(let r=0;r<Br;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<Br;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Br;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+tt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<Br;l++)this.rows[l].clear();const i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const l=a.rows[i].cueStartTime,d=this.logger.time;if(l!==null&&d!==null&&l<d)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[i+u])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const i=e.indent,a=Math.max(i-1,0);r.setCursor(e.indent),e.color=r.chars[a].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+tt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",s=-1;for(let i=0;i<Br;i++){const a=this.rows[i].getTextString();a&&(s=i+1,e?t.push("Row "+s+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class kx{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new gf(r),this.nonDisplayedMemory=new gf(r),this.lastOutputScreen=new gf(r),this.currRollUpRow=this.displayedMemory.rows[Br-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Br-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[r]}this.logger.log(2,"MIDROW: "+tt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Cx{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=yA(),this.logger=void 0;const s=this.logger=new pA;this.channels=[null,new kx(e,t,s),new kx(e+1,r,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const s=t[r]&127,i=t[r+1]&127;let a=!1,l=null;if(s===0&&i===0)continue;this.logger.log(3,()=>"["+Ns([t[r],t[r+1]])+"] -> ("+Ns([s,i])+")");const d=this.cmdHistory;if(s>=16&&s<=31){if(vA(s,i,d)){Gl(null,null,d),this.logger.log(3,()=>"Repeated command ("+Ns([s,i])+") is dropped");continue}Gl(s,i,this.cmdHistory),a=this.parseCmd(s,i),a||(a=this.parseMidrow(s,i)),a||(a=this.parsePAC(s,i)),a||(a=this.parseBackgroundAttributes(s,i))}else Gl(null,null,d);if(!a&&(l=this.parseChars(s,i),l)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Ns([s,i])+" orig: "+Ns([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(r||s))return!1;const i=e===20||e===21||e===23?1:2,a=this.channels[i];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[r];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Ns([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(e===16||e===24)&&t>=64&&t<=95;if(!(s||i))return!1;const a=e<=23?1:2;t>=64&&t<=95?r=a===1?uA[e]:fA[e]:r=a===1?dA[e]:hA[e];const l=this.channels[a];return l?(l.setPAC(this.interpretPAC(r,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let r;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,s.underline=(r&1)===1,r<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((r-16)/2)*4,s}parseChars(e,t){let r,s=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19){let a;i===17?a=t+80:i===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+N1(a)+"' in channel "+r),s=[a]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+Ns(s).join(",")),s}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(r||s))return!1;let i;const a={};e===16||e===24?(i=Math.floor((t-32)/2),a.background=mA[i],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Gl(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function Gl(n,e,t){t.a=n,t.b=e}function vA(n,e,t){return t.a===n&&t.b===e}function yA(){return{a:null,b:null}}var e0=(function(){if(Ec!=null&&Ec.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(l,d){if(typeof d!="string"||!Array.isArray(l))return!1;const u=d.toLowerCase();return~l.indexOf(u)?u:!1}function r(l){return t(n,l)}function s(l){return t(e,l)}function i(l,...d){let u=1;for(;u<arguments.length;u++){const h=arguments[u];for(const p in h)l[p]=h[p]}return l}function a(l,d,u){const h=this,p={enumerable:!0};h.hasBeenReset=!1;let g="",x=!1,y=l,E=d,w=u,S=null,T="",k=!0,I="auto",L="start",O=50,P="middle",j=50,F="middle";Object.defineProperty(h,"id",i({},p,{get:function(){return g},set:function(D){g=""+D}})),Object.defineProperty(h,"pauseOnExit",i({},p,{get:function(){return x},set:function(D){x=!!D}})),Object.defineProperty(h,"startTime",i({},p,{get:function(){return y},set:function(D){if(typeof D!="number")throw new TypeError("Start time must be set to a number.");y=D,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",i({},p,{get:function(){return E},set:function(D){if(typeof D!="number")throw new TypeError("End time must be set to a number.");E=D,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",i({},p,{get:function(){return w},set:function(D){w=""+D,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",i({},p,{get:function(){return S},set:function(D){S=D,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",i({},p,{get:function(){return T},set:function(D){const $=r(D);if($===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=$,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",i({},p,{get:function(){return k},set:function(D){k=!!D,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",i({},p,{get:function(){return I},set:function(D){if(typeof D!="number"&&D!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");I=D,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",i({},p,{get:function(){return L},set:function(D){const $=s(D);if(!$)throw new SyntaxError("An invalid or illegal string was specified.");L=$,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",i({},p,{get:function(){return O},set:function(D){if(D<0||D>100)throw new Error("Position must be between 0 and 100.");O=D,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",i({},p,{get:function(){return P},set:function(D){const $=s(D);if(!$)throw new SyntaxError("An invalid or illegal string was specified.");P=$,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",i({},p,{get:function(){return j},set:function(D){if(D<0||D>100)throw new Error("Size must be between 0 and 100.");j=D,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",i({},p,{get:function(){return F},set:function(D){const $=s(D);if(!$)throw new SyntaxError("An invalid or illegal string was specified.");F=$,this.hasBeenReset=!0}})),h.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a})();class EA{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function P1(n){function e(r,s,i,a){return(r|0)*3600+(s|0)*60+(i|0)+parseFloat(a||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class wA{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let s=0;s<r.length;++s)if(t===r[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function O1(n,e,t,r){const s=r?n.split(r):[n];for(const i in s){if(typeof s[i]!="string")continue;const a=s[i].split(t);if(a.length!==2)continue;const l=a[0],d=a[1];e(l,d)}}const fh=new e0(0,0,""),Hl=fh.align==="middle"?"middle":"center";function bA(n,e,t){const r=n;function s(){const l=P1(n);if(l===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),l}function i(l,d){const u=new wA;O1(l,function(g,x){let y;switch(g){case"region":for(let E=t.length-1;E>=0;E--)if(t[E].id===x){u.set(g,t[E].region);break}break;case"vertical":u.alt(g,x,["rl","lr"]);break;case"line":y=x.split(","),u.integer(g,y[0]),u.percent(g,y[0])&&u.set("snapToLines",!1),u.alt(g,y[0],["auto"]),y.length===2&&u.alt("lineAlign",y[1],["start",Hl,"end"]);break;case"position":y=x.split(","),u.percent(g,y[0]),y.length===2&&u.alt("positionAlign",y[1],["start",Hl,"end","line-left","line-right","auto"]);break;case"size":u.percent(g,x);break;case"align":u.alt(g,x,["start",Hl,"end","left","right"]);break}},/:/,/\s/),d.region=u.get("region",null),d.vertical=u.get("vertical","");let h=u.get("line","auto");h==="auto"&&fh.line===-1&&(h=-1),d.line=h,d.lineAlign=u.get("lineAlign","start"),d.snapToLines=u.get("snapToLines",!0),d.size=u.get("size",100),d.align=u.get("align",Hl);let p=u.get("position","auto");p==="auto"&&fh.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function a(){n=n.replace(/^\s+/,"")}if(a(),e.startTime=s(),a(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),a(),e.endTime=s(),a(),i(n,e)}function j1(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class SA{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new EA,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let i=t.buffer,a=0;for(i=j1(i);a<i.length&&i[a]!=="\r"&&i[a]!==`
`;)++a;const l=i.slice(0,a);return i[a]==="\r"&&++a,i[a]===`
`&&++a,t.buffer=i.slice(a),l}function s(i){O1(i,function(a,l){},/:/)}try{let i="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;i=r();const l=i.match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:i=r(),t.state){case"HEADER":/:/.test(i)?s(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new e0(0,0,""),t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{bA(i,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const l=i.indexOf("-->")!==-1;if(!i||l&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=i}continue;case"BADCUE":i||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const TA=/\r\n|\n\r|\n|\r/g,xf=function(e,t,r=0){return e.slice(r,r+t.length)===t},_A=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!xe(t)||!xe(r)||!xe(s)||!xe(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*s,t+=3600*1e3*i,t};function t0(n,e,t){return za(n.toString())+za(e.toString())+za(t)}const kA=function(e,t,r){let s=e[t],i=e[s.prevCC];if(!i||!i.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(a=i)!=null&&a.new;){var a;e.ccOffset+=s.start-i.start,s.new=!1,s=i,i=e[s.prevCC]}e.presentationOffset=r};function CA(n,e,t,r,s,i,a){const l=new SA,d=pr(new Uint8Array(n)).trim().replace(TA,`
`).split(`
`),u=[],h=e?DC(e.baseTime,e.timescale):0;let p="00:00.000",g=0,x=0,y,E=!0;l.oncue=function(w){const S=t[r];let T=t.ccOffset;const k=(g-h)/9e4;if(S!=null&&S.new&&(x!==void 0?T=t.ccOffset=S.start:kA(t,r,k)),k){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}T=k-t.presentationOffset}const I=w.endTime-w.startTime,L=hr((w.startTime+T-x)*9e4,s*9e4)/9e4;w.startTime=Math.max(L,0),w.endTime=Math.max(L+I,0);const O=w.text.trim();w.text=decodeURIComponent(encodeURIComponent(O)),w.id||(w.id=t0(w.startTime,w.endTime,O)),w.endTime>0&&u.push(w)},l.onparsingerror=function(w){y=w},l.onflush=function(){if(y){a(y);return}i(u)},d.forEach(w=>{if(E)if(xf(w,"X-TIMESTAMP-MAP=")){E=!1,w.slice(16).split(",").forEach(S=>{xf(S,"LOCAL:")?p=S.slice(6):xf(S,"MPEGTS:")&&(g=parseInt(S.slice(7)))});try{x=_A(p)/1e3}catch(S){y=S}return}else w===""&&(E=!1);l.parse(w+`
`)}),l.flush()}const vf="stpp.ttml.im1t",M1=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,F1=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,IA={left:"start",center:"center",right:"end",start:"start",end:"end"};function Ix(n,e,t,r){const s=Me(new Uint8Array(n),["mdat"]);if(s.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const i=s.map(l=>pr(l)),a=NC(e.baseTime,1,e.timescale);try{i.forEach(l=>t(AA(l,a)))}catch(l){r(l)}}function AA(n,e){const s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(i).reduce((p,g)=>(p[g]=s.getAttribute(`ttp:${g}`)||i[g],p),{}),l=s.getAttribute("xml:space")!=="preserve",d=Ax(yf(s,"styling","style")),u=Ax(yf(s,"layout","region")),h=yf(s,"body","[begin]");return[].map.call(h,p=>{const g=U1(p,l);if(!g||!p.hasAttribute("begin"))return null;const x=wf(p.getAttribute("begin"),a),y=wf(p.getAttribute("dur"),a);let E=wf(p.getAttribute("end"),a);if(x===null)throw Lx(p);if(E===null){if(y===null)throw Lx(p);E=x+y}const w=new e0(x-e,E-e,g);w.id=t0(w.startTime,w.endTime,w.text);const S=u[p.getAttribute("region")],T=d[p.getAttribute("style")],k=LA(S,T,d),{textAlign:I}=k;if(I){const L=IA[I];L&&(w.lineAlign=L),w.align=I}return Ze(w,k),w}).filter(p=>p!==null)}function yf(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function Ax(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function U1(n,e){return[].slice.call(n.childNodes).reduce((t,r,s)=>{var i;return r.nodeName==="br"&&s?t+`
`:(i=r.childNodes)!=null&&i.length?U1(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function LA(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let s=null;const i=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(s=t[a]),i.reduce((l,d)=>{const u=Ef(e,r,d)||Ef(n,r,d)||Ef(s,r,d);return u&&(l[d]=u),l},{})}function Ef(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function Lx(n){return new Error(`Could not parse ttml timestamp ${n}`)}function wf(n,e){if(!n)return null;let t=P1(n);return t===null&&(M1.test(n)?t=RA(n,e):F1.test(n)&&(t=NA(n,e))),t}function RA(n,e){const t=M1.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function NA(n,e){const t=F1.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class ql{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class DA{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Nx(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new ql(this,"textTrack1"),t=new ql(this,"textTrack2"),r=new ql(this,"textTrack3"),s=new ql(this,"textTrack4");this.cea608Parser1=new Cx(1,e,t),this.cea608Parser2=new Cx(3,r,s)}addCues(e,t,r,s,i){let a=!1;for(let l=i.length;l--;){const d=i[l],u=PA(d[0],d[1],t,r);if(u>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),a=!0,u/(r-t)>.5))return}if(a||i.push([t,r]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,t,r,s)}else{const l=this.Cues.newCue(null,t,r,s);this.hls.trigger(C.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:a}){const{unparsedVttFrags:l}=this;r===ye.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:i,trackId:a}),l.length&&(this.unparsedVttFrags=[],l.forEach(d=>{this.initPTS[d.frag.cc]?this.onFragLoaded(C.FRAG_LOADED,d):this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let s=0;s<r.textTracks.length;s++){const i=r.textTracks[s];if(Rx(i,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:s}=this,{label:i,languageCode:a}=t[e],l=this.getExistingTrack(i,a);if(l)r[e]=l,Li(r[e]),A1(r[e],s);else{const d=this.createTextTrack("captions",i,a);d&&(d[e]=!0,r[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,s={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,r){const s=this.media;if(s)return s.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:s}=this;Object.keys(s).forEach(i=>{Li(s[i]),delete s[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Nx(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)Li(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],s=r.some(i=>i.textCodec===vf);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(g1(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const a=this.media,l=a?lc(a.textTracks):null;if(this.tracks.forEach((d,u)=>{let h;if(l){let p=null;for(let g=0;g<l.length;g++)if(l[g]&&Rx(l[g],d)){p=l[g],l[g]=null;break}p&&(h=p)}if(h)Li(h);else{const p=B1(d);h=this.createTextTrack(p,d.name,d.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),l!=null&&l.length){const d=l.filter(u=>u!==null).map(u=>u.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(l=>({label:l.name,kind:l.type.toLowerCase(),default:l.default,subtitleTrack:l}));this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const s=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!s)return;const i=`textTrack${s[1]}`,a=this.captionsProperties[i];a&&(a.label=r.name,r.lang&&(a.languageCode=r.lang),a.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ye.MAIN){var r,s;const{cea608Parser1:i,cea608Parser2:a,lastSn:l}=this,{cc:d,sn:u}=t.frag,h=(r=(s=t.part)==null?void 0:s.index)!=null?r:-1;i&&a&&(u!==l+1||u===l&&h!==this.lastPartIndex+1||d!==this.lastCc)&&(i.reset(),a.reset()),this.lastCc=d,this.lastSn=u,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:r,payload:s}=t;if(r.type===ye.SUBTITLE)if(s.byteLength){const i=r.decryptdata,a="stats"in t;if(i==null||!i.encrypted||a){const l=this.tracks[r.level],d=this.vttCCs;d[r.cc]||(d[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),l&&l.textCodec===vf?this._parseIMSC1(r,s):this._parseVTTs(t)}}else this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;Ix(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),r.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{r.logger.log(`Failed to parse IMSC1: ${s}`),r.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:r,payload:s}=e,{initPTS:i,unparsedVttFrags:a}=this,l=i.length-1;if(!i[r.cc]&&l===-1){a.push(e);return}const d=this.hls,u=(t=r.initSegment)!=null&&t.data?Tr(r.initSegment.data,new Uint8Array(s)).buffer:s;CA(u,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,h=>{this._appendCues(h,r.level),d.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},h=>{const p=h.message==="Missing initPTS for VTT MPEGTS";p?a.push(e):this._fallbackToIMSC1(r,s),d.logger.log(`Failed to parse VTT cue: ${h}`),!(p&&l>r.cc)&&d.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:h})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||Ix(t,this.initPTS[e.cc],()=>{r.textCodec=vf,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(i=>L1(s,i))}else{const s=this.tracks[t];if(!s)return;const i=s.default?"default":"subtitles"+t;r.trigger(C.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===ye.SUBTITLE&&this.onFragLoaded(C.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:s}=t;if(!(r.type===ye.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let i=0;i<s.length;i++){const a=s[i].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const l=this.extractCea608Data(a);this.cea608Parser1.addData(s[i].pts,l[0]),this.cea608Parser2.addData(s[i].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:s,type:i}){const{media:a}=this;if(!(!a||a.currentTime<r)){if(!i||i==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(d=>dh(l[d],t,r))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(d=>dh(l[d],t,s))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let s=2;for(let i=0;i<r;i++){const a=e[s++],l=127&e[s++],d=127&e[s++];if(l===0&&d===0)continue;if((4&a)!==0){const h=3&a;(h===0||h===1)&&(t[h].push(l),t[h].push(d))}}return t}}function B1(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function Rx(n,e){return!!n&&n.kind===B1(e)&&oh(e,n)}function PA(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function Nx(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const OA=/\s/,jA={newCue(n,e,t,r){const s=[];let i,a,l,d,u;const h=self.VTTCue||self.TextTrackCue;for(let g=0;g<r.rows.length;g++)if(i=r.rows[g],l=!0,d=0,u="",!i.isEmpty()){var p;for(let E=0;E<i.chars.length;E++)OA.test(i.chars[E].uchar)&&l?d++:(u+=i.chars[E].uchar,l=!1);i.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const x=j1(u.trim()),y=t0(e,t,x);n!=null&&(p=n.cues)!=null&&p.getCueById(y)||(a=new h(e,t,x),a.id=y,a.line=g+1,a.align="left",a.position=10+Math.min(80,Math.floor(d*8/32)*10),s.push(a))}return n&&s.length&&(s.sort((g,x)=>g.line==="auto"||x.line==="auto"?0:g.line>8&&x.line>8?x.line-g.line:g.line-x.line),s.forEach(g=>L1(n,g))),s}};function MA(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const FA=/(\d+)-(\d+)\/(\d+)/;class Dx{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||VA,this.controller=new self.AbortController,this.stats=new Dh}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const i=UA(e,this.controller.signal),a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=d&&xe(d)?d:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(io(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var g;this.response=this.loader=p;const x=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},u-(x-s.loading.start)),!p.ok){const{status:E,statusText:w}=p;throw new GA(w||"fetch, bad network response",E,p)}s.loading.first=x,s.total=$A(p.headers)||s.total;const y=(g=this.callbacks)==null?void 0:g.onProgress;return y&&xe(t.highWaterMark)?this.loadProgressively(p,s,e,t.highWaterMark,y):a?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{var g,x;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const E=p[l];E&&(s.loaded=s.total=E);const w={url:y.url,data:p,code:y.status},S=(g=this.callbacks)==null?void 0:g.onProgress;S&&!xe(t.highWaterMark)&&S(s,e,p,y),(x=this.callbacks)==null||x.onSuccess(w,s,e,y)}).catch(p=>{var g;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const x=p&&p.code||0,y=p?p.message:null;(g=this.callbacks)==null||g.onError({code:x,text:y},e,p?p.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,s=0,i){const a=new Qy,l=e.body.getReader(),d=()=>l.read().then(u=>{if(u.done)return a.dataLength&&i(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=u.value,p=h.length;return t.loaded+=p,p<s||a.dataLength?(a.push(h),a.dataLength>=s&&i(t,r,a.flush().buffer,e)):i(t,r,h.buffer,e),d()}).catch(()=>Promise.reject());return d()}}function UA(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ze({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function BA(n){const e=FA.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function $A(n){const e=n.get("Content-Range");if(e){const r=BA(e);if(xe(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function VA(n,e){return new self.Request(n.url,e)}class GA extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const HA=/^age:\s*[\d.]+\s*$/im;class $1{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Dh,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return i(r,t.url)}).catch(a=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),i(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(a=>{var l;(l=this.callbacks)==null||l.onError({code:r.status,text:a.message},t,r,s)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:a}=r.loadPolicy;if(s)for(const l in s)e.setRequestHeader(l,s[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&xe(i)?i:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const s=t.readyState,i=this.config;if(!r.aborted&&s>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,h=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const y=h??t.response;if(y!=null){var a,l;r.loading.end=Math.max(self.performance.now(),r.loading.first);const E=t.responseType==="arraybuffer"?y.byteLength:y.length;r.loaded=r.total=E,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const w=(a=this.callbacks)==null?void 0:a.onProgress;w&&w(r,e,y,t);const S={url:t.responseURL,data:y,code:u};(l=this.callbacks)==null||l.onSuccess(S,r,e,t);return}}const p=i.loadPolicy.errorRetry,g=r.retry,x={url:e.url,data:void 0,code:u};if(vc(p,g,!1,x))this.retry(p);else{var d;Qe.error(`${u} while loading ${e.url}`),(d=this.callbacks)==null||d.onError({code:u,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(vc(e,t,!0))this.retry(e);else{var r;Qe.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=Mh(e,r.retry),r.retry++,Qe.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&HA.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const qA={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},KA=Ye(Ye({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:$1,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:sk,bufferController:WC,capLevelController:Xh,errorController:ck,fpsController:YI,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Uy,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:qA},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},zA()),{},{subtitleStreamController:oA,subtitleTrackController:ZI,timelineController:DA,audioStreamController:HC,audioTrackController:qC,emeController:Di,cmcdController:qI,contentSteeringController:zI,interstitialsController:aA});function zA(){return{cueHandler:jA,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function WA(n,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=hh(n),s=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(a=>{const l=`${a==="level"?"playlist":a}LoadPolicy`,d=e[l]===void 0,u=[];i.forEach(h=>{const p=`${a}Loading${h}`,g=e[p];if(g!==void 0&&d){u.push(p);const x=r[l].default;switch(e[l]={default:x},h){case"TimeOut":x.maxLoadTimeMs=g,x.maxTimeToFirstByteMs=g;break;case"MaxRetry":x.errorRetry.maxNumRetry=g,x.timeoutRetry.maxNumRetry=g;break;case"RetryDelay":x.errorRetry.retryDelayMs=g,x.timeoutRetry.retryDelayMs=g;break;case"MaxRetryTimeout":x.errorRetry.maxRetryDelayMs=g,x.timeoutRetry.maxRetryDelayMs=g;break}}}),u.length&&t.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${l}": ${tt(e[l])}`)}),Ye(Ye({},r),e)}function hh(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(hh):Object.keys(n).reduce((e,t)=>(e[t]=hh(n[t]),e),{}):n}function YA(n,e){const t=n.loader;t!==Dx&&t!==$1?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):MA()&&(n.loader=Dx,n.progressive=!0,n.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const cc=2,QA=.1,XA=.05,ZA=100;class JA extends Py{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(ZA),this.mediaSource=t.mediaSource;const r=this.media=t.media;Qt(r,"playing",this.onMediaPlaying),Qt(r,"waiting",this.onMediaWaiting),Qt(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(ir(r,"playing",this.onMediaPlaying),ir(r,"waiting",this.onMediaWaiting),ir(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,s;const i=(r=this.hls)==null?void 0:r.config;if(!i)return;const a=this.media;if(!a)return;const{seeking:l}=a,d=this.seeking&&!l,u=!this.seeking&&l,h=a.paused&&!l||a.ended||a.playbackRate===0;if(this.seeking=l,e!==t){t&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(u||d){d&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1}));return}if(!Oe.getBuffered(a).length){this.nudgeRetry=0;return}const p=Oe.bufferInfo(a,e,0),g=p.nextStart||0,x=this.fragmentTracker;if(l&&x&&this.hls){const O=Px(this.hls.inFlightFragments,e),P=p.len>cc,j=!g||O||g-e>cc&&!x.getPartialFragment(e);if(P||j)return;this.moved=!1}const y=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&x){if(!(p.len>0)&&!g)return;const P=Math.max(g,p.start||0)-e,F=!!(y!=null&&y.live)?y.targetduration*2:cc,D=Kl(e,x);if(P>0&&(P<=F||D)){a.paused||this._trySkipBufferHole(D);return}}const E=i.detectStallWithCurrentTimeMs,w=self.performance.now(),S=this.waiting;let T=this.stalled;if(T===null)if(S>0&&w-S<E)T=this.stalled=S;else{this.stalled=w;return}const k=w-T;if(!l&&(k>=E||S)&&this.hls){var I;if(((I=this.mediaSource)==null?void 0:I.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(e-(y?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const L=Oe.bufferInfo(a,e,i.maxBufferHole);this._tryFixBufferStall(L,k,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(C.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&s&&s.length>1&&e>s.end(0)){const i=Oe.bufferedInfo(Oe.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){const a=Oe.timeRangesToArray(s),l=Oe.bufferedInfo(a,t,0).bufferedIndex;if(l>-1&&l<a.length-1){const d=Oe.bufferedInfo(a,e,0).bufferedIndex,u=a[l].end,h=a[l+1].start;if((d===-1||d>l)&&h-u<1&&e-u<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${h} buffered index: ${d}`);this.warn(p.message),this.media.currentTime+=1e-6;let g=Kl(e,this.fragmentTracker);g&&"fragment"in g?g=g.fragment:g||(g=void 0);const x=Oe.bufferInfo(this.media,e,0);this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:g,buffer:x.len,bufferInfo:x})}}}}}_tryFixBufferStall(e,t,r){var s,i;const{fragmentTracker:a,media:l}=this,d=(s=this.hls)==null?void 0:s.config;if(!l||!a||!d)return;const u=(i=this.hls)==null?void 0:i.latestLevelDetails,h=Kl(r,a);if((h||u!=null&&u.live&&r<u.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const p=e.buffered,g=this.adjacentTraversal(e,r);(p&&p.length>1&&e.len>d.maxBufferHole||e.nextStart&&(e.nextStart-r<d.maxBufferHole||g))&&(t>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,s=e.nextStart;if(r&&s){const i=r.getFragAtPos(t,ye.MAIN),a=r.getFragAtPos(s,ye.MAIN);if(i&&a)return a.sn-i.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:s,stalled:i}=this;if(!s&&i!==null&&r&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${tt(e)})`);this.warn(a.message),t.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:s}=this,i=(t=this.hls)==null?void 0:t.config;if(!s||!r||!i)return 0;const a=s.currentTime,l=Oe.bufferInfo(s,a,0),d=a<l.start?l.start:l.nextStart;if(d&&this.hls){const h=l.len<=i.maxBufferHole,p=l.len>0&&l.len<1&&s.readyState<3,g=d-a;if(g>0&&(h||p)){if(g>i.maxBufferHole){let y=!1;if(a===0){const E=r.getAppendedFrag(0,ye.MAIN);E&&d<E.end&&(y=!0)}if(!y&&e){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||Px(this.hls.inFlightFragments,d))return 0;let w=!1,S=e.end;for(;S<d;){const T=Kl(S,r);if(T)S+=T.duration;else{w=!0;break}}if(w)return 0}}const x=Math.max(d+XA,a+QA);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${x}`),this.moved=!0,s.currentTime=x,!(e!=null&&e.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${x}`),E={type:Te.MEDIA_ERROR,details:q.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:l.len,bufferInfo:l};e&&("fragment"in e?E.part=e:E.frag=e),this.hls.trigger(C.ERROR,E)}return x}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:s}=this,i=t?.config;if(!r||!i)return 0;const a=r.currentTime;if(this.nudgeRetry++,s<i.nudgeMaxRetry){const l=a+(s+1)*i.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${a} to ${l}`);this.warn(d.message),r.currentTime=l,t.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:e.len,bufferInfo:e})}else{const l=new Error(`Playhead still not moving while enough data buffered @${a} after ${i.nudgeMaxRetry} nudges`);this.error(l.message),t.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Px(n,e){const t=Ox(n.main);if(t&&t.start<=e)return t;const r=Ox(n.audio);return r&&r.start<=e?r:null}function Ox(n){if(!n)return null;switch(n.state){case te.IDLE:case te.STOPPED:case te.ENDED:case te.ERROR:return null}return n.frag}function Kl(n,e){return e.getAppendedFrag(n,ye.MAIN)||e.getPartialFragment(n)}const eL=.25;function mh(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function bf(n,e,t,r,s){let i=new n(e,t,"");try{i.value=r,s&&(i.type=s)}catch{i=new n(e,t,tt(s?Ye({type:s},r):r))}return i}const zl=(()=>{const n=mh();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class tL{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(C.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&Li(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return A1(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:s}=this.hls.config;if(!r&&!s)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=mh();if(a)for(let l=0;l<i.length;l++){const d=i[l].type;if(d===mr.emsg&&!r||!s)continue;const u=n1(i[l].data),h=i[l].pts;let p=h+i[l].duration;p>zl&&(p=zl),p-h<=0&&(p=h+eL);for(let x=0;x<u.length;x++){const y=u[x];if(!s1(y)){this.updateId3CueEnds(h,d);const E=bf(a,h,p,y,d);E&&this.id3Track.addCue(E)}}}}updateId3CueEnds(e,t){var r;const s=(r=this.id3Track)==null?void 0:r.cues;if(s)for(let i=s.length;i--;){const a=s[i];a.type===t&&a.startTime<e&&a.endTime===zl&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:s}){const{id3Track:i,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:d}}=a;if(i&&(l||d)){let u;s==="audio"?u=h=>h.type===mr.audioId3&&d:s==="video"?u=h=>h.type===mr.emsg&&l:u=h=>h.type===mr.audioId3&&d||h.type===mr.emsg&&l,dh(i,t,r,u)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:s,enableDateRangeMetadataCues:i,interstitialsController:a}=this.hls.config;if(!i)return;const l=mh();if(r&&s&&!a){const{fragmentStart:E,fragmentEnd:w}=e;let S=this.assetCue;S?(S.startTime=E,S.endTime=w):l&&(S=this.assetCue=bf(l,E,w,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),S&&(S.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(S),S.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:d}=this,{dateRanges:u}=e,h=Object.keys(u);let p=this.dateRangeCuesAppended;if(d&&t){var g;if((g=d.cues)!=null&&g.length){const E=Object.keys(p).filter(w=>!h.includes(w));for(let w=E.length;w--;){var x;const S=E[w],T=(x=p[S])==null?void 0:x.cues;delete p[S],T&&Object.keys(T).forEach(k=>{const I=T[k];if(I){I.removeEventListener("enter",this.onEventCueEnter);try{d.removeCue(I)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const y=e.fragments[e.fragments.length-1];if(!(h.length===0||!xe(y?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let E=0;E<h.length;E++){const w=h[E],S=u[w],T=S.startTime,k=p[w],I=k?.cues||{};let L=k?.durationKnown||!1,O=zl;const{duration:P,endDate:j}=S;if(j&&P!==null)O=T+P,L=!0;else if(S.endOnNext&&!L){const D=h.reduce(($,J)=>{if(J!==S.id){const ne=u[J];if(ne.class===S.class&&ne.startDate>S.startDate&&(!$||S.startDate<$.startDate))return ne}return $},null);D&&(O=D.startTime,L=!0)}const F=Object.keys(S.attr);for(let D=0;D<F.length;D++){const $=F[D];if(!bk($))continue;const J=I[$];if(J)L&&!(k!=null&&k.durationKnown)?J.endTime=O:Math.abs(J.startTime-T)>.01&&(J.startTime=T,J.endTime=O);else if(l){let ne=S.attr[$];Sk($)&&(ne=my(ne));const X=bf(l,T,O,{key:$,data:ne},mr.dateRange);X&&(X.id=w,this.id3Track.addCue(X),I[$]=X,a&&($==="X-ASSET-LIST"||$==="X-ASSET-URL")&&X.addEventListener("enter",this.onEventCueEnter))}}p[w]={cues:I,dateRange:S,durationKnown:L}}}}}class rL{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:a}=this.config;if(!i||a===1||!r.live)return;const l=this.targetLatency;if(l===null)return;const d=s-l,u=Math.min(this.maxLatency,l+r.targetduration);if(d<u&&d>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,a)),g=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,x=Math.min(p,Math.max(1,g));this.changeMediaPlaybackRate(t,x)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:s}=e,{liveSyncDuration:i,liveSyncDurationCount:a,lowLatencyMode:l}=this.config,d=this.hls.userConfig;let u=l&&r||t;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||u===0)&&(u=i!==void 0?i:a*s);const h=s;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const s=r.edge,i=e-t-this.edgeStalled,a=s-r.totalduration,l=s-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,i),l)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===q.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,s;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class nL extends Qh{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,s=[],i={},a={};let l=!1,d=!1,u=!1;t.levels.forEach(h=>{const p=h.attrs;let{audioCodec:g,videoCodec:x}=h;g&&(h.audioCodec=g=mc(g,r)||void 0),x&&(x=h.videoCodec=U_(x));const{width:y,height:E,unknownCodecs:w}=h,S=w?.length||0;if(l||(l=!!(y&&E)),d||(d=!!x),u||(u=!!g),S||g&&!this.isAudioSupported(g)||x&&!this.isVideoSupported(x)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:T,"FRAME-RATE":k,"HDCP-LEVEL":I,"PATHWAY-ID":L,RESOLUTION:O,"VIDEO-RANGE":P}=p,F=`${`${L||"."}-`}${h.bitrate}-${O}-${k}-${T}-${P}-${I}`;if(i[F])if(i[F].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const D=a[F]+=1;h.attrs["PATHWAY-ID"]=new Array(D+1).join(".");const $=this.createLevel(h);i[F]=$,s.push($)}else i[F].addGroupId("audio",p.AUDIO),i[F].addGroupId("text",p.SUBTITLES);else{const D=this.createLevel(h);i[F]=D,a[F]=1,s.push(D)}}),this.filterAndSortMediaOptions(s,t,l,d,u)}createLevel(e){const t=new ro(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(s.message),t.supportedResult=ky(s,[])}return t}isAudioSupported(e){return eo(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return eo(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,s,i){var a;let l=[],d=[],u=e;const h=((a=t.stats)==null?void 0:a.parsing)||{};if((r||s)&&i&&(u=u.filter(({videoCodec:T,videoRange:k,width:I,height:L})=>(!!T||!!(I&&L))&&Y_(k))),u.length===0){Promise.resolve().then(()=>{if(this.hls){let T="no level with compatible codecs found in manifest",k=T;t.levels.length&&(k=`one or more CODECS in variant not supported: ${tt(t.levels.map(L=>L.attrs.CODECS).filter((L,O,P)=>P.indexOf(L)===O))}`,this.warn(k),T+=` (${k})`);const I=new Error(T);this.hls.trigger(C.ERROR,{type:Te.MEDIA_ERROR,details:q.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:I,reason:k})}}),h.end=performance.now();return}t.audioTracks&&(l=t.audioTracks.filter(T=>!T.audioCodec||this.isAudioSupported(T.audioCodec)),jx(l)),t.subtitles&&(d=t.subtitles,jx(d));const p=u.slice(0);u.sort((T,k)=>{if(T.attrs["HDCP-LEVEL"]!==k.attrs["HDCP-LEVEL"])return(T.attrs["HDCP-LEVEL"]||"")>(k.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&T.height!==k.height)return T.height-k.height;if(T.frameRate!==k.frameRate)return T.frameRate-k.frameRate;if(T.videoRange!==k.videoRange)return pc.indexOf(T.videoRange)-pc.indexOf(k.videoRange);if(T.videoCodec!==k.videoCodec){const I=Cg(T.videoCodec),L=Cg(k.videoCodec);if(I!==L)return L-I}if(T.uri===k.uri&&T.codecSet!==k.codecSet){const I=hc(T.codecSet),L=hc(k.codecSet);if(I!==L)return L-I}return T.averageBitrate!==k.averageBitrate?T.averageBitrate-k.averageBitrate:0});let g=p[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==p.length)){for(let T=0;T<p.length;T++)if(p[T].pathwayId===u[0].pathwayId){g=p[T];break}}this._levels=u;for(let T=0;T<u.length;T++)if(u[T]===g){var x;this._firstLevel=T;const k=g.bitrate,I=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${k}`),((x=this.hls.userConfig)==null?void 0:x.abrEwmaDefaultEstimate)===void 0){const L=Math.min(k,this.hls.config.abrEwmaDefaultEstimateMax);L>I&&I===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=L)}break}const y=i&&!s,E=this.hls.config,w=!!(E.audioStreamController&&E.audioTrackController),S={levels:u,audioTracks:l,subtitleTracks:d,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:s,altAudio:w&&!y&&l.some(T=>!!T.url)};h.end=performance.now(),this.hls.trigger(C.MANIFEST_PARSED,S)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:h,reason:h.message}),p)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,s=this.currentLevel,i=s?s.attrs["PATHWAY-ID"]:void 0,a=t[e],l=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,r===e&&s&&i===l)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${l?" with Pathway "+l:""} from level ${r}${i?" with Pathway "+i:""}`);const d={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(C.LEVEL_SWITCHING,d);const u=a.details;if(!u||u.live){const h=this.switchParams(a.uri,s?.details,u);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===Be.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ye.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(i=>!!r[i]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var r;const{level:s,details:i}=t,a=t.levelInfo;if(!a){var l;this.warn(`Invalid level index ${s}`),(l=t.deliveryDirectives)!=null&&l.skip&&(i.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let d=a.details;d===t.details&&d.advanced&&(d=void 0),this.playlistLoaded(s,t,d)}else(r=t.deliveryDirectives)!=null&&r.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,i=e.attrs["PATHWAY-ID"],a=e.details,l=a?.age;this.log(`Loading level index ${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${i?" Pathway "+i:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(C.LEVEL_LOADING,{url:r,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((i,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(l=>l.level=-1)),!1));zy(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=r.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(C.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(C.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function jx(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function V1(){return self.SourceBuffer||self.WebKitSourceBuffer}function G1(){if(!fs())return!1;const e=V1();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function sL(){if(!G1())return!1;const n=fs();return typeof n?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(to(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(to(e,"audio"))))}function iL(){var n;const e=V1();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const aL=100;class oL extends Vh{constructor(e,t,r){super(e,t,r,"stream-controller",ye.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,i=s?s.currentTime:null;if(i===null||!xe(i)||(this.log(`Media seeked to ${i.toFixed(3)}`),!this.getBufferedFrag(i)))return;const a=this.getFwdBufferInfoAtPos(s,i,ye.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${i} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:s}=this;if(this.stopLoad(),this.setInterval(aL),this.level=-1,!this.startFragRequested){let i=s.startLevel;i===-1&&(s.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=s.firstAutoLevel),s.nextLoadLevel=i,this.level=s.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=te.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=te.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case te.WAITING_LEVEL:{const{levels:e,level:t}=this,r=e?.[t],s=r?.details;if(s&&(!s.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(s))break;this.state=te.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=te.IDLE;break}break}case te.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===te.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const i=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[i]))return;const a=r[i],l=this.getMainFwdBufferInfo();if(l===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(l,d)){const E={};this.altAudio===2&&(E.type="video"),this.hls.trigger(C.BUFFER_EOS,E),this.state=te.ENDED;return}if(!this.buffering)return;e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const u=a.details;if(!u||this.state===te.WAITING_LEVEL||this.waitForLive(a)){this.level=i,this.state=te.WAITING_LEVEL,this.startFragRequested=!1;return}const h=l.len,p=this.getMaxBufferLength(a.maxBitrate);if(h>=p)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:l.end;let x=this.getNextFragment(g,u);if(this.couldBacktrack&&!this.fragPrevious&&x&&wt(x)&&this.fragmentTracker.getState(x)!==It.OK){var y;const w=((y=this.backtrackFragment)!=null?y:x).sn-u.startSN,S=u.fragments[w-1];S&&x.cc===S.cc&&(x=S,this.fragmentTracker.removeFragment(S))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(x&&this.isLoopLoading(x,g)){if(!x.gap){const w=this.audioOnly&&!this.altAudio?et.AUDIO:et.VIDEO,S=(w===et.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;S&&this.afterBufferFlushed(S,w,ye.MAIN)}x=this.getNextFragmentLoopLoading(x,u,l,ye.MAIN,p)}x&&(x.initSegment&&!x.initSegment.data&&!this.bitrateTest&&(x=x.initSegment),this.loadFragment(x,a,g))}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);s===It.NOT_LOADED||s===It.PARTIAL?wt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ye.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const i=this.getLevelDetails();if(i!=null&&i.live){const l=this.getMainFwdBufferInfo();if(!l||l.len<i.targetduration*2)return}if(!t.paused&&e){const l=this.hls.nextLoadLevel,d=e[l],u=this.fragLastKbps;u&&this.fragCurrent?r=this.fragCurrent.duration*d.maxBitrate/(1e3*u)+1:r=0}else r=0;const a=this.getBufferedFrag(t.currentTime+r);if(a){const l=this.followingBufferedFrag(a);if(l){this.abortCurrentFrag();const d=l.maxStartPTS?l.maxStartPTS:l.start,u=l.duration,h=Math.max(a.end,d+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case te.KEY_LOADING:case te.FRAG_LOADING:case te.FRAG_LOADING_WAITING_RETRY:case te.PARSING:case te.PARSED:this.state=te.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;Qt(r,"playing",this.onMediaPlaying),Qt(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(ir(r,"playing",this.onMediaPlaying),ir(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(C.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,s=!1;for(let i=0;i<t.levels.length;i++){const a=t.levels[i].audioCodec;a&&(r=r||a.indexOf("mp4a.40.2")!==-1,s=s||a.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&s&&!iL(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==te.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=te.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:s,startFragRequested:i}=this,a=t.level,l=t.details,d=l.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""}, cc [${l.startCC}, ${l.endCC}] duration:${d}`);const u=t.levelInfo,h=this.fragCurrent;h&&(this.state===te.FRAG_LOADING||this.state===te.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let p=0;if(l.live||(r=u.details)!=null&&r.live){var g;if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;p=this.alignPlaylists(l,u.details,(g=this.levelLastLoaded)==null?void 0:g.details)}if(u.details=l,this.levelLastLoaded=u,i||this.setStartPosition(l,p),this.hls.trigger(C.LEVEL_UPDATED,{details:l,level:a}),this.state===te.WAITING_LEVEL){if(this.waitForCdnTuneIn(l))return;this.state=te.IDLE}i&&l.live&&this.synchronizeToLiveEdge(l),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const s=this.hls.liveSyncPosition,i=this.getLoadPosition(),a=e.fragmentStart,l=e.edge,d=i>=a-t.maxFragLookUpTolerance&&i<=l;if(s!==null&&r.duration>s&&(i<s||!d)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!d&&r.readyState<4||i<l-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),r.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const p=Oe.bufferInfo(r,s,0);if(!((u=p.buffered)!=null&&u.length)){r.currentTime=s;return}if(p.start<=i){r.currentTime=s;return}const{nextStart:x}=Oe.bufferedInfo(p.buffered,i,0);x&&(r.currentTime=x)}else r.currentTime=s}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const l=a[r.level];if(!l){this.warn(`Level ${r.level} not found on progress`);return}const d=l.details;if(!d){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const u=l.videoCodec,h=d.PTSKnown||!d.live,p=(t=r.initSegment)==null?void 0:t.data,g=this._getAudioCodec(l),x=this.transmuxer=this.transmuxer||new p1(this.hls,ye.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=s?s.index:-1,E=y!==-1,w=new Uh(r.level,r.sn,r.stats.chunkCount,i.byteLength,y,E),S=this.initPTS[r.cc];x.push(i,p,g,u,r,s,d.totalduration,h,w,S)}onAudioTrackSwitching(e,t){const r=this.hls,s=this.altAudio!==0;if(gc(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.altAudio=0,this.fragmentTracker.removeAllFragments(),r.once(C.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(C.AUDIO_TRACK_SWITCHED,t)}),r.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(C.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=gc(t.url,this.hls);if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let s,i,a=!1;for(const l in r){const d=r[l];if(d.id==="main"){if(i=l,s=d,l==="video"){const u=r[l];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&s?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:s}=t,i=r.type===ye.MAIN;if(i){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===te.PARSED&&(this.state=te.IDLE);return}const l=s?s.stats:r.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),wt(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,s)}const a=this.media;a&&(!this._hasEnoughToStart&&Oe.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=te.ERROR;return}switch(t.details){case q.FRAG_GAP:case q.FRAG_PARSING_ERROR:case q.FRAG_DECRYPT_ERROR:case q.FRAG_LOAD_ERROR:case q.FRAG_LOAD_TIMEOUT:case q.KEY_LOAD_ERROR:case q.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ye.MAIN,t);break;case q.LEVEL_LOAD_ERROR:case q.LEVEL_LOAD_TIMEOUT:case q.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===te.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===Be.LEVEL&&(this.state=te.IDLE);break;case q.BUFFER_ADD_CODEC_ERROR:case q.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case q.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case q.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=te.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==et.AUDIO||!this.altAudio){const r=(t===et.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,ye.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&r&&(r+=s);const i=this.getLevelDetails(),a=Oe.getBuffered(e),l=a.length?a.start(0):0,d=l-r,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<u||this.loadingParts&&d<2*(i?.partTarget||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),r+=d,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${l}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:s}=this,i=r?.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=te.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=i.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(C.FRAG_LOADED,r),i.bitrateTest=!1}).catch(r=>{this.state===te.STOPPED||this.state===te.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:i}=e,a=this.getCurrentContext(i);if(!a){this.resetWhenMissingContext(i);return}const{frag:l,part:d,level:u}=a,{video:h,text:p,id3:g,initSegment:x}=s,{details:y}=u,E=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=te.PARSING,x){const w=x.tracks;if(w){const I=l.initSegment||l;if(this.unhandledEncryptionError(x,l))return;this._bufferInitSegment(u,w,I,i),r.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:t,tracks:w})}const S=x.initPTS,T=x.timescale,k=this.initPTS[l.cc];if(xe(S)&&(!k||k.baseTime!==S||k.timescale!==T)){const I=x.trackId;this.initPTS[l.cc]={baseTime:S,timescale:T,trackId:I},r.trigger(C.INIT_PTS_FOUND,{frag:l,id:t,initPTS:S,timescale:T,trackId:I})}}if(h&&y){E&&h.type==="audiovideo"&&this.logMuxedErr(l);const w=y.fragments[l.sn-1-y.startSN],S=l.sn===y.startSN,T=!w||l.cc>w.cc;if(s.independent!==!1){const{startPTS:k,endPTS:I,startDTS:L,endDTS:O}=h;if(d)d.elementaryStreams[h.type]={startPTS:k,endPTS:I,startDTS:L,endDTS:O};else if(h.firstKeyFrame&&h.independent&&i.id===1&&!T&&(this.couldBacktrack=!0),h.dropped&&h.independent){const P=this.getMainFwdBufferInfo(),j=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,F=h.firstKeyFramePTS?h.firstKeyFramePTS:k;if(!S&&j<F-this.config.maxBufferHole&&!T){this.backtrack(l);return}else T&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,I,l.start,O,!0)}else S&&k-(y.appliedTimelineOffset||0)>cc&&(l.gap=!0);l.setElementaryStreamInfo(h.type,k,I,L,O),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,d,i,S||T)}else if(S||T)l.gap=!0;else{this.backtrack(l);return}}if(E){const{startPTS:w,endPTS:S,startDTS:T,endDTS:k}=E;d&&(d.elementaryStreams[et.AUDIO]={startPTS:w,endPTS:S,startDTS:T,endDTS:k}),l.setElementaryStreamInfo(et.AUDIO,w,S,T,k),this.bufferFragmentData(E,l,d,i)}if(y&&g!=null&&g.samples.length){const w={id:t,frag:l,details:y,samples:g.samples};r.trigger(C.FRAG_PARSING_METADATA,w)}if(y&&p){const w={id:t,frag:l,details:y,samples:p.samples};r.trigger(C.FRAG_PARSING_USERDATA,w)}}logMuxedErr(e){this.warn(`${wt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,s){if(this.state!==te.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:i,video:a,audiovideo:l}=t;if(i){const u=e.audioCodec;let h=rc(i.codec,u);h==="mp4a"&&(h="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const g=i.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&i.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),u&&u!==h&&this.log(`Swapping manifest audio codec "${u}" for "${h}"`),i.levelCodec=h,i.id=ye.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${h||""}/${u||""}/${i.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=ye.MAIN;const u=a.codec;if(u?.length===4)switch(u){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${a.codec!==u?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}l&&(this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),delete t.video,delete t.audio);const d=Object.keys(t);if(d.length){if(this.hls.trigger(C.BUFFER_CODECS,t),!this.hls)return;d.forEach(u=>{const p=t[u].initSegment;p!=null&&p.byteLength&&this.hls.trigger(C.BUFFER_APPENDING,{type:u,data:p,frag:r,part:null,chunkMeta:s,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ye.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e?.[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=te.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Oe.isBuffered(e,r)?t=this.getAppendedFrag(r):Oe.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,i=t.level;(!s||t.sn!==s.sn||s.level!==i)&&(this.fragPlaying=t,this.hls.trigger(C.FRAG_CHANGED,{frag:t}),(!s||s.level!==i)&&this.hls.trigger(C.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return xe(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(xe(t)){const r=this.getLevelDetails(),s=this.currentFrag||(r?Gs(null,r.fragments,t):null);if(s){const i=s.programDateTime;if(i!==null){const a=i+(t-s.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class lL extends kr{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[r].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=q.KEY_LOAD_ERROR,r,s,i){return new Sn({type:Te.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:s})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let s=0,i=t.length;s<i;s++){const a=t[s];if(e.cc<=a.cc&&(!wt(e)||!wt(a)||e.sn<a.sn)||!r&&s==i-1)return this.emeController.selectKeySystemFormat(a).then(l=>{if(!this.emeController)return;a.setKeyFormat(l);const d=sc(l);if(d)return this.emeController.getKeySystemAccess([d])})}if(this.config.requireKeySystemAccessOnStart){const s=Ga(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,s;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,q.KEY_LOAD_ERROR,u))}const a=i.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,q.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));const l=Sf(i);let d=this.keyIdToKeyInfo[l];if((r=d)!=null&&r.decryptdata.key)return i.key=d.decryptdata.key,Promise.resolve({frag:e,keyInfo:d});if(this.emeController&&(s=d)!=null&&s.keyLoadPromise)switch(this.emeController.getKeyStatus(d.decryptdata)){case"usable":case"usable-in-future":return d.keyLoadPromise.then(h=>{const{keyInfo:p}=h;return i.key=p.decryptdata.key,{frag:e,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[l]?"Rel":"L"}oading${i.keyId?" keyId: "+Ut(i.keyId):""} URI: ${i.uri} from ${e.type} ${e.level}`),d=this.keyIdToKeyInfo[l]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return i.keyFormat==="identity"?this.loadKeyHTTP(d,e):this.loadKeyEME(d,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(d,e);default:return Promise.reject(this.createKeyLoadError(e,q.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var s;if(!e.decryptdata.keyId&&(s=t.initSegment)!=null&&s.data){const a=C_(t.initSegment.data);if(a.length){let l=a[0];l.some(d=>d!==0)?(this.log(`Using keyId found in init segment ${Ut(l)}`),us.setKeyIdForUri(e.decryptdata.uri,l)):(l=us.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Ut(l)}`)),e.decryptdata.keyId=l}}if(!e.decryptdata.keyId&&!wt(t))return Promise.resolve(r);const i=this.emeController.loadKey(r);return(e.keyLoadPromise=i.then(a=>(e.mediaKeySessionContext=a,r))).catch(a=>{throw e.keyLoadPromise=null,"data"in a&&(a.data.frag=t),a})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,s=r.loader,i=new s(r);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((a,l)=>{const d={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=r.keyLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(g,x,y,E)=>{const{frag:w,keyInfo:S}=y,T=Sf(S.decryptdata);if(!w.decryptdata||S!==this.keyIdToKeyInfo[T])return l(this.createKeyLoadError(w,q.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),E));S.decryptdata.key=w.decryptdata.key=new Uint8Array(g.data),w.keyLoader=null,S.loader=null,a({frag:w,keyInfo:S})},onError:(g,x,y,E)=>{this.resetLoader(x),l(this.createKeyLoadError(t,q.KEY_LOAD_ERROR,new Error(`HTTP Error ${g.code} loading key ${g.text}`),y,Ye({url:d.url,data:void 0},g)))},onTimeout:(g,x,y)=>{this.resetLoader(x),l(this.createKeyLoadError(t,q.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(g,x,y)=>{this.resetLoader(x),l(this.createKeyLoadError(t,q.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};i.load(d,h,p)})}resetLoader(e){const{frag:t,keyInfo:r,url:s}=e,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null);const a=Sf(r.decryptdata)||s;delete this.keyIdToKeyInfo[a],i&&i.destroy()}}function Sf(n){if(n.keyFormat!==Bt.FAIRPLAY){const e=n.keyId;if(e)return Ut(e)}return n.uri}function Mx(n){const{type:e}=n;switch(e){case Be.AUDIO_TRACK:return ye.AUDIO;case Be.SUBTITLE_TRACK:return ye.SUBTITLE;default:return ye.MAIN}}function Tf(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class cL{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,s=t.loader,i=r||s,a=new i(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Be.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:s,pathwayId:i,url:a,deliveryDirectives:l,levelInfo:d}=t;this.load({id:r,level:s,pathwayId:i,responseType:"text",type:Be.LEVEL,url:a,deliveryDirectives:l,levelOrTrack:d})}onAudioTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:a,track:l}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:Be.AUDIO_TRACK,url:i,deliveryDirectives:a,levelOrTrack:l})}onSubtitleTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:a,track:l}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:Be.SUBTITLE_TRACK,url:i,deliveryDirectives:a,levelOrTrack:l})}onLevelsUpdated(e,t){const r=this.loaders[Be.LEVEL];if(r){const s=r.context;s&&!t.levels.some(i=>i===s.levelOrTrack)&&(r.abort(),delete this.loaders[Be.LEVEL])}}load(e){var t;const r=this.hls.config;let s=this.getInternalLoader(e);if(s){const u=this.hls.logger,h=s.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let i;if(e.type===Be.MANIFEST?i=r.manifestLoadPolicy.default:i=Ze({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),xe((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===Be.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===Be.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===Be.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const h=u.partTarget,p=u.targetduration;if(h&&p){const g=Math.max(h*3,p*.8)*1e3;i=Ze({},i,{maxTimeToFirstByteMs:Math.min(g,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(g,i.maxTimeToFirstByteMs)})}}}const a=i.errorRetry||i.timeoutRetry||{},l={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},d={onSuccess:(u,h,p,g)=>{const x=this.getInternalLoader(p);this.resetInternalLoader(p.type);const y=u.data;h.parsing.start=performance.now(),tn.isMediaPlaylist(y)||p.type!==Be.MANIFEST?this.handleTrackOrLevelPlaylist(u,h,p,g||null,x):this.handleMasterPlaylist(u,h,p,g)},onError:(u,h,p,g)=>{this.handleNetworkError(h,p,!1,u,g)},onTimeout:(u,h,p)=>{this.handleNetworkError(h,p,!0,void 0,u)}};s.load(e,l,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,s){const i=this.hls,a=e.data,l=Tf(e,r),d=tn.parseMasterPlaylist(a,l);if(d.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,r,d.playlistParsingError,s,t);return}const{contentSteering:u,levels:h,sessionData:p,sessionKeys:g,startTimeOffset:x,variableList:y}=d;this.variableList=y,h.forEach(T=>{const{unknownCodecs:k}=T;if(k){const{preferManagedMediaSource:I}=this.hls.config;let{audioCodec:L,videoCodec:O}=T;for(let P=k.length;P--;){const j=k[P];eo(j,"audio",I)?(T.audioCodec=L=L?`${L},${j}`:j,Ui.audio[L.substring(0,4)]=2,k.splice(P,1)):eo(j,"video",I)&&(T.videoCodec=O=O?`${O},${j}`:j,Ui.video[O.substring(0,4)]=2,k.splice(P,1))}}});const{AUDIO:E=[],SUBTITLES:w,"CLOSED-CAPTIONS":S}=tn.parseMasterPlaylistMedia(a,l,d);E.length&&!E.some(k=>!k.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),E.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new dt({}),bitrate:0,url:""})),i.trigger(C.MANIFEST_LOADED,{levels:h,audioTracks:E,subtitles:w,captions:S,contentSteering:u,url:l,stats:t,networkDetails:s,sessionData:p,sessionKeys:g,startTimeOffset:x,variableList:y})}handleTrackOrLevelPlaylist(e,t,r,s,i){const a=this.hls,{id:l,level:d,type:u}=r,h=Tf(e,r),p=xe(d)?d:xe(l)?l:0,g=Mx(r),x=tn.parseLevelPlaylist(e.data,h,p,g,0,this.variableList);if(u===Be.MANIFEST){const y={attrs:new dt({}),bitrate:0,details:x,name:"",url:h};x.requestScheduled=t.loading.start+Hy(x,0),a.trigger(C.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:h,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=x,this.handlePlaylistLoaded(x,e,t,r,s,i)}handleManifestParsingError(e,t,r,s,i){this.hls.trigger(C.ERROR,{type:Te.NETWORK_ERROR,details:q.MANIFEST_PARSING_ERROR,fatal:t.type===Be.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:s,stats:i})}handleNetworkError(e,t,r=!1,s,i){let a=`A network ${r?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===Be.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===Be.AUDIO_TRACK||e.type===Be.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const l=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let d=q.UNKNOWN,u=!1;const h=this.getInternalLoader(e);switch(e.type){case Be.MANIFEST:d=r?q.MANIFEST_LOAD_TIMEOUT:q.MANIFEST_LOAD_ERROR,u=!0;break;case Be.LEVEL:d=r?q.LEVEL_LOAD_TIMEOUT:q.LEVEL_LOAD_ERROR,u=!1;break;case Be.AUDIO_TRACK:d=r?q.AUDIO_TRACK_LOAD_TIMEOUT:q.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case Be.SUBTITLE_TRACK:d=r?q.SUBTITLE_TRACK_LOAD_TIMEOUT:q.SUBTITLE_LOAD_ERROR,u=!1;break}h&&this.resetInternalLoader(e.type);const p={type:Te.NETWORK_ERROR,details:d,fatal:u,url:e.url,loader:h,context:e,error:l,networkDetails:t,stats:i};if(s){const g=t?.url||e.url;p.response=Ye({url:g,data:void 0},s)}this.hls.trigger(C.ERROR,p)}handlePlaylistLoaded(e,t,r,s,i,a){const l=this.hls,{type:d,level:u,levelOrTrack:h,id:p,groupId:g,deliveryDirectives:x}=s,y=Tf(t,s),E=Mx(s);let w=typeof s.level=="number"&&E===ye.MAIN?u:void 0;const S=e.playlistParsingError;if(S){if(this.hls.logger.warn(`${S} ${e.url}`),!l.config.ignorePlaylistParsingErrors){l.trigger(C.ERROR,{type:Te.NETWORK_ERROR,details:q.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:S,reason:S.message,response:t,context:s,level:w,parent:E,networkDetails:i,stats:r});return}e.playlistParsingError=null}if(!e.fragments.length){const T=e.playlistParsingError=new Error("No Segments found in Playlist");l.trigger(C.ERROR,{type:Te.NETWORK_ERROR,details:q.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:T,reason:T.message,response:t,context:s,level:w,parent:E,networkDetails:i,stats:r});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case Be.MANIFEST:case Be.LEVEL:if(w){if(!h)w=0;else if(h!==l.levels[w]){const T=l.levels.indexOf(h);T>-1&&(w=T)}}l.trigger(C.LEVEL_LOADED,{details:e,levelInfo:h||l.levels[0],level:w||0,id:p||0,stats:r,networkDetails:i,deliveryDirectives:x,withoutMultiVariant:d===Be.MANIFEST});break;case Be.AUDIO_TRACK:l.trigger(C.AUDIO_TRACK_LOADED,{details:e,track:h,id:p||0,groupId:g||"",stats:r,networkDetails:i,deliveryDirectives:x});break;case Be.SUBTITLE_TRACK:l.trigger(C.SUBTITLE_TRACK_LOADED,{details:e,track:h,id:p||0,groupId:g||"",stats:r,networkDetails:i,deliveryDirectives:x});break}}}class sr{static get version(){return no}static isMSESupported(){return G1()}static isSupported(){return sL()}static getMediaSource(){return fs()}static get Events(){return C}static get MetadataSchema(){return mr}static get ErrorTypes(){return Te}static get ErrorDetails(){return q}static get DefaultConfig(){return sr.defaultConfig?sr.defaultConfig:KA}static set DefaultConfig(e){sr.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Gh,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=p_(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=WA(sr.DefaultConfig,e,t);this.userConfig=e,r.progressive&&YA(r,t);const{abrController:s,bufferController:i,capLevelController:a,errorController:l,fpsController:d}=r,u=new l(this),h=this.abrController=new s(this),p=new uk(this),g=r.interstitialsController,x=g?this.interstitialsController=new g(this,sr):null,y=this.bufferController=new i(this,p),E=this.capLevelController=new a(this),w=new d(this),S=new cL(this),T=r.contentSteeringController,k=T?new T(this):null,I=this.levelController=new nL(this,k),L=new tL(this),O=new lL(this.config,this.logger),P=this.streamController=new oL(this,p,O),j=this.gapController=new JA(this,p);E.setStreamController(P),w.setStreamController(P);const F=[S,I,P];x&&F.splice(1,0,x),k&&F.splice(1,0,k),this.networkControllers=F;const D=[h,y,j,E,w,L,p];this.audioTrackController=this.createController(r.audioTrackController,F);const $=r.audioStreamController;$&&F.push(this.audioStreamController=new $(this,p,O)),this.subtitleTrackController=this.createController(r.subtitleTrackController,F);const J=r.subtitleStreamController;J&&F.push(this.subtititleStreamController=new J(this,p,O)),this.createController(r.timelineController,D),O.emeController=this.emeController=this.createController(r.emeController,D),this.cmcdController=this.createController(r.cmcdController,D),this.latencyController=this.createController(rL,D),this.coreComponents=D,F.push(u);const ne=u.onErrorOut;typeof ne=="function"&&this.on(C.ERROR,ne,u),this.on(C.MANIFEST_LOADED,S.onManifestLoaded,S)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,s){this._emitter.off(e,t,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const s=e===C.ERROR;this.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.INTERNAL_EXCEPTION,fatal:s,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(C.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const i=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(C.ERROR,{type:Te.OTHER_ERROR,details:q.ATTACH_MEDIA_ERROR,fatal:!0,error:i});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,s=t?e:{media:r};this._media=r,this.trigger(C.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(C.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(C.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,s=this._url=Nh.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(C.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ye.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ye.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ye.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=JI()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){W_(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,r)for(let i=s;i--;){const a=e[i].attrs["HDCP-LEVEL"];if(a&&a<=r)return i}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=Ay(t);return Cy(e,r,navigator.mediaCapabilities)}}sr.defaultConfig=void 0;var uL=Object.create,H1=Object.defineProperty,dL=Object.getOwnPropertyDescriptor,fL=Object.getOwnPropertyNames,hL=Object.getPrototypeOf,mL=Object.prototype.hasOwnProperty,q1=function(n,e){return function(){return n&&(e=n(n=0)),e}},ar=function(n,e){return function(){return e||n((e={exports:{}}).exports,e),e.exports}},pL=function(n,e,t,r){if(e&&typeof e=="object"||typeof e=="function")for(var s=fL(e),i=0,a=s.length,l;i<a;i++)l=s[i],!mL.call(n,l)&&l!==t&&H1(n,l,{get:function(d){return e[d]}.bind(null,l),enumerable:!(r=dL(e,l))||r.enumerable});return n},Cr=function(n,e,t){return t=n!=null?uL(hL(n)):{},pL(!n||!n.__esModule?H1(t,"default",{value:n,enumerable:!0}):t,n)},on=ar(function(n,e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={},e.exports=t});function qs(n,e){return e!=null&&typeof Symbol<"u"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](n):qs(n,e)}var Ks=q1(function(){Ks()});function K1(n){"@swc/helpers - typeof";return n&&typeof Symbol<"u"&&n.constructor===Symbol?"symbol":typeof n}var z1=q1(function(){}),W1=ar(function(n,e){var t=Array.prototype.slice;e.exports=r;function r(s,i){for(("length"in s)||(s=[s]),s=t.call(s);s.length;){var a=s.shift(),l=i(a);if(l)return l;a.childNodes&&a.childNodes.length&&(s=t.call(a.childNodes).concat(s))}}}),gL=ar(function(n,e){Ks(),e.exports=t;function t(r,s){if(!qs(this,t))return new t(r,s);this.data=r,this.nodeValue=r,this.length=r.length,this.ownerDocument=s||null}t.prototype.nodeType=8,t.prototype.nodeName="#comment",t.prototype.toString=function(){return"[object Comment]"}}),xL=ar(function(n,e){Ks(),e.exports=t;function t(r,s){if(!qs(this,t))return new t(r);this.data=r||"",this.length=this.data.length,this.ownerDocument=s||null}t.prototype.type="DOMTextNode",t.prototype.nodeType=3,t.prototype.nodeName="#text",t.prototype.toString=function(){return this.data},t.prototype.replaceData=function(r,s,i){var a=this.data,l=a.substring(0,r),d=a.substring(r+s,a.length);this.data=l+i+d,this.length=this.data.length}}),Y1=ar(function(n,e){e.exports=t;function t(r){var s=this,i=r.type;r.target||(r.target=s),s.listeners||(s.listeners={});var a=s.listeners[i];if(a)return a.forEach(function(l){r.currentTarget=s,typeof l=="function"?l(r):l.handleEvent(r)});s.parentNode&&s.parentNode.dispatchEvent(r)}}),Q1=ar(function(n,e){e.exports=t;function t(r,s){var i=this;i.listeners||(i.listeners={}),i.listeners[r]||(i.listeners[r]=[]),i.listeners[r].indexOf(s)===-1&&i.listeners[r].push(s)}}),X1=ar(function(n,e){e.exports=t;function t(r,s){var i=this;if(i.listeners&&i.listeners[r]){var a=i.listeners[r],l=a.indexOf(s);l!==-1&&a.splice(l,1)}}}),vL=ar(function(n,e){z1(),e.exports=r;var t=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function r(g){switch(g.nodeType){case 3:return h(g.data);case 8:return"<!--"+g.data+"-->";default:return s(g)}}function s(g){var x=[],y=g.tagName;return g.namespaceURI==="http://www.w3.org/1999/xhtml"&&(y=y.toLowerCase()),x.push("<"+y+u(g)+l(g)),t.indexOf(y)>-1?x.push(" />"):(x.push(">"),g.childNodes.length?x.push.apply(x,g.childNodes.map(r)):g.textContent||g.innerText?x.push(h(g.textContent||g.innerText)):g.innerHTML&&x.push(g.innerHTML),x.push("</"+y+">")),x.join("")}function i(g,x){var y=K1(g[x]);return x==="style"&&Object.keys(g.style).length>0?!0:g.hasOwnProperty(x)&&(y==="string"||y==="boolean"||y==="number")&&x!=="nodeName"&&x!=="className"&&x!=="tagName"&&x!=="textContent"&&x!=="innerText"&&x!=="namespaceURI"&&x!=="innerHTML"}function a(g){if(typeof g=="string")return g;var x="";return Object.keys(g).forEach(function(y){var E=g[y];y=y.replace(/[A-Z]/g,function(w){return"-"+w.toLowerCase()}),x+=y+":"+E+";"}),x}function l(g){var x=g.dataset,y=[];for(var E in x)y.push({name:"data-"+E,value:x[E]});return y.length?d(y):""}function d(g){var x=[];return g.forEach(function(y){var E=y.name,w=y.value;E==="style"&&(w=a(w)),x.push(E+'="'+p(w)+'"')}),x.length?" "+x.join(" "):""}function u(g){var x=[];for(var y in g)i(g,y)&&x.push({name:y,value:g[y]});for(var E in g._attributes)for(var w in g._attributes[E]){var S=g._attributes[E][w],T=(S.prefix?S.prefix+":":"")+w;x.push({name:T,value:S.value})}return g.className&&x.push({name:"class",value:g.className}),x.length?d(x):""}function h(g){var x="";return typeof g=="string"?x=g:g&&(x=g.toString()),x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function p(g){return h(g).replace(/"/g,"&quot;")}}),Z1=ar(function(n,e){Ks();var t=W1(),r=Y1(),s=Q1(),i=X1(),a=vL(),l="http://www.w3.org/1999/xhtml";e.exports=d;function d(u,h,p){if(!qs(this,d))return new d(u);var g=p===void 0?l:p||null;this.tagName=g===l?String(u).toUpperCase():u,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=h||null,this.namespaceURI=g,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}d.prototype.type="DOMElement",d.prototype.nodeType=1,d.prototype.appendChild=function(u){return u.parentNode&&u.parentNode.removeChild(u),this.childNodes.push(u),u.parentNode=this,u},d.prototype.replaceChild=function(u,h){u.parentNode&&u.parentNode.removeChild(u);var p=this.childNodes.indexOf(h);return h.parentNode=null,this.childNodes[p]=u,u.parentNode=this,h},d.prototype.removeChild=function(u){var h=this.childNodes.indexOf(u);return this.childNodes.splice(h,1),u.parentNode=null,u},d.prototype.insertBefore=function(u,h){u.parentNode&&u.parentNode.removeChild(u);var p=h==null?-1:this.childNodes.indexOf(h);return p>-1?this.childNodes.splice(p,0,u):this.childNodes.push(u),u.parentNode=this,u},d.prototype.setAttributeNS=function(u,h,p){var g=null,x=h,y=h.indexOf(":");if(y>-1&&(g=h.substr(0,y),x=h.substr(y+1)),this.tagName==="INPUT"&&h==="type")this.type=p;else{var E=this._attributes[u]||(this._attributes[u]={});E[x]={value:p,prefix:g}}},d.prototype.getAttributeNS=function(u,h){var p=this._attributes[u],g=p&&p[h]&&p[h].value;return this.tagName==="INPUT"&&h==="type"?this.type:typeof g!="string"?null:g},d.prototype.removeAttributeNS=function(u,h){var p=this._attributes[u];p&&delete p[h]},d.prototype.hasAttributeNS=function(u,h){var p=this._attributes[u];return!!p&&h in p},d.prototype.setAttribute=function(u,h){return this.setAttributeNS(null,u,h)},d.prototype.getAttribute=function(u){return this.getAttributeNS(null,u)},d.prototype.removeAttribute=function(u){return this.removeAttributeNS(null,u)},d.prototype.hasAttribute=function(u){return this.hasAttributeNS(null,u)},d.prototype.removeEventListener=i,d.prototype.addEventListener=s,d.prototype.dispatchEvent=r,d.prototype.focus=function(){},d.prototype.toString=function(){return a(this)},d.prototype.getElementsByClassName=function(u){var h=u.split(" "),p=[];return t(this,function(g){if(g.nodeType===1){var x=g.className||"",y=x.split(" ");h.every(function(E){return y.indexOf(E)!==-1})&&p.push(g)}}),p},d.prototype.getElementsByTagName=function(u){u=u.toLowerCase();var h=[];return t(this.childNodes,function(p){p.nodeType===1&&(u==="*"||p.tagName.toLowerCase()===u)&&h.push(p)}),h},d.prototype.contains=function(u){return t(this,function(h){return u===h})||!1}}),yL=ar(function(n,e){Ks();var t=Z1();e.exports=r;function r(s){if(!qs(this,r))return new r;this.childNodes=[],this.parentNode=null,this.ownerDocument=s||null}r.prototype.type="DocumentFragment",r.prototype.nodeType=11,r.prototype.nodeName="#document-fragment",r.prototype.appendChild=t.prototype.appendChild,r.prototype.replaceChild=t.prototype.replaceChild,r.prototype.removeChild=t.prototype.removeChild,r.prototype.toString=function(){return this.childNodes.map(function(s){return String(s)}).join("")}}),EL=ar(function(n,e){e.exports=t;function t(r){}t.prototype.initEvent=function(r,s,i){this.type=r,this.bubbles=s,this.cancelable=i},t.prototype.preventDefault=function(){}}),wL=ar(function(n,e){Ks();var t=W1(),r=gL(),s=xL(),i=Z1(),a=yL(),l=EL(),d=Y1(),u=Q1(),h=X1();e.exports=p;function p(){if(!qs(this,p))return new p;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var g=p.prototype;g.createTextNode=function(x){return new s(x,this)},g.createElementNS=function(x,y){var E=x===null?null:String(x);return new i(y,this,E)},g.createElement=function(x){return new i(x,this)},g.createDocumentFragment=function(){return new a(this)},g.createEvent=function(x){return new l(x)},g.createComment=function(x){return new r(x,this)},g.getElementById=function(x){x=String(x);var y=t(this.childNodes,function(E){if(String(E.id)===x)return E});return y||null},g.getElementsByClassName=i.prototype.getElementsByClassName,g.getElementsByTagName=i.prototype.getElementsByTagName,g.contains=i.prototype.contains,g.removeEventListener=h,g.addEventListener=u,g.dispatchEvent=d}),bL=ar(function(n,e){var t=wL();e.exports=new t}),J1=ar(function(n,e){var t=typeof global<"u"?global:typeof window<"u"?window:{},r=bL(),s;typeof document<"u"?s=document:(s=t["__GLOBAL_DOCUMENT_CACHE@4"],s||(s=t["__GLOBAL_DOCUMENT_CACHE@4"]=r)),e.exports=s});function SL(n){if(Array.isArray(n))return n}function TL(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],s=!0,i=!1,a,l;try{for(t=t.call(n);!(s=(a=t.next()).done)&&(r.push(a.value),!(e&&r.length===e));s=!0);}catch(d){i=!0,l=d}finally{try{!s&&t.return!=null&&t.return()}finally{if(i)throw l}}return r}}function _L(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ph(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function e2(n,e){if(n){if(typeof n=="string")return ph(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ph(n,e)}}function An(n,e){return SL(n)||TL(n,e)||e2(n,e)||_L()}var Wa=Cr(on()),Fx=Cr(on()),kL=Cr(on()),CL={now:function(){var n=kL.default.performance,e=n&&n.timing,t=e&&e.navigationStart,r=typeof t=="number"&&typeof n.now=="function"?t+n.now():Date.now();return Math.round(r)}},Ot=CL,oo=function(){var n,e,t;if(typeof((n=Fx.default.crypto)===null||n===void 0?void 0:n.getRandomValues)=="function"){t=new Uint8Array(32),Fx.default.crypto.getRandomValues(t);for(var r=0;r<32;r++)t[r]=t[r]%16}else{t=[];for(var s=0;s<32;s++)t[s]=Math.random()*16|0}var i=0;e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var u=d==="x"?t[i]:t[i]&3|8;return i++,u.toString(16)});var a=Ot.now(),l=a?.toString(16).substring(3);return l?e.substring(0,28)+l:e},t2=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},Fr=function(n){if(n&&typeof n.nodeName<"u")return n.muxId||(n.muxId=t2()),n.muxId;var e;try{e=document.querySelector(n)}catch{}return e&&!e.muxId&&(e.muxId=n),e?.muxId||n},Tc=function(n){var e;n&&typeof n.nodeName<"u"?(e=n,n=Fr(e)):e=document.querySelector(n);var t=e&&e.nodeName?e.nodeName.toLowerCase():"";return[e,n,t]};function IL(n){if(Array.isArray(n))return ph(n)}function AL(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function LL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ur(n){return IL(n)||AL(n)||e2(n)||LL()}var js={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4},RL=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t,r,s,i,a,l=[console,n],d=(t=console.trace).bind.apply(t,Ur(l)),u=(r=console.info).bind.apply(r,Ur(l)),h=(s=console.debug).bind.apply(s,Ur(l)),p=(i=console.warn).bind.apply(i,Ur(l)),g=(a=console.error).bind.apply(a,Ur(l)),x=e;return{trace:function(){for(var y=arguments.length,E=new Array(y),w=0;w<y;w++)E[w]=arguments[w];if(!(x>js.TRACE))return d.apply(void 0,Ur(E))},debug:function(){for(var y=arguments.length,E=new Array(y),w=0;w<y;w++)E[w]=arguments[w];if(!(x>js.DEBUG))return h.apply(void 0,Ur(E))},info:function(){for(var y=arguments.length,E=new Array(y),w=0;w<y;w++)E[w]=arguments[w];if(!(x>js.INFO))return u.apply(void 0,Ur(E))},warn:function(){for(var y=arguments.length,E=new Array(y),w=0;w<y;w++)E[w]=arguments[w];if(!(x>js.WARN))return p.apply(void 0,Ur(E))},error:function(){for(var y=arguments.length,E=new Array(y),w=0;w<y;w++)E[w]=arguments[w];if(!(x>js.ERROR))return g.apply(void 0,Ur(E))},get level(){return x},set level(y){y!==this.level&&(x=y??e)}}},Je=RL("[mux]"),_f=Cr(on());function gh(){var n=_f.default.doNotTrack||_f.default.navigator&&_f.default.navigator.doNotTrack;return n==="1"}function Ae(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}Ks();function Lt(n,e){if(!qs(n,e))throw new TypeError("Cannot call a class as a function")}function NL(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function ln(n,e,t){return e&&NL(n.prototype,e),n}function me(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $i(n){return $i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$i(n)}function DL(n,e){for(;!Object.prototype.hasOwnProperty.call(n,e)&&(n=$i(n),n!==null););return n}function uc(n,e,t){return typeof Reflect<"u"&&Reflect.get?uc=Reflect.get:uc=function(r,s,i){var a=DL(r,s);if(a){var l=Object.getOwnPropertyDescriptor(a,s);return l.get?l.get.call(i||r):l.value}},uc(n,e,t||n)}function xh(n,e){return xh=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},xh(n,e)}function PL(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&xh(n,e)}function OL(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function jL(n,e){if(n==null)return{};var t=OL(n,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function ML(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}z1();function FL(n,e){return e&&(K1(e)==="object"||typeof e=="function")?e:Ae(n)}function UL(n){var e=ML();return function(){var t=$i(n),r;if(e){var s=$i(this).constructor;r=Reflect.construct(t,arguments,s)}else r=t.apply(this,arguments);return FL(this,r)}}var $r=function(n){return lo(n)[0]},lo=function(n){if(typeof n!="string"||n==="")return["localhost"];var e=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t=n.match(e)||[],r=t[4],s;return r&&(s=(r.match(/[^\.]+\.[^\.]+$/)||[])[0]),[r,s]},kf=Cr(on()),BL={exists:function(){var n=kf.default.performance,e=n&&n.timing;return e!==void 0},domContentLoadedEventEnd:function(){var n=kf.default.performance,e=n&&n.timing;return e&&e.domContentLoadedEventEnd},navigationStart:function(){var n=kf.default.performance,e=n&&n.timing;return e&&e.navigationStart}},_c=BL;function At(n,e,t){t=t===void 0?1:t,n[e]=n[e]||0,n[e]+=t}function kc(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){me(n,s,t[s])})}return n}function $L(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t}function r0(n,e){return e=e??{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):$L(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n}var VL=["x-cdn","content-type"],r2=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],GL=VL.concat(r2);function n0(n){n=n||"";var e={},t=n.trim().split(/[\r\n]+/);return t.forEach(function(r){if(r){var s=r.split(": "),i=s.shift();i&&(GL.indexOf(i.toLowerCase())>=0||i.toLowerCase().indexOf("x-litix-")===0)&&(e[i]=s.join(": "))}}),e}function Cc(n){if(n){var e=r2.find(function(t){return n[t]!==void 0});return e?n[e]:void 0}}var HL=function(n){var e={};for(var t in n){var r=n[t],s=r["DATA-ID"].search("io.litix.data.");if(s!==-1){var i=r["DATA-ID"].replace("io.litix.data.","");e[i]=r.VALUE}}return e},n2=HL,Wl=function(n){if(!n)return{};var e=_c.navigationStart(),t=n.loading,r=t?t.start:n.trequest,s=t?t.first:n.tfirst,i=t?t.end:n.tload;return{bytesLoaded:n.total,requestStart:Math.round(e+r),responseStart:Math.round(e+s),responseEnd:Math.round(e+i)}},Ua=function(n){if(!(!n||typeof n.getAllResponseHeaders!="function"))return n0(n.getAllResponseHeaders())},qL=function(n,e,t){var r=arguments.length>4?arguments[4]:void 0,s=n.log,i=n.utils.secondsToMs,a=function(w){var S=parseInt(r.version),T;return S===1&&w.programDateTime!==null&&(T=w.programDateTime),S===0&&w.pdt!==null&&(T=w.pdt),T};if(!_c.exists()){s.warn("performance timing not supported. Not tracking HLS.js.");return}var l=function(w,S){return n.emit(e,w,S)},d=function(w,S){var T=S.levels,k=S.audioTracks,I=S.url,L=S.stats,O=S.networkDetails,P=S.sessionData,j={},F={};T.forEach(function(X,Z){j[Z]={width:X.width,height:X.height,bitrate:X.bitrate,attrs:X.attrs}}),k.forEach(function(X,Z){F[Z]={name:X.name,language:X.lang,bitrate:X.bitrate}});var D=Wl(L),$=D.bytesLoaded,J=D.requestStart,ne=D.responseStart,se=D.responseEnd;l("requestcompleted",r0(kc({},n2(P)),{request_event_type:w,request_bytes_loaded:$,request_start:J,request_response_start:ne,request_response_end:se,request_type:"manifest",request_hostname:$r(I),request_response_headers:Ua(O),request_rendition_lists:{media:j,audio:F,video:{}}}))};t.on(r.Events.MANIFEST_LOADED,d);var u=function(w,S){var T=S.details,k=S.level,I=S.networkDetails,L=S.stats,O=Wl(L),P=O.bytesLoaded,j=O.requestStart,F=O.responseStart,D=O.responseEnd,$=T.fragments[T.fragments.length-1],J=a($)+i($.duration);l("requestcompleted",{request_event_type:w,request_bytes_loaded:P,request_start:j,request_response_start:F,request_response_end:D,request_current_level:k,request_type:"manifest",request_hostname:$r(T.url),request_response_headers:Ua(I),video_holdback:T.holdBack&&i(T.holdBack),video_part_holdback:T.partHoldBack&&i(T.partHoldBack),video_part_target_duration:T.partTarget&&i(T.partTarget),video_target_duration:T.targetduration&&i(T.targetduration),video_source_is_live:T.live,player_manifest_newest_program_time:isNaN(J)?void 0:J})};t.on(r.Events.LEVEL_LOADED,u);var h=function(w,S){var T=S.details,k=S.networkDetails,I=S.stats,L=Wl(I),O=L.bytesLoaded,P=L.requestStart,j=L.responseStart,F=L.responseEnd;l("requestcompleted",{request_event_type:w,request_bytes_loaded:O,request_start:P,request_response_start:j,request_response_end:F,request_type:"manifest",request_hostname:$r(T.url),request_response_headers:Ua(k)})};t.on(r.Events.AUDIO_TRACK_LOADED,h);var p=function(w,S){var T=S.stats,k=S.networkDetails,I=S.frag;T=T||I.stats;var L=Wl(T),O=L.bytesLoaded,P=L.requestStart,j=L.responseStart,F=L.responseEnd,D=k?Ua(k):void 0,$={request_event_type:w,request_bytes_loaded:O,request_start:P,request_response_start:j,request_response_end:F,request_hostname:k?$r(k.responseURL):void 0,request_id:D?Cc(D):void 0,request_response_headers:D,request_media_duration:I.duration,request_url:k?.responseURL};I.type==="main"?($.request_type="media",$.request_current_level=I.level,$.request_video_width=(t.levels[I.level]||{}).width,$.request_video_height=(t.levels[I.level]||{}).height,$.request_labeled_bitrate=(t.levels[I.level]||{}).bitrate):$.request_type=I.type,l("requestcompleted",$)};t.on(r.Events.FRAG_LOADED,p);var g=function(w,S){var T=S.frag,k=T.start,I=a(T),L={currentFragmentPDT:I,currentFragmentStart:i(k)};l("fragmentchange",L)};t.on(r.Events.FRAG_CHANGED,g);var x=function(w,S){var T=S.type,k=S.details,I=S.response,L=S.fatal,O=S.frag,P=S.networkDetails,j=O?.url||S.url||"",F=P?Ua(P):void 0;if((k===r.ErrorDetails.MANIFEST_LOAD_ERROR||k===r.ErrorDetails.MANIFEST_LOAD_TIMEOUT||k===r.ErrorDetails.FRAG_LOAD_ERROR||k===r.ErrorDetails.FRAG_LOAD_TIMEOUT||k===r.ErrorDetails.LEVEL_LOAD_ERROR||k===r.ErrorDetails.LEVEL_LOAD_TIMEOUT||k===r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||k===r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||k===r.ErrorDetails.SUBTITLE_LOAD_ERROR||k===r.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||k===r.ErrorDetails.KEY_LOAD_ERROR||k===r.ErrorDetails.KEY_LOAD_TIMEOUT)&&l("requestfailed",{request_error:k,request_url:j,request_hostname:$r(j),request_id:F?Cc(F):void 0,request_type:k===r.ErrorDetails.FRAG_LOAD_ERROR||k===r.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":k===r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||k===r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":k===r.ErrorDetails.SUBTITLE_LOAD_ERROR||k===r.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":k===r.ErrorDetails.KEY_LOAD_ERROR||k===r.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:I?.code,request_error_text:I?.text}),L){var D,$="".concat(j?"url: ".concat(j,`
`):"")+"".concat(I&&(I.code||I.text)?"response: ".concat(I.code,", ").concat(I.text,`
`):"")+"".concat(S.reason?"failure reason: ".concat(S.reason,`
`):"")+"".concat(S.level?"level: ".concat(S.level,`
`):"")+"".concat(S.parent?"parent stream controller: ".concat(S.parent,`
`):"")+"".concat(S.buffer?"buffer length: ".concat(S.buffer,`
`):"")+"".concat(S.error?"error: ".concat(S.error,`
`):"")+"".concat(S.event?"event: ".concat(S.event,`
`):"")+"".concat(S.err?"error message: ".concat((D=S.err)===null||D===void 0?void 0:D.message,`
`):"");l("error",{player_error_code:T,player_error_message:k,player_error_context:$})}};t.on(r.Events.ERROR,x);var y=function(w,S){var T=S.frag,k=T&&T._url||"";l("requestcanceled",{request_event_type:w,request_url:k,request_type:"media",request_hostname:$r(k)})};t.on(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,y);var E=function(w,S){var T=S.level,k=t.levels[T];if(k&&k.attrs&&k.attrs.BANDWIDTH){var I=k.attrs.BANDWIDTH,L,O=parseFloat(k.attrs["FRAME-RATE"]);isNaN(O)||(L=O),I?l("renditionchange",{video_source_fps:L,video_source_bitrate:I,video_source_width:k.width,video_source_height:k.height,video_source_rendition_name:k.name,video_source_codec:k?.videoCodec}):s.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};t.on(r.Events.LEVEL_SWITCHED,E),t._stopMuxMonitor=function(){t.off(r.Events.MANIFEST_LOADED,d),t.off(r.Events.LEVEL_LOADED,u),t.off(r.Events.AUDIO_TRACK_LOADED,h),t.off(r.Events.FRAG_LOADED,p),t.off(r.Events.FRAG_CHANGED,g),t.off(r.Events.ERROR,x),t.off(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,y),t.off(r.Events.LEVEL_SWITCHED,E),t.off(r.Events.DESTROYING,t._stopMuxMonitor),delete t._stopMuxMonitor},t.on(r.Events.DESTROYING,t._stopMuxMonitor)},KL=function(n){n&&typeof n._stopMuxMonitor=="function"&&n._stopMuxMonitor()},Ux=function(n,e){if(!n||!n.requestEndDate)return{};var t=$r(n.url),r=n.url,s=n.bytesLoaded,i=new Date(n.requestStartDate).getTime(),a=new Date(n.firstByteDate).getTime(),l=new Date(n.requestEndDate).getTime(),d=isNaN(n.duration)?0:n.duration,u=typeof e.getMetricsFor=="function"?e.getMetricsFor(n.mediaType).HttpList:e.getDashMetrics().getHttpRequests(n.mediaType),h;u.length>0&&(h=n0(u[u.length-1]._responseHeaders||""));var p=h?Cc(h):void 0;return{requestStart:i,requestResponseStart:a,requestResponseEnd:l,requestBytesLoaded:s,requestResponseHeaders:h,requestMediaDuration:d,requestHostname:t,requestUrl:r,requestId:p}},zL=function(n,e){var t=e.getQualityFor(n),r=e.getCurrentTrackFor(n).bitrateList;return r?{currentLevel:t,renditionWidth:r[t].width||null,renditionHeight:r[t].height||null,renditionBitrate:r[t].bandwidth}:{}},WL=function(n){var e;return(e=n.match(/.*codecs\*?="(.*)"/))===null||e===void 0?void 0:e[1]},YL=function(n){try{var e,t,r=(t=n.getVersion)===null||t===void 0||(e=t.call(n))===null||e===void 0?void 0:e.split(".").map(function(s){return parseInt(s)})[0];return r}catch{return!1}},QL=function(n,e,t){var r=n.log;if(!t||!t.on){r.warn("Invalid dash.js player reference. Monitoring blocked.");return}var s=YL(t),i=function(T,k){return n.emit(e,T,k)},a=function(T){var k=T.type,I=T.data,L=(I||{}).url;i("requestcompleted",{request_event_type:k,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:$r(L),request_url:L})};t.on("manifestLoaded",a);var l={},d=function(T){if(typeof T.getRequests!="function")return null;var k=T.getRequests({state:"executed"});return k.length===0?null:k[k.length-1]},u=function(T){var k=T.type,I=T.fragmentModel,L=T.chunk,O=d(I);h({type:k,request:O,chunk:L})},h=function(T){var k=T.type,I=T.chunk,L=T.request,O=(I||{}).mediaInfo,P=O||{},j=P.type,F=P.bitrateList;F=F||[];var D={};F.forEach(function(W,N){D[N]={},D[N].width=W.width,D[N].height=W.height,D[N].bitrate=W.bandwidth,D[N].attrs={}}),j==="video"?l.video=D:j==="audio"?l.audio=D:l.media=D;var $=Ux(L,t),J=$.requestStart,ne=$.requestResponseStart,se=$.requestResponseEnd,X=$.requestResponseHeaders,Z=$.requestMediaDuration,ie=$.requestHostname,G=$.requestUrl,Q=$.requestId;i("requestcompleted",{request_event_type:k,request_start:J,request_response_start:ne,request_response_end:se,request_bytes_loaded:-1,request_type:j+"_init",request_response_headers:X,request_hostname:ie,request_id:Q,request_url:G,request_media_duration:Z,request_rendition_lists:l})};s>=4?t.on("initFragmentLoaded",h):t.on("initFragmentLoaded",u);var p=function(T){var k=T.type,I=T.fragmentModel,L=T.chunk,O=d(I);g({type:k,request:O,chunk:L})},g=function(T){var k=T.type,I=T.chunk,L=T.request,O=I||{},P=O.mediaInfo,j=O.start,F=P||{},D=F.type,$=Ux(L,t),J=$.requestStart,ne=$.requestResponseStart,se=$.requestResponseEnd,X=$.requestBytesLoaded,Z=$.requestResponseHeaders,ie=$.requestMediaDuration,G=$.requestHostname,Q=$.requestUrl,W=$.requestId,N=zL(D,t),U=N.currentLevel,re=N.renditionWidth,de=N.renditionHeight,ue=N.renditionBitrate;i("requestcompleted",{request_event_type:k,request_start:J,request_response_start:ne,request_response_end:se,request_bytes_loaded:X,request_type:D,request_response_headers:Z,request_hostname:G,request_id:W,request_url:Q,request_media_start_time:j,request_media_duration:ie,request_current_level:U,request_labeled_bitrate:ue,request_video_width:re,request_video_height:de})};s>=4?t.on("mediaFragmentLoaded",g):t.on("mediaFragmentLoaded",p);var x={video:void 0,audio:void 0,totalBitrate:void 0},y=function(){if(x.video&&typeof x.video.bitrate=="number"){if(!(x.video.width&&x.video.height)){r.warn("have bitrate info for video but missing width/height");return}var T=x.video.bitrate;if(x.audio&&typeof x.audio.bitrate=="number"&&(T+=x.audio.bitrate),T!==x.totalBitrate)return x.totalBitrate=T,{video_source_bitrate:T,video_source_height:x.video.height,video_source_width:x.video.width,video_source_codec:WL(x.video.codec)}}},E=function(T,k,I){if(typeof T.newQuality!="number"){r.warn("missing evt.newQuality in qualityChangeRendered event",T);return}var L=T.mediaType;if(L==="audio"||L==="video"){var O=t.getBitrateInfoListFor(L).find(function(j){var F=j.qualityIndex;return F===T.newQuality});if(!(O&&typeof O.bitrate=="number")){r.warn("missing bitrate info for ".concat(L));return}x[L]=r0(kc({},O),{codec:t.getCurrentTrackFor(L).codec});var P=y();P&&i("renditionchange",P)}};t.on("qualityChangeRendered",E);var w=function(T){var k=T.request,I=T.mediaType;k=k||{},i("requestcanceled",{request_event_type:k.type+"_"+k.action,request_url:k.url,request_type:I,request_hostname:$r(k.url)})};t.on("fragmentLoadingAbandoned",w);var S=function(T){var k=T.error,I,L,O=(k==null||(I=k.data)===null||I===void 0?void 0:I.request)||{},P=(k==null||(L=k.data)===null||L===void 0?void 0:L.response)||{};k?.code===27&&i("requestfailed",{request_error:O.type+"_"+O.action,request_url:O.url,request_hostname:$r(O.url),request_type:O.mediaType,request_error_code:P.status,request_error_text:P.statusText});var j="".concat(O!=null&&O.url?"url: ".concat(O.url,`
`):"")+"".concat(P!=null&&P.status||P!=null&&P.statusText?"response: ".concat(P?.status,", ").concat(P?.statusText,`
`):"");i("error",{player_error_code:k?.code,player_error_message:k?.message,player_error_context:j})};t.on("error",S),t._stopMuxMonitor=function(){t.off("manifestLoaded",a),t.off("initFragmentLoaded",h),t.off("mediaFragmentLoaded",g),t.off("qualityChangeRendered",E),t.off("error",S),t.off("fragmentLoadingAbandoned",w),delete t._stopMuxMonitor}},XL=function(n){n&&typeof n._stopMuxMonitor=="function"&&n._stopMuxMonitor()},Bx=0,ZL=(function(){function n(){Lt(this,n),me(this,"_listeners",void 0)}return ln(n,[{key:"on",value:function(e,t,r){return t._eventEmitterGuid=t._eventEmitterGuid||++Bx,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],r&&(t=t.bind(r)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var r=this._listeners&&this._listeners[e];r&&r.forEach(function(s,i){s._eventEmitterGuid===t._eventEmitterGuid&&r.splice(i,1)})}},{key:"one",value:function(e,t,r){var s=this;t._eventEmitterGuid=t._eventEmitterGuid||++Bx;var i=function(){s.off(e,i),t.apply(r||this,arguments)};i._eventEmitterGuid=t._eventEmitterGuid,this.on(e,i)}},{key:"emit",value:function(e,t){var r=this;if(this._listeners){t=t||{};var s=this._listeners["before"+e]||[],i=this._listeners["before*"]||[],a=this._listeners[e]||[],l=this._listeners["after"+e]||[],d=function(u,h){u=u.slice(),u.forEach(function(p){p.call(r,{type:e},h)})};d(s,t),d(i,t),d(a,t),d(l,t)}}}]),n})(),JL=ZL,Cf=Cr(on()),e3=(function(){function n(e){var t=this;Lt(this,n),me(this,"_playbackHeartbeatInterval",void 0),me(this,"_playheadShouldBeProgressing",void 0),me(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(r,s){t._playbackHeartbeatInterval!==null&&(Cf.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:s.viewer_time}),t._playbackHeartbeatInterval=null)})}return ln(n,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=Cf.default.setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(Cf.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),n})(),t3=e3,r3=function n(e){var t=this;Lt(this,n),me(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(r,s){try{var i=e.errorTranslator({player_error_code:s.player_error_code,player_error_message:s.player_error_message,player_error_context:s.player_error_context,player_error_severity:s.player_error_severity,player_error_business_exception:s.player_error_business_exception});i&&(e.data.player_error_code=i.player_error_code||s.player_error_code,e.data.player_error_message=i.player_error_message||s.player_error_message,e.data.player_error_context=i.player_error_context||s.player_error_context,e.data.player_error_severity=i.player_error_severity||s.player_error_severity,e.data.player_error_business_exception=i.player_error_business_exception||s.player_error_business_exception,t.viewErrored=!0)}catch(a){e.mux.log.warn("Exception in error translator callback.",a),t.viewErrored=!0}}),e.on("aftererror",function(){var r,s,i,a,l;(r=e.data)===null||r===void 0||delete r.player_error_code,(s=e.data)===null||s===void 0||delete s.player_error_message,(i=e.data)===null||i===void 0||delete i.player_error_context,(a=e.data)===null||a===void 0||delete a.player_error_severity,(l=e.data)===null||l===void 0||delete l.player_error_business_exception})},n3=r3,s3=(function(){function n(e){Lt(this,n),me(this,"_watchTimeTrackerLastCheckedTime",void 0),me(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return ln(n,[{key:"_updateWatchTime",value:function(e,t){var r=t.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=r),At(this.pm.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),n})(),i3=s3,a3=(function(){function n(e){var t=this;Lt(this,n),me(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),me(this,"_lastTime",void 0),me(this,"_isAdPlaying",void 0),me(this,"_callbackUpdatePlaybackTime",void 0),me(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=Ot.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null,e.on("viewinit",function(){t.pm.data.view_playing_time_ms_cumulative=0});var r=this._startPlaybackTimeTracking.bind(this);e.on("playing",r),e.on("adplaying",r),e.on("seeked",r),e.on("rebufferend",r);var s=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",s),e.on("seeking",s),e.on("rebufferstart",s),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=Ot.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return ln(n,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this._lastTime=Ot.now(),this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time||0,t=Ot.now(),r=t-this._lastTime,s=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?s=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(s=r),s>0&&s<=1e3&&At(this.pm.data,"view_content_playback_time",s),this._callbackUpdatePlaybackTime!==null&&r>0&&r<=1e3&&(this._isAdPlaying&&At(this.pm.data,"ad_playing_time_ms_cumulative",r),At(this.pm.data,"view_playing_time_ms_cumulative",r)),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}]),n})(),o3=a3,l3=(function(){function n(e){Lt(this,n),me(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return ln(n,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position>"u"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var r=this,s=function(){r.pm.currentFragmentPDT&&r.pm.currentFragmentStart&&(r.pm.data.player_program_time=r.pm.currentFragmentPDT+r.pm.data.player_playhead_time-r.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,s(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var i=this.pm.getPlayheadTime();typeof i<"u"&&(this.pm.data.player_playhead_time=i,s(),this._updateMaxPlayheadPosition())}}}]),n})(),c3=l3,$x=300*1e3,u3=function n(e){if(Lt(this,n),!e.disableRebufferTracking){var t,r=function(i,a){s(a),t=void 0},s=function(i){if(t){var a=i.viewer_time-t;At(e.data,"view_rebuffer_duration",a),t=i.viewer_time,e.data.view_rebuffer_duration>$x&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat($x,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(i,a){return s(a)}),e.on("rebufferstart",function(i,a){t||(At(e.data,"view_rebuffer_count",1),t=a.viewer_time,e.one("rebufferend",r))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",r)})}},d3=u3,f3=(function(){function n(e){var t=this;Lt(this,n),me(this,"_lastCheckedTime",void 0),me(this,"_lastPlayheadTime",void 0),me(this,"_lastPlayheadTimeUpdatedTime",void 0),me(this,"_rebuffering",void 0),me(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:Ot.now()})}))}return ln(n,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(e,t);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(t.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(e,t,!0);return}var r=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&r>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(this._lastCheckedTime===null)return;var s=this.pm.data.player_playhead_time-this._lastPlayheadTime,i=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&s>0&&i-s>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+i-s}))}r?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),n})(),h3=f3,m3=(function(){function n(e){var t=this;Lt(this,n),me(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var r=e.data,s=r.view_id;if(!r.view_program_changed){var i=function(a,l){var d=l.viewer_time;(a.type==="playing"&&typeof e.data.view_time_to_first_frame>"u"||a.type==="adplaying"&&(typeof e.data.view_time_to_first_frame>"u"||t._inPrerollPosition()))&&t.calculateTimeToFirstFrame(d||Ot.now(),s)};e.one("playing",i),e.one("adplaying",i),e.one("viewend",function(){e.off("playing",i),e.off("adplaying",i)})}})}return ln(n,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time>"u"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.pm.pageLoadInitTime&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.pm.pageLoadInitTime))}}]),n})(),p3=m3,g3=function n(e){var t=this;Lt(this,n),me(this,"_lastPlayerHeight",void 0),me(this,"_lastPlayerWidth",void 0),me(this,"_lastPlayheadPosition",void 0),me(this,"_lastSourceHeight",void 0),me(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var r=["pause","rebufferstart","seeking","error","adbreakstart","hb","renditionchange","orientationchange","viewend","playbackmodechange"],s=["playing","hb","renditionchange","orientationchange","playbackmodechange"];r.forEach(function(i){e.on(i,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var a=e.data.player_playhead_time-t._lastPlayheadPosition;if(a<0){t._lastPlayheadPosition=-1;return}var l=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),d=Math.max(0,l-1),u=Math.max(0,1-l);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,d),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,u),At(e.data,"view_total_content_playback_time",a),At(e.data,"view_total_upscaling",d*a),At(e.data,"view_total_downscaling",u*a)}t._lastPlayheadPosition=-1})}),s.forEach(function(i){e.on(i,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},x3=g3,v3=2e3,y3=function n(e){var t=this;Lt(this,n),me(this,"isSeeking",void 0),this.isSeeking=!1;var r=-1,s=function(){var i=Ot.now(),a=(e.data.viewer_time||i)-(r||i);At(e.data,"view_seek_duration",a),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,a),t.isSeeking=!1,r=-1};e.on("seeking",function(i,a){if(Object.assign(e.data,a),t.isSeeking&&a.viewer_time-r<=v3){r=a.viewer_time;return}t.isSeeking&&s(),t.isSeeking=!0,r=a.viewer_time,At(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){s()}),e.on("viewend",function(){t.isSeeking&&(s(),e.send("seeked")),t.isSeeking=!1,r=-1})},E3=y3,Vx=function(n,e){n.push(e),n.sort(function(t,r){return t.viewer_time-r.viewer_time})},w3=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],b3=(function(){function n(e){var t=this;Lt(this,n),me(this,"_adHasPlayed",void 0),me(this,"_adRequests",void 0),me(this,"_adResponses",void 0),me(this,"_currentAdRequestNumber",void 0),me(this,"_currentAdResponseNumber",void 0),me(this,"_prerollPlayTime",void 0),me(this,"_wouldBeNewAdPlay",void 0),me(this,"isAdBreak",void 0),me(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),w3.forEach(function(s){return e.on(s,t._updateAdData.bind(t))});var r=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",r),e.on("playing",r),e.on("viewend",r),e.on("adrequest",function(s,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},i),Vx(t._adRequests,i),At(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||At(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(s,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},i),Vx(t._adResponses,i);var a=t.findAdRequest(i.ad_request_id);a&&At(e.data,"view_ad_request_time",Math.max(0,i.viewer_time-a.viewer_time))}),e.on("adplay",function(s,i){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,At(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,i.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,i.viewer_time-e.data.view_start)),t._prerollPlayTime=i.viewer_time)}),e.on("adplaying",function(s,i){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time>"u"&&typeof t._prerollPlayTime<"u"&&(e.data.view_preroll_load_time=i.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=i.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(s,i){t._wouldBeNewAdPlay||At(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(s,i){t._wouldBeNewAdPlay||At(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return ln(n,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time>"u"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var r=An(lo(t.ad_tag_url),2),s=r[0],i=r[1];this.pm.data.view_preroll_ad_tag_domain=i,this.pm.data.view_preroll_ad_tag_hostname=s}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=An(lo(t.ad_asset_url),2),l=a[0],d=a[1];this.pm.data.view_preroll_ad_asset_domain=d,this.pm.data.view_preroll_ad_asset_hostname=l}this.pm.data.ad_type="preroll"}this.pm.data.ad_asset_url=t?.ad_asset_url,this.pm.data.ad_tag_url=t?.ad_tag_url,this.pm.data.ad_creative_id=t?.ad_creative_id,this.pm.data.ad_id=t?.ad_id,this.pm.data.ad_universal_id=t?.ad_universal_id,t!=null&&t.ad_type&&(this.pm.data.ad_type=t?.ad_type)}}]),n})(),S3=b3,T3=function n(e){var t=this;Lt(this,n),me(this,"lastWallClockTime",void 0);var r=function(){t.lastWallClockTime=Ot.now(),e.on("before*",s)},s=function(i){var a=Ot.now(),l=t.lastWallClockTime;t.lastWallClockTime=a,a-l>3e4&&(e.emit("devicesleep",{viewer_time:l}),Object.assign(e.data,{viewer_time:l}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:a}),Object.assign(e.data,{viewer_time:a}),e.send("devicewake"))};e.one("playbackheartbeat",r),e.on("playbackheartbeatend",function(){e.off("before*",s),e.one("playbackheartbeat",r)})},_3=T3,If=Cr(on()),s2=(function(n){return n()})(function(){var n=function(){for(var t=0,r={};t<arguments.length;t++){var s=arguments[t];for(var i in s)r[i]=s[i]}return r};function e(t){function r(s,i,a){var l;if(typeof document<"u"){if(arguments.length>1){if(a=n({path:"/"},r.defaults,a),typeof a.expires=="number"){var d=new Date;d.setMilliseconds(d.getMilliseconds()+a.expires*864e5),a.expires=d}try{l=JSON.stringify(i),/^[\{\[]/.test(l)&&(i=l)}catch{}return t.write?i=t.write(i,s):i=encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),s=encodeURIComponent(String(s)),s=s.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),s=s.replace(/[\(\)]/g,escape),document.cookie=[s,"=",i,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}s||(l={});for(var u=document.cookie?document.cookie.split("; "):[],h=/(%[0-9A-Z]{2})+/g,p=0;p<u.length;p++){var g=u[p].split("="),x=g.slice(1).join("=");x.charAt(0)==='"'&&(x=x.slice(1,-1));try{var y=g[0].replace(h,decodeURIComponent);if(x=t.read?t.read(x,y):t(x,y)||x.replace(h,decodeURIComponent),this.json)try{x=JSON.parse(x)}catch{}if(s===y){l=x;break}s||(l[y]=x)}catch{}}return l}}return r.set=r,r.get=function(s){return r.call(r,s)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(s,i){r(s,"",n(i,{expires:-1}))},r.withConverter=e,r}return e(function(){})}),i2="muxData",k3=function(n){return Object.entries(n).map(function(e){var t=An(e,2),r=t[0],s=t[1];return"".concat(r,"=").concat(s)}).join("&")},C3=function(n){return n.split("&").reduce(function(e,t){var r=An(t.split("="),2),s=r[0],i=r[1],a=+i,l=i&&a==i?a:i;return e[s]=l,e},{})},a2=function(){var n;try{n=C3(s2.get(i2)||"")}catch{n={}}return n},o2=function(n){try{s2.set(i2,k3(n),{expires:365})}catch{}},I3=function(){var n=a2();return n.mux_viewer_id=n.mux_viewer_id||oo(),n.msn=n.msn||Math.random(),o2(n),{mux_viewer_id:n.mux_viewer_id,mux_sample_number:n.msn}},A3=function(){var n=a2(),e=Ot.now();return n.session_start&&(n.sst=n.session_start,delete n.session_start),n.session_id&&(n.sid=n.session_id,delete n.session_id),n.session_expires&&(n.sex=n.session_expires,delete n.session_expires),(!n.sex||n.sex<e)&&(n.sid=oo(),n.sst=e),n.sex=e+1500*1e3,o2(n),{session_id:n.sid,session_start:n.sst,session_expires:n.sex}};function L3(n,e){var t=e.beaconCollectionDomain,r=e.beaconDomain;if(t)return"https://"+t;n=n||"inferred";var s=r||"litix.io";return n.match(/^[a-z0-9]+$/)?"https://"+n+"."+s:"https://img.litix.io/a.gif"}var R3=Cr(on()),l2=function(){var n;switch(c2()){case"cellular":n="cellular";break;case"ethernet":n="wired";break;case"wifi":n="wifi";break;case void 0:break;default:n="other"}return n},c2=function(){var n=R3.default.navigator,e=n&&(n.connection||n.mozConnection||n.webkitConnection);return e&&e.type};l2.getConnectionFromAPI=c2;var N3=l2,D3={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},P3=u2(D3),O3={ad:"ad",af:"affiliate",ag:"aggregate",ap:"api",al:"application",ao:"audio",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",bn:"brand",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ci:"client",ck:"clicked",cl:"canceled",cm:"cmcd",cn:"config",co:"count",ce:"counter",cp:"complete",cq:"creator",cr:"creative",cs:"captions",ct:"content",cu:"current",cv:"cumulative",cx:"connection",cz:"context",da:"data",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",dy:"dynamic",eb:"enabled",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mp:"mode",ms:"ms",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",or:"origin",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pp:"pip",pr:"preload",ps:"position",pt:"part",pv:"previous",py:"property",px:"pop",pz:"plan",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rg:"range",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sh:"shift",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",ss:"status",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},Gx=u2(O3);function u2(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function vh(n){var e={},t={};return Object.keys(n).forEach(function(r){var s=!1;if(n.hasOwnProperty(r)&&n[r]!==void 0){var i=r.split("_"),a=i[0],l=P3[a];l||(Je.info("Data key word `"+i[0]+"` not expected in "+r),l=a+"_"),i.splice(1).forEach(function(d){d==="url"&&(s=!0),Gx[d]?l+=Gx[d]:Number.isInteger(Number(d))?l+=d:(Je.info("Data key word `"+d+"` not expected in "+r),l+="_"+d+"_")}),s?t[l]=n[r]:e[l]=n[r]}}),Object.assign(e,t)}var Ms=Cr(on()),j3=Cr(J1()),M3={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},F3=56*1024,U3=["hb","requestcompleted","requestfailed","requestcanceled"],B3="https://img.litix.io",Dn=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=n||B3,this._eventQueue=[],this._postInFlight=!1,this._resendAfterPost=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},M3,e)};Dn.prototype.queueEvent=function(n,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||n==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};Dn.prototype.flushEvents=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};Dn.prototype.destroy=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,n?this._clearBeaconQueue():this.flushEvents(),Ms.default.clearTimeout(this._sendTimeout)};Dn.prototype._clearBeaconQueue=function(){var n=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(n);n>0&&Object.assign(e[e.length-1],vh({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);d2(this._beaconUrl,t,!0,function(){})};Dn.prototype._sendBeaconQueue=function(){var n=this;if(this._postInFlight){this._resendAfterPost=!0;return}var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),r=Ot.now();d2(this._beaconUrl,t,!1,function(s,i){i?(n._eventQueue=e.concat(n._eventQueue),n._failureCount+=1,Je.info("Error sending beacon: "+i)):n._failureCount=0,n._roundTripTime=Ot.now()-r,n._postInFlight=!1,n._resendAfterPost&&(n._resendAfterPost=!1,n._eventQueue.length>0&&n._sendBeaconQueue())})};Dn.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var n=Math.pow(2,this._failureCount-1);return n=n*Math.random(),(1+n)*this._options.baseTimeBetweenBeacons};Dn.prototype._startBeaconSending=function(){var n=this;Ms.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=Ms.default.setTimeout(function(){n._eventQueue.length&&n._sendBeaconQueue(),n._startBeaconSending()},this._getNextBeaconTime()))};Dn.prototype._createPayload=function(n){var e=this,t={transmission_timestamp:Math.round(Ot.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var r,s,i,a=function(){r=JSON.stringify({metadata:t,events:s||n}),i=r.length/1024},l=function(){return i<=e._options.maxPayloadKBSize};return a(),l()||(Je.info("Payload size is too big ("+i+" kb). Removing unnecessary events."),s=n.filter(function(d){return U3.indexOf(d.e)===-1}),a()),l()||(Je.info("Payload size still too big ("+i+" kb). Cropping fields.."),s.forEach(function(d){for(var u in d){var h=d[u],p=50*1024;typeof h=="string"&&h.length>p&&(d[u]=h.substring(0,p))}}),a()),r};var $3=typeof j3.default.exitPictureInPicture=="function"?function(n){return n.length<=F3}:function(n){return!1},d2=function(n,e,t,r){if(t&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(n,e)){r();return}if(Ms.default.fetch){Ms.default.fetch(n,{method:"POST",body:e,headers:{"Content-Type":"text/plain"},keepalive:$3(e)}).then(function(i){return r(null,i.ok?null:"Error")}).catch(function(i){return r(null,i)});return}if(Ms.default.XMLHttpRequest){var s=new Ms.default.XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===4)return r(null,s.status!==200?"error":void 0)},s.open("POST",n),s.setRequestHeader("Content-Type","text/plain"),s.send(e);return}r()},V3=Dn,G3=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception","view_playing_time_ms_cumulative","ad_playing_time_ms_cumulative"],H3=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],q3=["ad_id","ad_creative_id","ad_universal_id"],K3=["viewstart","error","ended","viewend"],z3=600*1e3,W3=(function(){function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Lt(this,n);var s,i,a,l,d,u,h,p,g,x,y,E;me(this,"mux",void 0),me(this,"envKey",void 0),me(this,"options",void 0),me(this,"eventQueue",void 0),me(this,"sampleRate",void 0),me(this,"disableCookies",void 0),me(this,"respectDoNotTrack",void 0),me(this,"previousBeaconData",void 0),me(this,"lastEventTime",void 0),me(this,"rateLimited",void 0),me(this,"pageLevelData",void 0),me(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=r,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new V3(L3(this.envKey,this.options));var w;this.sampleRate=(w=this.options.sampleRate)!==null&&w!==void 0?w:1;var S;this.disableCookies=(S=this.options.disableCookies)!==null&&S!==void 0?S:!1;var T;this.respectDoNotTrack=(T=this.options.respectDoNotTrack)!==null&&T!==void 0?T:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(s=this.options.platform)===null||s===void 0?void 0:s.name,viewer_application_version:(i=this.options.platform)===null||i===void 0?void 0:i.version,viewer_application_engine:(a=this.options.platform)===null||a===void 0?void 0:a.layout,viewer_device_name:(l=this.options.platform)===null||l===void 0?void 0:l.product,viewer_device_category:"",viewer_device_manufacturer:(d=this.options.platform)===null||d===void 0?void 0:d.manufacturer,viewer_os_family:(h=this.options.platform)===null||h===void 0||(u=h.os)===null||u===void 0?void 0:u.family,viewer_os_architecture:(g=this.options.platform)===null||g===void 0||(p=g.os)===null||p===void 0?void 0:p.architecture,viewer_os_version:(y=this.options.platform)===null||y===void 0||(x=y.os)===null||x===void 0?void 0:x.version,viewer_connection_type:N3(),page_url:If.default===null||If.default===void 0||(E=If.default.location)===null||E===void 0?void 0:E.href},this.viewerData=this.disableCookies?{}:I3()}return ln(n,[{key:"send",value:function(e,t){if(!(!e||!(t!=null&&t.view_id))){if(this.respectDoNotTrack&&gh())return Je.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||typeof t!="object")return Je.error("A data object was expected in send() but was not provided");var r=this.disableCookies?{}:A3(),s=r0(kc({},this.pageLevelData,t,r,this.viewerData),{event:e,env_key:this.envKey});s.user_id&&(s.viewer_user_id=s.user_id,delete s.user_id);var i,a=((i=s.mux_sample_number)!==null&&i!==void 0?i:0)>=this.sampleRate,l=this._deduplicateBeaconData(e,s),d=vh(l);if(this.lastEventTime=this.mux.utils.now(),a)return Je.info("Not sending event due to sample rate restriction",e,s,d);if(this.envKey||Je.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,s,d),!this.rateLimited)if(Je.info("Sending event",e,s,d),this.rateLimited=!this.eventQueue.queueEvent(e,d),this.mux.WINDOW_UNLOADING&&e==="viewend")this.eventQueue.destroy(!0);else{if(this.mux.WINDOW_HIDDEN&&e==="hb")this.eventQueue.flushEvents(!0);else if(K3.indexOf(e)>=0){if(e==="error"&&t.player_error_severity==="warning")return;this.eventQueue.flushEvents()}if(this.rateLimited)return s.event="eventrateexceeded",d=vh(s),this.eventQueue.queueEvent(s.event,d),Je.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var r=this,s={},i=t.view_id;if(i==="-1"||e==="viewstart"||e==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=z3)s=kc({},t),i&&(this.previousBeaconData=s),i&&e==="viewend"&&(this.previousBeaconData=null);else{var a=e.indexOf("request")===0;Object.entries(t).forEach(function(l){var d=An(l,2),u=d[0],h=d[1];r.previousBeaconData&&(h!==r.previousBeaconData[u]||G3.indexOf(u)>-1||r.objectHasChanged(a,u,h,r.previousBeaconData[u])||r.eventRequiresKey(e,u))&&(s[u]=h,r.previousBeaconData[u]=h)})}return s}},{key:"objectHasChanged",value:function(e,t,r,s){return!e||t.indexOf("request_")!==0?!1:t==="request_response_headers"||typeof r!="object"||typeof s!="object"?!0:Object.keys(r||{}).length!==Object.keys(s||{}).length}},{key:"eventRequiresKey",value:function(e,t){return!!(e==="renditionchange"&&t.indexOf("video_source_")===0||q3.includes(t)&&H3.includes(e))}}]),n})(),Y3=function n(e){Lt(this,n);var t=0,r=0,s=0,i=0,a=0,l=0,d=0,u=function(g,x){var y=x.request_start,E=x.request_response_start,w=x.request_response_end,S=x.request_bytes_loaded;i++;var T,k;if(E?(T=E-(y??0),k=(w??0)-E):k=(w??0)-(y??0),k>0&&S&&S>0){var I=S/k*8e3;a++,r+=S,s+=k,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,I),e.data.view_average_request_throughput=r/s*8e3,e.data.view_request_count=i,T>0&&(t+=T,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,T),e.data.view_average_request_latency=t/a)}},h=function(g,x){i++,l++,e.data.view_request_count=i,e.data.view_request_failed_count=l},p=function(g,x){i++,d++,e.data.view_request_count=i,e.data.view_request_canceled_count=d};e.on("requestcompleted",u),e.on("requestfailed",h),e.on("requestcanceled",p)},Q3=Y3,X3=3600*1e3,Z3=function n(e){var t=this;Lt(this,n),me(this,"_lastEventTime",void 0),e.on("before*",function(r,s){var i=s.viewer_time,a=Ot.now(),l=t._lastEventTime;if(t._lastEventTime=a,l&&a-l>X3){var d=Object.keys(e.data).reduce(function(h,p){return p.indexOf("video_")===0?Object.assign(h,me({},p,e.data[p])):h},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view");var u=e.playbackHeartbeat._playheadShouldBeProgressing;e._resetView(Object.assign({viewer_time:i},d)),e.playbackHeartbeat._playheadShouldBeProgressing=u,e.playbackHeartbeat._playheadShouldBeProgressing&&r.type!=="play"&&r.type!=="adbreakstart"&&(e.emit("play",{viewer_time:i}),r.type!=="playing"&&e.emit("playing",{viewer_time:i}))}})},J3=Z3,eR=function n(e){Lt(this,n);var t=function(l){var d=tR(l),u=rR(l);if(d!=null&&!Hx(d,i)&&a<=u){i=d,a=u;var h={video_cdn:d};e.emit("cdnchange",h)}},r=null,s=null,i=null,a=0;e.on("viewinit",function(){r=null,s=null,i=null,a=0}),e.on("beforecdnchange",function(l,d){var u=d?.video_cdn;u&&(typeof d.video_previous_cdn>"u"||d.video_previous_cdn===null)&&(Hx(u,s)?d.video_previous_cdn=r??void 0:(d.video_previous_cdn=s??void 0,r=s,s=u))}),e.on("requestcompleted",function(l,d){t(d)})};function Hx(n,e){return n?.toLowerCase()===e?.toLowerCase()}function tR(n){var e;return n!=null&&n.request_type&&(n.request_type==="media"||n.request_type==="video")&&!((e=n.request_response_headers)===null||e===void 0)&&e["x-cdn"]?n.request_response_headers["x-cdn"]:n!=null&&n.video_cdn?n.video_cdn:null}function rR(n){return n!=null&&n.request_start?n.request_start:n!=null&&n.viewer_time?n.viewer_time:Date.now()}var nR=eR,sR=function(n){try{return JSON.parse(n),!0}catch{return!1}},iR=function n(e){var t=this;Lt(this,n),me(this,"_emittingAutomaticEvent",!1),me(this,"_hasInitialized",!1),e.on("viewstart",function(){t._hasInitialized||(t._hasInitialized=!0,t._emittingAutomaticEvent=!0,e.emit("playbackmodechange",{player_playback_mode:"standard",player_playback_mode_data:"{}"}),t._emittingAutomaticEvent=!1)}),e.on("viewend",function(){t._hasInitialized=!1}),e.on("playbackmodechange",function(r,s){t._emittingAutomaticEvent||(s.player_playback_mode_data?sR(s.player_playback_mode_data)||(e.mux.log.warn("Invalid JSON string for player_playback_mode_data"),s.player_playback_mode_data="{}"):s.player_playback_mode_data="{}",e.data.player_playback_mode_data=s.player_playback_mode_data,e.data.player_playback_mode=s.player_playback_mode)})},aR=iR,oR=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange","cdnchange","playbackmodechange"],lR=new Set(["requestcompleted","requestfailed","requestcanceled"]),cR=(function(n){PL(t,n);var e=UL(t);function t(r,s,i){Lt(this,t);var a;a=e.call(this),me(Ae(a),"pageLoadEndTime",void 0),me(Ae(a),"pageLoadInitTime",void 0),me(Ae(a),"_destroyed",void 0),me(Ae(a),"_heartBeatTimeout",void 0),me(Ae(a),"adTracker",void 0),me(Ae(a),"dashjs",void 0),me(Ae(a),"data",void 0),me(Ae(a),"disablePlayheadRebufferTracking",void 0),me(Ae(a),"disableRebufferTracking",void 0),me(Ae(a),"errorTracker",void 0),me(Ae(a),"errorTranslator",void 0),me(Ae(a),"emitTranslator",void 0),me(Ae(a),"getAdData",void 0),me(Ae(a),"getPlayheadTime",void 0),me(Ae(a),"getStateData",void 0),me(Ae(a),"stateDataTranslator",void 0),me(Ae(a),"hlsjs",void 0),me(Ae(a),"id",void 0),me(Ae(a),"longResumeTracker",void 0),me(Ae(a),"minimumRebufferDuration",void 0),me(Ae(a),"mux",void 0),me(Ae(a),"playbackEventDispatcher",void 0),me(Ae(a),"playbackHeartbeat",void 0),me(Ae(a),"playbackHeartbeatTime",void 0),me(Ae(a),"playheadTime",void 0),me(Ae(a),"seekingTracker",void 0),me(Ae(a),"sustainedRebufferThreshold",void 0),me(Ae(a),"watchTimeTracker",void 0),me(Ae(a),"currentFragmentPDT",void 0),me(Ae(a),"currentFragmentStart",void 0),a.pageLoadInitTime=_c.navigationStart(),a.pageLoadEndTime=_c.domContentLoadedEventEnd();var l={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(g){return g},emitTranslator:function(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];return x},stateDataTranslator:function(g){return g}};a.mux=r,a.id=s,i!=null&&i.beaconDomain&&a.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),i=Object.assign(l,i),i.data=i.data||{},i.data.property_key&&(i.data.env_key=i.data.property_key,delete i.data.property_key),Je.level=i.debug?js.DEBUG:js.WARN,a.getPlayheadTime=i.getPlayheadTime,a.getStateData=i.getStateData||function(){return{}},a.getAdData=i.getAdData||function(){},a.minimumRebufferDuration=i.minimumRebufferDuration,a.sustainedRebufferThreshold=i.sustainedRebufferThreshold,a.playbackHeartbeatTime=i.playbackHeartbeatTime,a.disableRebufferTracking=i.disableRebufferTracking,a.disableRebufferTracking&&a.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),a.disablePlayheadRebufferTracking=i.disablePlayheadRebufferTracking,a.errorTranslator=i.errorTranslator,a.emitTranslator=i.emitTranslator,a.stateDataTranslator=i.stateDataTranslator,a.playbackEventDispatcher=new W3(r,i.data.env_key,i),a.data={player_instance_id:oo(),mux_sample_rate:i.sampleRate,beacon_domain:i.beaconCollectionDomain||i.beaconDomain},a.data.view_sequence_number=1,a.data.player_sequence_number=1;var d=function(){typeof this.data.view_start>"u"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"),this.emit("renditionchange"))}.bind(Ae(a));if(a.on("viewinit",function(g,x){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,x),this._initializeViewData(),this.one("play",d),this.one("adbreakstart",d)}),a.on("videochange",function(g,x){this._resetView(x)}),a.on("programchange",function(g,x){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(x,{view_program_changed:!0})),d(),this.emit("play"),this.emit("playing")}),a.on("fragmentchange",function(g,x){this.currentFragmentPDT=x.currentFragmentPDT,this.currentFragmentStart=x.currentFragmentStart}),a.on("destroy",a.destroy),typeof window<"u"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var u=function(){var g=typeof a.data.view_start<"u";a.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",g&&a.mux.WINDOW_HIDDEN&&(a.data.player_is_paused||a.emit("hb"))};window.addEventListener("visibilitychange",u,!1);var h=function(g){g.persisted||a.destroy()};window.addEventListener("pagehide",h,!1),a.on("destroy",function(){window.removeEventListener("visibilitychange",u),window.removeEventListener("pagehide",h)})}a.on("playerready",function(g,x){Object.assign(this.data,x)}),oR.forEach(function(g){a.on(g,function(x,y){g.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,y),this._sanitizeData()}),a.on("after"+g,function(){(g!=="error"||this.errorTracker.viewErrored)&&this.send(g)})}),a.on("viewend",function(g,x){Object.assign(a.data,x)});var p=function(g){var x=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=x-this.data.player_init_time),this.pageLoadInitTime=this.data.page_load_init_time||this.pageLoadInitTime,this.pageLoadEndTime=this.data.page_load_end_time||this.pageLoadEndTime,!this.mux.PLAYER_TRACKED&&this.pageLoadInitTime&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.pageLoadEndTime)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.pageLoadEndTime||1/0)-this.pageLoadInitTime)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return a.one("playerready",p),a.longResumeTracker=new J3(Ae(a)),a.errorTracker=new n3(Ae(a)),new _3(Ae(a)),a.seekingTracker=new E3(Ae(a)),a.playheadTime=new c3(Ae(a)),a.playbackHeartbeat=new t3(Ae(a)),new x3(Ae(a)),a.watchTimeTracker=new i3(Ae(a)),new o3(Ae(a)),a.adTracker=new S3(Ae(a)),new h3(Ae(a)),new d3(Ae(a)),new p3(Ae(a)),new Q3(Ae(a)),new nR(Ae(a)),new aR(Ae(a)),i.hlsjs&&a.addHLSJS(i),i.dashjs&&a.addDashJS(i),a.emit("viewinit",i.data),a}return ln(t,[{key:"emit",value:function(r,s){var i,a=Object.assign({viewer_time:this.mux.utils.now()},s),l=[r,a];if(this.emitTranslator)try{l=this.emitTranslator(r,a)}catch(d){this.mux.log.warn("Exception in emit translator callback.",d)}l!=null&&l.length&&(i=uc($i(t.prototype),"emit",this)).call.apply(i,[this].concat(Ur(l)))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start<"u"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(r){if(this.data.view_id){var s=Object.assign({},this.data),i=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(s.video_source_is_live===void 0&&(s.player_source_duration===1/0||s.video_source_duration===1/0?s.video_source_is_live=!0:(s.player_source_duration>0||s.video_source_duration>0)&&(s.video_source_is_live=!1)),s.video_source_is_live||i.forEach(function(u){s[u]=void 0}),s.video_source_url=s.video_source_url||s.player_source_url,s.video_source_url){var a=An(lo(s.video_source_url),2),l=a[0],d=a[1];s.video_source_domain=d,s.video_source_hostname=l}delete s.ad_request_id,this.playbackEventDispatcher.send(r,s),this.data.view_sequence_number++,this.data.player_sequence_number++,lR.has(r)||this._restartHeartBeat(),r==="viewend"&&delete this.data.view_id}}},{key:"_resetView",value:function(r){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",r)}},{key:"_updateStateData",value:function(){var r,s=this.getStateData();if(typeof this.stateDataTranslator=="function")try{s=this.stateDataTranslator(s)}catch(a){this.mux.log.warn("Exception in stateDataTranslator translator callback.",a)}if(!((r=this.data)===null||r===void 0)&&r.video_cdn&&s!=null&&s.video_cdn){s.video_cdn;var i=jL(s,["video_cdn"]);s=i}Object.assign(this.data,s),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var r=this,s=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];s.forEach(function(a){var l=parseInt(r.data[a],10);r.data[a]=isNaN(l)?void 0:l});var i=["player_source_url","video_source_url"];i.forEach(function(a){if(r.data[a]){var l=r.data[a].toLowerCase();(l.indexOf("data:")===0||l.indexOf("blob:")===0)&&(r.data[a]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var r=this;Object.keys(this.data).forEach(function(s){s.indexOf("video_")===0&&delete r.data[s]})}},{key:"_resetViewData",value:function(){var r=this;Object.keys(this.data).forEach(function(s){s.indexOf("view_")===0&&delete r.data[s]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var r=this,s=this.data.view_id=oo(),i=function(){s===r.data.view_id&&At(r.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",i):i()}},{key:"_restartHeartBeat",value:function(){var r=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){r.data.player_is_paused||r.emit("hb")},1e4)}},{key:"addHLSJS",value:function(r){if(!r.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=r.hlsjs,qL(this.mux,this.id,r.hlsjs,{},r.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(KL(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(r){if(!r.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=r.dashjs,QL(this.mux,this.id,r.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(XL(this.dashjs),this.dashjs=void 0)}}]),t})(JL),uR=cR,Ba=Cr(J1());function dR(){return Ba.default&&!!(Ba.default.fullscreenElement||Ba.default.webkitFullscreenElement||Ba.default.mozFullScreenElement||Ba.default.msFullscreenElement)}var fR=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],hR={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function mR(n,e,t){var r=An(Tc(e),3),s=r[0],i=r[1],a=r[2],l=n.log,d=n.utils.getComputedStyle,u=n.utils.secondsToMs,h={automaticErrorTracking:!0};if(s){if(a!=="video"&&a!=="audio")return l.error("The element of `"+i+"` was not a media element.")}else return l.error("No element was found with the `"+i+"` query selector.");s.mux&&(s.mux.destroy(),delete s.mux,l.warn("Already monitoring this video element, replacing existing event listeners"));var p={getPlayheadTime:function(){return u(s.currentTime)},getStateData:function(){var x,y,E,w=((x=(y=this).getPlayheadTime)===null||x===void 0?void 0:x.call(y))||u(s.currentTime),S=this.hlsjs&&this.hlsjs.url,T=this.dashjs&&typeof this.dashjs.getSource=="function"&&this.dashjs.getSource(),k={player_is_paused:s.paused,player_width:parseInt(d(s,"width")),player_height:parseInt(d(s,"height")),player_autoplay_on:s.autoplay,player_preload_on:s.preload,player_language_code:s.lang,player_is_fullscreen:dR(),video_poster_url:s.poster,video_source_url:S||T||s.currentSrc,video_source_duration:u(s.duration),video_source_height:s.videoHeight,video_source_width:s.videoWidth,view_dropped_frame_count:s==null||(E=s.getVideoPlaybackQuality)===null||E===void 0?void 0:E.call(s).droppedVideoFrames};if(s.getStartDate&&w>0){var I=s.getStartDate();if(I&&typeof I.getTime=="function"&&I.getTime()){var L=I.getTime();if(k.player_program_time=L+w,s.seekable.length>0){var O=L+s.seekable.end(s.seekable.length-1);k.player_live_edge_program_time=O}}}return k}};t=Object.assign(h,t,p),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:n.VERSION},t.data),s.mux=s.mux||{},s.mux.deleted=!1,s.mux.emit=function(x,y){n.emit(i,x,y)},s.mux.updateData=function(x){s.mux.emit("hb",x)};var g=function(){l.error("The monitor for this video element has already been destroyed.")};s.mux.destroy=function(){Object.keys(s.mux.listeners).forEach(function(x){s.removeEventListener(x,s.mux.listeners[x],!1)}),delete s.mux.listeners,s.mux.destroy=g,s.mux.swapElement=g,s.mux.emit=g,s.mux.addHLSJS=g,s.mux.addDashJS=g,s.mux.removeHLSJS=g,s.mux.removeDashJS=g,s.mux.updateData=g,s.mux.setEmitTranslator=g,s.mux.setStateDataTranslator=g,s.mux.setGetPlayheadTime=g,s.mux.deleted=!0,n.emit(i,"destroy")},s.mux.swapElement=function(x){var y=An(Tc(x),3),E=y[0],w=y[1],S=y[2];if(E){if(S!=="video"&&S!=="audio")return n.log.error("The element of `"+w+"` was not a media element.")}else return n.log.error("No element was found with the `"+w+"` query selector.");E.muxId=s.muxId,delete s.muxId,E.mux=E.mux||{},E.mux.listeners=Object.assign({},s.mux.listeners),delete s.mux.listeners,Object.keys(E.mux.listeners).forEach(function(T){s.removeEventListener(T,E.mux.listeners[T],!1),E.addEventListener(T,E.mux.listeners[T],!1)}),E.mux.swapElement=s.mux.swapElement,E.mux.destroy=s.mux.destroy,delete s.mux,s=E},s.mux.addHLSJS=function(x){n.addHLSJS(i,x)},s.mux.addDashJS=function(x){n.addDashJS(i,x)},s.mux.removeHLSJS=function(){n.removeHLSJS(i)},s.mux.removeDashJS=function(){n.removeDashJS(i)},s.mux.setEmitTranslator=function(x){n.setEmitTranslator(i,x)},s.mux.setStateDataTranslator=function(x){n.setStateDataTranslator(i,x)},s.mux.setGetPlayheadTime=function(x){x||(x=t.getPlayheadTime),n.setGetPlayheadTime(i,x)},n.init(i,t),n.emit(i,"playerready"),s.paused||(n.emit(i,"play"),s.readyState>2&&n.emit(i,"playing")),s.mux.listeners={},fR.forEach(function(x){x==="error"&&!t.automaticErrorTracking||(s.mux.listeners[x]=function(){var y={};if(x==="error"){if(!s.error||s.error.code===1)return;y.player_error_code=s.error.code,y.player_error_message=hR[s.error.code]||s.error.message}n.emit(i,x,y)},s.addEventListener(x,s.mux.listeners[x],!1))})}function pR(n,e,t,r){var s=r;if(n&&typeof n[e]=="function")try{s=n[e].apply(n,t)}catch(i){Je.info("safeCall error",i)}return s}var Ya=Cr(on()),Ii;Ya.default&&Ya.default.WeakMap&&(Ii=new WeakMap);function gR(n,e){if(!n||!e||!Ya.default||typeof Ya.default.getComputedStyle!="function")return"";var t;return Ii&&Ii.has(n)&&(t=Ii.get(n)),t||(t=Ya.default.getComputedStyle(n,null),Ii&&Ii.set(n,t)),t.getPropertyValue(e)}function xR(n){return Math.floor(n*1e3)}var Ds={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},qc=function(n){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(n),this.manifest};qc.prototype.process=function(n){var e;for(this.buffer+=n,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};qc.prototype.processLine=function(n){var e=n.indexOf(":"),t=wR(n,e),r=t[0],s=t.length===2?s0(t[1]):void 0;if(r[0]!=="#")this.currentUri.uri=r,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(r){case Ds.TARGET_DURATION:{if(!isFinite(s)||s<0)return;this.manifest.targetDuration=s,this.setHoldBack();break}case Ds.PART_INF:{Af(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case Ds.SERVER_CONTROL:{Af(this.manifest,t),this.setHoldBack();break}case Ds.INF:{s===0?this.currentUri.duration=.01:s>0&&(this.currentUri.duration=s);break}case Ds.PROGRAM_DATE_TIME:{var i=s,a=new Date(i);this.manifest.dateTimeString||(this.manifest.dateTimeString=i,this.manifest.dateTimeObject=a),this.currentUri.dateTimeString=i,this.currentUri.dateTimeObject=a;break}case Ds.VERSION:{Af(this.manifest,t);break}case Ds.SESSION_DATA:{var l=bR(t[1]),d=n2(l);Object.assign(this.manifest.sessionData,d)}}};qc.prototype.setHoldBack=function(){var n=this.manifest,e=n.serverControl,t=n.targetDuration,r=n.partTargetDuration;if(e){var s="holdBack",i="partHoldBack",a=t&&t*3,l=r&&r*2;t&&!e.hasOwnProperty(s)&&(e[s]=a),a&&e[s]<a&&(e[s]=a),r&&!e.hasOwnProperty(i)&&(e[i]=r*3),r&&e[i]<l&&(e[i]=l)}};var Af=function(n,e){var t=f2(e[0].replace("#EXT-X-","")),r;ER(e[1])?(r={},r=Object.assign(yR(e[1]),r)):r=s0(e[1]),n[t]=r},f2=function(n){return n.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},s0=function(n){if(n.toLowerCase()==="yes"||n.toLowerCase()==="no")return n.toLowerCase()==="yes";var e=n.indexOf(":")!==-1?n:parseFloat(n);return isNaN(e)?n:e},vR=function(n){var e={},t=n.split("=");if(t.length>1){var r=f2(t[0]);e[r]=s0(t[1])}return e},yR=function(n){for(var e=n.split(","),t={},r=0;e.length>r;r++){var s=e[r],i=vR(s);t=Object.assign(i,t)}return t},ER=function(n){return n.indexOf("=")>-1},wR=function(n,e){return e===-1?[n]:[n.substring(0,e),n.substring(e+1)]},bR=function(n){var e={};if(n){var t=n.search(","),r=n.slice(0,t),s=n.slice(t+1),i=[r,s];return i.forEach(function(a,l){for(var d=a.replace(/['"]+/g,"").split("="),u=0;u<d.length;u++)d[u]==="DATA-ID"&&(e["DATA-ID"]=d[1-u]),d[u]==="VALUE"&&(e.VALUE=d[1-u])}),{data:e}}},SR=qc,TR={safeCall:pR,safeIncrement:At,getComputedStyle:gR,secondsToMs:xR,assign:Object.assign,headersStringToObject:n0,cdnHeadersToRequestId:Cc,extractHostnameAndDomain:lo,extractHostname:$r,manifestParser:SR,generateShortID:t2,generateUUID:oo,now:Ot.now,findMediaElement:Tc},_R=TR,kR={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",PLAYBACK_MODE_CHANGE:"playbackmodechange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},CR=kR,IR="mux-embed",AR="5.14.0",LR="2.1",Tt={},ds=function(n){var e=arguments;typeof n=="string"?ds.hasOwnProperty(n)?Wa.default.setTimeout(function(){e=Array.prototype.splice.call(e,1),ds[n].apply(null,e)},0):Je.warn("`"+n+"` is an unknown task"):typeof n=="function"?Wa.default.setTimeout(function(){n(ds)},0):Je.warn("`"+n+"` is invalid.")},RR={loaded:Ot.now(),NAME:IR,VERSION:AR,API_VERSION:LR,PLAYER_TRACKED:!1,monitor:function(n,e){return mR(ds,n,e)},destroyMonitor:function(n){var e=An(Tc(n),1),t=e[0];t&&t.mux&&typeof t.mux.destroy=="function"?t.mux.destroy():Je.error("A video element monitor for `"+n+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(n,e){var t=Fr(n);Tt[t]?Tt[t].addHLSJS(e):Je.error("A monitor for `"+t+"` has not been initialized.")},addDashJS:function(n,e){var t=Fr(n);Tt[t]?Tt[t].addDashJS(e):Je.error("A monitor for `"+t+"` has not been initialized.")},removeHLSJS:function(n){var e=Fr(n);Tt[e]?Tt[e].removeHLSJS():Je.error("A monitor for `"+e+"` has not been initialized.")},removeDashJS:function(n){var e=Fr(n);Tt[e]?Tt[e].removeDashJS():Je.error("A monitor for `"+e+"` has not been initialized.")},init:function(n,e){gh()&&e&&e.respectDoNotTrack&&Je.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var t=Fr(n);Tt[t]=new uR(ds,t,e)},emit:function(n,e,t){var r=Fr(n);Tt[r]?(Tt[r].emit(e,t),e==="destroy"&&delete Tt[r]):Je.error("A monitor for `"+r+"` has not been initialized.")},updateData:function(n,e){var t=Fr(n);Tt[t]?Tt[t].emit("hb",e):Je.error("A monitor for `"+t+"` has not been initialized.")},setEmitTranslator:function(n,e){var t=Fr(n);Tt[t]?Tt[t].emitTranslator=e:Je.error("A monitor for `"+t+"` has not been initialized.")},setStateDataTranslator:function(n,e){var t=Fr(n);Tt[t]?Tt[t].stateDataTranslator=e:Je.error("A monitor for `"+t+"` has not been initialized.")},setGetPlayheadTime:function(n,e){var t=Fr(n);Tt[t]?Tt[t].getPlayheadTime=e:Je.error("A monitor for `"+t+"` has not been initialized.")},checkDoNotTrack:gh,log:Je,utils:_R,events:CR,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(ds,RR);typeof Wa.default<"u"&&typeof Wa.default.addEventListener=="function"&&Wa.default.addEventListener("pagehide",function(n){n.persisted||(ds.WINDOW_UNLOADING=!0)},!1);var NR=ds;/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/function ls({src:n,poster:e,muxEnvKey:t,playerName:r="Portfolio Video Player",muxMetadata:s={},className:i="",autoPlay:a=!1,muted:l=!1,loop:d=!1,controls:u=!0,onLoaded:h}){const p=R.useRef(null),g=R.useRef(null),x=R.useRef(Date.now()),y=R.useRef(!1),E=R.useRef(h),w=R.useRef(t),S=R.useRef(r),T=R.useRef(s),k=R.useRef(a),I=R.useRef(l);return E.current=h,w.current=t,S.current=r,T.current=s,k.current=a,I.current=l,R.useEffect(()=>{const L=p.current;if(!L)return;I.current&&(L.muted=!0);const O=()=>{E.current&&!y.current&&(y.current=!0,E.current())};L.addEventListener("canplaythrough",O);const P=n.includes(".m3u8"),j=F=>{if(!w.current){console.warn("Mux env_key not provided. Video monitoring is disabled.");return}const D={data:{env_key:w.current,player_name:S.current,player_init_time:x.current,...T.current}};F&&(D.hlsjs=F,D.Hls=sr),NR.monitor(L,D)};if(P)if(sr.isSupported()){const F=new sr({enableWorker:!0,lowLatencyMode:!1,startLevel:-1});g.current=F,F.loadSource(n),F.attachMedia(L),F.on(sr.Events.MANIFEST_PARSED,(D,$)=>{console.log("Available quality levels:",$.levels.map(ne=>`${ne.height}p`));const J=$.levels.length-1;F.currentLevel=J,F.loadLevel=J,console.log(`Locked to level ${J}: ${$.levels[J]?.height}p`),j(F),k.current&&(I.current&&(L.muted=!0),L.play().catch(ne=>{console.log("Autoplay prevented by browser:",ne)}))}),F.on(sr.Events.ERROR,(D,$)=>{if($.fatal)switch($.type){case sr.ErrorTypes.NETWORK_ERROR:console.error("Network error, attempting to recover..."),F.startLoad();break;case sr.ErrorTypes.MEDIA_ERROR:console.error("Media error, attempting to recover..."),F.recoverMediaError();break;default:console.error("Fatal error, destroying HLS instance"),F.destroy();break}})}else L.canPlayType("application/vnd.apple.mpegurl")?(L.src=n,j()):console.error("HLS is not supported in this browser");else L.src=n,j();return()=>{L.removeEventListener("canplaythrough",O),g.current&&(g.current.destroy(),g.current=null)}},[n]),f.jsx("video",{ref:p,className:i,poster:e,autoPlay:a,muted:l,loop:d,controls:u,playsInline:!0})}const Vi="/assets/logo-CcKS_K74.png",qx="data:image/svg+xml,%3Csvg%20preserveAspectRatio%3D%22none%22%20width%3D%22100%25%22%20height%3D%22100%25%22%20overflow%3D%22visible%22%20style%3D%22display%3A%20block%3B%22%20viewBox%3D%220%200%2019%2019%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20id%3D%22SVGG1Ot4cAD%22%3E%0A%3Cpath%20id%3D%22Vector%22%20d%3D%22M0%200H19V19H0V0Z%22%20fill%3D%22var(--fill-0%2C%20black)%22%2F%3E%0A%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A";function De({children:n,className:e,variant:t="slide",fast:r=!1,delay:s=0,threshold:i=.15,rootMargin:a="0px 0px -40px 0px",as:l="div",disabled:d=!1}){const u=R.useRef(null),h=r?"fast":t,p=R.useRef(null);if(R.useEffect(()=>{if(d)return;const x=u.current;if(!x)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){x.classList.add("revealed");return}const E=()=>{const T=x.getBoundingClientRect(),k=window.innerHeight||document.documentElement.clientHeight;return T.top<k+40&&T.bottom>-40};p.current===null&&(p.current=E(),p.current&&s>0&&(x.style.transitionDelay="0ms"));const w=()=>E()?(requestAnimationFrame(()=>{x.classList.add("revealed")}),!0):!1,S=new IntersectionObserver(T=>{T.forEach(k=>{k.isIntersecting&&(requestAnimationFrame(()=>{x.classList.add("revealed")}),S.unobserve(x))})},{threshold:0,rootMargin:"40px"});return S.observe(x),requestAnimationFrame(()=>{w()}),()=>{S.disconnect()}},[i,a,d,s]),d)return f.jsx(f.Fragment,{children:n});const g={slide:"scroll-reveal",fast:"scroll-reveal-fast",fade:"scroll-reveal-fade"}[h];return _n.createElement(l,{ref:u,className:ee(g,e),style:s>0?{transitionDelay:`${s}ms`}:void 0},n)}function ms({className:n=""}){return f.jsx("svg",{width:"0.6em",height:"0.6em",viewBox:"0 0 9 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`inline-block align-baseline ${n}`,style:{verticalAlign:"0.05em"},children:f.jsx("path",{d:"M0.928172 8.30395L0.0001719 7.35995L7.04017 0.319951L7.98417 1.26395L0.928172 8.30395ZM1.96817 1.35995V-4.95911e-05H8.30417L7.80817 1.34395L1.96817 1.35995ZM6.94417 6.33595L6.96017 0.479951L8.30417 -4.95911e-05V6.33595H6.94417Z",fill:"currentColor"})})}function DR(){const[n,e]=R.useState(null);return R.useEffect(()=>{(async()=>{try{const r=await fetch("https://api.github.com/repos/michelletliu/michelle-liu/commits?per_page=1");if(!r.ok)throw new Error("Failed to fetch");const s=await r.json();if(s&&s.length>0){const i=new Date(s[0].commit.committer.date),a=String(i.getMonth()+1).padStart(2,"0"),l=String(i.getDate()).padStart(2,"0"),d=String(i.getFullYear()).slice(-2);e(`${a}-${l}-${d}`)}}catch(r){console.error("Failed to fetch latest commit date:",r)}})()},[]),n}function PR({text:n,className:e}){const t=R.useRef(null),r=R.useRef(!1),s=R.useRef(n),i=R.useRef(!1),a="!@#$%^&*()_+-;:,.<>?ADELPSTUadelpstu0123456789";R.useEffect(()=>{s.current=n},[n]);const l=()=>{const u=t.current,h=s.current;if(!u||r.current)return;r.current=!0;const p=h.length,g=[];for(let E=0;E<p;E++){const w=h[E]||"",S=Math.floor(Math.random()*40),T=S+Math.floor(Math.random()*40);g.push({to:w,start:S,end:T})}let x=0;const y=()=>{let E="",w=0;for(let S=0;S<g.length;S++){const{to:T,start:k,end:I}=g[S];x>=I?(w++,E+=T):x>=k?((!g[S].char||Math.random()<.28)&&(g[S].char=a[Math.floor(Math.random()*a.length)]),E+=`<span style="color: #c4c4c4">${g[S].char}</span>`):E+=T}u.innerHTML=E,w===g.length?r.current=!1:(requestAnimationFrame(y),x++)};y()},d=()=>{l()};return R.useEffect(()=>{const u=t.current;if(!u)return;const h=new IntersectionObserver(p=>{p.forEach(g=>{g.isIntersecting&&!i.current&&(i.current=!0,setTimeout(()=>{l()},100))})},{threshold:.1});return h.observe(u),()=>h.disconnect()},[]),f.jsx("p",{ref:t,className:`${e} cursor-pointer`,onMouseEnter:d,children:n})}function Yl({children:n}){return f.jsx("div",{className:"relative shrink-0 size-6",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 24 24",children:f.jsx("g",{id:"Social Links",children:n})})})}function ki({text:n,href:e}){const t=f.jsx("p",{className:`font-['Figtree',sans-serif] leading-5 relative shrink-0 text-[#9ca3af] text-base text-nowrap tracking-[0.16px] ${e?"hover:text-blue-500 transition-colors duration-200":""}`,children:n});return e?f.jsx("a",{href:e,className:"content-stretch flex items-center justify-center px-0.5 py-0 relative rounded-full shrink-0",children:t}):f.jsx("div",{className:"content-stretch flex items-center justify-center px-0.5 py-0 relative rounded-full shrink-0",children:t})}function Kc(){const n=DR(),e=n?`CHANGELOG: ${n}`:"CHANGELOG: ...";return f.jsx("div",{className:"relative shrink-0 w-full",children:f.jsx("div",{className:"flex flex-col items-center size-full",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-16 items-center px-16 max-md:px-8 pt-8 pb-8 max-md:pb-16 max-md:pt-4 relative w-full",children:[f.jsxs(De,{className:"content-stretch flex flex-col gap-5 items-start relative shrink-0 w-full",children:[f.jsx("div",{className:"bg-gray-200 h-px shrink-0 w-full"}),f.jsxs("div",{className:"hidden md:grid gap-5 grid-cols-[repeat(4,_minmax(0px,_1fr))] grid-rows-[repeat(1,_fit-content(100%))] relative shrink-0 w-full",children:[f.jsx("div",{className:"[grid-area:1_/_1] content-stretch flex flex-col items-start relative shrink-0",children:f.jsxs("a",{href:"/",className:"content-stretch flex gap-3 items-center justify-center relative shrink-0 hover:opacity-80 transition-opacity",children:[f.jsx("div",{className:"relative shrink-0 size-7",children:f.jsx("img",{alt:"Michelle Liu Logo",className:"object-contain size-full",src:Vi})}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-[#374151] text-[32px] w-[212px]",children:"michelle liu"})]})}),f.jsxs("div",{className:"[grid-area:1_/_3] content-stretch flex flex-col gap-2 items-start relative shrink-0",children:[f.jsx(ki,{text:"Work",href:"/"}),f.jsx(ki,{text:"Art",href:"/art"}),f.jsx(ki,{text:"About",href:"/about"})]}),f.jsxs("div",{className:"[grid-area:1_/_4] content-stretch flex flex-col gap-4 items-start relative shrink-0",children:[f.jsxs("div",{className:"content-stretch flex flex-col font-['Figtree',sans-serif] font-normal items-start relative shrink-0 text-gray-400 w-full",children:[f.jsx("p",{className:"leading-6 min-w-full relative shrink-0 text-base w-[min-content]",children:"Let's work together!"}),f.jsx("p",{className:"leading-6 relative shrink-0 text-base break-all",children:f.jsxs("a",{href:"mailto:michelletheresaliu@gmail.com",className:"hover:text-blue-500 text-gray-500 transition-colors duration-200",children:[f.jsx("span",{children:"michelletheresaliu@gmail.com "}),f.jsx("span",{className:"font-['Figtree',sans-serif] font-bold",children:f.jsx(ms,{})})]})})]}),f.jsx("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0",children:f.jsxs("div",{className:"content-stretch flex gap-6 items-start relative shrink-0",children:[f.jsx("a",{href:"https://www.instagram.com/https.croissant/?hl=en",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:f.jsx(Yl,{children:f.jsx("path",{d:Ps.p2c5f2300,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})}),f.jsx("a",{href:"https://x.com/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:f.jsx("div",{className:"content-stretch flex items-center justify-center relative shrink-0 size-6",children:f.jsx("div",{className:"grid-cols-[max-content] grid-rows-[max-content] inline-grid leading-[0] place-items-start relative shrink-0",children:f.jsx("div",{className:"[grid-area:1_/_1] h-[17.219px] mask-alpha mask-intersect mask-no-clip mask-no-repeat mask-position-[0px_-0.89px] mask-size-[19px_19px] ml-0 mt-[4.69%] relative w-[19px]",style:{maskImage:`url('${qx}')`},children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 19 18",children:f.jsx("g",{id:"Group",children:f.jsx("path",{d:Ps.p16308a80,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})})})})})}),f.jsx("a",{href:"https://www.linkedin.com/in/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link social-link-linkedin",children:f.jsx("div",{className:"content-stretch flex items-center justify-center relative shrink-0 size-6",children:f.jsx(Yl,{children:f.jsx("path",{d:Ps.p1e086000,fill:"var(--fill-0, #c4c9d0)",id:"Vector",stroke:"var(--stroke-0, #c4c9d0)"})})})})]})})]})]}),f.jsxs("div",{className:"md:hidden content-stretch flex flex-col gap-10 items-start relative shrink-0 w-full",children:[f.jsx("div",{className:"content-stretch flex flex-col gap-1.5 items-start relative shrink-0",children:f.jsxs("a",{href:"/",className:"content-stretch flex gap-2 items-center justify-center relative shrink-0 hover:opacity-80 transition-opacity",children:[f.jsx("div",{className:"relative shrink-0 size-7",children:f.jsx("img",{alt:"Michelle Liu Logo",className:"object-contain size-full",src:Vi})}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-[#374151] text-[32px] w-[212px]",children:"michelle liu"})]})}),f.jsxs("div",{className:"content-stretch flex flex-col gap-10 items-start relative shrink-0",children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0",children:[f.jsxs("div",{className:"content-stretch flex flex-col font-['Figtree',sans-serif] font-normal items-start relative shrink-0 text-gray-400 w-[326px]",children:[f.jsx("p",{className:"leading-6 relative shrink-0 text-base w-full",children:"Let's work together!"}),f.jsx("p",{className:"leading-6 relative shrink-0 text-base w-full break-all",children:f.jsxs("a",{href:"mailto:michelletheresaliu@gmail.com",className:"hover:text-blue-500 text-gray-500 transition-colors duration-200",children:[f.jsx("span",{children:"michelletheresaliu@gmail.com "}),f.jsx("span",{className:"font-['Figtree',sans-serif] font-bold",children:f.jsx(ms,{})})]})})]}),f.jsx("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0 w-[326px]",children:f.jsxs("div",{className:"content-stretch flex gap-11 items-start relative shrink-0",children:[f.jsx("a",{href:"https://www.instagram.com/https.croissant/?hl=en",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:f.jsx(Yl,{children:f.jsx("path",{d:Ps.p2c5f2300,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})}),f.jsx("a",{href:"https://x.com/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:f.jsx("div",{className:"content-stretch flex items-center justify-center p-2.5 relative shrink-0 size-6",children:f.jsx("div",{className:"grid-cols-[max-content] grid-rows-[max-content] inline-grid leading-[0] place-items-start relative shrink-0",children:f.jsx("div",{className:"[grid-area:1_/_1] h-[17.219px] mask-alpha mask-intersect mask-no-clip mask-no-repeat mask-position-[0px_-0.89px] mask-size-[19px_19px] ml-0 mt-[4.69%] relative w-[19px]",style:{maskImage:`url('${qx}')`},children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 19 18",children:f.jsx("g",{id:"Group",children:f.jsx("path",{d:Ps.p16308a80,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})})})})})}),f.jsx("a",{href:"https://www.linkedin.com/in/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link social-link-linkedin",children:f.jsx("div",{className:"content-stretch flex items-center justify-center p-2.5 relative shrink-0 size-6",children:f.jsx(Yl,{children:f.jsx("path",{d:Ps.p1e086000,fill:"var(--fill-0, #c4c9d0)",id:"Vector",stroke:"var(--stroke-0, #c4c9d0)"})})})})]})})]}),f.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0 w-[338px]",children:[f.jsx(ki,{text:"WORK",href:"/"}),f.jsx(ki,{text:"ART",href:"/art"}),f.jsx(ki,{text:"ABOUT",href:"/about"})]})]})]})]}),f.jsxs(De,{variant:"fade",delay:200,className:"content-stretch flex flex-col gap-0.5 items-center relative shrink-0",children:[f.jsxs("p",{className:"font-['Figtree',sans-serif] font-normal leading-7 relative shrink-0 text-gray-500 text-sm",children:[f.jsx("span",{children:"Built with React & "}),f.jsxs("span",{className:"group",children:[f.jsx("a",{className:"[text-underline-position:from-font] cursor-pointer decoration-solid underline group-hover:!text-emerald-600 transition-colors",href:"https://www.rockysmatcha.com/blogs/matcha-guide/how-to-make-matcha-guide",target:"_blank",rel:"noopener noreferrer",children:"rocky's matcha"}),f.jsx("span",{children:" lattes."}),f.jsx("span",{className:"text-gray-400",children:" "})]})]}),f.jsx(PR,{text:e,className:"font-['Figtree',sans-serif] font-normal leading-5 tracking-wider relative shrink-0 text-[#9ca3af] text-xs text-nowrap"})]})]})})})}const OR="data:image/svg+xml,%3csvg%20width='19'%20height='28'%20viewBox='0%200%2019%2028'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.13274%2027.3175C2.1117%2027.3175%201.33199%2027.039%200.793626%2026.4821C0.264542%2025.9251%200%2025.099%200%2024.0037V14.4106C0%2013.3153%200.264542%2012.4938%200.793626%2011.9462C1.33199%2011.3892%202.1117%2011.1108%203.13274%2011.1108H15.8725C16.8936%2011.1108%2017.6686%2011.3892%2018.1977%2011.9462C18.7361%2012.4938%2019.0053%2013.3153%2019.0053%2014.4106V24.0037C19.0053%2025.099%2018.7361%2025.9251%2018.1977%2026.4821C17.6686%2027.039%2016.8936%2027.3175%2015.8725%2027.3175H3.13274ZM2.43657%2012.1829V7.78311C2.43657%206.03806%202.77073%204.59004%203.43905%203.43905C4.11665%202.28806%204.99381%201.42946%206.07054%200.863242C7.14728%200.287747%208.28899%200%209.49567%200C10.7116%200%2011.858%200.287747%2012.9347%200.863242C14.0114%201.42946%2014.884%202.28806%2015.5523%203.43905C16.2299%204.59004%2016.5687%206.03806%2016.5687%207.78311V12.1829H14.3688V7.47679C14.3688%206.30724%2014.1414%205.32333%2013.6866%204.52506C13.241%203.72679%2012.647%203.12345%2011.9044%202.71504C11.1711%202.30662%2010.3682%202.10241%209.49567%202.10241C8.63243%202.10241%207.82952%202.30662%207.08694%202.71504C6.35365%203.12345%205.76423%203.72679%205.31869%204.52506C4.87314%205.32333%204.65037%206.30724%204.65037%207.47679V12.1829H2.43657Z'%20fill='%236B7280'/%3e%3c/svg%3e",jR="/assets/quote%20gray%20200-CtrnUyGq.png";function MR({onClick:n,className:e}){return f.jsx("div",{className:ee("content-stretch flex flex-col items-center relative shrink-0 w-full",e),children:f.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),n?.()},className:"bg-[#f9fafb] border border-[#e5e7eb] border-solid content-stretch flex items-center justify-center px-5 py-2.5 relative rounded-full shrink-0 hover:bg-[#f3f4f6] transition-colors cursor-pointer z-10",children:f.jsx("span",{className:"font-medium leading-normal relative shrink-0 text-gray-700 hover:text-gray-800 text-base",children:"View all projects"})})})}function FR({project:n,className:e,onClick:t}){return f.jsxs("button",{type:"button",onClick:r=>{r.stopPropagation(),r.preventDefault(),t?.()},className:ee("flex flex-col gap-3 items-start cursor-pointer group text-left w-full",e),children:[f.jsx("div",{className:"w-full overflow-hidden rounded-[26px] transition-transform duration-300 group-hover:scale-[0.99]",children:f.jsx("div",{className:"aspect-[678/367.625] w-full relative",children:f.jsx("img",{className:"absolute inset-0 object-cover rounded-[26px] w-full h-full",alt:"",src:n.imageSrc})})}),f.jsxs("div",{className:"flex flex-col font-medium items-start px-[13px] !text-lg w-full",children:[f.jsxs("p",{className:"text-[#111827] w-full",children:[f.jsxs("span",{children:[n.title," "]}),f.jsxs("span",{className:"text-gray-400 font-normal",children:[" ",n.year]})]}),f.jsx("p",{className:"text-[#9ca3af] w-full leading-[1.3em] font-normal text-base project-card-text opacity-0 translate-y-1 transition-all duration-300 ease-out group-hover:opacity-100 group-hover:translate-y-0 max-md:opacity-100 max-md:translate-y-0",children:n.description})]})]})}function UR({device:n="Default",projects:e,onViewAll:t,onProjectClick:r}){const s=e.slice(0,2);return f.jsxs("div",{className:"flex flex-col items-start justify-center py-10 sm:py-16 px-8 md:px-[8%] xl:px-[175px] w-full max-w-[1440px] mx-auto",children:[f.jsxs("div",{className:"flex flex-col gap-8 sm:gap-10 items-start w-full mb-10 sm:mb-16",children:[f.jsx("p",{className:"font-normal leading-7 text-[#6b7280] text-lg sm:text-xl",children:"Also check out..."}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-6 w-full",children:s.map(i=>f.jsx(FR,{project:i,onClick:()=>r?.(i),className:"w-full"},i.id))})]}),t&&f.jsx(MR,{onClick:t})]})}function Ic(n){return n._type==="span"&&"text"in n&&typeof n.text=="string"&&(n.marks===void 0||Array.isArray(n.marks)&&n.marks.every(e=>typeof e=="string"))}function h2(n){return typeof n._type=="string"&&n._type[0]!=="@"&&(!("markDefs"in n)||!n.markDefs||Array.isArray(n.markDefs)&&n.markDefs.every(e=>typeof e._key=="string"))&&"children"in n&&Array.isArray(n.children)&&n.children.every(e=>typeof e=="object"&&"_type"in e)}function m2(n){return h2(n)&&"listItem"in n&&typeof n.listItem=="string"&&(n.level===void 0||typeof n.level=="number")}function p2(n){return n._type==="@list"}function g2(n){return n._type==="@span"}function x2(n){return n._type==="@text"}const Kx=["strong","em","code","underline","strike-through"];function BR(n,e,t){if(!Ic(n)||!n.marks||!n.marks.length)return[];let r=n.marks.slice(),s={};return r.forEach(i=>{s[i]=1;for(let a=e+1;a<t.length;a++){let l=t[a];if(l&&Ic(l)&&Array.isArray(l.marks)&&l.marks.indexOf(i)!==-1)s[i]++;else break}}),r.sort((i,a)=>$R(s,i,a))}function $R(n,e,t){let r=n[e],s=n[t];if(r!==s)return s-r;let i=Kx.indexOf(e),a=Kx.indexOf(t);return i===a?e.localeCompare(t):i-a}function VR(n){let{children:e}=n,t=n.markDefs??[];if(!e||!e.length)return[];let r=e.map(BR),s={_type:"@span",children:[],markType:"<unknown>"},i=[s];for(let a=0;a<e.length;a++){let l=e[a];if(!l)continue;let d=r[a]||[],u=1;if(i.length>1)for(;u<i.length;u++){let p=i[u]?.markKey||"",g=d.indexOf(p);if(g===-1)break;d.splice(g,1)}i=i.slice(0,u);let h=i[i.length-1];if(h){for(let p of d){let g=t?.find(y=>y._key===p),x={_type:"@span",_key:l._key,children:[],markDef:g,markType:g?g._type:p,markKey:p};h.children.push(x),i.push(x),h=x}if(Ic(l)){let p=l.text.split(`
`);for(let g=p.length;g-- >1;)p.splice(g,0,`
`);h.children=h.children.concat(p.map(g=>({_type:"@text",text:g})))}else h.children=h.children.concat(l)}}return s.children}function GR(n,e){let t=[],r;for(let s=0;s<n.length;s++){let i=n[s];if(i){if(!m2(i)){t.push(i),r=void 0;continue}if(!r){r=Ql(i,s,e),t.push(r);continue}if(HR(i,r)){r.children.push(i);continue}if((i.level||1)>r.level){let a=Ql(i,s,e);if(e==="html"){let l=r.children[r.children.length-1],d={...l,children:[...l.children,a]};r.children[r.children.length-1]=d}else r.children.push(a);r=a;continue}if((i.level||1)<r.level){let a=t[t.length-1],l=a&&yh(a,i);if(l){r=l,r.children.push(i);continue}r=Ql(i,s,e),t.push(r);continue}if(i.listItem!==r.listItem){let a=t[t.length-1],l=a&&yh(a,{level:i.level||1});if(l&&l.listItem===i.listItem){r=l,r.children.push(i);continue}else{r=Ql(i,s,e),t.push(r);continue}}console.warn("Unknown state encountered for block",i),t.push(i)}}return t}function HR(n,e){return(n.level||1)===e.level&&n.listItem===e.listItem}function Ql(n,e,t){return{_type:"@list",_key:`${n._key||`${e}`}-parent`,mode:t,level:n.level||1,listItem:n.listItem,children:[n]}}function yh(n,e){let t=e.level||1,r=e.listItem||"normal",s=typeof e.listItem=="string";if(p2(n)&&(n.level||1)===t&&s&&(n.listItem||"normal")===r)return n;if(!("children"in n))return;let i=n.children[n.children.length-1];return i&&!Ic(i)?yh(i,e):void 0}function v2(n){let e="";return n.children.forEach(t=>{x2(t)?e+=t.text:g2(t)&&(e+=v2(t))}),e}const qR="html",KR={number:({children:n})=>f.jsx("ol",{children:n}),bullet:({children:n})=>f.jsx("ul",{children:n})},zR=({children:n})=>f.jsx("li",{children:n}),WR=({children:n,value:e})=>f.jsx("a",{href:e?.href,children:n}),YR={textDecoration:"underline"},QR={em:({children:n})=>f.jsx("em",{children:n}),strong:({children:n})=>f.jsx("strong",{children:n}),code:({children:n})=>f.jsx("code",{children:n}),underline:({children:n})=>f.jsx("span",{style:YR,children:n}),"strike-through":({children:n})=>f.jsx("del",{children:n}),link:WR},go=(n,e)=>`[@portabletext/react] Unknown ${n}, specify a component for it in the \`components.${e}\` prop`,y2=n=>go(`block type "${n}"`,"types"),XR=n=>go(`mark type "${n}"`,"marks"),ZR=n=>go(`block style "${n}"`,"block"),JR=n=>go(`list style "${n}"`,"list"),e5=n=>go(`list item style "${n}"`,"listItem");function t5(n){console.warn(n)}const r5={display:"none"},zx={types:{},block:{normal:({children:n})=>f.jsx("p",{children:n}),blockquote:({children:n})=>f.jsx("blockquote",{children:n}),h1:({children:n})=>f.jsx("h1",{children:n}),h2:({children:n})=>f.jsx("h2",{children:n}),h3:({children:n})=>f.jsx("h3",{children:n}),h4:({children:n})=>f.jsx("h4",{children:n}),h5:({children:n})=>f.jsx("h5",{children:n}),h6:({children:n})=>f.jsx("h6",{children:n})},marks:QR,list:KR,listItem:zR,hardBreak:()=>f.jsx("br",{}),unknownType:({value:n,isInline:e})=>{let t=y2(n._type);return f.jsx(e?"span":"div",{style:r5,children:t})},unknownMark:({markType:n,children:e})=>f.jsx("span",{className:`unknown__pt__mark__${n}`,children:e}),unknownList:({children:n})=>f.jsx("ul",{children:n}),unknownListItem:({children:n})=>f.jsx("li",{children:n}),unknownBlockStyle:({children:n})=>f.jsx("p",{children:n})};function n5(n,e){let{block:t,list:r,listItem:s,marks:i,types:a,...l}=e;return{...n,block:$a(n,e,"block"),list:$a(n,e,"list"),listItem:$a(n,e,"listItem"),marks:$a(n,e,"marks"),types:$a(n,e,"types"),...l}}function $a(n,e,t){let r=e[t],s=n[t];return typeof r=="function"||r&&typeof s=="function"?r:r?{...s,...r}:s}function bn({value:n,components:e,listNestingMode:t,onMissingComponent:r=t5}){let s=r||i5,i=GR(Array.isArray(n)?n:[n],t||qR),a=R.useMemo(()=>e?n5(zx,e):zx,[e]),l=R.useMemo(()=>s5(a,s),[a,s]);return f.jsx(f.Fragment,{children:i.map((d,u)=>l({node:d,index:u,isInline:!1,renderNode:l}))})}const s5=(n,e)=>{function t(p){let{node:g,index:x,isInline:y}=p,E=g._key||`node-${x}`;return p2(g)?i(g,x,E):m2(g)?s(g,x,E):g2(g)?a(g,x,E):r(g)?h(g,x,E,y):h2(g)?l(g,x,E,y):x2(g)?d(g,E):u(g,x,E,y)}function r(p){return p._type in n.types}function s(p,g,x){let y=Wx({node:p,index:g,isInline:!1,renderNode:t}),E=n.listItem,w=(typeof E=="function"?E:E[p.listItem])||n.unknownListItem;if(w===n.unknownListItem){let T=p.listItem||"bullet";e(e5(T),{type:T,nodeType:"listItemStyle"})}let S=y.children;if(p.style&&p.style!=="normal"){let{listItem:T,...k}=p;S=t({node:k,index:g,isInline:!1})}return f.jsx(w,{value:p,index:g,isInline:!1,renderNode:t,children:S},x)}function i(p,g,x){let y=p.children.map((S,T)=>t({node:S._key?S:{...S,_key:`li-${g}-${T}`},index:T,isInline:!1})),E=n.list,w=(typeof E=="function"?E:E[p.listItem])||n.unknownList;if(w===n.unknownList){let S=p.listItem||"bullet";e(JR(S),{nodeType:"listStyle",type:S})}return f.jsx(w,{value:p,index:g,isInline:!1,renderNode:t,children:y},x)}function a(p,g,x){let{markDef:y,markType:E,markKey:w}=p,S=n.marks[E]||n.unknownMark,T=p.children.map((k,I)=>t({node:k,index:I,isInline:!0}));return S===n.unknownMark&&e(XR(E),{nodeType:"mark",type:E}),f.jsx(S,{text:v2(p),value:y,markType:E,markKey:w,renderNode:t,children:T},x)}function l(p,g,x,y){let{_key:E,...w}=Wx({node:p,index:g,isInline:y,renderNode:t}),S=w.node.style||"normal",T=(typeof n.block=="function"?n.block:n.block[S])||n.unknownBlockStyle;return T===n.unknownBlockStyle&&e(ZR(S),{nodeType:"blockStyle",type:S}),f.jsx(T,{...w,value:w.node,renderNode:t},x)}function d(p,g){if(p.text===`
`){let x=n.hardBreak;return x?f.jsx(x,{},g):`
`}return p.text}function u(p,g,x,y){let E={value:p,isInline:y,index:g,renderNode:t};e(y2(p._type),{nodeType:"block",type:p._type});let w=n.unknownType;return f.jsx(w,{...E},x)}function h(p,g,x,y){let E={value:p,isInline:y,index:g,renderNode:t},w=n.types[p._type];return w?f.jsx(w,{...E},x):null}return t};function Wx(n){let{node:e,index:t,isInline:r,renderNode:s}=n,i=VR(e).map((a,l)=>s({node:a,isInline:!0,index:l,renderNode:s}));return{_key:e._key||`block-${t}`,children:i,index:t,isInline:r,node:e}}function i5(){}const a5="modulepreload",o5=function(n){return"/"+n},Yx={},E2=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let a=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),d=l?.nonce||l?.getAttribute("nonce");s=a(t.map(u=>{if(u=o5(u),u in Yx)return;Yx[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":a5,h||(g.as="script"),g.crossOrigin="",g.href=u,d&&g.setAttribute("nonce",d),document.head.appendChild(g),h)return new Promise((x,y)=>{g.addEventListener("load",x),g.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},w2=!(typeof navigator>"u")&&navigator.product==="ReactNative",b2={timeout:w2?6e4:12e4},l5=function(n){const e={...b2,...typeof n=="string"?{url:n}:n};if(e.timeout=S2(e.timeout),e.query){const{url:t,searchParams:r}=(function(s){const i=s.indexOf("?");if(i===-1)return{url:s,searchParams:new URLSearchParams};const a=s.slice(0,i),l=s.slice(i+1);if(!w2)return{url:a,searchParams:new URLSearchParams(l)};if(typeof decodeURIComponent!="function")throw new Error("Broken `URLSearchParams` implementation, and `decodeURIComponent` is not defined");const d=new URLSearchParams;for(const u of l.split("&")){const[h,p]=u.split("=");h&&d.append(Qx(h),Qx(p||""))}return{url:a,searchParams:d}})(e.url);for(const[s,i]of Object.entries(e.query)){if(i!==void 0)if(Array.isArray(i))for(const l of i)r.append(s,l);else r.append(s,i);const a=r.toString();a&&(e.url=`${t}?${a}`)}}return e.method=e.body&&!e.method?"POST":(e.method||"GET").toUpperCase(),e};function Qx(n){return decodeURIComponent(n.replace(/\+/g," "))}function S2(n){if(n===!1||n===0)return!1;if(n.connect||n.socket)return n;const e=Number(n);return isNaN(e)?S2(b2.timeout):{connect:e,socket:e}}const c5=/^https?:\/\//i,u5=function(n){if(!c5.test(n.url))throw new Error(`"${n.url}" is not a valid URL`)};function T2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}const d5=["request","response","progress","error","abort"],Xx=["processOptions","validateOptions","interceptRequest","finalizeOptions","onRequest","onResponse","onError","onReturn","onHeaders"];function _2(n,e){const t=[],r=Xx.reduce((i,a)=>(i[a]=i[a]||[],i),{processOptions:[l5],validateOptions:[u5]});function s(i){const a=d5.reduce((x,y)=>(x[y]=(function(){const E=Object.create(null);let w=0;return{publish:function(S){for(const T in E)E[T](S)},subscribe:function(S){const T=w++;return E[T]=S,function(){delete E[T]}}}})(),x),{}),l=(x=>function(y,E,...w){const S=y==="onError";let T=E;for(let k=0;k<x[y].length&&(T=(0,x[y][k])(T,...w),!S||T);k++);return T})(r),d=l("processOptions",i);l("validateOptions",d);const u={options:d,channels:a,applyMiddleware:l};let h;const p=a.request.subscribe(x=>{h=e(x,(y,E)=>((w,S,T)=>{let k=w,I=S;if(!k)try{I=l("onResponse",S,T)}catch(L){I=null,k=L}k=k&&l("onError",k,T),k?a.error.publish(k):I&&a.response.publish(I)})(y,E,x))});a.abort.subscribe(()=>{p(),h&&h.abort()});const g=l("onReturn",a,u);return g===a&&a.request.publish(u),g}return s.use=function(i){if(!i)throw new Error("Tried to add middleware that resolved to falsey value");if(typeof i=="function")throw new Error("Tried to add middleware that was a function. It probably expects you to pass options to it.");if(i.onReturn&&r.onReturn.length>0)throw new Error("Tried to add new middleware with `onReturn` handler, but another handler has already been registered for this event");return Xx.forEach(a=>{i[a]&&r[a].push(i[a])}),t.push(i),s},s.clone=()=>_2(t,e),n.forEach(s.use),s}var Zx,Jx,f5=T2((function(){if(Jx)return Zx;Jx=1;var n=function(t){return t.replace(/^\s+|\s+$/g,"")},e=function(t){return Object.prototype.toString.call(t)==="[object Array]"};return Zx=function(t){if(!t)return{};for(var r=Object.create(null),s=n(t).split(`
`),i=0;i<s.length;i++){var a=s[i],l=a.indexOf(":"),d=n(a.slice(0,l)).toLowerCase(),u=n(a.slice(l+1));typeof r[d]>"u"?r[d]=u:e(r[d])?r[d].push(u):r[d]=[r[d],u]}return r}})());let Eh=class{onabort;onerror;onreadystatechange;ontimeout;readyState=0;response;responseText="";responseType="";status;statusText;withCredentials;#t;#e;#n;#s={};#r;#i={};#a;open(e,t,r){this.#t=e,this.#e=t,this.#n="",this.readyState=1,this.onreadystatechange?.(),this.#r=void 0}abort(){this.#r&&this.#r.abort()}getAllResponseHeaders(){return this.#n}setRequestHeader(e,t){this.#s[e]=t}setInit(e,t=!0){this.#i=e,this.#a=t}send(e){const t=this.responseType!=="arraybuffer",r={...this.#i,method:this.#t,headers:this.#s,body:e};typeof AbortController=="function"&&this.#a&&(this.#r=new AbortController,typeof EventTarget<"u"&&this.#r.signal instanceof EventTarget&&(r.signal=this.#r.signal)),typeof document<"u"&&(r.credentials=this.withCredentials?"include":"omit"),fetch(this.#e,r).then(s=>(s.headers.forEach((i,a)=>{this.#n+=`${a}: ${i}\r
`}),this.status=s.status,this.statusText=s.statusText,this.readyState=3,this.onreadystatechange?.(),t?s.text():s.arrayBuffer())).then(s=>{typeof s=="string"?this.responseText=s:this.response=s,this.readyState=4,this.onreadystatechange?.()}).catch(s=>{s.name!=="AbortError"?this.onerror?.(s):this.onabort?.()})}};const wh=typeof XMLHttpRequest=="function"?"xhr":"fetch",h5=wh==="xhr"?XMLHttpRequest:Eh,m5=(n,e)=>{const t=n.options,r=n.applyMiddleware("finalizeOptions",t),s={},i=n.applyMiddleware("interceptRequest",void 0,{adapter:wh,context:n});if(i){const E=setTimeout(e,0,null,i);return{abort:()=>clearTimeout(E)}}let a=new h5;a instanceof Eh&&typeof r.fetch=="object"&&a.setInit(r.fetch,r.useAbortSignal??!0);const l=r.headers,d=r.timeout;let u=!1,h=!1,p=!1;if(a.onerror=E=>{y(a instanceof Eh?E instanceof Error?E:new Error(`Request error while attempting to reach is ${r.url}`,{cause:E}):new Error(`Request error while attempting to reach is ${r.url}${E.lengthComputable?`(${E.loaded} of ${E.total} bytes transferred)`:""}`))},a.ontimeout=E=>{y(new Error(`Request timeout while attempting to reach ${r.url}${E.lengthComputable?`(${E.loaded} of ${E.total} bytes transferred)`:""}`))},a.onabort=()=>{x(!0),u=!0},a.onreadystatechange=function(){d&&(x(),s.socket=setTimeout(()=>g("ESOCKETTIMEDOUT"),d.socket)),!u&&a&&a.readyState===4&&a.status!==0&&(function(){if(!(u||h||p)){if(a.status===0)return void y(new Error("Unknown XHR error"));x(),h=!0,e(null,{body:a.response||(a.responseType===""||a.responseType==="text"?a.responseText:""),url:r.url,method:r.method,headers:f5(a.getAllResponseHeaders()),statusCode:a.status,statusMessage:a.statusText})}})()},a.open(r.method,r.url,!0),a.withCredentials=!!r.withCredentials,l&&a.setRequestHeader)for(const E in l)l.hasOwnProperty(E)&&a.setRequestHeader(E,l[E]);return r.rawBody&&(a.responseType="arraybuffer"),n.applyMiddleware("onRequest",{options:r,adapter:wh,request:a,context:n}),a.send(r.body||null),d&&(s.connect=setTimeout(()=>g("ETIMEDOUT"),d.connect)),{abort:function(){u=!0,a&&a.abort()}};function g(E){p=!0,a.abort();const w=new Error(E==="ESOCKETTIMEDOUT"?`Socket timed out on request to ${r.url}`:`Connection timed out on request to ${r.url}`);w.code=E,n.channels.error.publish(w)}function x(E){(E||u||a&&a.readyState>=2&&s.connect)&&clearTimeout(s.connect),s.socket&&clearTimeout(s.socket)}function y(E){if(h)return;x(!0),h=!0,a=null;const w=E||new Error(`Network error while attempting to reach ${r.url}`);w.isNetworkError=!0,w.request=r,e(w)}},p5=(n=[],e=m5)=>_2(n,e);var g5={},ev,tv,rv,nv,sv,Lf={exports:{}};sv||(sv=1,(function(n,e){e.formatArgs=function(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const s="color: "+this.color;r.splice(1,0,s,"color: inherit");let i=0,a=0;r[0].replace(/%[a-zA-Z%]/g,l=>{l!=="%%"&&(i++,l==="%c"&&(a=i))}),r.splice(a,0,s)},e.save=function(r){try{r?e.storage.setItem("debug",r):e.storage.removeItem("debug")}catch{}},e.load=function(){let r;try{r=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=g5.DEBUG),r},e.useColors=function(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=(function(){try{return localStorage}catch{}})(),e.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),n.exports=(nv?rv:(nv=1,rv=function(r){function s(l){let d,u,h,p=null;function g(...x){if(!g.enabled)return;const y=g,E=Number(new Date),w=E-(d||E);y.diff=w,y.prev=d,y.curr=E,d=E,x[0]=s.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let S=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(T,k)=>{if(T==="%%")return"%";S++;const I=s.formatters[k];if(typeof I=="function"){const L=x[S];T=I.call(y,L),x.splice(S,1),S--}return T}),s.formatArgs.call(y,x),(y.log||s.log).apply(y,x)}return g.namespace=l,g.useColors=s.useColors(),g.color=s.selectColor(l),g.extend=i,g.destroy=s.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(u!==s.namespaces&&(u=s.namespaces,h=s.enabled(l)),h),set:x=>{p=x}}),typeof s.init=="function"&&s.init(g),g}function i(l,d){const u=s(this.namespace+(typeof d>"u"?":":d)+l);return u.log=this.log,u}function a(l,d){let u=0,h=0,p=-1,g=0;for(;u<l.length;)if(h<d.length&&(d[h]===l[u]||d[h]==="*"))d[h]==="*"?(p=h,g=u,h++):(u++,h++);else{if(p===-1)return!1;h=p+1,g++,u=g}for(;h<d.length&&d[h]==="*";)h++;return h===d.length}return s.debug=s,s.default=s,s.coerce=function(l){return l instanceof Error?l.stack||l.message:l},s.disable=function(){const l=[...s.names,...s.skips.map(d=>"-"+d)].join(",");return s.enable(""),l},s.enable=function(l){s.save(l),s.namespaces=l,s.names=[],s.skips=[];const d=(typeof l=="string"?l:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const u of d)u[0]==="-"?s.skips.push(u.slice(1)):s.names.push(u)},s.enabled=function(l){for(const d of s.skips)if(a(l,d))return!1;for(const d of s.names)if(a(l,d))return!0;return!1},s.humanize=(function(){if(tv)return ev;tv=1;var l=1e3,d=60*l,u=60*d,h=24*u,p=7*h;function g(x,y,E,w){var S=y>=1.5*E;return Math.round(x/E)+" "+w+(S?"s":"")}return ev=function(x,y){y=y||{};var E,w,S=typeof x;if(S==="string"&&x.length>0)return(function(T){if(!((T=String(T)).length>100)){var k=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(T);if(k){var I=parseFloat(k[1]);switch((k[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*I;case"weeks":case"week":case"w":return I*p;case"days":case"day":case"d":return I*h;case"hours":case"hour":case"hrs":case"hr":case"h":return I*u;case"minutes":case"minute":case"mins":case"min":case"m":return I*d;case"seconds":case"second":case"secs":case"sec":case"s":return I*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return I;default:return}}}})(x);if(S==="number"&&isFinite(x))return y.long?(E=x,(w=Math.abs(E))>=h?g(E,w,h,"day"):w>=u?g(E,w,u,"hour"):w>=d?g(E,w,d,"minute"):w>=l?g(E,w,l,"second"):E+" ms"):(function(T){var k=Math.abs(T);return k>=h?Math.round(T/h)+"d":k>=u?Math.round(T/u)+"h":k>=d?Math.round(T/d)+"m":k>=l?Math.round(T/l)+"s":T+"ms"})(x);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(x))}})(),s.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(r).forEach(l=>{s[l]=r[l]}),s.names=[],s.skips=[],s.formatters={},s.selectColor=function(l){let d=0;for(let u=0;u<l.length;u++)d=(d<<5)-d+l.charCodeAt(u),d|=0;return s.colors[Math.abs(d)%s.colors.length]},s.enable(s.load()),s}))(e);const{formatters:t}=n.exports;t.j=function(r){try{return JSON.stringify(r)}catch(s){return"[UnexpectedJSONParseError]: "+s.message}}})(Lf,Lf.exports)),Lf.exports;const x5=typeof Buffer>"u"?()=>!1:n=>Buffer.isBuffer(n);function iv(n){return Object.prototype.toString.call(n)==="[object Object]"}function v5(n){if(iv(n)===!1)return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(iv(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)}const y5=["boolean","string","number"];function E5(){return{processOptions:n=>{const e=n.body;return!e||typeof e.pipe=="function"||x5(e)||y5.indexOf(typeof e)===-1&&!Array.isArray(e)&&!v5(e)?n:Object.assign({},n,{body:JSON.stringify(n.body),headers:Object.assign({},n.headers,{"Content-Type":"application/json"})})}}}function w5(n){return{onResponse:t=>{const r=t.headers["content-type"]||"",s=n&&n.force||r.indexOf("application/json")!==-1;return t.body&&r&&s?Object.assign({},t,{body:e(t.body)}):t},processOptions:t=>Object.assign({},t,{headers:Object.assign({Accept:"application/json"},t.headers)})};function e(t){try{return JSON.parse(t)}catch(r){throw r.message=`Failed to parsed response body as JSON: ${r.message}`,r}}}let Ha={};typeof globalThis<"u"?Ha=globalThis:typeof window<"u"?Ha=window:typeof global<"u"?Ha=global:typeof self<"u"&&(Ha=self);var b5=Ha;function S5(n={}){const e=n.implementation||b5.Observable;if(!e)throw new Error("`Observable` is not available in global scope, and no implementation was passed");return{onReturn:(t,r)=>new e(s=>(t.error.subscribe(i=>s.error(i)),t.progress.subscribe(i=>s.next(Object.assign({type:"progress"},i))),t.response.subscribe(i=>{s.next(Object.assign({type:"response"},i)),s.complete()}),t.request.publish(r),()=>t.abort.publish()))}}function T5(){return{onRequest:n=>{if(n.adapter!=="xhr")return;const e=n.request,t=n.context;function r(s){return i=>{const a=i.lengthComputable?i.loaded/i.total*100:-1;t.channels.progress.publish({stage:s,percent:a,total:i.total,loaded:i.loaded,lengthComputable:i.lengthComputable})}}"upload"in e&&"onprogress"in e.upload&&(e.upload.onprogress=r("upload")),"onprogress"in e&&(e.onprogress=r("download"))}}}var k2=(n,e,t)=>(t.method==="GET"||t.method==="HEAD")&&(n.isNetworkError||!1);function _5(n){return 100*Math.pow(2,n)+100*Math.random()}const i0=(n={})=>(e=>{const t=e.maxRetries||5,r=e.retryDelay||_5,s=e.shouldRetry;return{onError:(i,a)=>{const l=a.options,d=l.maxRetries||t,u=l.retryDelay||r,h=l.shouldRetry||s,p=l.attemptNumber||0;if((g=l.body)!==null&&typeof g=="object"&&typeof g.pipe=="function"||!h(i,p,l)||p>=d)return i;var g;const x=Object.assign({},a,{options:Object.assign({},l,{attemptNumber:p+1})});return setTimeout(()=>a.channels.request.publish(x),u(p)),null}}})({shouldRetry:k2,...n});i0.shouldRetry=k2;var bh=function(n,e){return bh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},bh(n,e)};function Pn(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");bh(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function k5(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(h){try{u(r.next(h))}catch(p){a(p)}}function d(h){try{u(r.throw(h))}catch(p){a(p)}}function u(h){h.done?i(h.value):s(h.value).then(l,d)}u((r=r.apply(n,e||[])).next())})}function C2(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(h){return d([u,h])}}function d(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,s=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(h){u=[6,h],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Gi(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ln(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(l){a={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return i}function Rn(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}function Oi(n){return this instanceof Oi?(this.v=n,this):new Oi(n)}function C5(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(x){return function(y){return Promise.resolve(y).then(x,p)}}function l(x,y){r[x]&&(s[x]=function(E){return new Promise(function(w,S){i.push([x,E,w,S])>1||d(x,E)})},y&&(s[x]=y(s[x])))}function d(x,y){try{u(r[x](y))}catch(E){g(i[0][3],E)}}function u(x){x.value instanceof Oi?Promise.resolve(x.value.v).then(h,p):g(i[0][2],x)}function h(x){d("next",x)}function p(x){d("throw",x)}function g(x,y){x(y),i.shift(),i.length&&d(i[0][0],i[0][1])}}function I5(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Gi=="function"?Gi(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(a){return new Promise(function(l,d){a=n[i](a),s(l,d,a.done,a.value)})}}function s(i,a,l,d){Promise.resolve(d).then(function(u){i({value:u,done:l})},a)}}function lt(n){return typeof n=="function"}function a0(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Rf=a0(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Ac(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var xo=(function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var l=Gi(a),d=l.next();!d.done;d=l.next()){var u=d.value;u.remove(this)}}catch(E){e={error:E}}finally{try{d&&!d.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(lt(h))try{h()}catch(E){i=E instanceof Rf?E.errors:[E]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var g=Gi(p),x=g.next();!x.done;x=g.next()){var y=x.value;try{av(y)}catch(E){i=i??[],E instanceof Rf?i=Rn(Rn([],Ln(i)),Ln(E.errors)):i.push(E)}}}catch(E){r={error:E}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(r)throw r.error}}}if(i)throw new Rf(i)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)av(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ac(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&Ac(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=(function(){var e=new n;return e.closed=!0,e})(),n})(),I2=xo.EMPTY;function A2(n){return n instanceof xo||n&&"closed"in n&&lt(n.remove)&&lt(n.add)&&lt(n.unsubscribe)}function av(n){lt(n)?n():n.unsubscribe()}var A5={Promise:void 0},L5={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,Rn([n,e],Ln(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function L2(n){L5.setTimeout(function(){throw n})}function ov(){}function dc(n){n()}var o0=(function(n){Pn(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,A2(t)&&t.add(r)):r.destination=D5,r}return e.create=function(t,r,s){return new Hi(t,r,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(xo),R5=(function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){Xl(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){Xl(r)}else Xl(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Xl(t)}},n})(),Hi=(function(n){Pn(e,n);function e(t,r,s){var i=n.call(this)||this,a;return lt(t)||!t?a={next:t??void 0,error:r??void 0,complete:s??void 0}:a=t,i.destination=new R5(a),i}return e})(o0);function Xl(n){L2(n)}function N5(n){throw n}var D5={closed:!0,next:ov,error:N5,complete:ov},l0=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function zc(n){return n}function P5(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return R2(n)}function R2(n){return n.length===0?zc:n.length===1?n[0]:function(t){return n.reduce(function(r,s){return s(r)},t)}}var vt=(function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var s=this,i=j5(e)?e:new Hi(e,t,r);return dc(function(){var a=s,l=a.operator,d=a.source;i.add(l?l.call(i,d):d?s._subscribe(i):s._trySubscribe(i))}),i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=lv(t),new t(function(s,i){var a=new Hi({next:function(l){try{e(l)}catch(d){i(d),a.unsubscribe()}},error:i,complete:s});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[l0]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return R2(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=lv(e),new e(function(r,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return r(i)})})},n.create=function(e){return new n(e)},n})();function lv(n){var e;return(e=n??A5.Promise)!==null&&e!==void 0?e:Promise}function O5(n){return n&&lt(n.next)&&lt(n.error)&&lt(n.complete)}function j5(n){return n&&n instanceof o0||O5(n)&&A2(n)}function M5(n){return lt(n?.lift)}function cn(n){return function(e){if(M5(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ps(n,e,t,r,s){return new F5(n,e,t,r,s)}var F5=(function(n){Pn(e,n);function e(t,r,s,i,a,l){var d=n.call(this,t)||this;return d.onFinalize=a,d.shouldUnsubscribe=l,d._next=r?function(u){try{r(u)}catch(h){t.error(h)}}:n.prototype._next,d._error=i?function(u){try{i(u)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,d._complete=s?function(){try{s()}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._complete,d}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e})(o0),U5=a0(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),c0=(function(n){Pn(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new cv(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new U5},e.prototype.next=function(t){var r=this;dc(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=Gi(r.currentObservers),l=a.next();!l.done;l=a.next()){var d=l.value;d.next(t)}}catch(u){s={error:u}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var r=this;dc(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;dc(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=this,i=s.hasError,a=s.isStopped,l=s.observers;return i||a?I2:(this.currentObservers=null,l.push(t),new xo(function(){r.currentObservers=null,Ac(l,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,i=r.thrownError,a=r.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new vt;return t.source=this,t},e.create=function(t,r){return new cv(t,r)},e})(vt),cv=(function(n){Pn(e,n);function e(t,r){var s=n.call(this)||this;return s.destination=t,s.source=r,s}return e.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},e.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:I2},e})(c0),u0={now:function(){return(u0.delegate||Date).now()},delegate:void 0},B5=(function(n){Pn(e,n);function e(t,r,s){t===void 0&&(t=1/0),r===void 0&&(r=1/0),s===void 0&&(s=u0);var i=n.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(t){var r=this,s=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,l=r._timestampProvider,d=r._windowTime;s||(i.push(t),!a&&i.push(l.now()+d)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),s=this,i=s._infiniteTimeWindow,a=s._buffer,l=a.slice(),d=0;d<l.length&&!t.closed;d+=i?1:2)t.next(l[d]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,s=t._timestampProvider,i=t._buffer,a=t._infiniteTimeWindow,l=(a?1:2)*r;if(r<1/0&&l<i.length&&i.splice(0,i.length-l),!a){for(var d=s.now(),u=0,h=1;h<i.length&&i[h]<=d;h+=2)u=h;u&&i.splice(0,u+1)}},e})(c0),$5=(function(n){Pn(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e})(xo),uv={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,Rn([n,e],Ln(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},V5=(function(n){Pn(e,n);function e(t,r){var s=n.call(this,t,r)||this;return s.scheduler=t,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(t,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,a=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(a,i,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),uv.setInterval(t.flush.bind(t,this),s)},e.prototype.recycleAsyncId=function(t,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&uv.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var s=!1,i;try{this.work(t)}catch(a){s=!0,i=a||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,s=t.scheduler,i=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ac(i,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e})($5),dv=(function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=u0.now,n})(),G5=(function(n){Pn(e,n);function e(t,r){r===void 0&&(r=dv.now);var s=n.call(this,t,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var s;this._active=!0;do if(s=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,s){for(;t=r.shift();)t.unsubscribe();throw s}},e})(dv),H5=new G5(V5),q5=H5,K5=new vt(function(n){return n.complete()});function z5(n){return n&&lt(n.schedule)}function d0(n){return n[n.length-1]}function W5(n){return lt(d0(n))?n.pop():void 0}function f0(n){return z5(d0(n))?n.pop():void 0}function Y5(n,e){return typeof d0(n)=="number"?n.pop():e}var N2=(function(n){return n&&typeof n.length=="number"&&typeof n!="function"});function D2(n){return lt(n?.then)}function P2(n){return lt(n[l0])}function O2(n){return Symbol.asyncIterator&&lt(n?.[Symbol.asyncIterator])}function j2(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Q5(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var M2=Q5();function F2(n){return lt(n?.[M2])}function U2(n){return C5(this,arguments,function(){var t,r,s,i;return C2(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Oi(t.read())];case 3:return r=a.sent(),s=r.value,i=r.done,i?[4,Oi(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Oi(s)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function B2(n){return lt(n?.getReader)}function un(n){if(n instanceof vt)return n;if(n!=null){if(P2(n))return X5(n);if(N2(n))return Z5(n);if(D2(n))return J5(n);if(O2(n))return $2(n);if(F2(n))return e4(n);if(B2(n))return t4(n)}throw j2(n)}function X5(n){return new vt(function(e){var t=n[l0]();if(lt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Z5(n){return new vt(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function J5(n){return new vt(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,L2)})}function e4(n){return new vt(function(e){var t,r;try{for(var s=Gi(n),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(l){t={error:l}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}e.complete()})}function $2(n){return new vt(function(e){r4(n,e).catch(function(t){return e.error(t)})})}function t4(n){return $2(U2(n))}function r4(n,e){var t,r,s,i;return k5(this,void 0,void 0,function(){var a,l;return C2(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),t=I5(n),d.label=1;case 1:return[4,t.next()];case 2:if(r=d.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=d.sent(),s={error:l},[3,11];case 6:return d.trys.push([6,,9,10]),r&&!r.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Bs(n,e,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function V2(n,e){return e===void 0&&(e=0),cn(function(t,r){t.subscribe(ps(r,function(s){return Bs(r,n,function(){return r.next(s)},e)},function(){return Bs(r,n,function(){return r.complete()},e)},function(s){return Bs(r,n,function(){return r.error(s)},e)}))})}function G2(n,e){return e===void 0&&(e=0),cn(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function n4(n,e){return un(n).pipe(G2(e),V2(e))}function s4(n,e){return un(n).pipe(G2(e),V2(e))}function i4(n,e){return new vt(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function a4(n,e){return new vt(function(t){var r;return Bs(t,e,function(){r=n[M2](),Bs(t,e,function(){var s,i,a;try{s=r.next(),i=s.value,a=s.done}catch(l){t.error(l);return}a?t.complete():t.next(i)},0,!0)}),function(){return lt(r?.return)&&r.return()}})}function H2(n,e){if(!n)throw new Error("Iterable cannot be null");return new vt(function(t){Bs(t,e,function(){var r=n[Symbol.asyncIterator]();Bs(t,e,function(){r.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function o4(n,e){return H2(U2(n),e)}function l4(n,e){if(n!=null){if(P2(n))return n4(n,e);if(N2(n))return i4(n,e);if(D2(n))return s4(n,e);if(O2(n))return H2(n,e);if(F2(n))return a4(n,e);if(B2(n))return o4(n,e)}throw j2(n)}function vo(n,e){return e?l4(n,e):un(n)}function ji(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=f0(n);return vo(n,t)}function q2(n,e){var t=lt(n)?n:function(){return n},r=function(s){return s.error(t())};return new vt(r)}function c4(n){return!!n&&(n instanceof vt||lt(n.lift)&&lt(n.subscribe))}var K2=a0(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function $e(n,e){return new Promise(function(t,r){var s=!1,i;n.subscribe({next:function(a){i=a,s=!0},error:r,complete:function(){s?t(i):r(new K2)}})})}function Nf(n,e){return new Promise(function(t,r){var s=new Hi({next:function(i){t(i),s.unsubscribe()},error:r,complete:function(){r(new K2)}});n.subscribe(s)})}function u4(n){return n instanceof Date&&!isNaN(n)}function zt(n,e){return cn(function(t,r){var s=0;t.subscribe(ps(r,function(i){r.next(n.call(e,i,s++))}))})}var d4=Array.isArray;function f4(n,e){return d4(e)?n.apply(void 0,Rn([],Ln(e))):n(e)}function h4(n){return zt(function(e){return f4(n,e)})}function m4(n,e,t){return t===void 0&&(t=zc),function(r){fv(e,function(){for(var s=n.length,i=new Array(s),a=s,l=s,d=function(h){fv(e,function(){var p=vo(n[h],e),g=!1;p.subscribe(ps(r,function(x){i[h]=x,g||(g=!0,l--),l||r.next(t(i.slice()))},function(){--a||r.complete()}))},r)},u=0;u<s;u++)d(u)})}}function fv(n,e,t){e()}function p4(n,e,t,r,s,i,a,l){var d=[],u=0,h=0,p=!1,g=function(){p&&!d.length&&!u&&e.complete()},x=function(E){return u<r?y(E):d.push(E)},y=function(E){u++;var w=!1;un(t(E,h++)).subscribe(ps(e,function(S){e.next(S)},function(){w=!0},void 0,function(){if(w)try{u--;for(var S=function(){var T=d.shift();a||y(T)};d.length&&u<r;)S();g()}catch(T){e.error(T)}}))};return n.subscribe(ps(e,x,function(){p=!0,g()})),function(){}}function $s(n,e,t){return t===void 0&&(t=1/0),lt(e)?$s(function(r,s){return zt(function(i,a){return e(r,i,s,a)})(un(n(r,s)))},t):(typeof e=="number"&&(t=e),cn(function(r,s){return p4(r,s,n,t)}))}function z2(n){return n===void 0&&(n=1/0),$s(zc,n)}function g4(){return z2(1)}function x4(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return g4()(vo(n,f0(n)))}function W2(n){return new vt(function(e){un(n()).subscribe(e)})}function v4(n,e,t){return t===void 0&&(t=q5),new vt(function(r){var s=u4(n)?+n-t.now():n;s<0&&(s=0);var i=0;return t.schedule(function(){r.closed||(r.next(i++),r.complete())},s)})}function y4(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=f0(n),r=Y5(n,1/0),s=n;return s.length?s.length===1?un(s[0]):z2(r)(vo(s,t)):K5}var E4=Array.isArray;function w4(n){return n.length===1&&E4(n[0])?n[0]:n}function Xi(n,e){return cn(function(t,r){var s=0;t.subscribe(ps(r,function(i){return n.call(e,i,s++)&&r.next(i)}))})}function Lc(n){return cn(function(e,t){var r=null,s=!1,i;r=e.subscribe(ps(t,void 0,void 0,function(a){i=un(n(a,Lc(n)(e))),r?(r.unsubscribe(),r=null,i.subscribe(t)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(t))})}function Y2(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=W5(n);return t?P5(Y2.apply(void 0,Rn([],Ln(n))),h4(t)):cn(function(r,s){m4(Rn([r],Ln(w4(n))))(s)})}function b4(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Y2.apply(void 0,Rn([],Ln(n)))}function Q2(n){return cn(function(e,t){try{e.subscribe(t)}finally{t.add(n)}})}function X2(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new c0}:e,r=n.resetOnError,s=r===void 0?!0:r,i=n.resetOnComplete,a=i===void 0?!0:i,l=n.resetOnRefCountZero,d=l===void 0?!0:l;return function(u){var h,p,g,x=0,y=!1,E=!1,w=function(){p?.unsubscribe(),p=void 0},S=function(){w(),h=g=void 0,y=E=!1},T=function(){var k=h;S(),k?.unsubscribe()};return cn(function(k,I){x++,!E&&!y&&w();var L=g=g??t();I.add(function(){x--,x===0&&!E&&!y&&(p=Df(T,d))}),L.subscribe(I),!h&&x>0&&(h=new Hi({next:function(O){return L.next(O)},error:function(O){E=!0,w(),p=Df(S,s,O),L.error(O)},complete:function(){y=!0,w(),p=Df(S,a),L.complete()}}),un(k).subscribe(h))})(u)}}function Df(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var s=new Hi({next:function(){s.unsubscribe(),n()}});return un(e.apply(void 0,Rn([],Ln(t)))).subscribe(s)}}function S4(n,e,t){var r,s=!1;return r=n,X2({connector:function(){return new B5(r,e,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}function T4(n,e,t){var r=lt(n)||e||t?{next:n,error:e,complete:t}:n;return r?cn(function(s,i){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var l=!0;s.subscribe(ps(i,function(d){var u;(u=r.next)===null||u===void 0||u.call(r,d),i.next(d)},function(){var d;l=!1,(d=r.complete)===null||d===void 0||d.call(r),i.complete()},function(d){var u;l=!1,(u=r.error)===null||u===void 0||u.call(r,d),i.error(d)},function(){var d,u;l&&((d=r.unsubscribe)===null||d===void 0||d.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):zc}function Z2(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}var J2={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},eE={0:8203,1:8204,2:8205,3:65279};new Array(4).fill(String.fromCodePoint(eE[0])).join("");Object.fromEntries(Object.entries(eE).map(n=>n.reverse()));Object.fromEntries(Object.entries(J2).map(n=>n.reverse()));var _4=`${Object.values(J2).map(n=>`\\u{${n.toString(16)}}`).join("")}`,hv=new RegExp(`[${_4}]{4,}`,"gu");function k4(n){var e;return{cleaned:n.replace(hv,""),encoded:((e=n.match(hv))==null?void 0:e[0])||""}}function C4(n){return n&&JSON.parse(k4(JSON.stringify(n)).cleaned)}function I4(n){return C4(n)}const A4="drafts",L4="versions",qi=".",Rc=`${A4}${qi}`,tE=`${L4}${qi}`;function Wc(n){return n.startsWith(Rc)}function Yc(n){return n.startsWith(tE)}function rE(n){if(Yc(n)){const e=Qc(n);return Rc+e}return Wc(n)?n:Rc+n}function yo(n,e){if(e==="drafts"||e==="published")throw new Error('Version can not be "published" or "drafts"');return`${tE}${e}${qi}${Qc(n)}`}function nE(n){if(!Yc(n))return;const[e,t,...r]=n.split(qi);return t}function Qc(n){return Yc(n)?n.split(qi).slice(2).join(qi):Wc(n)?n.slice(Rc.length):n}let R4=n=>crypto.getRandomValues(new Uint8Array(n)),N4=(n,e,t)=>{let r=(2<<Math.log(n.length-1)/Math.LN2)-1,s=-~(1.6*r*e/n.length);return(i=e)=>{let a="";for(;;){let l=t(s),d=s|0;for(;d--;)if(a+=n[l[d]&r]||"",a.length===i)return a}}},D4=(n,e=21)=>N4(n,e,R4);const mv=/\r\n|[\n\r\u2028\u2029]/;function P4(n,e,t){const r=n.split(mv),s={start:pv(e.start,r),end:e.end?pv(e.end,r):void 0},{start:i,end:a,markerLines:l}=O4(s,r),d=`${a}`.length;return n.split(mv,a).slice(i,a).map((u,h)=>{const p=i+1+h,g=` ${` ${p}`.slice(-d)} |`,x=l[p],y=!l[p+1];if(!x)return` ${g}${u.length>0?` ${u}`:""}`;let E="";if(Array.isArray(x)){const w=u.slice(0,Math.max(x[0]-1,0)).replace(/[^\t]/g," "),S=x[1]||1;E=[`
 `,g.replace(/\d/g," ")," ",w,"^".repeat(S)].join(""),y&&t&&(E+=" "+t)}return[">",g,u.length>0?` ${u}`:"",E].join("")}).join(`
`)}function O4(n,e){const t={...n.start},r={...t,...n.end},s=2,i=3,a=t.line??-1,l=t.column??0,d=r.line,u=r.column;let h=Math.max(a-(s+1),0),p=Math.min(e.length,d+i);a===-1&&(h=0),d===-1&&(p=e.length);const g=d-a,x={};if(g)for(let y=0;y<=g;y++){const E=y+a;if(!l)x[E]=!0;else if(y===0){const w=e[E-1].length;x[E]=[l,w-l+1]}else if(y===g)x[E]=[0,u];else{const w=e[E-y].length;x[E]=[0,w]}}else l===u?l?x[a]=[l,0]:x[a]=!0:x[a]=[l,u-l];return{start:h,end:p,markerLines:x}}function pv(n,e){let t=0;for(let r=0;r<e.length;r++){const s=e[r].length+1;if(t+s>n)return{line:r+1,column:n-t};t+=s}return{line:e.length,column:e[e.length-1]?.length??0}}const Pf=5;class j4 extends Error{response;statusCode=400;responseBody;details;constructor(e,t){const r=sE(e,t);super(r.message),Object.assign(this,r)}}class M4 extends Error{response;statusCode=500;responseBody;details;constructor(e){const t=sE(e);super(t.message),Object.assign(this,t)}}function sE(n,e){const t=n.body,r={response:n,statusCode:n.statusCode,responseBody:B4(t,n),message:"",details:void 0};if(!Z2(t))return r.message=Of(n,t),r;const s=t.error;if(typeof s=="string"&&typeof t.message=="string")return r.message=`${s} - ${t.message}`,r;if(typeof s!="object"||s===null)return typeof s=="string"?r.message=s:typeof t.message=="string"?r.message=t.message:r.message=Of(n,t),r;if(F4(s)||U4(s)){const i=s.items||[],a=i.slice(0,Pf).map(d=>d.error?.description).filter(Boolean);let l=a.length?`:
- ${a.join(`
- `)}`:"";return i.length>Pf&&(l+=`
...and ${i.length-Pf} more`),r.message=`${s.description}${l}`,r.details=t.error,r}if(iE(s)){const i=e?.options?.query?.tag;return r.message=aE(s,i),r.details=t.error,r}return"description"in s&&typeof s.description=="string"?(r.message=s.description,r.details=s,r):(r.message=Of(n,t),r)}function F4(n){return"type"in n&&n.type==="mutationError"&&"description"in n&&typeof n.description=="string"}function U4(n){return"type"in n&&n.type==="actionError"&&"description"in n&&typeof n.description=="string"}function iE(n){return Z2(n)&&n.type==="queryParseError"&&typeof n.query=="string"&&typeof n.start=="number"&&typeof n.end=="number"}function aE(n,e){const{query:t,start:r,end:s,description:i}=n;if(!t||typeof r>"u")return`GROQ query parse error: ${i}`;const a=e?`

Tag: ${e}`:"";return`GROQ query parse error:
${P4(t,{start:r,end:s},i)}${a}`}function Of(n,e){const t=typeof e=="string"?` (${$4(e,100)})`:"",r=n.statusMessage?` ${n.statusMessage}`:"";return`${n.method}-request to ${n.url} resulted in HTTP ${n.statusCode}${r}${t}`}function B4(n,e){return(e.headers["content-type"]||"").toLowerCase().indexOf("application/json")!==-1?JSON.stringify(n,null,2):n}function $4(n,e){return n.length>e?`${n.slice(0,e)}`:n}class V4 extends Error{projectId;addOriginUrl;constructor({projectId:e}){super("CorsOriginError"),this.name="CorsOriginError",this.projectId=e;const t=new URL(`https://sanity.io/manage/project/${e}/api`);if(typeof location<"u"){const{origin:r}=location;t.searchParams.set("cors","add"),t.searchParams.set("origin",r),this.addOriginUrl=t,this.message=`The current origin is not allowed to connect to the Live Content API. Add it here: ${t}`}else this.message=`The current origin is not allowed to connect to the Live Content API. Change your configuration here: ${t}`}}const G4={onResponse:(n,e)=>{if(n.statusCode>=500)throw new M4(n);if(n.statusCode>=400)throw new j4(n,e);return n}};function H4(n={}){const e={},t=r=>n.ignoreWarnings===void 0?!1:(Array.isArray(n.ignoreWarnings)?n.ignoreWarnings:[n.ignoreWarnings]).some(s=>typeof s=="string"?r.includes(s):s instanceof RegExp?s.test(r):!1);return{onResponse:r=>{const s=r.headers["x-sanity-warning"],i=Array.isArray(s)?s:[s];for(const a of i)!a||e[a]||t(a)||(e[a]=!0,console.warn(a));return r}}}function gv(n,e={}){return p5([i0({shouldRetry:q4}),...n,H4(e),E5(),w5(),T5(),G4,S5({implementation:vt})])}function q4(n,e,t){if(t.maxRetries===0)return!1;const r=t.method==="GET"||t.method==="HEAD",s=(t.uri||t.url).startsWith("/data/query"),i=n.response&&(n.response.statusCode===429||n.response.statusCode===502||n.response.statusCode===503);return(r||s)&&i?!0:i0.shouldRetry(n,e,t)}const K4="https://www.sanity.io/help/";function h0(n){return K4+n}const xv=["image","file"],vv=["before","after","replace"],oE=n=>{if(!/^(~[a-z0-9]{1}[-\w]{0,63}|[a-z0-9]{1}[-\w]{0,63})$/.test(n))throw new Error("Datasets can only contain lowercase characters, numbers, underscores and dashes, and start with tilde, and be maximum 64 characters")},z4=n=>{if(!/^[-a-z0-9]+$/i.test(n))throw new Error("`projectId` can only contain only a-z, 0-9 and dashes")},W4=n=>{if(xv.indexOf(n)===-1)throw new Error(`Invalid asset type: ${n}. Must be one of ${xv.join(", ")}`)},Qa=(n,e)=>{if(e===null||typeof e!="object"||Array.isArray(e))throw new Error(`${n}() takes an object of properties`)},Nc=(n,e)=>{if(typeof e!="string"||!/^[a-z0-9_][a-z0-9_.-]{0,127}$/i.test(e)||e.includes(".."))throw new Error(`${n}(): "${e}" is not a valid document ID`)},Ki=(n,e)=>{if(!e._id)throw new Error(`${n}() requires that the document contains an ID ("_id" property)`);Nc(n,e._id)},Y4=(n,e)=>{if(typeof e!="string")throw new Error(`\`${n}()\`: \`${e}\` is not a valid document type`)},lE=(n,e)=>{if(!e._type)throw new Error(`\`${n}()\` requires that the document contains a type (\`_type\` property)`);Y4(n,e._type)},Q4=(n,e)=>{if(e._id&&e._id!==n)throw new Error(`The provided document ID (\`${e._id}\`) does not match the generated version ID (\`${n}\`)`)},X4=(n,e,t)=>{const r="insert(at, selector, items)";if(vv.indexOf(n)===-1){const s=vv.map(i=>`"${i}"`).join(", ");throw new Error(`${r} takes an "at"-argument which is one of: ${s}`)}if(typeof e!="string")throw new Error(`${r} takes a "selector"-argument which must be a string`);if(!Array.isArray(t))throw new Error(`${r} takes an "items"-argument which must be an array`)},zs=n=>{if(!n.dataset)throw new Error("`dataset` must be provided to perform queries");return n.dataset||""},cE=n=>{if(typeof n!="string"||!/^[a-z0-9._-]{1,75}$/i.test(n))throw new Error("Tag can only contain alphanumeric characters, underscores, dashes and dots, and be between one and 75 characters long.");return n},uE=n=>{if(!n["~experimental_resource"])throw new Error("`resource` must be provided to perform resource queries");const{type:e,id:t}=n["~experimental_resource"];switch(e){case"dataset":{if(t.split(".").length!==2)throw new Error('Dataset resource ID must be in the format "project.dataset"');return}case"dashboard":case"media-library":case"canvas":return;default:throw new Error(`Unsupported resource type: ${e.toString()}`)}},Fs=(n,e)=>{if(e["~experimental_resource"])throw new Error(`\`${n}\` does not support resource-based operations`)};function Z4(n){let e=!1,t;return(...r)=>(e||(t=n(...r),e=!0),t)}const xs=n=>Z4((...e)=>console.warn(n.join(" "),...e)),J4=xs(["Because you set `withCredentials` to true, we will override your `useCdn`","setting to be false since (cookie-based) credentials are never set on the CDN"]),eN=xs(["Since you haven't set a value for `useCdn`, we will deliver content using our","global, edge-cached API-CDN. If you wish to have content delivered faster, set","`useCdn: false` to use the Live API. Note: You may incur higher costs using the live API."]),tN=xs(["The Sanity client is configured with the `perspective` set to `drafts` or `previewDrafts`, which doesn't support the API-CDN.","The Live API will be used instead. Set `useCdn: false` in your configuration to hide this warning."]),rN=xs(["The `previewDrafts` perspective has been renamed to  `drafts` and will be removed in a future API version"]),nN=xs(["You have configured Sanity client to use a token in the browser. This may cause unintentional security issues.",`See ${h0("js-client-browser-token")} for more information and how to hide this warning.`]),sN=xs(["You have configured Sanity client to use a token, but also provided `withCredentials: true`.","This is no longer supported - only token will be used - remove `withCredentials: true`."]),iN=xs(["Using the Sanity client without specifying an API version is deprecated.",`See ${h0("js-client-api-version")}`]),aN=xs(["You have called `createVersion()` with a defined `document`. The recommended approach is to provide a `baseId` and `releaseId` instead."]),oN="apicdn.sanity.io",Xa={apiHost:"https://api.sanity.io",apiVersion:"1",useProjectHostname:!0,stega:{enabled:!1}},lN=["localhost","127.0.0.1","0.0.0.0"],cN=n=>lN.indexOf(n)!==-1;function uN(n){if(n==="1"||n==="X")return;const e=new Date(n);if(!(/^\d{4}-\d{2}-\d{2}$/.test(n)&&e instanceof Date&&e.getTime()>0))throw new Error("Invalid API version string, expected `1` or date in format `YYYY-MM-DD`")}function dE(n){if(Array.isArray(n)&&n.length>1&&n.includes("raw"))throw new TypeError('Invalid API perspective value: "raw". The raw-perspective can not be combined with other perspectives')}const fE=(n,e)=>{const t={...e,...n,stega:{...typeof e.stega=="boolean"?{enabled:e.stega}:e.stega||Xa.stega,...typeof n.stega=="boolean"?{enabled:n.stega}:n.stega||{}}};t.apiVersion||iN();const r={...Xa,...t},s=r.useProjectHostname&&!r["~experimental_resource"];if(typeof Promise>"u"){const g=h0("js-client-promise-polyfill");throw new Error(`No native Promise-implementation found, polyfill needed - see ${g}`)}if(s&&!r.projectId)throw new Error("Configuration must contain `projectId`");if(r["~experimental_resource"]&&uE(r),typeof r.perspective<"u"&&dE(r.perspective),"encodeSourceMap"in r)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMap' is not supported in '@sanity/client'. Did you mean 'stega.enabled'?");if("encodeSourceMapAtPath"in r)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMapAtPath' is not supported in '@sanity/client'. Did you mean 'stega.filter'?");if(typeof r.stega.enabled!="boolean")throw new Error(`stega.enabled must be a boolean, received ${r.stega.enabled}`);if(r.stega.enabled&&r.stega.studioUrl===void 0)throw new Error("stega.studioUrl must be defined when stega.enabled is true");if(r.stega.enabled&&typeof r.stega.studioUrl!="string"&&typeof r.stega.studioUrl!="function")throw new Error(`stega.studioUrl must be a string or a function, received ${r.stega.studioUrl}`);const i=typeof window<"u"&&window.location&&window.location.hostname,a=i&&cN(window.location.hostname),l=!!r.token;r.withCredentials&&l&&(sN(),r.withCredentials=!1),i&&a&&l&&r.ignoreBrowserTokenWarning!==!0?nN():typeof r.useCdn>"u"&&eN(),s&&z4(r.projectId),r.dataset&&oE(r.dataset),"requestTagPrefix"in r&&(r.requestTagPrefix=r.requestTagPrefix?cE(r.requestTagPrefix).replace(/\.+$/,""):void 0),r.apiVersion=`${r.apiVersion}`.replace(/^v/,""),r.isDefaultApi=r.apiHost===Xa.apiHost,r.useCdn===!0&&r.withCredentials&&J4(),r.useCdn=r.useCdn!==!1&&!r.withCredentials,uN(r.apiVersion);const d=r.apiHost.split("://",2),u=d[0],h=d[1],p=r.isDefaultApi?oN:h;return s?(r.url=`${u}://${r.projectId}.${h}/v${r.apiVersion}`,r.cdnUrl=`${u}://${r.projectId}.${p}/v${r.apiVersion}`):(r.url=`${r.apiHost}/v${r.apiVersion}`,r.cdnUrl=r.url),r};class hE extends Error{name="ConnectionFailedError"}class dN extends Error{name="DisconnectError";reason;constructor(e,t,r={}){super(e,r),this.reason=t}}class fN extends Error{name="ChannelError";data;constructor(e,t){super(e),this.data=t}}class hN extends Error{name="MessageError";data;constructor(e,t,r={}){super(e,r),this.data=t}}class yv extends Error{name="MessageParseError"}const mN=["channelError","disconnect"];function mE(n,e){return W2(()=>{const t=n();return c4(t)?t:ji(t)}).pipe($s(t=>pN(t,e)))}function pN(n,e){return new vt(t=>{const r=e.includes("open"),s=e.includes("reconnect");function i(u){if("data"in u){const[h,p]=Ev(u);t.error(h?new yv("Unable to parse EventSource error message",{cause:p}):new hN((p?.data).message,p));return}n.readyState===n.CLOSED?t.error(new hE("EventSource connection failed")):s&&t.next({type:"reconnect"})}function a(){t.next({type:"open"})}function l(u){const[h,p]=Ev(u);if(h){t.error(new yv("Unable to parse EventSource message",{cause:h}));return}if(u.type==="channelError"){const g=new URL(n.url).searchParams.get("tag");t.error(new fN(gN(p?.data,g),p.data));return}if(u.type==="disconnect"){t.error(new dN(`Server disconnected client: ${p.data?.reason||"unknown error"}`));return}t.next({type:u.type,id:u.lastEventId,...p.data?{data:p.data}:{}})}n.addEventListener("error",i),r&&n.addEventListener("open",a);const d=[...new Set([...mN,...e])].filter(u=>u!=="error"&&u!=="open"&&u!=="reconnect");return d.forEach(u=>n.addEventListener(u,l)),()=>{n.removeEventListener("error",i),r&&n.removeEventListener("open",a),d.forEach(u=>n.removeEventListener(u,l)),n.close()}})}function Ev(n){try{const e=typeof n.data=="string"&&JSON.parse(n.data);return[null,{type:n.type,id:n.lastEventId,...xN(e)?{}:{data:e}}]}catch(e){return[e,null]}}function gN(n,e){const t=n.error;return t?iE(t)?aE(t,e):t.description?t.description:typeof t=="string"?t:JSON.stringify(t,null,2):n.message||"Unknown listener error"}function xN(n){for(const e in n)return!1;return!0}function pE(n){if(typeof n=="string")return{id:n};if(Array.isArray(n))return{query:"*[_id in $ids]",params:{ids:n}};if(typeof n=="object"&&n!==null&&"query"in n&&typeof n.query=="string")return"params"in n&&typeof n.params=="object"&&n.params!==null?{query:n.query,params:n.params}:{query:n.query};const e=["* Document ID (<docId>)","* Array of document IDs","* Object containing `query`"].join(`
`);throw new Error(`Unknown selection - must be one of:

${e}`)}class gE{selection;operations;constructor(e,t={}){this.selection=e,this.operations=t}set(e){return this._assign("set",e)}setIfMissing(e){return this._assign("setIfMissing",e)}diffMatchPatch(e){return Qa("diffMatchPatch",e),this._assign("diffMatchPatch",e)}unset(e){if(!Array.isArray(e))throw new Error("unset(attrs) takes an array of attributes to unset, non-array given");return this.operations=Object.assign({},this.operations,{unset:e}),this}inc(e){return this._assign("inc",e)}dec(e){return this._assign("dec",e)}insert(e,t,r){return X4(e,t,r),this._assign("insert",{[e]:t,items:r})}append(e,t){return this.insert("after",`${e}[-1]`,t)}prepend(e,t){return this.insert("before",`${e}[0]`,t)}splice(e,t,r,s){const i=typeof r>"u"||r===-1,a=t<0?t-1:t,l=i?-1:Math.max(0,t+r),d=a<0&&l>=0?"":l,u=`${e}[${a}:${d}]`;return this.insert("replace",u,s||[])}ifRevisionId(e){return this.operations.ifRevisionID=e,this}serialize(){return{...pE(this.selection),...this.operations}}toJSON(){return this.serialize()}reset(){return this.operations={},this}_assign(e,t,r=!0){return Qa(e,t),this.operations=Object.assign({},this.operations,{[e]:Object.assign({},r&&this.operations[e]||{},t)}),this}_set(e,t){return this._assign(e,t,!1)}}class Vs extends gE{#t;constructor(e,t,r){super(e,t),this.#t=r}clone(){return new Vs(this.selection,{...this.operations},this.#t)}commit(e){if(!this.#t)throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const t=typeof this.selection=="string",r=Object.assign({returnFirst:t,returnDocuments:!0},e);return this.#t.mutate({patch:this.serialize()},r)}}class cs extends gE{#t;constructor(e,t,r){super(e,t),this.#t=r}clone(){return new cs(this.selection,{...this.operations},this.#t)}commit(e){if(!this.#t)throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const t=typeof this.selection=="string",r=Object.assign({returnFirst:t,returnDocuments:!0},e);return this.#t.mutate({patch:this.serialize()},r)}}const xE={returnDocuments:!1};class vE{operations;trxId;constructor(e=[],t){this.operations=e,this.trxId=t}create(e){return Qa("create",e),this._add({create:e})}createIfNotExists(e){const t="createIfNotExists";return Qa(t,e),Ki(t,e),this._add({[t]:e})}createOrReplace(e){const t="createOrReplace";return Qa(t,e),Ki(t,e),this._add({[t]:e})}delete(e){return Nc("delete",e),this._add({delete:{id:e}})}transactionId(e){return e?(this.trxId=e,this):this.trxId}serialize(){return[...this.operations]}toJSON(){return this.serialize()}reset(){return this.operations=[],this}_add(e){return this.operations.push(e),this}}class Xc extends vE{#t;constructor(e,t,r){super(e,r),this.#t=t}clone(){return new Xc([...this.operations],this.#t,this.trxId)}commit(e){if(!this.#t)throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return this.#t.mutate(this.serialize(),Object.assign({transactionId:this.trxId},xE,e||{}))}patch(e,t){const r=typeof t=="function",s=typeof e!="string"&&e instanceof cs,i=typeof e=="object"&&("query"in e||"id"in e);if(s)return this._add({patch:e.serialize()});if(r){const a=t(new cs(e,{},this.#t));if(!(a instanceof cs))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:a.serialize()})}if(i){const a=new cs(e,t||{},this.#t);return this._add({patch:a.serialize()})}return this._add({patch:{id:e,...t}})}}class Zc extends vE{#t;constructor(e,t,r){super(e,r),this.#t=t}clone(){return new Zc([...this.operations],this.#t,this.trxId)}commit(e){if(!this.#t)throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return this.#t.mutate(this.serialize(),Object.assign({transactionId:this.trxId},xE,e||{}))}patch(e,t){const r=typeof t=="function";if(typeof e!="string"&&e instanceof Vs)return this._add({patch:e.serialize()});if(r){const s=t(new Vs(e,{},this.#t));if(!(s instanceof Vs))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:s.serialize()})}return this._add({patch:{id:e,...t}})}}const vN="X-Sanity-Project-ID";function yN(n,e={}){const t={};n.headers&&Object.assign(t,n.headers);const r=e.token||n.token;r&&(t.Authorization=`Bearer ${r}`),!e.useGlobalApi&&!n.useProjectHostname&&n.projectId&&(t[vN]=n.projectId);const s=!!(typeof e.withCredentials>"u"?n.withCredentials:e.withCredentials),i=typeof e.timeout>"u"?n.timeout:e.timeout;return Object.assign({},e,{headers:Object.assign({},t,e.headers||{}),timeout:typeof i>"u"?300*1e3:i,proxy:e.proxy||n.proxy,json:!0,withCredentials:s,fetch:typeof e.fetch=="object"&&typeof n.fetch=="object"?{...n.fetch,...e.fetch}:e.fetch||n.fetch})}const yE=({query:n,params:e={},options:t={}})=>{const r=new URLSearchParams,{tag:s,includeMutations:i,returnQuery:a,...l}=t;s&&r.append("tag",s),r.append("query",n);for(const[d,u]of Object.entries(e))u!==void 0&&r.append(`$${d}`,JSON.stringify(u));for(const[d,u]of Object.entries(l))u&&r.append(d,`${u}`);return a===!1&&r.append("returnQuery","false"),i===!1&&r.append("includeMutations","false"),`?${r}`},EN=(n,e)=>n===!1?void 0:typeof n>"u"?e:n,wN=(n={})=>({dryRun:n.dryRun,returnIds:!0,returnDocuments:EN(n.returnDocuments,!0),visibility:n.visibility||"sync",autoGenerateArrayKeys:n.autoGenerateArrayKeys,skipCrossDatasetReferenceValidation:n.skipCrossDatasetReferenceValidation}),m0=n=>n.type==="response",bN=n=>n.body,SN=(n,e)=>n.reduce((t,r)=>(t[e(r)]=r,t),Object.create(null)),TN=11264;function EE(n,e,t,r,s={},i={}){const a="stega"in i?{...t||{},...typeof i.stega=="boolean"?{enabled:i.stega}:i.stega||{}}:t,l=a.enabled?I4(s):s,d=i.filterResponse===!1?y=>y:y=>y.result,{cache:u,next:h,...p}={useAbortSignal:typeof i.signal<"u",resultSourceMap:a.enabled?"withKeyArraySelector":i.resultSourceMap,...i,returnQuery:i.filterResponse===!1&&i.returnQuery!==!1},g=typeof u<"u"||typeof h<"u"?{...p,fetch:{cache:u,next:h}}:p,x=Ws(n,e,"query",{query:r,params:l},g);return a.enabled?x.pipe(b4(vo(E2(()=>import("./stegaEncodeSourceMap-CZi2tXs1.js"),[]).then(function(y){return y.stegaEncodeSourceMap$1}).then(({stegaEncodeSourceMap:y})=>y))),zt(([y,E])=>{const w=E(y.result,y.resultSourceMap,a);return d({...y,result:w})})):x.pipe(zt(d))}function zi(n,e,t,r={}){const s=(()=>{if(!r.releaseId)return t;const a=nE(t);if(!a){if(Wc(t))throw new Error(`The document ID (\`${t}\`) is a draft, but \`options.releaseId\` is set as \`${r.releaseId}\``);return yo(t,r.releaseId)}if(a!==r.releaseId)throw new Error(`The document ID (\`${t}\`) is already a version of \`${a}\` release, but this does not match the provided \`options.releaseId\` (\`${r.releaseId}\`)`);return t})(),i={uri:Ir(n,"doc",s),json:!0,tag:r.tag,signal:r.signal,query:r.includeAllVersions!==void 0?{includeAllVersions:r.includeAllVersions}:void 0};return wo(n,e,i).pipe(Xi(m0),zt(a=>{const l=a.body.documents;return l?r.includeAllVersions?l:l[0]:r.includeAllVersions?[]:void 0}))}function wE(n,e,t,r={}){const s={uri:Ir(n,"doc",t.join(",")),json:!0,tag:r.tag,signal:r.signal};return wo(n,e,s).pipe(Xi(m0),zt(i=>{const a=SN(i.body.documents||[],l=>l._id);return t.map(l=>a[l]||null)}))}function bE(n,e,t,r={}){return Ws(n,e,"query",{query:"*[sanity::partOfRelease($releaseId)]",params:{releaseId:t}},r)}function SE(n,e,t,r){return Ki("createIfNotExists",t),Jc(n,e,t,"createIfNotExists",r)}function TE(n,e,t,r){return Ki("createOrReplace",t),Jc(n,e,t,"createOrReplace",r)}function _E(n,e,t,r,s){return Ki("createVersion",t),lE("createVersion",t),aN(),ft(n,e,{actionType:"sanity.action.document.version.create",publishedId:r,document:t},s)}function kE(n,e,t,r,s,i,a){if(!r)throw new Error("`createVersion()` requires `baseId` when no `document` is provided");if(!t)throw new Error("`createVersion()` requires `publishedId` when `baseId` is provided");Nc("createVersion",r),Nc("createVersion",t);const l={actionType:"sanity.action.document.version.create",publishedId:t,baseId:r,versionId:s?yo(t,s):rE(t),ifBaseRevisionId:i};return ft(n,e,l,a)}function CE(n,e,t,r){return Ws(n,e,"mutate",{mutations:[{delete:pE(t)}]},r)}function IE(n,e,t,r=!1,s){return ft(n,e,{actionType:"sanity.action.document.version.discard",versionId:t,purge:r},s)}function AE(n,e,t,r){return Ki("replaceVersion",t),lE("replaceVersion",t),ft(n,e,{actionType:"sanity.action.document.version.replace",document:t},r)}function LE(n,e,t,r,s){return ft(n,e,{actionType:"sanity.action.document.version.unpublish",versionId:t,publishedId:r},s)}function RE(n,e,t,r){let s;t instanceof cs||t instanceof Vs?s={patch:t.serialize()}:t instanceof Xc||t instanceof Zc?s=t.serialize():s=t;const i=Array.isArray(s)?s:[s],a=r&&r.transactionId||void 0;return Ws(n,e,"mutate",{mutations:i,transactionId:a},r)}function ft(n,e,t,r){const s=Array.isArray(t)?t:[t],i=r&&r.transactionId||void 0,a=r&&r.skipCrossDatasetReferenceValidation||void 0,l=r&&r.dryRun||void 0;return Ws(n,e,"actions",{actions:s,transactionId:i,skipCrossDatasetReferenceValidation:a,dryRun:l},r)}function Ws(n,e,t,r,s={}){const i=t==="mutate",a=t==="actions",l=t==="query",d=i||a?"":yE(r),u=!i&&!a&&d.length<TN,h=u?d:"",p=s.returnFirst,{timeout:g,token:x,tag:y,headers:E,returnQuery:w,lastLiveEventId:S,cacheMode:T}=s,k=Ir(n,t,h),I={method:u?"GET":"POST",uri:k,json:!0,body:u?void 0:r,query:i&&wN(s),timeout:g,headers:E,token:x,tag:y,returnQuery:w,perspective:s.perspective,resultSourceMap:s.resultSourceMap,lastLiveEventId:Array.isArray(S)?S[0]:S,cacheMode:T,canUseCdn:l,signal:s.signal,fetch:s.fetch,useAbortSignal:s.useAbortSignal,useCdn:s.useCdn};return wo(n,e,I).pipe(Xi(m0),zt(bN),zt(L=>{if(!i)return L;const O=L.results||[];if(s.returnDocuments)return p?O[0]&&O[0].document:O.map(F=>F.document);const P=p?"documentId":"documentIds",j=p?O[0]&&O[0].id:O.map(F=>F.id);return{transactionId:L.transactionId,results:O,[P]:j}}))}function Jc(n,e,t,r,s={}){const i={[r]:t},a=Object.assign({returnFirst:!0,returnDocuments:!0},s);return Ws(n,e,"mutate",{mutations:[i]},a)}const Eo=n=>n.config().dataset!==void 0&&n.config().projectId!==void 0||n.config()["~experimental_resource"]!==void 0,NE=(n,e)=>Eo(n)&&e.startsWith(Ir(n,"query")),_N=(n,e)=>Eo(n)&&e.startsWith(Ir(n,"mutate")),kN=(n,e)=>Eo(n)&&e.startsWith(Ir(n,"doc","")),CN=(n,e)=>Eo(n)&&e.startsWith(Ir(n,"listen")),IN=(n,e)=>Eo(n)&&e.startsWith(Ir(n,"history","")),AN=(n,e)=>e.startsWith("/data/")||NE(n,e)||_N(n,e)||kN(n,e)||CN(n,e)||IN(n,e);function wo(n,e,t){const r=t.url||t.uri,s=n.config(),i=typeof t.canUseCdn>"u"?["GET","HEAD"].indexOf(t.method||"GET")>=0&&AN(n,r):t.canUseCdn;let a=(t.useCdn??s.useCdn)&&i;const l=t.tag&&s.requestTagPrefix?[s.requestTagPrefix,t.tag].join("."):t.tag||s.requestTagPrefix;if(l&&t.tag!==null&&(t.query={tag:cE(l),...t.query}),["GET","HEAD","POST"].indexOf(t.method||"GET")>=0&&NE(n,r)){const h=t.resultSourceMap??s.resultSourceMap;h!==void 0&&h!==!1&&(t.query={resultSourceMap:h,...t.query});const p=t.perspective||s.perspective;typeof p<"u"&&(p==="previewDrafts"&&rN(),dE(p),t.query={perspective:Array.isArray(p)?p.join(","):p,...t.query},(Array.isArray(p)&&p.length>0||p==="previewDrafts"||p==="drafts")&&a&&(a=!1,tN())),t.lastLiveEventId&&(t.query={...t.query,lastLiveEventId:t.lastLiveEventId}),t.returnQuery===!1&&(t.query={returnQuery:"false",...t.query}),a&&t.cacheMode=="noStale"&&(t.query={cacheMode:"noStale",...t.query})}const d=yN(s,Object.assign({},t,{url:p0(n,r,a)})),u=new vt(h=>e(d,s.requester).subscribe(h));return t.signal?u.pipe(LN(t.signal)):u}function $t(n,e,t){return wo(n,e,t).pipe(Xi(r=>r.type==="response"),zt(r=>r.body))}function Ir(n,e,t){const r=n.config();if(r["~experimental_resource"]){uE(r);const a=DN(r),l=t!==void 0?`${e}/${t}`:e;return`${a}/${l}`.replace(/\/($|\?)/,"$1")}const s=zs(r),i=`/${e}/${s}`;return`/data${t!==void 0?`${i}/${t}`:i}`.replace(/\/($|\?)/,"$1")}function p0(n,e,t=!1){const{url:r,cdnUrl:s}=n.config();return`${t?s:r}/${e.replace(/^\//,"")}`}function LN(n){return e=>new vt(t=>{const r=()=>t.error(NN(n));if(n&&n.aborted){r();return}const s=e.subscribe(t);return n.addEventListener("abort",r),()=>{n.removeEventListener("abort",r),s.unsubscribe()}})}const RN=!!globalThis.DOMException;function NN(n){if(RN)return new DOMException(n?.reason??"The operation was aborted.","AbortError");const e=new Error(n?.reason??"The operation was aborted.");return e.name="AbortError",e}const DN=n=>{if(!n["~experimental_resource"])throw new Error("`resource` must be provided to perform resource queries");const{type:e,id:t}=n["~experimental_resource"];switch(e){case"dataset":{const r=t.split(".");if(r.length!==2)throw new Error('Dataset ID must be in the format "project.dataset"');return`/projects/${r[0]}/datasets/${r[1]}`}case"canvas":return`/canvases/${t}`;case"media-library":return`/media-libraries/${t}`;case"dashboard":return`/dashboards/${t}`;default:throw new Error(`Unsupported resource type: ${e.toString()}`)}};function DE(n,e,t){const r=zs(n.config());return $t(n,e,{method:"POST",uri:`/agent/action/generate/${r}`,body:t})}function PN(n,e,t){const r=zs(n.config());return $t(n,e,{method:"POST",uri:`/agent/action/patch/${r}`,body:t})}function ON(n,e,t){const r=zs(n.config());return $t(n,e,{method:"POST",uri:`/agent/action/prompt/${r}`,body:t})}function PE(n,e,t){const r=zs(n.config());return $t(n,e,{method:"POST",uri:`/agent/action/transform/${r}`,body:t})}function OE(n,e,t){const r=zs(n.config());return $t(n,e,{method:"POST",uri:`/agent/action/translate/${r}`,body:t})}class jN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}generate(e){return DE(this.#t,this.#e,e)}transform(e){return PE(this.#t,this.#e,e)}translate(e){return OE(this.#t,this.#e,e)}}class MN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}generate(e){return $e(DE(this.#t,this.#e,e))}transform(e){return $e(PE(this.#t,this.#e,e))}translate(e){return $e(OE(this.#t,this.#e,e))}prompt(e){return $e(ON(this.#t,this.#e,e))}patch(e){return $e(PN(this.#t,this.#e,e))}}class FN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}upload(e,t,r){return jE(this.#t,this.#e,e,t,r)}}class UN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}upload(e,t,r){const s=jE(this.#t,this.#e,e,t,r);return $e(s.pipe(Xi(i=>i.type==="response"),zt(i=>i.body.document)))}}function jE(n,e,t,r,s={}){W4(t);let i=s.extract||void 0;i&&!i.length&&(i=["none"]);const a=n.config(),l=$N(s,r),{tag:d,label:u,title:h,description:p,creditLine:g,filename:x,source:y}=l,E={label:u,title:h,description:p,filename:x,meta:i,creditLine:g};return y&&(E.sourceId=y.id,E.sourceName=y.name,E.sourceUrl=y.url),wo(n,e,{tag:d,method:"POST",timeout:l.timeout||0,uri:BN(a,t),headers:l.contentType?{"Content-Type":l.contentType}:{},query:E,body:r})}function BN(n,e){const t=e==="image"?"images":"files";if(n["~experimental_resource"]){const{type:s,id:i}=n["~experimental_resource"];switch(s){case"dataset":throw new Error("Assets are not supported for dataset resources, yet. Configure the client with `{projectId: <projectId>, dataset: <datasetId>}` instead.");case"canvas":return`/canvases/${i}/assets/${t}`;case"media-library":return`/media-libraries/${i}/upload`;case"dashboard":return`/dashboards/${i}/assets/${t}`;default:throw new Error(`Unsupported resource type: ${s.toString()}`)}}const r=zs(n);return`assets/${t}/${r}`}function $N(n,e){return typeof File>"u"||!(e instanceof File)?n:Object.assign({filename:n.preserveFilename===!1?void 0:e.name,contentType:e.type},n)}var VN=(n,e)=>Object.keys(e).concat(Object.keys(n)).reduce((t,r)=>(t[r]=typeof n[r]>"u"?e[r]:n[r],t),{});const GN=(n,e)=>e.reduce((t,r)=>(typeof n[r]>"u"||(t[r]=n[r]),t),{}),ME=W2(()=>E2(()=>import("./browser-JTzxfn89.js").then(n=>n.b),[])).pipe(zt(({default:n})=>n),S4(1));function FE(){return function(n){return n.pipe(Lc((e,t)=>e instanceof hE?x4(ji({type:"reconnect"}),v4(1e3).pipe($s(()=>t))):q2(()=>e)))}}const HN=14800,qN=["includePreviousRevision","includeResult","includeMutations","includeAllVersions","visibility","effectFormat","tag"],KN={includeResult:!0};function UE(n,e,t={}){const{url:r,token:s,withCredentials:i,requestTagPrefix:a,headers:l}=this.config(),d=t.tag&&a?[a,t.tag].join("."):t.tag,u={...VN(t,KN),tag:d},h=GN(u,qN),p=yE({query:n,params:e,options:{tag:d,...h}}),g=`${r}${Ir(this,"listen",p)}`;if(g.length>HN)return q2(()=>new Error("Query too large for listener"));const x=u.events?u.events:["mutation"],y={};return i&&(y.withCredentials=!0),(s||l)&&(y.headers={},s&&(y.headers.Authorization=`Bearer ${s}`),l&&Object.assign(y.headers,l)),mE(()=>(typeof EventSource>"u"||y.headers?ME:ji(EventSource)).pipe(zt(E=>new E(g,y))),x).pipe(FE(),Xi(E=>x.includes(E.type)),zt(E=>({type:E.type,..."data"in E?E.data:{}})))}function zN(n,e){return WN(typeof n=="function"?{predicate:n,...e}:n)}function WN(n){return e=>{let t,r=!1;const{predicate:s,...i}=n,a=e.pipe(T4(d=>{n.predicate(d)&&(r=!0,t=d)}),Q2(()=>{r=!1,t=void 0}),X2(i)),l=new vt(d=>{r&&d.next(t),d.complete()});return y4(a,l)}}const wv="2021-03-25";class BE{#t;constructor(e){this.#t=e}events({includeDrafts:e=!1,tag:t}={}){Fs("live",this.#t.config());const{projectId:r,apiVersion:s,token:i,withCredentials:a,requestTagPrefix:l,headers:d}=this.#t.config(),u=s.replace(/^v/,"");if(u!=="X"&&u<wv)throw new Error(`The live events API requires API version ${wv} or later. The current API version is ${u}. Please update your API version to use this feature.`);if(e&&!i&&!a)throw new Error("The live events API requires a token or withCredentials when 'includeDrafts: true'. Please update your client configuration. The token should have the lowest possible access role.");const h=Ir(this.#t,"live/events"),p=new URL(this.#t.getUrl(h,!1)),g=t&&l?[l,t].join("."):t;g&&p.searchParams.set("tag",g),e&&p.searchParams.set("includeDrafts","true");const x={};e&&a&&(x.withCredentials=!0),(e&&i||d)&&(x.headers={},e&&i&&(x.headers.Authorization=`Bearer ${i}`),d&&Object.assign(x.headers,d));const y=`${p.href}::${JSON.stringify(x)}`,E=jf.get(y);if(E)return E;const w=mE(()=>(typeof EventSource>"u"||x.headers?ME:ji(EventSource)).pipe(zt(k=>new k(p.href,x))),["message","restart","welcome","reconnect","goaway"]),S=YN(p,{method:"OPTIONS",mode:"cors",credentials:x.withCredentials?"include":"omit",headers:x.headers}).pipe(Lc(()=>{throw new V4({projectId:r})})),T=w.pipe(FE(),$s(k=>k.type==="reconnect"?S.pipe($s(()=>ji(k))):ji(k)),Lc(k=>S.pipe($s(()=>{throw k}))),zt(k=>{if(k.type==="message"){const{data:I,...L}=k;return{...L,tags:I.tags}}return k})).pipe(Q2(()=>jf.delete(y)),zN({predicate:k=>k.type==="welcome"}));return jf.set(y,T),T}}function YN(n,e){return new vt(t=>{const r=new AbortController,s=r.signal;return fetch(n,{...e,signal:r.signal}).then(i=>{t.next(i),t.complete()},i=>{s.aborted||t.error(i)}),()=>r.abort()})}const jf=new Map;class QN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}create(e,t){return Mi(this.#t,this.#e,"PUT",e,t)}edit(e,t){return Mi(this.#t,this.#e,"PATCH",e,t)}delete(e){return Mi(this.#t,this.#e,"DELETE",e)}list(){Fs("dataset",this.#t.config());const e=this.#t.config(),t=e.projectId;let r="/datasets";return e.useProjectHostname===!1&&(r=`/projects/${t}/datasets`),$t(this.#t,this.#e,{uri:r,tag:null})}}class XN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}create(e,t){return Fs("dataset",this.#t.config()),$e(Mi(this.#t,this.#e,"PUT",e,t))}edit(e,t){return Fs("dataset",this.#t.config()),$e(Mi(this.#t,this.#e,"PATCH",e,t))}delete(e){return Fs("dataset",this.#t.config()),$e(Mi(this.#t,this.#e,"DELETE",e))}list(){Fs("dataset",this.#t.config());const e=this.#t.config(),t=e.projectId;let r="/datasets";return e.useProjectHostname===!1&&(r=`/projects/${t}/datasets`),$e($t(this.#t,this.#e,{uri:r,tag:null}))}}function Mi(n,e,t,r,s){return Fs("dataset",n.config()),oE(r),$t(n,e,{method:t,uri:`/datasets/${r}`,body:s,tag:null})}class $E{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getPlaybackInfo(e,t={}){const r=this.#t.config()["~experimental_resource"]?.id,{instanceId:s,libraryId:i}=t8(e),a=i||r;if(!a)throw new Error("Could not determine Media Library ID - you need to provide a valid Media Library ID in the client config or a Media Library GDR");const l=r8(s,a),d=n8(t);return $t(this.#t,this.#e,{method:"GET",uri:l,query:d})}}class ZN{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getPlaybackInfo(e,t={}){return $e(new $E(this.#t.observable,this.#e).getPlaybackInfo(e,t))}}const JN=/^media-library:(ml[^:]+):([^:]+)$/;function e8(n){return typeof n=="object"&&"_ref"in n}function t8(n){const e=e8(n)?n._ref:n,t=JN.exec(e);if(t){const[,r,s]=t;return{libraryId:r,instanceId:s}}if(typeof n=="string"&&n.startsWith("video-"))return{instanceId:n};throw new Error(`Invalid video asset instance identifier "${e}": must be a valid video instance id or a Global Dataset Reference (GDR) to the video asset in the Media Library`)}function r8(n,e){return`/media-libraries/${e}/video/${n}/playback-info`}function n8(n){const e={};if(n.transformations){const{thumbnail:t,animated:r,storyboard:s}=n.transformations;t&&(t.width&&(e.thumbnailWidth=t.width),t.height&&(e.thumbnailHeight=t.height),t.time!==void 0&&(e.thumbnailTime=t.time),t.fit&&(e.thumbnailFit=t.fit),t.format&&(e.thumbnailFormat=t.format)),r&&(r.width&&(e.animatedWidth=r.width),r.height&&(e.animatedHeight=r.height),r.start!==void 0&&(e.animatedStart=r.start),r.end!==void 0&&(e.animatedEnd=r.end),r.fps&&(e.animatedFps=r.fps),r.format&&(e.animatedFormat=r.format)),s&&s.format&&(e.storyboardFormat=s.format)}return n.expiration&&(e.expiration=n.expiration),e}class s8{#t;#e;constructor(e,t){this.#t=e,this.#e=t}list(e){const t={},r="/projects";return e?.includeMembers===!1&&(t.includeMembers="false"),e?.organizationId&&(t.organizationId=e.organizationId),$t(this.#t,this.#e,{uri:r,query:t})}getById(e){return $t(this.#t,this.#e,{uri:`/projects/${e}`})}}class i8{#t;#e;constructor(e,t){this.#t=e,this.#e=t}list(e){const t={},r="/projects";return e?.includeMembers===!1&&(t.includeMembers="false"),e?.organizationId&&(t.organizationId=e.organizationId),$e($t(this.#t,this.#e,{uri:r,query:t}))}getById(e){return $e($t(this.#t,this.#e,{uri:`/projects/${e}`}))}}const bv=D4("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",8),Dc=(n,e)=>e?yo(n,e):rE(n);function Pc(n,{releaseId:e,publishedId:t,document:r}){if(t&&r._id){const s=Dc(t,e);return Q4(s,r),s}if(r._id){const s=Wc(r._id),i=Yc(r._id);if(!s&&!i)throw new Error(`\`${n}()\` requires a document with an \`_id\` that is a version or draft ID`);if(e){if(s)throw new Error(`\`${n}()\` was called with a document ID (\`${r._id}\`) that is a draft ID, but a release ID (\`${e}\`) was also provided.`);const a=nE(r._id);if(a!==e)throw new Error(`\`${n}()\` was called with a document ID (\`${r._id}\`) that is a version ID, but the release ID (\`${e}\`) does not match the document's version ID (\`${a}\`).`)}return r._id}if(t)return Dc(t,e);throw new Error(`\`${n}()\` requires either a publishedId or a document with an \`_id\``)}const a8=(n,e)=>{if(typeof n=="object"&&n!==null&&("releaseId"in n||"metadata"in n)){const{releaseId:t=bv(),metadata:r={}}=n;return[t,r,e]}return[bv(),{},n]},VE=(n,e)=>{const[t,r,s]=a8(n,e),i={...r,releaseType:r.releaseType||"undecided"};return{action:{actionType:"sanity.action.release.create",releaseId:t,metadata:i},options:s}};class o8{#t;#e;constructor(e,t){this.#t=e,this.#e=t}get({releaseId:e},t){return zi(this.#t,this.#e,`_.releases.${e}`,t)}create(e,t){const{action:r,options:s}=VE(e,t),{releaseId:i,metadata:a}=r;return ft(this.#t,this.#e,r,s).pipe(zt(l=>({...l,releaseId:i,metadata:a})))}edit({releaseId:e,patch:t},r){const s={actionType:"sanity.action.release.edit",releaseId:e,patch:t};return ft(this.#t,this.#e,s,r)}publish({releaseId:e},t){const r={actionType:"sanity.action.release.publish",releaseId:e};return ft(this.#t,this.#e,r,t)}archive({releaseId:e},t){const r={actionType:"sanity.action.release.archive",releaseId:e};return ft(this.#t,this.#e,r,t)}unarchive({releaseId:e},t){const r={actionType:"sanity.action.release.unarchive",releaseId:e};return ft(this.#t,this.#e,r,t)}schedule({releaseId:e,publishAt:t},r){const s={actionType:"sanity.action.release.schedule",releaseId:e,publishAt:t};return ft(this.#t,this.#e,s,r)}unschedule({releaseId:e},t){const r={actionType:"sanity.action.release.unschedule",releaseId:e};return ft(this.#t,this.#e,r,t)}delete({releaseId:e},t){const r={actionType:"sanity.action.release.delete",releaseId:e};return ft(this.#t,this.#e,r,t)}fetchDocuments({releaseId:e},t){return bE(this.#t,this.#e,e,t)}}class l8{#t;#e;constructor(e,t){this.#t=e,this.#e=t}get({releaseId:e},t){return $e(zi(this.#t,this.#e,`_.releases.${e}`,t))}async create(e,t){const{action:r,options:s}=VE(e,t),{releaseId:i,metadata:a}=r;return{...await $e(ft(this.#t,this.#e,r,s)),releaseId:i,metadata:a}}edit({releaseId:e,patch:t},r){const s={actionType:"sanity.action.release.edit",releaseId:e,patch:t};return $e(ft(this.#t,this.#e,s,r))}publish({releaseId:e},t){const r={actionType:"sanity.action.release.publish",releaseId:e};return $e(ft(this.#t,this.#e,r,t))}archive({releaseId:e},t){const r={actionType:"sanity.action.release.archive",releaseId:e};return $e(ft(this.#t,this.#e,r,t))}unarchive({releaseId:e},t){const r={actionType:"sanity.action.release.unarchive",releaseId:e};return $e(ft(this.#t,this.#e,r,t))}schedule({releaseId:e,publishAt:t},r){const s={actionType:"sanity.action.release.schedule",releaseId:e,publishAt:t};return $e(ft(this.#t,this.#e,s,r))}unschedule({releaseId:e},t){const r={actionType:"sanity.action.release.unschedule",releaseId:e};return $e(ft(this.#t,this.#e,r,t))}delete({releaseId:e},t){const r={actionType:"sanity.action.release.delete",releaseId:e};return $e(ft(this.#t,this.#e,r,t))}fetchDocuments({releaseId:e},t){return $e(bE(this.#t,this.#e,e,t))}}class c8{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getById(e){return $t(this.#t,this.#e,{uri:`/users/${e}`})}}class u8{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getById(e){return $e($t(this.#t,this.#e,{uri:`/users/${e}`}))}}class Oc{assets;datasets;live;mediaLibrary;projects;users;agent;releases;#t;#e;listen=UE;constructor(e,t=Xa){this.config(t),this.#e=e,this.assets=new FN(this,this.#e),this.datasets=new QN(this,this.#e),this.live=new BE(this),this.mediaLibrary={video:new $E(this,this.#e)},this.projects=new s8(this,this.#e),this.users=new c8(this,this.#e),this.agent={action:new jN(this,this.#e)},this.releases=new o8(this,this.#e)}clone(){return new Oc(this.#e,this.config())}config(e){if(e===void 0)return{...this.#t};if(this.#t&&this.#t.allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.#t=fE(e,this.#t||{}),this}withConfig(e){const t=this.config();return new Oc(this.#e,{...t,...e,stega:{...t.stega||{},...typeof e?.stega=="boolean"?{enabled:e.stega}:e?.stega||{}}})}fetch(e,t,r){return EE(this,this.#e,this.#t.stega,e,t,r)}getDocument(e,t){if(t?.includeAllVersions===!0)return zi(this,this.#e,e,{...t,includeAllVersions:!0});const r={signal:t?.signal,tag:t?.tag,releaseId:t?.releaseId,...t&&"includeAllVersions"in t?{includeAllVersions:!1}:{}};return zi(this,this.#e,e,r)}getDocuments(e,t){return wE(this,this.#e,e,t)}create(e,t){return Jc(this,this.#e,e,"create",t)}createIfNotExists(e,t){return SE(this,this.#e,e,t)}createOrReplace(e,t){return TE(this,this.#e,e,t)}createVersion({document:e,publishedId:t,releaseId:r,baseId:s,ifBaseRevisionId:i},a){if(!e)return kE(this,this.#e,t,s,r,i,a);const l=Pc("createVersion",{document:e,publishedId:t,releaseId:r}),d={...e,_id:l},u=t||Qc(e._id);return _E(this,this.#e,d,u,a)}delete(e,t){return CE(this,this.#e,e,t)}discardVersion({releaseId:e,publishedId:t},r,s){const i=Dc(t,e);return IE(this,this.#e,i,r,s)}replaceVersion({document:e,publishedId:t,releaseId:r},s){const i=Pc("replaceVersion",{document:e,publishedId:t,releaseId:r}),a={...e,_id:i};return AE(this,this.#e,a,s)}unpublishVersion({releaseId:e,publishedId:t},r){const s=yo(t,e);return LE(this,this.#e,s,t,r)}mutate(e,t){return RE(this,this.#e,e,t)}patch(e,t){return new Vs(e,t,this)}transaction(e){return new Zc(e,this)}action(e,t){return ft(this,this.#e,e,t)}request(e){return $t(this,this.#e,e)}getUrl(e,t){return p0(this,e,t)}getDataUrl(e,t){return Ir(this,e,t)}}class jc{assets;datasets;live;mediaLibrary;projects;users;agent;releases;observable;#t;#e;listen=UE;constructor(e,t=Xa){this.config(t),this.#e=e,this.assets=new UN(this,this.#e),this.datasets=new XN(this,this.#e),this.live=new BE(this),this.mediaLibrary={video:new ZN(this,this.#e)},this.projects=new i8(this,this.#e),this.users=new u8(this,this.#e),this.agent={action:new MN(this,this.#e)},this.releases=new l8(this,this.#e),this.observable=new Oc(e,t)}clone(){return new jc(this.#e,this.config())}config(e){if(e===void 0)return{...this.#t};if(this.#t&&this.#t.allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.observable&&this.observable.config(e),this.#t=fE(e,this.#t||{}),this}withConfig(e){const t=this.config();return new jc(this.#e,{...t,...e,stega:{...t.stega||{},...typeof e?.stega=="boolean"?{enabled:e.stega}:e?.stega||{}}})}fetch(e,t,r){return $e(EE(this,this.#e,this.#t.stega,e,t,r))}getDocument(e,t){if(t?.includeAllVersions===!0)return $e(zi(this,this.#e,e,{...t,includeAllVersions:!0}));const r={signal:t?.signal,tag:t?.tag,releaseId:t?.releaseId,...t&&"includeAllVersions"in t?{includeAllVersions:!1}:{}};return $e(zi(this,this.#e,e,r))}getDocuments(e,t){return $e(wE(this,this.#e,e,t))}create(e,t){return $e(Jc(this,this.#e,e,"create",t))}createIfNotExists(e,t){return $e(SE(this,this.#e,e,t))}createOrReplace(e,t){return $e(TE(this,this.#e,e,t))}createVersion({document:e,publishedId:t,releaseId:r,baseId:s,ifBaseRevisionId:i},a){if(!e)return Nf(kE(this,this.#e,t,s,r,i,a));const l=Pc("createVersion",{document:e,publishedId:t,releaseId:r}),d={...e,_id:l},u=t||Qc(e._id);return Nf(_E(this,this.#e,d,u,a))}delete(e,t){return $e(CE(this,this.#e,e,t))}discardVersion({releaseId:e,publishedId:t},r,s){const i=Dc(t,e);return $e(IE(this,this.#e,i,r,s))}replaceVersion({document:e,publishedId:t,releaseId:r},s){const i=Pc("replaceVersion",{document:e,publishedId:t,releaseId:r}),a={...e,_id:i};return Nf(AE(this,this.#e,a,s))}unpublishVersion({releaseId:e,publishedId:t},r){const s=yo(t,e);return $e(LE(this,this.#e,s,t,r))}mutate(e,t){return $e(RE(this,this.#e,e,t))}patch(e,t){return new cs(e,t,this)}transaction(e){return new Xc(e,this)}action(e,t){return $e(ft(this,this.#e,e,t))}request(e){return $e($t(this,this.#e,e))}dataRequest(e,t,r){return $e(Ws(this,this.#e,e,t,r))}getUrl(e,t){return p0(this,e,t)}getDataUrl(e,t){return Ir(this,e,t)}}function d8(n,e){return{requester:gv(n),createClient:t=>{const r=gv(n,{ignoreWarnings:t.ignoreWarnings});return new e((s,i)=>(i||r)({maxRedirects:0,maxRetries:t.maxRetries,retryDelay:t.retryDelay,lineage:t.lineage,...s}),t)}}}var f8=[];const h8=d8(f8,jc),m8=h8.createClient,Sv="image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg";function p8(n){const[,e,t,r]=n.split("-");if(!e||!t||!r)throw new Error(`Malformed asset _ref '${n}'. Expected an id like "${Sv}".`);const[s,i]=t.split("x"),a=+s,l=+i;if(!(isFinite(a)&&isFinite(l)))throw new Error(`Malformed asset _ref '${n}'. Expected an id like "${Sv}".`);return{id:e,width:a,height:l,format:r}}const g8=n=>{const e=n;return e?typeof e._ref=="string":!1},x8=n=>{const e=n;return e?typeof e._id=="string":!1},v8=n=>{const e=n;return e&&e.asset?typeof e.asset.url=="string":!1},y8=n=>{if(typeof n=="object"&&n!==null){const e=n;return e._upload&&(!e.asset||!e.asset._ref)}return!1};function E8(n){if(!n)return null;let e;if(typeof n=="string"&&w8(n))e={asset:{_ref:Tv(n)}};else if(typeof n=="string")e={asset:{_ref:n}};else if(g8(n))e={asset:n};else if(x8(n))e={asset:{_ref:n._id||""}};else if(v8(n))e={asset:{_ref:Tv(n.asset.url)}};else if(typeof n.asset=="object")e={...n};else return null;const t=n;return t.crop&&(e.crop=t.crop),t.hotspot&&(e.hotspot=t.hotspot),b8(e)}function w8(n){return/^https?:\/\//.test(`${n}`)}function Tv(n){return`image-${n.split("/").slice(-1)[0]}`.replace(/\.([a-z]+)$/,"-$1")}function b8(n){if(n.crop&&n.hotspot)return n;const e={...n};return e.crop||(e.crop={left:0,top:0,bottom:0,right:0}),e.hotspot||(e.hotspot={x:.5,y:.5,height:1,width:1}),e}const GE=[["width","w"],["height","h"],["format","fm"],["download","dl"],["blur","blur"],["sharpen","sharp"],["invert","invert"],["orientation","or"],["minHeight","min-h"],["maxHeight","max-h"],["minWidth","min-w"],["maxWidth","max-w"],["quality","q"],["fit","fit"],["crop","crop"],["saturation","sat"],["auto","auto"],["dpr","dpr"],["pad","pad"],["frame","frame"]];function S8(n){let e={...n||{}};const t=e.source;delete e.source;const r=E8(t);if(!r){if(t&&y8(t))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8HwQACfsD/QNViZkAAAAASUVORK5CYII=";throw new Error(`Unable to resolve image URL from source (${JSON.stringify(t)})`)}const s=r.asset._ref||r.asset._id||"",i=p8(s),a=Math.round(r.crop.left*i.width),l=Math.round(r.crop.top*i.height),d={left:a,top:l,width:Math.round(i.width-r.crop.right*i.width-a),height:Math.round(i.height-r.crop.bottom*i.height-l)},u=r.hotspot.height*i.height/2,h=r.hotspot.width*i.width/2,p=r.hotspot.x*i.width,g=r.hotspot.y*i.height,x={left:p-h,top:g-u,right:p+h,bottom:g+u};return e.rect||e.focalPoint||e.ignoreImageParams||e.crop||(e={...e,..._8({crop:d,hotspot:x},e)}),T8({...e,asset:i})}function T8(n){const e=(n.baseUrl||"https://cdn.sanity.io").replace(/\/+$/,""),t=n.vanityName?`/${n.vanityName}`:"",r=`${n.asset.id}-${n.asset.width}x${n.asset.height}.${n.asset.format}${t}`,s=n.mediaLibraryId?`${e}/media-libraries/${n.mediaLibraryId}/images/${r}`:`${e}/images/${n.projectId}/${n.dataset}/${r}`,i=[];if(n.rect){const{left:l,top:d,width:u,height:h}=n.rect;(l!==0||d!==0||h!==n.asset.height||u!==n.asset.width)&&i.push(`rect=${l},${d},${u},${h}`)}n.bg&&i.push(`bg=${n.bg}`),n.focalPoint&&(i.push(`fp-x=${n.focalPoint.x}`),i.push(`fp-y=${n.focalPoint.y}`));const a=[n.flipHorizontal&&"h",n.flipVertical&&"v"].filter(Boolean).join("");return a&&i.push(`flip=${a}`),GE.forEach(l=>{const[d,u]=l;typeof n[d]<"u"?i.push(`${u}=${encodeURIComponent(n[d])}`):typeof n[u]<"u"&&i.push(`${u}=${encodeURIComponent(n[u])}`)}),i.length===0?s:`${s}?${i.join("&")}`}function _8(n,e){let t;const r=e.width,s=e.height;if(!(r&&s))return{width:r,height:s,rect:n.crop};const i=n.crop,a=n.hotspot,l=r/s;if(i.width/i.height>l){const d=Math.round(i.height),u=Math.round(d*l),h=Math.max(0,Math.round(i.top)),p=Math.round((a.right-a.left)/2+a.left);let g=Math.max(0,Math.round(p-u/2));g<i.left?g=i.left:g+u>i.left+i.width&&(g=i.left+i.width-u),t={left:g,top:h,width:u,height:d}}else{const d=i.width,u=Math.round(d/l),h=Math.max(0,Math.round(i.left)),p=Math.round((a.bottom-a.top)/2+a.top);let g=Math.max(0,Math.round(p-u/2));g<i.top?g=i.top:g+u>i.top+i.height&&(g=i.top+i.height-u),t={left:h,top:g,width:d,height:u}}return{width:r,height:s,rect:t}}const k8=["clip","crop","fill","fillmax","max","scale","min"],C8=["top","bottom","left","right","center","focalpoint","entropy"],I8=["format"];function A8(n){return n&&"config"in n?typeof n.config=="function":!1}function L8(n){return n&&"clientConfig"in n?typeof n.clientConfig=="object":!1}function _v(n){const{apiHost:e,projectId:t,dataset:r}=n,s={baseUrl:(e||"https://api.sanity.io").replace(/^https:\/\/api\./,"https://cdn.")},i=n["~experimental_resource"];if(i?.type==="media-library"){if(typeof i.id!="string"||i.id.length===0)throw new Error('Media library clients must include an id in "~experimental_resource"');return{...s,mediaLibraryId:i.id}}return{...s,projectId:t,dataset:r}}function R8(n){const e=GE;for(const t of e){const[r,s]=t;if(n===r||n===s)return r}return n}function HE(n){let e={};return A8(n)?e=_v(n.config()):L8(n)?e=_v(n.clientConfig):e=n||{},e}function N8(n,e){const t=HE(e);return new n(null,t)}function D8(n){return N8(Mc,n)}function P8(n,e){const t=e.baseUrl||n.baseUrl,r={baseUrl:t};for(const s in e)if(e.hasOwnProperty(s)){const i=R8(s);r[i]=e[s]}return{baseUrl:t,...r}}class Mc{options;constructor(e,t){this.options=e?{...e.options||{},...t||{}}:{...t||{}}}withOptions(e){const t=P8(this.options,e);return new Mc(this,t)}image(e){return this.withOptions({source:e})}dataset(e){return this.withOptions({dataset:e})}projectId(e){return this.withOptions({projectId:e})}withClient(e){const t=HE(e),r={...this.options};return delete r.baseUrl,delete r.projectId,delete r.dataset,delete r.mediaLibraryId,new Mc(null,{...t,...r})}bg(e){return this.withOptions({bg:e})}dpr(e){return this.withOptions(e&&e!==1?{dpr:e}:{})}width(e){return this.withOptions({width:e})}height(e){return this.withOptions({height:e})}focalPoint(e,t){return this.withOptions({focalPoint:{x:e,y:t}})}maxWidth(e){return this.withOptions({maxWidth:e})}minWidth(e){return this.withOptions({minWidth:e})}maxHeight(e){return this.withOptions({maxHeight:e})}minHeight(e){return this.withOptions({minHeight:e})}size(e,t){return this.withOptions({width:e,height:t})}blur(e){return this.withOptions({blur:e})}sharpen(e){return this.withOptions({sharpen:e})}rect(e,t,r,s){return this.withOptions({rect:{left:e,top:t,width:r,height:s}})}format(e){return this.withOptions({format:e})}invert(e){return this.withOptions({invert:e})}orientation(e){return this.withOptions({orientation:e})}quality(e){return this.withOptions({quality:e})}forceDownload(e){return this.withOptions({download:e})}flipHorizontal(){return this.withOptions({flipHorizontal:!0})}flipVertical(){return this.withOptions({flipVertical:!0})}ignoreImageParams(){return this.withOptions({ignoreImageParams:!0})}fit(e){if(k8.indexOf(e)===-1)throw new Error(`Invalid fit mode "${e}"`);return this.withOptions({fit:e})}crop(e){if(C8.indexOf(e)===-1)throw new Error(`Invalid crop mode "${e}"`);return this.withOptions({crop:e})}saturation(e){return this.withOptions({saturation:e})}auto(e){if(I8.indexOf(e)===-1)throw new Error(`Invalid auto mode "${e}"`);return this.withOptions({auto:e})}pad(e){return this.withOptions({pad:e})}vanityName(e){return this.withOptions({vanityName:e})}frame(e){if(e!==1)throw new Error(`Invalid frame value "${e}"`);return this.withOptions({frame:e})}url(){return S8(this.options)}toString(){return this.url()}}function O8(n){let e=!1,t;return(...r)=>(e||(t=n(...r),e=!0),t)}const j8=n=>O8((...e)=>{console.warn(n.join(" "),...e)}),M8=j8(["The default export of @sanity/image-url has been deprecated. Use the named export `createImageUrlBuilder` instead."]);function F8(n){return function(e){return M8(),n(e)}}const U8=F8(D8),xt=m8({projectId:"am3v0x1c",dataset:"production",apiVersion:"2026-01-06",useCdn:!1}),B8=U8(xt);function at(n){return B8.image(n)}const $8=`
  *[_type == "project"] | order(order asc) {
    _id,
    title,
    "slug": slug.current,
    company,
    year,
    shortDescription,
    logo,
    heroImage,
    heroVideo,
    isPublished
  }
`,qE=`
  *[_type == "artPiece" && isPublished == true] | order(year desc, order asc) {
    _id,
    title,
    artType,
    image,
    medium,
    size,
    year,
    description
  }
`,KE=`
  *[_type == "sketchbook" && isPublished == true] | order(order asc) {
    _id,
    title,
    sidebarLabel,
    date,
    description,
    images[] {
      _key,
      asset,
      caption
    }
  }
`,zE=`
  *[_type == "mural" && isPublished == true] | order(order asc) {
    _id,
    title,
    sidebarLabel,
    location,
    date,
    description,
    images[] {
      _key,
      asset,
      caption
    }
  }
`,WE=`
  *[_type == "project" && company == $company][0] {
    _id,
    title,
    "slug": slug.current,
    company,
    year,
    shortDescription,
    logo,
    heroImage,
    heroVideo,
    metadata[] {
      _key,
      label,
      value,
      subValue
    },
    content[] {
      _key,
      _type,
      ...
    },
    relatedProjects[]-> {
      _id,
      title,
      "slug": slug.current,
      company,
      year,
      shortDescription,
      heroImage
    }
  }
`,YE=`
  *[_type == "experience" && isPublished == true] | order(order asc) {
    _id,
    company,
    role,
    logo,
    period,
    description
  }
`,QE=`
  *[_type == "community" && isPublished == true] | order(order asc) {
    _id,
    title,
    sidebarName,
    logo,
    description,
    instagramUrl,
    photos[] {
      _key,
      image,
      caption,
      rotation,
      orientation,
      yOffset,
      xOffset
    }
  }
`,XE=`
  *[_type == "shelfItem" && isPublished == true] | order(isFeatured desc, order asc) {
    _id,
    title,
    mediaType,
    cover,
    externalCoverUrl,
    author,
    year,
    rating,
    isFeatured,
    goodreadsUrl,
    letterboxdSlug,
    spotifyUrl
  }
`,ZE=`
  *[_type == "loreItem" && isPublished == true] | order(order asc) {
    _id,
    headline,
    image,
    imageBackground,
    date,
    description,
    link,
    fullStory
  }
`,JE=`
  *[_type == "aboutQuote" && isPublished == true] | order(order asc) {
    _id,
    emoji,
    title,
    text,
    underlinedText,
    author
  }
`,V8=`
  *[_type == "shelfItem" && isPublished == true && mediaType == "book"] | order(isLibraryFavorite desc, year desc, order asc) {
    _id,
    title,
    author,
    cover,
    externalCoverUrl,
    rating,
    year,
    isLibraryFavorite,
    goodreadsUrl,
    review,
    dateRead
  }
`,G8=`
  array::unique(*[_type == "shelfItem" && isPublished == true && mediaType == "book" && year != null].year) | order(@ desc)
`,ew=new Map,H8=300*1e3;let Mf=!1;function nt(n){const e=ew.get(n);return e&&Date.now()-e.timestamp<H8?e.data:null}function kn(n,e){ew.set(n,{data:e,timestamp:Date.now()})}async function Zl(n){const e=`project:${n}`;if(!nt(e))try{const t=await xt.fetch(WE,{company:n});t&&kn(e,t)}catch(t){console.warn(`Failed to preload project ${n}:`,t)}}async function q8(){const n="art:pieces",e="art:sketchbooks",t="art:murals";if(!(nt(n)&&nt(e)&&nt(t)))try{const[r,s,i]=await Promise.all([nt(n)?Promise.resolve(null):xt.fetch(qE),nt(e)?Promise.resolve(null):xt.fetch(KE),nt(t)?Promise.resolve(null):xt.fetch(zE)]);r&&kn(n,r),s&&kn(e,s),i&&kn(t,i)}catch(r){console.warn("Failed to preload art page:",r)}}async function K8(){const n={experiences:"about:experiences",communities:"about:communities",shelfItems:"about:shelfItems",quotes:"about:quotes",loreItems:"about:loreItems"};if(!(nt(n.experiences)&&nt(n.communities)&&nt(n.shelfItems)&&nt(n.quotes)&&nt(n.loreItems)))try{const[e,t,r,s,i]=await Promise.all([nt(n.experiences)?Promise.resolve(null):xt.fetch(YE),nt(n.communities)?Promise.resolve(null):xt.fetch(QE),nt(n.shelfItems)?Promise.resolve(null):xt.fetch(XE),nt(n.quotes)?Promise.resolve(null):xt.fetch(JE),nt(n.loreItems)?Promise.resolve(null):xt.fetch(ZE)]);e&&kn(n.experiences,e),t&&kn(n.communities,t),r&&kn(n.shelfItems,r),s&&kn(n.quotes,s),i&&kn(n.loreItems,i)}catch(e){console.warn("Failed to preload about page:",e)}}function z8(){if(Mf)return;Mf=!0;const n=async()=>{await Promise.all([Zl("apple"),Zl("roblox"),Zl("adobe"),Zl("nasa"),q8(),K8()]),Mf=!1};"requestIdleCallback"in window?requestIdleCallback(()=>n(),{timeout:3e3}):setTimeout(n,1e3)}function W8({card:n}){return f.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-6 py-12",children:[f.jsxs("div",{className:"flex flex-col gap-3",children:[n.label&&f.jsx("p",{className:"text-[#9ca3af] text-sm font-normal tracking-wide uppercase",children:n.label}),f.jsxs("p",{className:"text-xl font-normal text-[#111827]",children:[n.emoji&&f.jsx("span",{className:"mr-2",children:n.emoji}),n.title]})]}),n.image&&f.jsx("div",{className:"relative flex-shrink-0 w-full md:w-[340px] lg:w-[390px] rounded-[26px] overflow-hidden",children:f.jsx("img",{src:at(n.image).width(780).url(),alt:n.title,className:"w-full h-auto object-cover rounded-[26px]"})})]})}function Y8({cards:n}){return!n||n.length===0?null:f.jsx("div",{className:"flex flex-col px-8 md:px-[8%] xl:px-[175px] py-8",children:n.map(e=>f.jsx(W8,{card:e},e._key))})}function Q8(n,e,t){if(!e)return n;const r=n.toLowerCase(),s=e.toLowerCase(),i=r.indexOf(s);if(i===-1)return n;const a=n.substring(0,i),l=n.substring(i,i+e.length),d=n.substring(i+e.length),u=t||"#3b82f6";return f.jsxs(f.Fragment,{children:[a,f.jsx("span",{style:{color:u},children:l}),d]})}function X8({label:n,title:e,highlightedText:t,highlightColor:r,subtitle:s,image:i,teamLabel:a,teamMembers:l,description:d}){return f.jsx("div",{className:"px-8 md:px-[8%] xl:px-[175px] py-16 w-full",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_2fr] gap-12 md:gap-0",children:[f.jsxs("div",{className:"flex flex-col gap-12 md:col-start-1",children:[f.jsxs("div",{className:"flex flex-col",children:[n&&f.jsx("p",{className:"text-[#9ca3af] text-base pb-2",children:n}),e&&f.jsx("h3",{className:"text-2xl text-black",children:Q8(e,t,r)}),s&&f.jsx("p",{className:"text-gray-500 text-xl",children:s})]}),i&&f.jsx("div",{className:"mt-8",children:f.jsx("div",{className:"relative inline-block transform -rotate-2 transition-transform hover:rotate-0 duration-300",children:f.jsx("img",{src:at(i).width(600).url(),alt:e,className:"w-full max-w-[320px] h-auto rounded-lg"})})})]}),f.jsxs("div",{className:"flex flex-col gap-16 md:col-start-3",children:[l&&l.length>0&&f.jsxs("div",{className:"flex flex-col gap-2",children:[a&&f.jsx("p",{className:"text-[#9ca3af] text-base",children:a}),f.jsx("div",{className:"flex flex-col",children:l.map(u=>f.jsx("div",{children:u.link?f.jsx("a",{href:u.link,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 underline decoration-white underline-offset-2 hover:decoration-gray-300 transition-colors transition-100ms",children:u.name}):f.jsx("span",{className:"text-gray-500  underline decoration-[#d1d5db] underline-offset-2",children:u.name})},u._key))})]}),d&&d.length>0&&f.jsx("div",{className:"leading-normal text-gray-700 prose prose-p:my-4 first:prose-p:mt-0 last:prose-p:mb-0",children:f.jsx(bn,{value:d,components:{block:{normal:({children:u})=>f.jsx("p",{className:"mb-4 last:mb-0",children:u})},hardBreak:()=>f.jsx("br",{}),marks:{link:({value:u,children:h})=>f.jsx("a",{href:u?.href,target:"_blank",rel:"noopener noreferrer",className:"underline hover:opacity-70",children:h})}}})})]})]})})}let Za=0,Ai=null;function Z8(){Za++,Za===1&&(Ai={htmlOverflow:document.documentElement.style.overflow,bodyOverflow:document.body.style.overflow,scrollbarGutter:document.documentElement.style.scrollbarGutter},document.documentElement.style.scrollbarGutter="stable",document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden")}function J8(){Za>0&&Za--,Za===0&&Ai&&(document.documentElement.style.overflow=Ai.htmlOverflow,document.body.style.overflow=Ai.bodyOverflow,document.documentElement.style.scrollbarGutter=Ai.scrollbarGutter,Ai=null)}function bo(n=!0){R.useEffect(()=>{if(n)return Z8(),()=>{J8()}},[n])}const e6="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.75%2010.5C4.16421%2010.5%204.5%2010.1642%204.5%209.75V5.56066L9.96967%2011.0303C10.2626%2011.3232%2010.7374%2011.3232%2011.0303%2011.0303C11.3232%2010.7374%2011.3232%2010.2626%2011.0303%209.96967L5.56066%204.5H9.75C10.1642%204.5%2010.5%204.16421%2010.5%203.75C10.5%203.33579%2010.1642%203%209.75%203H3.75C3.33579%203%203%203.33579%203%203.75V9.75C3%2010.1642%203.33579%2010.5%203.75%2010.5Z'%20fill='%234B5563'/%3e%3cpath%20d='M20.25%2013.5C19.8358%2013.5%2019.5%2013.8358%2019.5%2014.25V18.4393L14.0303%2012.9697C13.7374%2012.6768%2013.2626%2012.6768%2012.9697%2012.9697C12.6768%2013.2626%2012.6768%2013.7374%2012.9697%2014.0303L18.4393%2019.5H14.25C13.8358%2019.5%2013.5%2019.8358%2013.5%2020.25C13.5%2020.6642%2013.8358%2021%2014.25%2021H20.25C20.6642%2021%2021%2020.6642%2021%2020.25V14.25C21%2013.8358%2020.6642%2013.5%2020.25%2013.5Z'%20fill='%234B5563'/%3e%3c/svg%3e",is={block:{h1:({children:n})=>f.jsx("h1",{className:"text-3xl font-normal mb-4 mt-8 first:mt-0",children:n}),h2:({children:n})=>f.jsx("h2",{className:"text-2xl font-normal mb-3 mt-6 first:mt-0",children:n}),h3:({children:n})=>f.jsx("h3",{className:"text-xl font-normal mb-3 mt-5 first:mt-0",children:n}),h4:({children:n})=>f.jsx("h4",{className:"text-lg font-normal mb-2 mt-4 first:mt-0",children:n}),normal:({children:n})=>f.jsx("p",{className:"mb-4 last:mb-0",children:n})},marks:{strong:({children:n})=>f.jsx("strong",{className:"font-semibold",children:n}),em:({children:n})=>f.jsx("em",{className:"italic",children:n}),code:({children:n})=>f.jsx("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded text-sm font-mono",children:n})},list:{bullet:({children:n})=>f.jsx("ul",{className:"list-disc ml-5 space-y-2 mb-4",children:n}),number:({children:n})=>f.jsx("ol",{className:"list-decimal ml-5 space-y-2 mb-4",children:n})}},tw="unlockedProjects";function rw(){try{const n=sessionStorage.getItem(tw);return n?JSON.parse(n):[]}catch{return[]}}function t6(n){try{const e=rw();e.includes(n)||(e.push(n),sessionStorage.setItem(tw,JSON.stringify(e)))}catch{}}function r6(n){return rw().includes(n)}const n6=()=>f.jsx("svg",{className:"block size-full",viewBox:"0 0 16 16",fill:"none",children:f.jsx("path",{d:"M6 12L10 8L6 4",stroke:"#9CA3AF",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})});function s6({projectName:n,onWorkClick:e,isScrolled:t=!1,isPastHero:r=!1}){return f.jsxs("div",{className:ee("flex items-center transition-all duration-300 ease-out",r?"opacity-0 pointer-events-none":"opacity-100"),children:[f.jsx("button",{onClick:e,className:ee("flex items-center justify-center py-0.5 rounded-md transition-all duration-300 ease-out hover:bg-[#f3f4f6]",t?"opacity-0 pointer-events-none w-0 px-0 overflow-hidden":"opacity-100 px-1.5 ml-2"),children:f.jsx("span",{className:"font-['Figtree:Medium',sans-serif] font-medium text-sm leading-normal text-[#4b5563] whitespace-nowrap",children:"Work"})}),f.jsx("div",{className:"shrink-0 size-4",children:f.jsx(n6,{})}),f.jsx("div",{className:"flex items-center justify-center px-1 py-0.5",children:f.jsx("span",{className:"font-['Figtree:Medium',sans-serif] font-medium text-sm leading-normal text-[#1f2937]",children:n})})]})}function i6({videoId:n}){const e=R.useRef(null),t=R.useRef(null),r=R.useRef(null),[s,i]=R.useState(1),[a,l]=R.useState(!1),d=R.useRef(null),u=R.useRef(`yt-${n}-${Math.random().toString(36).substr(2,9)}`),h=`${u.current}-1`,p=`${u.current}-2`;return R.useEffect(()=>{if(window.YT&&window.YT.Player){l(!0);return}if(!document.querySelector('script[src="https://www.youtube.com/iframe_api"]')){const E=document.createElement("script");E.src="https://www.youtube.com/iframe_api",document.head.appendChild(E)}const x=setInterval(()=>{window.YT&&window.YT.Player&&(l(!0),clearInterval(x))},100),y=window.onYouTubeIframeAPIReady;return window.onYouTubeIframeAPIReady=()=>{y?.(),l(!0),clearInterval(x)},()=>{clearInterval(x),d.current&&clearInterval(d.current)}},[]),R.useEffect(()=>{if(!a||!window.YT?.Player)return;const g=(x,y,E)=>{y.current=new window.YT.Player(x,{videoId:n,playerVars:{autoplay:E?1:0,mute:1,controls:0,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0,playsinline:1,origin:window.location.origin},events:{onReady:w=>{E&&w.target.playVideo()}}})};return g(h,t,!0),g(p,r,!1),()=>{t.current?.destroy(),r.current?.destroy()}},[a,n,h,p]),R.useEffect(()=>{if(!a)return;const g=()=>{const x=s===1?t:r,y=s===1?r:t,E=x.current,w=y.current;if(!(!E||!w))try{const S=E.getCurrentTime?.(),T=E.getDuration?.();S&&T&&T>0&&S>=T-.3&&(w.seekTo(0,!0),w.playVideo(),i(s===1?2:1))}catch{}};return d.current=window.setInterval(g,50),()=>{d.current&&clearInterval(d.current)}},[a,s]),f.jsxs("div",{ref:e,className:"aspect-video w-full overflow-hidden rounded-3xl relative pointer-events-none",children:[f.jsx("div",{id:h,className:ee("absolute inset-0 w-full h-full transition-opacity duration-200 scale-[1.5] [&>iframe]:w-full [&>iframe]:h-full",s===1?"opacity-100 z-10":"opacity-0 z-0")}),f.jsx("div",{id:p,className:ee("absolute inset-0 w-full h-full transition-opacity duration-200 scale-[1.5] [&>iframe]:w-full [&>iframe]:h-full",s===2?"opacity-100 z-10":"opacity-0 z-0")})]})}const a6=()=>f.jsx("img",{src:e6,alt:"Expand",className:"block size-full"}),o6=()=>f.jsx("svg",{className:"block size-full",viewBox:"0 0 12 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 0C6.41421 0 6.75 0.335786 6.75 0.75V11.4393L10.7197 7.46967C11.0126 7.17678 11.4874 7.17678 11.7803 7.46967C12.0732 7.76256 12.0732 8.23744 11.7803 8.53033L6.53033 13.7803C6.23744 14.0732 5.76256 14.0732 5.46967 13.7803L0.21967 8.53033C-0.0732233 8.23744 -0.0732233 7.76256 0.21967 7.46967C0.512563 7.17678 0.987437 7.17678 1.28033 7.46967L5.25 11.4393V0.75C5.25 0.335786 5.58579 0 6 0Z",fill:"#9CA3AF"})}),l6=()=>f.jsxs("svg",{className:"block size-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("path",{d:"M12 5.25C4.5 5.25 1.5 12 1.5 12C1.5 12 4.5 18.75 12 18.75C19.5 18.75 22.5 12 22.5 12C22.5 12 19.5 5.25 12 5.25Z",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M12 15.75C14.0711 15.75 15.75 14.0711 15.75 12C15.75 9.92893 14.0711 8.25 12 8.25C9.92893 8.25 8.25 9.92893 8.25 12C8.25 14.0711 9.92893 15.75 12 15.75Z",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),c6=()=>f.jsxs("svg",{className:"block size-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("path",{d:"M14.12 14.12C13.5646 14.6755 12.7998 14.9855 12 14.9855C11.2002 14.9855 10.4354 14.6755 9.88 14.12C9.32457 13.5646 9.0145 12.7998 9.0145 12C9.0145 11.2002 9.32457 10.4354 9.88 9.88",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M4.5 4.5L19.5 19.5",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M9.75 5.5C10.485 5.34 11.235 5.25 12 5.25C19.5 5.25 22.5 12 22.5 12C22.02 12.945 21.42 13.815 20.73 14.61",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),f.jsx("path",{d:"M17.94 17.94C16.23 19.17 14.16 19.875 12 19.875C4.5 19.875 1.5 13.125 1.5 13.125C2.505 11.205 3.975 9.54 5.775 8.355",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"})]});function u6({expectedPassword:n,onUnlock:e}){const[t,r]=R.useState(""),[s,i]=R.useState(!1),[a,l]=R.useState(!1),d=p=>{p.preventDefault(),t===n?(i(!1),r(""),e?.()):i(!0)},u=p=>{r(p.target.value),s&&i(!1)},h=()=>{l(!a)};return f.jsxs("form",{onSubmit:d,className:"flex flex-col gap-2 w-[313px]",children:[f.jsxs("div",{className:ee("bg-white border border-solid content-stretch flex items-center justify-between pl-4 pr-3 py-2 relative rounded-full shrink-0 w-full transition-colors duration-200",s?"border-[#f87171]":"border-[#e5e7eb]"),children:[f.jsx("input",{type:a?"text":"password",placeholder:"Enter",value:t,onChange:u,className:"leading-5 relative shrink-0 text-black text-base bg-transparent border-none outline-none flex-1 placeholder:text-[#9ca3af]"}),f.jsxs("div",{className:"flex items-center gap-2.5",children:[f.jsx("button",{type:"button",onClick:h,className:ee("relative shrink-0 size-[18px] hover:opacity-70 transition-all duration-200",t.length>0?"opacity-100":"opacity-0 pointer-events-none"),children:a?f.jsx(c6,{}):f.jsx(l6,{})}),f.jsx("button",{type:"submit",className:"relative shrink-0 size-[14px] rotate-[-90deg] hover:opacity-70 transition-opacity",children:f.jsx(o6,{})})]})]}),f.jsx("div",{className:ee("overflow-hidden transition-all duration-300 ease-out",s?"max-h-6 opacity-100":"max-h-0 opacity-0"),children:f.jsx("p",{className:"text-[#f87171] text-sm leading-5 px-2",children:"Please try again!"})})]})}function d6(){return f.jsx("div",{className:"h-px relative shrink-0 w-full",children:f.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})}function f6({projectId:n,onClose:e,onBack:t,onExpandToFullscreen:r,onCollapseFromFullscreen:s,initialFullscreen:i=!1,onProjectClick:a,onViewAllProjects:l}){const[d,u]=R.useState(!1),[h,p]=R.useState(!1),[g,x]=R.useState(!1),[y,E]=R.useState(!1),[w,S]=R.useState(!1),[T,k]=R.useState(null),[I,L]=R.useState(!0),[O,P]=R.useState(null),[j,F]=R.useState(()=>r6(n)),D=_n.useRef(null),$=_n.useRef(null),J=_n.useRef(null),ne=_n.useRef(null),se=i;R.useEffect(()=>{async function N(){try{L(!0);const U=`project:${n}`,re=nt(U);if(re){k(re),P(null),L(!1);return}const de=await xt.fetch(WE,{company:n});k(de),P(null)}catch(U){console.error("Error fetching project:",U),P("Failed to load project")}finally{L(!1)}}N()},[n]),bo(!se),R.useEffect(()=>{requestAnimationFrame(()=>{u(!0)})},[]),R.useEffect(()=>{const N=D.current;if(!N)return;let U=null;const re=(ue,he)=>{let pe=0,ge=ue;for(;ge&&ge!==he;)pe+=ge.offsetTop,ge=ge.offsetParent;return pe},de=setTimeout(()=>{U=()=>{const ue=N.scrollTop;if(x(ue>20),J.current&&ne.current){const he=re(J.current,N),pe=re(ne.current,N),ge=ue;S(ge>=he-200&&ge<pe-200)}},U&&(N.addEventListener("scroll",U),U())},100);return()=>{clearTimeout(de),U&&N.removeEventListener("scroll",U)}},[T,I]),R.useEffect(()=>{const N=$.current,U=D.current;if(!N||!U||!se)return;const re=new IntersectionObserver(de=>{de.forEach(ue=>{const he=ue.boundingClientRect.top,pe=ue.rootBounds?.top??0,ge=!ue.isIntersecting&&he<pe;E(ge)})},{root:U,threshold:0,rootMargin:"0px 0px 0px 0px"});return re.observe(N),()=>re.disconnect()},[se,T]),R.useEffect(()=>{if(se)return;const N=U=>{U.key==="Escape"&&(U.preventDefault(),X())};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[se]);const X=()=>{p(!0),u(!1),setTimeout(()=>{e()},300)},Z=()=>{r&&r()},ie=()=>{se?l&&l():t&&(p(!0),u(!1),setTimeout(()=>{t()},300))},G=()=>{if(t6(n),F(!0),!se&&r)r(),setTimeout(()=>{window.scrollTo({top:0,behavior:"instant"})},50);else{const N=()=>{D.current&&(D.current.scrollTop=0),window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0};N(),setTimeout(N,50),setTimeout(N,150)}},Q=N=>{if(N.preventDefault(),ne.current&&D.current){const re=((de,ue)=>{let he=0,pe=de;for(;pe&&pe!==ue;)he+=pe.offsetTop,pe=pe.offsetParent;return he})(ne.current,D.current);D.current.scrollTo({top:re-20,behavior:"smooth"})}},W=N=>{a&&a(N)};return f.jsxs("div",{className:ee("fixed inset-0 z-50 flex items-center justify-center transition-all duration-500 ease-out",se?"px-0":"px-8"),children:[f.jsx("div",{className:ee("absolute inset-0 bg-black/20 transition-opacity duration-500",d&&!se?"opacity-100":"opacity-0",se&&"pointer-events-none"),onClick:X}),f.jsx("div",{className:ee("relative bg-white flex flex-col overflow-hidden transition-all duration-500 ease-out",se?"w-full h-full rounded-none":"rounded-[26px] w-[calc(100%*10/12)] max-md:w-full max-h-[80vh] sm:max-h-[90vh]",d?"opacity-100 translate-y-0":h?"opacity-0 translate-y-4":"opacity-0 translate-y-8"),children:f.jsxs("div",{className:"flex flex-col flex-1 min-h-0 relative",children:[!se&&f.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-start justify-start px-7 pt-6 pb-3 z-10",children:f.jsx("button",{onClick:Z,className:"content-stretch flex items-center justify-center relative shrink-0 size-6 cursor-pointer rounded-sm hover:bg-gray-200 transition-colors duration-200 ease-out text-[#4b5563]",children:f.jsx("div",{className:"relative shrink-0 size-[18px]",children:f.jsx(a6,{})})})}),f.jsx("a",{href:"#final-designs",onClick:Q,className:ee("fixed z-[100] font-medium text-gray-400 hover:text-blue-500 cursor-pointer leading-tight","transition-all duration-300 ease-in-out",w?"opacity-100":"opacity-0 pointer-events-none",se?"top-16 left-14 max-md:left-6":"top-16 left-8"),children:f.jsxs("div",{className:"flex flex-col gap-0.5 items-start",children:[f.jsx("span",{className:"text-[0.8rem]",children:" SKIP TO"}),f.jsx("span",{className:"text-[0.8rem]",children:"DESIGNS"})]})}),f.jsxs("div",{ref:D,className:ee("overflow-y-auto overflow-x-hidden flex-1",!se&&"rounded-t-[26px]"),children:[se&&f.jsx("div",{className:ee("content-stretch flex flex-col items-start px-14 max-md:px-6 relative shrink-0 w-full md:sticky md:top-0 z-10 transition-all duration-300 ease-out",g?"py-4":"py-8"),children:f.jsxs("div",{className:"content-stretch flex gap-1.5 items-center relative shrink-0 w-full",children:[f.jsx("button",{onClick:ie,className:ee("overflow-clip relative shrink-0 cursor-pointer hover:opacity-80 transition-all duration-300 ease-out p-0 border-0 bg-transparent",g?"size-7":"size-[44px]"),children:f.jsx("img",{src:"/logo.png",alt:"Michelle Liu",className:"size-full object-cover"})}),f.jsx(s6,{projectName:T?.title||n.charAt(0).toUpperCase()+n.slice(1),onWorkClick:l,isScrolled:g,isPastHero:y})]})}),I&&f.jsx("div",{className:"flex items-center justify-center py-32",children:f.jsx("div",{className:"text-gray-400",children:"Loading..."})}),O&&f.jsx("div",{className:"flex items-center justify-center py-32",children:f.jsx("div",{className:"text-red-500",children:O})}),!I&&!O&&T&&f.jsxs("div",{className:"flex flex-col pb-32",children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-8 items-start justify-center px-8 md:px-[8%] xl:px-[175px] pt-32 pb-16 relative shrink-0 w-full",children:[T.logo&&f.jsx(De,{variant:"fade",rootMargin:"0px",children:f.jsx("div",{className:"relative shrink-0 size-20 rounded-[16px] overflow-hidden",children:f.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",alt:"",src:at(T.logo).width(160).height(160).url()})})}),f.jsxs("div",{className:"content-stretch flex flex-col gap-10 items-start relative shrink-0 w-full",children:[f.jsx(De,{variant:"fade",delay:80,rootMargin:"0px",children:f.jsx("p",{className:"font-normal leading-5 relative shrink-0 text-4xl text-black",children:T.title})}),T.metadata&&T.metadata.length>0&&f.jsx("div",{className:"content-stretch flex gap-5 items-start relative shrink-0 w-full max-md:grid max-md:grid-cols-2 max-md:gap-4",children:T.metadata.map(N=>f.jsx(De,{variant:"fade",delay:160,rootMargin:"0px",className:"flex-[1_0_0] min-h-px min-w-px",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-3 items-start leading-5 relative shrink-0 text-base whitespace-pre-wrap",children:[f.jsx("p",{className:"font-semibold relative shrink-0 text-[#9ca3af]",children:N.label}),f.jsxs("p",{className:"font-normal relative shrink-0 text-black",children:[N.value.map((U,re)=>f.jsxs(_n.Fragment,{children:[U,re<N.value.length-1&&f.jsx("br",{})]},re)),N.subValue&&f.jsxs(f.Fragment,{children:[f.jsx("br",{}),f.jsx("span",{className:"italic text-gray-600",children:N.subValue})]})]})]})},N._key))})]}),f.jsx(De,{variant:"fade",delay:400,rootMargin:"0px",className:"w-full",children:f.jsx(d6,{})}),T.heroVideo?f.jsx(De,{delay:480,rootMargin:"0px",className:"w-full",children:f.jsx("div",{ref:$,className:"content-stretch flex flex-col items-start overflow-clip relative rounded-[26px] shrink-0 w-full",children:f.jsxs("div",{className:"aspect-[1090/591] relative rounded-[26px] shrink-0 w-full overflow-hidden bg-gray-100",children:[T.heroImage&&f.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[26px] size-full",alt:"",src:at(T.heroImage).width(1200).url()}),f.jsx(ls,{src:`https://stream.mux.com/${T.heroVideo}.m3u8`,className:"absolute inset-0 max-w-none object-cover rounded-[26px] size-full",autoPlay:!0,muted:!0,loop:!0,controls:!1,poster:T.heroImage?at(T.heroImage).width(1200).url():void 0})]})})}):T.heroImage?f.jsx(De,{delay:480,rootMargin:"0px",className:"w-full",children:f.jsx("div",{ref:$,className:"content-stretch flex flex-col items-start overflow-clip relative rounded-[26px] shrink-0 w-full",children:f.jsx("div",{className:"aspect-[1090/591] relative rounded-[26px] shrink-0 w-full",children:f.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[26px] size-full",alt:"",src:at(T.heroImage).width(1200).url()})})})}):null]}),(()=>{let N=T.content||[];const U=re=>{if(re._type==="protectedSection")return!j;const de=re.visibility||"both";return de==="both"?!0:de==="locked"?!j:de==="unlocked"?j:!0};if(!j){const re=N.findIndex(de=>de._type==="protectedSection");re!==-1&&(N=N.slice(0,re+1))}return N=N.filter(U),N.map(re=>re._type==="testimonialSection"?f.jsx(kv,{section:re,isFullscreen:se,isUnlocked:j,onUnlock:G,skipStartRef:J,skipEndRef:ne},re._key):f.jsx(De,{children:f.jsx(kv,{section:re,isFullscreen:se,isUnlocked:j,onUnlock:G,skipStartRef:J,skipEndRef:ne})},re._key))})(),T.relatedProjects&&T.relatedProjects.length>0&&f.jsx(De,{variant:"fade",children:f.jsx(UR,{projects:T.relatedProjects.map(N=>({id:N._id,title:N.title,year:N.year,description:N.shortDescription||"",imageSrc:N.heroImage?at(N.heroImage).width(800).height(434).url():""})),onProjectClick:N=>{const U=T.relatedProjects?.find(re=>re._id===N.id);U?.company&&W(U.company)},onViewAll:se?l:void 0})})]}),!I&&!O&&!T&&f.jsx("div",{className:"flex items-center justify-center py-32",children:f.jsx("div",{className:"text-gray-400",children:"Project not found"})}),se&&f.jsx(Kc,{})]})]})})]})}const h6=()=>f.jsx("svg",{className:"block size-full",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.7803 14.7803C14.4874 15.0732 14.0126 15.0732 13.7197 14.7803L6.5 7.56066V13.25C6.5 13.6642 6.16421 14 5.75 14C5.33579 14 5 13.6642 5 13.25V5.75C5 5.33579 5.33579 5 5.75 5H13.25C13.6642 5 14 5.33579 14 5.75C14 6.16421 13.6642 6.5 13.25 6.5H7.56066L14.7803 13.7197C15.0732 14.0126 15.0732 14.4874 14.7803 14.7803Z",fill:"#9CA3AF"})}),m6=()=>f.jsx("svg",{className:"block size-full rotate-180",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.7803 14.7803C14.4874 15.0732 14.0126 15.0732 13.7197 14.7803L6.5 7.56066V13.25C6.5 13.6642 6.16421 14 5.75 14C5.33579 14 5 13.6642 5 13.25V5.75C5 5.33579 5.33579 5 5.75 5H13.25C13.6642 5 14 5.33579 14 5.75C14 6.16421 13.6642 6.5 13.25 6.5H7.56066L14.7803 13.7197C15.0732 14.0126 15.0732 14.4874 14.7803 14.7803Z",fill:"#9CA3AF"})});function p6({sectionLabel:n="Feedback",sectionTitle:e="Kind words from my manager",highlightedText:t,highlightColor:r,quote:s,fullQuote:i,authorName:a,authorTitle:l,authorCompany:d,authorImage:u,isFullscreen:h=!1}){const[p,g]=R.useState(!1),[x,y]=R.useState(!1),E=_n.useRef(null),w=()=>{const T=p;y(!0),g(!p),T&&E.current&&setTimeout(()=>{E.current?.scrollIntoView({behavior:"smooth",block:"start"})},50),setTimeout(()=>y(!1),400)},S=d?`${l}, ${d}`:l;return f.jsx("div",{ref:E,className:"content-stretch flex flex-col items-start justify-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full scroll-mt-8",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-[100px] max-md:gap-16 items-start relative shrink-0 w-full",children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-5 items-start relative shrink-0 w-full",children:[f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n}),f.jsx("p",{className:"leading-7 min-w-full relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:e&&Xr(e,t,r)})]}),f.jsxs("div",{className:ee("content-stretch flex items-start relative shrink-0 w-full","justify-between",h&&"px-[111px]","max-md:flex-col max-md:gap-16 max-md:px-12"),children:[f.jsxs("div",{className:ee("content-stretch flex relative shrink-0","flex-col gap-6 items-start w-[202px]","max-md:flex-row max-md:gap-8 max-md:items-center max-md:w-auto"),children:[f.jsx("div",{className:"relative rounded-full shrink-0 size-[120px] overflow-hidden bg-gray-100",children:u&&f.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",alt:a||"",src:at(u).width(240).height(240).url()})}),f.jsxs("div",{className:"content-stretch flex flex-col gap-1 items-start leading-5 relative shrink-0 text-base max-md:flex-1",children:[f.jsx("p",{className:"relative shrink-0 text-black",children:a}),f.jsx("p",{className:"relative shrink-0 text-[#9ca3af]",children:S})]})]}),f.jsxs("div",{className:ee("content-stretch flex flex-col gap-6 relative shrink-0","items-start justify-center","max-md:w-full"),children:[f.jsx("div",{className:ee("absolute pointer-events-none","-top-[77px] -left-[77px] w-[121px] h-[120px]","max-md:-left-[50px] max-md:-top-[50px] max-md:w-[80px] max-md:h-[80px]"),children:f.jsx("img",{src:jR,alt:"",className:"w-full h-full object-contain"})}),f.jsxs("div",{className:"relative w-[424px] max-md:w-full",children:[!p&&f.jsx("div",{className:"leading-normal text-[#1f2937] text-xl whitespace-pre-wrap",children:f.jsx("p",{children:s})}),p&&f.jsx("div",{className:"leading-normal text-[#1f2937] text-xl whitespace-pre-wrap",children:i?.map((T,k)=>f.jsx("p",{className:k<(i?.length||0)-1?"mb-6":"",children:T},k))})]}),f.jsx("button",{onClick:w,className:ee("relative shrink-0 cursor-pointer transition-colors duration-300 ease-out",p?"size-6 hover:opacity-70":"leading-5 text-[#9ca3af] text-base hover:text-[#6b7280] text-left"),children:p?f.jsxs("div",{className:"relative shrink-0 size-5",children:[f.jsx("span",{className:"hidden max-md:block",children:f.jsx(m6,{})}),f.jsx("span",{className:"block max-md:hidden",children:f.jsx(h6,{})})]}):i&&i.length>0?"Read more":null})]})]})]})})}function Xr(n,e,t){if(!e)return n;const r=n.toLowerCase(),s=e.toLowerCase(),i=r.indexOf(s);if(i===-1)return n;const a=n.substring(0,i),l=n.substring(i,i+e.length),d=n.substring(i+e.length),u=t||"#3b82f6";return f.jsxs(f.Fragment,{children:[a,f.jsx("span",{style:{color:u},children:l}),d]})}function kv({section:n,isFullscreen:e=!1,isUnlocked:t=!1,onUnlock:r,skipStartRef:s,skipEndRef:i}){const l=(()=>{switch(n._type){case"missionSection":const d=n.missionDescription&&n.missionDescription.length>0;return n.missionImage?f.jsxs("div",{className:"flex flex-col items-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[f.jsxs("div",{className:"flex flex-col gap-5 items-center text-center w-[410px] max-md:w-full",children:[f.jsx("p",{className:"leading-5 text-[#9ca3af] text-base",children:n.sectionLabel||"The Mission"}),f.jsx("p",{className:"leading-7 text-2xl text-black whitespace-pre-wrap text-pretty",children:Xr(n.missionTitle,n.highlightedText,n.highlightColor)})]}),f.jsx("div",{className:"relative mt-8 w-[410px] max-md:w-full",children:f.jsx("img",{src:at(n.missionImage).width(820).url(),alt:"",className:"w-full h-auto object-cover"})}),d&&f.jsxs("div",{className:"flex flex-col gap-8 mt-8 w-[410px] max-md:w-full px-8 max-md:px-0",children:[f.jsx("div",{className:"leading-normal text-[#4b5563] text-base whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:f.jsx(bn,{value:n.missionDescription,components:is})}),n.missionNote&&f.jsx("p",{className:"text-[#9ca3af] text-base italic leading-5",children:n.missionNote})]}),!d&&n.missionNote&&f.jsx("p",{className:"text-[#9ca3af] text-base italic leading-5 mt-8 w-[410px] max-md:w-full px-8 max-md:px-0",children:n.missionNote})]}):f.jsxs("div",{className:ee("content-stretch items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",!d&&"flex flex-col gap-5 justify-center",d&&"grid grid-cols-[2fr_1fr_2fr] max-md:flex max-md:flex-col max-md:gap-8"),children:[f.jsxs("div",{className:ee("content-stretch flex flex-col gap-5 items-start relative",!d&&"max-w-[646px] w-full",d&&"col-start-1"),children:[f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n.sectionLabel||"The Mission"}),f.jsx("p",{className:"leading-7 w-full relative shrink-0 text-2xl text-black whitespace-pre-wrap text-pretty",children:Xr(n.missionTitle,n.highlightedText,n.highlightColor)})]}),d&&f.jsx("div",{className:"leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap col-start-3 max-md:col-start-auto max-md:w-full prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:f.jsx(bn,{value:n.missionDescription,components:is})})]});case"protectedSection":if(!(n.visibility==="both"||n.visibility==="locked"&&!t||n.visibility==="unlocked"&&t||!n.visibility&&!t))return null;const p=!!(n.showPasswordProtection&&n.password);return f.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:f.jsx("div",{className:"bg-gray-100 content-stretch flex flex-col items-center justify-center overflow-clip p-16 max-md:p-8 relative rounded-[26px] shrink-0 w-full",children:f.jsxs("div",{className:ee("content-stretch flex flex-col items-start relative shrink-0 w-full",p&&"gap-8"),children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-8 items-start justify-center relative shrink-0",children:[f.jsx("div",{className:"relative shrink-0 size-[60px]",children:f.jsx("div",{className:"absolute inset-0 rounded-full bg-white shadow-[0px_1px_3px_0px_rgba(0,0,0,0.08),0px_1px_2px_-1px_rgba(0,0,0,0.08)] flex items-center justify-center",children:f.jsx("img",{src:OR,alt:"",className:"w-[19px] h-[28px]"})})}),f.jsxs("div",{className:"content-stretch flex flex-col gap-2 items-start relative shrink-0 w-full",children:[f.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black",children:(n.title||(p?"This case study is password-protected.":"Confidential")).replace(/\n/g," ")}),f.jsxs("p",{className:"leading-6 relative shrink-0 text-[#9ca3af] text-lg",children:[p?"Curious? Feel free to ":n.message||"Interested? Please ",n.contactEmail?f.jsxs(f.Fragment,{children:[f.jsx("a",{href:`mailto:${n.contactEmail}`,className:"text-[#4b5563] hover:text-blue-500 transition-colors",children:"email me"}),f.jsx("span",{className:"text-[#9ca3af]",children:"!"})]}):"email me!"]})]})]}),p&&!t&&f.jsx(u6,{expectedPassword:n.password||"",onUnlock:r})]})})});case"featureSection":const g=n.externalImageUrl?n.externalImageUrl:n.image?at(n.image).width(2400).url():null,x=n.mediaType==="video"&&n.muxPlaybackId,y=n.layout==="stacked",E=n.mediaPosition==="left",S={small:"py-10",normal:"py-16",large:"py-20"}[n.verticalPadding||"normal"];return y?f.jsx("div",{className:"flex flex-col py-6",children:f.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] relative shrink-0 w-full",style:{backgroundColor:n.backgroundColor||"#f9fafb"},children:f.jsxs("div",{className:ee("content-stretch flex flex-col justify-between relative shrink-0 w-full",S),children:[f.jsxs("div",{className:"flex flex-row items-start gap-32 w-full max-md:flex max-md:flex-col max-md:gap-8",children:[f.jsxs("div",{className:"content-stretch flex w-120 flex-col gap-3 items-start relative col-start-1",children:[(n.sectionNumber||n.sectionLabel)&&f.jsxs("div",{className:"flex items-center gap-2",children:[n.sectionNumber&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#3b82f6] text-base font-medium",children:n.sectionNumber}),n.sectionLabel&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#3b82f6] text-base",children:n.sectionLabel})]}),n.problemLabel&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n.problemLabel}),n.heading&&f.jsx("p",{className:"leading-7 min-w-120 relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:Xr(n.heading,n.highlightedText,n.highlightColor)})]}),n.description&&n.description.length>0&&f.jsx("div",{className:"leading-normal max-w-120 relative text-gray-500 text-base whitespace-pre-wrap col-start-3 max-md:col-start-auto max-md:w-full prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:f.jsx(bn,{value:n.description,components:is})})]}),f.jsxs("div",{className:"w-full",children:[x&&f.jsx("div",{className:"w-full overflow-hidden rounded-[26px]",children:f.jsx("div",{className:"aspect-video w-full",children:f.jsx(ls,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-cover",controls:!1,autoPlay:!0,muted:!0,loop:!0})})}),!x&&g&&f.jsx("div",{className:"overflow-hidden rounded-[26px] w-full",children:f.jsx("img",{className:"w-full object-cover",alt:n.imageAlt||"",src:g})})]})]})})}):f.jsx("div",{className:"flex flex-col py-6",children:f.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] relative shrink-0 w-full",style:{backgroundColor:n.backgroundColor||"#f9fafb"},children:f.jsxs("div",{className:ee("content-stretch items-center flex flex-col gap-32 relative shrink-0 w-full md:flex-row max-md:gap-8",E&&"md:flex-row-reverse",S),children:[f.jsxs("div",{className:"min-w-120 shrink-0 content-stretch flex flex-col gap-3 items-start relative col-start-1 max-md:w-full max-md:min-w-0",children:[(n.sectionNumber||n.sectionLabel)&&f.jsxs("div",{className:"flex items-center gap-2",children:[n.sectionNumber&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#3b82f6] text-base font-medium",children:n.sectionNumber}),n.sectionLabel&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#3b82f6] text-base",children:n.sectionLabel})]}),n.problemLabel&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n.problemLabel}),n.heading&&f.jsx("p",{className:"leading-7 min-w-120 relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:Xr(n.heading,n.highlightedText,n.highlightColor)}),n.description&&n.description.length>0&&f.jsx("div",{className:"pt-6 max-w-120 whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 text-gray-500",children:f.jsx(bn,{value:n.description,components:is})})]}),f.jsxs("div",{className:"leading-5 max-w-120 flex-items-center relative text-[#4b5563] text-base whitespace-pre-wrap items-center flex flex-col gap-8",children:[x&&f.jsx("div",{className:"w-full min-w-200 overflow-hidden rounded-[26px] ",children:f.jsx("div",{className:"aspect-video w-full",children:f.jsx(ls,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-cover",controls:!1,autoPlay:!0,muted:!0,loop:!0})})}),!x&&g&&f.jsx("div",{className:"overflow-hidden rounded-[26px] w-full",children:f.jsx("img",{className:"w-full object-cover",alt:n.imageAlt||"",src:g})})]})]})})});case"gallerySection":const T=n.layout==="2-col"?"grid-cols-2":n.layout==="3-col"?"grid-cols-3":"grid-cols-4";return f.jsxs("div",{className:"content-stretch flex flex-col gap-4 px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[f.jsx("div",{className:`content-stretch grid gap-4 items-center relative w-full max-md:grid-cols-2 ${T}`,children:n.images?.map(pe=>f.jsx("div",{className:"aspect-[200/300] content-stretch flex flex-[1_0_0] flex-col items-start min-h-px min-w-px overflow-clip relative rounded-[26px] shadow-[0px_2px_8px_0px_#eaeaea] shrink-0",children:f.jsx("div",{className:"flex-[1_0_0] min-h-px min-w-px relative rounded-[26px] shrink-0 w-full",children:f.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[26px] size-full",alt:pe.alt||"",src:at(pe).width(400).height(600).url()})})},pe._key))}),n.title&&f.jsx("p",{className:"font-normal pt-4 leading-5 relative shrink-0 text-gray-400 text-base text-center w-full",children:n.title})]});case"textSection":return n.layout==="two-col"?f.jsxs("div",{className:`
  flex
  justify-between
  items-start
  gap-10
  px-8 md:px-[8%] xl:px-[175px]
  py-10
  relative
  shrink-0
  w-full
  max-md:flex max-md:flex-col
`,children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-3 items-start relative col-start-1",children:[n.label&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n.label}),n.heading&&f.jsx("p",{className:"leading-7 min-w-120 relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:Xr(n.heading,n.highlightedText,n.highlightColor)})]}),f.jsx("div",{className:"leading-normal relative max-w-120 text-[#4b5563] text-base whitespace-pre-wrap col-start-3 max-md:col-start-auto max-md:w-full max-md:pr-0 prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 prose-p:break-words",children:n.body&&f.jsx(bn,{value:n.body,components:is})})]}):n.layout==="centered"?f.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.label&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base text-center",children:n.label}),n.heading&&f.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black text-center whitespace-pre-line",children:Xr(n.heading,n.highlightedText,n.highlightColor)}),n.body&&f.jsx("div",{className:"leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap text-center prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 max-w-[600px]",children:f.jsx(bn,{value:n.body,components:is})})]}):n.layout==="single-col"?f.jsx("div",{className:"content-stretch grid grid-cols-[2fr_1fr_2fr] items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full max-md:flex max-md:flex-col max-md:gap-8",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-3 items-start relative col-start-1",children:[n.label&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n.label}),n.heading&&f.jsx("p",{className:"leading-7 min-w-full relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:Xr(n.heading,n.highlightedText,n.highlightColor)}),n.body&&f.jsx("div",{className:"leading-normal pt-4 relative text-[#4b5563] max-w-100 text-base whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 w-full",children:f.jsx(bn,{value:n.body,components:is})})]})}):f.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.label&&f.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] text-base",children:n.label}),n.heading&&f.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black whitespace-pre-line",children:Xr(n.heading,n.highlightedText,n.highlightColor)}),n.body&&f.jsx("div",{className:"leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:f.jsx(bn,{value:n.body,components:is})})]});case"imageSection":const k=n.externalImageUrl?n.externalImageUrl:n.image?at(n.image).width(2400).url():null;if(!k)return null;const I={full:"w-full",large:"w-full max-w-[900px]",medium:"w-full max-w-[600px]",small:"w-full max-w-[400px]"},L=n.size||"large",O=I[L]||I.large;return f.jsxs("div",{className:ee("content-stretch flex flex-col py-10 relative shrink-0 w-full",L==="full"?"items-start px-8 md:px-[8%] xl:px-[175px]":"items-center px-8"),children:[f.jsx("div",{className:ee("overflow-hidden",O,n.rounded!==!1&&"rounded-[26px]"),children:f.jsx("img",{className:"w-full object-cover",alt:n.alt||"",src:k})}),n.caption&&f.jsx("p",{className:ee("mt-3 text-center text-gray-400",O),children:n.caption})]});case"overlayImageSection":const P=n.externalBaseImageUrl?n.externalBaseImageUrl:n.baseImage?at(n.baseImage).width(2400).url():null,j=n.externalOverlayImageUrl?n.externalOverlayImageUrl:n.overlayImage?at(n.overlayImage).width(800).url():null;if(!P)return null;const F={full:"w-full",large:"w-full max-w-[900px]",medium:"w-full max-w-[600px]",small:"w-full max-w-[400px]"},D=n.size||"large",$=F[D]||F.large,J=n.overlaySize==="small"?"w-80":n.overlaySize==="large"?"w-120":"w-100",ne=n.overlayPosition?.x??50,se=n.overlayPosition?.y??50,X=!!n.backgroundColor;return f.jsx("div",{className:ee("content-stretch flex flex-col relative shrink-0 w-full",X&&"py-10"),children:f.jsx("div",{className:ee("flex flex-col relative shrink-0 w-full",D==="full"?"items-start px-8 md:px-[8%] xl:px-[175px]":"items-center px-8",!X&&"py-10"),style:{backgroundColor:n.backgroundColor||"transparent"},children:f.jsxs("div",{className:ee("relative",$,n.rounded!==!1&&"rounded-[26px]"),children:[f.jsx("img",{className:ee("w-full object-cover",n.rounded!==!1&&"rounded-[26px]"),alt:"",src:P}),j&&f.jsx("img",{src:j,alt:"",className:ee("absolute",J,"pointer-events-none"),style:{left:`${ne}%`,top:`${se}%`,transform:"translate(-50%, -50%)"}})]})})});case"videoSection":const Z=pe=>{const ge=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/];for(const Ne of ge){const Ge=pe.match(Ne);if(Ge)return Ge[1]}return null},ie=pe=>{const ge=pe.match(/vimeo\.com\/(\d+)/);return ge?ge[1]:null},G=n.youtubeUrl?Z(n.youtubeUrl):null,Q=n.vimeoUrl?ie(n.vimeoUrl):null,N=(n.size||"full")==="medium"?"max-w-[800px]":"w-full",U=n.backgroundColor?"py-0":"py-10";return f.jsx("div",{className:ee("content-stretch flex flex-col items-center px-8 md:px-[8%] xl:px-[175px] relative shrink-0 w-full",U),style:{backgroundColor:n.backgroundColor||"transparent"},children:f.jsxs("div",{className:ee("w-full",N),children:[n.videoType==="mux"&&n.muxPlaybackId&&f.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-3xl",children:f.jsx(ls,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-cover",controls:!1,autoPlay:!0,muted:!0,loop:!0,poster:n.posterImage?at(n.posterImage).width(1200).url():`https://image.mux.com/${n.muxPlaybackId}/thumbnail.png`})}),n.videoType==="youtube"&&G&&f.jsx(i6,{videoId:G}),n.videoType==="vimeo"&&Q&&f.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-3xl relative pointer-events-none",children:f.jsx("iframe",{src:`https://player.vimeo.com/video/${Q}?autoplay=1&muted=1&loop=1&controls=0&background=1`,className:"absolute inset-0 w-full h-full scale-[1.5]",allow:"autoplay; fullscreen; picture-in-picture",title:n.title||"Video"})}),(n.title||n.caption)&&f.jsxs("div",{className:"flex flex-col items-center gap-2 mt-8 text-center",children:[n.title&&f.jsx("p",{className:"text-xl text-black",children:n.title}),n.caption&&f.jsx("p",{className:"text-base text-[#9ca3af]",children:n.caption})]})]})});case"testimonialSection":return f.jsx(p6,{sectionLabel:n.sectionLabel,sectionTitle:n.sectionTitle,highlightedText:n.highlightedText,highlightColor:n.highlightColor,quote:n.quote,fullQuote:n.fullQuote,authorName:n.authorName,authorTitle:n.authorTitle,authorCompany:n.authorCompany,authorImage:n.authorImage,isFullscreen:e});case"projectCardSection":return n.cards&&n.cards.length>0?f.jsx(Y8,{cards:n.cards}):null;case"sideQuestSection":return f.jsx(X8,{label:n.label,title:n.title,highlightedText:n.highlightedText,highlightColor:n.highlightColor,subtitle:n.subtitle,image:n.image,teamLabel:n.teamLabel,teamMembers:n.teamMembers,description:n.description});case"dividerSection":return f.jsx("div",{className:"px-8 md:px-[8%] xl:px-[175px] py-8 w-full",children:f.jsx("div",{className:"h-px relative shrink-0 w-full",children:f.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})});case"phoneVideoSection":const re=n.layout!=="video-right",de=n.mediaType!=="gif",ue=n.externalGifUrl?n.externalGifUrl:n.gifImage?at(n.gifImage).width(800).url():null;return f.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:f.jsxs("div",{className:ee("flex items-center gap-20 w-full",re?"flex-row":"flex-row-reverse","max-md:flex-col"),children:[f.jsx("div",{className:"flex items-center justify-center w-[49%] aspect-[1/1] rounded-[26px] shrink-0 max-md:w-full max-md:h-auto max-md:aspect-square overflow-hidden p-6",style:{backgroundColor:n.backgroundColor||"#000000"},children:f.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[de&&n.muxPlaybackId&&f.jsx("div",{className:"w-full h-full max-w-[90%] max-h-[90%] flex items-center justify-center rounded-3xl overflow-hidden",children:f.jsx(ls,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-contain",controls:!1,autoPlay:!0,muted:!0,loop:!0})}),!de&&ue&&f.jsx("img",{src:ue,alt:"",className:"max-h-[90%] max-w-[90%] object-contain rounded-3xl"})]})}),f.jsxs("div",{className:"flex flex-col gap-6 flex-1",children:[n.emoji&&f.jsx("div",{className:"text-5xl",children:n.emoji}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[n.sectionNumber&&f.jsx("p",{className:"text-xl font-normal text-gray-400",children:n.sectionNumber}),n.heading&&f.jsx("h3",{className:"text-xl font-normal text-black leading-normal whitespace-pre-line",children:Xr(n.heading,n.highlightedText,n.highlightColor)})]}),n.subheading&&f.jsx("p",{className:"text-base text-gray-500 max-w-100 leading-normal whitespace-pre-line",children:n.subheading}),n.bulletPoints&&n.bulletPoints.length>0&&f.jsx("ul",{className:"flex flex-col gap-3",children:n.bulletPoints.map((pe,ge)=>f.jsxs("li",{className:"flex items-start gap-3 text-gray-600",children:[f.jsx("span",{className:"text-gray-600 mt-0.5 font-bold",children:""}),f.jsx("span",{className:"flex-1 leading-normal",children:pe})]},ge))})]})]})]})});case"learningsSection":return f.jsxs("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.sectionTitle&&f.jsx("h3",{className:"text-2xl font-normal text-black mb-8",children:n.sectionTitle}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 w-full",children:n.learnings?.map(pe=>f.jsxs("div",{className:"flex flex-col gap-3 py-6 px-6 rounded-3xl",children:[pe.emoji&&f.jsx("div",{className:"text-4xl",children:pe.emoji}),f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("h4",{className:"text-xl font-medium text-gray-700",children:pe.title}),pe.description&&f.jsx("p",{className:"text-base text-gray-400 leading-relaxed",children:pe.description})]})]},pe._key))})]});case"sectionTitleSection":const he=n.isSkipLinkStart?s:n.isSkipLinkEnd?i:void 0;return f.jsxs("div",{ref:he,className:"content-stretch flex flex-col gap-5 items-start justify-center px-8 md:px-[8%] xl:px-[175px] py-16 relative shrink-0 w-full",children:[f.jsxs("div",{className:"content-stretch flex font-normal gap-5 items-start leading-7 relative shrink-0 text-2xl w-full",children:[n.number&&f.jsx("p",{className:"relative shrink-0",style:{color:n.numberColor||"#7fa2ff"},children:n.number}),n.title&&f.jsx("p",{className:"relative shrink-0",style:{color:n.titleColor||"#2e5ede"},children:n.title})]}),n.showLine!==!1&&f.jsx("div",{className:"h-px relative shrink-0 w-full",children:f.jsx("div",{className:"absolute inset-0",style:{backgroundColor:n.lineColor||"#e5e7eb"}})})]});default:return null}})();return l?n._type==="testimonialSection"?l:f.jsx(De,{children:l}):null}const g6="/assets/Rectangle%20Grain%201-BSzmpmNo.png";function Cv({additionalClassNames:n=""}){return f.jsx("img",{alt:"Michelle Liu Logo",className:ee("object-contain pointer-events-none",n),src:Vi})}function g0({variant:n,heroAnimationPlayed:e=!1,children:t,nameAddon:r}){const s=Nn(),i=n==="work";return f.jsxs("div",{className:ee("content-stretch flex flex-col items-start relative shrink-0 w-full",n==="work"&&"header-gradient"),style:n!=="work"?{backgroundImage:"linear-gradient(16deg, rgba(255, 255, 255, 1) 60%, rgba(243, 218, 255, 1) 81%, rgba(192, 221, 254, 1) 98%, rgba(154, 226, 244, 1) 100%)"}:void 0,children:[f.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`url(${g6})`,backgroundRepeat:"repeat",backgroundSize:"auto",opacity:.8}}),f.jsx("div",{className:"relative shrink-0 w-full",style:{zIndex:2},children:f.jsx("div",{className:"size-full",children:f.jsx("div",{className:"content-stretch flex flex-col items-start px-16 pt-8 pb-8 max-md:px-8 max-md:pt-8 max-md:pb-4 relative w-full",children:f.jsx("div",{className:"content-stretch flex items-start justify-between relative shrink-0 w-full",children:i?f.jsx("div",{className:"relative shrink-0 size-11",children:f.jsx(Cv,{additionalClassNames:"size-full"})}):f.jsx("button",{onClick:()=>s("/"),className:"relative shrink-0 size-11 cursor-pointer",children:f.jsx(Cv,{additionalClassNames:"size-full"})})})})})}),f.jsx("div",{className:"relative shrink-0 w-full",style:{zIndex:2},children:f.jsx("div",{className:"size-full",children:f.jsx("div",{className:"content-stretch flex flex-col gap-4 items-start pb-6 pt-14 px-16 max-md:px-8 max-md:pt-8 max-md:pb-4 relative w-full max-md:h-[220px]",children:f.jsxs("div",{className:"content-stretch flex flex-col items-start relative shrink-0 w-full",children:[f.jsx(De,{variant:"fade",rootMargin:"0px",disabled:e,children:r?f.jsxs("div",{className:"flex gap-4 items-baseline w-full max-md:flex-col max-md:gap-0 max-md:items-start",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal text-[#374151] text-5xl max-md:text-4xl",children:"michelle liu"}),r]}):f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-[#374151] text-5xl w-full max-md:text-4xl",children:"michelle liu"})}),t&&f.jsx(De,{variant:"fade",delay:150,rootMargin:"0px",disabled:e,children:f.jsx("div",{className:"font-['Figtree',sans-serif] font-normal tracking-wide leading-6.5 text-[#9ca3af] text-lg max-md:text-lg w-full max-md:max-w-80 whitespace-pre-wrap mt-1 max-md:mt-1",children:t})})]})})})})]})}function Va({className:n,text:e,active:t=!1}){return f.jsxs("div",{className:ee("flex flex-col w-full gap-2",n),children:[f.jsx("div",{className:"flex items-center justify-center px-0 py-0 w-full",children:f.jsx("p",{className:ee("flex-1 font-normal leading-5 tracking-wide text-base whitespace-pre-wrap",t?"text-gray-600":"text-gray-400"),children:e})}),f.jsx("div",{className:"bg-gray-100 h-px w-full"})]})}function x6({className:n,data:e,onClick:t}){const[r,s]=R.useState(!1);return f.jsxs("button",{onClick:t,className:ee("flex flex-col gap-2 items-start w-full cursor-pointer group text-left break-inside-avoid mb-5",n),children:[f.jsxs("div",{className:"relative w-full rounded-xl overflow-hidden",children:[f.jsx("div",{className:ee("absolute inset-0 rounded-xl transition-opacity duration-500 ease-out",r?"opacity-0":"opacity-100 animate-shimmer")}),f.jsx("img",{src:e.imageSrc,alt:e.title,className:ee("w-full h-auto rounded-xl object-contain transition-opacity duration-500 ease-out",r?"opacity-100":"opacity-0"),onLoad:()=>s(!0)})]}),f.jsxs("p",{className:"font-medium leading-[1.4] px-2 text-sm",children:[f.jsx("span",{className:"text-gray-500",children:e.title}),e.metadata&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-gray-400",children:", "}),f.jsx("span",{className:"text-gray-400",children:e.metadata})]})]})]})}function Ff({className:n,items:e,onItemClick:t}){return f.jsx("div",{className:ee("w-full max-w-full","columns-2 gap-4 lg:columns-3",n),children:e.map(r=>f.jsx(De,{className:"break-inside-avoid",children:f.jsx(x6,{data:r,onClick:()=>t?.(r)})},r.id))})}const Iv=[{id:"painting",label:"Painting"},{id:"conceptual",label:"Conceptual"},{id:"graphite",label:"Graphite"}];function v6({className:n,activeCategory:e,onCategoryClick:t,counts:r,sketchbookLabels:s=[],sketchbookImageCounts:i=[],activeSketchbookIndex:a,onSketchbookClick:l,muralLabels:d=[],activeMuralIndex:u,onMuralClick:h}){const p=Iv.some(E=>E.id===e),g=e==="sketchbook",x=e==="murals",y=(E,w)=>{const S=e===E.id,T=r?.[E.id],k=T!==void 0&&T>0&&!(E.id==="sketchbook"&&p);return f.jsx("button",{onClick:()=>t(E.id),className:ee("flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors","pl-3"),children:f.jsxs("span",{className:ee("text-base font-medium tracking-wide leading-5 text-left transition-colors",S?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:[E.label,k&&f.jsxs("span",{className:"text-gray-300 ml-1",children:["(",T,")"]})]})},E.id)};return f.jsxs("div",{className:ee("flex flex-col gap-3 items-start",n),children:[f.jsx("button",{onClick:()=>t("painting"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",p?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Fine Art"})}),f.jsx("div",{className:ee("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",p?"max-h-40 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:Iv.map(E=>y(E))}),f.jsx("button",{onClick:()=>t("sketchbook"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",g?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Sketchbook"})}),f.jsx("div",{className:ee("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",g?"max-h-96 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:s.map((E,w)=>{const S=i[w];return f.jsx("button",{onClick:()=>l?.(w),className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:f.jsxs("span",{className:ee("text-base font-medium tracking-wide leading-5 text-left transition-colors",a===w?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:[E,S!==void 0&&S>0&&f.jsxs("span",{className:"text-gray-300 ml-1",children:["(",S,")"]})]})},w)})}),f.jsx("button",{onClick:()=>t("murals"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",x?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Murals"})}),f.jsx("div",{className:ee("flex flex-col gap-2 overflow-hidden transition-all duration-300 ease-in-out",x?"max-h-96 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:d.map((E,w)=>f.jsx("button",{onClick:()=>h?.(w),className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide text-left transition-colors",u===w?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:E})},w))})]})}function nw({className:n}){return f.jsx("svg",{className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:f.jsx("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function sw({className:n}){return f.jsx("svg",{className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:f.jsx("path",{d:"M9 18L15 12L9 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function y6({image:n,onClick:e,onLoad:t}){const[r,s]=R.useState(!1);return f.jsxs("button",{onClick:e,className:"flex-none inline-flex h-[200px] md:h-[300px] lg:h-96 rounded-xl overflow-hidden cursor-pointer items-center justify-center relative",style:{width:"auto",minWidth:"150px"},children:[f.jsx("div",{className:ee("absolute inset-0 rounded-xl transition-opacity duration-500 ease-out",r?"opacity-0":"opacity-100 animate-shimmer")}),f.jsx("img",{src:n.imageSrc,alt:"",className:ee("block h-[200px] md:h-[300px] lg:h-96 w-auto max-w-none object-contain transition-opacity duration-500 ease-out",r?"opacity-100":"opacity-0"),style:{maxWidth:"unset"},onLoad:()=>{s(!0),t?.()}})]})}function E6({className:n,data:e,onImageClick:t}){const r=R.useRef(null),s=R.useRef(null),[i,a]=R.useState(e.images.length>1),[l,d]=R.useState(e.images.length>1),u=R.useMemo(()=>e.images.length<=1?e.images:[...e.images,...e.images,...e.images],[e.images]),h=R.useCallback(()=>{const x=r.current;!x||u.length<=e.images.length||(s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{s.current=requestAnimationFrame(()=>{const y=x.scrollWidth;if(!y)return;const E=y/3;x.scrollLeft=E})}))},[e.images.length,u.length]);R.useEffect(()=>{const x=e.images.length>1;a(x),d(x)},[e.images.length]),R.useEffect(()=>{const x=r.current;if(!x||u.length<=e.images.length)return;const y=()=>{const E=x.scrollWidth;if(!E)return;const w=E/3;x.scrollLeft<=w*.1?x.scrollLeft+=w:x.scrollLeft>=w*1.9&&(x.scrollLeft-=w)};return h(),x.addEventListener("scroll",y),window.addEventListener("resize",h),()=>{x.removeEventListener("scroll",y),window.removeEventListener("resize",h),s.current&&cancelAnimationFrame(s.current)}},[e.images.length,u.length,h]);const p=()=>{h()},g=x=>{const y=r.current;if(!y)return;const w=Math.min(y.clientWidth*.82,320)+16,S=x==="left"?y.scrollLeft-w:y.scrollLeft+w;y.scrollTo({left:S,behavior:"smooth"})};return f.jsxs("div",{className:ee("flex flex-col gap-6 pb-6 w-full",n),children:[f.jsxs("div",{className:"flex flex-col font-medium items-start leading-[1.4] text-base",children:[f.jsx("p",{className:"text-gray-900 text-lg",children:e.title}),f.jsx("p",{className:"text-gray-400",children:e.date})]}),f.jsxs("div",{className:"relative w-full",children:[f.jsx("div",{ref:r,className:"flex gap-4 items-center justify-start overflow-x-auto w-full scrollbar-hide pb-1",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:u.map((x,y)=>f.jsx(y6,{image:x,onClick:()=>t?.(x),onLoad:p},`${x.id}-${y}`))}),f.jsx("button",{onClick:()=>g("left"),disabled:!i,className:ee("absolute top-1/2 left-0 -translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",i?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll left",children:f.jsx(nw,{className:"size-5"})}),f.jsx("button",{onClick:()=>g("right"),disabled:!l,className:ee("absolute top-1/2 right-0 translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",l?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll right",children:f.jsx(sw,{className:"size-5"})})]})]})}function w6({image:n,onClick:e,onLoad:t}){const[r,s]=R.useState(!1);return f.jsxs("button",{onClick:e,className:"flex-none inline-flex h-[200px] md:h-[250px] lg:h-96 rounded-xl overflow-hidden cursor-pointer transition-transform duration-300 items-center justify-center relative",style:{width:"auto",minWidth:"150px"},children:[f.jsx("div",{className:ee("absolute inset-0 rounded-xl transition-opacity duration-500 ease-out",r?"opacity-0":"opacity-100 animate-shimmer")}),f.jsx("img",{src:n.imageSrc,alt:"",className:ee("block h-[200px] md:h-[250px] lg:h-96 w-auto max-w-none object-contain transition-opacity duration-500 ease-out",r?"opacity-100":"opacity-0"),style:{maxWidth:"unset"},onLoad:()=>{s(!0),t?.()}})]})}function b6({className:n,data:e,onImageClick:t}){const r=R.useRef(null),s=R.useRef(null),[i,a]=R.useState(e.images.length>1),[l,d]=R.useState(e.images.length>1),u=R.useMemo(()=>e.images.length<=1?e.images:[...e.images,...e.images,...e.images],[e.images]),h=R.useCallback(()=>{const x=r.current;!x||u.length<=e.images.length||(s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{s.current=requestAnimationFrame(()=>{const y=x.scrollWidth;if(!y)return;const E=y/3;x.scrollLeft=E})}))},[e.images.length,u.length]);R.useEffect(()=>{const x=e.images.length>1;a(x),d(x)},[e.images.length]),R.useEffect(()=>{const x=r.current;if(!x||u.length<=e.images.length)return;const y=()=>{const E=x.scrollWidth;if(!E)return;const w=E/3;x.scrollLeft<=w*.1?x.scrollLeft+=w:x.scrollLeft>=w*1.9&&(x.scrollLeft-=w)};return h(),x.addEventListener("scroll",y),window.addEventListener("resize",h),()=>{x.removeEventListener("scroll",y),window.removeEventListener("resize",h),s.current&&cancelAnimationFrame(s.current)}},[e.images.length,u.length,h]);const p=()=>{h()},g=x=>{const y=r.current;if(!y)return;const w=Math.min(y.clientWidth*.82,320)+16,S=x==="left"?y.scrollLeft-w:y.scrollLeft+w;y.scrollTo({left:S,behavior:"smooth"})};return f.jsxs("div",{className:ee("flex flex-col gap-4 pb-12 w-full",n),children:[f.jsxs("div",{className:"flex flex-col items-start w-full",children:[f.jsx("p",{className:"font-medium leading-normal text-gray-900 text-lg mb-4",children:e.title}),f.jsxs("div",{className:"flex flex-col md:flex-row font-normal gap-5 items-start text-base w-full",children:[f.jsxs("div",{className:"flex flex-col items-start w-[202px] flex-shrink-0",children:[f.jsx("p",{className:"text-gray-500 font-medium",children:e.location}),f.jsx("p",{className:"text-gray-400",children:e.date})]}),e.description&&f.jsx("p",{className:"font-normal leading-normal  text-gray-400 max-w-[366px] whitespace-pre-wrap",children:e.description})]})]}),f.jsx("div",{className:"bg-zinc-100 h-px shrink-0 w-full mb-2"}),f.jsxs("div",{className:"relative w-full",children:[f.jsx("div",{ref:r,className:"flex gap-4 items-center justify-start overflow-x-auto w-full scrollbar-hide pb-1",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:u.map((x,y)=>f.jsx(w6,{image:x,onLoad:p,onClick:()=>t?.(x)},`${x.id}-${y}`))}),f.jsx("button",{onClick:()=>g("left"),disabled:!i,className:ee("absolute top-1/2 left-0 -translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",i?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll left",children:f.jsx(nw,{className:"size-5"})}),f.jsx("button",{onClick:()=>g("right"),disabled:!l,className:ee("absolute top-1/2 right-0 translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",l?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll right",children:f.jsx(sw,{className:"size-5"})})]})]})}const S6=`
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-up {
  animation: fadeUp 400ms ease-out forwards;
}
`;function Uf({text:n,active:e=!1,onClick:t}){return f.jsx("button",{onClick:t,className:ee("content-stretch flex items-center justify-center px-4 pt-[5px] pb-[3px] relative rounded-full shrink-0 cursor-pointer transition-all duration-100 ease-out border border-transparent",!e&&"hover:bg-gray-200/40 hover:pt-[3px] hover:pb-[1px] hover:my-[2px]",e&&"bg-gray-200/60 backdrop-blur-md shadow-[0_2px_8px_rgba(0,0,0,0.06),inset_0_1px_1px_rgba(255,255,255,0.9),inset_0_-1px_1px_rgba(0,0,0,0.02)] !border-white/50"),children:f.jsx("p",{className:ee("font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-lg text-nowrap",e?"text-[#4b5563]":"text-[#9ca3af]"),children:n})})}function Bf(n){return n.map(e=>{const r=[e.medium,e.size,e.year].filter(Boolean).join(", ");return{id:e._id,imageSrc:e.image?at(e.image).width(800).url():"",title:e.title,metadata:r||void 0}})}function T6(n){return n.map(e=>({id:e._id,title:e.title,sidebarLabel:e.sidebarLabel,date:e.date,images:e.images?.map(t=>({id:t._key,imageSrc:t.asset?at(t).height(600).url():""}))||[]}))}function _6(n){return n.map(e=>({id:e._id,title:e.title,sidebarLabel:e.sidebarLabel,location:e.location,date:e.date,description:e.description,images:e.images?.map(t=>({id:t._key,imageSrc:t.asset?at(t).height(600).url():""}))||[]}))}function k6(n){const e={painting:[],conceptual:[],graphite:[]};return n.forEach(t=>{t.artType&&e[t.artType]&&e[t.artType].push(t)}),e}function C6(){const n=Nn(),[e,t]=R.useState("painting"),[r,s]=R.useState(void 0),[i,a]=R.useState(void 0),[l,d]=R.useState(()=>sessionStorage.getItem("heroAnimationPlayed")==="true");R.useEffect(()=>{if(!l){const X=setTimeout(()=>{sessionStorage.setItem("heroAnimationPlayed","true"),d(!0)},500);return()=>clearTimeout(X)}},[l]);const u=R.useRef(null),h=R.useRef(null),p=R.useRef(null),g=R.useRef(null),x=R.useRef(null),y=R.useRef([]),E=R.useRef([]),[w,S]=R.useState({painting:[],conceptual:[],graphite:[]}),[T,k]=R.useState([]),[I,L]=R.useState([]),[O,P]=R.useState(!0),[j,F]=R.useState(null);R.useEffect(()=>{async function X(){try{P(!0),F(null);const Z=nt("art:pieces"),ie=nt("art:sketchbooks"),G=nt("art:murals"),[Q,W,N]=await Promise.all([Z??xt.fetch(qE),ie??xt.fetch(KE),G??xt.fetch(zE)]),U=k6(Q||[]);S({painting:Bf(U.painting),conceptual:Bf(U.conceptual),graphite:Bf(U.graphite)}),k(T6(W||[])),L(_6(N||[]))}catch(Z){console.error("Error fetching art data:",Z),F("Failed to load art content. Please try again later.")}finally{P(!1)}}X()},[]);const D=X=>{t(X),X==="sketchbook"?(s(0),a(void 0)):X==="murals"?(a(0),s(void 0)):(s(void 0),a(void 0));const ie={painting:u,conceptual:h,graphite:p,sketchbook:g,murals:x}[X];ie?.current&&ie.current.scrollIntoView({behavior:"smooth",block:"start"})},$=X=>{t("sketchbook"),s(X),a(void 0);const Z=y.current[X];Z&&Z.scrollIntoView({behavior:"smooth",block:"start"})},J=X=>{t("murals"),a(X),s(void 0);const Z=E.current[X];Z&&Z.scrollIntoView({behavior:"smooth",block:"start"})};R.useEffect(()=>{const X=()=>{const Z=[{id:"painting",ref:u},{id:"conceptual",ref:h},{id:"graphite",ref:p},{id:"sketchbook",ref:g},{id:"murals",ref:x}],ie=250;let G=null;for(let Q=Z.length-1;Q>=0;Q--){const W=Z[Q];if(W.ref.current&&W.ref.current.getBoundingClientRect().top<=ie){G=W.id;break}}if(!G){for(const Q of Z)if(Q.ref.current){const W=Q.ref.current.getBoundingClientRect();if(W.top<window.innerHeight&&W.bottom>0){G=Q.id;break}}}if(G)if(t(G),G==="sketchbook"){let Q=0;for(let W=y.current.length-1;W>=0;W--){const N=y.current[W];if(N&&N.getBoundingClientRect().top<=ie){Q=W;break}}s(Q),a(void 0)}else if(G==="murals"){let Q=0;for(let W=E.current.length-1;W>=0;W--){const N=E.current[W];if(N&&N.getBoundingClientRect().top<=ie){Q=W;break}}a(Q),s(void 0)}else s(void 0),a(void 0)};return window.addEventListener("scroll",X),X(),()=>window.removeEventListener("scroll",X)},[T.length,I.length]);const ne=X=>{console.log("Art item clicked:",X)},se={painting:w.painting.length,conceptual:w.conceptual.length,graphite:w.graphite.length,sketchbook:T.length,murals:I.length};return f.jsxs("div",{className:"bg-white flex flex-col items-center relative size-full min-h-screen",children:[f.jsx("style",{children:S6}),f.jsx(g0,{variant:"art",heroAnimationPlayed:l,nameAddon:f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal text-gray-500 text-xl whitespace-pre-wrap",children:"b. 2004"}),children:f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"mb-0",children:"Currently based in Los Angeles, CA."}),f.jsx("p",{children:"Also in between San Francisco & New York City."})]})}),f.jsxs("div",{className:"content-stretch flex flex-col items-center pb-6 pt-0 px-0 relative shrink-0 w-full",children:[f.jsx(De,{variant:"fade",delay:280,rootMargin:"0px",className:"relative shrink-0 w-full",disabled:l,children:f.jsx("div",{className:"size-full",children:f.jsx("div",{className:"content-stretch flex flex-col gap-3 items-start pb-0 pt-4 px-16 max-md:px-8 relative w-full",children:f.jsxs("div",{className:"content-stretch flex gap-1 items-start relative shrink-0",children:[f.jsx(Uf,{text:"Work",onClick:()=>n("/")}),f.jsx(Uf,{text:"Art",active:!0}),f.jsx(Uf,{text:"About",onClick:()=>n("/about")})]})})})}),f.jsx("div",{className:"px-16 max-md:px-8 w-full pt-3",children:f.jsx("div",{className:"bg-zinc-100 h-px shrink-0 w-full"})})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start px-16 max-md:px-8 pt-2 relative shrink-0 w-full",children:[f.jsx("div",{className:"hidden lg:block lg:sticky lg:top-8 pb-8 w-[202px] shrink-0",children:f.jsx(v6,{activeCategory:e,onCategoryClick:D,counts:se,sketchbookLabels:T.map(X=>X.sidebarLabel||X.title.split(" ")[0].toUpperCase()),sketchbookImageCounts:T.map(X=>X.images.length),activeSketchbookIndex:r,onSketchbookClick:$,muralLabels:I.map(X=>X.sidebarLabel||X.title.split(" ")[0].toUpperCase()),activeMuralIndex:i,onMuralClick:J})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-12 items-start justify-center pb-8 min-w-0 w-full",children:[O&&f.jsx("div",{className:"flex items-center justify-center w-full py-20",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),f.jsx("p",{className:"text-gray-400 text-base",children:"Loading artwork..."})]})}),j&&!O&&f.jsx("div",{className:"flex items-center justify-center w-full py-20",children:f.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[f.jsx("p",{className:"text-gray-600 text-base",children:j}),f.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 text-sm transition-colors",children:"Try Again"})]})}),!O&&!j&&f.jsxs(f.Fragment,{children:[f.jsxs("section",{ref:u,className:"flex flex-col gap-4 items-start w-full",children:[f.jsx(De,{variant:"fade",className:"w-full",children:f.jsx(Va,{text:"Painting"})}),w.painting.length>0?f.jsx(De,{delay:120,children:f.jsx(Ff,{items:w.painting,onItemClick:ne})}):f.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No paintings yet."})]}),f.jsxs("section",{ref:h,className:"flex flex-col gap-4 items-start w-full",children:[f.jsx(De,{variant:"fade",className:"w-full",children:f.jsx(Va,{text:"Conceptual"})}),w.conceptual.length>0?f.jsx(De,{delay:120,children:f.jsx(Ff,{items:w.conceptual,onItemClick:ne})}):f.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No conceptual pieces yet."})]}),f.jsxs("section",{ref:p,className:"flex flex-col gap-4 items-start w-full",children:[f.jsx(De,{variant:"fade",className:"w-full",children:f.jsx(Va,{text:"Graphite"})}),w.graphite.length>0?f.jsx(De,{delay:120,children:f.jsx(Ff,{items:w.graphite,onItemClick:ne})}):f.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No graphite drawings yet."})]}),f.jsxs("section",{ref:g,className:"flex flex-col gap-4 items-start w-full",children:[f.jsx(De,{variant:"fade",className:"w-full",children:f.jsx(Va,{className:"-mb-4",text:"Sketchbook"})}),T.length>0?f.jsx("div",{className:"flex flex-col gap-8 py-8 w-full",children:T.map((X,Z)=>f.jsx(De,{delay:Z*120,children:f.jsx("div",{ref:ie=>{y.current[Z]=ie},children:f.jsx(E6,{data:X})})},X.id))}):f.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No sketchbooks yet."})]}),f.jsxs("section",{ref:x,className:"flex flex-col gap-4 items-start w-full",children:[f.jsx(De,{variant:"fade",className:"w-full",children:f.jsx(Va,{className:"-mb-4",text:"Murals"})}),I.length>0?f.jsx("div",{className:"flex flex-col gap-8 py-8 w-full",children:I.map((X,Z)=>f.jsx(De,{delay:Z*120,children:f.jsx("div",{ref:ie=>{E.current[Z]=ie},children:f.jsx(b6,{data:X})})},X.id))}):f.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No murals yet."})]})]})]})]}),f.jsx(Kc,{})]})}function I6({text:n,underlinedText:e,isRevealed:t}){if(!e||!n.includes(e))return f.jsx(f.Fragment,{children:n});const r=n.indexOf(e),s=n.slice(0,r),i=n.slice(r+e.length);return f.jsxs(f.Fragment,{children:[s,f.jsx("span",{className:"quote-underline-wrapper",children:f.jsx("span",{className:ee("quote-animated-underline",t&&"revealed"),children:e})}),i]})}function Sh({className:n,data:e,variant:t="default",aspectRatio:r,onClick:s,topRow:i=!1}){const a=e?.type||"Book",l=!!e?.imageSrc,d=r?r==="square":a==="Music",u=R.useRef(null),[h,p]=R.useState(!1);if(R.useEffect(()=>{if(a!=="Quote")return;const P=u.current;if(!P)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){p(!0);return}const F=new IntersectionObserver(D=>{D.forEach($=>{$.isIntersecting&&(setTimeout(()=>{p(!0)},400),F.unobserve(P))})},{threshold:.3,rootMargin:"0px"});return F.observe(P),()=>F.disconnect()},[a]),a==="Quote")return f.jsx("div",{ref:u,className:ee("flex h-full min-h-[260px] md:min-h-[280px] flex-col items-start overflow-hidden rounded-3xl border border-gray-100 bg-white transition-shadow duration-200","shadow-[0px_4px_16px_0px_rgba(209,213,219,0.65)]","md:rounded-3xl",n),children:f.jsxs("div",{className:ee("flex w-full flex-col gap-4 px-12 pb-12 md:gap-4 md:px-12 md:pb-12",i?"pt-14 md:pt-18":"pt-14 md:pt-14"),children:[e?.emoji&&f.jsx("p",{className:"font-['Figtree'] text-4xl",children:e.emoji}),e?.quoteTitle&&f.jsx("p",{className:"whitespace-pre-wrap font-['Figtree'] -mb-1 text-2xl tracking-[0.01em] font-medium text-gray-700",children:e.quoteTitle}),f.jsxs("div",{className:"flex flex-col items-start text-base md:text-base",children:[e?.quoteText&&f.jsx("p",{className:"font-['Figtree'] font-normal text-gray-500 mb-0.5",children:f.jsx(I6,{text:e.quoteText,underlinedText:e.quoteUnderlinedText,isRevealed:h})}),e?.quoteAuthor&&f.jsx("p",{className:"font-['Figtree'] font-normal text-gray-400",children:e.quoteAuthor})]})]})});const x=(()=>{if(a==="Book"&&e?.goodreadsUrl)return e.goodreadsUrl;if(a==="Music"&&e?.spotifyUrl)return e.spotifyUrl;if(a==="Movie"&&e?.letterboxdSlug)return`https://letterboxd.com/liumichelle/film/${e.letterboxdSlug}/`})(),[y,E]=R.useState(!1),[w,S]=R.useState(!1);R.useEffect(()=>{E(!1),S(!1)},[e?.imageSrc]);const T=R.useCallback(()=>{E(!0)},[]),k=R.useCallback(()=>{S(!0)},[]),I=l&&!y&&!w,L=ee("relative overflow-hidden transition-transform hover:scale-[1.01]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",d?"aspect-square":"aspect-[210/310]",t==="default"&&"rounded-xl md:rounded-md",t==="expanded"&&"rounded-lg md:rounded-md",!l&&"bg-gray-300",x?"cursor-pointer":"",n),O=f.jsxs(f.Fragment,{children:[I&&f.jsx("div",{className:"absolute inset-0 animate-shimmer transition-opacity duration-500 ease-out"}),l&&f.jsx("img",{src:e.imageSrc,alt:e.title||"Media cover",className:ee("absolute inset-0 h-full w-full object-cover transition-opacity duration-500 ease-out",y?"opacity-100":"opacity-0"),loading:"lazy",onLoad:T,onError:k})]});return x?f.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:ee(L,"block"),title:e?.title,"aria-label":e?.title||"Media item",children:O}):f.jsx("button",{onClick:s,className:L,title:e?.title,"aria-label":e?.title||"Media item",children:O})}function A6({className:n,data:e,onClick:t}){const r=!!e.imageSrc,s=e.imageBackground||"#e3dff4",i=()=>{e.link?window.open(e.link,"_blank","noopener,noreferrer"):t&&t()};return f.jsxs("button",{onClick:i,className:ee("group flex w-full flex-col items-start text-left","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",n),children:[f.jsx("div",{className:"relative h-[140px] md:h-[200px] w-full shrink-0 rounded-2xl sm:rounded-3xl",children:r?f.jsx("img",{src:e.imageSrc,alt:e.headline,className:"absolute inset-0 h-full w-full rounded-2xl sm:rounded-3xl object-cover transition-transform duration-200 ease-out group-hover:scale-[1.01]",loading:"lazy"}):f.jsx("div",{className:"h-full w-full transition-transform duration-200 ease-out group-hover:scale-[1.01]",style:{backgroundColor:s}})}),f.jsxs("div",{className:"flex w-full flex-col px-1 font-['Figtree',sans-serif] pt-2 font-medium text-base",children:[f.jsxs("div",{className:"flex w-full items-start justify-between",children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:gap-1 md:items-center md:flex-wrap",children:[f.jsx("span",{className:"text-gray-600 text-base md:text-lg",children:e.headline}),e.date&&f.jsxs(f.Fragment,{children:[f.jsxs("span",{className:"hidden md:inline text-gray-500 text-sm font-normal md:text-base",children:["  ",e.date]}),f.jsx("span",{className:"md:hidden text-gray-500 font-normal text-sm",children:e.date})]})]}),f.jsx("span",{className:"text-gray-700 text-sm opacity-100 md:opacity-0 transition-opacity duration-200 ease-out md:group-hover:opacity-100",children:f.jsx(ms,{})})]}),e.description&&f.jsx("p",{className:"whitespace-pre-wrap font-normal text-sm sm:text-base text-gray-400 md:opacity-0 md:translate-y-1 md:transition-all md:duration-300 md:ease-out md:group-hover:opacity-100 md:group-hover:translate-y-0",children:e.description})]})]})}function L6({className:n,data:e}){const t=e.photos||[],[r,s]=R.useState(null),i=[11,-2,-11,-9],a=r?t.find(l=>l.id===r):null;return bo(!!r),R.useEffect(()=>{const l=d=>{d.key==="Escape"&&r&&s(null)};return r&&document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}},[r]),f.jsxs("div",{className:ee("flex w-full flex-col gap-12 py-2",n),children:[f.jsxs("div",{className:"flex w-full shrink-0 flex-col gap-6 lg:hidden",children:[e.logoSrc&&f.jsx("div",{className:"relative h-16 w-16 shrink-0",children:f.jsx("img",{src:e.logoSrc,alt:`${e.title} logo`,className:"h-full w-full object-contain"})}),f.jsxs("div",{className:"flex w-full max-w-lg flex-col gap-4 whitespace-pre-wrap font-normal leading-[1.2]",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h3",{className:"text-xl font-medium text-gray-600",children:e.title}),e.instagramUrl&&f.jsx("a",{href:e.instagramUrl,target:"_blank",rel:"noopener noreferrer",className:"flex h-6 w-6 items-center justify-center text-gray-500 transition-colors hover:text-gray-700","aria-label":`${e.title} Instagram`,children:f.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("path",{d:"M10 1.80078C12.6719 1.80078 12.9883 1.8125 14.0391 1.85937C15.0156 1.90234 15.543 2.06641 15.8945 2.20313C16.3594 2.38281 16.6953 2.60156 17.043 2.94922C17.3945 3.30078 17.6094 3.63281 17.7891 4.09766C17.9258 4.44922 18.0898 4.98047 18.1328 5.95313C18.1797 7.00781 18.1914 7.32422 18.1914 9.99219C18.1914 12.6641 18.1797 12.9805 18.1328 14.0313C18.0898 15.0078 17.9258 15.5352 17.7891 15.8867C17.6094 16.3516 17.3906 16.6875 17.043 17.0352C16.6914 17.3867 16.3594 17.6016 15.8945 17.7813C15.543 17.918 15.0117 18.082 14.0391 18.125C12.9844 18.1719 12.668 18.1836 10 18.1836C7.32813 18.1836 7.01172 18.1719 5.96094 18.125C4.98438 18.082 4.45703 17.918 4.10547 17.7813C3.64063 17.6016 3.30469 17.3828 2.95703 17.0352C2.60547 16.6836 2.39063 16.3516 2.21094 15.8867C2.07422 15.5352 1.91016 15.0039 1.86719 14.0313C1.82031 12.9766 1.80859 12.6602 1.80859 9.99219C1.80859 7.32031 1.82031 7.00391 1.86719 5.95313C1.91016 4.97656 2.07422 4.44922 2.21094 4.09766C2.39063 3.63281 2.60938 3.29687 2.95703 2.94922C3.30859 2.59766 3.64063 2.38281 4.10547 2.20313C4.45703 2.06641 4.98828 1.90234 5.96094 1.85937C7.01172 1.8125 7.32813 1.80078 10 1.80078ZM10 0C7.28516 0 6.94531 0.0117188 5.87891 0.0585938C4.81641 0.105469 4.08594 0.277344 3.45313 0.523437C2.79297 0.78125 2.23438 1.12109 1.67969 1.67969C1.12109 2.23438 0.78125 2.79297 0.523438 3.44922C0.277344 4.08594 0.105469 4.8125 0.0585938 5.875C0.0117188 6.94531 0 7.28516 0 10C0 12.7148 0.0117188 13.0547 0.0585938 14.1211C0.105469 15.1836 0.277344 15.9141 0.523438 16.5469C0.78125 17.207 1.12109 17.7656 1.67969 18.3203C2.23438 18.875 2.79297 19.2188 3.44922 19.4727C4.08594 19.7188 4.8125 19.8906 5.875 19.9375C6.94141 19.9844 7.28125 19.9961 9.99609 19.9961C12.7109 19.9961 13.0508 19.9844 14.1172 19.9375C15.1797 19.8906 15.9102 19.7188 16.543 19.4727C17.1992 19.2188 17.7578 18.875 18.3125 18.3203C18.8672 17.7656 19.2109 17.207 19.4648 16.5508C19.7109 15.9141 19.8828 15.1875 19.9297 14.125C19.9766 13.0586 19.9883 12.7188 19.9883 10.0039C19.9883 7.28906 19.9766 6.94922 19.9297 5.88281C19.8828 4.82031 19.7109 4.08984 19.4648 3.45703C19.2188 2.79297 18.8789 2.23438 18.3203 1.67969C17.7656 1.125 17.207 0.78125 16.5508 0.527344C15.9141 0.28125 15.1875 0.109375 14.125 0.0625C13.0547 0.0117188 12.7148 0 10 0Z",fill:"currentColor"}),f.jsx("path",{d:"M10 4.86328C7.16406 4.86328 4.86328 7.16406 4.86328 10C4.86328 12.8359 7.16406 15.1367 10 15.1367C12.8359 15.1367 15.1367 12.8359 15.1367 10C15.1367 7.16406 12.8359 4.86328 10 4.86328ZM10 13.332C8.16016 13.332 6.66797 11.8398 6.66797 10C6.66797 8.16016 8.16016 6.66797 10 6.66797C11.8398 6.66797 13.332 8.16016 13.332 10C13.332 11.8398 11.8398 13.332 10 13.332Z",fill:"currentColor"}),f.jsx("path",{d:"M16.5391 4.66016C16.5391 5.32422 16 5.85938 15.3398 5.85938C14.6758 5.85938 14.1406 5.32031 14.1406 4.66016C14.1406 3.99609 14.6797 3.46094 15.3398 3.46094C16 3.46094 16.5391 4 16.5391 4.66016Z",fill:"currentColor"})]})})]}),e.description&&f.jsx("p",{className:"text-sm text-gray-400",children:e.description})]})]}),f.jsxs("div",{className:"hidden w-full items-start py-8 justify-between gap-12 lg:flex",children:[f.jsxs("div",{className:"flex shrink-0 items-center gap-4 xl:gap-8",children:[e.logoSrc&&f.jsx("div",{className:"relative h-[90px] w-[90px] shrink-0",children:f.jsx("img",{src:e.logoSrc,alt:`${e.title} logo`,className:"h-full w-full object-contain"})}),f.jsx("h3",{className:"text-2xl font-medium leading-[1.4] text-gray-600",children:e.title}),e.instagramUrl&&f.jsx("a",{href:e.instagramUrl,target:"_blank",rel:"noopener noreferrer",className:"flex h-6 w-6 items-center justify-center text-gray-400 transition-colors hover:text-gray-500","aria-label":`${e.title} Instagram`,children:f.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("path",{d:"M10 1.80078C12.6719 1.80078 12.9883 1.8125 14.0391 1.85937C15.0156 1.90234 15.543 2.06641 15.8945 2.20313C16.3594 2.38281 16.6953 2.60156 17.043 2.94922C17.3945 3.30078 17.6094 3.63281 17.7891 4.09766C17.9258 4.44922 18.0898 4.98047 18.1328 5.95313C18.1797 7.00781 18.1914 7.32422 18.1914 9.99219C18.1914 12.6641 18.1797 12.9805 18.1328 14.0313C18.0898 15.0078 17.9258 15.5352 17.7891 15.8867C17.6094 16.3516 17.3906 16.6875 17.043 17.0352C16.6914 17.3867 16.3594 17.6016 15.8945 17.7813C15.543 17.918 15.0117 18.082 14.0391 18.125C12.9844 18.1719 12.668 18.1836 10 18.1836C7.32813 18.1836 7.01172 18.1719 5.96094 18.125C4.98438 18.082 4.45703 17.918 4.10547 17.7813C3.64063 17.6016 3.30469 17.3828 2.95703 17.0352C2.60547 16.6836 2.39063 16.3516 2.21094 15.8867C2.07422 15.5352 1.91016 15.0039 1.86719 14.0313C1.82031 12.9766 1.80859 12.6602 1.80859 9.99219C1.80859 7.32031 1.82031 7.00391 1.86719 5.95313C1.91016 4.97656 2.07422 4.44922 2.21094 4.09766C2.39063 3.63281 2.60938 3.29687 2.95703 2.94922C3.30859 2.59766 3.64063 2.38281 4.10547 2.20313C4.45703 2.06641 4.98828 1.90234 5.96094 1.85937C7.01172 1.8125 7.32813 1.80078 10 1.80078ZM10 0C7.28516 0 6.94531 0.0117188 5.87891 0.0585938C4.81641 0.105469 4.08594 0.277344 3.45313 0.523437C2.79297 0.78125 2.23438 1.12109 1.67969 1.67969C1.12109 2.23438 0.78125 2.79297 0.523438 3.44922C0.277344 4.08594 0.105469 4.8125 0.0585938 5.875C0.0117188 6.94531 0 7.28516 0 10C0 12.7148 0.0117188 13.0547 0.0585938 14.1211C0.105469 15.1836 0.277344 15.9141 0.523438 16.5469C0.78125 17.207 1.12109 17.7656 1.67969 18.3203C2.23438 18.875 2.79297 19.2188 3.44922 19.4727C4.08594 19.7188 4.8125 19.8906 5.875 19.9375C6.94141 19.9844 7.28125 19.9961 9.99609 19.9961C12.7109 19.9961 13.0508 19.9844 14.1172 19.9375C15.1797 19.8906 15.9102 19.7188 16.543 19.4727C17.1992 19.2188 17.7578 18.875 18.3125 18.3203C18.8672 17.7656 19.2109 17.207 19.4648 16.5508C19.7109 15.9141 19.8828 15.1875 19.9297 14.125C19.9766 13.0586 19.9883 12.7188 19.9883 10.0039C19.9883 7.28906 19.9766 6.94922 19.9297 5.88281C19.8828 4.82031 19.7109 4.08984 19.4648 3.45703C19.2188 2.79297 18.8789 2.23438 18.3203 1.67969C17.7656 1.125 17.207 0.78125 16.5508 0.527344C15.9141 0.28125 15.1875 0.109375 14.125 0.0625C13.0547 0.0117188 12.7148 0 10 0Z",fill:"currentColor"}),f.jsx("path",{d:"M10 4.86328C7.16406 4.86328 4.86328 7.16406 4.86328 10C4.86328 12.8359 7.16406 15.1367 10 15.1367C12.8359 15.1367 15.1367 12.8359 15.1367 10C15.1367 7.16406 12.8359 4.86328 10 4.86328ZM10 13.332C8.16016 13.332 6.66797 11.8398 6.66797 10C6.66797 8.16016 8.16016 6.66797 10 6.66797C11.8398 6.66797 13.332 8.16016 13.332 10C13.332 11.8398 11.8398 13.332 10 13.332Z",fill:"currentColor"}),f.jsx("path",{d:"M16.5391 4.66016C16.5391 5.32422 16 5.85938 15.3398 5.85938C14.6758 5.85938 14.1406 5.32031 14.1406 4.66016C14.1406 3.99609 14.6797 3.46094 15.3398 3.46094C16 3.46094 16.5391 4 16.5391 4.66016Z",fill:"currentColor"})]})})]}),e.description&&f.jsx("p",{className:"max-w-xs xl:max-w-sm mr-12 shrink-0 whitespace-pre-wrap text-base font-normal leading-[1.4] text-gray-400",children:e.description})]}),t.length>0&&f.jsxs("div",{className:"relative w-full shrink-0 px-4",children:[f.jsx("div",{className:"flex w-full flex-col items-center gap-10 lg:hidden",children:t.slice(0,4).map((l,d)=>{const u=l.rotation??i[d]??0,h=l.orientation==="vertical";return f.jsx("div",{className:"relative cursor-pointer",onClick:()=>s(l.id),children:f.jsxs("div",{className:"relative flex flex-col gap-1",style:{transform:`rotate(${u}deg)`},children:[f.jsxs("div",{className:"relative transition-transform duration-200 hover:scale-[1.01]",children:[f.jsx("div",{className:"absolute -inset-2 rounded-sm border border-gray-100 bg-white shadow-[0px_4px_8px_0px_rgba(0,0,0,0.15)]"}),f.jsx("div",{className:ee("relative overflow-hidden rounded-sm",h?"h-52 w-44":"h-44 w-52"),children:f.jsx("img",{src:l.imageSrc,alt:l.caption||"Community photo",className:"h-full w-full object-cover",loading:"lazy"})})]}),l.caption&&f.jsx("p",{className:ee("mt-3 font-['DM_Sans'] text-sm font-normal text-gray-500",h?"w-44":"w-52"),style:{fontVariationSettings:"'opsz' 9"},children:l.caption})]})},l.id)})}),f.jsx("div",{className:"hidden lg:grid xl:hidden grid-cols-2 gap-8 justify-items-center",children:t.slice(0,4).map((l,d)=>{const u=l.rotation??i[d]??0,h=l.orientation==="vertical";return f.jsx("div",{className:"relative cursor-pointer",onClick:()=>s(l.id),children:f.jsxs("div",{className:"relative flex flex-col gap-1",style:{transform:`rotate(${u}deg)`},children:[f.jsxs("div",{className:"relative transition-transform duration-200 hover:scale-[1.01]",children:[f.jsx("div",{className:"absolute -inset-2 rounded-sm border border-gray-100 bg-white shadow-[0px_4px_8px_0px_rgba(0,0,0,0.15)]"}),f.jsx("div",{className:ee("relative overflow-hidden rounded-sm",h?"h-56 w-48":"h-48 w-56"),children:f.jsx("img",{src:l.imageSrc,alt:l.caption||"Community photo",className:"h-full w-full object-cover",loading:"lazy"})})]}),l.caption&&f.jsx("p",{className:ee("mt-3 font-['DM_Sans'] text-sm font-normal text-gray-500",h?"w-48":"w-56"),style:{fontVariationSettings:"'opsz' 9"},children:l.caption})]})},l.id)})}),f.jsx("div",{className:"hidden h-[400px] w-full items-start justify-center xl:flex",children:t.slice(0,4).map((l,d)=>{const u=l.rotation??i[d]??0,h=l.orientation==="vertical",p=parseInt(l.yOffset||"0",10)*4,g=parseInt(l.xOffset||"0",10)*4,x=["","-ml-2","-ml-2","-ml-2"];return f.jsx("div",{className:ee("cursor-pointer",x[d]),style:{transform:`translate(${g}px, ${p}px)`},onClick:()=>s(l.id),children:f.jsxs("div",{className:"relative flex flex-col gap-1",style:{transform:`rotate(${u}deg)`},children:[f.jsxs("div",{className:"relative transition-transform duration-200 hover:scale-[1.01]",children:[f.jsx("div",{className:"absolute -inset-2 rounded-sm border border-gray-100 bg-white shadow-[0px_4px_8px_0px_rgba(0,0,0,0.15)]"}),f.jsx("div",{className:ee("relative overflow-hidden rounded-sm",h?"h-72 w-60":"h-60 w-72"),children:f.jsx("img",{src:l.imageSrc,alt:l.caption||"Community photo",className:"h-full w-full object-cover",loading:"lazy"})})]}),l.caption&&f.jsx("p",{className:ee("mt-2 font-['DM_Sans'] text-sm font-normal leading-tight text-gray-500",h?"w-60":"w-72"),style:{fontVariationSettings:"'opsz' 9"},children:l.caption})]})},l.id)})})]}),a&&a_.createPortal(f.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-[fadeIn_200ms_ease-out]",onClick:()=>s(null),children:[f.jsx("div",{className:"absolute inset-0 bg-gray-100/95"}),f.jsx("button",{onClick:l=>{l.stopPropagation(),s(null)},className:"fixed right-4 top-4 z-[10000] flex h-10 w-10 items-center justify-center transition-all duration-200 hover:scale-110 animate-[fadeSlideDown_300ms_ease-out]","aria-label":"Close expanded photo",children:f.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M1 1L13 13M1 13L13 1",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round"})})}),f.jsx("div",{className:"relative z-10 flex max-h-[85vh] max-w-[90vw] flex-col items-center animate-[scaleIn_300ms_ease-out]",onClick:l=>l.stopPropagation(),children:f.jsxs("div",{className:"relative flex flex-col items-center gap-1",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute -inset-3 rounded-sm border border-gray-100 bg-white shadow-[0px_8px_24px_0px_rgba(0,0,0,0.15)]"}),f.jsx("div",{className:ee("relative overflow-hidden rounded-sm",a.orientation==="vertical"?"h-[65vh] max-h-[500px] w-auto":"h-auto max-h-[55vh] w-[80vw] max-w-[600px]"),children:f.jsx("img",{src:a.imageSrc,alt:a.caption||"Community photo",className:"h-full w-full object-contain"})})]}),a.caption&&f.jsx("p",{className:"mt-6 max-w-[600px] text-center font-['DM_Sans'] text-base font-normal leading-relaxed text-gray-600 animate-[fadeSlideUp_300ms_ease-out_100ms_both]",style:{fontVariationSettings:"'opsz' 9"},children:a.caption})]})})]}),document.body)]})}function R6({className:n,data:e}){return f.jsxs("div",{className:ee("flex items-center gap-5 w-full",n),children:[f.jsx("div",{className:"relative h-20 w-20 shrink-0 overflow-hidden rounded-full md:h-24 md:w-24",children:e.logoSrc?f.jsx("img",{src:e.logoSrc,alt:`${e.company} logo`,className:"h-full w-full object-cover"}):f.jsx("div",{className:"h-full w-full bg-gray-200"})}),f.jsxs("div",{className:"flex flex-1 flex-col items-start",children:[f.jsx("p",{className:"whitespace-pre-wrap text-base text-lg font-medium leading-[1.4] text-gray-700",children:e.company}),f.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 text-base font-normal leading-[1.4]",children:[f.jsxs("span",{className:"text-gray-500",children:[e.role,e.period&&f.jsx("span",{className:"text-gray-400",children:","})]}),e.period&&f.jsx("span",{className:"text-gray-400 whitespace-nowrap",children:e.period})]})]})]})}const N6=[{id:"books",label:"Books"},{id:"music",label:"Music"},{id:"movies",label:"Movies"}];function D6({activeCategory:n,onCategoryClick:e,communityItems:t=[],activeCommunityId:r,onCommunityClick:s,activeShelfSubcategory:i,onShelfSubcategoryClick:a,shelfCounts:l}){const d=[{id:"hi",label:"Hi!"},{id:"experience",label:"Experience"}],u=n==="community",h=n==="shelf",p=t.filter(g=>g.sidebarName);return f.jsxs("nav",{className:"flex flex-col gap-3 items-start",children:[d.map(g=>f.jsx("button",{onClick:()=>e(g.id),className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",n===g.id?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:g.label})},g.id)),f.jsx("button",{onClick:()=>{e("community"),p.length>0&&s?.(p[0].id)},className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",u?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Community"})}),p.length>0&&f.jsx("div",{className:ee("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",u?"max-h-96 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:p.map(g=>{const x=r===g.id;return f.jsx("button",{onClick:()=>{e("community"),s?.(g.id)},className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 text-left transition-colors",x?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:g.sidebarName})},g.id)})}),f.jsx("button",{onClick:()=>e("philosophy"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",n==="philosophy"?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:"Philosophy"})}),f.jsx("button",{onClick:()=>{e("shelf"),a?.("books")},className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",h?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Shelf"})}),f.jsx("div",{className:ee("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",h?"max-h-40 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:N6.map(g=>{const x=i===g.id,y=l?.[g.id],E=y!==void 0&&y>0;return f.jsx("button",{onClick:()=>{e("shelf"),a?.(g.id)},className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:f.jsxs("span",{className:ee("text-base font-medium tracking-wide leading-5 text-left transition-colors",x?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:[g.label,E&&f.jsxs("span",{className:"text-gray-300 ml-1",children:["(",y,")"]})]})},g.id)})}),f.jsx("button",{onClick:()=>e("lore"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:f.jsx("span",{className:ee("text-base font-medium tracking-wide leading-5 transition-colors",n==="lore"?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:"Lore"})})]})}function $f({className:n,title:e,count:t,mediaType:r,yearFilters:s=[],activeYear:i,onYearChange:a,externalLink:l,items:d,itemCount:u=5,onItemClick:h}){const p=i?d.filter(I=>I.year===i):d.filter(I=>I.isFeatured),g=i?p:p.slice(0,u),x=r==="music",[y,E]=R.useState(0),w=i||"featured",[S,T]=R.useState(!1),k=R.useRef(null);return R.useEffect(()=>{function I(L){k.current&&!k.current.contains(L.target)&&T(!1)}return S&&document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[S]),R.useEffect(()=>{E(I=>I+1)},[w]),f.jsxs("div",{className:ee("flex w-full flex-col gap-1",n),children:[f.jsxs("div",{className:"relative flex w-full flex-col py-4",children:[f.jsxs("div",{className:"flex items-center pb-2",children:[s.length>0&&f.jsxs("div",{className:"relative lg:hidden shrink-0",ref:k,children:[f.jsxs("button",{onClick:()=>T(!S),className:ee("flex shrink-0 items-center gap-1.5 rounded-full px-3 py-1 transition-colors cursor-pointer","bg-gray-500/10"),children:[f.jsx("span",{className:"font-['Figtree',sans-serif] font-semibold text-sm tracking-wide whitespace-nowrap text-gray-500",children:i?(()=>{const I=s.find(L=>L.year===i);return I?f.jsxs(f.Fragment,{children:[I.year,I.count!==void 0&&f.jsxs("span",{className:"text-gray-400",children:[" (",I.count,")"]})]}):i})():f.jsxs(f.Fragment,{children:[e,t!==void 0&&f.jsxs("span",{className:"text-gray-400",children:[" (",t,")"]})]})}),f.jsx("svg",{className:ee("w-3 h-3 text-gray-400 transition-transform duration-200",S&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),S&&f.jsx("div",{className:"absolute left-0 top-[calc(100%+4px)] bg-white rounded-lg shadow-lg border border-gray-100 z-[9999] min-w-[140px] animate-in fade-in slide-in-from-top-1 duration-200",children:f.jsxs("div",{className:"flex flex-col py-1.5 px-1.5",children:[f.jsx("button",{onClick:()=>{a?.(""),T(!1)},className:ee("flex items-center px-3 py-1.5 rounded-md transition-colors text-left",i?"hover:bg-gray-50":"bg-gray-100"),children:f.jsxs("span",{className:ee("font-['Figtree',sans-serif] font-semibold text-sm tracking-wide",i?"text-gray-400":"text-gray-600"),children:[e,t!==void 0&&f.jsxs("span",{className:i?"text-gray-300":"text-gray-400",children:[" (",t,")"]})]})}),s.map(I=>{const L=i===I.year;return f.jsx("button",{onClick:()=>{a?.(I.year),T(!1)},className:ee("flex items-center px-3 py-1.5 rounded-md transition-colors text-left",L?"bg-gray-100":"hover:bg-gray-50"),children:f.jsxs("span",{className:ee("font-['Figtree',sans-serif] font-semibold text-sm tracking-wide",L?"text-gray-600":"text-gray-400"),children:[I.year,I.count!==void 0&&f.jsxs("span",{className:L?"text-gray-400":"text-gray-300",children:[" ","(",I.count,")"]})]})},I.year)})]})})]}),s.length===0&&f.jsx("button",{onClick:()=>a?.(""),className:ee("flex lg:hidden shrink-0 items-center justify-center rounded-full px-3 py-1 transition-colors cursor-pointer",i?"hover:bg-gray-500/5":"bg-gray-500/10"),children:f.jsxs("span",{className:ee("font-['Figtree',sans-serif] font-semibold text-sm tracking-wide whitespace-nowrap",i?"text-gray-400":"text-gray-500"),children:[e,t!==void 0&&f.jsxs("span",{className:i?"text-gray-300":"text-gray-400",children:[" (",t,")"]})]})}),f.jsx("div",{className:"flex-1 lg:hidden"}),f.jsxs("div",{className:"hidden lg:flex items-center gap-1 min-w-0 overflow-hidden flex-1",children:[f.jsx("button",{onClick:()=>a?.(""),className:ee("flex shrink-0 items-center justify-center rounded-full px-3 py-1 transition-colors cursor-pointer",i?"hover:bg-gray-500/5":"bg-gray-500/10"),children:f.jsxs("span",{className:ee("font-['Figtree',sans-serif] font-semibold text-base tracking-wide whitespace-nowrap",i?"text-gray-400":"text-gray-500"),children:[e,t!==void 0&&f.jsxs("span",{className:i?"text-gray-300":"text-gray-400",children:[" (",t,")"]})]})}),s.map(I=>{const L=i===I.year;return f.jsx("button",{onClick:()=>a?.(I.year),className:ee("flex shrink-0 cursor-pointer items-center justify-center rounded-full px-3 py-1 transition-colors",L?"bg-gray-500/10":"hover:bg-gray-500/5"),children:f.jsxs("span",{className:ee("font-['Figtree',sans-serif] text-base font-semibold tracking-wide whitespace-nowrap",L?"text-gray-600":"text-gray-400"),children:[I.year,I.count!==void 0&&f.jsxs("span",{className:L?"text-gray-400":"text-gray-300",children:[" ","(",I.count,")"]})]})},I.year)})]}),l&&f.jsx("div",{className:"shrink-0 flex items-center pl-6 bg-gradient-to-r from-transparent to-white",children:f.jsx("a",{href:l.href,target:"_blank",rel:"noopener noreferrer",className:"cursor-pointer transition-colors bg-white",children:f.jsxs("span",{className:"font-['Figtree',sans-serif] text-sm md:text-base font-normal tracking-wide text-gray-400 hover:text-blue-500 transition-colors whitespace-nowrap",children:[l.label," ",f.jsx(ms,{})]})})})]}),f.jsx("div",{className:"h-px w-full bg-gray-200"})]}),f.jsx("div",{children:g.length>0?i?f.jsx("div",{className:"grid grid-cols-5 md:grid-cols-10 gap-2 md:gap-3 w-full py-2",children:g.map((I,L)=>f.jsx("div",{className:"animate-shelf-item-fade-up",style:{animationDelay:`${Math.min(L*20,200)}ms`},children:f.jsx(Sh,{data:I,variant:"default",aspectRatio:x?"square":"portrait",onClick:()=>h?.(I),className:"w-full"})},I.id||L))}):f.jsx("div",{className:"grid grid-cols-5 md:flex md:justify-center gap-2 md:gap-6 w-full py-2 lg:px-[118px]",children:g.map((I,L)=>f.jsx("div",{className:"animate-shelf-item-fade-up w-full md:flex-1 md:min-w-0",style:{animationDelay:`${L*50}ms`},children:f.jsx(Sh,{data:I,variant:"default",aspectRatio:x?"square":"portrait",onClick:()=>h?.(I),className:"w-full h-full"})},I.id||L))}):f.jsx("div",{className:"flex w-full items-start py-2 animate-shelf-item-fade-up",children:f.jsxs("p",{className:"text-gray-400 text-sm py-4",children:["No ",r,"s added yet. Add them in Sanity Studio."]})})},y)]})}const P6="/assets/Website%20Profile%20Pic-DPLDBdct.png",O6="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.69316%2014.9007C7.7133%2014.9124%207.72913%2014.9214%207.74034%2014.9277L7.75895%2014.9381C7.90753%2015.0196%208.09184%2015.019%208.24056%2014.9383L8.25966%2014.9277C8.27087%2014.9214%208.2867%2014.9124%208.30684%2014.9007C8.34711%2014.8774%208.40465%2014.8433%208.477%2014.7988C8.62164%2014.7097%208.82583%2014.5784%209.06974%2014.4061C9.55673%2014.0621%2010.2065%2013.5516%2010.8577%2012.8849C12.1538%2011.5579%2013.5%209.56411%2013.5%207C13.5%203.96243%2011.0376%201.5%208%201.5C4.96243%201.5%202.5%203.96243%202.5%207C2.5%209.56411%203.84622%2011.5579%205.1423%2012.8849C5.7935%2013.5516%206.44327%2014.0621%206.93026%2014.4061C7.17417%2014.5784%207.37836%2014.7097%207.523%2014.7988C7.59535%2014.8433%207.65289%2014.8774%207.69316%2014.9007ZM8%209C9.10457%209%2010%208.10457%2010%207C10%205.89543%209.10457%205%208%205C6.89543%205%206%205.89543%206%207C6%208.10457%206.89543%209%208%209Z'%20fill='%239CA3AF'/%3e%3c/svg%3e",j6="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.79888%201.87019C7.92652%201.81443%208.07162%201.81443%208.19926%201.87019C10.6785%202.95341%2013.0281%204.27758%2015.2187%205.81304C15.3772%205.92416%2015.4574%206.1168%2015.4244%206.30757C15.3915%206.49833%2015.2514%206.65294%2015.0648%206.70445C14.6081%206.83049%2014.1555%206.96623%2013.7069%207.1109C11.8862%207.69809%2010.1335%208.43692%208.46379%209.31252L8.46161%209.31366C8.3859%209.35337%208.31037%209.39336%208.23501%209.43362C8.08777%209.51229%207.91098%209.51229%207.76375%209.43362C7.68766%209.39297%207.6114%209.3526%207.53497%209.31252C6.70932%208.87956%205.86341%208.48004%204.99902%208.11576V7.96663C4.99902%207.87907%205.04397%207.80136%205.11351%207.75923C6.11692%207.15133%207.15194%206.59043%208.21551%206.07957C8.46443%205.96001%208.56929%205.6613%208.44973%205.41238C8.33017%205.16347%208.03145%205.0586%207.78254%205.17816C6.6897%205.70308%205.62626%206.27939%204.59535%206.90395C4.2931%207.08706%204.08991%207.38676%204.02307%207.72252C3.45312%207.50328%202.87568%207.29907%202.29122%207.11058C1.84267%206.96593%201.38998%206.83047%200.933386%206.70444C0.746773%206.65293%200.606664%206.49833%200.573717%206.30756C0.54077%206.11679%200.620906%205.92415%200.779432%205.81303C2.96999%204.27757%205.31967%202.95341%207.79888%201.87019Z'%20fill='%239CA3AF'/%3e%3cpath%20d='M8.70627%2010.3156C10.3322%209.44687%2012.0404%208.71245%2013.8162%208.12706C13.9057%209.07027%2013.9629%2010.0228%2013.9865%2010.9837C13.9916%2011.1898%2013.8696%2011.3779%2013.6793%2011.4574C11.7786%2012.251%209.9706%2013.2227%208.27632%2014.3518C8.1084%2014.4637%207.88968%2014.4637%207.72176%2014.3518C6.02747%2013.2227%204.21951%2012.251%202.31875%2011.4574C2.12846%2011.3779%202.00646%2011.1898%202.01154%2010.9837C2.03522%2010.0228%202.09236%209.07013%202.18187%208.12685C2.79587%208.32923%203.40179%208.54944%203.99902%208.78685V9.63378C3.70012%209.80669%203.49902%2010.1299%203.49902%2010.5C3.49902%2010.8302%203.65908%2011.123%203.90584%2011.3051C3.84616%2011.5589%203.75784%2011.8072%203.64087%2012.045C3.94267%2012.1874%204.24188%2012.3344%204.53842%2012.486C4.70731%2012.1425%204.82977%2011.7819%204.90579%2011.4138C5.25535%2011.258%205.49902%2010.9074%205.49902%2010.5C5.49902%2010.1299%205.29792%209.80669%204.99902%209.63378V9.20394C5.77996%209.54515%206.54492%209.91618%207.29248%2010.3156C7.7342%2010.5516%208.26455%2010.5516%208.70627%2010.3156Z'%20fill='%239CA3AF'/%3e%3cpath%20d='M2.97384%2012.9749C3.25326%2012.6954%203.4757%2012.3807%203.64087%2012.045C3.94267%2012.1874%204.24188%2012.3344%204.53842%2012.486C4.32605%2012.9179%204.04012%2013.3228%203.68095%2013.682C3.48568%2013.8772%203.1691%2013.8772%202.97384%2013.682C2.77858%2013.4867%202.77858%2013.1701%202.97384%2012.9749Z'%20fill='%239CA3AF'/%3e%3c/svg%3e",M6="data:image/svg+xml,%3csvg%20width='32'%20height='29'%20viewBox='0%200%2032%2029'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M15.5156%2028.6875C15.3594%2028.6875%2015.1719%2028.6406%2014.9531%2028.5469C14.7448%2028.4635%2014.5573%2028.3698%2014.3906%2028.2656C11.4531%2026.3906%208.90625%2024.4271%206.75%2022.375C4.59375%2020.3125%202.92708%2018.1979%201.75%2016.0312C0.583333%2013.8542%200%2011.6562%200%209.4375C0%208.05208%200.21875%206.78646%200.65625%205.64062C1.10417%204.48438%201.72396%203.48438%202.51562%202.64062C3.30729%201.79688%204.22917%201.14583%205.28125%200.6875C6.33333%200.229167%207.47396%200%208.70312%200C10.2344%200%2011.5781%200.390625%2012.7344%201.17188C13.8906%201.95312%2014.8177%202.98438%2015.5156%204.26562C16.224%202.97396%2017.1562%201.94271%2018.3125%201.17188C19.4688%200.390625%2020.8073%200%2022.3281%200C23.5573%200%2024.6979%200.229167%2025.75%200.6875C26.8125%201.14583%2027.7344%201.79688%2028.5156%202.64062C29.3073%203.48438%2029.9219%204.48438%2030.3594%205.64062C30.8073%206.78646%2031.0312%208.05208%2031.0312%209.4375C31.0312%2011.6562%2030.4427%2013.8542%2029.2656%2016.0312C28.099%2018.1979%2026.4375%2020.3125%2024.2812%2022.375C22.1354%2024.4271%2019.5938%2026.3906%2016.6562%2028.2656C16.4896%2028.3698%2016.2969%2028.4635%2016.0781%2028.5469C15.8698%2028.6406%2015.6823%2028.6875%2015.5156%2028.6875Z'%20fill='black'/%3e%3c/svg%3e",F6=`
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-up {
  animation: fadeUp 400ms ease-out forwards;
}
`;function Vf({text:n,active:e=!1,onClick:t}){return f.jsx("button",{onClick:t,className:ee("content-stretch flex items-center justify-center px-4 pt-[5px] pb-[3px] relative rounded-full shrink-0 cursor-pointer transition-all duration-100 ease-out border border-transparent",!e&&"hover:bg-gray-200/40 hover:pt-[3px] hover:pb-[1px] hover:my-[2px]",e&&"bg-gray-200/60 backdrop-blur-md shadow-[0_2px_8px_rgba(0,0,0,0.06),inset_0_1px_1px_rgba(255,255,255,0.9),inset_0_-1px_1px_rgba(0,0,0,0.02)] !border-white/50"),children:f.jsx("p",{className:ee("font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-lg text-nowrap",e?"text-[#4b5563]":"text-[#9ca3af]"),children:n})})}function U6({imageSrc:n,caption:e}){return f.jsxs("div",{className:"flex flex-col gap-3 w-72 md:w-76",children:[f.jsx("div",{className:"rounded-lg overflow-hidden",children:n?f.jsx("img",{src:n,alt:"Michelle Liu",className:"w-full h-auto rounded-lg"}):f.jsx("div",{className:"w-full aspect-[3/4] bg-gradient-to-br from-gray-200 to-gray-300 rounded-lg"})}),e&&f.jsx("div",{className:"px-6",children:f.jsx("p",{className:"text-sm text-gray-400 text-center",children:e})})]})}function B6(n){return n.map(e=>({id:e._id,logoSrc:e.logo?at(e.logo).width(200).url():void 0,company:e.company,role:e.role,period:e.period}))}function $6(n){return n.map(e=>({id:e._id,logoSrc:e.logo?at(e.logo).width(200).url():void 0,title:e.title,sidebarName:e.sidebarName,description:e.description,instagramUrl:e.instagramUrl,photos:e.photos?.map(t=>({id:t._key,imageSrc:t.image?at(t.image).width(1200).quality(90).url():"",caption:t.caption,rotation:t.rotation,orientation:t.orientation,yOffset:t.yOffset,xOffset:t.xOffset}))}))}function V6(n){return n.map(e=>({id:e._id,imageSrc:e.cover?at(e.cover).width(300).url():e.externalCoverUrl||void 0,title:e.title,type:e.mediaType==="book"?"Book":e.mediaType==="music"?"Music":e.mediaType==="movie"?"Movie":"Book",year:e.year,isFeatured:e.isFeatured,goodreadsUrl:e.goodreadsUrl,letterboxdSlug:e.letterboxdSlug,spotifyUrl:e.spotifyUrl}))}function G6(n){return n.map(e=>({id:e._id,imageSrc:e.image?at(e.image).width(600).url():void 0,imageBackground:e.imageBackground,headline:e.headline,date:e.date,description:e.description,link:e.link}))}function H6(n){return n.map(e=>({id:e._id,type:"Quote",emoji:e.emoji,quoteTitle:e.title,quoteText:e.text,quoteUnderlinedText:e.underlinedText,quoteAuthor:e.author}))}function q6(){const n=Nn(),[e,t]=R.useState(()=>sessionStorage.getItem("heroAnimationPlayed")==="true");R.useEffect(()=>{if(!e){const le=setTimeout(()=>{sessionStorage.setItem("heroAnimationPlayed","true"),t(!0)},500);return()=>clearTimeout(le)}},[e]);const[r,s]=R.useState("hi"),i=R.useRef(null),a=R.useRef(null),l=R.useRef(null),d=R.useRef(null),u=R.useRef(null),h=R.useRef(null),p=R.useRef({}),g=R.useRef(null),x=R.useRef(null),y=R.useRef(null),E=R.useRef(null),[w,S]=R.useState(!1),[T,k]=R.useState(),[I,L]=R.useState("books"),[O,P]=R.useState([]),[j,F]=R.useState([]),[D,$]=R.useState([]),[J,ne]=R.useState([]),[se,X]=R.useState([]),[Z,ie]=R.useState(!0),[G,Q]=R.useState(),[W,N]=R.useState(),[U,re]=R.useState();R.useEffect(()=>{async function le(){try{ie(!0);const Pe=nt("about:experiences"),we=nt("about:communities"),Fe=nt("about:shelfItems"),He=nt("about:quotes"),Ke=nt("about:loreItems"),[Ve,Xe,bt,On,dn]=await Promise.all([Pe??xt.fetch(YE),we??xt.fetch(QE),Fe??xt.fetch(XE),He??xt.fetch(JE),Ke??xt.fetch(ZE)]);P(B6(Ve||[])),F($6(Xe||[])),$(V6(bt||[])),ne(H6(On||[])),X(G6(dn||[]))}catch(Pe){console.error("Error fetching about data:",Pe)}finally{ie(!1)}}le()},[]),R.useEffect(()=>{if(j.length>0&&!T){const le=j.find(Pe=>Pe.sidebarName);le&&k(le.id)}},[j,T]),R.useEffect(()=>{const le=E.current;if(!le)return;const Pe=new IntersectionObserver(we=>{we.forEach(Fe=>{Fe.isIntersecting&&!w&&setTimeout(()=>{S(!0)},400)})},{threshold:.5});return Pe.observe(le),()=>{Pe.disconnect()}},[w]);const de=le=>{s(le);const we={hi:i,experience:a,community:l,philosophy:d,shelf:u,lore:h}[le];we?.current&&we.current.scrollIntoView({behavior:"smooth",block:"start"})},ue=le=>{k(le);const Pe=p.current[le];Pe?Pe.scrollIntoView({behavior:"smooth",block:"start"}):l?.current&&l.current.scrollIntoView({behavior:"smooth",block:"start"})},he=le=>{L(le);const we={books:g,music:x,movies:y}[le];we?.current&&we.current.scrollIntoView({behavior:"smooth",block:"start"})};R.useEffect(()=>{const le=()=>{const Pe=[{id:"hi",ref:i},{id:"experience",ref:a},{id:"community",ref:l},{id:"philosophy",ref:d},{id:"shelf",ref:u},{id:"lore",ref:h}],we=250;let Fe=null;for(let He=Pe.length-1;He>=0;He--){const Ke=Pe[He];if(Ke.ref.current&&Ke.ref.current.getBoundingClientRect().top<=we){Fe=Ke.id;break}}if(!Fe){for(const He of Pe)if(He.ref.current){const Ke=He.ref.current.getBoundingClientRect();if(Ke.top<window.innerHeight&&Ke.bottom>0){Fe=He.id;break}}}if(Fe){if(s(Fe),Fe==="community"){const He=j.filter(Ve=>Ve.sidebarName);let Ke=null;for(let Ve=He.length-1;Ve>=0;Ve--){const Xe=He[Ve],bt=p.current[Xe.id];if(bt&&bt.getBoundingClientRect().top<=we){Ke=Xe.id;break}}if(!Ke)for(const Ve of He){const Xe=p.current[Ve.id];if(Xe){const bt=Xe.getBoundingClientRect();if(bt.top<window.innerHeight&&bt.bottom>0){Ke=Ve.id;break}}}Ke&&k(Ke)}if(Fe==="shelf"){const He=[{id:"books",ref:g},{id:"music",ref:x},{id:"movies",ref:y}];let Ke=null;for(let Ve=He.length-1;Ve>=0;Ve--){const Xe=He[Ve];if(Xe.ref.current&&Xe.ref.current.getBoundingClientRect().top<=we){Ke=Xe.id;break}}if(!Ke){for(const Ve of He)if(Ve.ref.current){const Xe=Ve.ref.current.getBoundingClientRect();if(Xe.top<window.innerHeight&&Xe.bottom>0){Ke=Ve.id;break}}}Ke&&L(Ke)}}};return window.addEventListener("scroll",le),le(),()=>window.removeEventListener("scroll",le)},[j]);const pe=D.filter(le=>le.type==="Book"),ge=D.filter(le=>le.type==="Music"),Ne=D.filter(le=>le.type==="Movie"),Ge=le=>{const Pe={};return le.forEach(we=>{we.year&&(Pe[we.year]=(Pe[we.year]||0)+1)}),Object.entries(Pe).filter(([we])=>Number(we)>=2020).sort(([we],[Fe])=>Number(Fe)-Number(we)).map(([we,Fe])=>({year:we,count:Fe}))},Vt=Ge(pe),ke=Ge(ge),je=Ge(Ne);return f.jsxs("div",{className:"bg-white flex flex-col items-center relative size-full min-h-screen",children:[f.jsx("style",{children:F6}),f.jsx(g0,{variant:"about",heroAnimationPlayed:e,children:f.jsxs(f.Fragment,{children:[f.jsx("p",{children:"Product, design, & everything in between."}),f.jsx("p",{children:"Graduating from UCLA in June 2026. "})]})}),f.jsxs("div",{className:"content-stretch flex flex-col items-center pb-4 pt-0 px-0 relative shrink-0 w-full",children:[f.jsx(De,{variant:"fade",delay:280,rootMargin:"0px",className:"relative shrink-0 w-full",disabled:e,children:f.jsx("div",{className:"size-full",children:f.jsx("div",{className:"content-stretch flex flex-col gap-3 items-start pb-0 pt-4 px-16 max-md:px-8 relative w-full",children:f.jsxs("div",{className:"content-stretch flex gap-1 items-start relative shrink-0",children:[f.jsx(Vf,{text:"Work",onClick:()=>n("/")}),f.jsx(Vf,{text:"Art",onClick:()=>n("/art")}),f.jsx(Vf,{text:"About",active:!0})]})})})}),f.jsx("div",{className:"px-16 max-md:px-8 w-full pt-3",children:f.jsx("div",{className:"bg-zinc-100 h-px shrink-0 w-full"})})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start px-16 max-md:px-8 pt-2 relative shrink-0 w-full",children:[f.jsx("div",{className:"hidden lg:block lg:sticky lg:top-8 pb-4 lg:pb-8 w-[202px] shrink-0",children:f.jsx(D6,{activeCategory:r,onCategoryClick:de,communityItems:j.filter(le=>le.sidebarName).map(le=>({id:le.id,sidebarName:le.sidebarName})),activeCommunityId:T,onCommunityClick:ue,activeShelfSubcategory:I,onShelfSubcategoryClick:he,shelfCounts:{books:pe.length,music:ge.length,movies:Ne.length}})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-20 items-start pb-8 min-w-0 w-full",children:[f.jsxs("section",{ref:i,className:"flex flex-col md:flex-row gap-10 md:gap-16 items-center w-full max-w-5xl scroll-mt-8",children:[f.jsx(De,{delay:100,children:f.jsx("div",{className:"shrink-0",children:f.jsx(U6,{imageSrc:P6,caption:f.jsxs(f.Fragment,{children:["A visit to the studio of one of my absolute favorite artists,"," ",f.jsx("a",{href:"https://artsandculture.google.com/story/artist-spotlight-hung-liu-national-museum-of-women-in-the-arts/3wVRJQ12cc4OEA?hl=en",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-700 transition-colors",children:"Hung Liu"})]})})})}),f.jsxs("div",{className:"flex flex-col pt-8 gap-6 flex-1",children:[f.jsx(De,{variant:"fade",delay:150,children:f.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-3xl md:text-4xl",children:"Hi, I'm Michelle!"})}),f.jsx(De,{variant:"fade",delay:200,children:f.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-6 text-base tracking-wide text-gray-400",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:O6,alt:"",className:"w-4 h-4"}),f.jsx("span",{className:"text-gray-400",children:"SF  LA  NYC"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:j6,alt:"",className:"w-4 h-4"}),f.jsx("span",{className:"text-gray-400",children:"B.A. Art, B.S. Cognitive Science  UCLA '26"})]})]})}),f.jsx(De,{variant:"fade",delay:250,children:f.jsxs("div",{className:"flex flex-col gap-4 text-gray-600 text-base leading-relaxed",children:[f.jsx("p",{children:"I love art, business, technology, & the ways that they can work together to create extraordinary products for people."}),f.jsxs("p",{children:["I believe thoughtful design makes life more intuitive (& beautiful). I want to bring more of it into the worldwhether through my creations or the communities I'm helping to build. I like to think of it as my ",f.jsx("a",{href:"https://en.wikipedia.org/wiki/Ikigai",target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 font-emdium no-underline hover:text-blue-600 transition-colors",children:"ikigai"}),": the constant pursuit of an intersection between passion, profession, and personal mission."]}),f.jsx("p",{children:"I also love discovering new hidden food spots, getting excited about beautifully designed stationery, and listening to audiobooks on long drives."}),f.jsxs("p",{children:["3 words to describe me: ",f.jsx("em",{children:"Golden Retriever Energy."})," (even on the bad days)"]})]})}),f.jsx(De,{variant:"fade",delay:300,children:f.jsxs("span",{ref:E,className:ee("relative inline-flex items-center justify-center rounded-[999px] transition-all duration-[800ms] ease-out mt-2 w-fit bg-[#ecfdf5]",w?"gap-1.5 pl-1.5 pr-2.5 py-1":"gap-0 p-1"),children:[f.jsxs("span",{className:"relative shrink-0 size-[16px] overflow-visible",children:[f.jsx("span",{className:w?"green-pulse-ring-off":"green-pulse-ring"}),f.jsx("svg",{className:"block size-full relative z-10",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 16 16",children:f.jsxs("g",{id:"Background",children:[f.jsx("rect",{fill:"var(--fill-0, #A7F3D0)",height:"16",rx:"8",width:"16"}),f.jsx("circle",{cx:"8",cy:"8",fill:"var(--fill-0, #10B981)",id:"Ellipse 1",r:"4"})]})})]}),f.jsxs("span",{className:ee("font-['Figtree:Medium',sans-serif] font-normal text-[#10b981] text-base text-nowrap overflow-hidden transition-all duration-[800ms] ease-out",w?"max-w-[500px] opacity-100":"max-w-0 opacity-0"),children:[f.jsx("span",{children:"Working on something cool? Get in"})," ",f.jsx("a",{href:"mailto:michelletheresaliu@gmail.com",className:"[text-decoration-skip-ink:none] [text-underline-position:from-font] decoration-solid underline hover:!text-emerald-600 transition-colors",children:"touch"}),"!"]})]})})]})]}),f.jsxs("section",{ref:a,className:"flex flex-col gap-16 md:flex-row md:justify-between md:gap-0 w-full scroll-mt-8",children:[f.jsx(De,{variant:"fade",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-700 text-[40px] leading-normal shrink-0",children:"Experience"}),f.jsxs("a",{href:"https://drive.google.com/file/d/1JPVZsAg6QSwS9He0bc2cMdVohcBQYD0W/view?usp=sharing",target:"_blank",rel:"noopener noreferrer",className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg hover:text-blue-500 transition-colors",children:["Resume ",f.jsx(ms,{})]})]})}),Z?f.jsxs("div",{className:"flex items-center gap-3 py-4",children:[f.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),f.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):O.length>0?f.jsx("div",{className:"flex flex-col gap-8 md:gap-8 w-full md:w-[560px]",children:O.map((le,Pe)=>f.jsx(De,{delay:Pe*80,children:f.jsx(R6,{data:le})},le.id))}):f.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add experience items in Sanity Studio."})]}),f.jsxs("section",{ref:l,className:"flex flex-col gap-8 w-full scroll-mt-8",children:[f.jsx(De,{variant:"fade",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-[40px] leading-normal shrink-0",children:"My Communities"}),f.jsxs("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg flex items-center gap-1.5",children:["The people who make it all worth it",f.jsx("img",{src:M6,alt:"",className:"w-[12px] h-[12px]",style:{filter:"brightness(0) saturate(100%) invert(83%) sepia(8%) saturate(293%) hue-rotate(177deg) brightness(91%) contrast(87%)"}})]})]})}),Z?f.jsxs("div",{className:"flex items-center gap-3 py-4",children:[f.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),f.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):j.length>0?f.jsx("div",{className:"flex flex-col gap-12 pt-4",children:j.map((le,Pe)=>f.jsx("div",{ref:we=>{p.current[le.id]=we},className:"scroll-mt-8",children:f.jsxs(De,{delay:Pe*100,children:[f.jsx(L6,{data:le}),Pe<j.length-1&&f.jsx("div",{className:"mt-12 h-px w-full bg-gray-200"})]})},le.id))}):f.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add community items in Sanity Studio."})]}),f.jsxs("section",{ref:d,className:"flex flex-col gap-12 w-full scroll-mt-8",children:[f.jsx(De,{variant:"fade",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-[40px] leading-normal shrink-0",children:"My Favorite Quotes"}),f.jsx("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg",children:"a.k.a. my Design ( + Life ) Philosophy"})]})}),J.length>0?f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:grid-rows-[1fr_1fr]",children:J.map((le,Pe)=>f.jsx(De,{delay:Pe*80,className:"h-full",children:f.jsx(Sh,{data:le,className:"h-full",topRow:Pe<2})},le.id))}):f.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add quotes in Sanity Studio."})]}),f.jsxs("section",{ref:u,className:"flex flex-col gap-6 w-full scroll-mt-8",children:[f.jsx(De,{variant:"fade",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-[40px] leading-normal shrink-0",children:"Shelf"}),f.jsx("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg",children:" - Favorites"})]})}),Z?f.jsxs("div",{className:"flex items-center gap-3 py-4",children:[f.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),f.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):f.jsxs("div",{className:"flex flex-col gap-8",children:[f.jsx("div",{ref:g,className:"scroll-mt-8",children:f.jsx(De,{delay:100,children:f.jsx($f,{title:" Books",count:pe.filter(le=>le.isFeatured).length,mediaType:"book",yearFilters:Vt,activeYear:G,onYearChange:le=>Q(le||void 0),externalLink:{label:"Goodreads",href:"https://www.goodreads.com/user/show/126741914-michelletliu"},items:pe,itemCount:5,onItemClick:le=>console.log("Book clicked:",le)})})}),f.jsx("div",{ref:x,className:"scroll-mt-8",children:f.jsx(De,{delay:200,children:f.jsx($f,{title:" Music",count:ge.filter(le=>le.isFeatured).length,mediaType:"music",yearFilters:ke,activeYear:W,onYearChange:le=>N(le||void 0),externalLink:{label:"Spotify",href:"https://open.spotify.com/user/i4stx92bb6e14vmhqe5tl8az6?si=3b9ee8fc1b3a4784"},items:ge,itemCount:5,onItemClick:le=>console.log("Music clicked:",le)})})}),f.jsx("div",{ref:y,className:"scroll-mt-8",children:f.jsx(De,{delay:300,children:f.jsx($f,{title:" Movies",count:Ne.filter(le=>le.isFeatured).length,mediaType:"movie",yearFilters:je,activeYear:U,onYearChange:le=>re(le||void 0),externalLink:{label:"Letterboxd",href:"https://letterboxd.com/LiuMichelle/"},items:Ne,itemCount:5,onItemClick:le=>{le.letterboxdSlug&&window.open(`https://letterboxd.com/liumichelle/film/${le.letterboxdSlug}/`,"_blank")}})})})]})]}),f.jsxs("section",{ref:h,className:"flex flex-col gap-12 w-full scroll-mt-8",children:[f.jsx(De,{variant:"fade",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-[40px] leading-normal shrink-0",children:"Lore "}),f.jsx("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg",children:"Fun snippets from past lives"})]})}),Z?f.jsxs("div",{className:"flex items-center gap-3 py-4",children:[f.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),f.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):se.length>0?f.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-6 md:gap-6",children:se.map((le,Pe)=>f.jsx(De,{delay:Pe*80,children:f.jsx(A6,{data:le,onClick:()=>console.log("Lore clicked:",le)})},le.id))}):f.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add lore items in Sanity Studio."})]})]})]}),f.jsx(Kc,{})]})}function K6(n,e){return n[13]=1,n[14]=e>>8,n[15]=e&255,n[16]=e>>8,n[17]=e&255,n}const iw=112,aw=72,ow=89,lw=115;let Gf;function z6(){const n=new Int32Array(256);for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;n[e]=t}return n}function W6(n){let e=-1;Gf||(Gf=z6());for(let t=0;t<n.length;t++)e=Gf[(e^n[t])&255]^e>>>8;return e^-1}function Y6(n){const e=n.length-1;for(let t=e;t>=4;t--)if(n[t-4]===9&&n[t-3]===iw&&n[t-2]===aw&&n[t-1]===ow&&n[t]===lw)return t-3;return 0}function Q6(n,e,t=!1){const r=new Uint8Array(13);e*=39.3701,r[0]=iw,r[1]=aw,r[2]=ow,r[3]=lw,r[4]=e>>>24,r[5]=e>>>16,r[6]=e>>>8,r[7]=e&255,r[8]=r[4],r[9]=r[5],r[10]=r[6],r[11]=r[7],r[12]=1;const s=W6(r),i=new Uint8Array(4);if(i[0]=s>>>24,i[1]=s>>>16,i[2]=s>>>8,i[3]=s&255,t){const a=Y6(n);return n.set(r,a),n.set(i,a+13),n}else{const a=new Uint8Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=9;const l=new Uint8Array(54);return l.set(n,0),l.set(a,33),l.set(r,37),l.set(i,50),l}}const X6="AAlwSFlz",Z6="AAAJcEhZ",J6="AAAACXBI";function eD(n){let e=n.indexOf(X6);return e===-1&&(e=n.indexOf(Z6)),e===-1&&(e=n.indexOf(J6)),e}const cw="[modern-screenshot]",gs=typeof window<"u",tD=gs&&"Worker"in window,rD=gs&&"atob"in window,nD=gs&&"btoa"in window,x0=gs?window.navigator?.userAgent:"",uw=x0.includes("Chrome"),Fc=x0.includes("AppleWebKit")&&!uw,v0=x0.includes("Firefox"),sD=n=>n&&"__CONTEXT__"in n,iD=n=>n.constructor.name==="CSSFontFaceRule",aD=n=>n.constructor.name==="CSSImportRule",sn=n=>n.nodeType===1,So=n=>typeof n.className=="object",dw=n=>n.tagName==="image",oD=n=>n.tagName==="use",co=n=>sn(n)&&typeof n.style<"u"&&!So(n),lD=n=>n.nodeType===8,cD=n=>n.nodeType===3,Wi=n=>n.tagName==="IMG",eu=n=>n.tagName==="VIDEO",uD=n=>n.tagName==="CANVAS",dD=n=>n.tagName==="TEXTAREA",fD=n=>n.tagName==="INPUT",hD=n=>n.tagName==="STYLE",mD=n=>n.tagName==="SCRIPT",pD=n=>n.tagName==="SELECT",gD=n=>n.tagName==="SLOT",xD=n=>n.tagName==="IFRAME",vD=(...n)=>console.warn(cw,...n);function yD(n){const e=n?.createElement?.("canvas");return e&&(e.height=e.width=1),!!e&&"toDataURL"in e&&!!e.toDataURL("image/webp").includes("image/webp")}const Th=n=>n.startsWith("data:");function fw(n,e){if(n.match(/^[a-z]+:\/\//i))return n;if(gs&&n.match(/^\/\//))return window.location.protocol+n;if(n.match(/^[a-z]+:/i)||!gs)return n;const t=tu().implementation.createHTMLDocument(),r=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(r),t.body.appendChild(s),e&&(r.href=e),s.href=n,s.href}function tu(n){return(n&&sn(n)?n?.ownerDocument:n)??window.document}const ru="http://www.w3.org/2000/svg";function ED(n,e,t){const r=tu(t).createElementNS(ru,"svg");return r.setAttributeNS(null,"width",n.toString()),r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"viewBox",`0 0 ${n} ${e}`),r}function wD(n,e){let t=new XMLSerializer().serializeToString(n);return e&&(t=t.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}function bD(n,e){return new Promise((t,r)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=()=>r(s.error),s.onabort=()=>r(new Error(`Failed read blob to ${e}`)),s.readAsDataURL(n)})}const SD=n=>bD(n,"dataUrl");function Fi(n,e){const t=tu(e).createElement("img");return t.decoding="sync",t.loading="eager",t.src=n,t}function uo(n,e){return new Promise(t=>{const{timeout:r,ownerDocument:s,onError:i,onWarn:a}=e??{},l=typeof n=="string"?Fi(n,tu(s)):n;let d=null,u=null;function h(){t(l),d&&clearTimeout(d),u?.()}if(r&&(d=setTimeout(h,r)),eu(l)){const p=l.currentSrc||l.src;if(!p)return l.poster?uo(l.poster,e).then(t):h();if(l.readyState>=2)return h();const g=h,x=y=>{a?.("Failed video load",p,y),i?.(y),h()};u=()=>{l.removeEventListener("loadeddata",g),l.removeEventListener("error",x)},l.addEventListener("loadeddata",g,{once:!0}),l.addEventListener("error",x,{once:!0})}else{const p=dw(l)?l.href.baseVal:l.currentSrc||l.src;if(!p)return h();const g=async()=>{if(Wi(l)&&"decode"in l)try{await l.decode()}catch(y){a?.("Failed to decode image, trying to render anyway",l.dataset.originalSrc||p,y)}h()},x=y=>{a?.("Failed image load",l.dataset.originalSrc||p,y),h()};if(Wi(l)&&l.complete)return g();u=()=>{l.removeEventListener("load",g),l.removeEventListener("error",x)},l.addEventListener("load",g,{once:!0}),l.addEventListener("error",x,{once:!0})}})}async function TD(n,e){co(n)&&(Wi(n)||eu(n)?await uo(n,e):await Promise.all(["img","video"].flatMap(t=>Array.from(n.querySelectorAll(t)).map(r=>uo(r,e)))))}const hw=(function(){let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function mw(n){return n?.split(",").map(e=>e.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let Av=0;function _D(n){const e=`${cw}[#${Av}]`;return Av++,{time:t=>n&&console.time(`${e} ${t}`),timeEnd:t=>n&&console.timeEnd(`${e} ${t}`),warn:(...t)=>n&&vD(...t)}}function kD(n){return{cache:n?"no-cache":"force-cache"}}async function nu(n,e){return sD(n)?n:CD(n,{...e,autoDestruct:!0})}async function CD(n,e){const{scale:t=1,workerUrl:r,workerNumber:s=1}=e||{},i=!!e?.debug,a=e?.features??!0,l=n.ownerDocument??(gs?window.document:void 0),d=n.ownerDocument?.defaultView??(gs?window:void 0),u=new Map,h={width:0,height:0,quality:1,type:"image/png",scale:t,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:i,fetch:{requestInit:kD(e?.fetch?.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...e?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:s,onCloneEachNode:null,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...e,__CONTEXT__:!0,log:_D(i),node:n,ownerDocument:l,ownerWindow:d,dpi:t===1?null:96*t,svgStyleElement:pw(l),svgDefsElement:l?.createElementNS(ru,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:tD&&r&&s?s:0})].map(()=>{try{const x=new Worker(r);return x.onmessage=async y=>{const{url:E,result:w}=y.data;w?u.get(E)?.resolve?.(w):u.get(E)?.reject?.(new Error(`Error receiving message from worker: ${E}`))},x.onmessageerror=y=>{const{url:E}=y.data;u.get(E)?.reject?.(new Error(`Error receiving message from worker: ${E}`))},x}catch(x){return h.log.warn("Failed to new Worker",x),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[yD(l)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:u,drawImageCount:0,tasks:[],features:a,isEnable:x=>x==="restoreScrollPosition"?typeof a=="boolean"?!1:a[x]??!1:typeof a=="boolean"?a:a[x]??!0,shadowRoots:[]};h.log.time("wait until load"),await TD(n,{timeout:h.timeout,onWarn:h.log.warn}),h.log.timeEnd("wait until load");const{width:p,height:g}=ID(n,h);return h.width=p,h.height=g,h}function pw(n){if(!n)return;const e=n.createElement("style"),t=e.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return e.appendChild(t),e}function ID(n,e){let{width:t,height:r}=e;if(sn(n)&&(!t||!r)){const s=n.getBoundingClientRect();t=t||s.width||Number(n.getAttribute("width"))||0,r=r||s.height||Number(n.getAttribute("height"))||0}return{width:t,height:r}}async function AD(n,e){const{log:t,timeout:r,drawImageCount:s,drawImageInterval:i}=e;t.time("image to canvas");const a=await uo(n,{timeout:r,onWarn:e.log.warn}),{canvas:l,context2d:d}=LD(n.ownerDocument,e),u=()=>{try{d?.drawImage(a,0,0,l.width,l.height)}catch(h){e.log.warn("Failed to drawImage",h)}};if(u(),e.isEnable("fixSvgXmlDecode"))for(let h=0;h<s;h++)await new Promise(p=>{setTimeout(()=>{d?.clearRect(0,0,l.width,l.height),u(),p()},h+i)});return e.drawImageCount=0,t.timeEnd("image to canvas"),l}function LD(n,e){const{width:t,height:r,scale:s,backgroundColor:i,maximumCanvasSize:a}=e,l=n.createElement("canvas");l.width=Math.floor(t*s),l.height=Math.floor(r*s),l.style.width=`${t}px`,l.style.height=`${r}px`,a&&(l.width>a||l.height>a)&&(l.width>a&&l.height>a?l.width>l.height?(l.height*=a/l.width,l.width=a):(l.width*=a/l.height,l.height=a):l.width>a?(l.height*=a/l.width,l.width=a):(l.width*=a/l.height,l.height=a));const d=l.getContext("2d");return d&&i&&(d.fillStyle=i,d.fillRect(0,0,l.width,l.height)),{canvas:l,context2d:d}}function gw(n,e){if(n.ownerDocument)try{const i=n.toDataURL();if(i!=="data:,")return Fi(i,n.ownerDocument)}catch(i){e.log.warn("Failed to clone canvas",i)}const t=n.cloneNode(!1),r=n.getContext("2d"),s=t.getContext("2d");try{return r&&s&&s.putImageData(r.getImageData(0,0,n.width,n.height),0,0),t}catch(i){e.log.warn("Failed to clone canvas",i)}return t}function RD(n,e){try{if(n?.contentDocument?.body)return y0(n.contentDocument.body,e)}catch(t){e.log.warn("Failed to clone iframe",t)}return n.cloneNode(!1)}function ND(n){const e=n.cloneNode(!1);return n.currentSrc&&n.currentSrc!==n.src&&(e.src=n.currentSrc,e.srcset=""),e.loading==="lazy"&&(e.loading="eager"),e}async function DD(n,e){if(n.ownerDocument&&!n.currentSrc&&n.poster)return Fi(n.poster,n.ownerDocument);const t=n.cloneNode(!1);t.crossOrigin="anonymous",n.currentSrc&&n.currentSrc!==n.src&&(t.src=n.currentSrc);const r=t.ownerDocument;if(r){let s=!0;if(await uo(t,{onError:()=>s=!1,onWarn:e.log.warn}),!s)return n.poster?Fi(n.poster,n.ownerDocument):t;t.currentTime=n.currentTime,await new Promise(a=>{t.addEventListener("seeked",a,{once:!0})});const i=r.createElement("canvas");i.width=n.offsetWidth,i.height=n.offsetHeight;try{const a=i.getContext("2d");a&&a.drawImage(t,0,0,i.width,i.height)}catch(a){return e.log.warn("Failed to clone video",a),n.poster?Fi(n.poster,n.ownerDocument):t}return gw(i,e)}return t}function PD(n,e){return uD(n)?gw(n,e):xD(n)?RD(n,e):Wi(n)?ND(n):eu(n)?DD(n,e):n.cloneNode(!1)}function OD(n){let e=n.sandbox;if(!e){const{ownerDocument:t}=n;try{t&&(e=t.createElement("iframe"),e.id=`__SANDBOX__${hw()}`,e.width="0",e.height="0",e.style.visibility="hidden",e.style.position="fixed",t.body.appendChild(e),e.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',n.sandbox=e)}catch(r){n.log.warn("Failed to getSandBox",r)}}return e}const jD=["width","height","-webkit-text-fill-color"],MD=["stroke","fill"];function xw(n,e,t){const{defaultComputedStyles:r}=t,s=n.nodeName.toLowerCase(),i=So(n)&&s!=="svg",a=i?MD.map(E=>[E,n.getAttribute(E)]).filter(([,E])=>E!==null):[],l=[i&&"svg",s,a.map((E,w)=>`${E}=${w}`).join(","),e].filter(Boolean).join(":");if(r.has(l))return r.get(l);const u=OD(t)?.contentWindow;if(!u)return new Map;const h=u?.document;let p,g;i?(p=h.createElementNS(ru,"svg"),g=p.ownerDocument.createElementNS(p.namespaceURI,s),a.forEach(([E,w])=>{g.setAttributeNS(null,E,w)}),p.appendChild(g)):p=g=h.createElement(s),g.textContent=" ",h.body.appendChild(p);const x=u.getComputedStyle(g,e),y=new Map;for(let E=x.length,w=0;w<E;w++){const S=x.item(w);jD.includes(S)||y.set(S,x.getPropertyValue(S))}return h.body.removeChild(p),r.set(l,y),y}function vw(n,e,t){const r=new Map,s=[],i=new Map;if(t)for(const l of t)a(l);else for(let l=n.length,d=0;d<l;d++){const u=n.item(d);a(u)}for(let l=s.length,d=0;d<l;d++)i.get(s[d])?.forEach((u,h)=>r.set(h,u));function a(l){const d=n.getPropertyValue(l),u=n.getPropertyPriority(l),h=l.lastIndexOf("-"),p=h>-1?l.substring(0,h):void 0;if(p){let g=i.get(p);g||(g=new Map,i.set(p,g)),g.set(l,[d,u])}e.get(l)===d&&!u||(p?s.push(p):r.set(l,[d,u]))}return r}function FD(n,e,t,r){const{ownerWindow:s,includeStyleProperties:i,currentParentNodeStyle:a}=r,l=e.style,d=s.getComputedStyle(n),u=xw(n,null,r);a?.forEach((p,g)=>{u.delete(g)});const h=vw(d,u,i);h.delete("transition-property"),h.delete("all"),h.delete("d"),h.delete("content"),t&&(h.delete("margin-top"),h.delete("margin-right"),h.delete("margin-bottom"),h.delete("margin-left"),h.delete("margin-block-start"),h.delete("margin-block-end"),h.delete("margin-inline-start"),h.delete("margin-inline-end"),h.set("box-sizing",["border-box",""])),h.get("background-clip")?.[0]==="text"&&e.classList.add("______background-clip--text"),uw&&(h.has("font-kerning")||h.set("font-kerning",["normal",""]),(h.get("overflow-x")?.[0]==="hidden"||h.get("overflow-y")?.[0]==="hidden")&&h.get("text-overflow")?.[0]==="ellipsis"&&n.scrollWidth===n.clientWidth&&h.set("text-overflow",["clip",""]));for(let p=l.length,g=0;g<p;g++)l.removeProperty(l.item(g));return h.forEach(([p,g],x)=>{l.setProperty(x,p,g)}),h}function UD(n,e){(dD(n)||fD(n)||pD(n))&&e.setAttribute("value",n.value)}const BD=["::before","::after"],$D=["::-webkit-scrollbar","::-webkit-scrollbar-button","::-webkit-scrollbar-thumb","::-webkit-scrollbar-track","::-webkit-scrollbar-track-piece","::-webkit-scrollbar-corner","::-webkit-resizer"];function VD(n,e,t,r,s){const{ownerWindow:i,svgStyleElement:a,svgStyles:l,currentNodeStyle:d}=r;if(!a||!i)return;function u(h){const p=i.getComputedStyle(n,h);let g=p.getPropertyValue("content");if(!g||g==="none")return;s?.(g),g=g.replace(/(')|(")|(counter\(.+\))/g,"");const x=[hw()],y=xw(n,h,r);d?.forEach((k,I)=>{y.delete(I)});const E=vw(p,y,r.includeStyleProperties);E.delete("content"),E.delete("-webkit-locale"),E.get("background-clip")?.[0]==="text"&&e.classList.add("______background-clip--text");const w=[`content: '${g}';`];if(E.forEach(([k,I],L)=>{w.push(`${L}: ${k}${I?" !important":""};`)}),w.length===1)return;try{e.className=[e.className,...x].join(" ")}catch(k){r.log.warn("Failed to copyPseudoClass",k);return}const S=w.join(`
  `);let T=l.get(S);T||(T=[],l.set(S,T)),T.push(`.${x[0]}${h}`)}BD.forEach(u),t&&$D.forEach(u)}const Lv=new Set(["symbol"]);async function Rv(n,e,t,r,s){if(sn(t)&&(hD(t)||mD(t))||r.filter&&!r.filter(t))return;Lv.has(e.nodeName)||Lv.has(t.nodeName)?r.currentParentNodeStyle=void 0:r.currentParentNodeStyle=r.currentNodeStyle;const i=await y0(t,r,!1,s);r.isEnable("restoreScrollPosition")&&GD(n,i),e.appendChild(i)}async function Nv(n,e,t,r){let s=n.firstChild;sn(n)&&n.shadowRoot&&(s=n.shadowRoot?.firstChild,t.shadowRoots.push(n.shadowRoot));for(let i=s;i;i=i.nextSibling)if(!lD(i))if(sn(i)&&gD(i)&&typeof i.assignedNodes=="function"){const a=i.assignedNodes();for(let l=0;l<a.length;l++)await Rv(n,e,a[l],t,r)}else await Rv(n,e,i,t,r)}function GD(n,e){if(!co(n)||!co(e))return;const{scrollTop:t,scrollLeft:r}=n;if(!t&&!r)return;const{transform:s}=e.style,i=new DOMMatrix(s),{a,b:l,c:d,d:u}=i;i.a=1,i.b=0,i.c=0,i.d=1,i.translateSelf(-r,-t),i.a=a,i.b=l,i.c=d,i.d=u,e.style.transform=i.toString()}function HD(n,e){const{backgroundColor:t,width:r,height:s,style:i}=e,a=n.style;if(t&&a.setProperty("background-color",t,"important"),r&&a.setProperty("width",`${r}px`,"important"),s&&a.setProperty("height",`${s}px`,"important"),i)for(const l in i)a[l]=i[l]}const qD=/^[\w-:]+$/;async function y0(n,e,t=!1,r){const{ownerDocument:s,ownerWindow:i,fontFamilies:a,onCloneEachNode:l}=e;if(s&&cD(n))return r&&/\S/.test(n.data)&&r(n.data),s.createTextNode(n.data);if(s&&i&&sn(n)&&(co(n)||So(n))){const u=await PD(n,e);if(e.isEnable("removeAbnormalAttributes")){const E=u.getAttributeNames();for(let w=E.length,S=0;S<w;S++){const T=E[S];qD.test(T)||u.removeAttribute(T)}}const h=e.currentNodeStyle=FD(n,u,t,e);t&&HD(u,e);let p=!1;if(e.isEnable("copyScrollbar")){const E=[h.get("overflow-x")?.[0],h.get("overflow-y")?.[0]];p=E.includes("scroll")||(E.includes("auto")||E.includes("overlay"))&&(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)}const g=h.get("text-transform")?.[0],x=mw(h.get("font-family")?.[0]),y=x?E=>{g==="uppercase"?E=E.toUpperCase():g==="lowercase"?E=E.toLowerCase():g==="capitalize"&&(E=E[0].toUpperCase()+E.substring(1)),x.forEach(w=>{let S=a.get(w);S||a.set(w,S=new Set),E.split("").forEach(T=>S.add(T))})}:void 0;return VD(n,u,p,e,y),UD(n,u),eu(n)||await Nv(n,u,e,y),await l?.(u),u}const d=n.cloneNode(!1);return await Nv(n,d,e),await l?.(d),d}function KD(n){if(n.ownerDocument=void 0,n.ownerWindow=void 0,n.svgStyleElement=void 0,n.svgDefsElement=void 0,n.svgStyles.clear(),n.defaultComputedStyles.clear(),n.sandbox){try{n.sandbox.remove()}catch(e){n.log.warn("Failed to destroyContext",e)}n.sandbox=void 0}n.workers=[],n.fontFamilies.clear(),n.fontCssTexts.clear(),n.requests.clear(),n.tasks=[],n.shadowRoots=[]}function zD(n){const{url:e,timeout:t,responseType:r,...s}=n,i=new AbortController,a=t?setTimeout(()=>i.abort(),t):void 0;return fetch(e,{signal:i.signal,...s}).then(l=>{if(!l.ok)throw new Error("Failed fetch, not 2xx response",{cause:l});switch(r){case"arrayBuffer":return l.arrayBuffer();case"dataUrl":return l.blob().then(SD);case"text":default:return l.text()}}).finally(()=>clearTimeout(a))}function fo(n,e){const{url:t,requestType:r="text",responseType:s="text",imageDom:i}=e;let a=t;const{timeout:l,acceptOfImage:d,requests:u,fetchFn:h,fetch:{requestInit:p,bypassingCache:g,placeholderImage:x},font:y,workers:E,fontFamilies:w}=n;r==="image"&&(Fc||v0)&&n.drawImageCount++;let S=u.get(t);if(!S){g&&g instanceof RegExp&&g.test(a)&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());const T=r.startsWith("font")&&y&&y.minify,k=new Set;T&&r.split(";")[1].split(",").forEach(P=>{w.has(P)&&w.get(P).forEach(j=>k.add(j))});const I=T&&k.size,L={url:a,timeout:l,responseType:I?"arrayBuffer":s,headers:r==="image"?{accept:d}:void 0,...p};S={type:r,resolve:void 0,reject:void 0,response:null},S.response=(async()=>{if(h&&r==="image"){const O=await h(t);if(O)return O}return!Fc&&t.startsWith("http")&&E.length?new Promise((O,P)=>{E[u.size&E.length-1].postMessage({rawUrl:t,...L}),S.resolve=O,S.reject=P}):zD(L)})().catch(O=>{if(u.delete(t),r==="image"&&x)return n.log.warn("Failed to fetch image base64, trying to use placeholder image",a),typeof x=="string"?x:x(i);throw O}),u.set(t,S)}return S.response}async function yw(n,e,t,r){if(!Ew(n))return n;for(const[s,i]of WD(n,e))try{const a=await fo(t,{url:i,requestType:r?"image":"text",responseType:"dataUrl"});n=n.replace(YD(s),`$1${a}$3`)}catch(a){t.log.warn("Failed to fetch css data url",s,a)}return n}function Ew(n){return/url\((['"]?)([^'"]+?)\1\)/.test(n)}const ww=/url\((['"]?)([^'"]+?)\1\)/g;function WD(n,e){const t=[];return n.replace(ww,(r,s,i)=>(t.push([i,fw(i,e)]),r)),t.filter(([r])=>!Th(r))}function YD(n){const e=n.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}const QD=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function XD(n,e){return QD.map(t=>{const r=n.getPropertyValue(t);return!r||r==="none"?null:((Fc||v0)&&e.drawImageCount++,yw(r,null,e,!0).then(s=>{!s||r===s||n.setProperty(t,s,n.getPropertyPriority(t))}))}).filter(Boolean)}function ZD(n,e){if(Wi(n)){const t=n.currentSrc||n.src;if(!Th(t))return[fo(e,{url:t,imageDom:n,requestType:"image",responseType:"dataUrl"}).then(r=>{r&&(n.srcset="",n.dataset.originalSrc=t,n.src=r||"")})];(Fc||v0)&&e.drawImageCount++}else if(So(n)&&!Th(n.href.baseVal)){const t=n.href.baseVal;return[fo(e,{url:t,imageDom:n,requestType:"image",responseType:"dataUrl"}).then(r=>{r&&(n.dataset.originalSrc=t,n.href.baseVal=r||"")})]}return[]}function JD(n,e){const{ownerDocument:t,svgDefsElement:r}=e,s=n.getAttribute("href")??n.getAttribute("xlink:href");if(!s)return[];const[i,a]=s.split("#");if(a){const l=`#${a}`,d=e.shadowRoots.reduce((u,h)=>u??h.querySelector(`svg ${l}`),t?.querySelector(`svg ${l}`));if(i&&n.setAttribute("href",l),r?.querySelector(l))return[];if(d)return r?.appendChild(d.cloneNode(!0)),[];if(i)return[fo(e,{url:i,responseType:"text"}).then(u=>{r?.insertAdjacentHTML("beforeend",u)})]}return[]}function bw(n,e){const{tasks:t}=e;sn(n)&&((Wi(n)||dw(n))&&t.push(...ZD(n,e)),oD(n)&&t.push(...JD(n,e))),co(n)&&t.push(...XD(n.style,e)),n.childNodes.forEach(r=>{bw(r,e)})}async function eP(n,e){const{ownerDocument:t,svgStyleElement:r,fontFamilies:s,fontCssTexts:i,tasks:a,font:l}=e;if(!(!t||!r||!s.size))if(l&&l.cssText){const d=Pv(l.cssText,e);r.appendChild(t.createTextNode(`${d}
`))}else{const d=Array.from(t.styleSheets).filter(h=>{try{return"cssRules"in h&&!!h.cssRules.length}catch(p){return e.log.warn(`Error while reading CSS rules from ${h.href}`,p),!1}});await Promise.all(d.flatMap(h=>Array.from(h.cssRules).map(async(p,g)=>{if(aD(p)){let x=g+1;const y=p.href;let E="";try{E=await fo(e,{url:y,requestType:"text",responseType:"text"})}catch(S){e.log.warn(`Error fetch remote css import from ${y}`,S)}const w=E.replace(ww,(S,T,k)=>S.replace(k,fw(k,y)));for(const S of rP(w))try{h.insertRule(S,S.startsWith("@import")?x+=1:h.cssRules.length)}catch(T){e.log.warn("Error inserting rule from remote css import",{rule:S,error:T})}}}))),d.flatMap(h=>Array.from(h.cssRules)).filter(h=>iD(h)&&Ew(h.style.getPropertyValue("src"))&&mw(h.style.getPropertyValue("font-family"))?.some(p=>s.has(p))).forEach(h=>{const p=h,g=i.get(p.cssText);g?r.appendChild(t.createTextNode(`${g}
`)):a.push(yw(p.cssText,p.parentStyleSheet?p.parentStyleSheet.href:null,e).then(x=>{x=Pv(x,e),i.set(p.cssText,x),r.appendChild(t.createTextNode(`${x}
`))}))})}}const tP=/(\/\*[\s\S]*?\*\/)/g,Dv=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function rP(n){if(n==null)return[];const e=[];let t=n.replace(tP,"");for(;;){const i=Dv.exec(t);if(!i)break;e.push(i[0])}t=t.replace(Dv,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let i=r.exec(t);if(i)s.lastIndex=r.lastIndex;else if(i=s.exec(t),i)r.lastIndex=s.lastIndex;else break;e.push(i[0])}return e}const nP=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,sP=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Pv(n,e){const{font:t}=e,r=t?t?.preferredFormat:void 0;return r?n.replace(sP,s=>{for(;;){const[i,,a]=nP.exec(s)||[];if(!a)return"";if(a===r)return`src: ${i};`}}):n}async function iP(n,e){const t=await nu(n,e);if(sn(t.node)&&So(t.node))return t.node;const{ownerDocument:r,log:s,tasks:i,svgStyleElement:a,svgDefsElement:l,svgStyles:d,font:u,progress:h,autoDestruct:p,onCloneNode:g,onEmbedNode:x,onCreateForeignObjectSvg:y}=t;s.time("clone node");const E=await y0(t.node,t,!0);if(a&&r){let I="";d.forEach((L,O)=>{I+=`${L.join(`,
`)} {
  ${O}
}
`}),a.appendChild(r.createTextNode(I))}s.timeEnd("clone node"),await g?.(E),u!==!1&&sn(E)&&(s.time("embed web font"),await eP(E,t),s.timeEnd("embed web font")),s.time("embed node"),bw(E,t);const w=i.length;let S=0;const T=async()=>{for(;;){const I=i.pop();if(!I)break;try{await I}catch(L){t.log.warn("Failed to run task",L)}h?.(++S,w)}};h?.(S,w),await Promise.all([...Array.from({length:4})].map(T)),s.timeEnd("embed node"),await x?.(E);const k=aP(E,t);return l&&k.insertBefore(l,k.children[0]),a&&k.insertBefore(a,k.children[0]),p&&KD(t),await y?.(k),k}function aP(n,e){const{width:t,height:r}=e,s=ED(t,r,n.ownerDocument),i=s.ownerDocument.createElementNS(s.namespaceURI,"foreignObject");return i.setAttributeNS(null,"x","0%"),i.setAttributeNS(null,"y","0%"),i.setAttributeNS(null,"width","100%"),i.setAttributeNS(null,"height","100%"),i.append(n),s.appendChild(i),s}async function oP(n,e){const t=await nu(n,e),r=await iP(t),s=wD(r,t.isEnable("removeControlCharacter"));t.autoDestruct||(t.svgStyleElement=pw(t.ownerDocument),t.svgDefsElement=t.ownerDocument?.createElementNS(ru,"defs"),t.svgStyles.clear());const i=Fi(s,r.ownerDocument);return await AD(i,t)}async function lP(n,e){const t=await nu(n,e),{log:r,quality:s,type:i,dpi:a}=t,l=await oP(t);r.time("canvas to data url");let d=l.toDataURL(i,s);if(["image/png","image/jpeg"].includes(i)&&a&&rD&&nD){const[u,h]=d.split(",");let p=0,g=!1;if(i==="image/png"){const k=eD(h);k>=0?(p=Math.ceil((k+28)/3)*4,g=!0):p=33/3*4}else i==="image/jpeg"&&(p=18/3*4);const x=h.substring(0,p),y=h.substring(p),E=window.atob(x),w=new Uint8Array(E.length);for(let k=0;k<w.length;k++)w[k]=E.charCodeAt(k);const S=i==="image/png"?Q6(w,a,g):K6(w,a),T=window.btoa(String.fromCharCode(...S));d=[u,",",T,y].join("")}return r.timeEnd("canvas to data url"),d}async function Sw(n,e){return lP(await nu(n,{...e,type:"image/png"}))}const cP="/assets/fcadb86f9e7ac3194098e501064eb43213cdfff1-CAqEyYq2.png",uP="/assets/dd3b1a5ed7db644c197314328f647774bd86226e-gTVcV44l.png",dP="/assets/f81f194aee98efdd62a97e659006efa986492874-Cw7hLurS.png",fP="/assets/7d8c54338d14a1f9afdfff1bec90c42375e5050e-yQmd-iJ8.png",hP="/assets/a643fce02520f3d992e6b432fa72fab473a1ca7e-Crr1K7le.png";function mP(){return f.jsx("svg",{width:"20",height:"20",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M12.4512 24.9023C10.734 24.9023 9.12272 24.5768 7.61719 23.9258C6.11165 23.2829 4.78923 22.3918 3.6499 21.2524C2.51058 20.1131 1.6154 18.7907 0.964355 17.2852C0.321452 15.7796 0 14.1683 0 12.4512C0 10.734 0.321452 9.12272 0.964355 7.61719C1.6154 6.11165 2.51058 4.78923 3.6499 3.6499C4.78923 2.50244 6.11165 1.60726 7.61719 0.964355C9.12272 0.321452 10.734 0 12.4512 0C14.1683 0 15.7796 0.321452 17.2852 0.964355C18.7907 1.60726 20.1131 2.50244 21.2524 3.6499C22.3918 4.78923 23.2829 6.11165 23.9258 7.61719C24.5768 9.12272 24.9023 10.734 24.9023 12.4512C24.9023 14.1683 24.5768 15.7796 23.9258 17.2852C23.2829 18.7907 22.3918 20.1131 21.2524 21.2524C20.1131 22.3918 18.7907 23.2829 17.2852 23.9258C15.7796 24.5768 14.1683 24.9023 12.4512 24.9023ZM12.4512 22.8271C13.8835 22.8271 15.2262 22.5586 16.4795 22.0215C17.7327 21.4844 18.8354 20.7397 19.7876 19.7876C20.7397 18.8354 21.4844 17.7327 22.0215 16.4795C22.5586 15.2262 22.8271 13.8835 22.8271 12.4512C22.8271 11.0189 22.5586 9.67611 22.0215 8.42285C21.4844 7.16146 20.7397 6.05876 19.7876 5.11475C18.8354 4.1626 17.7327 3.41797 16.4795 2.88086C15.2262 2.34375 13.8835 2.0752 12.4512 2.0752C11.0189 2.0752 9.67611 2.34375 8.42285 2.88086C7.1696 3.41797 6.06689 4.1626 5.11475 5.11475C4.1626 6.05876 3.41797 7.16146 2.88086 8.42285C2.34375 9.67611 2.0752 11.0189 2.0752 12.4512C2.0752 13.8835 2.34375 15.2262 2.88086 16.4795C3.41797 17.7327 4.1626 18.8354 5.11475 19.7876C6.06689 20.7397 7.1696 21.4844 8.42285 22.0215C9.67611 22.5586 11.0189 22.8271 12.4512 22.8271ZM10.3149 19.2749C10.0627 19.2749 9.85107 19.1935 9.68018 19.0308C9.50928 18.868 9.42383 18.6646 9.42383 18.4204C9.42383 18.1763 9.50928 17.9728 9.68018 17.8101C9.85107 17.6473 10.0627 17.5659 10.3149 17.5659H11.8286V11.9629H10.5225C10.2702 11.9629 10.0586 11.8815 9.8877 11.7188C9.7168 11.556 9.63135 11.3525 9.63135 11.1084C9.63135 10.8643 9.7168 10.6608 9.8877 10.498C10.0586 10.3353 10.2702 10.2539 10.5225 10.2539H12.8174C13.1266 10.2539 13.3626 10.3556 13.5254 10.5591C13.6882 10.7544 13.7695 11.0189 13.7695 11.3525V17.5659H15.2832C15.5355 17.5659 15.7471 17.6473 15.918 17.8101C16.0889 17.9728 16.1743 18.1763 16.1743 18.4204C16.1743 18.6646 16.0889 18.868 15.918 19.0308C15.7471 19.1935 15.5355 19.2749 15.2832 19.2749H10.3149ZM12.3413 8.21533C11.9019 8.21533 11.5275 8.06071 11.2183 7.75146C10.909 7.44222 10.7544 7.06787 10.7544 6.62842C10.7544 6.18083 10.909 5.80241 11.2183 5.49316C11.5275 5.18392 11.9019 5.0293 12.3413 5.0293C12.7889 5.0293 13.1632 5.18392 13.4644 5.49316C13.7736 5.80241 13.9282 6.18083 13.9282 6.62842C13.9282 7.06787 13.7736 7.44222 13.4644 7.75146C13.1632 8.06071 12.7889 8.21533 12.3413 8.21533Z",fill:"currentColor"})})}const Ov="M10.6862 7.6055L17.3844 0H15.8002L9.97941 6.60311L5.36277 0H0.178833L7.19548 9.9737L0.178833 17.9454H1.76308L7.90171 10.9761L12.7696 17.9454H17.9536L10.6858 7.6055H10.6862ZM8.7057 10.0639L7.99222 9.06869L2.33673 1.16544H4.60063L9.33802 7.5516L10.0515 8.54678L15.8011 16.8348H13.5372L8.7057 10.0643V10.0639Z";function E0({project:n}){const[e,t]=R.useState(!1),[r,s]=R.useState(!1),[i,a]=R.useState(!1),[l,d]=R.useState(!1);bo(e),R.useEffect(()=>{if(e){requestAnimationFrame(()=>{s(!0)});const p=setTimeout(()=>{d(!0)},350);return()=>clearTimeout(p)}else s(!1),d(!1)},[e]),R.useEffect(()=>{if(!e)return;const p=g=>{g.key==="Escape"&&(g.preventDefault(),h())};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[e]);const u=()=>{t(!0),a(!1)},h=()=>{a(!0),s(!1),setTimeout(()=>{t(!1),a(!1)},300)};return f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:u,className:"absolute top-8 right-8 md:right-16 z-40 cursor-pointer transition-opacity duration-200 hover:opacity-70 text-gray-400","aria-label":"Project info",children:f.jsx(mP,{})}),e&&f.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-8",children:[f.jsx("div",{className:`absolute inset-0 bg-black/20 transition-opacity duration-300 ${r?"opacity-100":"opacity-0"}`,onClick:h}),f.jsx("div",{className:`relative bg-white rounded-3xl flex flex-col w-[calc(100%*6/12)] max-md:w-[95%] max-h-[80vh] overflow-hidden transition-all duration-300 ease-out ${r?"opacity-100 translate-y-0":i?"opacity-0 translate-y-4":"opacity-0 translate-y-8"}`,children:f.jsx("div",{className:"flex flex-col flex-1 min-h-0 pt-2 max-md:pt-1 max-md:pb-2",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-1 items-start px-8 max-md:px-6 pt-4 pb-8 max-md:py-4 relative shrink-0 w-full",children:[f.jsxs("div",{className:"flex items-center justify-between w-full",children:[f.jsxs("div",{className:"content-stretch flex gap-[6px] items-center relative shrink-0",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-xl text-black",children:n.title}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] relative shrink-0 text-[#9ca3af] text-base",children:""}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-[#9ca3af] text-xl",children:n.year})]}),n.xLink&&f.jsx("a",{href:n.xLink,target:"_blank",rel:"noopener noreferrer",className:"hidden md:flex content-stretch items-center relative shrink-0 group/xlink",children:f.jsxs("div",{className:"content-stretch flex gap-[2px] items-center relative shrink-0",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative shrink-0 text-[#9ca3af] text-base group-hover/xlink:text-blue-500 transition-colors",children:"View on"}),f.jsx("div",{className:"content-stretch flex items-center justify-center px-[4.667px] py-[6.667px] relative shrink-0 -mr-0.5",children:f.jsx("svg",{className:"block w-[16px] h-[16px] fill-[#9ca3af] group-hover/xlink:fill-blue-500 transition-colors",viewBox:"0 0 19 18",children:f.jsx("path",{d:Ov})})}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative shrink-0 text-[#9ca3af] text-base group-hover/xlink:text-blue-500 transition-colors",children:f.jsx(ms,{})})]})})]}),f.jsx("div",{className:"content-stretch flex gap-2 items-start relative w-full -mt-1 mb-1",children:f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative text-[#6b7280] text-base",children:n.description})}),n.xLink&&f.jsx("a",{href:n.xLink,target:"_blank",rel:"noopener noreferrer",className:"md:hidden content-stretch flex items-center relative shrink-0 group/xlink -mt-1 mb-1",children:f.jsxs("div",{className:"content-stretch flex gap-[2px] items-center relative shrink-0",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative shrink-0 text-[#9ca3af] text-base group-hover/xlink:text-blue-500 transition-colors",children:"View on"}),f.jsx("div",{className:"content-stretch flex items-center justify-center px-[4.667px] py-[6.667px] relative shrink-0 -mr-0.5",children:f.jsx("svg",{className:"block w-[16px] h-[16px] fill-[#9ca3af] group-hover/xlink:fill-blue-500 transition-colors",viewBox:"0 0 19 18",children:f.jsx("path",{d:Ov})})}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative shrink-0 text-[#9ca3af] text-base group-hover/xlink:text-blue-500 transition-colors",children:f.jsx(ms,{})})]})}),f.jsxs("div",{className:"relative rounded-[16px] w-full aspect-[1097/616] overflow-hidden bg-gray-100 shrink-0 mt-3",children:[f.jsx("img",{alt:"",className:"absolute object-cover size-full rounded-[16px]",src:n.imageSrc}),n.videoSrc&&l&&f.jsx(ls,{src:n.videoSrc,className:"absolute object-cover size-full rounded-[16px]",autoPlay:!0,muted:!0,loop:!0,controls:!1,muxEnvKey:"e4cc19a78gcf0tbtfmu4m7ruf"},n.id)]})]})})})})]})]})}const pP={id:"polaroid",title:"Polaroid Studio",year:"2025",description:"A digital way to customize your own polaroid.",imageSrc:"https://image.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w/thumbnail.png",videoSrc:"https://stream.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w.m3u8",xLink:"https://x.com/michelletliu/status/1991201412072734777",tryItOutHref:"/polaroid"};let _h=!1,Jl=null;function Hf(n){Jl&&(clearTimeout(Jl),Jl=null),n?_h=!0:Jl=setTimeout(()=>{_h=!1},150)}function Uc({label:n,children:e,offsetY:t=0}){const[r,s]=R.useState(!1),[i,a]=R.useState(!1),[l,d]=R.useState(!1),u=R.useRef(null),h=()=>{u.current&&clearTimeout(u.current),a(!1),_h?(d(!0),s(!0),Hf(!0)):(d(!1),u.current=setTimeout(()=>{s(!0),Hf(!0)},800))},p=()=>{u.current&&(clearTimeout(u.current),u.current=null),r&&(Hf(!1),l?(s(!1),d(!1)):(a(!0),setTimeout(()=>{s(!1),a(!1)},125)))};return f.jsxs("div",{className:"relative inline-flex",onMouseEnter:h,onMouseLeave:p,children:[e,r&&f.jsxs("div",{className:"tooltip absolute left-1/2 px-2.5 py-1.5 bg-gray-800 text-white text-[13px] font-medium rounded-md whitespace-nowrap pointer-events-none z-[9999] -translate-x-1/2","data-ending-style":i?"":void 0,"data-instant":l?"":void 0,style:{bottom:`calc(100% + 8px - ${t}px)`,"--transform-origin":"center bottom"},children:[n,f.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[5px] border-t-gray-800"})]})]})}const jv=[{id:"red",name:"Red",fill:"#FF383C",fillHover:"#E32226",tint:"rgba(255, 56, 60, 0.15)",border:"#f0c8c9"},{id:"orange",name:"Orange",fill:"#FF8D28",fillHover:"#E67A1C",tint:"rgba(255, 141, 40, 0.15)",border:"#ffe0c8"},{id:"yellow",name:"Yellow",fill:"#FFCC00",fillHover:"#E6B800",tint:"rgba(255, 204, 0, 0.15)",border:"#fff2cc"},{id:"green",name:"Green",fill:"#34C759",fillHover:"#2DB04C",tint:"rgba(52, 199, 89, 0.15)",border:"#d4eedd"},{id:"cyan",name:"Cyan",fill:"#00C3D0",fillHover:"#00A8B5",tint:"rgba(0, 195, 208, 0.1)",border:"#c5f0e7"},{id:"blue",name:"Blue",fill:"#0088FF",fillHover:"#0070D9",tint:"rgba(0, 136, 255, 0.15)",border:"#cce5ff"},{id:"purple",name:"Purple",fill:"#6155F5",fillHover:"#4E3FE0",tint:"rgba(97, 85, 245, 0.15)",border:"#d1d0e0"}];function gP({color:n,isSelected:e,onClick:t}){const[r,s]=R.useState(!1);return e?f.jsx(Uc,{label:n.name,offsetY:-5,children:f.jsx("button",{onClick:t,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),className:"relative shrink-0 size-[30px] cursor-pointer group","aria-label":`Select ${n.name} color`,children:f.jsx("div",{className:"absolute inset-[-20%]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 42 42",children:f.jsxs("g",{children:[f.jsx("circle",{cx:"21",cy:"21",fill:r?n.fillHover:n.fill,opacity:"0.7",r:"15",className:"transition-all duration-200"}),f.jsx("circle",{cx:"21",cy:"21",opacity:"0.7",r:"19.5",stroke:"#0088FF",strokeWidth:"3"})]})})})})}):f.jsx(Uc,{label:n.name,offsetY:-5,children:f.jsx("button",{onClick:t,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),className:"relative shrink-0 size-[30px] cursor-pointer group","aria-label":`Select ${n.name} color`,children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 30 30",children:f.jsx("g",{opacity:"0.7",children:f.jsx("circle",{cx:"15",cy:"15",fill:r?n.fillHover:n.fill,r:"15",className:"transition-all duration-200"})})})})})}function xP(){const n=Nn(),[e,t]=R.useState(null),[r,s]=R.useState(!1),[i,a]=R.useState(!1),[l,d]=R.useState(""),[u,h]=R.useState(!1),[p,g]=R.useState(!1),[x,y]=R.useState(!1),[E,w]=R.useState(!1),[S,T]=R.useState(!1),[k,I]=R.useState(!1),[L,O]=R.useState(!1),[P,j]=R.useState(null),[F,D]=R.useState(!1),[$,J]=R.useState(null),[ne,se]=R.useState(!1),[X,Z]=R.useState(!1),[ie,G]=R.useState(!0),Q=R.useRef(null),W=R.useRef(null);R.useEffect(()=>{const ke=setTimeout(()=>{G(!1)},50);return()=>clearTimeout(ke)},[]);const N=()=>{Z(!0),setTimeout(()=>{n("/")},280)};R.useEffect(()=>{const ke=new URLSearchParams(window.location.search),je=ke.get("color");if(je){const we=jv.find(Fe=>Fe.id===je);we&&t(we)}const le=ke.get("caption");le&&(d(decodeURIComponent(le)),a(!0)),ke.get("date")==="true"&&s(!0)},[]);const U=R.useRef(null);R.useEffect(()=>{const ke=()=>{ne&&setTimeout(()=>{se(!1),O(!1)},100)};return window.addEventListener("focus",ke),()=>window.removeEventListener("focus",ke)},[ne]);const re=new Date().toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}).replace(/\//g,"."),de=()=>{t(null),s(!1),a(!1),d(""),h(!1),J(null)},ue=async()=>{if(U.current)try{const ke=await Sw(U.current,{scale:3,backgroundColor:null}),je=document.createElement("a");je.href=ke,je.download=`PolaroidStudio${re}.png`,document.body.appendChild(je),je.click(),document.body.removeChild(je),w(!0),setTimeout(()=>w(!1),2e3)}catch(ke){console.error("Failed to download polaroid:",ke)}},he=()=>{const ke=window.location.origin+window.location.pathname,je=new URLSearchParams;return e&&je.set("color",e.id),l&&je.set("caption",encodeURIComponent(l)),r&&je.set("date","true"),je.toString()?`${ke}?${je.toString()}`:ke},pe=async()=>{const ke=he();try{await navigator.clipboard.writeText(ke),y(!0),setTimeout(()=>y(!1),2e3)}catch{const le=document.createElement("textarea");le.value=ke,le.style.position="fixed",le.style.left="-999999px",document.body.appendChild(le),le.select();try{document.execCommand("copy"),y(!0),setTimeout(()=>y(!1),2e3)}catch(Pe){console.error("Failed to copy link:",Pe)}document.body.removeChild(le)}},ge=async ke=>{const je=he(),le="Check out my Polaroid!",Pe={Instagram:"https://www.instagram.com/",Messages:`sms:&body=${encodeURIComponent(le+" "+je)}`,AirDrop:je,LinkedIn:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(je)}`,Mail:`mailto:?subject=${encodeURIComponent(le)}&body=${encodeURIComponent(je)}`,X:`https://twitter.com/intent/tweet?text=${encodeURIComponent(le)}&url=${encodeURIComponent(je)}`};if((ke==="AirDrop"||ke==="Messages")&&navigator.share)try{await navigator.share({title:le,text:le,url:je});return}catch{console.log("Share cancelled or failed"),ke==="Messages"&&(window.location.href=Pe[ke]);return}if(ke==="Instagram"){alert("Instagram sharing would open the Instagram app here. Link copied to clipboard!");return}Pe[ke]&&(ke==="Messages"?window.location.href=Pe[ke]:window.open(Pe[ke],"_blank"))},Ne=()=>{if(D(!0),$){const ke=setTimeout(()=>{O(!0)},50);j(ke)}},Ge=()=>{D(!1),P&&(clearTimeout(P),j(null)),ne||O(!1)},Vt=ke=>{const je=ke.target.files?.[0];if(je){if(!je.type.startsWith("image/")){alert("Please upload an image file (e.g., .jpg, .png, .gif)"),se(!1),O(!1);return}const le=new FileReader;le.onload=Pe=>{J(Pe.target?.result),se(!1),O(!1),W.current&&(W.current.value="")},le.onerror=()=>{console.error("Error reading file"),alert("Error reading file. Please try again."),se(!1),O(!1)},le.readAsDataURL(je)}};return f.jsxs(f.Fragment,{children:[f.jsx("button",{ref:Q,onClick:N,className:"fixed top-8 left-8 md:left-16 z-40 cursor-pointer transition-opacity duration-200 hover:opacity-80","aria-label":"Go back to home",children:f.jsx("img",{src:Vi,alt:"Michelle Liu Logo",className:"w-[44px] h-[44px] object-contain"})}),f.jsx(E0,{project:pP}),f.jsxs("div",{className:`polaroid-page-container relative w-full min-h-screen min-h-[100dvh] px-4 flex flex-col items-center transition-all ${X?"opacity-0 scale-[0.985]":ie?"opacity-0 scale-[1.01]":"opacity-100 scale-100"}`,style:{backgroundImage:"linear-gradient(133.216deg, rgba(151, 191, 255, 0.2) 10.334%, rgba(151, 191, 255, 0) 94.005%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)",transitionDuration:X?"280ms":"300ms",transitionTimingFunction:X?"cubic-bezier(0.4, 0, 0.2, 1)":"ease-out"},onClick:()=>{T(!1),I(!1)},children:[f.jsxs("div",{className:"flex flex-col gap-[32px] md:gap-[48px] items-center w-full max-w-[583px] my-auto py-[100px] md:py-[120px]",children:[f.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center relative shrink-0 text-2xl md:text-3rxl text-black text-center text-nowrap",style:{fontVariationSettings:"'wdth' 100"},children:f.jsxs("p",{className:"",children:[f.jsx("span",{children:"Polaroid "}),f.jsx("span",{className:"text-gray-400",children:"Studio"})]})}),f.jsxs("div",{ref:U,className:"content-stretch flex h-[320px] md:h-[393.22px] items-center justify-center relative rounded-[5.5px] md:rounded-[6.78px] shadow-[0px_2.5px_16px_0px_rgba(0,0,0,0.08)] md:shadow-[0px_3.39px_20.339px_0px_rgba(0,0,0,0.08)] shrink-0 w-[274px] md:w-[337.288px] transition-transform duration-300 ease-out hover:rotate-2",children:[f.jsx("div",{className:"h-[320px] md:h-[393.22px] relative rounded-[5.5px] md:rounded-[6.78px] shrink-0 w-[274px] md:w-[337.288px]",children:f.jsxs("div",{className:"absolute contents left-0 top-0",children:[f.jsx("div",{className:"absolute contents left-0 top-0",children:f.jsx("div",{className:"absolute blur-[0.25px] filter h-full left-0 rounded-[5.5px] md:rounded-[6.78px] top-0 w-full",style:{backgroundColor:e?e.tint:"white"},children:f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-[-1px] pointer-events-none rounded-[6.88px] md:rounded-[8.475px]",style:{borderColor:e?e.border:void 0}})})}),f.jsx("div",{className:"absolute content-stretch flex items-center left-0 pb-[62px] md:pb-[76.271px] pt-[16.5px] md:pt-[20.339px] px-[16.5px] md:px-[20.339px] rounded-[5.5px] md:rounded-[6.78px] top-0",style:{backgroundColor:e?e.tint:"white"},children:f.jsxs("div",{className:"relative rounded-[2.75px] md:rounded-[3.39px] shrink-0 w-[241px] h-[241px] md:w-[296.61px] md:h-[296.61px]",onMouseEnter:Ne,onMouseLeave:Ge,children:[f.jsx("div",{className:"overflow-clip relative rounded-[inherit] size-full",children:$?f.jsx("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden rounded-[4.7px] md:rounded-[5.773px] bg-[#f5f5f5]",children:f.jsx("img",{alt:"Polaroid photo",className:"max-w-full max-h-full w-auto h-auto object-contain",src:$})}):f.jsx("button",{type:"button",onClick:()=>{se(!0),W.current?.click()},className:"absolute inset-0 rounded-[4.7px] md:rounded-[5.773px] flex items-center justify-center cursor-pointer transition-colors duration-200",style:{backgroundColor:F?"#e5e7eb":"#f3f4f6"},children:f.jsx("div",{className:"rounded-full w-[162px] h-[162px] md:w-[200px] md:h-[200px] flex items-center justify-center transition-colors duration-200",style:{backgroundColor:F?"#d1d5db":"#e5e7eb"},children:f.jsxs("svg",{width:"65",height:"65",viewBox:"0 0 24 24",fill:"none",stroke:F?"#6b7280":"#9ca3af",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"md:w-[80px] md:h-[80px] transition-colors duration-200",children:[f.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),f.jsx("polyline",{points:"17 8 12 3 7 8"}),f.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})})})}),f.jsx("input",{ref:W,type:"file",accept:"image/*",onChange:Vt,className:"sr-only","aria-hidden":"true"}),L&&$&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"absolute bg-[rgba(196,196,196,0.5)] inset-0 rounded-[3.39px] transition-all duration-150 ease-out animate-fade-in-fast"}),f.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10",children:f.jsx("button",{type:"button",onClick:()=>{se(!0),W.current?.click()},className:"cursor-pointer block transition-all duration-150 ease-out animate-scale-in-fast",children:f.jsxs("div",{className:"bg-gray-50 hover:!bg-gray-200 content-stretch flex gap-[12px] items-center px-6 py-3 rounded-[999px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)] hover:shadow-[0px_4px_12px_0px_rgba(0,0,0,0.1)] transition-all duration-300 ease-in-out",children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[999px]"}),f.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(60,60,67,0.6)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),f.jsx("polyline",{points:"17 8 12 3 7 8"}),f.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),f.jsx("span",{className:"font-['SF_Pro','-apple-system',sans-serif] text-[17px] text-[rgba(60,60,67,0.6)] whitespace-nowrap",children:"Upload New"})]})})})]}),f.jsx("div",{"aria-hidden":"true",className:"absolute border-[0.847px] border-solid border-gray-200/50 inset-0 pointer-events-none rounded-[3.39px]",style:{borderColor:e?`${e.fill}4D`:void 0}})]})})]})}),r&&f.jsx("div",{className:"absolute flex flex-col justify-center leading-[0] left-[229.7px] md:left-[282.7px] not-italic text-[13.8px] md:text-[16.949px] text-[rgba(0,0,0,0.4)] text-center text-nowrap top-[301.5px] md:top-[370.72px] tracking-[0.15em] -translate-x-1/2 -translate-y-1/2",style:{fontFamily:"'Courier New', monospace"},children:f.jsx("p",{className:"leading-[23.4px] md:leading-[28.814px]",children:re})}),i&&f.jsx("div",{className:"absolute content-stretch flex items-center left-[10px] md:left-[12.3px] px-[6.5px] md:px-[8px] py-[3.25px] md:py-[4px] top-[260.2px] md:top-[320.29px]",children:f.jsxs("div",{className:"content-stretch flex items-center relative shrink-0",children:[f.jsx("div",{className:"flex flex-col justify-center leading-[0] not-italic relative shrink-0 text-[14.6px] md:text-[18px] text-black text-center text-nowrap tracking-[0.15em]",style:{fontFamily:"'Courier New', monospace"},children:f.jsx("p",{className:"leading-[24.4px] md:leading-[30px]",children:l})}),u&&f.jsx("div",{className:"h-[24.4px] md:h-[30px] relative shrink-0 w-[1.6px] md:w-[2px] ml-[1.6px] md:ml-[2px] animate-blink",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 2 30",children:f.jsx("path",{d:"M1 2L1 28",stroke:"#0088FF",strokeLinecap:"round",strokeWidth:"2"})})}),f.jsx("input",{type:"text",value:l,onChange:ke=>d(ke.target.value),onFocus:()=>h(!0),onBlur:()=>{h(!1),l.trim()===""&&(a(!1),I(!1))},onKeyDown:ke=>{ke.key==="Enter"&&(ke.preventDefault(),I(!1),ke.currentTarget.blur())},placeholder:"",className:"absolute inset-0 opacity-0 cursor-text",style:{width:"300px"},maxLength:20})]})})]}),f.jsxs("div",{className:"content-stretch flex flex-col gap-[36px] items-center relative shrink-0",children:[f.jsx("div",{className:"content-stretch flex items-center px-[8px] py-0 relative rounded-[16px] shrink-0 w-full justify-center",children:f.jsxs("div",{className:"content-stretch flex md:flex-row flex-col gap-[10px] items-center justify-center relative shrink-0",children:[f.jsxs("div",{className:"bg-white content-stretch flex items-center md:p-[10px] p-[8px] relative rounded-[1000px] shrink-0 shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)] overflow-visible",children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/80 border-solid inset-0 pointer-events-none rounded-[1000px]"}),f.jsx("div",{className:"content-stretch flex md:gap-[18px] gap-[12px] items-center relative shrink-0 overflow-visible",children:jv.map(ke=>f.jsx(gP,{color:ke,isSelected:e?.id===ke.id,onClick:()=>t(ke)},ke.id))})]}),f.jsxs("div",{className:"flex gap-[10px] items-center",children:[f.jsx(Uc,{label:"Date",children:f.jsxs("div",{className:"bg-white content-stretch flex items-center p-[5px] relative rounded-[1000px] shrink-0 shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)]",children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/80 border-solid inset-0 pointer-events-none rounded-[1000px]"}),f.jsx("button",{onClick:ke=>{ke.stopPropagation(),s(!r),r||(T(!0),I(!1))},className:`relative rounded-[999px] shrink-0 size-[40px] cursor-pointer transition-all duration-300 ${r&&S?"bg-[#0088FF]":r?"bg-[#e5e7eb] hover:bg-[#d1d5db]":"bg-transparent hover:bg-[#e5e5e5]"}`,"aria-label":"Toggle date",children:f.jsx("div",{className:"absolute inset-0 flex items-center justify-center transition-colors duration-300",children:f.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:r&&S?"white":r?"#1f2937":"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),f.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),f.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),f.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})})]})}),f.jsx(Uc,{label:"Caption",children:f.jsxs("div",{className:"bg-white content-stretch flex items-center p-[5px] relative rounded-[1000px] shrink-0 shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)]",children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/80 border-solid inset-0 pointer-events-none rounded-[1000px]"}),f.jsx("button",{onClick:ke=>{ke.stopPropagation(),i?(a(!1),I(!1)):(a(!0),I(!0),T(!1),setTimeout(()=>{const je=document.querySelector('input[type="text"]');je&&je.focus()},100))},className:`relative rounded-[999px] shrink-0 size-[40px] cursor-pointer transition-all duration-300 ${i&&k?"bg-[#0088FF]":i?"bg-[#e5e7eb] hover:bg-[#d1d5db]":"bg-transparent hover:bg-[#e5e5e5]"}`,"aria-label":"Toggle text",children:f.jsx("div",{className:"absolute inset-0 flex items-center justify-center transition-colors duration-300",children:f.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:i&&k?"white":i?"#1f2937":"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("polyline",{points:"4 7 4 4 20 4 20 7"}),f.jsx("line",{x1:"9",y1:"20",x2:"15",y2:"20"}),f.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})]})})})]})})]})]})}),f.jsxs("div",{className:"content-stretch flex gap-[24px] items-center relative shrink-0",children:[f.jsxs("button",{className:"flex items-center gap-[8px] px-6 py-3 text-[17px] text-[rgba(60,60,67,0.5)] cursor-pointer rounded-[999px] hover:bg-[rgba(0,0,0,0.05)] transition-colors",onClick:de,children:[f.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),f.jsx("path",{d:"M3 3v5h5"})]}),f.jsx("span",{className:"font-['SF_Pro','-apple-system',sans-serif]",children:"Restart"})]}),f.jsxs("button",{className:`rounded-[999px] flex items-center gap-[8px] px-6 py-3 text-[17px] text-white transition-colors ${$?"bg-black cursor-pointer hover:bg-[rgba(0,0,0,0.8)]":"bg-gray-800 cursor-not-allowed opacity-50"}`,onClick:()=>$&&g(!0),disabled:!$,children:[f.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),f.jsx("polyline",{points:"16 6 12 2 8 6"}),f.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]}),f.jsx("span",{className:"font-['SF_Pro','-apple-system',sans-serif]",children:"Share"})]})]})]})]}),p&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 transition-opacity cursor-pointer z-40",style:{backgroundImage:"linear-gradient(90deg, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.05) 100%), linear-gradient(90deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.25) 100%)",opacity:.4},onClick:()=>g(!1)}),f.jsxs("div",{className:"fixed bg-white left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-[26px] z-50 max-h-[calc(100vh-40px)] max-h-[calc(100dvh-40px)] overflow-y-auto w-[calc(100%-32px)] sm:w-auto sm:min-w-[400px] md:min-w-[530px]",children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-[24px] sm:gap-[32px] items-center overflow-clip px-[20px] sm:px-[28px] md:px-[36px] py-[24px] sm:py-[30px] relative rounded-[inherit] w-full sm:min-w-[400px] md:min-w-[530px]",children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-[36px] items-center relative shrink-0 w-full",children:[f.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center leading-[0] min-w-full relative shrink-0 text-[22px] text-black tracking-[-0.26px] w-[min-content]",style:{fontVariationSettings:"'wdth' 100"},children:f.jsx("p",{className:"leading-[28px]",children:"Share Polaroid"})}),f.jsx("div",{className:"relative shrink-0 h-[198px] sm:h-[254.237px] w-[170px] sm:w-[218.074px]",style:{perspective:"800px"},children:f.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 transition-transform duration-300 ease-out scale-[0.78] sm:scale-100 origin-top hover:[transform:rotateY(-8deg)_rotateX(2deg)]",style:{width:"218.074px",height:"254.237px"},children:f.jsx("div",{className:"absolute content-stretch flex items-center justify-center left-0 rounded-[4.383px] shadow-[0px_2.192px_13.15px_0px_rgba(0,0,0,0.15)] top-0 w-[218.074px]",children:f.jsx("div",{className:"h-[254.237px] relative rounded-[4.383px] shrink-0 w-[218.074px]",children:f.jsxs("div",{className:"absolute contents left-0 top-0",children:[f.jsx("div",{className:"absolute contents left-0 top-0",children:f.jsx("div",{className:"absolute blur-[0.162px] filter h-[254.237px] left-0 rounded-[4.383px] top-0 w-[218.074px]",style:{backgroundColor:e?e.tint:"white"},children:f.jsx("div",{"aria-hidden":"true",className:"absolute border-[1.096px] border-solid border-gray-200/50 inset-[-1.096px] pointer-events-none rounded-[5.479px]",style:{borderColor:e?e.border:void 0}})})}),f.jsx("div",{className:"absolute content-stretch flex items-center left-0 pb-[49.313px] pt-[13.15px] px-[13.15px] rounded-[4.383px] top-0",style:{backgroundColor:e?e.tint:"white"},children:f.jsxs("div",{className:"relative rounded-[2.192px] shrink-0 size-[191.774px]",children:[f.jsx("div",{className:"overflow-clip relative rounded-[inherit] size-full",children:$?f.jsx("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden rounded-[3.733px] bg-[#f5f5f5]",children:f.jsx("img",{alt:"Polaroid photo",className:"max-w-full max-h-full w-auto h-auto object-contain",src:$})}):f.jsx("div",{className:"absolute inset-0 bg-[#f3f4f6] rounded-[3.733px] flex items-center justify-center",children:f.jsx("div",{className:"bg-[#e5e7eb] rounded-full w-[130px] h-[130px] flex items-center justify-center",children:f.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),f.jsx("polyline",{points:"17 8 12 3 7 8"}),f.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})})})}),f.jsx("div",{"aria-hidden":"true",className:"absolute border-[0.548px] border-solid border-gray-200/50 inset-0 pointer-events-none rounded-[2.192px]",style:{borderColor:e?`${e.fill}4D`:void 0}})]})}),r&&f.jsx("div",{className:"absolute flex flex-col justify-center leading-[0] left-[182.78px] not-italic text-[10.959px] text-[rgba(0,0,0,0.4)] text-center text-nowrap top-[239.88px] tracking-[0.15em] -translate-x-1/2 -translate-y-1/2",style:{fontFamily:"'Courier New', monospace"},children:f.jsx("p",{className:"leading-[18.629px]",children:re})}),l&&f.jsx("div",{className:"absolute content-stretch flex items-center left-[8.07px] px-[5.172px] py-[2.586px] top-[207.15px] w-[104.741px]",children:f.jsx("div",{className:"content-stretch flex items-center relative shrink-0",children:f.jsx("div",{className:"flex flex-col justify-center leading-[0] not-italic relative shrink-0 text-[12.931px] text-black text-center text-nowrap tracking-[0.15em]",style:{fontFamily:"'Courier New', monospace"},children:f.jsx("p",{className:"leading-[21.983px]",children:l})})})})]})})})})}),f.jsxs("div",{className:"content-stretch flex gap-[16px] sm:gap-[24px] items-center relative shrink-0 w-full",children:[f.jsxs("button",{onClick:pe,className:"group basis-0 bg-white grow h-[120px] sm:h-[140px] min-h-px min-w-px relative rounded-[16px] shrink-0 cursor-pointer hover:bg-gray-50 transition-all duration-300 ease-in-out",style:{backgroundImage:x?"linear-gradient(90deg, rgba(0, 0, 0, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)":void 0},children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[16px]"}),f.jsx("div",{className:"flex flex-col items-center size-full",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-[7px] items-center p-[24px] relative size-full",children:[f.jsxs("div",{className:"relative shrink-0 size-[70px]",children:[f.jsx("div",{className:`absolute bg-gray-100 group-hover:bg-gray-200 flex items-center justify-center rounded-full size-[70px] transition-all duration-300 ease-in-out ${x?"opacity-0 scale-75":"opacity-100 scale-100"}`,children:f.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),f.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}),f.jsx("div",{className:`absolute bg-[#08f] flex items-center justify-center left-[-2px] rounded-full size-[74px] top-[-2px] transition-all duration-300 ease-in-out ${x?"opacity-100 scale-100":"opacity-0 scale-75"}`,children:f.jsx("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:f.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),f.jsxs("div",{className:"relative h-[20px] overflow-visible",children:[f.jsx("p",{className:`font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${x?"opacity-0 translate-y-[-5px]":"opacity-100 translate-y-0"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Copy Link"}),f.jsx("p",{className:`absolute left-0 right-0 top-0 font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${x?"opacity-100 translate-y-0":"opacity-0 translate-y-[5px]"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Saved!"})]})]})})]}),f.jsxs("button",{onClick:ue,className:"group basis-0 bg-white grow h-[120px] sm:h-[140px] min-h-px min-w-px relative rounded-[16px] shrink-0 cursor-pointer hover:bg-gray-50 transition-all duration-300 ease-in-out",style:{backgroundImage:E?"linear-gradient(90deg, rgba(0, 0, 0, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)":void 0},children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[16px]"}),f.jsx("div",{className:"flex flex-col items-center size-full",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-[7px] items-center p-[24px] relative size-full",children:[f.jsxs("div",{className:"relative shrink-0 size-[70px]",children:[f.jsx("div",{className:`absolute bg-gray-100 group-hover:bg-gray-200 flex items-center justify-center rounded-full size-[70px] transition-all duration-300 ease-in-out ${E?"opacity-0 scale-75":"opacity-100 scale-100"}`,children:f.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),f.jsx("polyline",{points:"7 10 12 15 17 10"}),f.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),f.jsx("div",{className:`absolute bg-[#08f] flex items-center justify-center rounded-full size-[70px] transition-all duration-300 ease-in-out ${E?"opacity-100 scale-100":"opacity-0 scale-75"}`,children:f.jsx("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:f.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),f.jsxs("div",{className:"relative h-[15px]",children:[f.jsx("p",{className:`font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${E?"opacity-0 translate-y-[-5px]":"opacity-100 translate-y-0"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Download"}),f.jsx("p",{className:`absolute left-0 right-0 top-0 font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${E?"opacity-100 translate-y-0":"opacity-0 translate-y-[5px]"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Saved!"})]})]})})]})]})]}),f.jsx("button",{onClick:()=>g(!1),className:"absolute bg-white right-[17px] rounded-full size-[32px] top-[17px] cursor-pointer hover:bg-gray-100 transition-colors flex items-center justify-center",children:f.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(20,20,20,0.5)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),f.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),f.jsx("div",{className:"overflow-x-auto overflow-y-hidden w-[calc(100%+40px)] sm:w-auto md:w-[530px] mx-[-20px] sm:mx-0 scrollbar-hide",children:f.jsxs("div",{className:"content-stretch flex gap-[20px] sm:gap-[28px] items-start justify-start sm:justify-center pb-0 pt-0 px-[20px] sm:px-[4px] relative shrink-0 w-max sm:w-full",children:[f.jsxs("button",{onClick:()=>ge("Instagram"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[f.jsx("div",{className:"relative rounded-[18.928px] shrink-0 size-[69.402px]",children:f.jsx("img",{alt:"Instagram",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[18.928px] size-full",src:cP})}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"Instagram"})]}),f.jsxs("button",{onClick:()=>ge("LinkedIn"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[f.jsx("div",{className:"relative rounded-[17.35px] shrink-0 size-[69.402px]",children:f.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none rounded-[17.35px]",children:f.jsx("img",{alt:"LinkedIn",className:"absolute h-[1236.21%] left-[-168.97%] max-w-none top-[-256.03%] w-[568.97%]",src:dP})})}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"LinkedIn"})]}),f.jsxs("button",{onClick:()=>ge("Mail"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 cursor-pointer hover:brightness-90 transition-all",children:[f.jsx("div",{className:"relative rounded-[15px] shrink-0 size-[70px]",children:f.jsx("img",{alt:"Mail",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[15px] size-full",src:fP})}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px]",style:{fontVariationSettings:"'wdth' 100"},children:"Mail"})]}),f.jsxs("button",{onClick:()=>ge("X"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[f.jsx("div",{className:"h-[70px] relative rounded-[17.949px] shrink-0 w-[69.402px]",children:f.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none rounded-[17.949px]",children:f.jsx("img",{alt:"X",className:"absolute h-[1225.64%] left-[-39.66%] max-w-none top-[-671.79%] w-[568.97%]",src:hP})})}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"X"})]}),f.jsxs("button",{onClick:()=>ge("Messages"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[f.jsx("div",{className:"relative rounded-[18.928px] shrink-0 size-[69.402px]",children:f.jsx("img",{alt:"Messages",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[18.928px] size-full",src:uP})}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"Messages"})]})]})})]}),f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[26px]"})]})]}),f.jsx("style",{children:`
        @keyframes blink {
          0%, 49% { opacity: 1; }
          50%, 100% { opacity: 0; }
        }
        .animate-blink {
          animation: blink 1s infinite;
        }
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes scaleInCentered {
          from { 
            opacity: 0; 
            transform: scale(0.9);
          }
          to { 
            opacity: 1; 
            transform: scale(1);
          }
        }
        .animate-fade-in {
          animation: fadeIn 0.4s ease-in-out forwards;
        }
        .animate-scale-in-centered {
          animation: scaleInCentered 0.4s ease-in-out forwards;
        }
        .animate-fade-in-fast {
          animation: fadeIn 0.15s ease-out forwards;
        }
        .animate-scale-in-fast {
          animation: scaleInCentered 0.15s ease-out forwards;
        }
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
        .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        /* Polaroid page container - enable scrolling when content overflows */
        .polaroid-page-container {
          overflow-y: auto;
        }
      `})]})]})}function vP({book:n,onClick:e}){return f.jsxs("button",{onClick:e,className:"relative flex flex-col items-center w-[120px] sm:w-[136px] md:w-[148px] lg:w-[160px] h-[250px] sm:h-[280px] md:h-[320px] lg:h-[350px] group overflow-visible cursor-pointer",children:[f.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-0 h-[172px] sm:h-[197px] md:h-[222px] lg:h-[246.753px] w-[120px] sm:w-[136px] md:w-[148px] lg:w-[160px] rounded-sm shadow-[0px_4px_12px_0px_rgba(0,0,0,0.1)] transition-all duration-[400ms] ease-out group-hover:top-[-12px] group-hover:sm:top-[-14px] group-hover:md:top-[-16px] group-hover:lg:top-[-18px] group-hover:h-[176px] group-hover:sm:h-[202px] group-hover:md:h-[227px] group-hover:lg:h-[253px] group-hover:w-[123px] group-hover:sm:w-[139px] group-hover:md:w-[152px] group-hover:lg:w-[164px] group-hover:shadow-none",children:f.jsx("img",{alt:`${n.title} by ${n.author}`,className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-sm size-full",src:n.coverImage})}),f.jsxs("div",{className:"absolute top-[175px] sm:top-[200px] md:top-[225px] lg:top-[250px] left-1/2 -translate-x-1/2 w-[130px] sm:w-[140px] md:w-[150px] lg:w-[160px] flex flex-col items-center text-center leading-[0] opacity-0 transition-opacity duration-[400ms] ease-out group-hover:opacity-100",children:[f.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-medium justify-center relative shrink-0 text-base text-black",style:{fontVariationSettings:"'wdth' 100"},children:f.jsx("p",{className:"leading-normal line-clamp-2",children:n.title})}),f.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center relative shrink-0 text-base text-gray-500",style:{fontVariationSettings:"'wdth' 100"},children:f.jsx("p",{className:"leading-normal",children:n.author})}),f.jsxs("p",{className:"font-['DM_Sans:Medium','Noto_Sans_Symbols2:Regular',sans-serif] leading-normal not-italic relative shrink-0 text-[14px] sm:text-[15px] md:text-[16px] lg:text-[17px] text-black text-nowrap",children:[f.jsx("span",{className:"text-gray-500",children:"".repeat(n.rating)}),f.jsx("span",{className:"text-gray-200",children:"".repeat(5-n.rating)})]})]})]})}function yP(n){return n.split(/\n*-{3,}\n*/g).flatMap((t,r)=>{const s=[],i=t.trim();if(!i)return s;r>0&&s.push(f.jsx("div",{className:"w-full h-px bg-black/10 my-10"},`hr-${r}`));const a=/(\*\*[^*]+\*\*|\*[^*]+\*|<b>[^<]+<\/b>|<i>[^<]+<\/i>)/g;return i.split(a).forEach((d,u)=>{if(!d)return;const h=`${r}-${u}`;d.startsWith("**")&&d.endsWith("**")?s.push(f.jsx("strong",{children:d.slice(2,-2)},h)):d.startsWith("*")&&d.endsWith("*")&&!d.startsWith("**")?s.push(f.jsx("em",{children:d.slice(1,-1)},h)):d.startsWith("<b>")&&d.endsWith("</b>")?s.push(f.jsx("strong",{children:d.slice(3,-4)},h)):d.startsWith("<i>")&&d.endsWith("</i>")?s.push(f.jsx("em",{children:d.slice(3,-4)},h)):s.push(f.jsx("span",{children:d},h))}),s})}function EP({book:n,onClose:e}){const[t,r]=R.useState(!1);bo();const s=()=>{r(!0),setTimeout(()=>{e()},200)};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:`fixed inset-0 z-40 ${t?"animate-overlay-out":"animate-overlay-in"}`,style:{backgroundImage:"linear-gradient(90deg, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.05) 100%), linear-gradient(90deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.25) 100%)"},onClick:s}),f.jsxs("div",{className:`fixed left-1/2 top-1/2 z-50 flex flex-col gap-6 sm:gap-8 md:gap-10 p-6 sm:p-10 md:p-16 lg:p-20 rounded-2xl w-[calc(100vw-32px)] sm:w-[calc(100vw-80px)] md:w-[min(1137px,90vw)] max-h-[80vh] sm:max-h-[90vh] overflow-y-auto bg-white border border-[rgba(0,0,0,0.1)] shadow-[0px_4px_36px_0px_rgba(0,0,0,0.15)] ${t?"animate-modal-scale-out":"animate-modal-scale-in"}`,children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-8 sm:gap-9 md:gap-11 w-full",children:[f.jsx("div",{className:"w-[142px] h-[219px] shrink-0 mx-auto sm:mx-0 group cursor-pointer",children:f.jsx("img",{alt:`${n.title} by ${n.author}`,className:"w-full h-full object-cover rounded-md shadow-[0px_4px_12px_0px_rgba(0,0,0,0.1)] transition-transform duration-300 group-hover:rotate-[1deg]",src:n.coverImage})}),f.jsxs("div",{className:"flex flex-col gap-6 sm:gap-7 md:gap-8 flex-1 text-center sm:text-left",children:[f.jsxs("div",{className:"flex flex-col gap-0.5",children:[f.jsx("h2",{className:"font-['SF_Pro:Regular',sans-serif] font-medium text-xl text-black",style:{fontVariationSettings:"'wdth' 100"},children:n.title}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-lg text-gray-500",style:{fontVariationSettings:"'wdth' 100"},children:n.author})]}),f.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[n.rating>0&&f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-6 md:gap-8 lg:gap-10 items-center sm:items-center",children:[f.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400 sm:w-[88px] shrink-0",style:{fontVariationSettings:"'wdth' 100"},children:"Rating"}),f.jsxs("span",{className:"font-['DM_Sans:Medium','Noto_Sans_Symbols2:Regular',sans-serif] text-lg sm:text-[19px] md:text-xl",children:[f.jsx("span",{className:"text-gray-600",children:"".repeat(n.rating)}),f.jsx("span",{className:"text-gray-200",children:"".repeat(5-n.rating)})]})]}),(n.isFavorite||n.year)&&f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-6 md:gap-8 lg:gap-10 items-center sm:items-center",children:[f.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400 sm:w-[88px] shrink-0",style:{fontVariationSettings:"'wdth' 100"},children:"Shelf"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.isFavorite&&f.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full font-medium font-['SF_Pro:Regular',sans-serif] text-base sm:text-[16px] text-gray-600",style:{fontVariationSettings:"'wdth' 100"},children:"favorites"}),n.year&&f.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full font-medium font-['SF_Pro:Regular',sans-serif] text-base sm:text-[16px] text-gray-600",style:{fontVariationSettings:"'wdth' 100"},children:n.year})]})]}),n.dateRead&&f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-6 md:gap-8 lg:gap-10 items-center sm:items-center",children:[f.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400 sm:w-[88px] shrink-0",style:{fontVariationSettings:"'wdth' 100"},children:"Date Read"}),f.jsx("span",{className:"font-['SF_Pro:Regular',sans-serif] text-base text-gray-600",style:{fontVariationSettings:"'wdth' 100"},children:new Date(n.dateRead).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]}),n.review&&f.jsx("div",{className:"w-full bg-gray-200",style:{height:"1px",flexShrink:0}}),n.review&&f.jsxs("div",{className:"flex flex-col gap-4 -mt-2 sm:gap-6 w-full",children:[f.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400",style:{fontVariationSettings:"'wdth' 100"},children:"Review"}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-lg text-black leading-relaxed whitespace-pre-wrap",style:{fontVariationSettings:"'wdth' 100"},children:yP(n.review)})]})]})]})}function wP({className:n=""}){return f.jsx("svg",{className:n,width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M9 1V17M1 9H17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function bP({className:n=""}){return f.jsx("svg",{className:n,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M18.5 1.5L9 11M18.5 1.5L12.5 18.5L9 11M18.5 1.5L1.5 7.5L9 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}function SP({className:n=""}){return f.jsxs("svg",{className:n,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("circle",{cx:"10",cy:"10",r:"8.5",stroke:"currentColor",strokeWidth:"1.5"}),f.jsx("circle",{cx:"7",cy:"8",r:"1.25",fill:"currentColor"}),f.jsx("circle",{cx:"13",cy:"8",r:"1.25",fill:"currentColor"}),f.jsx("path",{d:"M6.5 12.5C7 13.5 8.3 14.5 10 14.5C11.7 14.5 13 13.5 13.5 12.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function TP({onClose:n,onAddBook:e}){const[t,r]=R.useState(""),[s,i]=R.useState(!1),a=()=>{t.trim()&&(e(t),i(!0),setTimeout(()=>{r(""),i(!1),n()},2e3))},l=d=>{d.key==="Enter"&&!s&&a()};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 z-40",onClick:n}),f.jsxs("div",{className:"absolute right-0 top-[calc(100%+12px)] z-50 bg-white rounded-[16px] w-[calc(100vw-40px)] sm:w-[420px] max-w-[420px] animate-modal-in",children:[f.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200 border-solid inset-0 pointer-events-none rounded-[16px] shadow-sm"}),f.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start p-[24px] relative w-full",children:[f.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center leading-[0] relative shrink-0 text-lg text-black w-full",style:{fontVariationSettings:"'wdth' 100"},children:f.jsxs("p",{className:"leading-[25px]",children:["Have a book suggestion?",f.jsx("br",{}),f.jsx("span",{className:"text-gray-500",children:"Drop it here! I'll check it out :) "})]})}),f.jsxs("div",{className:"content-stretch flex gap-2.5 items-center relative shrink-0 w-full",children:[f.jsxs("div",{className:"basis-0 bg-[#f5f5f5] grow h-[40px] min-h-px min-w-px relative rounded-[999px] shrink-0",children:[f.jsx("div",{"aria-hidden":"true",className:`absolute border-[1.5px] border-solid inset-0 pointer-events-none rounded-[999px] transition-colors duration-300 ${s?"border-[rgba(0,0,0,0.1)]":"border-[#2883de]"}`}),f.jsx("div",{className:"flex flex-row items-center size-full",children:f.jsx("div",{className:"content-stretch flex items-center px-[14px] relative size-full",children:s?f.jsx("div",{className:"content-stretch flex items-center relative shrink-0",children:f.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center relative shrink-0 text-[15px] text-[#2883de] text-nowrap transition-opacity duration-300",style:{fontVariationSettings:"'wdth' 100"},children:f.jsx("p",{children:"Thank you!"})})}):f.jsx("input",{type:"text",value:t,onChange:d=>r(d.target.value),onKeyDown:l,placeholder:"",className:"w-full bg-transparent outline-none font-['SF_Pro:Regular',sans-serif] font-normal text-[15px] text-[rgba(0,0,0,0.8)] transition-opacity duration-300",style:{fontVariationSettings:"'wdth' 100"},autoFocus:!0})})})]}),f.jsx("button",{onClick:a,disabled:!t.trim()||s,className:`flex items-center justify-center rounded-full shrink-0 size-[40px] transition-all duration-300 ${s?"bg-[#2883de]":"bg-[#2883de] hover:bg-[#2070ba]"} disabled:opacity-50 disabled:cursor-not-allowed`,children:f.jsx("div",{className:"flex items-center justify-center text-white",children:s?f.jsx(SP,{className:"w-[18px] h-[18px]"}):f.jsx(bP,{className:"w-[18px] h-[18px]"})})})]})]})]})]})}const _P={id:"library",title:"Personal Library",year:"2025",description:"My dream digital bookshelf",imageSrc:"https://image.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo/thumbnail.png",videoSrc:"https://stream.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo.m3u8",xLink:"https://x.com/michelletliu/status/1981030966044061894",tryItOutHref:"/library"};function kP(n){let e="";return n.cover?.asset?e=at(n.cover).width(400).url():n.externalCoverUrl&&(e=n.externalCoverUrl),{id:n._id,title:n.title,author:n.author||"Unknown Author",coverImage:e,rating:n.rating||0,year:n.year,isFavorite:n.isLibraryFavorite||!1,goodreadsUrl:n.goodreadsUrl,review:n.review,dateRead:n.dateRead}}function CP(){const n=Nn(),[e,t]=R.useState([]),[r,s]=R.useState([{value:"favorites",label:"favorites",isFavorites:!0}]),[i,a]=R.useState("favorites"),[l,d]=R.useState(null),[u,h]=R.useState(!1),[p,g]=R.useState(!1),[x,y]=R.useState(!1),[E,w]=R.useState(!1),[S,T]=R.useState(!0),[k,I]=R.useState(!0),L=R.useRef(null),O=R.useRef(null);R.useEffect(()=>{p?requestAnimationFrame(()=>{y(!0)}):y(!1)},[p]),R.useEffect(()=>{function D($){O.current&&!O.current.contains($.target)&&g(!1)}return p&&document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[p]),R.useEffect(()=>{async function D(){try{const[$,J]=await Promise.all([xt.fetch(V8),xt.fetch(G8)]),ne=$.map(kP);t(ne);const se=[{value:"favorites",label:"favorites",isFavorites:!0},{value:"all",label:"all",isAll:!0},...J.map(X=>({value:X,label:X}))];s(se)}catch($){console.error("Error fetching books:",$)}finally{I(!1)}}D()},[]);const P=i==="all"?e:i==="favorites"?e.filter(D=>D.isFavorite):e.filter(D=>D.year===i);R.useEffect(()=>{const D=setTimeout(()=>{T(!1)},50);return()=>clearTimeout(D)},[]);const j=()=>{w(!0),setTimeout(()=>{n("/")},280)},F=D=>{console.log("Book suggestion:",D)};return f.jsxs(f.Fragment,{children:[f.jsx(E0,{project:_P}),f.jsx("div",{className:"absolute top-0 left-0 pt-8 px-8 md:px-16 z-10",children:f.jsx("button",{ref:L,onClick:j,className:"cursor-pointer transition-opacity duration-200 hover:opacity-80","aria-label":"Go back to home",children:f.jsx("img",{src:Vi,alt:"Michelle Liu Logo",className:"size-[44px] object-contain"})})}),f.jsxs("div",{className:`relative min-h-screen w-full bg-white transition-all ${E?"opacity-0 scale-[0.985]":S?"opacity-0 scale-[1.01]":"opacity-100 scale-100"}`,style:{backgroundImage:"linear-gradient(90deg, rgba(0, 0, 0, 0.02) 0%, rgba(0, 0, 0, 0.02) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)",transitionDuration:E?"280ms":"300ms",transitionTimingFunction:E?"cubic-bezier(0.4, 0, 0.2, 1)":"ease-out"},children:[f.jsx("div",{className:"pt-8 px-8 md:px-16",children:f.jsxs("div",{className:"flex flex-col gap-10 md:gap-12 items-start pb-5 md:pb-6",children:[f.jsx("div",{className:"size-[44px] shrink-0"}),f.jsxs("div",{className:"flex items-start justify-between w-full",children:[f.jsxs("div",{className:"flex flex-col gap-3 items-start shrink-0",children:[f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal leading-[34px] relative shrink-0 text-[28px] text-black",style:{fontVariationSettings:"'wdth' 100"},children:"library"}),f.jsxs("div",{className:"relative",ref:O,children:[f.jsxs("button",{onClick:()=>g(!p),className:"flex shrink-0 items-center gap-1.5 rounded-full px-3 py-1.5 transition-colors cursor-pointer bg-gray-500/10",children:[f.jsxs("span",{className:"font-['Figtree',sans-serif] font-medium text-base tracking-[0.01em] whitespace-nowrap text-gray-500",children:[i,f.jsxs("span",{className:"text-gray-400",children:[" (",P.length,")"]})]}),f.jsx("svg",{className:ee("w-3 h-3 text-gray-400 transition-transform duration-200",p&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),f.jsx("div",{className:ee("absolute left-0 top-[calc(100%+4px)] bg-white rounded-lg shadow-lg border border-gray-100 z-50 w-36 transition-all duration-200 ease-out max-h-[300px] overflow-y-auto",p?"pointer-events-auto":"pointer-events-none",x?"opacity-100 translate-y-0":"opacity-0 -translate-y-1"),children:f.jsx("div",{className:"flex flex-col py-1.5 px-1.5",children:r.map(D=>{const $=i===D.value,J=D.isFavorites?e.filter(ne=>ne.isFavorite).length:D.isAll?e.length:e.filter(ne=>ne.year===D.value).length;return f.jsx("button",{onClick:()=>{a(D.value),g(!1)},className:ee("flex items-center px-3 py-1.5 rounded-md transition-colors text-left",$?"bg-gray-100":"hover:bg-gray-50"),children:f.jsxs("span",{className:ee("font-['Figtree',sans-serif] font-medium text-base tracking-[0.01em]",$?"text-gray-600":"text-gray-400"),children:[D.label,f.jsxs("span",{className:$?"text-gray-400":"text-gray-300",children:[" ","(",J,")"]})]})},D.value)})})})]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:()=>h(!u),className:"bg-gray-500/10 content-stretch flex items-center justify-center rounded-full size-[36px] hover:bg-[rgba(0,0,0,0.1)] transition-all duration-300",children:f.jsx("div",{className:`flex items-center justify-center text-gray-400 transition-transform duration-300 ${u?"rotate-45":"rotate-0"}`,children:f.jsx(wP,{className:"w-[14px] h-[14px]"})})}),u&&f.jsx(TP,{onClose:()=>h(!1),onAddBook:F})]})]})]})}),f.jsx("div",{className:"pt-6 md:pt-8 px-8 md:px-16 pb-[60px] md:pb-[100px]",children:f.jsx("div",{children:k?f.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx("div",{className:"w-8 h-8 border-2 border-[#e7e5e4] border-t-[#57534e] rounded-full animate-spin"}),f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-[16px] text-[rgba(0,0,0,0.4)]",children:"Loading books..."})]})}):P.length===0?f.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:f.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-[18px] text-[rgba(0,0,0,0.4)]",children:"No books on this shelf yet."})}):f.jsx("div",{className:"grid grid-cols-[repeat(3,auto)] md:grid-cols-[repeat(6,auto)] gap-y-14 sm:gap-y-12 md:gap-y-8 justify-between",children:P.map(D=>f.jsx(vP,{book:D,onClick:()=>d(D)},D.id))})})})]}),l&&f.jsx(EP,{book:l,onClose:()=>d(null)})]})}const IP="data:image/svg+xml,%3csvg%20width='38'%20height='63'%20viewBox='0%200%2038%2063'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.96875%2062.0215C5.58594%2062.0215%203.66211%2061.3184%202.19727%2059.9121C0.732422%2058.5254%200%2056.6895%200%2054.4043V7.61719C0%205.33203%200.732422%203.49609%202.19727%202.10938C3.66211%200.703125%205.58594%200%207.96875%200H29.6777C32.0801%200%2034.0039%200.703125%2035.4492%202.10938C36.9141%203.49609%2037.6465%205.33203%2037.6465%207.61719V54.4043C37.6465%2056.6895%2036.9141%2058.5254%2035.4492%2059.9121C34.0039%2061.3184%2032.0801%2062.0215%2029.6777%2062.0215H7.96875ZM8.58398%2057.3047H29.0918C30.3223%2057.3047%2031.2695%2056.9824%2031.9336%2056.3379C32.5977%2055.7129%2032.9297%2054.8145%2032.9297%2053.6426V8.37891C32.9297%207.20703%2032.5977%206.30859%2031.9336%205.68359C31.2695%205.03906%2030.3223%204.7168%2029.0918%204.7168H8.58398C7.33398%204.7168%206.37695%205.03906%205.71289%205.68359C5.04883%206.30859%204.7168%207.20703%204.7168%208.37891V53.6426C4.7168%2054.8145%205.04883%2055.7129%205.71289%2056.3379C6.37695%2056.9824%207.33398%2057.3047%208.58398%2057.3047ZM12.627%2055.166C12.2363%2055.166%2011.9043%2055.0391%2011.6309%2054.7852C11.377%2054.5312%2011.25%2054.1992%2011.25%2053.7891C11.25%2053.3789%2011.377%2053.0469%2011.6309%2052.793C11.9043%2052.5586%2012.2363%2052.4414%2012.627%2052.4414H25.0781C25.4688%2052.4414%2025.791%2052.5586%2026.0449%2052.793C26.2988%2053.0469%2026.4258%2053.3789%2026.4258%2053.7891C26.4258%2054.1992%2026.2988%2054.5312%2026.0449%2054.7852C25.791%2055.0391%2025.4688%2055.166%2025.0781%2055.166H12.627ZM15.293%2010.9277C14.707%2010.9277%2014.209%2010.7324%2013.7988%2010.3418C13.4082%209.93164%2013.2129%209.43359%2013.2129%208.84766C13.2129%208.28125%2013.4082%207.80273%2013.7988%207.41211C14.209%207.00195%2014.707%206.79688%2015.293%206.79688H22.3828C22.9492%206.79688%2023.4277%207.00195%2023.8184%207.41211C24.2285%207.80273%2024.4336%208.28125%2024.4336%208.84766C24.4336%209.43359%2024.2285%209.93164%2023.8184%2010.3418C23.4277%2010.7324%2022.9492%2010.9277%2022.3828%2010.9277H15.293Z'%20fill='%238E8E93'/%3e%3c/svg%3e",AP="data:image/svg+xml,%3csvg%20width='22'%20height='27'%20viewBox='0%200%2022%2027'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.10254%2026.0986C3.4668%2026.0986%202.2054%2025.6551%201.31836%2024.7681C0.439453%2023.8892%200%2022.6318%200%2020.9961V11.5967C0%209.9528%200.439453%208.69141%201.31836%207.8125C2.2054%206.93359%203.4668%206.49414%205.10254%206.49414H7.56836V8.45947H5.10254C4.10156%208.45947%203.32845%208.7321%202.7832%209.27734C2.23796%209.82259%201.96533%2010.5957%201.96533%2011.5967V20.9961C1.96533%2021.9971%202.23796%2022.7702%202.7832%2023.3154C3.32845%2023.8607%204.10156%2024.1333%205.10254%2024.1333H16.5527C17.5618%2024.1333%2018.339%2023.8607%2018.8843%2023.3154C19.4295%2022.7702%2019.7021%2021.9971%2019.7021%2020.9961V11.5967C19.7021%2010.5957%2019.4295%209.82259%2018.8843%209.27734C18.339%208.7321%2017.5618%208.45947%2016.5527%208.45947H14.0869V6.49414H16.5527C18.1966%206.49414%2019.458%206.93359%2020.3369%207.8125C21.224%208.69141%2021.6675%209.9528%2021.6675%2011.5967V20.9961C21.6675%2022.6318%2021.224%2023.8892%2020.3369%2024.7681C19.458%2025.6551%2018.1966%2026.0986%2016.5527%2026.0986H5.10254ZM10.8398%200C11.1003%200%2011.3241%200.0935872%2011.5112%200.280762C11.7065%200.467936%2011.8042%200.687663%2011.8042%200.939941V13.3545L11.6577%2016.6504C11.6414%2016.8701%2011.556%2017.0614%2011.4014%2017.2241C11.2467%2017.3869%2011.0596%2017.4683%2010.8398%2017.4683C10.612%2017.4683%2010.4207%2017.3869%2010.2661%2017.2241C10.1115%2017.0614%2010.026%2016.8701%2010.0098%2016.6504L9.86328%2013.3545V0.939941C9.86328%200.687663%209.95687%200.467936%2010.144%200.280762C10.3394%200.0935872%2010.5713%200%2010.8398%200ZM6.68945%2012.1582C6.96615%2012.1582%207.18994%2012.2559%207.36084%2012.4512L9.25293%2014.4653L10.8398%2016.1377L12.4146%2014.4653L14.3066%2012.4512C14.4694%2012.2559%2014.6891%2012.1582%2014.9658%2012.1582C15.2181%2012.1582%2015.4297%2012.2396%2015.6006%2012.4023C15.7715%2012.5651%2015.8569%2012.7686%2015.8569%2013.0127C15.8569%2013.2487%2015.7593%2013.4644%2015.564%2013.6597L11.5356%2017.5415C11.4136%2017.6636%2011.2956%2017.749%2011.1816%2017.7979C11.0758%2017.8385%2010.9619%2017.8589%2010.8398%2017.8589C10.7096%2017.8589%2010.5876%2017.8385%2010.4736%2017.7979C10.3678%2017.749%2010.2539%2017.6636%2010.1318%2017.5415L6.10352%2013.6597C5.9082%2013.4644%205.81055%2013.2487%205.81055%2013.0127C5.81055%2012.7686%205.89193%2012.5651%206.05469%2012.4023C6.22559%2012.2396%206.43717%2012.1582%206.68945%2012.1582Z'%20fill='%23333333'/%3e%3c/svg%3e",LP="data:image/svg+xml,%3csvg%20width='26'%20height='26'%20viewBox='0%200%2026%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M15.2832%2025.5737C14.7135%2025.5737%2014.3026%2025.3703%2014.0503%2024.9634C13.798%2024.5565%2013.5824%2024.0479%2013.4033%2023.4375L10.8398%2014.7339L2.02637%2012.146C1.44043%2011.967%200.956217%2011.7554%200.57373%2011.5112C0.191243%2011.259%200%2010.8521%200%2010.2905C0%209.85107%200.174967%209.47266%200.524902%209.15527C0.874837%208.83789%201.30615%208.58154%201.81885%208.38623L22.8149%200.341797C23.0998%200.236003%2023.3643%200.154622%2023.6084%200.0976562C23.8607%200.0325521%2024.0885%200%2024.292%200C24.6908%200%2025.0041%200.113932%2025.2319%200.341797C25.4598%200.569661%2025.5737%200.882975%2025.5737%201.28174C25.5737%201.49333%2025.5412%201.72119%2025.4761%201.96533C25.4191%202.20947%2025.3377%202.47396%2025.2319%202.75879L17.2363%2023.645C17.0085%2024.231%2016.7358%2024.6989%2016.4185%2025.0488C16.1011%2025.3988%2015.7227%2025.5737%2015.2832%2025.5737ZM11.3892%2012.8784L19.7876%204.47998C20.1213%204.14632%2020.516%203.79232%2020.9717%203.41797C21.4274%203.04362%2021.8587%202.69368%2022.2656%202.36816C21.8099%202.57975%2021.346%202.79948%2020.874%203.02734C20.4102%203.24707%2019.9341%203.45052%2019.4458%203.6377L2.94189%209.8877C2.85238%209.92025%202.79134%209.95687%202.75879%209.99756C2.72624%2010.0301%202.70996%2010.0667%202.70996%2010.1074C2.70996%2010.1481%202.72624%2010.1847%202.75879%2010.2173C2.79948%2010.2498%202.86865%2010.2783%202.96631%2010.3027L11.3892%2012.8784ZM15.4785%2022.8882C15.5192%2022.8882%2015.5558%2022.8678%2015.5884%2022.8271C15.6209%2022.7865%2015.6535%2022.7214%2015.686%2022.6318L21.936%206.12793C22.1232%205.63151%2022.3307%205.1473%2022.5586%204.67529C22.7865%204.20329%2023.0062%203.73535%2023.2178%203.27148C22.8923%203.68652%2022.5382%204.12598%2022.1558%204.58984C21.7814%205.05371%2021.4274%205.45247%2021.0938%205.78613L12.6953%2014.1846L15.271%2022.6074C15.3035%2022.7051%2015.332%2022.7743%2015.3564%2022.8149C15.389%2022.8638%2015.4297%2022.8882%2015.4785%2022.8882Z'%20fill='%23333333'/%3e%3c/svg%3e",Mv="data:image/svg+xml,%3csvg%20width='22'%20height='21'%20viewBox='0%200%2022%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.95898%2020.8618C7.47884%2020.8618%207.05566%2020.6258%206.68945%2020.1538L0.354004%2012.085C0.231934%2011.9385%200.142415%2011.792%200.0854492%2011.6455C0.0284831%2011.4909%200%2011.3403%200%2011.1938C0%2010.8602%200.109863%2010.5876%200.32959%2010.376C0.549316%2010.1562%200.830078%2010.0464%201.17188%2010.0464C1.57878%2010.0464%201.92871%2010.2458%202.22168%2010.6445L7.91016%2018.0908L18.8721%200.622559C19.0186%200.394694%2019.1691%200.236003%2019.3237%200.146484C19.4784%200.0488281%2019.6777%200%2019.9219%200C20.2555%200%2020.5241%200.101725%2020.7275%200.305176C20.931%200.508626%2021.0327%200.777181%2021.0327%201.11084C21.0327%201.25732%2021.0083%201.40381%2020.9595%201.55029C20.9106%201.68864%2020.8333%201.84326%2020.7275%202.01416L9.19189%2020.1782C8.89079%2020.634%208.47982%2020.8618%207.95898%2020.8618Z'%20fill='white'/%3e%3c/svg%3e",RP="data:image/svg+xml,%3csvg%20width='36'%20height='45'%20viewBox='0%200%2036%2045'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M10.9375%209.51172C10.4948%209.51172%2010.1172%209.36849%209.80469%209.08203C9.49219%208.78255%209.33594%208.40495%209.33594%207.94922C9.33594%207.51953%209.51172%207.13542%209.86328%206.79688L16.2695%200.605469C16.5169%200.371094%2016.7513%200.214844%2016.9727%200.136719C17.194%200.0455729%2017.4219%200%2017.6562%200C17.8906%200%2018.1185%200.0455729%2018.3398%200.136719C18.5612%200.214844%2018.7891%200.371094%2019.0234%200.605469L25.4492%206.79688C25.7878%207.13542%2025.957%207.51953%2025.957%207.94922C25.957%208.40495%2025.7943%208.78255%2025.4688%209.08203C25.1562%209.36849%2024.7786%209.51172%2024.3359%209.51172C23.8542%209.51172%2023.4505%209.32943%2023.125%208.96484L20.3516%205.99609L17.6562%202.73438L14.9609%205.99609L12.168%208.96484C11.8555%209.32943%2011.4453%209.51172%2010.9375%209.51172ZM17.6562%2029.0234C17.1615%2029.0234%2016.7318%2028.8477%2016.3672%2028.4961C16.0156%2028.1445%2015.8398%2027.7344%2015.8398%2027.2656V7.65625L16.1719%202.05078C16.1979%201.63411%2016.3477%201.28255%2016.6211%200.996094C16.9076%200.696615%2017.2526%200.546875%2017.6562%200.546875C18.0599%200.546875%2018.3984%200.696615%2018.6719%200.996094C18.9583%201.28255%2019.1146%201.63411%2019.1406%202.05078L19.4727%207.65625V27.2656C19.4727%2027.7344%2019.2904%2028.1445%2018.9258%2028.4961C18.5742%2028.8477%2018.151%2029.0234%2017.6562%2029.0234ZM8.37891%2044.7656C5.69661%2044.7656%203.6263%2044.0365%202.16797%2042.5781C0.722656%2041.1328%200%2039.069%200%2036.3867V21.3281C0%2018.6328%200.722656%2016.569%202.16797%2015.1367C3.6263%2013.6914%205.69661%2012.9688%208.37891%2012.9688H12.1484V16.7969H8.47656C6.99219%2016.7969%205.84635%2017.2005%205.03906%2018.0078C4.24479%2018.8021%203.84766%2019.9479%203.84766%2021.4453V36.2891C3.84766%2037.7734%204.24479%2038.9193%205.03906%2039.7266C5.84635%2040.5339%206.99219%2040.9375%208.47656%2040.9375H26.8164C28.3138%2040.9375%2029.4596%2040.5339%2030.2539%2039.7266C31.0612%2038.9193%2031.4648%2037.7734%2031.4648%2036.2891V21.4453C31.4648%2019.9479%2031.0612%2018.8021%2030.2539%2018.0078C29.4596%2017.2005%2028.3138%2016.7969%2026.8164%2016.7969H23.1445V12.9688H26.9141C29.6094%2012.9688%2031.6797%2013.6914%2033.125%2015.1367C34.5833%2016.569%2035.3125%2018.6328%2035.3125%2021.3281V36.3867C35.3125%2039.069%2034.5833%2041.1328%2033.125%2042.5781C31.6797%2044.0365%2029.6094%2044.7656%2026.9141%2044.7656H8.37891Z'%20fill='black'/%3e%3c/svg%3e",NP="/assets/fcadb86f9e7ac3194098e501064eb43213cdfff1-CAqEyYq2.png",DP="/assets/a643fce02520f3d992e6b432fa72fab473a1ca7e-Crr1K7le.png",PP="/assets/f81f194aee98efdd62a97e659006efa986492874-Cw7hLurS.png",OP="/assets/dd3b1a5ed7db644c197314328f647774bd86226e-gTVcV44l.png",jP="/assets/d215490446b5a00cb8bffe9167cdce65067a29ac-6arCD4Ou.png",MP="/assets/6d01b65a3f6d80963e9f7bc16d4214b718f19e63-BsB3QDpF.png",FP="/assets/a96b215a3998f46bd64e605040650bcf6eeedb40-90j5WTjl.png",UP="/assets/ed242d6b65d5ccb5cf614e9ecb48eb47cf46d29b-BMHuY85K.png",BP="/assets/7e1b9c12f8851b2eb04dc3a6cde488912f9c1662-fl5KXzZz.png",$P="/assets/b8fbffbd38baca46478d9cc48b9ea8682aec011f-CyFwkuNp.png",VP="/assets/d05a38e2f2b65e25e0e7c6f7fc308cfd490b8aef-Cu95k6uk.png",GP="/assets/c5d11845c52c0f03f2dbc26a4acdc83f8e1c322d-DAQSLF1a.png",HP={id:"screentime",title:"Screentime Receipt",year:"2025",description:"A receipt for your daily or weekly screentime.",imageSrc:"https://image.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI/thumbnail.png",videoSrc:"https://stream.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI.m3u8",xLink:"https://x.com/michelletliu/status/2000987498550383032",tryItOutHref:"/screentime"},br={instagram:NP,twitter:DP,linkedin:PP,messages:OP,calendar:jP,slack:MP,notes:FP,mail:UP,notion:BP,youtube:$P,netflix:VP,spotify:GP},qf={cellular:"M19.2 1.14623C19.2 0.513183 18.7224 0 18.1333 0H17.0667C16.4776 0 16 0.513183 16 1.14623V11.0802C16 11.7132 16.4776 12.2264 17.0667 12.2264H18.1333C18.7224 12.2264 19.2 11.7132 19.2 11.0802V1.14623ZM11.7659 2.44528H12.8326C13.4217 2.44528 13.8992 2.97078 13.8992 3.61902V11.0527C13.8992 11.7009 13.4217 12.2264 12.8326 12.2264H11.7659C11.1768 12.2264 10.6992 11.7009 10.6992 11.0527V3.61902C10.6992 2.97078 11.1768 2.44528 11.7659 2.44528ZM7.43411 5.09433H6.36745C5.77834 5.09433 5.30078 5.62652 5.30078 6.28301V11.0377C5.30078 11.6942 5.77834 12.2264 6.36745 12.2264H7.43411C8.02322 12.2264 8.50078 11.6942 8.50078 11.0377V6.28301C8.50078 5.62652 8.02322 5.09433 7.43411 5.09433ZM2.13333 7.53962H1.06667C0.477563 7.53962 0 8.06421 0 8.71132V11.0547C0 11.7018 0.477563 12.2264 1.06667 12.2264H2.13333C2.72244 12.2264 3.2 11.7018 3.2 11.0547V8.71132C3.2 8.06421 2.72244 7.53962 2.13333 7.53962Z",wifi:"M8.5713 2.46628C11.0584 2.46639 13.4504 3.38847 15.2529 5.04195C15.3887 5.1696 15.6056 5.16799 15.7393 5.03834L17.0368 3.77487C17.1045 3.70911 17.1422 3.62004 17.1417 3.52735C17.1411 3.43467 17.1023 3.34603 17.0338 3.28104C12.3028 -1.09368 4.83907 -1.09368 0.108056 3.28104C0.039524 3.34598 0.000639766 3.4346 7.82398e-06 3.52728C-0.000624118 3.61996 0.0370483 3.70906 0.104689 3.77487L1.40255 5.03834C1.53615 5.16819 1.75327 5.1698 1.88893 5.04195C3.69167 3.38836 6.08395 2.46628 8.5713 2.46628ZM8.56795 6.68656C9.92527 6.68647 11.2341 7.19821 12.2403 8.12234C12.3763 8.2535 12.5907 8.25065 12.7234 8.11593L14.0106 6.79663C14.0784 6.72742 14.1161 6.63355 14.1151 6.53599C14.1141 6.43844 14.0746 6.34536 14.0054 6.27757C10.9416 3.38672 6.19688 3.38672 3.13305 6.27757C3.06384 6.34536 3.02435 6.43849 3.02345 6.53607C3.02254 6.63365 3.06028 6.72752 3.12822 6.79663L4.41513 8.11593C4.54778 8.25065 4.76215 8.2535 4.89823 8.12234C5.90368 7.19882 7.21152 6.68713 8.56795 6.68656ZM11.0924 9.48011C11.0943 9.58546 11.0572 9.68703 10.9899 9.76084L8.81327 12.2156C8.74946 12.2877 8.66247 12.3283 8.5717 12.3283C8.48093 12.3283 8.39394 12.2877 8.33013 12.2156L6.1531 9.76084C6.08585 9.68697 6.04886 9.58537 6.05085 9.48002C6.05284 9.37467 6.09365 9.27491 6.16364 9.20429C7.55374 7.8904 9.58966 7.8904 10.9798 9.20429C11.0497 9.27497 11.0904 9.37476 11.0924 9.48011Z",batteryCap:"M26 4.78113V8.8566C26.8047 8.51143 27.328 7.70847 27.328 6.81886C27.328 5.92926 26.8047 5.1263 26 4.78113"};function Sr(n,e){return Math.floor(Math.random()*(e-n+1))+n}function Fv(n){const e=String(n.getMonth()+1).padStart(2,"0"),t=String(n.getDate()).padStart(2,"0"),r=String(n.getFullYear()).slice(-2);return`${e}/${t}/${r}`}function Kf(n){const e=Math.floor(n/60),t=n%60;return e===0?`${t}m`:`${e}h ${t}m`}function Uv(n){const e=new Date,t=Fv(e);let r;if(n==="weekly"){const a=new Date(e);a.setDate(a.getDate()-7),r=Fv(a)}else r=t;const s=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),i=n==="weekly"?7:1;return{period:n,startDate:r,endDate:t,generatedTime:s,categories:[{name:"SOCIAL & COMMUNICATION",apps:[{name:"INSTAGRAM",category:"SOCIAL MEDIA",minutes:Sr(30,180)*i,icon:br.instagram},{name:"TWITTER/X",category:"SOCIAL MEDIA",minutes:Sr(20,120)*i,icon:br.twitter},{name:"LINKEDIN",category:"SOCIAL MEDIA",minutes:Sr(40,200)*i,icon:br.linkedin},{name:"MESSAGES",category:"COMMUNICATION",minutes:Sr(10,60)*i,icon:br.messages}]},{name:"WORK & PRODUCTIVITY",apps:[{name:"CALENDAR",category:"PRODUCTIVITY",minutes:Sr(10,40)*i,icon:br.calendar},{name:"SLACK",category:"WORK",minutes:Sr(60,180)*i,icon:br.slack},{name:"NOTES",category:"PRODUCTIVITY",minutes:Sr(5,30)*i,icon:br.notes},{name:"MAIL",category:"WORK",minutes:Sr(30,90)*i,icon:br.mail},{name:"NOTION",category:"PRODUCTIVITY",minutes:Sr(20,80)*i,icon:br.notion}]},{name:"ENTERTAINMENT",apps:[{name:"YOUTUBE",category:"ENTERTAINMENT",minutes:Sr(60,240)*i,icon:br.youtube},{name:"NETFLIX",category:"STREAMING",minutes:Sr(30,150)*i,icon:br.netflix},{name:"SPOTIFY",category:"MUSIC",minutes:Sr(60,300)*i,icon:br.spotify}]}]}}function qP(n){const e=n/60;return e<2?{main:"IMPRESSIVE!",message:"You're crushing it! "}:e<4?{main:"NICE WORK!",message:"You're doing great! "}:e<6?{main:"NOT BAD!",message:`Pretty good! 
Maybe add a walk to your day?`}:e<10?{main:"TIME FOR A BREAK!",message:"Go touch some grass "}:e<15?{main:"TIME FOR A BREAK!",message:"Your eyes need a rest! "}:e<20?{main:"EMERGENCY!",message:"Touch grass IMMEDIATELY "}:{main:"ARE YOU OKAY?",message:"There's a world outside! "}}function KP(){const n=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!1});return f.jsxs("div",{className:"md:hidden",children:[f.jsx("div",{className:"absolute bg-gradient-to-b from-[#f3f4f6] from-[32.87%] h-[108px] left-1/2 to-transparent top-0 -translate-x-1/2 w-[402px] max-w-full"}),f.jsxs("div",{className:"absolute flex gap-[154px] items-center justify-center left-1/2 pb-[19px] pt-[21px] px-[16px] top-0 -translate-x-1/2 w-[402px] max-w-full",children:[f.jsx("div",{className:"basis-0 flex grow h-[22px] items-center justify-center min-h-px min-w-px pb-0 pt-[2px] px-0 relative shrink-0",children:f.jsx("p",{className:"font-mono font-semibold leading-[22px] relative shrink-0 text-[17px] text-black text-center text-nowrap",children:n})}),f.jsxs("div",{className:"basis-0 flex gap-[7px] grow h-[22px] items-center justify-center min-h-px min-w-px pb-0 pt-px px-0 relative shrink-0",children:[f.jsx("div",{className:"relative shrink-0 h-[12.226px] w-[19.2px]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 19.2 12.2264",children:f.jsx("path",{clipRule:"evenodd",d:qf.cellular,fill:"black",fillRule:"evenodd"})})}),f.jsx("div",{className:"relative shrink-0 h-[12.328px] w-[17.142px]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 17.1417 12.3283",children:f.jsx("path",{clipRule:"evenodd",d:qf.wifi,fill:"black",fillRule:"evenodd"})})}),f.jsx("div",{className:"h-[13px] relative shrink-0 w-[27.328px]",children:f.jsxs("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 27.328 13",children:[f.jsx("rect",{height:"12",opacity:"0.35",rx:"3.8",stroke:"black",width:"24",x:"0.5",y:"0.5"}),f.jsx("path",{d:qf.batteryCap,fill:"black",opacity:"0.4"}),f.jsx("rect",{fill:"black",height:"9",rx:"2.5",width:"21",x:"2",y:"2"})]})})]})]})]})}function zP({additionalClassNames:n=""}){return f.jsx("div",{className:`md:hidden absolute h-[34px] left-1/2 -translate-x-1/2 w-[400px] max-w-full ${n}`,children:f.jsx("div",{className:"absolute bottom-[8px] flex h-[5px] items-center justify-center left-1/2 -translate-x-1/2 w-[144px]",children:f.jsx("div",{className:"flex-none rotate-180 scale-y-[-1]",children:f.jsx("div",{className:"bg-black h-[5px] rounded-[100px] w-[144px]"})})})})}function WP({period:n,onPeriodChange:e,onGenerate:t,onUploadClick:r}){return f.jsxs("div",{className:"absolute flex flex-col items-center gap-3 justify-center size-full",children:[f.jsxs("div",{className:"bg-white flex flex-col gap-[24px] items-center px-[48px] py-[32px] rounded-[26px] shadow-[0px_2px_8px_rgba(0,0,0,0.1)] max-w-[90%]",children:[f.jsx("div",{className:"bg-[rgba(116,116,128,0.08)] flex flex-col items-center justify-center p-[10px] relative rounded-full shrink-0 size-[120px]",children:f.jsx("img",{src:IP,alt:"Phone",className:"w-[38px] h-[63px]"})}),f.jsxs("div",{className:"font-mono leading-[28px] relative shrink-0 text-[22px] text-black text-center text-nowrap",children:[f.jsx("p",{className:"mb-0",children:"SCREEN TIME"}),f.jsx("p",{children:"RECEIPT"})]}),f.jsx("div",{className:"flex items-start relative shrink-0",children:f.jsxs("div",{className:"bg-[rgba(118,118,128,0.12)] flex h-[36px] items-center justify-center overflow-clip px-[8px] py-[4px] relative rounded-[100px] shrink-0 w-[209px]",children:[f.jsx("button",{onClick:()=>e("daily"),className:"basis-0 grow h-full min-h-px min-w-px relative rounded-[7px] shrink-0 cursor-pointer",children:f.jsx("div",{className:"flex flex-row items-center size-full",children:f.jsxs("div",{className:"flex items-center px-[10px] py-[2px] relative size-full",children:[n==="daily"&&f.jsx("div",{className:"absolute bg-white inset-[0_-4.5px_0_-4px] rounded-[20px] shadow-[0px_2px_20px_rgba(0,0,0,0.06)]"}),f.jsx("p",{className:`basis-0 font-mono ${n==="daily"?"font-semibold":"font-medium"} grow leading-[18px] min-h-px min-w-px overflow-ellipsis overflow-hidden relative shrink-0 text-[14px] text-black text-center text-nowrap tracking-[-0.08px]`,children:"Daily"})]})})}),f.jsx("button",{onClick:()=>e("weekly"),className:"basis-0 grow h-full min-h-px min-w-px relative shrink-0 cursor-pointer",children:f.jsx("div",{className:"flex flex-row items-center size-full",children:f.jsxs("div",{className:"flex items-center px-[10px] py-[3px] relative size-full",children:[n==="weekly"&&f.jsx("div",{className:"absolute bg-white inset-[0_-4.5px_0_-4px] rounded-[20px] shadow-[0px_2px_20px_rgba(0,0,0,0.06)]"}),f.jsx("p",{className:`basis-0 font-mono ${n==="weekly"?"font-semibold":"font-medium"} grow leading-[18px] min-h-px min-w-px overflow-ellipsis overflow-hidden relative shrink-0 text-[14px] text-black text-center text-nowrap`,children:"Weekly"})]})})})]})}),f.jsx("div",{className:"flex flex-col gap-3",children:f.jsx("button",{onClick:t,className:"bg-[#404040] flex items-center justify-center px-6 py-[10px] relative rounded-full shrink-0 cursor-pointer hover:bg-[#333] transition-colors w-full",children:f.jsx("p",{className:"font-mono leading-normal relative shrink-0 text-[15px] text-center text-nowrap text-white tracking-[0.75px]",children:"GENERATE"})})})]}),f.jsxs("button",{onClick:r,className:"flex items-center justify-center gap-3.5 px-6 py-2 relative shrink-0 cursor-pointer transition-colors group",children:[f.jsx("img",{src:RP,alt:"",className:"h-[15px] w-auto opacity-50 group-hover:opacity-70 transition-opacity"}),f.jsx("p",{className:"font-mono leading-normal relative shrink-0 text-[15px] text-center text-nowrap text-gray-500 group-hover:text-gray-700 tracking-[0.5px] transition-colors",children:"UPLOAD YOUR OWN DATA"})]})]})}function YP({appName:n,icon:e}){const t="relative shrink-0 size-[44px]";switch(n){case"INSTAGRAM":return f.jsx("div",{className:`${t} rounded-[12px]`,children:f.jsx("img",{alt:"",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[12px] size-full",src:e})});case"TWITTER/X":return f.jsx("div",{className:"h-[44.379px] relative rounded-[11.379px] shrink-0 w-[44px] overflow-hidden",children:f.jsx("img",{alt:"",className:"absolute h-[1225.64%] left-[-39.66%] max-w-none top-[-671.79%] w-[568.97%]",src:e})});case"LINKEDIN":return f.jsx("div",{className:`${t} rounded-[11px] overflow-hidden`,children:f.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-168.97%] max-w-none top-[-256.03%] w-[568.97%]",src:e})});case"MESSAGES":return f.jsx("div",{className:t,children:f.jsx("img",{alt:"",className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",src:e})});case"CALENDAR":return f.jsx("div",{className:`${t} rounded-[10.891px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] overflow-hidden`,children:f.jsx("img",{alt:"",className:"absolute h-[1419.8%] left-[-500.99%] max-w-none top-[-301.98%] w-[653.47%]",src:e})});case"SLACK":return f.jsx("div",{className:"h-[44px] relative rounded-[11.759px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] shrink-0 w-[44.379px] overflow-hidden",children:f.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-167.52%] max-w-none top-[-115.52%] w-[564.1%]",src:e})});case"NOTES":return f.jsx("div",{className:t,children:f.jsx("img",{alt:"",className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",src:e})});case"MAIL":return f.jsx("div",{className:"h-[44px] relative shrink-0 w-[44.25px] overflow-hidden",children:f.jsx("img",{alt:"",className:"absolute h-[814.77%] left-[-16.95%] max-w-none top-[-107.95%] w-[372.88%]",src:e})});case"NOTION":return f.jsx("div",{className:`${t} rounded-[11.327px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] overflow-hidden`,children:f.jsx("img",{alt:"",className:"absolute h-[1419.8%] left-[-351.49%] max-w-none top-[-301.98%] w-[653.47%]",src:e})});case"YOUTUBE":return f.jsx("div",{className:"h-[44px] relative rounded-[11.658px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] shrink-0 w-[43.624px] overflow-hidden",children:f.jsx("img",{alt:"",className:"absolute h-[1225.64%] left-[-300%] max-w-none top-[-811.11%] w-[568.97%]",src:e})});case"NETFLIX":return f.jsx("div",{className:"h-[43.254px] relative rounded-[11.186px] shrink-0 w-[44px] overflow-hidden",children:f.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-422.03%] max-w-none top-[-818.1%] w-[559.32%]",src:e})});case"SPOTIFY":return f.jsx("div",{className:"h-[43.254px] relative rounded-[10.814px] shrink-0 w-[44px] overflow-hidden",children:f.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-294.07%] max-w-none top-[-115.52%] w-[559.32%]",src:e})});default:return f.jsx("div",{className:`${t} rounded-[12px] overflow-hidden`,children:f.jsx("img",{alt:"",className:"max-w-none object-cover pointer-events-none size-full",src:e})})}}function QP({data:n,onSave:e,onShare:t,onGenerateNew:r}){const[s,i]=R.useState(!1),[a,l]=R.useState(!1),[d,u]=R.useState(!1),h=R.useRef(null),p=n.categories.reduce((E,w)=>E+w.apps.reduce((S,T)=>S+T.minutes,0),0),g=async()=>{if(!(!h.current||d)){u(!0);try{const E=await Sw(h.current,{scale:3,backgroundColor:"#ffffff"}),w=document.createElement("a");w.href=E;const S=new Date().toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}).replace(/\//g,".");w.download=`ScreenTimeReceipt_${S}.png`,document.body.appendChild(w),w.click(),document.body.removeChild(w),u(!1),i(!0),setTimeout(()=>i(!1),2e3)}catch(E){console.error("Failed to save receipt:",E),u(!1)}}},x=async()=>{if(navigator.share)try{await navigator.share({title:"Screen Time Receipt",text:`Check out my ${n.period==="weekly"?"weekly":"daily"} screen time receipt!`,url:window.location.href}),l(!0),setTimeout(()=>l(!1),2e3)}catch(E){console.log("Share cancelled:",E)}else t(),l(!0),setTimeout(()=>l(!1),2e3)},y=qP(p);return f.jsxs("div",{className:"absolute flex flex-col gap-[24px] items-center left-1/2 top-[86px] md:top-[40px] -translate-x-1/2 w-[337px] max-w-[90%] pb-[100px] animate-slide-in transition-transform duration-400",children:[f.jsx("div",{ref:h,className:"bg-white relative shadow-md shrink-0 w-full border border-gray-200",children:f.jsx("div",{className:"flex flex-col items-center size-full",children:f.jsxs("div",{className:"flex flex-col gap-[32px] items-center px-[24px] py-[32px] relative w-full",children:[f.jsx("div",{className:"flex flex-col gap-[24px] items-center relative shrink-0 w-full",children:f.jsxs("div",{className:"flex flex-col font-mono gap-[4px] items-center relative shrink-0 text-center w-[201px] max-w-full",children:[f.jsx("p",{className:"leading-[22px] min-w-full relative shrink-0 text-[17px] text-black font-semibold",children:"DIGITAL RECEIPT"}),f.jsxs("p",{className:"leading-[22px] relative shrink-0 text-[13px] text-gray-400 text-nowrap",children:[n.period==="weekly"?"Weekly":"Daily"," Screen Time Summary"]}),f.jsxs("div",{className:"leading-[22px] relative shrink-0 text-[13px] text-gray-500 text-nowrap",children:[f.jsxs("p",{className:"mb-0",children:[n.startDate," - ",n.endDate]}),f.jsxs("p",{children:["Generated ",n.generatedTime]})]})]})}),n.categories.map((E,w)=>{const S=E.apps.reduce((T,k)=>T+k.minutes,0);return f.jsxs("div",{className:"flex flex-col gap-[16px] items-start relative shrink-0 w-full",children:[f.jsxs("div",{className:"flex flex-col gap-[4px] items-start relative shrink-0 w-full",children:[f.jsx("p",{className:"font-mono leading-[22px] font-semibold relative shrink-0 text-[13px] text-black w-full",children:E.name}),f.jsx("div",{className:"h-0 relative shrink-0 w-full",children:f.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:f.jsx("line",{stroke:"gray",strokeOpacity:"0.3",x2:"289",y1:"0.5",y2:"0.5"})})})})]}),E.apps.map((T,k)=>f.jsxs("div",{className:"flex gap-[16px] items-center relative shrink-0 w-full",children:[f.jsx(YP,{appName:T.name,icon:T.icon}),f.jsxs("div",{className:"basis-0 flex font-mono grow items-start justify-between leading-[22px] min-h-px min-w-px relative shrink-0 text-[13px]",children:[f.jsxs("div",{className:"flex flex-col items-start relative shrink-0 w-[97px]",children:[f.jsx("p",{className:"min-w-full relative shrink-0 text-black font-semibold",children:T.name}),f.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.4)] text-center text-nowrap",children:T.category})]}),f.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.4)] text-center text-nowrap font-semibold",children:Kf(T.minutes)})]})]},k)),f.jsxs("div",{className:"flex flex-col gap-[8px] items-start relative shrink-0 w-full",children:[f.jsx("div",{className:"h-0 relative shrink-0 w-full",children:f.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:f.jsx("line",{stroke:"black",strokeDasharray:"2 2",strokeOpacity:"0.3",x2:"289",y1:"0.5",y2:"0.5"})})})}),f.jsxs("div",{className:"flex font-mono items-start justify-between leading-[22px] relative shrink-0 text-[13px] w-full font-semibold",children:[f.jsx("p",{className:"relative self-stretch shrink-0 text-[rgba(0,0,0,0.5)] w-[97px]",children:"SUBTOTAL:"}),f.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.4)] text-center text-nowrap",children:Kf(S)})]})]})]},w)}),f.jsxs("div",{className:"flex flex-col gap-[24px] items-center relative shrink-0 w-full",children:[f.jsxs("div",{className:"flex flex-col gap-[14px] items-start relative shrink-0 w-full",children:[f.jsx("div",{className:"h-0 relative shrink-0 w-full",children:f.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:f.jsx("line",{stroke:"black",strokeDasharray:"6 3",x2:"289",y1:"0.5",y2:"0.5"})})})}),f.jsxs("div",{className:"flex font-mono items-start justify-between leading-[22px] relative shrink-0 text-[17px] text-nowrap w-full font-semibold",children:[f.jsx("p",{className:"relative shrink-0 text-black",children:"GRAND TOTAL:"}),f.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.8)] text-center",children:Kf(p)})]}),f.jsx("div",{className:"h-0 relative shrink-0 w-full",children:f.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:f.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:f.jsx("line",{stroke:"black",strokeDasharray:"6 3",x2:"289",y1:"0.5",y2:"0.5"})})})})]}),f.jsxs("div",{className:"flex flex-col font-mono gap-[16px] items-start relative shrink-0 text-center w-full ",children:[f.jsx("p",{className:"leading-[22px] relative shrink-0 text-[17px] font-semibold text-gray-500 w-full",children:y.main}),f.jsxs("div",{className:"leading-[22px] relative shrink-0 text-[15px] text-gray-400 font-medium w-full whitespace-pre-line",children:[f.jsx("p",{className:"mb-0",children:"Recommendation:"}),f.jsx("p",{children:y.message})]})]})]})]})})}),f.jsxs("div",{className:"flex gap-[24px] items-center justify-center px-0 py-[16px] relative shrink-0 w-full",children:[f.jsx("button",{onClick:g,disabled:d,className:"flex flex-col items-start relative shrink-0 cursor-pointer group disabled:cursor-default",children:f.jsxs("div",{className:"flex flex-col gap-[7px] items-center relative shrink-0 w-[78px]",children:[f.jsx("div",{className:`flex items-center justify-center relative rounded-full shrink-0 size-[70px] transition-colors ${s?"bg-[#08f]":d?"bg-[#ededed]":"bg-[#ededed] group-hover:bg-[#e0e0e0]"}`,children:d?f.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-500 rounded-full animate-spin"}):s?f.jsx("img",{src:Mv,alt:"Saved",className:"w-[22px] h-[21px]"}):f.jsx("img",{src:AP,alt:"Save",className:"w-[22px] h-[27px]"})}),f.jsx("p",{className:"font-mono font-normal leading-[15px] overflow-ellipsis overflow-hidden relative shrink-0 text-[#333] text-[13px] text-center text-nowrap tracking-[-0.1px]",children:d?"Saving...":s?"Saved":"Save"})]})}),f.jsx("button",{onClick:x,className:"flex flex-col items-start relative shrink-0 cursor-pointer group",children:f.jsxs("div",{className:"flex flex-col gap-[7px] items-center relative shrink-0 w-[78px]",children:[f.jsx("div",{className:`flex items-center justify-center relative rounded-full shrink-0 size-[70px] transition-colors ${a?"bg-[#08f]":"bg-[#ededed] group-hover:bg-[#e0e0e0]"}`,children:a?f.jsx("img",{src:Mv,alt:"Shared",className:"w-[22px] h-[21px]"}):f.jsx("img",{src:LP,alt:"Share",className:"w-[26px] h-[26px]"})}),f.jsx("p",{className:"font-mono font-normal leading-[15px] overflow-ellipsis overflow-hidden relative shrink-0 text-[#333] text-[13px] text-center text-nowrap tracking-[-0.1px]",children:a?"Shared":"Share"})]})})]}),f.jsx("button",{onClick:r,className:"h-[22px] relative shrink-0 w-[204px] cursor-pointer",children:f.jsx("p",{className:"absolute font-mono inset-0 leading-[22px] text-[15px] text-[rgba(0,0,0,0.5)] text-center text-nowrap hover:text-[rgba(0,0,0,0.7)] transition-colors font-semibold",children:" Generate New Receipt"})})]})}function XP({onClose:n}){const e=[{name:"Ashley",emoji:""},{name:"Jordan",emoji:""},{name:"Gary and Tasha",emoji:""},{name:"Steven",emoji:""}],t=[{name:"AirDrop",icon:"",color:"bg-blue-500"},{name:"Messages",icon:"",color:"bg-green-500"},{name:"Mail",icon:"",color:"bg-blue-400"},{name:"Notes",icon:"",color:"bg-yellow-300"}],r=[{name:"Copy",icon:""},{name:"Add to Favorites",icon:""},{name:"Add to Reading List",icon:""},{name:"Add Bookmark",icon:""}],s=i=>{alert(`${i} clicked! (This is a demo)`),n()};return f.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/20 animate-fade-in",onClick:n,children:f.jsxs("div",{className:"bg-white rounded-t-[20px] w-full max-w-[402px] pb-8 animate-slide-in max-h-[90vh] overflow-y-auto",onClick:i=>i.stopPropagation(),children:[f.jsx("div",{className:"flex items-center justify-center px-8 py-3 border-b border-gray-200",children:f.jsx("h3",{className:"font-mono text-[15px] font-semibold",children:"Screen Time Receipt"})}),f.jsx("p",{className:"text-center text-[13px] text-gray-400 font-mono py-2",children:"Weekly Time Summary"}),f.jsx("div",{className:"px-8 py-3",children:f.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:e.map((i,a)=>f.jsxs("button",{className:"flex flex-col items-center gap-1 min-w-[60px]",children:[f.jsx("div",{className:"w-[60px] h-[60px] rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-3xl",children:i.emoji}),f.jsx("span",{className:"text-[11px] text-gray-700 font-mono truncate w-full text-center",children:i.name})]},a))})}),f.jsx("div",{className:"px-8 py-3 border-t border-gray-200",children:f.jsx("div",{className:"flex gap-4 justify-around",children:t.map((i,a)=>f.jsxs("button",{className:"flex flex-col items-center gap-1",children:[f.jsx("div",{className:`w-[60px] h-[60px] rounded-[15px] ${i.color} flex items-center justify-center text-3xl shadow-sm`,children:i.icon}),f.jsx("span",{className:"text-[11px] text-gray-700 font-mono",children:i.name})]},a))})}),f.jsx("div",{className:"px-8 py-3 border-t border-gray-200 space-y-1",children:r.map((i,a)=>f.jsxs("button",{className:"flex items-center gap-3 w-full py-3 px-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:()=>s(i.name),children:[f.jsx("span",{className:"text-2xl",children:i.icon}),f.jsx("span",{className:"text-[15px] text-gray-900 font-mono",children:i.name})]},a))})]})})}function ZP({onClose:n,onUploadSuccess:e}){const[t,r]=R.useState(null),[s,i]=R.useState(!1),a=l=>{const d=l.target.files?.[0];if(!d)return;if(!d.type.startsWith("image/")){r("Please upload an image file (PNG, JPG, etc.)");return}if(d.size>10*1024*1024){r("Image is too large. Please upload a file under 10MB.");return}r(null),i(!0);const u=new FileReader;u.onload=h=>{const p=new Image;p.onload=()=>{const g=p.height>p.width,x=p.width>=300&&p.height>=400;if(!g){i(!1),r("Please upload a portrait screenshot from your phone's Screen Time settings.");return}if(!x){i(!1),r("Image is too small. Please upload a full-resolution screenshot.");return}setTimeout(()=>{i(!1),e()},500)},p.onerror=()=>{i(!1),r("Could not read the image. Please try a different file.")},p.src=h.target?.result},u.onerror=()=>{i(!1),r("Could not read the file. Please try again.")},u.readAsDataURL(d)};return f.jsx("div",{className:"fixed inset-0 z-10000 flex items-center justify-center bg-black/5 animate-fade-in p-4",onClick:n,children:f.jsxs("div",{className:"bg-white rounded-[20px] py-2 pb-4 w-full max-w-[500px] max-h-[90vh] overflow-y-auto shadow-md animate-slide-in",onClick:l=>l.stopPropagation(),children:[f.jsx("div",{className:"top-0 bg-white flex items-center justify-center px-12 pt-8 rounded-t-[20px]",children:f.jsx("h2",{className:"font-mono text-lg text-black font-semibold",children:"Upload Your Screen Time Data"})}),f.jsxs("div",{className:"px-12 py-6 space-y-6 font-mono text-[15px]",children:[f.jsx("div",{className:"border-t border-gray-200"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"font-['Figtree'] text-base text-black font-semibold",children:"iPhone"}),f.jsxs("ol",{className:"font-['Figtree'] space-y-3 pl-10 list-decimal text-gray-500 leading-normal",children:[f.jsxs("li",{children:["Open ",f.jsx("strong",{children:"Settings"})]}),f.jsxs("li",{children:["Scroll down and tap ",f.jsx("strong",{children:"Screen Time"})]}),f.jsxs("li",{children:["Tap ",f.jsx("strong",{children:"See All Activity"})]}),f.jsxs("li",{children:["Choose ",f.jsx("strong",{children:"Week"})," or ",f.jsx("strong",{children:"Day"})," at the top"]}),f.jsx("li",{children:"Take a screenshot (Side Button + Volume Up)"})]})]}),f.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-3",children:[f.jsx("h3",{className:"font-mono text-base text-black font-semibold",children:"Android"}),f.jsxs("ol",{className:"font-['Figtree'] space-y-3 pl-10 list-decimal text-gray-500 leading-normal",children:[f.jsxs("li",{children:["Open ",f.jsx("strong",{children:"Settings"})]}),f.jsxs("li",{children:["Tap ",f.jsx("strong",{children:"Digital Wellbeing & parental controls"})]}),f.jsx("li",{children:"Tap the graph to see your screen time details"}),f.jsx("li",{children:"Take a screenshot (Power + Volume Down)"})]})]}),t&&f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[f.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-red-100 flex items-center justify-center mt-0.5",children:f.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#ef4444",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),f.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-['Figtree'] text-sm text-red-800 font-medium",children:"Upload failed"}),f.jsx("p",{className:"font-['Figtree'] text-sm text-red-600 mt-0.5",children:t})]}),f.jsx("button",{onClick:()=>r(null),className:"flex-shrink-0 text-red-400 hover:text-red-600 transition-colors",children:f.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),f.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),f.jsxs("label",{className:"block",children:[f.jsx("div",{className:`${s?"bg-gray-400":"bg-[#404040] hover:bg-[#333]"} transition-colors flex items-center justify-center px-[20px] py-[12px] rounded-full cursor-pointer`,children:f.jsx("p",{className:"font-mono text-[15px] text-center text-white tracking-[0.75px]",children:s?"PROCESSING...":"UPLOAD SCREENSHOT"})}),f.jsx("input",{type:"file",accept:"image/*",className:"hidden",disabled:s,onChange:a})]})]})]})})}function JP(){const n=Nn(),[e,t]=R.useState("generate"),[r,s]=R.useState("daily"),[i,a]=R.useState(null),[l,d]=R.useState(!1),[u,h]=R.useState(!0);R.useEffect(()=>{const I=setTimeout(()=>{h(!1)},50);return()=>clearTimeout(I)},[]);const p=()=>{d(!0),setTimeout(()=>{n("/")},280)},g=()=>{const I=Uv(r);a(I),t("receipt")},x=()=>{alert("Receipt saved! (This is a demo - in a real app, this would save to your device)")},y=async()=>{if(navigator.share)try{await navigator.share({title:"Screen Time Receipt",text:`Check out my ${r==="weekly"?"weekly":"daily"} screen time receipt!`,url:window.location.href})}catch(I){console.log("Share cancelled or failed:",I)}else t("share")},E=()=>{t("receipt")},w=()=>{t("generate"),a(null)},S=()=>{t("upload")},T=()=>{t("generate")},k=()=>{const I=Uv(r);a(I),t("receipt")};return f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:p,className:"fixed top-8 left-8 md:left-16 z-40 cursor-pointer transition-opacity duration-200 hover:opacity-80","aria-label":"Go back to home",children:f.jsx("img",{src:Vi,alt:"Michelle Liu Logo",className:"w-[44px] h-[44px] object-contain"})}),f.jsx(E0,{project:HP}),f.jsx("div",{className:`screentime-page-container relative w-full min-h-screen min-h-[100dvh] px-4 flex flex-col items-center transition-all ${l?"opacity-0 scale-[0.985]":u?"opacity-0 scale-[1.01]":"opacity-100 scale-100"}`,style:{backgroundColor:"#f3f4f6",transitionDuration:l?"280ms":"300ms",transitionTimingFunction:l?"cubic-bezier(0.4, 0, 0.2, 1)":"ease-out"},children:f.jsxs("div",{className:"relative w-full max-w-[402px] min-h-screen mx-auto bg-[#f3f4f6]",children:[f.jsx("div",{className:"hidden md:block",children:f.jsx(KP,{})}),f.jsx(zP,{additionalClassNames:"bottom-0"}),e==="generate"&&f.jsx(WP,{period:r,onPeriodChange:s,onGenerate:g,onUploadClick:S}),e==="receipt"&&i&&f.jsx(QP,{data:i,onSave:x,onShare:y,onGenerateNew:w}),e==="share"&&f.jsx(XP,{onClose:E}),e==="upload"&&f.jsx(ZP,{onClose:T,onUploadSuccess:k})]})}),f.jsx("style",{children:`
        .screentime-page-container {
          overflow-y: auto;
        }
        
        .screentime-page-container,
        .screentime-page-container * {
          font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
        }
        
        @keyframes slideInFromBottom {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        .animate-slide-in {
          animation: slideInFromBottom 1.5s ease-out;
        }
        
        .animate-fade-in {
          animation: fadeIn 0.2s ease-out;
        }
      `})]})}function Bv({href:n="/polaroid",onClick:e,className:t=""}){const r=()=>{e?e():window.location.href=n};return f.jsx("button",{onClick:r,className:`bg-blue-500 border border-blue-400 border-solid content-stretch flex gap-1.5 items-center justify-center px-4 py-1.5 relative rounded-full shrink-0 cursor-pointer hover:bg-blue-400 hover:border-blue-300 transition-colors duration-200 ease-out ${t}`,children:f.jsx("span",{className:"font-['Manrope',sans-serif] font-semibold leading-normal relative shrink-0 text-base text-white whitespace-nowrap",children:"Try It Out!"})})}function e9(){if(typeof window>"u")return;const n=navigator.userAgent,e=/Windows/.test(n),t=/Firefox/.test(n),r=/Safari/.test(n)&&!/Chrome/.test(n),s="ontouchstart"in window||navigator.maxTouchPoints>0,i=/Mac/.test(n);if(console.log(" Custom Cursor Status:",{platform:e?"Windows":i?"macOS":"Other",browser:t?"Firefox":r?"Safari":"Chrome/Other",touchDevice:s,expectedCursor:e?"32x32 (small)":"40x40/46x46 (large)",note:"If cursor looks wrong, check Network tab for failed SVG loads"}),s){console.log(" Touch device detected - using system cursor");return}(async()=>{const l=[{name:"default-large",path:"/src/assets/cursor-default.svg"},{name:"default-small",path:"/src/assets/cursor-default-small.svg"},{name:"hover-large",path:"/src/assets/cursor-hover.svg"},{name:"hover-small",path:"/src/assets/cursor-hover-small.svg"}],d=await Promise.all(l.map(p=>new Promise(g=>{const x=new Image;x.onload=()=>g({...p,loaded:!0}),x.onerror=()=>g({...p,loaded:!1}),x.src=p.path}))),u=d.filter(p=>p.loaded).length,h=d.filter(p=>!p.loaded);h.length>0?(console.warn(" Some cursors failed to load:",h.map(p=>p.name)),console.log(" This might cause cursor to appear as system default")):console.log(` All ${u} cursor files loaded successfully`),setTimeout(()=>{const x=window.getComputedStyle(document.body).getPropertyValue("cursor").includes("cursor-default");console.log(" Cursor application check:",{hasCustomCursor:x,cursorValue:x?"Custom cursor active ":"System cursor (fallback)",reason:!x&&e?"Might be Windows 32x32 limit issue":"Check CSS and file paths"}),document.body.setAttribute("data-cursor-status",x?"custom":"system")},100)})(),e?console.log(" Windows detected: Using 32x32px cursors (Windows size limit)"):i&&console.log(" macOS detected: Using 40x40/46x46px cursors"),t&&console.log(" Firefox: Custom cursors active with enhanced compatibility")}function t9(){const n=document.body,t=window.getComputedStyle(n).getPropertyValue("cursor"),r={cursorValue:t,hasCustomCursor:t.includes("cursor-default"),platform:/Windows/.test(navigator.userAgent)?"Windows":/Mac/.test(navigator.userAgent)?"macOS":"Other",browser:navigator.userAgent,recommendation:""};return r.hasCustomCursor?r.recommendation="Custom cursor is active ":r.recommendation="Custom cursor not active. Check: 1) File paths in CSS, 2) Cursor size limits, 3) Browser console for errors",console.table(r),r}typeof window<"u"&&(window.debugCursor=t9);const r9=`
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-up {
  animation: fadeUp 400ms ease-out forwards;
}
`;function n9(n){return{imageSrc:`https://image.mux.com/${n}/thumbnail.png`,videoSrc:`https://stream.mux.com/${n}.m3u8`}}const $v=[{id:"apple",title:"Apple",year:"2025",description:"Designing new features to drive engagement and user delight.",imageSrc:"",videoSrc:""},{id:"roblox",title:"Roblox",year:"2024",description:"Reimagining the future of social gameplay and user communication.",imageSrc:"",videoSrc:""},{id:"adobe",title:"Adobe",year:"2023",description:"Product strategy to drive user acquisition on college campuses.",imageSrc:"",videoSrc:""},{id:"nasa",title:"NASA JPL",year:"2023-24",description:"Daring (& designing) mighty things at NASA's in-house DesignLab.",imageSrc:"",videoSrc:""},{id:"polaroid",title:"Polaroid Studio",year:"2025",description:"A digital way to customize your own polaroid.",imageSrc:"https://image.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w/thumbnail.png",videoSrc:"https://stream.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w.m3u8",xLink:"https://x.com/michelletliu/status/1991201412072734777"},{id:"screentime",title:"Screentime Receipt",year:"2025",description:"A receipt for your daily or weekly screentime.",imageSrc:"https://image.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI/thumbnail.png",videoSrc:"https://stream.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI.m3u8",xLink:"https://x.com/michelletliu/status/2000987498550383032"},{id:"sketchbook",title:"Digital Sketchbook",year:"2025",description:"A digital home for sketches and visual journaling. Live app coming soon!",imageSrc:"https://image.mux.com/iEo013MYI028Zit3nPTJetFvqbgweCC8e2NHbY702qsQBg/thumbnail.png",videoSrc:"https://stream.mux.com/iEo013MYI028Zit3nPTJetFvqbgweCC8e2NHbY702qsQBg.m3u8"},{id:"library",title:"Personal Library",year:"2025",description:"My dream digital bookshelf",imageSrc:"https://image.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo/thumbnail.png",videoSrc:"https://stream.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo.m3u8",xLink:"https://x.com/michelletliu/status/1981030966044061894"}],Vv=_n.memo(function({imageSrc:e,videoSrc:t}){const r=R.useRef(null),[s,i]=R.useState(!1),[a,l]=R.useState(!1),[d,u]=R.useState(!1);return R.useEffect(()=>{const h=r.current;if(!h)return;const p=new IntersectionObserver(g=>{g.forEach(x=>{x.isIntersecting&&(i(!0),setTimeout(()=>l(!0),100),p.disconnect())})},{threshold:.1,rootMargin:"100px"});return p.observe(h),()=>p.disconnect()},[]),t?f.jsxs("div",{ref:r,className:"aspect-[678/367.625] relative rounded-[26px] shrink-0 w-full overflow-hidden bg-[#e5e7eb]",children:[s&&a&&f.jsx(ls,{src:t,className:ee("absolute max-w-none object-cover rounded-[26px] size-full transition-opacity duration-500 ease-out",d?"opacity-100":"opacity-0 invisible"),autoPlay:!0,muted:!0,loop:!0,controls:!1,muxEnvKey:"e4cc19a78gcf0tbtfmu4m7ruf",onLoaded:()=>u(!0)}),f.jsx("div",{className:ee("absolute inset-0 rounded-[26px] transition-opacity duration-500 ease-out bg-[#e5e7eb] z-10 pointer-events-none",d?"opacity-0":"opacity-100 animate-shimmer")})]}):e?f.jsx("div",{ref:r,className:"aspect-[678/367.625] relative rounded-[26px] shrink-0 w-full",children:f.jsx("img",{alt:"",className:"absolute max-w-none object-cover rounded-[26px] size-full",src:e,loading:"lazy"})}):f.jsx("div",{ref:r,className:"aspect-[678/367.625] relative rounded-[26px] shrink-0 w-full overflow-hidden bg-[#e5e7eb]",children:f.jsx("div",{className:"absolute inset-0 rounded-[26px] bg-[#e5e7eb] animate-shimmer"})})});function zf({text:n,active:e=!1,onClick:t}){return f.jsx("button",{onClick:t,className:ee("content-stretch flex items-center justify-center px-4 pt-[5px] pb-[3px] relative rounded-full shrink-0 cursor-pointer transition-all duration-100 ease-out border border-transparent",!e&&"hover:bg-gray-200/40 hover:pt-[3px] hover:pb-[1px] hover:my-[2px]",e&&"bg-gray-200/60 backdrop-blur-md shadow-[0_2px_8px_rgba(0,0,0,0.06),inset_0_1px_1px_rgba(255,255,255,0.9),inset_0_-1px_1px_rgba(0,0,0,0.02)] !border-white/50"),children:f.jsx("p",{className:ee("font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-lg text-nowrap",e?"text-[#4b5563]":"text-[#9ca3af]"),children:n})})}const Gv=_n.memo(function({project:e,onProjectClick:t,featured:r=!1}){const s=e.id==="polaroid"||e.id==="library"||e.id==="screentime",i=()=>{s?window.location.href=e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library":t(e.id)};return r?f.jsxs("button",{onClick:i,className:"content-stretch flex flex-col gap-3 items-start relative shrink-0 w-full cursor-pointer group project-card",children:[f.jsxs("div",{className:"content-stretch flex flex-col items-start justify-end overflow-clip relative rounded-[26px] shrink-0 w-full transition-transform duration-300 group-hover:scale-[0.99]",children:[f.jsx(Vv,{imageSrc:e.imageSrc,videoSrc:e.videoSrc}),f.jsx("div",{className:"absolute bottom-0 left-0 p-3 hidden md:block",children:f.jsx("div",{className:"bg-white border border-[#f3f4f6] border-solid flex items-center justify-center px-3 py-1.5 rounded-full",children:f.jsxs("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] text-[#111827] text-base",children:[f.jsx("span",{children:e.title}),!s&&f.jsxs("span",{className:"text-[#9ca3af]",children:["  ",e.year]}),s&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[#9ca3af] opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"  "}),f.jsx("a",{href:e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library",onClick:a=>a.stopPropagation(),className:"text-blue-400 hover:text-blue-300 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"Try It Out!"})]})]})})})]}),f.jsx("div",{className:"hidden md:flex content-stretch items-start px-[13px] py-0 -mt-0.5 relative shrink-0 w-full",children:f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-[1] text-[#9ca3af] text-base text-left project-hover-text",children:e.description})}),f.jsxs("div",{className:"md:hidden content-stretch flex flex-col font-['Figtree',sans-serif] font-normal items-start leading-[1.4] px-[13px] py-0 relative shrink-0 text-base gap-1",children:[f.jsxs("p",{className:"relative shrink-0 text-[#111827] text-left project-hover-text",children:[f.jsx("span",{children:e.title}),!s&&f.jsxs("span",{className:"text-[#9ca3af]",children:["  ",e.year]}),s&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[#9ca3af]",children:"  "}),f.jsx("a",{href:e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library",onClick:a=>a.stopPropagation(),className:"text-blue-400 hover:text-blue-300",children:"Try It Out!"})]})]}),f.jsx("p",{className:"relative shrink-0 text-[#9ca3af] w-full text-left font-normal leading-[1.3]",children:e.description})]})]}):f.jsxs("button",{onClick:i,className:"content-stretch flex flex-col gap-3 items-start relative shrink-0 w-full cursor-pointer group project-card",children:[f.jsx("div",{className:"content-stretch flex flex-col items-start overflow-clip relative rounded-[26px] shrink-0 w-full transition-transform duration-300 group-hover:scale-[0.99]",children:f.jsx(Vv,{imageSrc:e.imageSrc,videoSrc:e.videoSrc})}),f.jsx("div",{className:"content-stretch flex font-['Figtree',sans-serif] -mt-1 font-normal items-start leading-[1.4] px-[13px] py-0 relative shrink-0 text-base w-full",children:f.jsxs("p",{className:"relative shrink-0 text-[#111827] text-left project-hover-text",children:[f.jsx("span",{children:e.title}),!s&&f.jsxs("span",{className:"text-[#9ca3af]",children:["  ",e.year]}),s&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-[#9ca3af] md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"  "}),f.jsx("a",{href:e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library",onClick:a=>a.stopPropagation(),className:"text-blue-400 hover:text-blue-300 md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"Try It Out!"})]})]})})]})});function s9(){return f.jsx("div",{className:"h-px relative shrink-0 w-full",children:f.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})}function i9({project:n,onClose:e}){Nn();const[t,r]=R.useState(!1),[s,i]=R.useState(!1),[a,l]=R.useState(!1);bo(),R.useEffect(()=>{requestAnimationFrame(()=>{r(!0)});const u=setTimeout(()=>{l(!0)},350);return()=>clearTimeout(u)},[]),R.useEffect(()=>{const u=h=>{h.key==="Escape"&&(h.preventDefault(),d())};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[]);const d=()=>{i(!0),r(!1),setTimeout(()=>{e()},300)};return f.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-8",children:[f.jsx("div",{className:`absolute inset-0 bg-black/20 transition-opacity duration-300 ${t?"opacity-100":"opacity-0"}`,onClick:d}),f.jsx("div",{className:ee("relative bg-white rounded-[26px] flex flex-col w-[calc(100%*10/12)] max-md:w-full max-h-[90vh] overflow-hidden transition-all duration-300 ease-out",t?"opacity-100 translate-y-0":s?"opacity-0 translate-y-4":"opacity-0 translate-y-8"),children:f.jsx("div",{className:"flex flex-col flex-1 min-h-0 pt-6 max-md:pt-4",children:f.jsx("div",{className:"overflow-y-auto flex-1",children:f.jsxs("div",{className:"content-stretch flex flex-col gap-3 items-start px-44 max-md:px-10 pt-16 max-md:pt-0 pb-8 max-md:pb-6 relative shrink-0 w-full",children:[f.jsxs("div",{className:"hidden md:flex gap-[6px] items-start relative shrink-0 w-full",children:[f.jsxs("div",{className:"content-stretch flex flex-[1_0_0] flex-col gap-[6px] items-start min-h-px min-w-px relative shrink-0",children:[f.jsx("div",{className:"content-stretch flex items-start relative shrink-0 w-full",children:f.jsxs("div",{className:"content-stretch flex gap-[6px] items-center relative shrink-0",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-xl text-black",children:n.title}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] relative shrink-0 text-[#9ca3af] text-base",children:""}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-[#9ca3af] text-xl",children:n.year})]})}),f.jsx("div",{className:"content-stretch flex gap-2 items-start relative w-full",children:f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative text-[#6b7280] text-base",children:n.description})})]}),(n.id==="polaroid"||n.id==="library"||n.id==="screentime")&&f.jsx(Bv,{href:n.id==="polaroid"?"/polaroid":n.id==="screentime"?"/screentime":"/library"})]}),f.jsxs("div",{className:"md:hidden flex flex-col gap-3 items-start relative shrink-0 w-full",children:[f.jsxs("div",{className:"content-stretch flex flex-col gap-[6px] items-start relative shrink-0 w-full",children:[f.jsx("div",{className:"content-stretch flex items-start relative shrink-0 w-full",children:f.jsxs("div",{className:"content-stretch flex gap-[6px] items-center relative shrink-0",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-xl text-black",children:n.title}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] relative shrink-0 text-[#9ca3af] text-base",children:""}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-[#9ca3af] text-xl",children:n.year})]})}),f.jsx("div",{className:"content-stretch flex gap-2 items-start relative w-full",children:f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative text-[#6b7280] text-base",children:n.description})})]}),(n.id==="polaroid"||n.id==="library"||n.id==="screentime")&&f.jsx(Bv,{href:n.id==="polaroid"?"/polaroid":n.id==="screentime"?"/screentime":"/library"})]}),f.jsx(s9,{}),n.xLink&&f.jsx("a",{href:n.xLink,target:"_blank",rel:"noopener noreferrer",className:"content-stretch flex items-center relative shrink-0 group/xlink",children:f.jsxs("div",{className:"content-stretch flex gap-[2px] items-center relative shrink-0",children:[f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative shrink-0 text-[#9ca3af] text-base group-hover/xlink:text-blue-500 transition-colors",children:"View on"}),f.jsx("div",{className:"content-stretch flex items-center justify-center px-[4.667px] py-[6.667px] relative shrink-0 -mr-0.5",children:f.jsx("svg",{className:"block w-[16px] h-[16px] fill-[#9ca3af] group-hover/xlink:fill-blue-500 transition-colors",viewBox:"0 0 19 18",children:f.jsx("path",{d:Ps.p16308a80})})}),f.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative shrink-0 text-[#9ca3af] text-base group-hover/xlink:text-blue-500 transition-colors",children:f.jsx(ms,{})})]})}),f.jsxs("div",{className:"relative rounded-[16px] w-full aspect-[1097/616] overflow-hidden bg-gray-100 shrink-0 mt-3",children:[f.jsx("img",{alt:"",className:"absolute object-cover size-full rounded-[16px]",src:n.imageSrc}),n.videoSrc&&a&&f.jsx(ls,{src:n.videoSrc,className:"absolute object-cover size-full rounded-[16px]",autoPlay:!0,muted:!0,loop:!0,controls:!1,muxEnvKey:"e4cc19a78gcf0tbtfmu4m7ruf"},n.id)]})]})})})})]})}const a9=["polaroid","screentime","sketchbook","library"],o9=["apple","roblox","adobe","nasa"];function l9(){const n=Nn(),{slug:e,mode:t}=dT(),[r,s]=R.useState(!1),i=R.useRef(null),[a,l]=R.useState($v),[d,u]=R.useState(()=>sessionStorage.getItem("heroAnimationPlayed")==="true");R.useEffect(()=>{async function I(){try{const L=await xt.fetch($8),O={};L.forEach(j=>{j.company&&j.heroVideo&&(O[j.company]=j.heroVideo)});const P=$v.map(j=>{if(o9.includes(j.id)){const F=O[j.id];if(F){const D=n9(F);return{...j,imageSrc:D.imageSrc,videoSrc:D.videoSrc}}}return j});l(P)}catch(L){console.error("Error fetching Sanity projects:",L)}}I()},[]),R.useEffect(()=>{if(!d){const I=setTimeout(()=>{sessionStorage.setItem("heroAnimationPlayed","true"),u(!0)},500);return()=>clearTimeout(I)}},[d]),R.useEffect(()=>{z8()},[]);const h=e&&a.find(I=>I.id===e)||null,p=t==="full",g=()=>{i.current&&(clearTimeout(i.current),i.current=null),s(!0)},x=()=>{i.current=setTimeout(()=>{s(!1)},100)},y=R.useCallback(I=>{const O=window.innerWidth<768&&I!=="sketchbook";n(O?`/project/${I}/full`:`/project/${I}`)},[n]),E=()=>{n("/")},w=()=>{e&&n(`/project/${e}/full`)},S=()=>{e&&n(`/project/${e}`)},T=I=>{const L=p?`/project/${I}/full`:`/project/${I}`;n(L)},k=()=>{n("/"),window.scrollTo({top:0,behavior:"smooth"})};return f.jsxs("div",{className:"bg-white content-stretch flex flex-col items-center relative size-full min-h-screen",children:[f.jsx("style",{children:r9}),f.jsx("svg",{width:"0",height:"0",className:"absolute",children:f.jsx("defs",{children:f.jsxs("linearGradient",{id:"socialGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[f.jsx("stop",{offset:"0%",stopColor:"#D79FE8",children:f.jsx("animate",{attributeName:"stop-color",values:"#D79FE8; #4DACEA; #13B2EB; #D79FE8",dur:"3.5s",repeatCount:"indefinite"})}),f.jsx("stop",{offset:"50%",stopColor:"#4DACEA",children:f.jsx("animate",{attributeName:"stop-color",values:"#4DACEA; #13B2EB; #D79FE8; #4DACEA",dur:"3.5s",repeatCount:"indefinite"})}),f.jsx("stop",{offset:"100%",stopColor:"#13B2EB",children:f.jsx("animate",{attributeName:"stop-color",values:"#13B2EB; #D79FE8; #4DACEA; #13B2EB",dur:"3.5s",repeatCount:"indefinite"})})]})})}),f.jsx(g0,{variant:"work",heroAnimationPlayed:d,children:f.jsxs(f.Fragment,{children:[f.jsxs("span",{children:["Designing useful products to spark moments of"," "]}),f.jsx("span",{children:"delight"}),f.jsx("span",{children:" & "}),f.jsx("span",{className:"gradient-text-animated",children:"human connection. "}),f.jsxs("span",{children:[f.jsx("br",{"aria-hidden":"true"}),"Previously at "]}),f.jsx("span",{className:"text-[#374151]",style:{fontVariationSettings:"'wdth' 100"}}),f.jsx("span",{className:"font-['Figtree',sans-serif] text-[#374151]",children:""}),f.jsx("span",{children:", "}),f.jsx("span",{className:"text-[#374151]",children:"Roblox"}),f.jsx("span",{children:", & "}),f.jsx("span",{className:"text-[#374151]",children:"NASA"}),f.jsx("span",{children:"."}),f.jsxs("span",{className:ee("relative inline-flex items-center justify-center rounded-[999px] align-middle -translate-y-[2px] transition-all duration-300 ease-in-out [cursor:inherit] before:content-[''] before:absolute before:-inset-[2px] before:rounded-[999px] before:pointer-events-none","max-md:hidden",r?"gap-2 bg-[#ecfdf5] pl-1.5 pr-3.5 py-0.5 -my-0.5 md:ml-1":"md:gap-0 md:bg-transparent md:p-0 md:ml-2.5"),onMouseEnter:g,onMouseLeave:x,children:[f.jsxs("span",{className:"relative shrink-0 size-[16px] overflow-visible",children:[f.jsx("span",{className:r?"green-pulse-ring-off":"green-pulse-ring"}),f.jsx("svg",{className:"block size-full relative z-10",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 16 16",children:f.jsxs("g",{id:"Background",children:[f.jsx("rect",{fill:"var(--fill-0, #A7F3D0)",height:"16",rx:"8",width:"16"}),f.jsx("circle",{cx:"8",cy:"8",fill:"var(--fill-0, #10B981)",id:"Ellipse 1",r:"4"})]})})]}),f.jsxs("span",{className:ee("font-['Figtree:Medium',sans-serif] font-normal text-[#10b981] text-base text-nowrap overflow-hidden transition-all duration-300 ease-in-out",r?"max-w-[500px] opacity-100":"max-w-0 opacity-0"),children:[f.jsx("span",{children:"Working on something cool? Get in"})," ",f.jsx("a",{href:"mailto:michelletheresaliu@gmail.com",className:"[text-decoration-skip-ink:none] [text-underline-position:from-font] decoration-solid underline hover:!text-emerald-600 transition-colors",children:"touch"}),"!"]})]})]})}),f.jsxs("div",{className:"content-stretch flex flex-col items-center pb-4 pt-0 px-0 relative shrink-0 w-full",children:[f.jsx(De,{variant:"fade",delay:280,rootMargin:"0px",className:"relative shrink-0 w-full",disabled:d,children:f.jsx("div",{className:"size-full",children:f.jsx("div",{className:"content-stretch flex flex-col gap-3 items-start pb-0 pt-4 px-16 max-md:px-8 relative w-full",children:f.jsxs("div",{className:"content-stretch flex gap-1 items-start relative shrink-0",children:[f.jsx(zf,{text:"Work",active:!0}),f.jsx(zf,{text:"Art",onClick:()=>n("/art")}),f.jsx(zf,{text:"About",onClick:()=>n("/about")})]})})})}),f.jsx("div",{className:"px-17 max-md:px-8 w-full pt-3",children:f.jsx("div",{className:"bg-zinc-100 h-px shrink-0 w-full"})}),f.jsx("div",{className:"hidden md:grid gap-6 grid-cols-2 px-16 py-4 pt-6 relative shrink-0 w-full",children:a.map((I,L)=>f.jsx(De,{delay:Math.min(Math.floor(L/2)*80,320),className:"w-full",rootMargin:"0px 0px -100px 0px",children:f.jsx(Gv,{project:I,onProjectClick:y,featured:L<4})},I.id))}),f.jsx("div",{className:"md:hidden flex flex-col gap-8 px-8 py-4 relative shrink-0 w-full",children:a.map((I,L)=>f.jsx(De,{delay:Math.min(L*60,300),rootMargin:"0px 0px -50px 0px",children:f.jsx(Gv,{project:I,onProjectClick:y,featured:L<4})},I.id))})]}),f.jsx(Kc,{}),h&&(a9.includes(h.id)?f.jsx(i9,{project:h,onClose:E}):f.jsx(f6,{projectId:h.id,onClose:E,onBack:p?S:E,onExpandToFullscreen:w,onCollapseFromFullscreen:S,initialFullscreen:p,onProjectClick:I=>{T(I)},onViewAllProjects:k},h.id))]})}function c9(){return R.useEffect(()=>{e9()},[]),f.jsxs(kT,{children:[f.jsxs(Qr,{path:"/",element:f.jsx(l9,{}),children:[f.jsx(Qr,{index:!0,element:null}),f.jsx(Qr,{path:"project/:slug",element:null}),f.jsx(Qr,{path:"project/:slug/:mode",element:null})]}),f.jsx(Qr,{path:"/art",element:f.jsx(C6,{})}),f.jsx(Qr,{path:"/about",element:f.jsx(q6,{})}),f.jsx(Qr,{path:"/polaroid",element:f.jsx(xP,{})}),f.jsx(Qr,{path:"/library",element:f.jsx(CP,{})}),f.jsx(Qr,{path:"/screentime",element:f.jsx(JP,{})})]})}console.log(" thanks for stopping by! say hi: michelletheresaliu@gmail.com");IS.createRoot(document.getElementById("root")).render(f.jsx(QT,{children:f.jsx(c9,{})}));export{ES as g,Z2 as i};

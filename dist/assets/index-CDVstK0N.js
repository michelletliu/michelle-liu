(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function XA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var mh={exports:{}},Lo={},ph={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gy;function ZA(){if(Gy)return Ve;Gy=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function g(j){return j===null||typeof j!="object"?null:(j=m&&j[m]||j["@@iterator"],typeof j=="function"?j:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function b(j,$,fe){this.props=j,this.context=$,this.refs=w,this.updater=fe||x}b.prototype.isReactComponent={},b.prototype.setState=function(j,$){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,$,"setState")},b.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function E(){}E.prototype=b.prototype;function T(j,$,fe){this.props=j,this.context=$,this.refs=w,this.updater=fe||x}var _=T.prototype=new E;_.constructor=T,y(_,b.prototype),_.isPureReactComponent=!0;var A=Array.isArray,I=Object.prototype.hasOwnProperty,N={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function O(j,$,fe){var ne,ae={},ce=null,_e=null;if($!=null)for(ne in $.ref!==void 0&&(_e=$.ref),$.key!==void 0&&(ce=""+$.key),$)I.call($,ne)&&!P.hasOwnProperty(ne)&&(ae[ne]=$[ne]);var Ee=arguments.length-2;if(Ee===1)ae.children=fe;else if(1<Ee){for(var Le=Array(Ee),oe=0;oe<Ee;oe++)Le[oe]=arguments[oe+2];ae.children=Le}if(j&&j.defaultProps)for(ne in Ee=j.defaultProps,Ee)ae[ne]===void 0&&(ae[ne]=Ee[ne]);return{$$typeof:n,type:j,key:ce,ref:_e,props:ae,_owner:N.current}}function M(j,$){return{$$typeof:n,type:j.type,key:$,ref:j.ref,props:j.props,_owner:j._owner}}function D(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function B(j){var $={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(fe){return $[fe]})}var q=/\/+/g;function ie(j,$){return typeof j=="object"&&j!==null&&j.key!=null?B(""+j.key):$.toString(36)}function te(j,$,fe,ne,ae){var ce=typeof j;(ce==="undefined"||ce==="boolean")&&(j=null);var _e=!1;if(j===null)_e=!0;else switch(ce){case"string":case"number":_e=!0;break;case"object":switch(j.$$typeof){case n:case e:_e=!0}}if(_e)return _e=j,ae=ae(_e),j=ne===""?"."+ie(_e,0):ne,A(ae)?(fe="",j!=null&&(fe=j.replace(q,"$&/")+"/"),te(ae,$,fe,"",function(oe){return oe})):ae!=null&&(D(ae)&&(ae=M(ae,fe+(!ae.key||_e&&_e.key===ae.key?"":(""+ae.key).replace(q,"$&/")+"/")+j)),$.push(ae)),1;if(_e=0,ne=ne===""?".":ne+":",A(j))for(var Ee=0;Ee<j.length;Ee++){ce=j[Ee];var Le=ne+ie(ce,Ee);_e+=te(ce,$,fe,Le,ae)}else if(Le=g(j),typeof Le=="function")for(j=Le.call(j),Ee=0;!(ce=j.next()).done;)ce=ce.value,Le=ne+ie(ce,Ee++),_e+=te(ce,$,fe,Le,ae);else if(ce==="object")throw $=String(j),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return _e}function re(j,$,fe){if(j==null)return j;var ne=[],ae=0;return te(j,ne,"","",function(ce){return $.call(fe,ce,ae++)}),ne}function ee(j){if(j._status===-1){var $=j._result;$=$(),$.then(function(fe){(j._status===0||j._status===-1)&&(j._status=1,j._result=fe)},function(fe){(j._status===0||j._status===-1)&&(j._status=2,j._result=fe)}),j._status===-1&&(j._status=0,j._result=$)}if(j._status===1)return j._result.default;throw j._result}var Q={current:null},G={transition:null},Y={ReactCurrentDispatcher:Q,ReactCurrentBatchConfig:G,ReactCurrentOwner:N};function Z(){throw Error("act(...) is not supported in production builds of React.")}return Ve.Children={map:re,forEach:function(j,$,fe){re(j,function(){$.apply(this,arguments)},fe)},count:function(j){var $=0;return re(j,function(){$++}),$},toArray:function(j){return re(j,function($){return $})||[]},only:function(j){if(!D(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Ve.Component=b,Ve.Fragment=t,Ve.Profiler=s,Ve.PureComponent=T,Ve.StrictMode=r,Ve.Suspense=u,Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,Ve.act=Z,Ve.cloneElement=function(j,$,fe){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var ne=y({},j.props),ae=j.key,ce=j.ref,_e=j._owner;if($!=null){if($.ref!==void 0&&(ce=$.ref,_e=N.current),$.key!==void 0&&(ae=""+$.key),j.type&&j.type.defaultProps)var Ee=j.type.defaultProps;for(Le in $)I.call($,Le)&&!P.hasOwnProperty(Le)&&(ne[Le]=$[Le]===void 0&&Ee!==void 0?Ee[Le]:$[Le])}var Le=arguments.length-2;if(Le===1)ne.children=fe;else if(1<Le){Ee=Array(Le);for(var oe=0;oe<Le;oe++)Ee[oe]=arguments[oe+2];ne.children=Ee}return{$$typeof:n,type:j.type,key:ae,ref:ce,props:ne,_owner:_e}},Ve.createContext=function(j){return j={$$typeof:a,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:i,_context:j},j.Consumer=j},Ve.createElement=O,Ve.createFactory=function(j){var $=O.bind(null,j);return $.type=j,$},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(j){return{$$typeof:l,render:j}},Ve.isValidElement=D,Ve.lazy=function(j){return{$$typeof:f,_payload:{_status:-1,_result:j},_init:ee}},Ve.memo=function(j,$){return{$$typeof:d,type:j,compare:$===void 0?null:$}},Ve.startTransition=function(j){var $=G.transition;G.transition={};try{j()}finally{G.transition=$}},Ve.unstable_act=Z,Ve.useCallback=function(j,$){return Q.current.useCallback(j,$)},Ve.useContext=function(j){return Q.current.useContext(j)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(j){return Q.current.useDeferredValue(j)},Ve.useEffect=function(j,$){return Q.current.useEffect(j,$)},Ve.useId=function(){return Q.current.useId()},Ve.useImperativeHandle=function(j,$,fe){return Q.current.useImperativeHandle(j,$,fe)},Ve.useInsertionEffect=function(j,$){return Q.current.useInsertionEffect(j,$)},Ve.useLayoutEffect=function(j,$){return Q.current.useLayoutEffect(j,$)},Ve.useMemo=function(j,$){return Q.current.useMemo(j,$)},Ve.useReducer=function(j,$,fe){return Q.current.useReducer(j,$,fe)},Ve.useRef=function(j){return Q.current.useRef(j)},Ve.useState=function(j){return Q.current.useState(j)},Ve.useSyncExternalStore=function(j,$,fe){return Q.current.useSyncExternalStore(j,$,fe)},Ve.useTransition=function(){return Q.current.useTransition()},Ve.version="18.3.1",Ve}var Hy;function Rp(){return Hy||(Hy=1,ph.exports=ZA()),ph.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ky;function JA(){if(Ky)return Lo;Ky=1;var n=Rp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(l,u,d){var f,m={},g=null,x=null;d!==void 0&&(g=""+d),u.key!==void 0&&(g=""+u.key),u.ref!==void 0&&(x=u.ref);for(f in u)r.call(u,f)&&!i.hasOwnProperty(f)&&(m[f]=u[f]);if(l&&l.defaultProps)for(f in u=l.defaultProps,u)m[f]===void 0&&(m[f]=u[f]);return{$$typeof:e,type:l,key:g,ref:x,props:m,_owner:s.current}}return Lo.Fragment=t,Lo.jsx=a,Lo.jsxs=a,Lo}var zy;function eI(){return zy||(zy=1,mh.exports=JA()),mh.exports}var h=eI(),Bc={},gh={exports:{}},xn={},xh={exports:{}},yh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function tI(){return Wy||(Wy=1,(function(n){function e(G,Y){var Z=G.length;G.push(Y);e:for(;0<Z;){var j=Z-1>>>1,$=G[j];if(0<s($,Y))G[j]=Y,G[Z]=$,Z=j;else break e}}function t(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var Y=G[0],Z=G.pop();if(Z!==Y){G[0]=Z;e:for(var j=0,$=G.length,fe=$>>>1;j<fe;){var ne=2*(j+1)-1,ae=G[ne],ce=ne+1,_e=G[ce];if(0>s(ae,Z))ce<$&&0>s(_e,ae)?(G[j]=_e,G[ce]=Z,j=ce):(G[j]=ae,G[ne]=Z,j=ne);else if(ce<$&&0>s(_e,Z))G[j]=_e,G[ce]=Z,j=ce;else break e}}return Y}function s(G,Y){var Z=G.sortIndex-Y.sortIndex;return Z!==0?Z:G.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var u=[],d=[],f=1,m=null,g=3,x=!1,y=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(G){for(var Y=t(d);Y!==null;){if(Y.callback===null)r(d);else if(Y.startTime<=G)r(d),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=t(d)}}function A(G){if(w=!1,_(G),!y)if(t(u)!==null)y=!0,ee(I);else{var Y=t(d);Y!==null&&Q(A,Y.startTime-G)}}function I(G,Y){y=!1,w&&(w=!1,E(O),O=-1),x=!0;var Z=g;try{for(_(Y),m=t(u);m!==null&&(!(m.expirationTime>Y)||G&&!B());){var j=m.callback;if(typeof j=="function"){m.callback=null,g=m.priorityLevel;var $=j(m.expirationTime<=Y);Y=n.unstable_now(),typeof $=="function"?m.callback=$:m===t(u)&&r(u),_(Y)}else r(u);m=t(u)}if(m!==null)var fe=!0;else{var ne=t(d);ne!==null&&Q(A,ne.startTime-Y),fe=!1}return fe}finally{m=null,g=Z,x=!1}}var N=!1,P=null,O=-1,M=5,D=-1;function B(){return!(n.unstable_now()-D<M)}function q(){if(P!==null){var G=n.unstable_now();D=G;var Y=!0;try{Y=P(!0,G)}finally{Y?ie():(N=!1,P=null)}}else N=!1}var ie;if(typeof T=="function")ie=function(){T(q)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,re=te.port2;te.port1.onmessage=q,ie=function(){re.postMessage(null)}}else ie=function(){b(q,0)};function ee(G){P=G,N||(N=!0,ie())}function Q(G,Y){O=b(function(){G(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||x||(y=!0,ee(I))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(G){switch(g){case 1:case 2:case 3:var Y=3;break;default:Y=g}var Z=g;g=Y;try{return G()}finally{g=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,Y){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var Z=g;g=G;try{return Y()}finally{g=Z}},n.unstable_scheduleCallback=function(G,Y,Z){var j=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?j+Z:j):Z=j,G){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=Z+$,G={id:f++,callback:Y,priorityLevel:G,startTime:Z,expirationTime:$,sortIndex:-1},Z>j?(G.sortIndex=Z,e(d,G),t(u)===null&&G===t(d)&&(w?(E(O),O=-1):w=!0,Q(A,Z-j))):(G.sortIndex=$,e(u,G),y||x||(y=!0,ee(I))),G},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(G){var Y=g;return function(){var Z=g;g=Y;try{return G.apply(this,arguments)}finally{g=Z}}}})(yh)),yh}var qy;function nI(){return qy||(qy=1,xh.exports=tI()),xh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yy;function rI(){if(Yy)return xn;Yy=1;var n=Rp(),e=nI();function t(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,p=1;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function i(o,c){a(o,c),a(o+"Capture",c)}function a(o,c){for(s[o]=c,o=0;o<c.length;o++)r.add(c[o])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function g(o){return u.call(m,o)?!0:u.call(f,o)?!1:d.test(o)?m[o]=!0:(f[o]=!0,!1)}function x(o,c,p,v){if(p!==null&&p.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return v?!1:p!==null?!p.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function y(o,c,p,v){if(c===null||typeof c>"u"||x(o,c,p,v))return!0;if(v)return!1;if(p!==null)switch(p.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function w(o,c,p,v,S,k,R){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=v,this.attributeNamespace=S,this.mustUseProperty=p,this.propertyName=o,this.type=c,this.sanitizeURL=k,this.removeEmptyString=R}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){b[o]=new w(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];b[c]=new w(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){b[o]=new w(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){b[o]=new w(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){b[o]=new w(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){b[o]=new w(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){b[o]=new w(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){b[o]=new w(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){b[o]=new w(o,5,!1,o.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function T(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(E,T);b[c]=new w(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(E,T);b[c]=new w(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(E,T);b[c]=new w(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){b[o]=new w(o,1,!1,o.toLowerCase(),null,!1,!1)}),b.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){b[o]=new w(o,1,!1,o.toLowerCase(),null,!0,!0)});function _(o,c,p,v){var S=b.hasOwnProperty(c)?b[c]:null;(S!==null?S.type!==0:v||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,p,S,v)&&(p=null),v||S===null?g(c)&&(p===null?o.removeAttribute(c):o.setAttribute(c,""+p)):S.mustUseProperty?o[S.propertyName]=p===null?S.type===3?!1:"":p:(c=S.attributeName,v=S.attributeNamespace,p===null?o.removeAttribute(c):(S=S.type,p=S===3||S===4&&p===!0?"":""+p,v?o.setAttributeNS(v,c,p):o.setAttribute(c,p))))}var A=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),N=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),B=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),Q=Symbol.for("react.offscreen"),G=Symbol.iterator;function Y(o){return o===null||typeof o!="object"?null:(o=G&&o[G]||o["@@iterator"],typeof o=="function"?o:null)}var Z=Object.assign,j;function $(o){if(j===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);j=c&&c[1]||""}return`
`+j+o}var fe=!1;function ne(o,c){if(!o||fe)return"";fe=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(X){var v=X}Reflect.construct(o,[],c)}else{try{c.call()}catch(X){v=X}o.call(c.prototype)}else{try{throw Error()}catch(X){v=X}o()}}catch(X){if(X&&v&&typeof X.stack=="string"){for(var S=X.stack.split(`
`),k=v.stack.split(`
`),R=S.length-1,F=k.length-1;1<=R&&0<=F&&S[R]!==k[F];)F--;for(;1<=R&&0<=F;R--,F--)if(S[R]!==k[F]){if(R!==1||F!==1)do if(R--,F--,0>F||S[R]!==k[F]){var U=`
`+S[R].replace(" at new "," at ");return o.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",o.displayName)),U}while(1<=R&&0<=F);break}}}finally{fe=!1,Error.prepareStackTrace=p}return(o=o?o.displayName||o.name:"")?$(o):""}function ae(o){switch(o.tag){case 5:return $(o.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return o=ne(o.type,!1),o;case 11:return o=ne(o.type.render,!1),o;case 1:return o=ne(o.type,!0),o;default:return""}}function ce(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case N:return"Portal";case M:return"Profiler";case O:return"StrictMode";case ie:return"Suspense";case te:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case B:return(o.displayName||"Context")+".Consumer";case D:return(o._context.displayName||"Context")+".Provider";case q:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case re:return c=o.displayName||null,c!==null?c:ce(o.type)||"Memo";case ee:c=o._payload,o=o._init;try{return ce(o(c))}catch{}}return null}function _e(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(c);case 8:return c===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ee(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Le(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function oe(o){var c=Le(o)?"checked":"value",p=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),v=""+o[c];if(!o.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,k=p.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return S.call(this)},set:function(R){v=""+R,k.call(this,R)}}),Object.defineProperty(o,c,{enumerable:p.enumerable}),{getValue:function(){return v},setValue:function(R){v=""+R},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Re(o){o._valueTracker||(o._valueTracker=oe(o))}function We(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var p=c.getValue(),v="";return o&&(v=Le(o)?o.checked?"true":"false":o.value),o=v,o!==p?(c.setValue(o),!0):!1}function ge(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ie(o,c){var p=c.checked;return Z({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??o._wrapperState.initialChecked})}function Me(o,c){var p=c.defaultValue==null?"":c.defaultValue,v=c.checked!=null?c.checked:c.defaultChecked;p=Ee(c.value!=null?c.value:p),o._wrapperState={initialChecked:v,initialValue:p,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function we(o,c){c=c.checked,c!=null&&_(o,"checked",c,!1)}function Ue(o,c){we(o,c);var p=Ee(c.value),v=c.type;if(p!=null)v==="number"?(p===0&&o.value===""||o.value!=p)&&(o.value=""+p):o.value!==""+p&&(o.value=""+p);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?Yt(o,c.type,p):c.hasOwnProperty("defaultValue")&&Yt(o,c.type,Ee(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function Je(o,c,p){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var v=c.type;if(!(v!=="submit"&&v!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,p||c===o.value||(o.value=c),o.defaultValue=c}p=o.name,p!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,p!==""&&(o.name=p)}function Yt(o,c,p){(c!=="number"||ge(o.ownerDocument)!==o)&&(p==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+p&&(o.defaultValue=""+p))}var Et=Array.isArray;function nn(o,c,p,v){if(o=o.options,c){c={};for(var S=0;S<p.length;S++)c["$"+p[S]]=!0;for(p=0;p<o.length;p++)S=c.hasOwnProperty("$"+o[p].value),o[p].selected!==S&&(o[p].selected=S),S&&v&&(o[p].defaultSelected=!0)}else{for(p=""+Ee(p),c=null,S=0;S<o.length;S++){if(o[S].value===p){o[S].selected=!0,v&&(o[S].defaultSelected=!0);return}c!==null||o[S].disabled||(c=o[S])}c!==null&&(c.selected=!0)}}function En(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return Z({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Fr(o,c){var p=c.value;if(p==null){if(p=c.children,c=c.defaultValue,p!=null){if(c!=null)throw Error(t(92));if(Et(p)){if(1<p.length)throw Error(t(93));p=p[0]}c=p}c==null&&(c=""),p=c}o._wrapperState={initialValue:Ee(p)}}function ls(o,c){var p=Ee(c.value),v=Ee(c.defaultValue);p!=null&&(p=""+p,p!==o.value&&(o.value=p),c.defaultValue==null&&o.defaultValue!==p&&(o.defaultValue=p)),v!=null&&(o.defaultValue=""+v)}function cs(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function Br(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function us(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?Br(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Ur,ds=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,p,v,S){MSApp.execUnsafeLocalFunction(function(){return o(c,p,v,S)})}:o})(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(Ur=Ur||document.createElement("div"),Ur.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Ur.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function dr(o,c){if(c){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=c;return}}o.textContent=c}var rn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ad=["Webkit","ms","Moz","O"];Object.keys(rn).forEach(function(o){Ad.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),rn[c]=rn[o]})});function xe(o,c,p){return c==null||typeof c=="boolean"||c===""?"":p||typeof c!="number"||c===0||rn.hasOwnProperty(o)&&rn[o]?(""+c).trim():c+"px"}function yt(o,c){o=o.style;for(var p in c)if(c.hasOwnProperty(p)){var v=p.indexOf("--")===0,S=xe(p,c[p],v);p==="float"&&(p="cssFloat"),v?o.setProperty(p,S):o[p]=S}}var dn=Z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fr(o,c){if(c){if(dn[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Ka(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var za=null;function Pi(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Id=null,Di=null,Ni=null;function ag(o){if(o=po(o)){if(typeof Id!="function")throw Error(t(280));var c=o.stateNode;c&&(c=ec(c),Id(o.stateNode,o.type,c))}}function og(o){Di?Ni?Ni.push(o):Ni=[o]:Di=o}function lg(){if(Di){var o=Di,c=Ni;if(Ni=Di=null,ag(o),c)for(o=0;o<c.length;o++)ag(c[o])}}function cg(o,c){return o(c)}function ug(){}var Ld=!1;function dg(o,c,p){if(Ld)return o(c,p);Ld=!0;try{return cg(o,c,p)}finally{Ld=!1,(Di!==null||Ni!==null)&&(ug(),lg())}}function Wa(o,c){var p=o.stateNode;if(p===null)return null;var v=ec(p);if(v===null)return null;p=v[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(t(231,c,typeof p));return p}var Rd=!1;if(l)try{var qa={};Object.defineProperty(qa,"passive",{get:function(){Rd=!0}}),window.addEventListener("test",qa,qa),window.removeEventListener("test",qa,qa)}catch{Rd=!1}function rC(o,c,p,v,S,k,R,F,U){var X=Array.prototype.slice.call(arguments,3);try{c.apply(p,X)}catch(ue){this.onError(ue)}}var Ya=!1,Pl=null,Dl=!1,Pd=null,sC={onError:function(o){Ya=!0,Pl=o}};function iC(o,c,p,v,S,k,R,F,U){Ya=!1,Pl=null,rC.apply(sC,arguments)}function aC(o,c,p,v,S,k,R,F,U){if(iC.apply(this,arguments),Ya){if(Ya){var X=Pl;Ya=!1,Pl=null}else throw Error(t(198));Dl||(Dl=!0,Pd=X)}}function Qs(o){var c=o,p=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(p=c.return),o=c.return;while(o)}return c.tag===3?p:null}function fg(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function hg(o){if(Qs(o)!==o)throw Error(t(188))}function oC(o){var c=o.alternate;if(!c){if(c=Qs(o),c===null)throw Error(t(188));return c!==o?null:o}for(var p=o,v=c;;){var S=p.return;if(S===null)break;var k=S.alternate;if(k===null){if(v=S.return,v!==null){p=v;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===p)return hg(S),o;if(k===v)return hg(S),c;k=k.sibling}throw Error(t(188))}if(p.return!==v.return)p=S,v=k;else{for(var R=!1,F=S.child;F;){if(F===p){R=!0,p=S,v=k;break}if(F===v){R=!0,v=S,p=k;break}F=F.sibling}if(!R){for(F=k.child;F;){if(F===p){R=!0,p=k,v=S;break}if(F===v){R=!0,v=k,p=S;break}F=F.sibling}if(!R)throw Error(t(189))}}if(p.alternate!==v)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?o:c}function mg(o){return o=oC(o),o!==null?pg(o):null}function pg(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=pg(o);if(c!==null)return c;o=o.sibling}return null}var gg=e.unstable_scheduleCallback,xg=e.unstable_cancelCallback,lC=e.unstable_shouldYield,cC=e.unstable_requestPaint,Tt=e.unstable_now,uC=e.unstable_getCurrentPriorityLevel,Dd=e.unstable_ImmediatePriority,yg=e.unstable_UserBlockingPriority,Nl=e.unstable_NormalPriority,dC=e.unstable_LowPriority,vg=e.unstable_IdlePriority,jl=null,hr=null;function fC(o){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(jl,o,void 0,(o.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:pC,hC=Math.log,mC=Math.LN2;function pC(o){return o>>>=0,o===0?32:31-(hC(o)/mC|0)|0}var Ol=64,Ml=4194304;function Qa(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Fl(o,c){var p=o.pendingLanes;if(p===0)return 0;var v=0,S=o.suspendedLanes,k=o.pingedLanes,R=p&268435455;if(R!==0){var F=R&~S;F!==0?v=Qa(F):(k&=R,k!==0&&(v=Qa(k)))}else R=p&~S,R!==0?v=Qa(R):k!==0&&(v=Qa(k));if(v===0)return 0;if(c!==0&&c!==v&&(c&S)===0&&(S=v&-v,k=c&-c,S>=k||S===16&&(k&4194240)!==0))return c;if((v&4)!==0&&(v|=p&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=v;0<c;)p=31-Yn(c),S=1<<p,v|=o[p],c&=~S;return v}function gC(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xC(o,c){for(var p=o.suspendedLanes,v=o.pingedLanes,S=o.expirationTimes,k=o.pendingLanes;0<k;){var R=31-Yn(k),F=1<<R,U=S[R];U===-1?((F&p)===0||(F&v)!==0)&&(S[R]=gC(F,c)):U<=c&&(o.expiredLanes|=F),k&=~F}}function Nd(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function wg(){var o=Ol;return Ol<<=1,(Ol&4194240)===0&&(Ol=64),o}function jd(o){for(var c=[],p=0;31>p;p++)c.push(o);return c}function Xa(o,c,p){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-Yn(c),o[c]=p}function yC(o,c){var p=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<p;){var S=31-Yn(p),k=1<<S;c[S]=0,v[S]=-1,o[S]=-1,p&=~k}}function Od(o,c){var p=o.entangledLanes|=c;for(o=o.entanglements;p;){var v=31-Yn(p),S=1<<v;S&c|o[v]&c&&(o[v]|=c),p&=~S}}var Qe=0;function bg(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Sg,Md,Eg,Tg,_g,Fd=!1,Bl=[],fs=null,hs=null,ms=null,Za=new Map,Ja=new Map,ps=[],vC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kg(o,c){switch(o){case"focusin":case"focusout":fs=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":Za.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ja.delete(c.pointerId)}}function eo(o,c,p,v,S,k){return o===null||o.nativeEvent!==k?(o={blockedOn:c,domEventName:p,eventSystemFlags:v,nativeEvent:k,targetContainers:[S]},c!==null&&(c=po(c),c!==null&&Md(c)),o):(o.eventSystemFlags|=v,c=o.targetContainers,S!==null&&c.indexOf(S)===-1&&c.push(S),o)}function wC(o,c,p,v,S){switch(c){case"focusin":return fs=eo(fs,o,c,p,v,S),!0;case"dragenter":return hs=eo(hs,o,c,p,v,S),!0;case"mouseover":return ms=eo(ms,o,c,p,v,S),!0;case"pointerover":var k=S.pointerId;return Za.set(k,eo(Za.get(k)||null,o,c,p,v,S)),!0;case"gotpointercapture":return k=S.pointerId,Ja.set(k,eo(Ja.get(k)||null,o,c,p,v,S)),!0}return!1}function Cg(o){var c=Xs(o.target);if(c!==null){var p=Qs(c);if(p!==null){if(c=p.tag,c===13){if(c=fg(p),c!==null){o.blockedOn=c,_g(o.priority,function(){Eg(p)});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Ul(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var p=Ud(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(p===null){p=o.nativeEvent;var v=new p.constructor(p.type,p);za=v,p.target.dispatchEvent(v),za=null}else return c=po(p),c!==null&&Md(c),o.blockedOn=p,!1;c.shift()}return!0}function Ag(o,c,p){Ul(o)&&p.delete(c)}function bC(){Fd=!1,fs!==null&&Ul(fs)&&(fs=null),hs!==null&&Ul(hs)&&(hs=null),ms!==null&&Ul(ms)&&(ms=null),Za.forEach(Ag),Ja.forEach(Ag)}function to(o,c){o.blockedOn===c&&(o.blockedOn=null,Fd||(Fd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bC)))}function no(o){function c(S){return to(S,o)}if(0<Bl.length){to(Bl[0],o);for(var p=1;p<Bl.length;p++){var v=Bl[p];v.blockedOn===o&&(v.blockedOn=null)}}for(fs!==null&&to(fs,o),hs!==null&&to(hs,o),ms!==null&&to(ms,o),Za.forEach(c),Ja.forEach(c),p=0;p<ps.length;p++)v=ps[p],v.blockedOn===o&&(v.blockedOn=null);for(;0<ps.length&&(p=ps[0],p.blockedOn===null);)Cg(p),p.blockedOn===null&&ps.shift()}var ji=A.ReactCurrentBatchConfig,$l=!0;function SC(o,c,p,v){var S=Qe,k=ji.transition;ji.transition=null;try{Qe=1,Bd(o,c,p,v)}finally{Qe=S,ji.transition=k}}function EC(o,c,p,v){var S=Qe,k=ji.transition;ji.transition=null;try{Qe=4,Bd(o,c,p,v)}finally{Qe=S,ji.transition=k}}function Bd(o,c,p,v){if($l){var S=Ud(o,c,p,v);if(S===null)rf(o,c,v,Vl,p),kg(o,v);else if(wC(S,o,c,p,v))v.stopPropagation();else if(kg(o,v),c&4&&-1<vC.indexOf(o)){for(;S!==null;){var k=po(S);if(k!==null&&Sg(k),k=Ud(o,c,p,v),k===null&&rf(o,c,v,Vl,p),k===S)break;S=k}S!==null&&v.stopPropagation()}else rf(o,c,v,null,p)}}var Vl=null;function Ud(o,c,p,v){if(Vl=null,o=Pi(v),o=Xs(o),o!==null)if(c=Qs(o),c===null)o=null;else if(p=c.tag,p===13){if(o=fg(c),o!==null)return o;o=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return Vl=o,null}function Ig(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uC()){case Dd:return 1;case yg:return 4;case Nl:case dC:return 16;case vg:return 536870912;default:return 16}default:return 16}}var gs=null,$d=null,Gl=null;function Lg(){if(Gl)return Gl;var o,c=$d,p=c.length,v,S="value"in gs?gs.value:gs.textContent,k=S.length;for(o=0;o<p&&c[o]===S[o];o++);var R=p-o;for(v=1;v<=R&&c[p-v]===S[k-v];v++);return Gl=S.slice(o,1<v?1-v:void 0)}function Hl(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Kl(){return!0}function Rg(){return!1}function Tn(o){function c(p,v,S,k,R){this._reactName=p,this._targetInst=S,this.type=v,this.nativeEvent=k,this.target=R,this.currentTarget=null;for(var F in o)o.hasOwnProperty(F)&&(p=o[F],this[F]=p?p(k):k[F]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Kl:Rg,this.isPropagationStopped=Rg,this}return Z(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),c}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vd=Tn(Oi),ro=Z({},Oi,{view:0,detail:0}),TC=Tn(ro),Gd,Hd,so,zl=Z({},ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==so&&(so&&o.type==="mousemove"?(Gd=o.screenX-so.screenX,Hd=o.screenY-so.screenY):Hd=Gd=0,so=o),Gd)},movementY:function(o){return"movementY"in o?o.movementY:Hd}}),Pg=Tn(zl),_C=Z({},zl,{dataTransfer:0}),kC=Tn(_C),CC=Z({},ro,{relatedTarget:0}),Kd=Tn(CC),AC=Z({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),IC=Tn(AC),LC=Z({},Oi,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),RC=Tn(LC),PC=Z({},Oi,{data:0}),Dg=Tn(PC),DC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OC(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=jC[o])?!!c[o]:!1}function zd(){return OC}var MC=Z({},ro,{key:function(o){if(o.key){var c=DC[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=Hl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?NC[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(o){return o.type==="keypress"?Hl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Hl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),FC=Tn(MC),BC=Z({},zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ng=Tn(BC),UC=Z({},ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),$C=Tn(UC),VC=Z({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),GC=Tn(VC),HC=Z({},zl,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),KC=Tn(HC),zC=[9,13,27,32],Wd=l&&"CompositionEvent"in window,io=null;l&&"documentMode"in document&&(io=document.documentMode);var WC=l&&"TextEvent"in window&&!io,jg=l&&(!Wd||io&&8<io&&11>=io),Og=" ",Mg=!1;function Fg(o,c){switch(o){case"keyup":return zC.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bg(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Mi=!1;function qC(o,c){switch(o){case"compositionend":return Bg(c);case"keypress":return c.which!==32?null:(Mg=!0,Og);case"textInput":return o=c.data,o===Og&&Mg?null:o;default:return null}}function YC(o,c){if(Mi)return o==="compositionend"||!Wd&&Fg(o,c)?(o=Lg(),Gl=$d=gs=null,Mi=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return jg&&c.locale!=="ko"?null:c.data;default:return null}}var QC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ug(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!QC[o.type]:c==="textarea"}function $g(o,c,p,v){og(v),c=Xl(c,"onChange"),0<c.length&&(p=new Vd("onChange","change",null,p,v),o.push({event:p,listeners:c}))}var ao=null,oo=null;function XC(o){ix(o,0)}function Wl(o){var c=Vi(o);if(We(c))return o}function ZC(o,c){if(o==="change")return c}var Vg=!1;if(l){var qd;if(l){var Yd="oninput"in document;if(!Yd){var Gg=document.createElement("div");Gg.setAttribute("oninput","return;"),Yd=typeof Gg.oninput=="function"}qd=Yd}else qd=!1;Vg=qd&&(!document.documentMode||9<document.documentMode)}function Hg(){ao&&(ao.detachEvent("onpropertychange",Kg),oo=ao=null)}function Kg(o){if(o.propertyName==="value"&&Wl(oo)){var c=[];$g(c,oo,o,Pi(o)),dg(XC,c)}}function JC(o,c,p){o==="focusin"?(Hg(),ao=c,oo=p,ao.attachEvent("onpropertychange",Kg)):o==="focusout"&&Hg()}function eA(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Wl(oo)}function tA(o,c){if(o==="click")return Wl(c)}function nA(o,c){if(o==="input"||o==="change")return Wl(c)}function rA(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Qn=typeof Object.is=="function"?Object.is:rA;function lo(o,c){if(Qn(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var p=Object.keys(o),v=Object.keys(c);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var S=p[v];if(!u.call(c,S)||!Qn(o[S],c[S]))return!1}return!0}function zg(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Wg(o,c){var p=zg(o);o=0;for(var v;p;){if(p.nodeType===3){if(v=o+p.textContent.length,o<=c&&v>=c)return{node:p,offset:c-o};o=v}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=zg(p)}}function qg(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?qg(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Yg(){for(var o=window,c=ge();c instanceof o.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)o=c.contentWindow;else break;c=ge(o.document)}return c}function Qd(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function sA(o){var c=Yg(),p=o.focusedElem,v=o.selectionRange;if(c!==p&&p&&p.ownerDocument&&qg(p.ownerDocument.documentElement,p)){if(v!==null&&Qd(p)){if(c=v.start,o=v.end,o===void 0&&(o=c),"selectionStart"in p)p.selectionStart=c,p.selectionEnd=Math.min(o,p.value.length);else if(o=(c=p.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var S=p.textContent.length,k=Math.min(v.start,S);v=v.end===void 0?k:Math.min(v.end,S),!o.extend&&k>v&&(S=v,v=k,k=S),S=Wg(p,k);var R=Wg(p,v);S&&R&&(o.rangeCount!==1||o.anchorNode!==S.node||o.anchorOffset!==S.offset||o.focusNode!==R.node||o.focusOffset!==R.offset)&&(c=c.createRange(),c.setStart(S.node,S.offset),o.removeAllRanges(),k>v?(o.addRange(c),o.extend(R.node,R.offset)):(c.setEnd(R.node,R.offset),o.addRange(c)))}}for(c=[],o=p;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<c.length;p++)o=c[p],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var iA=l&&"documentMode"in document&&11>=document.documentMode,Fi=null,Xd=null,co=null,Zd=!1;function Qg(o,c,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Zd||Fi==null||Fi!==ge(v)||(v=Fi,"selectionStart"in v&&Qd(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),co&&lo(co,v)||(co=v,v=Xl(Xd,"onSelect"),0<v.length&&(c=new Vd("onSelect","select",null,c,p),o.push({event:c,listeners:v}),c.target=Fi)))}function ql(o,c){var p={};return p[o.toLowerCase()]=c.toLowerCase(),p["Webkit"+o]="webkit"+c,p["Moz"+o]="moz"+c,p}var Bi={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionend:ql("Transition","TransitionEnd")},Jd={},Xg={};l&&(Xg=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function Yl(o){if(Jd[o])return Jd[o];if(!Bi[o])return o;var c=Bi[o],p;for(p in c)if(c.hasOwnProperty(p)&&p in Xg)return Jd[o]=c[p];return o}var Zg=Yl("animationend"),Jg=Yl("animationiteration"),ex=Yl("animationstart"),tx=Yl("transitionend"),nx=new Map,rx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(o,c){nx.set(o,c),i(c,[o])}for(var ef=0;ef<rx.length;ef++){var tf=rx[ef],aA=tf.toLowerCase(),oA=tf[0].toUpperCase()+tf.slice(1);xs(aA,"on"+oA)}xs(Zg,"onAnimationEnd"),xs(Jg,"onAnimationIteration"),xs(ex,"onAnimationStart"),xs("dblclick","onDoubleClick"),xs("focusin","onFocus"),xs("focusout","onBlur"),xs(tx,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lA=new Set("cancel close invalid load scroll toggle".split(" ").concat(uo));function sx(o,c,p){var v=o.type||"unknown-event";o.currentTarget=p,aC(v,c,void 0,o),o.currentTarget=null}function ix(o,c){c=(c&4)!==0;for(var p=0;p<o.length;p++){var v=o[p],S=v.event;v=v.listeners;e:{var k=void 0;if(c)for(var R=v.length-1;0<=R;R--){var F=v[R],U=F.instance,X=F.currentTarget;if(F=F.listener,U!==k&&S.isPropagationStopped())break e;sx(S,F,X),k=U}else for(R=0;R<v.length;R++){if(F=v[R],U=F.instance,X=F.currentTarget,F=F.listener,U!==k&&S.isPropagationStopped())break e;sx(S,F,X),k=U}}}if(Dl)throw o=Pd,Dl=!1,Pd=null,o}function at(o,c){var p=c[uf];p===void 0&&(p=c[uf]=new Set);var v=o+"__bubble";p.has(v)||(ax(c,o,2,!1),p.add(v))}function nf(o,c,p){var v=0;c&&(v|=4),ax(p,o,v,c)}var Ql="_reactListening"+Math.random().toString(36).slice(2);function fo(o){if(!o[Ql]){o[Ql]=!0,r.forEach(function(p){p!=="selectionchange"&&(lA.has(p)||nf(p,!1,o),nf(p,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Ql]||(c[Ql]=!0,nf("selectionchange",!1,c))}}function ax(o,c,p,v){switch(Ig(c)){case 1:var S=SC;break;case 4:S=EC;break;default:S=Bd}p=S.bind(null,c,p,o),S=void 0,!Rd||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(S=!0),v?S!==void 0?o.addEventListener(c,p,{capture:!0,passive:S}):o.addEventListener(c,p,!0):S!==void 0?o.addEventListener(c,p,{passive:S}):o.addEventListener(c,p,!1)}function rf(o,c,p,v,S){var k=v;if((c&1)===0&&(c&2)===0&&v!==null)e:for(;;){if(v===null)return;var R=v.tag;if(R===3||R===4){var F=v.stateNode.containerInfo;if(F===S||F.nodeType===8&&F.parentNode===S)break;if(R===4)for(R=v.return;R!==null;){var U=R.tag;if((U===3||U===4)&&(U=R.stateNode.containerInfo,U===S||U.nodeType===8&&U.parentNode===S))return;R=R.return}for(;F!==null;){if(R=Xs(F),R===null)return;if(U=R.tag,U===5||U===6){v=k=R;continue e}F=F.parentNode}}v=v.return}dg(function(){var X=k,ue=Pi(p),de=[];e:{var le=nx.get(o);if(le!==void 0){var ye=Vd,Te=o;switch(o){case"keypress":if(Hl(p)===0)break e;case"keydown":case"keyup":ye=FC;break;case"focusin":Te="focus",ye=Kd;break;case"focusout":Te="blur",ye=Kd;break;case"beforeblur":case"afterblur":ye=Kd;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Pg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=kC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=$C;break;case Zg:case Jg:case ex:ye=IC;break;case tx:ye=GC;break;case"scroll":ye=TC;break;case"wheel":ye=KC;break;case"copy":case"cut":case"paste":ye=RC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=Ng}var ke=(c&4)!==0,_t=!ke&&o==="scroll",z=ke?le!==null?le+"Capture":null:le;ke=[];for(var V=X,W;V!==null;){W=V;var he=W.stateNode;if(W.tag===5&&he!==null&&(W=he,z!==null&&(he=Wa(V,z),he!=null&&ke.push(ho(V,he,W)))),_t)break;V=V.return}0<ke.length&&(le=new ye(le,Te,null,p,ue),de.push({event:le,listeners:ke}))}}if((c&7)===0){e:{if(le=o==="mouseover"||o==="pointerover",ye=o==="mouseout"||o==="pointerout",le&&p!==za&&(Te=p.relatedTarget||p.fromElement)&&(Xs(Te)||Te[$r]))break e;if((ye||le)&&(le=ue.window===ue?ue:(le=ue.ownerDocument)?le.defaultView||le.parentWindow:window,ye?(Te=p.relatedTarget||p.toElement,ye=X,Te=Te?Xs(Te):null,Te!==null&&(_t=Qs(Te),Te!==_t||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(ye=null,Te=X),ye!==Te)){if(ke=Pg,he="onMouseLeave",z="onMouseEnter",V="mouse",(o==="pointerout"||o==="pointerover")&&(ke=Ng,he="onPointerLeave",z="onPointerEnter",V="pointer"),_t=ye==null?le:Vi(ye),W=Te==null?le:Vi(Te),le=new ke(he,V+"leave",ye,p,ue),le.target=_t,le.relatedTarget=W,he=null,Xs(ue)===X&&(ke=new ke(z,V+"enter",Te,p,ue),ke.target=W,ke.relatedTarget=_t,he=ke),_t=he,ye&&Te)t:{for(ke=ye,z=Te,V=0,W=ke;W;W=Ui(W))V++;for(W=0,he=z;he;he=Ui(he))W++;for(;0<V-W;)ke=Ui(ke),V--;for(;0<W-V;)z=Ui(z),W--;for(;V--;){if(ke===z||z!==null&&ke===z.alternate)break t;ke=Ui(ke),z=Ui(z)}ke=null}else ke=null;ye!==null&&ox(de,le,ye,ke,!1),Te!==null&&_t!==null&&ox(de,_t,Te,ke,!0)}}e:{if(le=X?Vi(X):window,ye=le.nodeName&&le.nodeName.toLowerCase(),ye==="select"||ye==="input"&&le.type==="file")var Ae=ZC;else if(Ug(le))if(Vg)Ae=nA;else{Ae=eA;var Pe=JC}else(ye=le.nodeName)&&ye.toLowerCase()==="input"&&(le.type==="checkbox"||le.type==="radio")&&(Ae=tA);if(Ae&&(Ae=Ae(o,X))){$g(de,Ae,p,ue);break e}Pe&&Pe(o,le,X),o==="focusout"&&(Pe=le._wrapperState)&&Pe.controlled&&le.type==="number"&&Yt(le,"number",le.value)}switch(Pe=X?Vi(X):window,o){case"focusin":(Ug(Pe)||Pe.contentEditable==="true")&&(Fi=Pe,Xd=X,co=null);break;case"focusout":co=Xd=Fi=null;break;case"mousedown":Zd=!0;break;case"contextmenu":case"mouseup":case"dragend":Zd=!1,Qg(de,p,ue);break;case"selectionchange":if(iA)break;case"keydown":case"keyup":Qg(de,p,ue)}var De;if(Wd)e:{switch(o){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Mi?Fg(o,p)&&(je="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(je="onCompositionStart");je&&(jg&&p.locale!=="ko"&&(Mi||je!=="onCompositionStart"?je==="onCompositionEnd"&&Mi&&(De=Lg()):(gs=ue,$d="value"in gs?gs.value:gs.textContent,Mi=!0)),Pe=Xl(X,je),0<Pe.length&&(je=new Dg(je,o,null,p,ue),de.push({event:je,listeners:Pe}),De?je.data=De:(De=Bg(p),De!==null&&(je.data=De)))),(De=WC?qC(o,p):YC(o,p))&&(X=Xl(X,"onBeforeInput"),0<X.length&&(ue=new Dg("onBeforeInput","beforeinput",null,p,ue),de.push({event:ue,listeners:X}),ue.data=De))}ix(de,c)})}function ho(o,c,p){return{instance:o,listener:c,currentTarget:p}}function Xl(o,c){for(var p=c+"Capture",v=[];o!==null;){var S=o,k=S.stateNode;S.tag===5&&k!==null&&(S=k,k=Wa(o,p),k!=null&&v.unshift(ho(o,k,S)),k=Wa(o,c),k!=null&&v.push(ho(o,k,S))),o=o.return}return v}function Ui(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function ox(o,c,p,v,S){for(var k=c._reactName,R=[];p!==null&&p!==v;){var F=p,U=F.alternate,X=F.stateNode;if(U!==null&&U===v)break;F.tag===5&&X!==null&&(F=X,S?(U=Wa(p,k),U!=null&&R.unshift(ho(p,U,F))):S||(U=Wa(p,k),U!=null&&R.push(ho(p,U,F)))),p=p.return}R.length!==0&&o.push({event:c,listeners:R})}var cA=/\r\n?/g,uA=/\u0000|\uFFFD/g;function lx(o){return(typeof o=="string"?o:""+o).replace(cA,`
`).replace(uA,"")}function Zl(o,c,p){if(c=lx(c),lx(o)!==c&&p)throw Error(t(425))}function Jl(){}var sf=null,af=null;function of(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var lf=typeof setTimeout=="function"?setTimeout:void 0,dA=typeof clearTimeout=="function"?clearTimeout:void 0,cx=typeof Promise=="function"?Promise:void 0,fA=typeof queueMicrotask=="function"?queueMicrotask:typeof cx<"u"?function(o){return cx.resolve(null).then(o).catch(hA)}:lf;function hA(o){setTimeout(function(){throw o})}function cf(o,c){var p=c,v=0;do{var S=p.nextSibling;if(o.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(v===0){o.removeChild(S),no(c);return}v--}else p!=="$"&&p!=="$?"&&p!=="$!"||v++;p=S}while(p);no(c)}function ys(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function ux(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return o;c--}else p==="/$"&&c++}o=o.previousSibling}return null}var $i=Math.random().toString(36).slice(2),mr="__reactFiber$"+$i,mo="__reactProps$"+$i,$r="__reactContainer$"+$i,uf="__reactEvents$"+$i,mA="__reactListeners$"+$i,pA="__reactHandles$"+$i;function Xs(o){var c=o[mr];if(c)return c;for(var p=o.parentNode;p;){if(c=p[$r]||p[mr]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(o=ux(o);o!==null;){if(p=o[mr])return p;o=ux(o)}return c}o=p,p=o.parentNode}return null}function po(o){return o=o[mr]||o[$r],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Vi(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function ec(o){return o[mo]||null}var df=[],Gi=-1;function vs(o){return{current:o}}function ot(o){0>Gi||(o.current=df[Gi],df[Gi]=null,Gi--)}function st(o,c){Gi++,df[Gi]=o.current,o.current=c}var ws={},Qt=vs(ws),fn=vs(!1),Zs=ws;function Hi(o,c){var p=o.type.contextTypes;if(!p)return ws;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===c)return v.__reactInternalMemoizedMaskedChildContext;var S={},k;for(k in p)S[k]=c[k];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=S),S}function hn(o){return o=o.childContextTypes,o!=null}function tc(){ot(fn),ot(Qt)}function dx(o,c,p){if(Qt.current!==ws)throw Error(t(168));st(Qt,c),st(fn,p)}function fx(o,c,p){var v=o.stateNode;if(c=c.childContextTypes,typeof v.getChildContext!="function")return p;v=v.getChildContext();for(var S in v)if(!(S in c))throw Error(t(108,_e(o)||"Unknown",S));return Z({},p,v)}function nc(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ws,Zs=Qt.current,st(Qt,o),st(fn,fn.current),!0}function hx(o,c,p){var v=o.stateNode;if(!v)throw Error(t(169));p?(o=fx(o,c,Zs),v.__reactInternalMemoizedMergedChildContext=o,ot(fn),ot(Qt),st(Qt,o)):ot(fn),st(fn,p)}var Vr=null,rc=!1,ff=!1;function mx(o){Vr===null?Vr=[o]:Vr.push(o)}function gA(o){rc=!0,mx(o)}function bs(){if(!ff&&Vr!==null){ff=!0;var o=0,c=Qe;try{var p=Vr;for(Qe=1;o<p.length;o++){var v=p[o];do v=v(!0);while(v!==null)}Vr=null,rc=!1}catch(S){throw Vr!==null&&(Vr=Vr.slice(o+1)),gg(Dd,bs),S}finally{Qe=c,ff=!1}}return null}var Ki=[],zi=0,sc=null,ic=0,Dn=[],Nn=0,Js=null,Gr=1,Hr="";function ei(o,c){Ki[zi++]=ic,Ki[zi++]=sc,sc=o,ic=c}function px(o,c,p){Dn[Nn++]=Gr,Dn[Nn++]=Hr,Dn[Nn++]=Js,Js=o;var v=Gr;o=Hr;var S=32-Yn(v)-1;v&=~(1<<S),p+=1;var k=32-Yn(c)+S;if(30<k){var R=S-S%5;k=(v&(1<<R)-1).toString(32),v>>=R,S-=R,Gr=1<<32-Yn(c)+S|p<<S|v,Hr=k+o}else Gr=1<<k|p<<S|v,Hr=o}function hf(o){o.return!==null&&(ei(o,1),px(o,1,0))}function mf(o){for(;o===sc;)sc=Ki[--zi],Ki[zi]=null,ic=Ki[--zi],Ki[zi]=null;for(;o===Js;)Js=Dn[--Nn],Dn[Nn]=null,Hr=Dn[--Nn],Dn[Nn]=null,Gr=Dn[--Nn],Dn[Nn]=null}var _n=null,kn=null,ct=!1,Xn=null;function gx(o,c){var p=Fn(5,null,null,0);p.elementType="DELETED",p.stateNode=c,p.return=o,c=o.deletions,c===null?(o.deletions=[p],o.flags|=16):c.push(p)}function xx(o,c){switch(o.tag){case 5:var p=o.type;return c=c.nodeType!==1||p.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,_n=o,kn=ys(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,_n=o,kn=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(p=Js!==null?{id:Gr,overflow:Hr}:null,o.memoizedState={dehydrated:c,treeContext:p,retryLane:1073741824},p=Fn(18,null,null,0),p.stateNode=c,p.return=o,o.child=p,_n=o,kn=null,!0):!1;default:return!1}}function pf(o){return(o.mode&1)!==0&&(o.flags&128)===0}function gf(o){if(ct){var c=kn;if(c){var p=c;if(!xx(o,c)){if(pf(o))throw Error(t(418));c=ys(p.nextSibling);var v=_n;c&&xx(o,c)?gx(v,p):(o.flags=o.flags&-4097|2,ct=!1,_n=o)}}else{if(pf(o))throw Error(t(418));o.flags=o.flags&-4097|2,ct=!1,_n=o}}}function yx(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;_n=o}function ac(o){if(o!==_n)return!1;if(!ct)return yx(o),ct=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!of(o.type,o.memoizedProps)),c&&(c=kn)){if(pf(o))throw vx(),Error(t(418));for(;c;)gx(o,c),c=ys(c.nextSibling)}if(yx(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var p=o.data;if(p==="/$"){if(c===0){kn=ys(o.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++}o=o.nextSibling}kn=null}}else kn=_n?ys(o.stateNode.nextSibling):null;return!0}function vx(){for(var o=kn;o;)o=ys(o.nextSibling)}function Wi(){kn=_n=null,ct=!1}function xf(o){Xn===null?Xn=[o]:Xn.push(o)}var xA=A.ReactCurrentBatchConfig;function go(o,c,p){if(o=p.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var v=p.stateNode}if(!v)throw Error(t(147,o));var S=v,k=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===k?c.ref:(c=function(R){var F=S.refs;R===null?delete F[k]:F[k]=R},c._stringRef=k,c)}if(typeof o!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,o))}return o}function oc(o,c){throw o=Object.prototype.toString.call(c),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function wx(o){var c=o._init;return c(o._payload)}function bx(o){function c(z,V){if(o){var W=z.deletions;W===null?(z.deletions=[V],z.flags|=16):W.push(V)}}function p(z,V){if(!o)return null;for(;V!==null;)c(z,V),V=V.sibling;return null}function v(z,V){for(z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function S(z,V){return z=Is(z,V),z.index=0,z.sibling=null,z}function k(z,V,W){return z.index=W,o?(W=z.alternate,W!==null?(W=W.index,W<V?(z.flags|=2,V):W):(z.flags|=2,V)):(z.flags|=1048576,V)}function R(z){return o&&z.alternate===null&&(z.flags|=2),z}function F(z,V,W,he){return V===null||V.tag!==6?(V=lh(W,z.mode,he),V.return=z,V):(V=S(V,W),V.return=z,V)}function U(z,V,W,he){var Ae=W.type;return Ae===P?ue(z,V,W.props.children,he,W.key):V!==null&&(V.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===ee&&wx(Ae)===V.type)?(he=S(V,W.props),he.ref=go(z,V,W),he.return=z,he):(he=Rc(W.type,W.key,W.props,null,z.mode,he),he.ref=go(z,V,W),he.return=z,he)}function X(z,V,W,he){return V===null||V.tag!==4||V.stateNode.containerInfo!==W.containerInfo||V.stateNode.implementation!==W.implementation?(V=ch(W,z.mode,he),V.return=z,V):(V=S(V,W.children||[]),V.return=z,V)}function ue(z,V,W,he,Ae){return V===null||V.tag!==7?(V=li(W,z.mode,he,Ae),V.return=z,V):(V=S(V,W),V.return=z,V)}function de(z,V,W){if(typeof V=="string"&&V!==""||typeof V=="number")return V=lh(""+V,z.mode,W),V.return=z,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case I:return W=Rc(V.type,V.key,V.props,null,z.mode,W),W.ref=go(z,null,V),W.return=z,W;case N:return V=ch(V,z.mode,W),V.return=z,V;case ee:var he=V._init;return de(z,he(V._payload),W)}if(Et(V)||Y(V))return V=li(V,z.mode,W,null),V.return=z,V;oc(z,V)}return null}function le(z,V,W,he){var Ae=V!==null?V.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return Ae!==null?null:F(z,V,""+W,he);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case I:return W.key===Ae?U(z,V,W,he):null;case N:return W.key===Ae?X(z,V,W,he):null;case ee:return Ae=W._init,le(z,V,Ae(W._payload),he)}if(Et(W)||Y(W))return Ae!==null?null:ue(z,V,W,he,null);oc(z,W)}return null}function ye(z,V,W,he,Ae){if(typeof he=="string"&&he!==""||typeof he=="number")return z=z.get(W)||null,F(V,z,""+he,Ae);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case I:return z=z.get(he.key===null?W:he.key)||null,U(V,z,he,Ae);case N:return z=z.get(he.key===null?W:he.key)||null,X(V,z,he,Ae);case ee:var Pe=he._init;return ye(z,V,W,Pe(he._payload),Ae)}if(Et(he)||Y(he))return z=z.get(W)||null,ue(V,z,he,Ae,null);oc(V,he)}return null}function Te(z,V,W,he){for(var Ae=null,Pe=null,De=V,je=V=0,Bt=null;De!==null&&je<W.length;je++){De.index>je?(Bt=De,De=null):Bt=De.sibling;var qe=le(z,De,W[je],he);if(qe===null){De===null&&(De=Bt);break}o&&De&&qe.alternate===null&&c(z,De),V=k(qe,V,je),Pe===null?Ae=qe:Pe.sibling=qe,Pe=qe,De=Bt}if(je===W.length)return p(z,De),ct&&ei(z,je),Ae;if(De===null){for(;je<W.length;je++)De=de(z,W[je],he),De!==null&&(V=k(De,V,je),Pe===null?Ae=De:Pe.sibling=De,Pe=De);return ct&&ei(z,je),Ae}for(De=v(z,De);je<W.length;je++)Bt=ye(De,z,je,W[je],he),Bt!==null&&(o&&Bt.alternate!==null&&De.delete(Bt.key===null?je:Bt.key),V=k(Bt,V,je),Pe===null?Ae=Bt:Pe.sibling=Bt,Pe=Bt);return o&&De.forEach(function(Ls){return c(z,Ls)}),ct&&ei(z,je),Ae}function ke(z,V,W,he){var Ae=Y(W);if(typeof Ae!="function")throw Error(t(150));if(W=Ae.call(W),W==null)throw Error(t(151));for(var Pe=Ae=null,De=V,je=V=0,Bt=null,qe=W.next();De!==null&&!qe.done;je++,qe=W.next()){De.index>je?(Bt=De,De=null):Bt=De.sibling;var Ls=le(z,De,qe.value,he);if(Ls===null){De===null&&(De=Bt);break}o&&De&&Ls.alternate===null&&c(z,De),V=k(Ls,V,je),Pe===null?Ae=Ls:Pe.sibling=Ls,Pe=Ls,De=Bt}if(qe.done)return p(z,De),ct&&ei(z,je),Ae;if(De===null){for(;!qe.done;je++,qe=W.next())qe=de(z,qe.value,he),qe!==null&&(V=k(qe,V,je),Pe===null?Ae=qe:Pe.sibling=qe,Pe=qe);return ct&&ei(z,je),Ae}for(De=v(z,De);!qe.done;je++,qe=W.next())qe=ye(De,z,je,qe.value,he),qe!==null&&(o&&qe.alternate!==null&&De.delete(qe.key===null?je:qe.key),V=k(qe,V,je),Pe===null?Ae=qe:Pe.sibling=qe,Pe=qe);return o&&De.forEach(function(QA){return c(z,QA)}),ct&&ei(z,je),Ae}function _t(z,V,W,he){if(typeof W=="object"&&W!==null&&W.type===P&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case I:e:{for(var Ae=W.key,Pe=V;Pe!==null;){if(Pe.key===Ae){if(Ae=W.type,Ae===P){if(Pe.tag===7){p(z,Pe.sibling),V=S(Pe,W.props.children),V.return=z,z=V;break e}}else if(Pe.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===ee&&wx(Ae)===Pe.type){p(z,Pe.sibling),V=S(Pe,W.props),V.ref=go(z,Pe,W),V.return=z,z=V;break e}p(z,Pe);break}else c(z,Pe);Pe=Pe.sibling}W.type===P?(V=li(W.props.children,z.mode,he,W.key),V.return=z,z=V):(he=Rc(W.type,W.key,W.props,null,z.mode,he),he.ref=go(z,V,W),he.return=z,z=he)}return R(z);case N:e:{for(Pe=W.key;V!==null;){if(V.key===Pe)if(V.tag===4&&V.stateNode.containerInfo===W.containerInfo&&V.stateNode.implementation===W.implementation){p(z,V.sibling),V=S(V,W.children||[]),V.return=z,z=V;break e}else{p(z,V);break}else c(z,V);V=V.sibling}V=ch(W,z.mode,he),V.return=z,z=V}return R(z);case ee:return Pe=W._init,_t(z,V,Pe(W._payload),he)}if(Et(W))return Te(z,V,W,he);if(Y(W))return ke(z,V,W,he);oc(z,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,V!==null&&V.tag===6?(p(z,V.sibling),V=S(V,W),V.return=z,z=V):(p(z,V),V=lh(W,z.mode,he),V.return=z,z=V),R(z)):p(z,V)}return _t}var qi=bx(!0),Sx=bx(!1),lc=vs(null),cc=null,Yi=null,yf=null;function vf(){yf=Yi=cc=null}function wf(o){var c=lc.current;ot(lc),o._currentValue=c}function bf(o,c,p){for(;o!==null;){var v=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),o===p)break;o=o.return}}function Qi(o,c){cc=o,yf=Yi=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&c)!==0&&(mn=!0),o.firstContext=null)}function jn(o){var c=o._currentValue;if(yf!==o)if(o={context:o,memoizedValue:c,next:null},Yi===null){if(cc===null)throw Error(t(308));Yi=o,cc.dependencies={lanes:0,firstContext:o}}else Yi=Yi.next=o;return c}var ti=null;function Sf(o){ti===null?ti=[o]:ti.push(o)}function Ex(o,c,p,v){var S=c.interleaved;return S===null?(p.next=p,Sf(c)):(p.next=S.next,S.next=p),c.interleaved=p,Kr(o,v)}function Kr(o,c){o.lanes|=c;var p=o.alternate;for(p!==null&&(p.lanes|=c),p=o,o=o.return;o!==null;)o.childLanes|=c,p=o.alternate,p!==null&&(p.childLanes|=c),p=o,o=o.return;return p.tag===3?p.stateNode:null}var Ss=!1;function Ef(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tx(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function zr(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Es(o,c,p){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(Ke&2)!==0){var S=v.pending;return S===null?c.next=c:(c.next=S.next,S.next=c),v.pending=c,Kr(o,p)}return S=v.interleaved,S===null?(c.next=c,Sf(v)):(c.next=S.next,S.next=c),v.interleaved=c,Kr(o,p)}function uc(o,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194240)!==0)){var v=c.lanes;v&=o.pendingLanes,p|=v,c.lanes=p,Od(o,p)}}function _x(o,c){var p=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var S=null,k=null;if(p=p.firstBaseUpdate,p!==null){do{var R={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};k===null?S=k=R:k=k.next=R,p=p.next}while(p!==null);k===null?S=k=c:k=k.next=c}else S=k=c;p={baseState:v.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:v.shared,effects:v.effects},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=c:o.next=c,p.lastBaseUpdate=c}function dc(o,c,p,v){var S=o.updateQueue;Ss=!1;var k=S.firstBaseUpdate,R=S.lastBaseUpdate,F=S.shared.pending;if(F!==null){S.shared.pending=null;var U=F,X=U.next;U.next=null,R===null?k=X:R.next=X,R=U;var ue=o.alternate;ue!==null&&(ue=ue.updateQueue,F=ue.lastBaseUpdate,F!==R&&(F===null?ue.firstBaseUpdate=X:F.next=X,ue.lastBaseUpdate=U))}if(k!==null){var de=S.baseState;R=0,ue=X=U=null,F=k;do{var le=F.lane,ye=F.eventTime;if((v&le)===le){ue!==null&&(ue=ue.next={eventTime:ye,lane:0,tag:F.tag,payload:F.payload,callback:F.callback,next:null});e:{var Te=o,ke=F;switch(le=c,ye=p,ke.tag){case 1:if(Te=ke.payload,typeof Te=="function"){de=Te.call(ye,de,le);break e}de=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=ke.payload,le=typeof Te=="function"?Te.call(ye,de,le):Te,le==null)break e;de=Z({},de,le);break e;case 2:Ss=!0}}F.callback!==null&&F.lane!==0&&(o.flags|=64,le=S.effects,le===null?S.effects=[F]:le.push(F))}else ye={eventTime:ye,lane:le,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ue===null?(X=ue=ye,U=de):ue=ue.next=ye,R|=le;if(F=F.next,F===null){if(F=S.shared.pending,F===null)break;le=F,F=le.next,le.next=null,S.lastBaseUpdate=le,S.shared.pending=null}}while(!0);if(ue===null&&(U=de),S.baseState=U,S.firstBaseUpdate=X,S.lastBaseUpdate=ue,c=S.shared.interleaved,c!==null){S=c;do R|=S.lane,S=S.next;while(S!==c)}else k===null&&(S.shared.lanes=0);si|=R,o.lanes=R,o.memoizedState=de}}function kx(o,c,p){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var v=o[c],S=v.callback;if(S!==null){if(v.callback=null,v=p,typeof S!="function")throw Error(t(191,S));S.call(v)}}}var xo={},pr=vs(xo),yo=vs(xo),vo=vs(xo);function ni(o){if(o===xo)throw Error(t(174));return o}function Tf(o,c){switch(st(vo,c),st(yo,o),st(pr,xo),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:us(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=us(c,o)}ot(pr),st(pr,c)}function Xi(){ot(pr),ot(yo),ot(vo)}function Cx(o){ni(vo.current);var c=ni(pr.current),p=us(c,o.type);c!==p&&(st(yo,o),st(pr,p))}function _f(o){yo.current===o&&(ot(pr),ot(yo))}var dt=vs(0);function fc(o){for(var c=o;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var kf=[];function Cf(){for(var o=0;o<kf.length;o++)kf[o]._workInProgressVersionPrimary=null;kf.length=0}var hc=A.ReactCurrentDispatcher,Af=A.ReactCurrentBatchConfig,ri=0,ft=null,Lt=null,Mt=null,mc=!1,wo=!1,bo=0,yA=0;function Xt(){throw Error(t(321))}function If(o,c){if(c===null)return!1;for(var p=0;p<c.length&&p<o.length;p++)if(!Qn(o[p],c[p]))return!1;return!0}function Lf(o,c,p,v,S,k){if(ri=k,ft=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,hc.current=o===null||o.memoizedState===null?SA:EA,o=p(v,S),wo){k=0;do{if(wo=!1,bo=0,25<=k)throw Error(t(301));k+=1,Mt=Lt=null,c.updateQueue=null,hc.current=TA,o=p(v,S)}while(wo)}if(hc.current=xc,c=Lt!==null&&Lt.next!==null,ri=0,Mt=Lt=ft=null,mc=!1,c)throw Error(t(300));return o}function Rf(){var o=bo!==0;return bo=0,o}function gr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?ft.memoizedState=Mt=o:Mt=Mt.next=o,Mt}function On(){if(Lt===null){var o=ft.alternate;o=o!==null?o.memoizedState:null}else o=Lt.next;var c=Mt===null?ft.memoizedState:Mt.next;if(c!==null)Mt=c,Lt=o;else{if(o===null)throw Error(t(310));Lt=o,o={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Mt===null?ft.memoizedState=Mt=o:Mt=Mt.next=o}return Mt}function So(o,c){return typeof c=="function"?c(o):c}function Pf(o){var c=On(),p=c.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=o;var v=Lt,S=v.baseQueue,k=p.pending;if(k!==null){if(S!==null){var R=S.next;S.next=k.next,k.next=R}v.baseQueue=S=k,p.pending=null}if(S!==null){k=S.next,v=v.baseState;var F=R=null,U=null,X=k;do{var ue=X.lane;if((ri&ue)===ue)U!==null&&(U=U.next={lane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),v=X.hasEagerState?X.eagerState:o(v,X.action);else{var de={lane:ue,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null};U===null?(F=U=de,R=v):U=U.next=de,ft.lanes|=ue,si|=ue}X=X.next}while(X!==null&&X!==k);U===null?R=v:U.next=F,Qn(v,c.memoizedState)||(mn=!0),c.memoizedState=v,c.baseState=R,c.baseQueue=U,p.lastRenderedState=v}if(o=p.interleaved,o!==null){S=o;do k=S.lane,ft.lanes|=k,si|=k,S=S.next;while(S!==o)}else S===null&&(p.lanes=0);return[c.memoizedState,p.dispatch]}function Df(o){var c=On(),p=c.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=o;var v=p.dispatch,S=p.pending,k=c.memoizedState;if(S!==null){p.pending=null;var R=S=S.next;do k=o(k,R.action),R=R.next;while(R!==S);Qn(k,c.memoizedState)||(mn=!0),c.memoizedState=k,c.baseQueue===null&&(c.baseState=k),p.lastRenderedState=k}return[k,v]}function Ax(){}function Ix(o,c){var p=ft,v=On(),S=c(),k=!Qn(v.memoizedState,S);if(k&&(v.memoizedState=S,mn=!0),v=v.queue,Nf(Px.bind(null,p,v,o),[o]),v.getSnapshot!==c||k||Mt!==null&&Mt.memoizedState.tag&1){if(p.flags|=2048,Eo(9,Rx.bind(null,p,v,S,c),void 0,null),Ft===null)throw Error(t(349));(ri&30)!==0||Lx(p,c,S)}return S}function Lx(o,c,p){o.flags|=16384,o={getSnapshot:c,value:p},c=ft.updateQueue,c===null?(c={lastEffect:null,stores:null},ft.updateQueue=c,c.stores=[o]):(p=c.stores,p===null?c.stores=[o]:p.push(o))}function Rx(o,c,p,v){c.value=p,c.getSnapshot=v,Dx(c)&&Nx(o)}function Px(o,c,p){return p(function(){Dx(c)&&Nx(o)})}function Dx(o){var c=o.getSnapshot;o=o.value;try{var p=c();return!Qn(o,p)}catch{return!0}}function Nx(o){var c=Kr(o,1);c!==null&&tr(c,o,1,-1)}function jx(o){var c=gr();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:o},c.queue=o,o=o.dispatch=bA.bind(null,ft,o),[c.memoizedState,o]}function Eo(o,c,p,v){return o={tag:o,create:c,destroy:p,deps:v,next:null},c=ft.updateQueue,c===null?(c={lastEffect:null,stores:null},ft.updateQueue=c,c.lastEffect=o.next=o):(p=c.lastEffect,p===null?c.lastEffect=o.next=o:(v=p.next,p.next=o,o.next=v,c.lastEffect=o)),o}function Ox(){return On().memoizedState}function pc(o,c,p,v){var S=gr();ft.flags|=o,S.memoizedState=Eo(1|c,p,void 0,v===void 0?null:v)}function gc(o,c,p,v){var S=On();v=v===void 0?null:v;var k=void 0;if(Lt!==null){var R=Lt.memoizedState;if(k=R.destroy,v!==null&&If(v,R.deps)){S.memoizedState=Eo(c,p,k,v);return}}ft.flags|=o,S.memoizedState=Eo(1|c,p,k,v)}function Mx(o,c){return pc(8390656,8,o,c)}function Nf(o,c){return gc(2048,8,o,c)}function Fx(o,c){return gc(4,2,o,c)}function Bx(o,c){return gc(4,4,o,c)}function Ux(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function $x(o,c,p){return p=p!=null?p.concat([o]):null,gc(4,4,Ux.bind(null,c,o),p)}function jf(){}function Vx(o,c){var p=On();c=c===void 0?null:c;var v=p.memoizedState;return v!==null&&c!==null&&If(c,v[1])?v[0]:(p.memoizedState=[o,c],o)}function Gx(o,c){var p=On();c=c===void 0?null:c;var v=p.memoizedState;return v!==null&&c!==null&&If(c,v[1])?v[0]:(o=o(),p.memoizedState=[o,c],o)}function Hx(o,c,p){return(ri&21)===0?(o.baseState&&(o.baseState=!1,mn=!0),o.memoizedState=p):(Qn(p,c)||(p=wg(),ft.lanes|=p,si|=p,o.baseState=!0),c)}function vA(o,c){var p=Qe;Qe=p!==0&&4>p?p:4,o(!0);var v=Af.transition;Af.transition={};try{o(!1),c()}finally{Qe=p,Af.transition=v}}function Kx(){return On().memoizedState}function wA(o,c,p){var v=Cs(o);if(p={lane:v,action:p,hasEagerState:!1,eagerState:null,next:null},zx(o))Wx(c,p);else if(p=Ex(o,c,p,v),p!==null){var S=an();tr(p,o,v,S),qx(p,c,v)}}function bA(o,c,p){var v=Cs(o),S={lane:v,action:p,hasEagerState:!1,eagerState:null,next:null};if(zx(o))Wx(c,S);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=c.lastRenderedReducer,k!==null))try{var R=c.lastRenderedState,F=k(R,p);if(S.hasEagerState=!0,S.eagerState=F,Qn(F,R)){var U=c.interleaved;U===null?(S.next=S,Sf(c)):(S.next=U.next,U.next=S),c.interleaved=S;return}}catch{}finally{}p=Ex(o,c,S,v),p!==null&&(S=an(),tr(p,o,v,S),qx(p,c,v))}}function zx(o){var c=o.alternate;return o===ft||c!==null&&c===ft}function Wx(o,c){wo=mc=!0;var p=o.pending;p===null?c.next=c:(c.next=p.next,p.next=c),o.pending=c}function qx(o,c,p){if((p&4194240)!==0){var v=c.lanes;v&=o.pendingLanes,p|=v,c.lanes=p,Od(o,p)}}var xc={readContext:jn,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useInsertionEffect:Xt,useLayoutEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useMutableSource:Xt,useSyncExternalStore:Xt,useId:Xt,unstable_isNewReconciler:!1},SA={readContext:jn,useCallback:function(o,c){return gr().memoizedState=[o,c===void 0?null:c],o},useContext:jn,useEffect:Mx,useImperativeHandle:function(o,c,p){return p=p!=null?p.concat([o]):null,pc(4194308,4,Ux.bind(null,c,o),p)},useLayoutEffect:function(o,c){return pc(4194308,4,o,c)},useInsertionEffect:function(o,c){return pc(4,2,o,c)},useMemo:function(o,c){var p=gr();return c=c===void 0?null:c,o=o(),p.memoizedState=[o,c],o},useReducer:function(o,c,p){var v=gr();return c=p!==void 0?p(c):c,v.memoizedState=v.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},v.queue=o,o=o.dispatch=wA.bind(null,ft,o),[v.memoizedState,o]},useRef:function(o){var c=gr();return o={current:o},c.memoizedState=o},useState:jx,useDebugValue:jf,useDeferredValue:function(o){return gr().memoizedState=o},useTransition:function(){var o=jx(!1),c=o[0];return o=vA.bind(null,o[1]),gr().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,p){var v=ft,S=gr();if(ct){if(p===void 0)throw Error(t(407));p=p()}else{if(p=c(),Ft===null)throw Error(t(349));(ri&30)!==0||Lx(v,c,p)}S.memoizedState=p;var k={value:p,getSnapshot:c};return S.queue=k,Mx(Px.bind(null,v,k,o),[o]),v.flags|=2048,Eo(9,Rx.bind(null,v,k,p,c),void 0,null),p},useId:function(){var o=gr(),c=Ft.identifierPrefix;if(ct){var p=Hr,v=Gr;p=(v&~(1<<32-Yn(v)-1)).toString(32)+p,c=":"+c+"R"+p,p=bo++,0<p&&(c+="H"+p.toString(32)),c+=":"}else p=yA++,c=":"+c+"r"+p.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},EA={readContext:jn,useCallback:Vx,useContext:jn,useEffect:Nf,useImperativeHandle:$x,useInsertionEffect:Fx,useLayoutEffect:Bx,useMemo:Gx,useReducer:Pf,useRef:Ox,useState:function(){return Pf(So)},useDebugValue:jf,useDeferredValue:function(o){var c=On();return Hx(c,Lt.memoizedState,o)},useTransition:function(){var o=Pf(So)[0],c=On().memoizedState;return[o,c]},useMutableSource:Ax,useSyncExternalStore:Ix,useId:Kx,unstable_isNewReconciler:!1},TA={readContext:jn,useCallback:Vx,useContext:jn,useEffect:Nf,useImperativeHandle:$x,useInsertionEffect:Fx,useLayoutEffect:Bx,useMemo:Gx,useReducer:Df,useRef:Ox,useState:function(){return Df(So)},useDebugValue:jf,useDeferredValue:function(o){var c=On();return Lt===null?c.memoizedState=o:Hx(c,Lt.memoizedState,o)},useTransition:function(){var o=Df(So)[0],c=On().memoizedState;return[o,c]},useMutableSource:Ax,useSyncExternalStore:Ix,useId:Kx,unstable_isNewReconciler:!1};function Zn(o,c){if(o&&o.defaultProps){c=Z({},c),o=o.defaultProps;for(var p in o)c[p]===void 0&&(c[p]=o[p]);return c}return c}function Of(o,c,p,v){c=o.memoizedState,p=p(v,c),p=p==null?c:Z({},c,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var yc={isMounted:function(o){return(o=o._reactInternals)?Qs(o)===o:!1},enqueueSetState:function(o,c,p){o=o._reactInternals;var v=an(),S=Cs(o),k=zr(v,S);k.payload=c,p!=null&&(k.callback=p),c=Es(o,k,S),c!==null&&(tr(c,o,S,v),uc(c,o,S))},enqueueReplaceState:function(o,c,p){o=o._reactInternals;var v=an(),S=Cs(o),k=zr(v,S);k.tag=1,k.payload=c,p!=null&&(k.callback=p),c=Es(o,k,S),c!==null&&(tr(c,o,S,v),uc(c,o,S))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var p=an(),v=Cs(o),S=zr(p,v);S.tag=2,c!=null&&(S.callback=c),c=Es(o,S,v),c!==null&&(tr(c,o,v,p),uc(c,o,v))}};function Yx(o,c,p,v,S,k,R){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,k,R):c.prototype&&c.prototype.isPureReactComponent?!lo(p,v)||!lo(S,k):!0}function Qx(o,c,p){var v=!1,S=ws,k=c.contextType;return typeof k=="object"&&k!==null?k=jn(k):(S=hn(c)?Zs:Qt.current,v=c.contextTypes,k=(v=v!=null)?Hi(o,S):ws),c=new c(p,k),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=yc,o.stateNode=c,c._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=S,o.__reactInternalMemoizedMaskedChildContext=k),c}function Xx(o,c,p,v){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,v),c.state!==o&&yc.enqueueReplaceState(c,c.state,null)}function Mf(o,c,p,v){var S=o.stateNode;S.props=p,S.state=o.memoizedState,S.refs={},Ef(o);var k=c.contextType;typeof k=="object"&&k!==null?S.context=jn(k):(k=hn(c)?Zs:Qt.current,S.context=Hi(o,k)),S.state=o.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(Of(o,c,k,p),S.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(c=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),c!==S.state&&yc.enqueueReplaceState(S,S.state,null),dc(o,p,S,v),S.state=o.memoizedState),typeof S.componentDidMount=="function"&&(o.flags|=4194308)}function Zi(o,c){try{var p="",v=c;do p+=ae(v),v=v.return;while(v);var S=p}catch(k){S=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:c,stack:S,digest:null}}function Ff(o,c,p){return{value:o,source:null,stack:p??null,digest:c??null}}function Bf(o,c){try{console.error(c.value)}catch(p){setTimeout(function(){throw p})}}var _A=typeof WeakMap=="function"?WeakMap:Map;function Zx(o,c,p){p=zr(-1,p),p.tag=3,p.payload={element:null};var v=c.value;return p.callback=function(){_c||(_c=!0,eh=v),Bf(o,c)},p}function Jx(o,c,p){p=zr(-1,p),p.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var S=c.value;p.payload=function(){return v(S)},p.callback=function(){Bf(o,c)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(p.callback=function(){Bf(o,c),typeof v!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var R=c.stack;this.componentDidCatch(c.value,{componentStack:R!==null?R:""})}),p}function ey(o,c,p){var v=o.pingCache;if(v===null){v=o.pingCache=new _A;var S=new Set;v.set(c,S)}else S=v.get(c),S===void 0&&(S=new Set,v.set(c,S));S.has(p)||(S.add(p),o=BA.bind(null,o,c,p),c.then(o,o))}function ty(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function ny(o,c,p,v,S){return(o.mode&1)===0?(o===c?o.flags|=65536:(o.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(c=zr(-1,1),c.tag=2,Es(p,c,1))),p.lanes|=1),o):(o.flags|=65536,o.lanes=S,o)}var kA=A.ReactCurrentOwner,mn=!1;function sn(o,c,p,v){c.child=o===null?Sx(c,null,p,v):qi(c,o.child,p,v)}function ry(o,c,p,v,S){p=p.render;var k=c.ref;return Qi(c,S),v=Lf(o,c,p,v,k,S),p=Rf(),o!==null&&!mn?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~S,Wr(o,c,S)):(ct&&p&&hf(c),c.flags|=1,sn(o,c,v,S),c.child)}function sy(o,c,p,v,S){if(o===null){var k=p.type;return typeof k=="function"&&!oh(k)&&k.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(c.tag=15,c.type=k,iy(o,c,k,v,S)):(o=Rc(p.type,null,v,c,c.mode,S),o.ref=c.ref,o.return=c,c.child=o)}if(k=o.child,(o.lanes&S)===0){var R=k.memoizedProps;if(p=p.compare,p=p!==null?p:lo,p(R,v)&&o.ref===c.ref)return Wr(o,c,S)}return c.flags|=1,o=Is(k,v),o.ref=c.ref,o.return=c,c.child=o}function iy(o,c,p,v,S){if(o!==null){var k=o.memoizedProps;if(lo(k,v)&&o.ref===c.ref)if(mn=!1,c.pendingProps=v=k,(o.lanes&S)!==0)(o.flags&131072)!==0&&(mn=!0);else return c.lanes=o.lanes,Wr(o,c,S)}return Uf(o,c,p,v,S)}function ay(o,c,p){var v=c.pendingProps,S=v.children,k=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(ea,Cn),Cn|=p;else{if((p&1073741824)===0)return o=k!==null?k.baseLanes|p:p,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,st(ea,Cn),Cn|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=k!==null?k.baseLanes:p,st(ea,Cn),Cn|=v}else k!==null?(v=k.baseLanes|p,c.memoizedState=null):v=p,st(ea,Cn),Cn|=v;return sn(o,c,S,p),c.child}function oy(o,c){var p=c.ref;(o===null&&p!==null||o!==null&&o.ref!==p)&&(c.flags|=512,c.flags|=2097152)}function Uf(o,c,p,v,S){var k=hn(p)?Zs:Qt.current;return k=Hi(c,k),Qi(c,S),p=Lf(o,c,p,v,k,S),v=Rf(),o!==null&&!mn?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~S,Wr(o,c,S)):(ct&&v&&hf(c),c.flags|=1,sn(o,c,p,S),c.child)}function ly(o,c,p,v,S){if(hn(p)){var k=!0;nc(c)}else k=!1;if(Qi(c,S),c.stateNode===null)wc(o,c),Qx(c,p,v),Mf(c,p,v,S),v=!0;else if(o===null){var R=c.stateNode,F=c.memoizedProps;R.props=F;var U=R.context,X=p.contextType;typeof X=="object"&&X!==null?X=jn(X):(X=hn(p)?Zs:Qt.current,X=Hi(c,X));var ue=p.getDerivedStateFromProps,de=typeof ue=="function"||typeof R.getSnapshotBeforeUpdate=="function";de||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(F!==v||U!==X)&&Xx(c,R,v,X),Ss=!1;var le=c.memoizedState;R.state=le,dc(c,v,R,S),U=c.memoizedState,F!==v||le!==U||fn.current||Ss?(typeof ue=="function"&&(Of(c,p,ue,v),U=c.memoizedState),(F=Ss||Yx(c,p,F,v,le,U,X))?(de||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(c.flags|=4194308)):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=U),R.props=v,R.state=U,R.context=X,v=F):(typeof R.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{R=c.stateNode,Tx(o,c),F=c.memoizedProps,X=c.type===c.elementType?F:Zn(c.type,F),R.props=X,de=c.pendingProps,le=R.context,U=p.contextType,typeof U=="object"&&U!==null?U=jn(U):(U=hn(p)?Zs:Qt.current,U=Hi(c,U));var ye=p.getDerivedStateFromProps;(ue=typeof ye=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(F!==de||le!==U)&&Xx(c,R,v,U),Ss=!1,le=c.memoizedState,R.state=le,dc(c,v,R,S);var Te=c.memoizedState;F!==de||le!==Te||fn.current||Ss?(typeof ye=="function"&&(Of(c,p,ye,v),Te=c.memoizedState),(X=Ss||Yx(c,p,X,v,le,Te,U)||!1)?(ue||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(v,Te,U),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(v,Te,U)),typeof R.componentDidUpdate=="function"&&(c.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof R.componentDidUpdate!="function"||F===o.memoizedProps&&le===o.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||F===o.memoizedProps&&le===o.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=Te),R.props=v,R.state=Te,R.context=U,v=X):(typeof R.componentDidUpdate!="function"||F===o.memoizedProps&&le===o.memoizedState||(c.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||F===o.memoizedProps&&le===o.memoizedState||(c.flags|=1024),v=!1)}return $f(o,c,p,v,k,S)}function $f(o,c,p,v,S,k){oy(o,c);var R=(c.flags&128)!==0;if(!v&&!R)return S&&hx(c,p,!1),Wr(o,c,k);v=c.stateNode,kA.current=c;var F=R&&typeof p.getDerivedStateFromError!="function"?null:v.render();return c.flags|=1,o!==null&&R?(c.child=qi(c,o.child,null,k),c.child=qi(c,null,F,k)):sn(o,c,F,k),c.memoizedState=v.state,S&&hx(c,p,!0),c.child}function cy(o){var c=o.stateNode;c.pendingContext?dx(o,c.pendingContext,c.pendingContext!==c.context):c.context&&dx(o,c.context,!1),Tf(o,c.containerInfo)}function uy(o,c,p,v,S){return Wi(),xf(S),c.flags|=256,sn(o,c,p,v),c.child}var Vf={dehydrated:null,treeContext:null,retryLane:0};function Gf(o){return{baseLanes:o,cachePool:null,transitions:null}}function dy(o,c,p){var v=c.pendingProps,S=dt.current,k=!1,R=(c.flags&128)!==0,F;if((F=R)||(F=o!==null&&o.memoizedState===null?!1:(S&2)!==0),F?(k=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&(S|=1),st(dt,S&1),o===null)return gf(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((c.mode&1)===0?c.lanes=1:o.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(R=v.children,o=v.fallback,k?(v=c.mode,k=c.child,R={mode:"hidden",children:R},(v&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=R):k=Pc(R,v,0,null),o=li(o,v,p,null),k.return=c,o.return=c,k.sibling=o,c.child=k,c.child.memoizedState=Gf(p),c.memoizedState=Vf,o):Hf(c,R));if(S=o.memoizedState,S!==null&&(F=S.dehydrated,F!==null))return CA(o,c,R,v,F,S,p);if(k){k=v.fallback,R=c.mode,S=o.child,F=S.sibling;var U={mode:"hidden",children:v.children};return(R&1)===0&&c.child!==S?(v=c.child,v.childLanes=0,v.pendingProps=U,c.deletions=null):(v=Is(S,U),v.subtreeFlags=S.subtreeFlags&14680064),F!==null?k=Is(F,k):(k=li(k,R,p,null),k.flags|=2),k.return=c,v.return=c,v.sibling=k,c.child=v,v=k,k=c.child,R=o.child.memoizedState,R=R===null?Gf(p):{baseLanes:R.baseLanes|p,cachePool:null,transitions:R.transitions},k.memoizedState=R,k.childLanes=o.childLanes&~p,c.memoizedState=Vf,v}return k=o.child,o=k.sibling,v=Is(k,{mode:"visible",children:v.children}),(c.mode&1)===0&&(v.lanes=p),v.return=c,v.sibling=null,o!==null&&(p=c.deletions,p===null?(c.deletions=[o],c.flags|=16):p.push(o)),c.child=v,c.memoizedState=null,v}function Hf(o,c){return c=Pc({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function vc(o,c,p,v){return v!==null&&xf(v),qi(c,o.child,null,p),o=Hf(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function CA(o,c,p,v,S,k,R){if(p)return c.flags&256?(c.flags&=-257,v=Ff(Error(t(422))),vc(o,c,R,v)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(k=v.fallback,S=c.mode,v=Pc({mode:"visible",children:v.children},S,0,null),k=li(k,S,R,null),k.flags|=2,v.return=c,k.return=c,v.sibling=k,c.child=v,(c.mode&1)!==0&&qi(c,o.child,null,R),c.child.memoizedState=Gf(R),c.memoizedState=Vf,k);if((c.mode&1)===0)return vc(o,c,R,null);if(S.data==="$!"){if(v=S.nextSibling&&S.nextSibling.dataset,v)var F=v.dgst;return v=F,k=Error(t(419)),v=Ff(k,v,void 0),vc(o,c,R,v)}if(F=(R&o.childLanes)!==0,mn||F){if(v=Ft,v!==null){switch(R&-R){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(v.suspendedLanes|R))!==0?0:S,S!==0&&S!==k.retryLane&&(k.retryLane=S,Kr(o,S),tr(v,o,S,-1))}return ah(),v=Ff(Error(t(421))),vc(o,c,R,v)}return S.data==="$?"?(c.flags|=128,c.child=o.child,c=UA.bind(null,o),S._reactRetry=c,null):(o=k.treeContext,kn=ys(S.nextSibling),_n=c,ct=!0,Xn=null,o!==null&&(Dn[Nn++]=Gr,Dn[Nn++]=Hr,Dn[Nn++]=Js,Gr=o.id,Hr=o.overflow,Js=c),c=Hf(c,v.children),c.flags|=4096,c)}function fy(o,c,p){o.lanes|=c;var v=o.alternate;v!==null&&(v.lanes|=c),bf(o.return,c,p)}function Kf(o,c,p,v,S){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:S}:(k.isBackwards=c,k.rendering=null,k.renderingStartTime=0,k.last=v,k.tail=p,k.tailMode=S)}function hy(o,c,p){var v=c.pendingProps,S=v.revealOrder,k=v.tail;if(sn(o,c,v.children,p),v=dt.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&fy(o,p,c);else if(o.tag===19)fy(o,p,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(st(dt,v),(c.mode&1)===0)c.memoizedState=null;else switch(S){case"forwards":for(p=c.child,S=null;p!==null;)o=p.alternate,o!==null&&fc(o)===null&&(S=p),p=p.sibling;p=S,p===null?(S=c.child,c.child=null):(S=p.sibling,p.sibling=null),Kf(c,!1,S,p,k);break;case"backwards":for(p=null,S=c.child,c.child=null;S!==null;){if(o=S.alternate,o!==null&&fc(o)===null){c.child=S;break}o=S.sibling,S.sibling=p,p=S,S=o}Kf(c,!0,p,null,k);break;case"together":Kf(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function wc(o,c){(c.mode&1)===0&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function Wr(o,c,p){if(o!==null&&(c.dependencies=o.dependencies),si|=c.lanes,(p&c.childLanes)===0)return null;if(o!==null&&c.child!==o.child)throw Error(t(153));if(c.child!==null){for(o=c.child,p=Is(o,o.pendingProps),c.child=p,p.return=c;o.sibling!==null;)o=o.sibling,p=p.sibling=Is(o,o.pendingProps),p.return=c;p.sibling=null}return c.child}function AA(o,c,p){switch(c.tag){case 3:cy(c),Wi();break;case 5:Cx(c);break;case 1:hn(c.type)&&nc(c);break;case 4:Tf(c,c.stateNode.containerInfo);break;case 10:var v=c.type._context,S=c.memoizedProps.value;st(lc,v._currentValue),v._currentValue=S;break;case 13:if(v=c.memoizedState,v!==null)return v.dehydrated!==null?(st(dt,dt.current&1),c.flags|=128,null):(p&c.child.childLanes)!==0?dy(o,c,p):(st(dt,dt.current&1),o=Wr(o,c,p),o!==null?o.sibling:null);st(dt,dt.current&1);break;case 19:if(v=(p&c.childLanes)!==0,(o.flags&128)!==0){if(v)return hy(o,c,p);c.flags|=128}if(S=c.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),st(dt,dt.current),v)break;return null;case 22:case 23:return c.lanes=0,ay(o,c,p)}return Wr(o,c,p)}var my,zf,py,gy;my=function(o,c){for(var p=c.child;p!==null;){if(p.tag===5||p.tag===6)o.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===c)break;for(;p.sibling===null;){if(p.return===null||p.return===c)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},zf=function(){},py=function(o,c,p,v){var S=o.memoizedProps;if(S!==v){o=c.stateNode,ni(pr.current);var k=null;switch(p){case"input":S=Ie(o,S),v=Ie(o,v),k=[];break;case"select":S=Z({},S,{value:void 0}),v=Z({},v,{value:void 0}),k=[];break;case"textarea":S=En(o,S),v=En(o,v),k=[];break;default:typeof S.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=Jl)}fr(p,v);var R;p=null;for(X in S)if(!v.hasOwnProperty(X)&&S.hasOwnProperty(X)&&S[X]!=null)if(X==="style"){var F=S[X];for(R in F)F.hasOwnProperty(R)&&(p||(p={}),p[R]="")}else X!=="dangerouslySetInnerHTML"&&X!=="children"&&X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(s.hasOwnProperty(X)?k||(k=[]):(k=k||[]).push(X,null));for(X in v){var U=v[X];if(F=S?.[X],v.hasOwnProperty(X)&&U!==F&&(U!=null||F!=null))if(X==="style")if(F){for(R in F)!F.hasOwnProperty(R)||U&&U.hasOwnProperty(R)||(p||(p={}),p[R]="");for(R in U)U.hasOwnProperty(R)&&F[R]!==U[R]&&(p||(p={}),p[R]=U[R])}else p||(k||(k=[]),k.push(X,p)),p=U;else X==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,F=F?F.__html:void 0,U!=null&&F!==U&&(k=k||[]).push(X,U)):X==="children"?typeof U!="string"&&typeof U!="number"||(k=k||[]).push(X,""+U):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&(s.hasOwnProperty(X)?(U!=null&&X==="onScroll"&&at("scroll",o),k||F===U||(k=[])):(k=k||[]).push(X,U))}p&&(k=k||[]).push("style",p);var X=k;(c.updateQueue=X)&&(c.flags|=4)}},gy=function(o,c,p,v){p!==v&&(c.flags|=4)};function To(o,c){if(!ct)switch(o.tailMode){case"hidden":c=o.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Zt(o){var c=o.alternate!==null&&o.alternate.child===o.child,p=0,v=0;if(c)for(var S=o.child;S!==null;)p|=S.lanes|S.childLanes,v|=S.subtreeFlags&14680064,v|=S.flags&14680064,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)p|=S.lanes|S.childLanes,v|=S.subtreeFlags,v|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=v,o.childLanes=p,c}function IA(o,c,p){var v=c.pendingProps;switch(mf(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(c),null;case 1:return hn(c.type)&&tc(),Zt(c),null;case 3:return v=c.stateNode,Xi(),ot(fn),ot(Qt),Cf(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(ac(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Xn!==null&&(rh(Xn),Xn=null))),zf(o,c),Zt(c),null;case 5:_f(c);var S=ni(vo.current);if(p=c.type,o!==null&&c.stateNode!=null)py(o,c,p,v,S),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!v){if(c.stateNode===null)throw Error(t(166));return Zt(c),null}if(o=ni(pr.current),ac(c)){v=c.stateNode,p=c.type;var k=c.memoizedProps;switch(v[mr]=c,v[mo]=k,o=(c.mode&1)!==0,p){case"dialog":at("cancel",v),at("close",v);break;case"iframe":case"object":case"embed":at("load",v);break;case"video":case"audio":for(S=0;S<uo.length;S++)at(uo[S],v);break;case"source":at("error",v);break;case"img":case"image":case"link":at("error",v),at("load",v);break;case"details":at("toggle",v);break;case"input":Me(v,k),at("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!k.multiple},at("invalid",v);break;case"textarea":Fr(v,k),at("invalid",v)}fr(p,k),S=null;for(var R in k)if(k.hasOwnProperty(R)){var F=k[R];R==="children"?typeof F=="string"?v.textContent!==F&&(k.suppressHydrationWarning!==!0&&Zl(v.textContent,F,o),S=["children",F]):typeof F=="number"&&v.textContent!==""+F&&(k.suppressHydrationWarning!==!0&&Zl(v.textContent,F,o),S=["children",""+F]):s.hasOwnProperty(R)&&F!=null&&R==="onScroll"&&at("scroll",v)}switch(p){case"input":Re(v),Je(v,k,!0);break;case"textarea":Re(v),cs(v);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(v.onclick=Jl)}v=S,c.updateQueue=v,v!==null&&(c.flags|=4)}else{R=S.nodeType===9?S:S.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Br(p)),o==="http://www.w3.org/1999/xhtml"?p==="script"?(o=R.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=R.createElement(p,{is:v.is}):(o=R.createElement(p),p==="select"&&(R=o,v.multiple?R.multiple=!0:v.size&&(R.size=v.size))):o=R.createElementNS(o,p),o[mr]=c,o[mo]=v,my(o,c,!1,!1),c.stateNode=o;e:{switch(R=Ka(p,v),p){case"dialog":at("cancel",o),at("close",o),S=v;break;case"iframe":case"object":case"embed":at("load",o),S=v;break;case"video":case"audio":for(S=0;S<uo.length;S++)at(uo[S],o);S=v;break;case"source":at("error",o),S=v;break;case"img":case"image":case"link":at("error",o),at("load",o),S=v;break;case"details":at("toggle",o),S=v;break;case"input":Me(o,v),S=Ie(o,v),at("invalid",o);break;case"option":S=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},S=Z({},v,{value:void 0}),at("invalid",o);break;case"textarea":Fr(o,v),S=En(o,v),at("invalid",o);break;default:S=v}fr(p,S),F=S;for(k in F)if(F.hasOwnProperty(k)){var U=F[k];k==="style"?yt(o,U):k==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&ds(o,U)):k==="children"?typeof U=="string"?(p!=="textarea"||U!=="")&&dr(o,U):typeof U=="number"&&dr(o,""+U):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(s.hasOwnProperty(k)?U!=null&&k==="onScroll"&&at("scroll",o):U!=null&&_(o,k,U,R))}switch(p){case"input":Re(o),Je(o,v,!1);break;case"textarea":Re(o),cs(o);break;case"option":v.value!=null&&o.setAttribute("value",""+Ee(v.value));break;case"select":o.multiple=!!v.multiple,k=v.value,k!=null?nn(o,!!v.multiple,k,!1):v.defaultValue!=null&&nn(o,!!v.multiple,v.defaultValue,!0);break;default:typeof S.onClick=="function"&&(o.onclick=Jl)}switch(p){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Zt(c),null;case 6:if(o&&c.stateNode!=null)gy(o,c,o.memoizedProps,v);else{if(typeof v!="string"&&c.stateNode===null)throw Error(t(166));if(p=ni(vo.current),ni(pr.current),ac(c)){if(v=c.stateNode,p=c.memoizedProps,v[mr]=c,(k=v.nodeValue!==p)&&(o=_n,o!==null))switch(o.tag){case 3:Zl(v.nodeValue,p,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Zl(v.nodeValue,p,(o.mode&1)!==0)}k&&(c.flags|=4)}else v=(p.nodeType===9?p:p.ownerDocument).createTextNode(v),v[mr]=c,c.stateNode=v}return Zt(c),null;case 13:if(ot(dt),v=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(ct&&kn!==null&&(c.mode&1)!==0&&(c.flags&128)===0)vx(),Wi(),c.flags|=98560,k=!1;else if(k=ac(c),v!==null&&v.dehydrated!==null){if(o===null){if(!k)throw Error(t(318));if(k=c.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[mr]=c}else Wi(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Zt(c),k=!1}else Xn!==null&&(rh(Xn),Xn=null),k=!0;if(!k)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=p,c):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(c.child.flags|=8192,(c.mode&1)!==0&&(o===null||(dt.current&1)!==0?Rt===0&&(Rt=3):ah())),c.updateQueue!==null&&(c.flags|=4),Zt(c),null);case 4:return Xi(),zf(o,c),o===null&&fo(c.stateNode.containerInfo),Zt(c),null;case 10:return wf(c.type._context),Zt(c),null;case 17:return hn(c.type)&&tc(),Zt(c),null;case 19:if(ot(dt),k=c.memoizedState,k===null)return Zt(c),null;if(v=(c.flags&128)!==0,R=k.rendering,R===null)if(v)To(k,!1);else{if(Rt!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(R=fc(o),R!==null){for(c.flags|=128,To(k,!1),v=R.updateQueue,v!==null&&(c.updateQueue=v,c.flags|=4),c.subtreeFlags=0,v=p,p=c.child;p!==null;)k=p,o=v,k.flags&=14680066,R=k.alternate,R===null?(k.childLanes=0,k.lanes=o,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=R.childLanes,k.lanes=R.lanes,k.child=R.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=R.memoizedProps,k.memoizedState=R.memoizedState,k.updateQueue=R.updateQueue,k.type=R.type,o=R.dependencies,k.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),p=p.sibling;return st(dt,dt.current&1|2),c.child}o=o.sibling}k.tail!==null&&Tt()>ta&&(c.flags|=128,v=!0,To(k,!1),c.lanes=4194304)}else{if(!v)if(o=fc(R),o!==null){if(c.flags|=128,v=!0,p=o.updateQueue,p!==null&&(c.updateQueue=p,c.flags|=4),To(k,!0),k.tail===null&&k.tailMode==="hidden"&&!R.alternate&&!ct)return Zt(c),null}else 2*Tt()-k.renderingStartTime>ta&&p!==1073741824&&(c.flags|=128,v=!0,To(k,!1),c.lanes=4194304);k.isBackwards?(R.sibling=c.child,c.child=R):(p=k.last,p!==null?p.sibling=R:c.child=R,k.last=R)}return k.tail!==null?(c=k.tail,k.rendering=c,k.tail=c.sibling,k.renderingStartTime=Tt(),c.sibling=null,p=dt.current,st(dt,v?p&1|2:p&1),c):(Zt(c),null);case 22:case 23:return ih(),v=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(c.flags|=8192),v&&(c.mode&1)!==0?(Cn&1073741824)!==0&&(Zt(c),c.subtreeFlags&6&&(c.flags|=8192)):Zt(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function LA(o,c){switch(mf(c),c.tag){case 1:return hn(c.type)&&tc(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Xi(),ot(fn),ot(Qt),Cf(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 5:return _f(c),null;case 13:if(ot(dt),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(t(340));Wi()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return ot(dt),null;case 4:return Xi(),null;case 10:return wf(c.type._context),null;case 22:case 23:return ih(),null;case 24:return null;default:return null}}var bc=!1,Jt=!1,RA=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Ji(o,c){var p=o.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(v){vt(o,c,v)}else p.current=null}function Wf(o,c,p){try{p()}catch(v){vt(o,c,v)}}var xy=!1;function PA(o,c){if(sf=$l,o=Yg(),Qd(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else e:{p=(p=o.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var S=v.anchorOffset,k=v.focusNode;v=v.focusOffset;try{p.nodeType,k.nodeType}catch{p=null;break e}var R=0,F=-1,U=-1,X=0,ue=0,de=o,le=null;t:for(;;){for(var ye;de!==p||S!==0&&de.nodeType!==3||(F=R+S),de!==k||v!==0&&de.nodeType!==3||(U=R+v),de.nodeType===3&&(R+=de.nodeValue.length),(ye=de.firstChild)!==null;)le=de,de=ye;for(;;){if(de===o)break t;if(le===p&&++X===S&&(F=R),le===k&&++ue===v&&(U=R),(ye=de.nextSibling)!==null)break;de=le,le=de.parentNode}de=ye}p=F===-1||U===-1?null:{start:F,end:U}}else p=null}p=p||{start:0,end:0}}else p=null;for(af={focusedElem:o,selectionRange:p},$l=!1,Se=c;Se!==null;)if(c=Se,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,Se=o;else for(;Se!==null;){c=Se;try{var Te=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var ke=Te.memoizedProps,_t=Te.memoizedState,z=c.stateNode,V=z.getSnapshotBeforeUpdate(c.elementType===c.type?ke:Zn(c.type,ke),_t);z.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var W=c.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){vt(c,c.return,he)}if(o=c.sibling,o!==null){o.return=c.return,Se=o;break}Se=c.return}return Te=xy,xy=!1,Te}function _o(o,c,p){var v=c.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var S=v=v.next;do{if((S.tag&o)===o){var k=S.destroy;S.destroy=void 0,k!==void 0&&Wf(c,p,k)}S=S.next}while(S!==v)}}function Sc(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var p=c=c.next;do{if((p.tag&o)===o){var v=p.create;p.destroy=v()}p=p.next}while(p!==c)}}function qf(o){var c=o.ref;if(c!==null){var p=o.stateNode;switch(o.tag){case 5:o=p;break;default:o=p}typeof c=="function"?c(o):c.current=o}}function yy(o){var c=o.alternate;c!==null&&(o.alternate=null,yy(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[mr],delete c[mo],delete c[uf],delete c[mA],delete c[pA])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function vy(o){return o.tag===5||o.tag===3||o.tag===4}function wy(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||vy(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Yf(o,c,p){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?p.nodeType===8?p.parentNode.insertBefore(o,c):p.insertBefore(o,c):(p.nodeType===8?(c=p.parentNode,c.insertBefore(o,p)):(c=p,c.appendChild(o)),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=Jl));else if(v!==4&&(o=o.child,o!==null))for(Yf(o,c,p),o=o.sibling;o!==null;)Yf(o,c,p),o=o.sibling}function Qf(o,c,p){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?p.insertBefore(o,c):p.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(Qf(o,c,p),o=o.sibling;o!==null;)Qf(o,c,p),o=o.sibling}var Vt=null,Jn=!1;function Ts(o,c,p){for(p=p.child;p!==null;)by(o,c,p),p=p.sibling}function by(o,c,p){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(jl,p)}catch{}switch(p.tag){case 5:Jt||Ji(p,c);case 6:var v=Vt,S=Jn;Vt=null,Ts(o,c,p),Vt=v,Jn=S,Vt!==null&&(Jn?(o=Vt,p=p.stateNode,o.nodeType===8?o.parentNode.removeChild(p):o.removeChild(p)):Vt.removeChild(p.stateNode));break;case 18:Vt!==null&&(Jn?(o=Vt,p=p.stateNode,o.nodeType===8?cf(o.parentNode,p):o.nodeType===1&&cf(o,p),no(o)):cf(Vt,p.stateNode));break;case 4:v=Vt,S=Jn,Vt=p.stateNode.containerInfo,Jn=!0,Ts(o,c,p),Vt=v,Jn=S;break;case 0:case 11:case 14:case 15:if(!Jt&&(v=p.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){S=v=v.next;do{var k=S,R=k.destroy;k=k.tag,R!==void 0&&((k&2)!==0||(k&4)!==0)&&Wf(p,c,R),S=S.next}while(S!==v)}Ts(o,c,p);break;case 1:if(!Jt&&(Ji(p,c),v=p.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=p.memoizedProps,v.state=p.memoizedState,v.componentWillUnmount()}catch(F){vt(p,c,F)}Ts(o,c,p);break;case 21:Ts(o,c,p);break;case 22:p.mode&1?(Jt=(v=Jt)||p.memoizedState!==null,Ts(o,c,p),Jt=v):Ts(o,c,p);break;default:Ts(o,c,p)}}function Sy(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var p=o.stateNode;p===null&&(p=o.stateNode=new RA),c.forEach(function(v){var S=$A.bind(null,o,v);p.has(v)||(p.add(v),v.then(S,S))})}}function er(o,c){var p=c.deletions;if(p!==null)for(var v=0;v<p.length;v++){var S=p[v];try{var k=o,R=c,F=R;e:for(;F!==null;){switch(F.tag){case 5:Vt=F.stateNode,Jn=!1;break e;case 3:Vt=F.stateNode.containerInfo,Jn=!0;break e;case 4:Vt=F.stateNode.containerInfo,Jn=!0;break e}F=F.return}if(Vt===null)throw Error(t(160));by(k,R,S),Vt=null,Jn=!1;var U=S.alternate;U!==null&&(U.return=null),S.return=null}catch(X){vt(S,c,X)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Ey(c,o),c=c.sibling}function Ey(o,c){var p=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(er(c,o),xr(o),v&4){try{_o(3,o,o.return),Sc(3,o)}catch(ke){vt(o,o.return,ke)}try{_o(5,o,o.return)}catch(ke){vt(o,o.return,ke)}}break;case 1:er(c,o),xr(o),v&512&&p!==null&&Ji(p,p.return);break;case 5:if(er(c,o),xr(o),v&512&&p!==null&&Ji(p,p.return),o.flags&32){var S=o.stateNode;try{dr(S,"")}catch(ke){vt(o,o.return,ke)}}if(v&4&&(S=o.stateNode,S!=null)){var k=o.memoizedProps,R=p!==null?p.memoizedProps:k,F=o.type,U=o.updateQueue;if(o.updateQueue=null,U!==null)try{F==="input"&&k.type==="radio"&&k.name!=null&&we(S,k),Ka(F,R);var X=Ka(F,k);for(R=0;R<U.length;R+=2){var ue=U[R],de=U[R+1];ue==="style"?yt(S,de):ue==="dangerouslySetInnerHTML"?ds(S,de):ue==="children"?dr(S,de):_(S,ue,de,X)}switch(F){case"input":Ue(S,k);break;case"textarea":ls(S,k);break;case"select":var le=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!k.multiple;var ye=k.value;ye!=null?nn(S,!!k.multiple,ye,!1):le!==!!k.multiple&&(k.defaultValue!=null?nn(S,!!k.multiple,k.defaultValue,!0):nn(S,!!k.multiple,k.multiple?[]:"",!1))}S[mo]=k}catch(ke){vt(o,o.return,ke)}}break;case 6:if(er(c,o),xr(o),v&4){if(o.stateNode===null)throw Error(t(162));S=o.stateNode,k=o.memoizedProps;try{S.nodeValue=k}catch(ke){vt(o,o.return,ke)}}break;case 3:if(er(c,o),xr(o),v&4&&p!==null&&p.memoizedState.isDehydrated)try{no(c.containerInfo)}catch(ke){vt(o,o.return,ke)}break;case 4:er(c,o),xr(o);break;case 13:er(c,o),xr(o),S=o.child,S.flags&8192&&(k=S.memoizedState!==null,S.stateNode.isHidden=k,!k||S.alternate!==null&&S.alternate.memoizedState!==null||(Jf=Tt())),v&4&&Sy(o);break;case 22:if(ue=p!==null&&p.memoizedState!==null,o.mode&1?(Jt=(X=Jt)||ue,er(c,o),Jt=X):er(c,o),xr(o),v&8192){if(X=o.memoizedState!==null,(o.stateNode.isHidden=X)&&!ue&&(o.mode&1)!==0)for(Se=o,ue=o.child;ue!==null;){for(de=Se=ue;Se!==null;){switch(le=Se,ye=le.child,le.tag){case 0:case 11:case 14:case 15:_o(4,le,le.return);break;case 1:Ji(le,le.return);var Te=le.stateNode;if(typeof Te.componentWillUnmount=="function"){v=le,p=le.return;try{c=v,Te.props=c.memoizedProps,Te.state=c.memoizedState,Te.componentWillUnmount()}catch(ke){vt(v,p,ke)}}break;case 5:Ji(le,le.return);break;case 22:if(le.memoizedState!==null){ky(de);continue}}ye!==null?(ye.return=le,Se=ye):ky(de)}ue=ue.sibling}e:for(ue=null,de=o;;){if(de.tag===5){if(ue===null){ue=de;try{S=de.stateNode,X?(k=S.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(F=de.stateNode,U=de.memoizedProps.style,R=U!=null&&U.hasOwnProperty("display")?U.display:null,F.style.display=xe("display",R))}catch(ke){vt(o,o.return,ke)}}}else if(de.tag===6){if(ue===null)try{de.stateNode.nodeValue=X?"":de.memoizedProps}catch(ke){vt(o,o.return,ke)}}else if((de.tag!==22&&de.tag!==23||de.memoizedState===null||de===o)&&de.child!==null){de.child.return=de,de=de.child;continue}if(de===o)break e;for(;de.sibling===null;){if(de.return===null||de.return===o)break e;ue===de&&(ue=null),de=de.return}ue===de&&(ue=null),de.sibling.return=de.return,de=de.sibling}}break;case 19:er(c,o),xr(o),v&4&&Sy(o);break;case 21:break;default:er(c,o),xr(o)}}function xr(o){var c=o.flags;if(c&2){try{e:{for(var p=o.return;p!==null;){if(vy(p)){var v=p;break e}p=p.return}throw Error(t(160))}switch(v.tag){case 5:var S=v.stateNode;v.flags&32&&(dr(S,""),v.flags&=-33);var k=wy(o);Qf(o,k,S);break;case 3:case 4:var R=v.stateNode.containerInfo,F=wy(o);Yf(o,F,R);break;default:throw Error(t(161))}}catch(U){vt(o,o.return,U)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function DA(o,c,p){Se=o,Ty(o)}function Ty(o,c,p){for(var v=(o.mode&1)!==0;Se!==null;){var S=Se,k=S.child;if(S.tag===22&&v){var R=S.memoizedState!==null||bc;if(!R){var F=S.alternate,U=F!==null&&F.memoizedState!==null||Jt;F=bc;var X=Jt;if(bc=R,(Jt=U)&&!X)for(Se=S;Se!==null;)R=Se,U=R.child,R.tag===22&&R.memoizedState!==null?Cy(S):U!==null?(U.return=R,Se=U):Cy(S);for(;k!==null;)Se=k,Ty(k),k=k.sibling;Se=S,bc=F,Jt=X}_y(o)}else(S.subtreeFlags&8772)!==0&&k!==null?(k.return=S,Se=k):_y(o)}}function _y(o){for(;Se!==null;){var c=Se;if((c.flags&8772)!==0){var p=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Jt||Sc(5,c);break;case 1:var v=c.stateNode;if(c.flags&4&&!Jt)if(p===null)v.componentDidMount();else{var S=c.elementType===c.type?p.memoizedProps:Zn(c.type,p.memoizedProps);v.componentDidUpdate(S,p.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var k=c.updateQueue;k!==null&&kx(c,k,v);break;case 3:var R=c.updateQueue;if(R!==null){if(p=null,c.child!==null)switch(c.child.tag){case 5:p=c.child.stateNode;break;case 1:p=c.child.stateNode}kx(c,R,p)}break;case 5:var F=c.stateNode;if(p===null&&c.flags&4){p=F;var U=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&p.focus();break;case"img":U.src&&(p.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var X=c.alternate;if(X!==null){var ue=X.memoizedState;if(ue!==null){var de=ue.dehydrated;de!==null&&no(de)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Jt||c.flags&512&&qf(c)}catch(le){vt(c,c.return,le)}}if(c===o){Se=null;break}if(p=c.sibling,p!==null){p.return=c.return,Se=p;break}Se=c.return}}function ky(o){for(;Se!==null;){var c=Se;if(c===o){Se=null;break}var p=c.sibling;if(p!==null){p.return=c.return,Se=p;break}Se=c.return}}function Cy(o){for(;Se!==null;){var c=Se;try{switch(c.tag){case 0:case 11:case 15:var p=c.return;try{Sc(4,c)}catch(U){vt(c,p,U)}break;case 1:var v=c.stateNode;if(typeof v.componentDidMount=="function"){var S=c.return;try{v.componentDidMount()}catch(U){vt(c,S,U)}}var k=c.return;try{qf(c)}catch(U){vt(c,k,U)}break;case 5:var R=c.return;try{qf(c)}catch(U){vt(c,R,U)}}}catch(U){vt(c,c.return,U)}if(c===o){Se=null;break}var F=c.sibling;if(F!==null){F.return=c.return,Se=F;break}Se=c.return}}var NA=Math.ceil,Ec=A.ReactCurrentDispatcher,Xf=A.ReactCurrentOwner,Mn=A.ReactCurrentBatchConfig,Ke=0,Ft=null,Ct=null,Gt=0,Cn=0,ea=vs(0),Rt=0,ko=null,si=0,Tc=0,Zf=0,Co=null,pn=null,Jf=0,ta=1/0,qr=null,_c=!1,eh=null,_s=null,kc=!1,ks=null,Cc=0,Ao=0,th=null,Ac=-1,Ic=0;function an(){return(Ke&6)!==0?Tt():Ac!==-1?Ac:Ac=Tt()}function Cs(o){return(o.mode&1)===0?1:(Ke&2)!==0&&Gt!==0?Gt&-Gt:xA.transition!==null?(Ic===0&&(Ic=wg()),Ic):(o=Qe,o!==0||(o=window.event,o=o===void 0?16:Ig(o.type)),o)}function tr(o,c,p,v){if(50<Ao)throw Ao=0,th=null,Error(t(185));Xa(o,p,v),((Ke&2)===0||o!==Ft)&&(o===Ft&&((Ke&2)===0&&(Tc|=p),Rt===4&&As(o,Gt)),gn(o,v),p===1&&Ke===0&&(c.mode&1)===0&&(ta=Tt()+500,rc&&bs()))}function gn(o,c){var p=o.callbackNode;xC(o,c);var v=Fl(o,o===Ft?Gt:0);if(v===0)p!==null&&xg(p),o.callbackNode=null,o.callbackPriority=0;else if(c=v&-v,o.callbackPriority!==c){if(p!=null&&xg(p),c===1)o.tag===0?gA(Iy.bind(null,o)):mx(Iy.bind(null,o)),fA(function(){(Ke&6)===0&&bs()}),p=null;else{switch(bg(v)){case 1:p=Dd;break;case 4:p=yg;break;case 16:p=Nl;break;case 536870912:p=vg;break;default:p=Nl}p=My(p,Ay.bind(null,o))}o.callbackPriority=c,o.callbackNode=p}}function Ay(o,c){if(Ac=-1,Ic=0,(Ke&6)!==0)throw Error(t(327));var p=o.callbackNode;if(na()&&o.callbackNode!==p)return null;var v=Fl(o,o===Ft?Gt:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||c)c=Lc(o,v);else{c=v;var S=Ke;Ke|=2;var k=Ry();(Ft!==o||Gt!==c)&&(qr=null,ta=Tt()+500,ai(o,c));do try{MA();break}catch(F){Ly(o,F)}while(!0);vf(),Ec.current=k,Ke=S,Ct!==null?c=0:(Ft=null,Gt=0,c=Rt)}if(c!==0){if(c===2&&(S=Nd(o),S!==0&&(v=S,c=nh(o,S))),c===1)throw p=ko,ai(o,0),As(o,v),gn(o,Tt()),p;if(c===6)As(o,v);else{if(S=o.current.alternate,(v&30)===0&&!jA(S)&&(c=Lc(o,v),c===2&&(k=Nd(o),k!==0&&(v=k,c=nh(o,k))),c===1))throw p=ko,ai(o,0),As(o,v),gn(o,Tt()),p;switch(o.finishedWork=S,o.finishedLanes=v,c){case 0:case 1:throw Error(t(345));case 2:oi(o,pn,qr);break;case 3:if(As(o,v),(v&130023424)===v&&(c=Jf+500-Tt(),10<c)){if(Fl(o,0)!==0)break;if(S=o.suspendedLanes,(S&v)!==v){an(),o.pingedLanes|=o.suspendedLanes&S;break}o.timeoutHandle=lf(oi.bind(null,o,pn,qr),c);break}oi(o,pn,qr);break;case 4:if(As(o,v),(v&4194240)===v)break;for(c=o.eventTimes,S=-1;0<v;){var R=31-Yn(v);k=1<<R,R=c[R],R>S&&(S=R),v&=~k}if(v=S,v=Tt()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*NA(v/1960))-v,10<v){o.timeoutHandle=lf(oi.bind(null,o,pn,qr),v);break}oi(o,pn,qr);break;case 5:oi(o,pn,qr);break;default:throw Error(t(329))}}}return gn(o,Tt()),o.callbackNode===p?Ay.bind(null,o):null}function nh(o,c){var p=Co;return o.current.memoizedState.isDehydrated&&(ai(o,c).flags|=256),o=Lc(o,c),o!==2&&(c=pn,pn=p,c!==null&&rh(c)),o}function rh(o){pn===null?pn=o:pn.push.apply(pn,o)}function jA(o){for(var c=o;;){if(c.flags&16384){var p=c.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var v=0;v<p.length;v++){var S=p[v],k=S.getSnapshot;S=S.value;try{if(!Qn(k(),S))return!1}catch{return!1}}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function As(o,c){for(c&=~Zf,c&=~Tc,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var p=31-Yn(c),v=1<<p;o[p]=-1,c&=~v}}function Iy(o){if((Ke&6)!==0)throw Error(t(327));na();var c=Fl(o,0);if((c&1)===0)return gn(o,Tt()),null;var p=Lc(o,c);if(o.tag!==0&&p===2){var v=Nd(o);v!==0&&(c=v,p=nh(o,v))}if(p===1)throw p=ko,ai(o,0),As(o,c),gn(o,Tt()),p;if(p===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,oi(o,pn,qr),gn(o,Tt()),null}function sh(o,c){var p=Ke;Ke|=1;try{return o(c)}finally{Ke=p,Ke===0&&(ta=Tt()+500,rc&&bs())}}function ii(o){ks!==null&&ks.tag===0&&(Ke&6)===0&&na();var c=Ke;Ke|=1;var p=Mn.transition,v=Qe;try{if(Mn.transition=null,Qe=1,o)return o()}finally{Qe=v,Mn.transition=p,Ke=c,(Ke&6)===0&&bs()}}function ih(){Cn=ea.current,ot(ea)}function ai(o,c){o.finishedWork=null,o.finishedLanes=0;var p=o.timeoutHandle;if(p!==-1&&(o.timeoutHandle=-1,dA(p)),Ct!==null)for(p=Ct.return;p!==null;){var v=p;switch(mf(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&tc();break;case 3:Xi(),ot(fn),ot(Qt),Cf();break;case 5:_f(v);break;case 4:Xi();break;case 13:ot(dt);break;case 19:ot(dt);break;case 10:wf(v.type._context);break;case 22:case 23:ih()}p=p.return}if(Ft=o,Ct=o=Is(o.current,null),Gt=Cn=c,Rt=0,ko=null,Zf=Tc=si=0,pn=Co=null,ti!==null){for(c=0;c<ti.length;c++)if(p=ti[c],v=p.interleaved,v!==null){p.interleaved=null;var S=v.next,k=p.pending;if(k!==null){var R=k.next;k.next=S,v.next=R}p.pending=v}ti=null}return o}function Ly(o,c){do{var p=Ct;try{if(vf(),hc.current=xc,mc){for(var v=ft.memoizedState;v!==null;){var S=v.queue;S!==null&&(S.pending=null),v=v.next}mc=!1}if(ri=0,Mt=Lt=ft=null,wo=!1,bo=0,Xf.current=null,p===null||p.return===null){Rt=1,ko=c,Ct=null;break}e:{var k=o,R=p.return,F=p,U=c;if(c=Gt,F.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var X=U,ue=F,de=ue.tag;if((ue.mode&1)===0&&(de===0||de===11||de===15)){var le=ue.alternate;le?(ue.updateQueue=le.updateQueue,ue.memoizedState=le.memoizedState,ue.lanes=le.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var ye=ty(R);if(ye!==null){ye.flags&=-257,ny(ye,R,F,k,c),ye.mode&1&&ey(k,X,c),c=ye,U=X;var Te=c.updateQueue;if(Te===null){var ke=new Set;ke.add(U),c.updateQueue=ke}else Te.add(U);break e}else{if((c&1)===0){ey(k,X,c),ah();break e}U=Error(t(426))}}else if(ct&&F.mode&1){var _t=ty(R);if(_t!==null){(_t.flags&65536)===0&&(_t.flags|=256),ny(_t,R,F,k,c),xf(Zi(U,F));break e}}k=U=Zi(U,F),Rt!==4&&(Rt=2),Co===null?Co=[k]:Co.push(k),k=R;do{switch(k.tag){case 3:k.flags|=65536,c&=-c,k.lanes|=c;var z=Zx(k,U,c);_x(k,z);break e;case 1:F=U;var V=k.type,W=k.stateNode;if((k.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(_s===null||!_s.has(W)))){k.flags|=65536,c&=-c,k.lanes|=c;var he=Jx(k,F,c);_x(k,he);break e}}k=k.return}while(k!==null)}Dy(p)}catch(Ae){c=Ae,Ct===p&&p!==null&&(Ct=p=p.return);continue}break}while(!0)}function Ry(){var o=Ec.current;return Ec.current=xc,o===null?xc:o}function ah(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),Ft===null||(si&268435455)===0&&(Tc&268435455)===0||As(Ft,Gt)}function Lc(o,c){var p=Ke;Ke|=2;var v=Ry();(Ft!==o||Gt!==c)&&(qr=null,ai(o,c));do try{OA();break}catch(S){Ly(o,S)}while(!0);if(vf(),Ke=p,Ec.current=v,Ct!==null)throw Error(t(261));return Ft=null,Gt=0,Rt}function OA(){for(;Ct!==null;)Py(Ct)}function MA(){for(;Ct!==null&&!lC();)Py(Ct)}function Py(o){var c=Oy(o.alternate,o,Cn);o.memoizedProps=o.pendingProps,c===null?Dy(o):Ct=c,Xf.current=null}function Dy(o){var c=o;do{var p=c.alternate;if(o=c.return,(c.flags&32768)===0){if(p=IA(p,c,Cn),p!==null){Ct=p;return}}else{if(p=LA(p,c),p!==null){p.flags&=32767,Ct=p;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Rt=6,Ct=null;return}}if(c=c.sibling,c!==null){Ct=c;return}Ct=c=o}while(c!==null);Rt===0&&(Rt=5)}function oi(o,c,p){var v=Qe,S=Mn.transition;try{Mn.transition=null,Qe=1,FA(o,c,p,v)}finally{Mn.transition=S,Qe=v}return null}function FA(o,c,p,v){do na();while(ks!==null);if((Ke&6)!==0)throw Error(t(327));p=o.finishedWork;var S=o.finishedLanes;if(p===null)return null;if(o.finishedWork=null,o.finishedLanes=0,p===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var k=p.lanes|p.childLanes;if(yC(o,k),o===Ft&&(Ct=Ft=null,Gt=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||kc||(kc=!0,My(Nl,function(){return na(),null})),k=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||k){k=Mn.transition,Mn.transition=null;var R=Qe;Qe=1;var F=Ke;Ke|=4,Xf.current=null,PA(o,p),Ey(p,o),sA(af),$l=!!sf,af=sf=null,o.current=p,DA(p),cC(),Ke=F,Qe=R,Mn.transition=k}else o.current=p;if(kc&&(kc=!1,ks=o,Cc=S),k=o.pendingLanes,k===0&&(_s=null),fC(p.stateNode),gn(o,Tt()),c!==null)for(v=o.onRecoverableError,p=0;p<c.length;p++)S=c[p],v(S.value,{componentStack:S.stack,digest:S.digest});if(_c)throw _c=!1,o=eh,eh=null,o;return(Cc&1)!==0&&o.tag!==0&&na(),k=o.pendingLanes,(k&1)!==0?o===th?Ao++:(Ao=0,th=o):Ao=0,bs(),null}function na(){if(ks!==null){var o=bg(Cc),c=Mn.transition,p=Qe;try{if(Mn.transition=null,Qe=16>o?16:o,ks===null)var v=!1;else{if(o=ks,ks=null,Cc=0,(Ke&6)!==0)throw Error(t(331));var S=Ke;for(Ke|=4,Se=o.current;Se!==null;){var k=Se,R=k.child;if((Se.flags&16)!==0){var F=k.deletions;if(F!==null){for(var U=0;U<F.length;U++){var X=F[U];for(Se=X;Se!==null;){var ue=Se;switch(ue.tag){case 0:case 11:case 15:_o(8,ue,k)}var de=ue.child;if(de!==null)de.return=ue,Se=de;else for(;Se!==null;){ue=Se;var le=ue.sibling,ye=ue.return;if(yy(ue),ue===X){Se=null;break}if(le!==null){le.return=ye,Se=le;break}Se=ye}}}var Te=k.alternate;if(Te!==null){var ke=Te.child;if(ke!==null){Te.child=null;do{var _t=ke.sibling;ke.sibling=null,ke=_t}while(ke!==null)}}Se=k}}if((k.subtreeFlags&2064)!==0&&R!==null)R.return=k,Se=R;else e:for(;Se!==null;){if(k=Se,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:_o(9,k,k.return)}var z=k.sibling;if(z!==null){z.return=k.return,Se=z;break e}Se=k.return}}var V=o.current;for(Se=V;Se!==null;){R=Se;var W=R.child;if((R.subtreeFlags&2064)!==0&&W!==null)W.return=R,Se=W;else e:for(R=V;Se!==null;){if(F=Se,(F.flags&2048)!==0)try{switch(F.tag){case 0:case 11:case 15:Sc(9,F)}}catch(Ae){vt(F,F.return,Ae)}if(F===R){Se=null;break e}var he=F.sibling;if(he!==null){he.return=F.return,Se=he;break e}Se=F.return}}if(Ke=S,bs(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(jl,o)}catch{}v=!0}return v}finally{Qe=p,Mn.transition=c}}return!1}function Ny(o,c,p){c=Zi(p,c),c=Zx(o,c,1),o=Es(o,c,1),c=an(),o!==null&&(Xa(o,1,c),gn(o,c))}function vt(o,c,p){if(o.tag===3)Ny(o,o,p);else for(;c!==null;){if(c.tag===3){Ny(c,o,p);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(_s===null||!_s.has(v))){o=Zi(p,o),o=Jx(c,o,1),c=Es(c,o,1),o=an(),c!==null&&(Xa(c,1,o),gn(c,o));break}}c=c.return}}function BA(o,c,p){var v=o.pingCache;v!==null&&v.delete(c),c=an(),o.pingedLanes|=o.suspendedLanes&p,Ft===o&&(Gt&p)===p&&(Rt===4||Rt===3&&(Gt&130023424)===Gt&&500>Tt()-Jf?ai(o,0):Zf|=p),gn(o,c)}function jy(o,c){c===0&&((o.mode&1)===0?c=1:(c=Ml,Ml<<=1,(Ml&130023424)===0&&(Ml=4194304)));var p=an();o=Kr(o,c),o!==null&&(Xa(o,c,p),gn(o,p))}function UA(o){var c=o.memoizedState,p=0;c!==null&&(p=c.retryLane),jy(o,p)}function $A(o,c){var p=0;switch(o.tag){case 13:var v=o.stateNode,S=o.memoizedState;S!==null&&(p=S.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(c),jy(o,p)}var Oy;Oy=function(o,c,p){if(o!==null)if(o.memoizedProps!==c.pendingProps||fn.current)mn=!0;else{if((o.lanes&p)===0&&(c.flags&128)===0)return mn=!1,AA(o,c,p);mn=(o.flags&131072)!==0}else mn=!1,ct&&(c.flags&1048576)!==0&&px(c,ic,c.index);switch(c.lanes=0,c.tag){case 2:var v=c.type;wc(o,c),o=c.pendingProps;var S=Hi(c,Qt.current);Qi(c,p),S=Lf(null,c,v,o,S,p);var k=Rf();return c.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,hn(v)?(k=!0,nc(c)):k=!1,c.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,Ef(c),S.updater=yc,c.stateNode=S,S._reactInternals=c,Mf(c,v,o,p),c=$f(null,c,v,!0,k,p)):(c.tag=0,ct&&k&&hf(c),sn(null,c,S,p),c=c.child),c;case 16:v=c.elementType;e:{switch(wc(o,c),o=c.pendingProps,S=v._init,v=S(v._payload),c.type=v,S=c.tag=GA(v),o=Zn(v,o),S){case 0:c=Uf(null,c,v,o,p);break e;case 1:c=ly(null,c,v,o,p);break e;case 11:c=ry(null,c,v,o,p);break e;case 14:c=sy(null,c,v,Zn(v.type,o),p);break e}throw Error(t(306,v,""))}return c;case 0:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:Zn(v,S),Uf(o,c,v,S,p);case 1:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:Zn(v,S),ly(o,c,v,S,p);case 3:e:{if(cy(c),o===null)throw Error(t(387));v=c.pendingProps,k=c.memoizedState,S=k.element,Tx(o,c),dc(c,v,null,p);var R=c.memoizedState;if(v=R.element,k.isDehydrated)if(k={element:v,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},c.updateQueue.baseState=k,c.memoizedState=k,c.flags&256){S=Zi(Error(t(423)),c),c=uy(o,c,v,p,S);break e}else if(v!==S){S=Zi(Error(t(424)),c),c=uy(o,c,v,p,S);break e}else for(kn=ys(c.stateNode.containerInfo.firstChild),_n=c,ct=!0,Xn=null,p=Sx(c,null,v,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Wi(),v===S){c=Wr(o,c,p);break e}sn(o,c,v,p)}c=c.child}return c;case 5:return Cx(c),o===null&&gf(c),v=c.type,S=c.pendingProps,k=o!==null?o.memoizedProps:null,R=S.children,of(v,S)?R=null:k!==null&&of(v,k)&&(c.flags|=32),oy(o,c),sn(o,c,R,p),c.child;case 6:return o===null&&gf(c),null;case 13:return dy(o,c,p);case 4:return Tf(c,c.stateNode.containerInfo),v=c.pendingProps,o===null?c.child=qi(c,null,v,p):sn(o,c,v,p),c.child;case 11:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:Zn(v,S),ry(o,c,v,S,p);case 7:return sn(o,c,c.pendingProps,p),c.child;case 8:return sn(o,c,c.pendingProps.children,p),c.child;case 12:return sn(o,c,c.pendingProps.children,p),c.child;case 10:e:{if(v=c.type._context,S=c.pendingProps,k=c.memoizedProps,R=S.value,st(lc,v._currentValue),v._currentValue=R,k!==null)if(Qn(k.value,R)){if(k.children===S.children&&!fn.current){c=Wr(o,c,p);break e}}else for(k=c.child,k!==null&&(k.return=c);k!==null;){var F=k.dependencies;if(F!==null){R=k.child;for(var U=F.firstContext;U!==null;){if(U.context===v){if(k.tag===1){U=zr(-1,p&-p),U.tag=2;var X=k.updateQueue;if(X!==null){X=X.shared;var ue=X.pending;ue===null?U.next=U:(U.next=ue.next,ue.next=U),X.pending=U}}k.lanes|=p,U=k.alternate,U!==null&&(U.lanes|=p),bf(k.return,p,c),F.lanes|=p;break}U=U.next}}else if(k.tag===10)R=k.type===c.type?null:k.child;else if(k.tag===18){if(R=k.return,R===null)throw Error(t(341));R.lanes|=p,F=R.alternate,F!==null&&(F.lanes|=p),bf(R,p,c),R=k.sibling}else R=k.child;if(R!==null)R.return=k;else for(R=k;R!==null;){if(R===c){R=null;break}if(k=R.sibling,k!==null){k.return=R.return,R=k;break}R=R.return}k=R}sn(o,c,S.children,p),c=c.child}return c;case 9:return S=c.type,v=c.pendingProps.children,Qi(c,p),S=jn(S),v=v(S),c.flags|=1,sn(o,c,v,p),c.child;case 14:return v=c.type,S=Zn(v,c.pendingProps),S=Zn(v.type,S),sy(o,c,v,S,p);case 15:return iy(o,c,c.type,c.pendingProps,p);case 17:return v=c.type,S=c.pendingProps,S=c.elementType===v?S:Zn(v,S),wc(o,c),c.tag=1,hn(v)?(o=!0,nc(c)):o=!1,Qi(c,p),Qx(c,v,S),Mf(c,v,S,p),$f(null,c,v,!0,o,p);case 19:return hy(o,c,p);case 22:return ay(o,c,p)}throw Error(t(156,c.tag))};function My(o,c){return gg(o,c)}function VA(o,c,p,v){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(o,c,p,v){return new VA(o,c,p,v)}function oh(o){return o=o.prototype,!(!o||!o.isReactComponent)}function GA(o){if(typeof o=="function")return oh(o)?1:0;if(o!=null){if(o=o.$$typeof,o===q)return 11;if(o===re)return 14}return 2}function Is(o,c){var p=o.alternate;return p===null?(p=Fn(o.tag,c,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=c,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&14680064,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,c=o.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p}function Rc(o,c,p,v,S,k){var R=2;if(v=o,typeof o=="function")oh(o)&&(R=1);else if(typeof o=="string")R=5;else e:switch(o){case P:return li(p.children,S,k,c);case O:R=8,S|=8;break;case M:return o=Fn(12,p,c,S|2),o.elementType=M,o.lanes=k,o;case ie:return o=Fn(13,p,c,S),o.elementType=ie,o.lanes=k,o;case te:return o=Fn(19,p,c,S),o.elementType=te,o.lanes=k,o;case Q:return Pc(p,S,k,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case D:R=10;break e;case B:R=9;break e;case q:R=11;break e;case re:R=14;break e;case ee:R=16,v=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return c=Fn(R,p,c,S),c.elementType=o,c.type=v,c.lanes=k,c}function li(o,c,p,v){return o=Fn(7,o,v,c),o.lanes=p,o}function Pc(o,c,p,v){return o=Fn(22,o,v,c),o.elementType=Q,o.lanes=p,o.stateNode={isHidden:!1},o}function lh(o,c,p){return o=Fn(6,o,null,c),o.lanes=p,o}function ch(o,c,p){return c=Fn(4,o.children!==null?o.children:[],o.key,c),c.lanes=p,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function HA(o,c,p,v,S){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jd(0),this.expirationTimes=jd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jd(0),this.identifierPrefix=v,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function uh(o,c,p,v,S,k,R,F,U){return o=new HA(o,c,p,F,U),c===1?(c=1,k===!0&&(c|=8)):c=0,k=Fn(3,null,null,c),o.current=k,k.stateNode=o,k.memoizedState={element:v,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ef(k),o}function KA(o,c,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:N,key:v==null?null:""+v,children:o,containerInfo:c,implementation:p}}function Fy(o){if(!o)return ws;o=o._reactInternals;e:{if(Qs(o)!==o||o.tag!==1)throw Error(t(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(hn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(o.tag===1){var p=o.type;if(hn(p))return fx(o,p,c)}return c}function By(o,c,p,v,S,k,R,F,U){return o=uh(p,v,!0,o,S,k,R,F,U),o.context=Fy(null),p=o.current,v=an(),S=Cs(p),k=zr(v,S),k.callback=c??null,Es(p,k,S),o.current.lanes=S,Xa(o,S,v),gn(o,v),o}function Dc(o,c,p,v){var S=c.current,k=an(),R=Cs(S);return p=Fy(p),c.context===null?c.context=p:c.pendingContext=p,c=zr(k,R),c.payload={element:o},v=v===void 0?null:v,v!==null&&(c.callback=v),o=Es(S,c,R),o!==null&&(tr(o,S,R,k),uc(o,S,R)),R}function Nc(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Uy(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<c?p:c}}function dh(o,c){Uy(o,c),(o=o.alternate)&&Uy(o,c)}function zA(){return null}var $y=typeof reportError=="function"?reportError:function(o){console.error(o)};function fh(o){this._internalRoot=o}jc.prototype.render=fh.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(t(409));Dc(o,c,null,null)},jc.prototype.unmount=fh.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;ii(function(){Dc(null,o,null,null)}),c[$r]=null}};function jc(o){this._internalRoot=o}jc.prototype.unstable_scheduleHydration=function(o){if(o){var c=Tg();o={blockedOn:null,target:o,priority:c};for(var p=0;p<ps.length&&c!==0&&c<ps[p].priority;p++);ps.splice(p,0,o),p===0&&Cg(o)}};function hh(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Oc(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function Vy(){}function WA(o,c,p,v,S){if(S){if(typeof v=="function"){var k=v;v=function(){var X=Nc(R);k.call(X)}}var R=By(c,v,o,0,null,!1,!1,"",Vy);return o._reactRootContainer=R,o[$r]=R.current,fo(o.nodeType===8?o.parentNode:o),ii(),R}for(;S=o.lastChild;)o.removeChild(S);if(typeof v=="function"){var F=v;v=function(){var X=Nc(U);F.call(X)}}var U=uh(o,0,!1,null,null,!1,!1,"",Vy);return o._reactRootContainer=U,o[$r]=U.current,fo(o.nodeType===8?o.parentNode:o),ii(function(){Dc(c,U,p,v)}),U}function Mc(o,c,p,v,S){var k=p._reactRootContainer;if(k){var R=k;if(typeof S=="function"){var F=S;S=function(){var U=Nc(R);F.call(U)}}Dc(c,R,o,S)}else R=WA(p,c,o,S,v);return Nc(R)}Sg=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var p=Qa(c.pendingLanes);p!==0&&(Od(c,p|1),gn(c,Tt()),(Ke&6)===0&&(ta=Tt()+500,bs()))}break;case 13:ii(function(){var v=Kr(o,1);if(v!==null){var S=an();tr(v,o,1,S)}}),dh(o,1)}},Md=function(o){if(o.tag===13){var c=Kr(o,134217728);if(c!==null){var p=an();tr(c,o,134217728,p)}dh(o,134217728)}},Eg=function(o){if(o.tag===13){var c=Cs(o),p=Kr(o,c);if(p!==null){var v=an();tr(p,o,c,v)}dh(o,c)}},Tg=function(){return Qe},_g=function(o,c){var p=Qe;try{return Qe=o,c()}finally{Qe=p}},Id=function(o,c,p){switch(c){case"input":if(Ue(o,p),c=p.name,p.type==="radio"&&c!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<p.length;c++){var v=p[c];if(v!==o&&v.form===o.form){var S=ec(v);if(!S)throw Error(t(90));We(v),Ue(v,S)}}}break;case"textarea":ls(o,p);break;case"select":c=p.value,c!=null&&nn(o,!!p.multiple,c,!1)}},cg=sh,ug=ii;var qA={usingClientEntryPoint:!1,Events:[po,Vi,ec,og,lg,sh]},Io={findFiberByHostInstance:Xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YA={bundleType:Io.bundleType,version:Io.version,rendererPackageName:Io.rendererPackageName,rendererConfig:Io.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=mg(o),o===null?null:o.stateNode},findFiberByHostInstance:Io.findFiberByHostInstance||zA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fc.isDisabled&&Fc.supportsFiber)try{jl=Fc.inject(YA),hr=Fc}catch{}}return xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qA,xn.createPortal=function(o,c){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hh(c))throw Error(t(200));return KA(o,c,null,p)},xn.createRoot=function(o,c){if(!hh(o))throw Error(t(299));var p=!1,v="",S=$y;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),c=uh(o,1,!1,null,null,p,!1,v,S),o[$r]=c.current,fo(o.nodeType===8?o.parentNode:o),new fh(c)},xn.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=mg(c),o=o===null?null:o.stateNode,o},xn.flushSync=function(o){return ii(o)},xn.hydrate=function(o,c,p){if(!Oc(c))throw Error(t(200));return Mc(null,o,c,!0,p)},xn.hydrateRoot=function(o,c,p){if(!hh(o))throw Error(t(405));var v=p!=null&&p.hydratedSources||null,S=!1,k="",R=$y;if(p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onRecoverableError!==void 0&&(R=p.onRecoverableError)),c=By(c,null,o,1,p??null,S,!1,k,R),o[$r]=c.current,fo(o),v)for(o=0;o<v.length;o++)p=v[o],S=p._getVersion,S=S(p._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[p,S]:c.mutableSourceEagerHydrationData.push(p,S);return new jc(c)},xn.render=function(o,c,p){if(!Oc(c))throw Error(t(200));return Mc(null,o,c,!1,p)},xn.unmountComponentAtNode=function(o){if(!Oc(o))throw Error(t(40));return o._reactRootContainer?(ii(function(){Mc(null,null,o,!1,function(){o._reactRootContainer=null,o[$r]=null})}),!0):!1},xn.unstable_batchedUpdates=sh,xn.unstable_renderSubtreeIntoContainer=function(o,c,p,v){if(!Oc(p))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return Mc(o,c,p,!1,v)},xn.version="18.3.1-next-f1338f8080-20240426",xn}var Qy;function $w(){if(Qy)return gh.exports;Qy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gh.exports=rI(),gh.exports}var Xy;function sI(){if(Xy)return Bc;Xy=1;var n=$w();return Bc.createRoot=n.createRoot,Bc.hydrateRoot=n.hydrateRoot,Bc}var iI=sI(),L=Rp();const Er=XA(L);/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Zy="popstate";function aI(n={}){function e(r,s){let{pathname:i,search:a,hash:l}=r.location;return Lm("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:el(s)}return lI(e,t,null,n)}function xt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ur(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oI(){return Math.random().toString(36).substring(2,10)}function Jy(n,e){return{usr:n.state,key:n.key,idx:e}}function Lm(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Fa(e):e,state:t,key:e&&e.key||r||oI()}}function el({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Fa(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function lI(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l="POP",u=null,d=f();d==null&&(d=0,a.replaceState({...a.state,idx:d},""));function f(){return(a.state||{idx:null}).idx}function m(){l="POP";let b=f(),E=b==null?null:b-d;d=b,u&&u({action:l,location:w.location,delta:E})}function g(b,E){l="PUSH";let T=Lm(w.location,b,E);d=f()+1;let _=Jy(T,d),A=w.createHref(T);try{a.pushState(_,"",A)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;s.location.assign(A)}i&&u&&u({action:l,location:w.location,delta:1})}function x(b,E){l="REPLACE";let T=Lm(w.location,b,E);d=f();let _=Jy(T,d),A=w.createHref(T);a.replaceState(_,"",A),i&&u&&u({action:l,location:w.location,delta:0})}function y(b){return cI(b)}let w={get action(){return l},get location(){return n(s,a)},listen(b){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Zy,m),u=b,()=>{s.removeEventListener(Zy,m),u=null}},createHref(b){return e(s,b)},createURL:y,encodeLocation(b){let E=y(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:x,go(b){return a.go(b)}};return w}function cI(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),xt(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:el(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Vw(n,e,t="/"){return uI(n,e,t,!1)}function uI(n,e,t,r){let s=typeof e=="string"?Fa(e):e,i=ts(s.pathname||"/",t);if(i==null)return null;let a=Gw(n);dI(a);let l=null;for(let u=0;l==null&&u<a.length;++u){let d=SI(i);l=wI(a[u],d,r)}return l}function Gw(n,e=[],t=[],r="",s=!1){let i=(a,l,u=s,d)=>{let f={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(r)&&u)return;xt(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length)}let m=Jr([r,f.relativePath]),g=t.concat(f);a.children&&a.children.length>0&&(xt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Gw(a.children,e,g,m,u)),!(a.path==null&&!a.index)&&e.push({path:m,score:yI(m,a.index),routesMeta:g})};return n.forEach((a,l)=>{if(a.path===""||!a.path?.includes("?"))i(a,l);else for(let u of Hw(a.path))i(a,l,!0,u)}),e}function Hw(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=Hw(r.join("/")),l=[];return l.push(...a.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...a),l.map(u=>n.startsWith("/")&&u===""?"/":u)}function dI(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:vI(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var fI=/^:[\w-]+$/,hI=3,mI=2,pI=1,gI=10,xI=-2,ev=n=>n==="*";function yI(n,e){let t=n.split("/"),r=t.length;return t.some(ev)&&(r+=xI),e&&(r+=mI),t.filter(s=>!ev(s)).reduce((s,i)=>s+(fI.test(i)?hI:i===""?pI:gI),r)}function vI(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function wI(n,e,t=!1){let{routesMeta:r}=n,s={},i="/",a=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=Cu({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),g=u.route;if(!m&&d&&t&&!r[r.length-1].route.index&&(m=Cu({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!m)return null;Object.assign(s,m.params),a.push({params:s,pathname:Jr([i,m.pathname]),pathnameBase:kI(Jr([i,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(i=Jr([i,m.pathnameBase]))}return a}function Cu(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=bI(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,{paramName:f,isOptional:m},g)=>{if(f==="*"){let y=l[g]||"";a=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const x=l[g];return m&&!x?d[f]=void 0:d[f]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:n}}function bI(n,e=!1,t=!0){ur(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function SI(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ur(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ts(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var Kw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,EI=n=>Kw.test(n);function TI(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Fa(n):n,i;if(t)if(EI(t))i=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),ur(!1,`Pathnames cannot have embedded double slashes - normalizing ${a} -> ${t}`)}t.startsWith("/")?i=tv(t.substring(1),"/"):i=tv(t,e)}else i=e;return{pathname:i,search:CI(r),hash:AI(s)}}function tv(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function vh(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _I(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function zw(n){let e=_I(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Ww(n,e,t,r=!1){let s;typeof n=="string"?s=Fa(n):(s={...n},xt(!s.pathname||!s.pathname.includes("?"),vh("?","pathname","search",s)),xt(!s.pathname||!s.pathname.includes("#"),vh("#","pathname","hash",s)),xt(!s.search||!s.search.includes("#"),vh("#","search","hash",s)));let i=n===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=t;else{let m=e.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}l=m>=0?e[m]:"/"}let u=TI(s,l),d=a&&a!=="/"&&a.endsWith("/"),f=(i||a===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}var Jr=n=>n.join("/").replace(/\/\/+/g,"/"),kI=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),CI=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,AI=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,II=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function LI(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function RI(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var qw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Yw(n,e){let t=n;if(typeof t!="string"||!Kw.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,s=!1;if(qw)try{let i=new URL(window.location.href),a=t.startsWith("//")?new URL(i.protocol+t):new URL(t),l=ts(a.pathname,e);a.origin===i.origin&&l!=null?t=l+a.search+a.hash:s=!0}catch{ur(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Qw=["POST","PUT","PATCH","DELETE"];new Set(Qw);var PI=["GET",...Qw];new Set(PI);var Ba=L.createContext(null);Ba.displayName="DataRouter";var od=L.createContext(null);od.displayName="DataRouterState";var DI=L.createContext(!1),Xw=L.createContext({isTransitioning:!1});Xw.displayName="ViewTransition";var NI=L.createContext(new Map);NI.displayName="Fetchers";var jI=L.createContext(null);jI.displayName="Await";var Kn=L.createContext(null);Kn.displayName="Navigation";var yl=L.createContext(null);yl.displayName="Location";var Pr=L.createContext({outlet:null,matches:[],isDataRoute:!1});Pr.displayName="Route";var Pp=L.createContext(null);Pp.displayName="RouteError";var Zw="REACT_ROUTER_ERROR",OI="REDIRECT",MI="ROUTE_ERROR_RESPONSE";function FI(n){if(n.startsWith(`${Zw}:${OI}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function BI(n){if(n.startsWith(`${Zw}:${MI}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new II(e.status,e.statusText,e.data)}catch{}}function UI(n,{relative:e}={}){xt(vl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=L.useContext(Kn),{hash:s,pathname:i,search:a}=wl(n,{relative:e}),l=i;return t!=="/"&&(l=i==="/"?t:Jr([t,i])),r.createHref({pathname:l,search:a,hash:s})}function vl(){return L.useContext(yl)!=null}function Ci(){return xt(vl(),"useLocation() may be used only in the context of a <Router> component."),L.useContext(yl).location}var Jw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eb(n){L.useContext(Kn).static||L.useLayoutEffect(n)}function Dr(){let{isDataRoute:n}=L.useContext(Pr);return n?eL():$I()}function $I(){xt(vl(),"useNavigate() may be used only in the context of a <Router> component.");let n=L.useContext(Ba),{basename:e,navigator:t}=L.useContext(Kn),{matches:r}=L.useContext(Pr),{pathname:s}=Ci(),i=JSON.stringify(zw(r)),a=L.useRef(!1);return eb(()=>{a.current=!0}),L.useCallback((u,d={})=>{if(ur(a.current,Jw),!a.current)return;if(typeof u=="number"){t.go(u);return}let f=Ww(u,JSON.parse(i),s,d.relative==="path");n==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Jr([e,f.pathname])),(d.replace?t.replace:t.push)(f,d.state,d)},[e,t,i,s,n])}L.createContext(null);function VI(){let{matches:n}=L.useContext(Pr),e=n[n.length-1];return e?e.params:{}}function wl(n,{relative:e}={}){let{matches:t}=L.useContext(Pr),{pathname:r}=Ci(),s=JSON.stringify(zw(t));return L.useMemo(()=>Ww(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function GI(n,e){return tb(n,e)}function tb(n,e,t,r,s){xt(vl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=L.useContext(Kn),{matches:a}=L.useContext(Pr),l=a[a.length-1],u=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",m=l&&l.route;{let T=m&&m.path||"";rb(d,!m||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let g=Ci(),x;if(e){let T=typeof e=="string"?Fa(e):e;xt(f==="/"||T.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${T.pathname}" was given in the \`location\` prop.`),x=T}else x=g;let y=x.pathname||"/",w=y;if(f!=="/"){let T=f.replace(/^\//,"").split("/");w="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let b=Vw(n,{pathname:w});ur(m||b!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),ur(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=qI(b&&b.map(T=>Object.assign({},T,{params:Object.assign({},u,T.params),pathname:Jr([f,i.encodeLocation?i.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?f:Jr([f,i.encodeLocation?i.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),a,t,r,s);return e&&E?L.createElement(yl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},E):E}function HI(){let n=JI(),e=LI(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",n),a=L.createElement(L.Fragment,null,L.createElement("p",null," Hey developer "),L.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",L.createElement("code",{style:i},"ErrorBoundary")," or"," ",L.createElement("code",{style:i},"errorElement")," prop on your route.")),L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),t?L.createElement("pre",{style:s},t):null,a)}var KI=L.createElement(HI,null),nb=class extends L.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=BI(n.digest);t&&(n=t)}let e=n!==void 0?L.createElement(Pr.Provider,{value:this.props.routeContext},L.createElement(Pp.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?L.createElement(zI,{error:n},e):e}};nb.contextType=DI;var wh=new WeakMap;function zI({children:n,error:e}){let{basename:t}=L.useContext(Kn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=FI(e.digest);if(r){let s=wh.get(e);if(s)throw s;let i=Yw(r.location,t);if(qw&&!wh.get(e))if(i.isExternal||r.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const a=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:r.replace}));throw wh.set(e,a),a}return L.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return n}function WI({routeContext:n,match:e,children:t}){let r=L.useContext(Ba);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),L.createElement(Pr.Provider,{value:n},t)}function qI(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,a=t?.errors;if(a!=null){let f=i.findIndex(m=>m.route.id&&a?.[m.route.id]!==void 0);xt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,u=-1;if(t)for(let f=0;f<i.length;f++){let m=i[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=f),m.route.id){let{loaderData:g,errors:x}=t,y=m.route.loader&&!g.hasOwnProperty(m.route.id)&&(!x||x[m.route.id]===void 0);if(m.route.lazy||y){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}let d=t&&r?(f,m)=>{r(f,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:RI(t.matches),errorInfo:m})}:void 0;return i.reduceRight((f,m,g)=>{let x,y=!1,w=null,b=null;t&&(x=a&&m.route.id?a[m.route.id]:void 0,w=m.route.errorElement||KI,l&&(u<0&&g===0?(rb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,b=null):u===g&&(y=!0,b=m.route.hydrateFallbackElement||null)));let E=e.concat(i.slice(0,g+1)),T=()=>{let _;return x?_=w:y?_=b:m.route.Component?_=L.createElement(m.route.Component,null):m.route.element?_=m.route.element:_=f,L.createElement(WI,{match:m,routeContext:{outlet:f,matches:E,isDataRoute:t!=null},children:_})};return t&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?L.createElement(nb,{location:t.location,revalidation:t.revalidation,component:w,error:x,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:d}):T()},null)}function Dp(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YI(n){let e=L.useContext(Ba);return xt(e,Dp(n)),e}function QI(n){let e=L.useContext(od);return xt(e,Dp(n)),e}function XI(n){let e=L.useContext(Pr);return xt(e,Dp(n)),e}function Np(n){let e=XI(n),t=e.matches[e.matches.length-1];return xt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function ZI(){return Np("useRouteId")}function JI(){let n=L.useContext(Pp),e=QI("useRouteError"),t=Np("useRouteError");return n!==void 0?n:e.errors?.[t]}function eL(){let{router:n}=YI("useNavigate"),e=Np("useNavigate"),t=L.useRef(!1);return eb(()=>{t.current=!0}),L.useCallback(async(s,i={})=>{ur(t.current,Jw),t.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:e,...i}))},[n,e])}var nv={};function rb(n,e,t){!e&&!nv[n]&&(nv[n]=!0,ur(!1,t))}L.memo(tL);function tL({routes:n,future:e,state:t,onError:r}){return tb(n,void 0,t,r,e)}function br(n){xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nL({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:i=!1,unstable_useTransitions:a}){xt(!vl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:l,navigator:s,static:i,unstable_useTransitions:a,future:{}}),[l,s,i,a]);typeof t=="string"&&(t=Fa(t));let{pathname:d="/",search:f="",hash:m="",state:g=null,key:x="default"}=t,y=L.useMemo(()=>{let w=ts(d,l);return w==null?null:{location:{pathname:w,search:f,hash:m,state:g,key:x},navigationType:r}},[l,d,f,m,g,x,r]);return ur(y!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:L.createElement(Kn.Provider,{value:u},L.createElement(yl.Provider,{children:e,value:y}))}function rL({children:n,location:e}){return GI(Rm(n),e)}function Rm(n,e=[]){let t=[];return L.Children.forEach(n,(r,s)=>{if(!L.isValidElement(r))return;let i=[...e,s];if(r.type===L.Fragment){t.push.apply(t,Rm(r.props.children,i));return}xt(r.type===br,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Rm(r.props.children,i)),t.push(a)}),t}var du="get",fu="application/x-www-form-urlencoded";function ld(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function sL(n){return ld(n)&&n.tagName.toLowerCase()==="button"}function iL(n){return ld(n)&&n.tagName.toLowerCase()==="form"}function aL(n){return ld(n)&&n.tagName.toLowerCase()==="input"}function oL(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function lL(n,e){return n.button===0&&(!e||e==="_self")&&!oL(n)}var Uc=null;function cL(){if(Uc===null)try{new FormData(document.createElement("form"),0),Uc=!1}catch{Uc=!0}return Uc}var uL=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bh(n){return n!=null&&!uL.has(n)?(ur(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${fu}"`),null):n}function dL(n,e){let t,r,s,i,a;if(iL(n)){let l=n.getAttribute("action");r=l?ts(l,e):null,t=n.getAttribute("method")||du,s=bh(n.getAttribute("enctype"))||fu,i=new FormData(n)}else if(sL(n)||aL(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||l.getAttribute("action");if(r=u?ts(u,e):null,t=n.getAttribute("formmethod")||l.getAttribute("method")||du,s=bh(n.getAttribute("formenctype"))||bh(l.getAttribute("enctype"))||fu,i=new FormData(l,n),!cL()){let{name:d,type:f,value:m}=n;if(f==="image"){let g=d?`${d}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else d&&i.append(d,m)}}else{if(ld(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=du,r=null,s=fu,a=n}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function jp(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function fL(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&ts(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function hL(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function mL(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function pL(n,e,t){let r=await Promise.all(n.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await hL(i,t);return a.links?a.links():[]}return[]}));return vL(r.flat(1).filter(mL).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function rv(n,e,t,r,s,i){let a=(u,d)=>t[d]?u.route.id!==t[d].route.id:!0,l=(u,d)=>t[d].pathname!==u.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==u.params["*"];return i==="assets"?e.filter((u,d)=>a(u,d)||l(u,d)):i==="data"?e.filter((u,d)=>{let f=r.routes[u.route.id];if(!f||!f.hasLoader)return!1;if(a(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let m=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function gL(n,e,{includeHydrateFallback:t}={}){return xL(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function xL(n){return[...new Set(n)]}function yL(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function vL(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let i=JSON.stringify(yL(s));return t.has(i)||(t.add(i),r.push({key:i,link:s})),r},[])}function sb(){let n=L.useContext(Ba);return jp(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function wL(){let n=L.useContext(od);return jp(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Op=L.createContext(void 0);Op.displayName="FrameworkContext";function ib(){let n=L.useContext(Op);return jp(n,"You must render this element inside a <HydratedRouter> element"),n}function bL(n,e){let t=L.useContext(Op),[r,s]=L.useState(!1),[i,a]=L.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:f,onTouchStart:m}=e,g=L.useRef(null);L.useEffect(()=>{if(n==="render"&&a(!0),n==="viewport"){let w=E=>{E.forEach(T=>{a(T.isIntersecting)})},b=new IntersectionObserver(w,{threshold:.5});return g.current&&b.observe(g.current),()=>{b.disconnect()}}},[n]),L.useEffect(()=>{if(r){let w=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(w)}}},[r]);let x=()=>{s(!0)},y=()=>{s(!1),a(!1)};return t?n!=="intent"?[i,g,{}]:[i,g,{onFocus:Ro(l,x),onBlur:Ro(u,y),onMouseEnter:Ro(d,x),onMouseLeave:Ro(f,y),onTouchStart:Ro(m,x)}]:[!1,g,{}]}function Ro(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function SL({page:n,...e}){let{router:t}=sb(),r=L.useMemo(()=>Vw(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?L.createElement(TL,{page:n,matches:r,...e}):null}function EL(n){let{manifest:e,routeModules:t}=ib(),[r,s]=L.useState([]);return L.useEffect(()=>{let i=!1;return pL(n,e,t).then(a=>{i||s(a)}),()=>{i=!0}},[n,e,t]),r}function TL({page:n,matches:e,...t}){let r=Ci(),{manifest:s,routeModules:i}=ib(),{basename:a}=sb(),{loaderData:l,matches:u}=wL(),d=L.useMemo(()=>rv(n,e,u,s,r,"data"),[n,e,u,s,r]),f=L.useMemo(()=>rv(n,e,u,s,r,"assets"),[n,e,u,s,r]),m=L.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,w=!1;if(e.forEach(E=>{let T=s.routes[E.route.id];!T||!T.hasLoader||(!d.some(_=>_.route.id===E.route.id)&&E.route.id in l&&i[E.route.id]?.shouldRevalidate||T.hasClientLoader?w=!0:y.add(E.route.id))}),y.size===0)return[];let b=fL(n,a,"data");return w&&y.size>0&&b.searchParams.set("_routes",e.filter(E=>y.has(E.route.id)).map(E=>E.route.id).join(",")),[b.pathname+b.search]},[a,l,r,s,d,e,n,i]),g=L.useMemo(()=>gL(f,s),[f,s]),x=EL(f);return L.createElement(L.Fragment,null,m.map(y=>L.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),g.map(y=>L.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),x.map(({key:y,link:w})=>L.createElement("link",{key:y,nonce:t.nonce,...w})))}function _L(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var kL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kL&&(window.__reactRouterVersion="7.11.0")}catch{}function CL({basename:n,children:e,unstable_useTransitions:t,window:r}){let s=L.useRef();s.current==null&&(s.current=aI({window:r,v5Compat:!0}));let i=s.current,[a,l]=L.useState({action:i.action,location:i.location}),u=L.useCallback(d=>{t===!1?l(d):L.startTransition(()=>l(d))},[t]);return L.useLayoutEffect(()=>i.listen(u),[i,u]),L.createElement(nL,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:i,unstable_useTransitions:t})}var ab=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ob=L.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:l,target:u,to:d,preventScrollReset:f,viewTransition:m,unstable_defaultShouldRevalidate:g,...x},y){let{basename:w,unstable_useTransitions:b}=L.useContext(Kn),E=typeof d=="string"&&ab.test(d),T=Yw(d,w);d=T.to;let _=UI(d,{relative:s}),[A,I,N]=bL(r,x),P=RL(d,{replace:a,state:l,target:u,preventScrollReset:f,relative:s,viewTransition:m,unstable_defaultShouldRevalidate:g,unstable_useTransitions:b});function O(D){e&&e(D),D.defaultPrevented||P(D)}let M=L.createElement("a",{...x,...N,href:T.absoluteURL||_,onClick:T.isExternal||i?e:O,ref:_L(y,I),target:u,"data-discover":!E&&t==="render"?"true":void 0});return A&&!E?L.createElement(L.Fragment,null,M,L.createElement(SL,{page:_})):M});ob.displayName="Link";var AL=L.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:l,children:u,...d},f){let m=wl(a,{relative:d.relative}),g=Ci(),x=L.useContext(od),{navigator:y,basename:w}=L.useContext(Kn),b=x!=null&&OL(m)&&l===!0,E=y.encodeLocation?y.encodeLocation(m).pathname:m.pathname,T=g.pathname,_=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;t||(T=T.toLowerCase(),_=_?_.toLowerCase():null,E=E.toLowerCase()),_&&w&&(_=ts(_,w)||_);const A=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let I=T===E||!s&&T.startsWith(E)&&T.charAt(A)==="/",N=_!=null&&(_===E||!s&&_.startsWith(E)&&_.charAt(E.length)==="/"),P={isActive:I,isPending:N,isTransitioning:b},O=I?e:void 0,M;typeof r=="function"?M=r(P):M=[r,I?"active":null,N?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let D=typeof i=="function"?i(P):i;return L.createElement(ob,{...d,"aria-current":O,className:M,ref:f,style:D,to:a,viewTransition:l},typeof u=="function"?u(P):u)});AL.displayName="NavLink";var IL=L.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:i,method:a=du,action:l,onSubmit:u,relative:d,preventScrollReset:f,viewTransition:m,unstable_defaultShouldRevalidate:g,...x},y)=>{let{unstable_useTransitions:w}=L.useContext(Kn),b=NL(),E=jL(l,{relative:d}),T=a.toLowerCase()==="get"?"get":"post",_=typeof l=="string"&&ab.test(l),A=I=>{if(u&&u(I),I.defaultPrevented)return;I.preventDefault();let N=I.nativeEvent.submitter,P=N?.getAttribute("formmethod")||a,O=()=>b(N||I.currentTarget,{fetcherKey:e,method:P,navigate:t,replace:s,state:i,relative:d,preventScrollReset:f,viewTransition:m,unstable_defaultShouldRevalidate:g});w&&t!==!1?L.startTransition(()=>O()):O()};return L.createElement("form",{ref:y,method:T,action:E,onSubmit:r?u:A,...x,"data-discover":!_&&n==="render"?"true":void 0})});IL.displayName="Form";function LL(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lb(n){let e=L.useContext(Ba);return xt(e,LL(n)),e}function RL(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:i,viewTransition:a,unstable_defaultShouldRevalidate:l,unstable_useTransitions:u}={}){let d=Dr(),f=Ci(),m=wl(n,{relative:i});return L.useCallback(g=>{if(lL(g,e)){g.preventDefault();let x=t!==void 0?t:el(f)===el(m),y=()=>d(n,{replace:x,state:r,preventScrollReset:s,relative:i,viewTransition:a,unstable_defaultShouldRevalidate:l});u?L.startTransition(()=>y()):y()}},[f,d,m,t,r,e,n,s,i,a,l,u])}var PL=0,DL=()=>`__${String(++PL)}__`;function NL(){let{router:n}=lb("useSubmit"),{basename:e}=L.useContext(Kn),t=ZI(),r=n.fetch,s=n.navigate;return L.useCallback(async(i,a={})=>{let{action:l,method:u,encType:d,formData:f,body:m}=dL(i,e);if(a.navigate===!1){let g=a.fetcherKey||DL();await r(g,t,a.action||l,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:f,body:m,formMethod:a.method||u,formEncType:a.encType||d,flushSync:a.flushSync})}else await s(a.action||l,{unstable_defaultShouldRevalidate:a.unstable_defaultShouldRevalidate,preventScrollReset:a.preventScrollReset,formData:f,body:m,formMethod:a.method||u,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,s,e,t])}function jL(n,{relative:e}={}){let{basename:t}=L.useContext(Kn),r=L.useContext(Pr);xt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...wl(n||".",{relative:e})},a=Ci();if(n==null){i.search=a.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(f=>f==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let f=l.toString();i.search=f?`?${f}`:""}}return(!n||n===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Jr([t,i.pathname])),el(i)}function OL(n,{relative:e}={}){let t=L.useContext(Xw);xt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=lb("useViewTransitionState"),s=wl(n,{relative:e});if(!t.isTransitioning)return!1;let i=ts(t.currentLocation.pathname,r)||t.currentLocation.pathname,a=ts(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Cu(s.pathname,a)!=null||Cu(s.pathname,i)!=null}var Mp=$w();const hi={p16308a80:"M14.9625 0H17.8763L11.5113 7.29329L19 17.2194H13.1371L8.54186 11.2005L3.28971 17.2194H0.373214L7.18064 9.41586L0 0.00135713H6.01214L10.1596 5.50186L14.9625 0ZM13.9379 15.4714H15.5529L5.13 1.65707H3.39829L13.9379 15.4714Z",p1e086000:"M5 3.5H19C19.3978 3.5 19.7792 3.65815 20.0605 3.93945C20.3419 4.22076 20.5 4.60218 20.5 5V19C20.5 19.3978 20.3419 19.7792 20.0605 20.0605C19.7792 20.3419 19.3978 20.5 19 20.5H5C4.60218 20.5 4.22076 20.3419 3.93945 20.0605C3.65815 19.7792 3.5 19.3978 3.5 19V5C3.5 4.60218 3.65815 4.22076 3.93945 3.93945C4.22076 3.65815 4.60218 3.5 5 3.5ZM5 19H8.76953V9.62988H5V19ZM15.2402 9.44043C14.6307 9.44043 13.9731 9.65806 13.4199 10.0322V9.62988H9.62988V19H13.4199V13.5703C13.4199 13.0719 13.8206 12.6702 14.3096 12.6699C14.5482 12.6699 14.7775 12.7648 14.9463 12.9336C15.1151 13.1024 15.21 13.3316 15.21 13.5703V19H19V13.2002C19 12.203 18.6036 11.2462 17.8984 10.541C17.1934 9.83611 16.2372 9.44049 15.2402 9.44043ZM6.87988 4.69043C6.2991 4.69046 5.74173 4.92038 5.33105 5.33105C4.92038 5.74173 4.69046 6.2991 4.69043 6.87988C4.69043 8.08984 5.67767 9.05951 6.87988 9.05957C7.45805 9.05957 8.01305 8.8307 8.42188 8.42188C8.8307 8.01305 9.05957 7.45805 9.05957 6.87988C9.05951 5.67767 8.08984 4.69043 6.87988 4.69043Z",p2c5f2300:"M7.8 2H16.2C19.4 2 22 4.6 22 7.8V16.2C22 17.7383 21.3889 19.2135 20.3012 20.3012C19.2135 21.3889 17.7383 22 16.2 22H7.8C4.6 22 2 19.4 2 16.2V7.8C2 6.26174 2.61107 4.78649 3.69878 3.69878C4.78649 2.61107 6.26174 2 7.8 2ZM7.6 4C6.64522 4 5.72955 4.37928 5.05442 5.05442C4.37928 5.72955 4 6.64522 4 7.6V16.4C4 18.39 5.61 20 7.6 20H16.4C17.3548 20 18.2705 19.6207 18.9456 18.9456C19.6207 18.2705 20 17.3548 20 16.4V7.6C20 5.61 18.39 4 16.4 4H7.6ZM17.25 5.5C17.5815 5.5 17.8995 5.6317 18.1339 5.86612C18.3683 6.10054 18.5 6.41848 18.5 6.75C18.5 7.08152 18.3683 7.39946 18.1339 7.63388C17.8995 7.8683 17.5815 8 17.25 8C16.9185 8 16.6005 7.8683 16.3661 7.63388C16.1317 7.39946 16 7.08152 16 6.75C16 6.41848 16.1317 6.10054 16.3661 5.86612C16.6005 5.6317 16.9185 5.5 17.25 5.5ZM12 7C13.3261 7 14.5979 7.52678 15.5355 8.46447C16.4732 9.40215 17 10.6739 17 12C17 13.3261 16.4732 14.5979 15.5355 15.5355C14.5979 16.4732 13.3261 17 12 17C10.6739 17 9.40215 16.4732 8.46447 15.5355C7.52678 14.5979 7 13.3261 7 12C7 10.6739 7.52678 9.40215 8.46447 8.46447C9.40215 7.52678 10.6739 7 12 7ZM12 9C11.2044 9 10.4413 9.31607 9.87868 9.87868C9.31607 10.4413 9 11.2044 9 12C9 12.7956 9.31607 13.5587 9.87868 14.1213C10.4413 14.6839 11.2044 15 12 15C12.7956 15 13.5587 14.6839 14.1213 14.1213C14.6839 13.5587 15 12.7956 15 12C15 11.2044 14.6839 10.4413 14.1213 9.87868C13.5587 9.31607 12.7956 9 12 9Z"};function cb(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=cb(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function J(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=cb(n))&&(r&&(r+=" "),r+=e);return r}const pe=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},ML=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=FL},FL=Number.MAX_SAFE_INTEGER||9007199254740991;let Ce=(function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n})({}),K=(function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n})({}),C=(function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n})({});var Ge={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ve={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class ra{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class BL{constructor(e,t,r,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ra(e),this.fast_=new ra(t),this.defaultTTFB_=s,this.ttfb_=new ra(e)}update(e,t){const{slow_:r,fast_:s,ttfb_:i}=this;r.halfLife!==e&&(this.slow_=new ra(e,r.getEstimate(),r.getTotalWeight())),s.halfLife!==t&&(this.fast_=new ra(t,s.getEstimate(),s.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new ra(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,s=e/1e3,i=r/s;this.fast_.sample(s,i),this.slow_.sample(s,i)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function UL(n,e,t){return(e=VL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function et(){return et=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},et.apply(null,arguments)}function sv(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Xe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sv(Object(t),!0).forEach(function(r){UL(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):sv(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function $L(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function VL(n){var e=$L(n,"string");return typeof e=="symbol"?e:e+""}class zn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=Ns,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}const Ns=function(){},GL={trace:Ns,debug:Ns,log:Ns,warn:Ns,info:Ns,error:Ns};function Pm(){return et({},GL)}function HL(n,e){const t=self.console[n];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${n}] >`):Ns}function iv(n,e,t){return e[n]?e[n].bind(e):HL(n,t)}const Dm=Pm();function KL(n,e,t){const r=Pm();if(typeof console=="object"&&n===!0||typeof n=="object"){const s=["debug","log","info","warn","error"];s.forEach(i=>{r[i]=iv(i,n,t)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Pm()}s.forEach(i=>{Dm[i]=iv(i,n)})}else et(Dm,r);return r}const Ze=Dm;function $s(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function zL(n){return typeof self<"u"&&n===self.ManagedMediaSource}function ub(n,e){const t=Object.keys(n),r=Object.keys(e),s=t.length,i=r.length;return!s||!i||s===i&&!t.some(a=>r.indexOf(a)===-1)}function Pn(n,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(n);if(e){const f=d.indexOf("\0");return f!==-1?d.substring(0,f):d}return d.replace(/\0/g,"")}const t=n.length;let r,s,i,a="",l=0;for(;l<t;){if(r=n[l++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:s=n[l++],a+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[l++],i=n[l++],a+=String.fromCharCode((r&15)<<12|(s&63)<<6|(i&63)<<0);break}}return a}function zt(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function db(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function WL(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Sh={exports:{}},av;function qL(){return av||(av=1,(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(u,d,f){if(f=f||{},u=u.trim(),d=d.trim(),!d){if(!f.alwaysNormalize)return u;var m=l.parseURL(u);if(!m)throw new Error("Error trying to parse base URL.");return m.path=l.normalizePath(m.path),l.buildURLFromParts(m)}var g=l.parseURL(d);if(!g)throw new Error("Error trying to parse relative URL.");if(g.scheme)return f.alwaysNormalize?(g.path=l.normalizePath(g.path),l.buildURLFromParts(g)):d;var x=l.parseURL(u);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var y=s.exec(x.path);x.netLoc=y[1],x.path=y[2]}x.netLoc&&!x.path&&(x.path="/");var w={scheme:x.scheme,netLoc:g.netLoc,path:null,params:g.params,query:g.query,fragment:g.fragment};if(!g.netLoc&&(w.netLoc=x.netLoc,g.path[0]!=="/"))if(!g.path)w.path=x.path,g.params||(w.params=x.params,g.query||(w.query=x.query));else{var b=x.path,E=b.substring(0,b.lastIndexOf("/")+1)+g.path;w.path=l.normalizePath(E)}return w.path===null&&(w.path=f.alwaysNormalize?l.normalizePath(g.path):g.path),l.buildURLFromParts(w)},parseURL:function(u){var d=r.exec(u);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(i,"");u.length!==(u=u.replace(a,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};n.exports=l})()})(Sh)),Sh.exports}var Fp=qL();class Bp{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var nt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class fb{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,QL(this,"stats")}setByteRange(e,t){const r=e.split("@",2);let s;r.length===1?s=t?.byteRangeEndOffset||0:s=parseInt(r[1]),this._byteRange=[s,parseInt(r[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[nt.AUDIO]:null,[nt.VIDEO]:null,[nt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Bp),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Fp.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[nt.AUDIO]=null,e[nt.VIDEO]=null,e[nt.AUDIOVIDEO]=null}}function kt(n){return n.sn!=="initSegment"}class Eh extends fb{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(pe(e)&&pe(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const r=Object.keys(t);if(r.length===1){const s=this._decryptdata=t[r[0]]||null;s&&(this._decryptdata=s.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=pe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const r=Object.keys(this.levelkeys),s=r.length;if(s>1||s===1&&(t=this.levelkeys[r[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!pe(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return kt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var r;const s=t[e];s&&!((r=this._decryptdata)!=null&&r.keyId)&&(this._decryptdata=s.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,s,i,a=!1){const{elementaryStreams:l}=this,u=l[e];if(!u){l[e]={startPTS:t,endPTS:r,startDTS:s,endDTS:i,partial:a};return}u.startPTS=Math.min(u.startPTS,t),u.endPTS=Math.max(u.endPTS,r),u.startDTS=Math.min(u.startDTS,s),u.endDTS=Math.max(u.endDTS,i)}}class YL extends fb{constructor(e,t,r,s,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function hb(n,e){const t=Object.getPrototypeOf(n);if(t){const r=Object.getOwnPropertyDescriptor(t,e);return r||hb(t,e)}}function QL(n,e){const t=hb(n,e);t&&(t.enumerable=!0,Object.defineProperty(n,e,t))}const ov=Math.pow(2,32)-1,XL=[].push,mb={video:1,audio:2,id3:3,text:4};function Dt(n){return String.fromCharCode.apply(null,n)}function pb(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Oe(n,e){const t=gb(n,e);return t<0?4294967296+t:t}function lv(n,e){let t=Oe(n,e);return t*=Math.pow(2,32),t+=Oe(n,e+4),t}function gb(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function ZL(n){const e=n.byteLength;for(let t=0;t<e;){const r=Oe(n,t);if(r>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=r>1?t+r:e}return!1}function $e(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let s=0;s<r;){const i=Oe(n,s),a=Dt(n.subarray(s+4,s+8)),l=i>1?s+i:r;if(a===e[0])if(e.length===1)t.push(n.subarray(s+8,l));else{const u=$e(n.subarray(s+8,l),e.slice(1));u.length&&XL.apply(t,u)}s=l}return t}function JL(n){const e=[],t=n[0];let r=8;const s=Oe(n,r);r+=4;let i=0,a=0;t===0?(i=Oe(n,r),a=Oe(n,r+4),r+=8):(i=lv(n,r),a=lv(n,r+8),r+=16),r+=2;let l=n.length+a;const u=pb(n,r);r+=2;for(let d=0;d<u;d++){let f=r;const m=Oe(n,f);f+=4;const g=m&2147483647;if((m&2147483648)>>>31===1)return Ze.warn("SIDX has hierarchical references (not supported)"),null;const y=Oe(n,f);f+=4,e.push({referenceSize:g,subsegmentDuration:y,info:{duration:y/s,start:l,end:l+g-1}}),l+=g,f+=4,r=f}return{earliestPresentationTime:i,timescale:s,version:t,referencesCount:u,references:e}}function xb(n){const e=[],t=$e(n,["moov","trak"]);for(let s=0;s<t.length;s++){const i=t[s],a=$e(i,["tkhd"])[0];if(a){let l=a[0];const u=Oe(a,l===0?12:20),d=$e(i,["mdia","mdhd"])[0];if(d){l=d[0];const f=Oe(d,l===0?12:20),m=$e(i,["mdia","hdlr"])[0];if(m){const g=Dt(m.subarray(8,12)),x={soun:nt.AUDIO,vide:nt.VIDEO}[g],y=$e(i,["mdia","minf","stbl","stsd"])[0],w=eR(y);x?(e[u]={timescale:f,type:x,stsd:w},e[x]=Xe({timescale:f,id:u},w)):e[u]={timescale:f,type:g,stsd:w}}}}}return $e(n,["moov","mvex","trex"]).forEach(s=>{const i=Oe(s,4),a=e[i];a&&(a.default={duration:Oe(s,12),flags:Oe(s,20)})}),e}function eR(n){const e=n.subarray(8),t=e.subarray(86),r=Dt(e.subarray(4,8));let s=r,i;const a=r==="enca"||r==="encv";if(a){const d=$e(e,[r])[0].subarray(r==="enca"?28:78);$e(d,["sinf"]).forEach(m=>{const g=$e(m,["schm"])[0];if(g){const x=Dt(g.subarray(4,8));if(x==="cbcs"||x==="cenc"){const y=$e(m,["frma"])[0];y&&(s=Dt(y))}}})}const l=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const u=$e(t,["avcC"])[0];u&&u.length>3&&(s+="."+Vc(u[1])+Vc(u[2])+Vc(u[3]),i=$c(l==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const u=$e(e,[r])[0],d=$e(u.subarray(28),["esds"])[0];if(d&&d.length>7){let f=4;if(d[f++]!==3)break;f=Th(d,f),f+=2;const m=d[f++];if(m&128&&(f+=2),m&64&&(f+=d[f++]),d[f++]!==4)break;f=Th(d,f);const g=d[f++];if(g===64)s+="."+Vc(g);else break;if(f+=12,d[f++]!==5)break;f=Th(d,f);const x=d[f++];let y=(x&248)>>3;y===31&&(y+=1+((x&7)<<3)+((d[f]&224)>>5)),s+="."+y}break}case"hvc1":case"hev1":{const u=$e(t,["hvcC"])[0];if(u&&u.length>12){const d=u[1],f=["","A","B","C"][d>>6],m=d&31,g=Oe(u,2),x=(d&32)>>5?"H":"L",y=u[12],w=u.subarray(6,12);s+="."+f+m,s+="."+tR(g).toString(16).toUpperCase(),s+="."+x+y;let b="";for(let E=w.length;E--;){const T=w[E];(T||b)&&(b="."+T.toString(16).toUpperCase()+b)}s+=b}i=$c(l=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=$c(s,t)||s;break}case"vp09":{const u=$e(t,["vpcC"])[0];if(u&&u.length>6){const d=u[4],f=u[5],m=u[6]>>4&15;s+="."+Sr(d)+"."+Sr(f)+"."+Sr(m)}break}case"av01":{const u=$e(t,["av1C"])[0];if(u&&u.length>2){const d=u[1]>>>5,f=u[1]&31,m=u[2]>>>7?"H":"M",g=(u[2]&64)>>6,x=(u[2]&32)>>5,y=d===2&&g?x?12:10:g?10:8,w=(u[2]&16)>>4,b=(u[2]&8)>>3,E=(u[2]&4)>>2,T=u[2]&3;s+="."+d+"."+Sr(f)+m+"."+Sr(y)+"."+w+"."+b+E+T+"."+Sr(1)+"."+Sr(1)+"."+Sr(1)+"."+0,i=$c("dav1",t)}break}}return{codec:s,encrypted:a,supplemental:i}}function $c(n,e){const t=$e(e,["dvvC"]),r=t.length?t[0]:$e(e,["dvcC"])[0];if(r){const s=r[2]>>1&127,i=r[2]<<5&32|r[3]>>3&31;return n+"."+Sr(s)+"."+Sr(i)}}function tR(n){let e=0;for(let t=0;t<32;t++)e|=(n>>t&1)<<31-t;return e>>>0}function Th(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function Vc(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function Sr(n){return(n<10?"0":"")+n}function nR(n,e){if(!n||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&yb(n,(r,s)=>{const i=r.subarray(8,24);i.some(a=>a!==0)||(Ze.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${zt(i)} -> ${zt(t)}`),r.set(t,8))})}function rR(n){const e=[];return yb(n,t=>e.push(t.subarray(8,24))),e}function yb(n,e){$e(n,["moov","trak"]).forEach(r=>{const s=$e(r,["mdia","minf","stbl","stsd"])[0];if(!s)return;const i=s.subarray(8);let a=$e(i,["enca"]);const l=a.length>0;l||(a=$e(i,["encv"])),a.forEach(u=>{const d=l?u.subarray(28):u.subarray(78);$e(d,["sinf"]).forEach(m=>{const g=vb(m);g&&e(g,l)})})})}function vb(n){const e=$e(n,["schm"])[0];if(e){const t=Dt(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const r=$e(n,["schi","tenc"])[0];if(r)return r}}}function sR(n,e,t){const r={},s=$e(n,["moof","traf"]);for(let i=0;i<s.length;i++){const a=s[i],l=$e(a,["tfhd"])[0],u=Oe(l,4),d=e[u];if(!d)continue;r[u]||(r[u]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const f=r[u],m=$e(a,["tfdt"])[0];if(m){const _=m[0];let A=Oe(m,4);_===1&&(A===ov?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(A*=ov+1,A+=Oe(m,8))),pe(A)&&(!pe(f.start)||A<f.start)&&(f.start=A)}const g=d.default,x=Oe(l,0)|g?.flags;let y=g?.duration||0;x&8&&(x&2?y=Oe(l,12):y=Oe(l,8));const w=$e(a,["trun"]);let b=f.start||0,E=0,T=y;for(let _=0;_<w.length;_++){const A=w[_],I=Oe(A,4),N=f.sampleCount;f.sampleCount+=I;const P=A[3]&1,O=A[3]&4,M=A[2]&1,D=A[2]&2,B=A[2]&4,q=A[2]&8;let ie=8,te=I;for(P&&(ie+=4),O&&I&&(!(A[ie+1]&1)&&f.keyFrameIndex===void 0&&(f.keyFrameIndex=N),ie+=4,M?(T=Oe(A,ie),ie+=4):T=y,D&&(ie+=4),q&&(ie+=4),b+=T,E+=T,te--);te--;)M?(T=Oe(A,ie),ie+=4):T=y,D&&(ie+=4),B&&(A[ie+1]&1||f.keyFrameIndex===void 0&&(f.keyFrameIndex=f.sampleCount-(te+1),f.keyFrameStart=b),ie+=4),q&&(ie+=4),b+=T,E+=T;!E&&y&&(E+=y*I)}f.duration+=E}if(!Object.keys(r).some(i=>r[i].duration)){let i=1/0,a=0;const l=$e(n,["sidx"]);for(let u=0;u<l.length;u++){const d=JL(l[u]);if(d!=null&&d.references){i=Math.min(i,d.earliestPresentationTime/d.timescale);const f=d.references.reduce((m,g)=>m+g.info.duration||0,0);a=Math.max(a,f+d.earliestPresentationTime/d.timescale)}}a&&pe(a)&&Object.keys(r).forEach(u=>{r[u].duration||(r[u].duration=a*r[u].timescale-r[u].start)})}return r}function iR(n){const e={valid:null,remainder:null},t=$e(n,["moof"]);if(t.length<2)return e.remainder=n,e;const r=t[t.length-1];return e.valid=n.slice(0,r.byteOffset-8),e.remainder=n.slice(r.byteOffset-8),e}function Hn(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function cv(n,e){const t=[],r=e.samples,s=e.timescale,i=e.id;let a=!1;return $e(r,["moof"]).map(u=>{const d=u.byteOffset-8;$e(u,["traf"]).map(m=>{const g=$e(m,["tfdt"]).map(x=>{const y=x[0];let w=Oe(x,4);return y===1&&(w*=Math.pow(2,32),w+=Oe(x,8)),w/s})[0];return g!==void 0&&(n=g),$e(m,["tfhd"]).map(x=>{const y=Oe(x,4),w=Oe(x,0)&16777215,b=(w&1)!==0,E=(w&2)!==0,T=(w&8)!==0;let _=0;const A=(w&16)!==0;let I=0;const N=(w&32)!==0;let P=8;y===i&&(b&&(P+=8),E&&(P+=4),T&&(_=Oe(x,P),P+=4),A&&(I=Oe(x,P),P+=4),N&&(P+=4),e.type==="video"&&(a=cd(e.codec)),$e(m,["trun"]).map(O=>{const M=O[0],D=Oe(O,0)&16777215,B=(D&1)!==0;let q=0;const ie=(D&4)!==0,te=(D&256)!==0;let re=0;const ee=(D&512)!==0;let Q=0;const G=(D&1024)!==0,Y=(D&2048)!==0;let Z=0;const j=Oe(O,4);let $=8;B&&(q=Oe(O,$),$+=4),ie&&($+=4);let fe=q+d;for(let ne=0;ne<j;ne++){if(te?(re=Oe(O,$),$+=4):re=_,ee?(Q=Oe(O,$),$+=4):Q=I,G&&($+=4),Y&&(M===0?Z=Oe(O,$):Z=gb(O,$),$+=4),e.type===nt.VIDEO){let ae=0;for(;ae<Q;){const ce=Oe(r,fe);if(fe+=4,aR(a,r[fe])){const _e=r.subarray(fe,fe+ce);Up(_e,a?2:1,n+Z/s,t)}fe+=ce,ae+=ce+4}}n+=re/s}}))})})}),t}function cd(n){if(!n)return!1;const e=n.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function aR(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Up(n,e,t,r){const s=wb(n);let i=0;i+=e;let a=0,l=0,u=0;for(;i<s.length;){a=0;do{if(i>=s.length)break;u=s[i++],a+=u}while(u===255);l=0;do{if(i>=s.length)break;u=s[i++],l+=u}while(u===255);const d=s.length-i;let f=i;if(l<d)i+=l;else if(l>d){Ze.error(`Malformed SEI payload. ${l} is too small, only ${d} bytes left to parse.`);break}if(a===4){if(s[f++]===181){const g=pb(s,f);if(f+=2,g===49){const x=Oe(s,f);if(f+=4,x===1195456820){const y=s[f++];if(y===3){const w=s[f++],b=31&w,E=64&w,T=E?2+b*3:0,_=new Uint8Array(T);if(E){_[0]=w;for(let A=1;A<T;A++)_[A]=s[f++]}r.push({type:y,payloadType:a,pts:t,bytes:_})}}}}}else if(a===5&&l>16){const m=[];for(let y=0;y<16;y++){const w=s[f++].toString(16);m.push(w.length==1?"0"+w:w),(y===3||y===5||y===7||y===9)&&m.push("-")}const g=l-16,x=new Uint8Array(g);for(let y=0;y<g;y++)x[y]=s[f++];r.push({payloadType:a,pts:t,uuid:m.join(""),userData:Pn(x),userDataBytes:x})}}}function wb(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const s=e-t.length,i=new Uint8Array(s);let a=0;for(r=0;r<s;a++,r++)a===t[0]&&(a++,t.shift()),i[r]=n[a];return i}function oR(n){const e=n[0];let t="",r="",s=0,i=0,a=0,l=0,u=0,d=0;if(e===0){for(;Dt(n.subarray(d,d+1))!=="\0";)t+=Dt(n.subarray(d,d+1)),d+=1;for(t+=Dt(n.subarray(d,d+1)),d+=1;Dt(n.subarray(d,d+1))!=="\0";)r+=Dt(n.subarray(d,d+1)),d+=1;r+=Dt(n.subarray(d,d+1)),d+=1,s=Oe(n,12),i=Oe(n,16),l=Oe(n,20),u=Oe(n,24),d=28}else if(e===1){d+=4,s=Oe(n,d),d+=4;const m=Oe(n,d);d+=4;const g=Oe(n,d);for(d+=4,a=2**32*m+g,ML(a)||(a=Number.MAX_SAFE_INTEGER,Ze.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=Oe(n,d),d+=4,u=Oe(n,d),d+=4;Dt(n.subarray(d,d+1))!=="\0";)t+=Dt(n.subarray(d,d+1)),d+=1;for(t+=Dt(n.subarray(d,d+1)),d+=1;Dt(n.subarray(d,d+1))!=="\0";)r+=Dt(n.subarray(d,d+1)),d+=1;r+=Dt(n.subarray(d,d+1)),d+=1}const f=n.subarray(d,n.byteLength);return{schemeIdUri:t,value:r,timeScale:s,presentationTime:a,presentationTimeDelta:i,eventDuration:l,id:u,payload:f}}function lR(n,...e){const t=e.length;let r=8,s=t;for(;s--;)r+=e[s].byteLength;const i=new Uint8Array(r);for(i[0]=r>>24&255,i[1]=r>>16&255,i[2]=r>>8&255,i[3]=r&255,i.set(n,4),s=0,r=8;s<t;s++)i.set(e[s],r),r+=e[s].byteLength;return i}function cR(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,s;r=0,s=new Uint8Array;let i;r>0?(i=new Uint8Array(4),e.length>0&&new DataView(i.buffer).setUint32(0,e.length,!1)):i=new Uint8Array;const a=new Uint8Array(4);return t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),lR([112,115,115,104],new Uint8Array([r,0,0,0]),n,i,s,a,t)}function uR(n){const e=[];if(n instanceof ArrayBuffer){const t=n.byteLength;let r=0;for(;r+32<t;){const s=new DataView(n,r),i=dR(s);e.push(i),r+=i.size}}return e}function dR(n){const e=n.getUint32(0),t=n.byteOffset,r=n.byteLength;if(r<e)return{offset:t,size:r};if(n.getUint32(4)!==1886614376)return{offset:t,size:e};const i=n.getUint32(8)>>>24;if(i!==0&&i!==1)return{offset:t,size:e};const a=n.buffer,l=zt(new Uint8Array(a,t+12,16));let u=null,d=null,f=0;if(i===0)f=28;else{const g=n.getUint32(28);if(!g||r<32+g*16)return{offset:t,size:e};u=[];for(let x=0;x<g;x++)u.push(new Uint8Array(a,t+32+x*16,16));f=32+g*16}if(!f)return{offset:t,size:e};const m=n.getUint32(f);return e-32<m?{offset:t,size:e}:(d=new Uint8Array(a,t+f+4,m),{version:i,systemId:l,kids:u,data:d,offset:t,size:e})}const bb=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),ka={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function $p(n,e){const t=ka[e];return!!t&&!!t[n.slice(0,4)]}function tl(n,e,t=!0){return!n.split(",").some(r=>!Vp(r,e,t))}function Vp(n,e,t=!0){var r;const s=$s(t);return(r=s?.isTypeSupported(nl(n,e)))!=null?r:!1}function nl(n,e){return`${e}/mp4;codecs=${n}`}function uv(n){if(n){const e=n.substring(0,4);return ka.video[e]}return 2}function Au(n){const e=bb();return n.split(",").reduce((t,r)=>{const i=e&&cd(r)?9:ka.video[r];return i?(i*2+t)/(t?3:2):(ka.audio[r]+t)/(t?2:1)},0)}const _h={};function fR(n,e=!0){if(_h[n])return _h[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let s=0;s<t.length;s++){var r;if(Vp(t[s],"audio",e))return _h[n]=t[s],t[s];if(t[s]==="mp3"&&(r=$s(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return n}const hR=/flac|opus|mp4a\.40\.34/i;function Iu(n,e=!0){return n.replace(hR,t=>fR(t.toLowerCase(),e))}function mR(n,e){const t=[];if(n){const r=n.split(",");for(let s=0;s<r.length;s++)$p(r[s],"video")||t.push(r[s])}return e&&t.push(e),t.join(",")}function hu(n,e){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1)&&(dv(n,"audio")||dv(n,"video")))return n;if(e){const t=e.split(",");if(t.length>1){if(n){for(let r=t.length;r--;)if(t[r].substring(0,4)===n.substring(0,4))return t[r]}return t[0]}}return e||n}function dv(n,e){return $p(n,e)&&Vp(n,e)}function pR(n){const e=n.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&r[0]==="avc1"&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function gR(n){if(n.startsWith("av01.")){const e=n.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return n}function fv(n){const e=$s(n)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Nm(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const xR={supported:!0,powerEfficient:!0,smooth:!0},yR={supported:!1,smooth:!1,powerEfficient:!1},Sb={supported:!0,configurations:[],decodingInfoResults:[xR]};function Eb(n,e){return{supported:!1,configurations:e,decodingInfoResults:[yR],error:n}}function vR(n,e,t,r,s,i){const a=n.videoCodec,l=n.audioCodec?n.audioGroups:null,u=i?.audioCodec,d=i?.channels,f=d?parseInt(d):u?1/0:2;let m=null;if(l!=null&&l.length)try{l.length===1&&l[0]?m=e.groups[l[0]].channels:m=l.reduce((g,x)=>{if(x){const y=e.groups[x];if(!y)throw new Error(`Audio track group ${x} not found`);Object.keys(y.channels).forEach(w=>{g[w]=(g[w]||0)+y.channels[w]})}return g},{2:0})}catch{return!0}return a!==void 0&&(a.split(",").some(g=>cd(g))||n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(r,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(s,8e6))||!!m&&pe(f)&&Object.keys(m).some(g=>parseInt(g)>f)}function Tb(n,e,t,r={}){const s=n.videoCodec;if(!s&&!n.audioCodec||!t)return Promise.resolve(Sb);const i=[],a=wR(n),l=a.length,u=bR(n,e,l>0),d=u.length;for(let f=l||1*d||1;f--;){const m={type:"media-source"};if(l&&(m.video=a[f%l]),d){m.audio=u[f%d];const g=m.audio.bitrate;m.video&&g&&(m.video.bitrate-=g)}i.push(m)}if(s){const f=navigator.userAgent;if(s.split(",").some(m=>cd(m))&&bb())return Promise.resolve(Eb(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${f})`),i))}return Promise.all(i.map(f=>{const m=ER(f);return r[m]||(r[m]=t.decodingInfo(f))})).then(f=>({supported:!f.some(m=>!m.supported),configurations:i,decodingInfoResults:f})).catch(f=>({supported:!1,configurations:i,decodingInfoResults:[],error:f}))}function wR(n){var e;const t=(e=n.videoCodec)==null?void 0:e.split(","),r=_b(n),s=n.width||640,i=n.height||480,a=n.frameRate||30,l=n.videoRange.toLowerCase();return t?t.map(u=>{const d={contentType:nl(gR(u),"video"),width:s,height:i,bitrate:r,framerate:a};return l!=="sdr"&&(d.transferFunction=l),d}):[]}function bR(n,e,t){var r;const s=(r=n.audioCodec)==null?void 0:r.split(","),i=_b(n);return s&&n.audioGroups?n.audioGroups.reduce((a,l)=>{var u;const d=l?(u=e.groups[l])==null?void 0:u.tracks:null;return d?d.reduce((f,m)=>{if(m.groupId===l){const g=parseFloat(m.channels||"");s.forEach(x=>{const y={contentType:nl(x,"audio"),bitrate:t?SR(x,i):i};g&&(y.channels=""+g),f.push(y)})}return f},a):a},[]):[]}function SR(n,e){if(e<=1)return 1;let t=128e3;return n==="ec-3"?t=768e3:n==="ac-3"&&(t=64e4),Math.min(e/2,t)}function _b(n){return Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)/1e3)*1e3||1}function ER(n){let e="";const{audio:t,video:r}=n;if(r){const s=Nm(r.contentType);e+=`${s}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(t){const s=Nm(t.contentType);e+=`${r?"_":""}${s}_c${t.channels}`}return e}const jm=["NONE","TYPE-0","TYPE-1",null];function TR(n){return jm.indexOf(n)>-1}const Lu=["SDR","PQ","HLG"];function _R(n){return!!n&&Lu.indexOf(n)>-1}var mu={No:"",Yes:"YES",v2:"v2"};function hv(n){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=n,s=r<e/2;return e&&s?t?mu.v2:mu.Yes:mu.No}class mv{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class rl{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return pv(this._audioGroups,e)}hasSubtitleGroup(e){return pv(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function pv(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function kR(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function CR(n,e){let t=!1,r=[];if(n&&(t=n!=="SDR",r=[n]),e){r=e.allowedVideoRanges||Lu.slice(0);const s=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:s&&kR(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const AR=n=>{const e=new WeakSet;return(t,r)=>{if(n&&(r=n(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},rt=(n,e)=>JSON.stringify(n,AR(e));function IR(n,e,t,r,s){const i=Object.keys(n),a=r?.channels,l=r?.audioCodec,u=s?.videoCodec,d=a&&parseInt(a)===2;let f=!1,m=!1,g=1/0,x=1/0,y=1/0,w=1/0,b=0,E=[];const{preferHDR:T,allowedVideoRanges:_}=CR(e,s);for(let O=i.length;O--;){const M=n[i[O]];f||(f=M.channels[2]>0),g=Math.min(g,M.minHeight),x=Math.min(x,M.minFramerate),y=Math.min(y,M.minBitrate),_.filter(B=>M.videoRanges[B]>0).length>0&&(m=!0)}g=pe(g)?g:0,x=pe(x)?x:0;const A=Math.max(1080,g),I=Math.max(30,x);y=pe(y)?y:t,t=Math.max(y,t),m||(e=void 0);const N=i.length>1;return{codecSet:i.reduce((O,M)=>{const D=n[M];if(M===O)return O;if(E=m?_.filter(B=>D.videoRanges[B]>0):[],N){if(D.minBitrate>t)return yr(M,`min bitrate of ${D.minBitrate} > current estimate of ${t}`),O;if(!D.hasDefaultAudio)return yr(M,"no renditions with default or auto-select sound found"),O;if(l&&M.indexOf(l.substring(0,4))%5!==0)return yr(M,`audio codec preference "${l}" not found`),O;if(a&&!d){if(!D.channels[a])return yr(M,`no renditions with ${a} channel sound found (channels options: ${Object.keys(D.channels)})`),O}else if((!l||d)&&f&&D.channels[2]===0)return yr(M,"no renditions with stereo sound found"),O;if(D.minHeight>A)return yr(M,`min resolution of ${D.minHeight} > maximum of ${A}`),O;if(D.minFramerate>I)return yr(M,`min framerate of ${D.minFramerate} > maximum of ${I}`),O;if(!E.some(B=>D.videoRanges[B]>0))return yr(M,`no variants with VIDEO-RANGE of ${rt(E)} found`),O;if(u&&M.indexOf(u.substring(0,4))%5!==0)return yr(M,`video codec preference "${u}" not found`),O;if(D.maxScore<b)return yr(M,`max score of ${D.maxScore} < selected max of ${b}`),O}return O&&(Au(M)>=Au(O)||D.fragmentError>n[O].fragmentError)?O:(w=D.minIndex,b=D.maxScore,M)},void 0),videoRanges:E,preferHDR:T,minFramerate:x,minBitrate:y,minIndex:w}}function yr(n,e){Ze.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function kb(n){return n.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const s=t.channels||"2";return r.channels[s]=(r.channels[s]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function LR(n,e,t,r){return n.slice(t,r+1).reduce((s,i,a)=>{if(!i.codecSet)return s;const l=i.audioGroups;let u=s[i.codecSet];u||(s[i.codecSet]=u={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),u.minBitrate=Math.min(u.minBitrate,i.bitrate);const d=Math.min(i.height,i.width);return u.minHeight=Math.min(u.minHeight,d),u.minFramerate=Math.min(u.minFramerate,i.frameRate),u.minIndex=Math.min(u.minIndex,a),u.maxScore=Math.max(u.maxScore,i.score),u.fragmentError+=i.fragmentError,u.videoRanges[i.videoRange]=(u.videoRanges[i.videoRange]||0)+1,l&&l.forEach(f=>{if(!f)return;const m=e.groups[f];m&&(u.hasDefaultAudio=u.hasDefaultAudio||e.hasDefaultAudio?m.hasDefault:m.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(m.channels).forEach(g=>{u.channels[g]=(u.channels[g]||0)+m.channels[g]}))}),s},{})}function gv(n){if(!n)return n;const{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}=n;return{lang:e,assocLang:t,characteristics:r,channels:s,audioCodec:i}}function _r(n,e,t){if("attrs"in n){const r=e.indexOf(n);if(r!==-1)return r}for(let r=0;r<e.length;r++){const s=e[r];if(bi(n,s,t))return r}return-1}function bi(n,e,t){const{groupId:r,name:s,lang:i,assocLang:a,default:l}=n,u=n.forced;return(r===void 0||e.groupId===r)&&(s===void 0||e.name===s)&&(i===void 0||RR(i,e.lang))&&(i===void 0||e.assocLang===a)&&(l===void 0||e.default===l)&&(u===void 0||e.forced===u)&&(!("characteristics"in n)||PR(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function RR(n,e="--"){return n.length===e.length?n===e:n.startsWith(e)||e.startsWith(n)}function PR(n,e=""){const t=n.split(","),r=e.split(",");return t.length===r.length&&!t.some(s=>r.indexOf(s)===-1)}function mi(n,e){const{audioCodec:t,channels:r}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function DR(n,e,t,r,s){const i=e[r],l=e.reduce((g,x,y)=>{const w=x.uri;return(g[w]||(g[w]=[])).push(y),g},{})[i.uri];l.length>1&&(r=Math.max.apply(Math,l));const u=i.videoRange,d=i.frameRate,f=i.codecSet.substring(0,4),m=xv(e,r,g=>{if(g.videoRange!==u||g.frameRate!==d||g.codecSet.substring(0,4)!==f)return!1;const x=g.audioGroups,y=t.filter(w=>!x||x.indexOf(w.groupId)!==-1);return _r(n,y,s)>-1});return m>-1?m:xv(e,r,g=>{const x=g.audioGroups,y=t.filter(w=>!x||x.indexOf(w.groupId)!==-1);return _r(n,y,s)>-1})}function xv(n,e,t){for(let r=e;r>-1;r--)if(t(n[r]))return r;for(let r=e+1;r<n.length;r++)if(t(n[r]))return r;return-1}function Ru(n,e){var t;return!!n&&n!==((t=e.loadLevelObj)==null?void 0:t.uri)}class NR extends zn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:s,partCurrent:i,hls:a}=this,{autoLevelEnabled:l,media:u}=a;if(!s||!u)return;const d=performance.now(),f=i?i.stats:s.stats,m=i?i.duration:s.duration,g=d-f.loading.start,x=a.minAutoLevel,y=s.level,w=this._nextAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||y<=x){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l)return;const b=w>-1&&w!==y,E=!!t||b;if(!E&&(u.paused||!u.playbackRate||!u.readyState))return;const T=a.mainForwardBufferInfo;if(!E&&T===null)return;const _=this.bwEstimator.getEstimateTTFB(),A=Math.abs(u.playbackRate);if(g<=Math.max(_,1e3*(m/(A*2))))return;const I=T?T.len/A:0,N=f.loading.first?f.loading.first-f.loading.start:-1,P=f.loaded&&N>-1,O=this.getBwEstimate(),M=a.levels,D=M[y],B=Math.max(f.loaded,Math.round(m*(s.bitrate||D.averageBitrate)/8));let q=P?g-N:g;q<1&&P&&(q=Math.min(g,f.loaded*8/O));const ie=P?f.loaded*1e3/q:0,te=_/1e3,re=ie?(B-f.loaded)/ie:B*8/O+te;if(re<=I)return;const ee=ie?ie*8:O,Q=((r=t?.details||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,G=this.hls.config.abrBandWidthUpFactor;let Y=Number.POSITIVE_INFINITY,Z;for(Z=y-1;Z>x;Z--){const ne=M[Z].maxBitrate,ae=!M[Z].details||Q;if(Y=this.getTimeToLoadFrag(te,ee,m*ne,ae),Y<Math.min(I,m+te))break}if(Y>=re||Y>m*10)return;P?this.bwEstimator.sample(g-Math.min(_,N),f.loaded):this.bwEstimator.sampleTTFB(g);const j=M[Z].maxBitrate;this.getBwEstimate()*G>j&&this.resetEstimator(j);const $=this.findBestLevel(j,x,Z,0,I,1,1);$>-1&&(Z=$),this.warn(`Fragment ${s.sn}${i?" part "+i.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${I.toFixed(3)} s
      Estimated load time for current fragment: ${re.toFixed(3)} s
      Estimated load time for down switch fragment: ${Y.toFixed(3)} s
      TTFB estimate: ${N|0} ms
      Current BW estimate: ${pe(O)?O|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${Z} @ ${j|0} bps`),a.nextLoadLevel=a.nextAutoLevel=Z,this.clearTimer();const fe=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===Z&&Z>0){const ne=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${Z>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${ne.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,Z>x){let ae=this.findBestLevel(this.hls.levels[x].bitrate,x,Z,0,ne,1,1);ae===-1&&(ae=x),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ae,this.resetEstimator(this.hls.levels[ae].bitrate)}}};b||re>Y*2?fe():this.timer=self.setInterval(fe,Y*1e3),a.trigger(C.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:i,stats:f})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new BL(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(C.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var s;this.fragCurrent=r,this.partCurrent=(s=t.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case K.BUFFER_ADD_CODEC_ERROR:case K.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case K.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:s,partCurrent:i}=this;if(r&&s&&r.sn===s.sn&&r.level===s.level){const a=performance.now(),l=i?i.stats:r.stats,u=a-l.loading.start,d=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&d>-1){const m=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(u-Math.min(m,d),l.loaded)}else this.bwEstimator.sampleTTFB(u)}break}}}getTimeToLoadFrag(e,t,r,s){const i=e+r/t,a=s?e+this.lastLevelLoadSec:0;return i+a}onLevelLoaded(e,t){const r=this.hls.config,{loading:s}=t.stats,i=s.end-s.first;pe(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const s=r?r.stats:t.stats;if(t.type===ve.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const i=r?r.duration:t.duration,a=this.hls.levels[t.level],l=(a.loaded?a.loaded.bytes:0)+s.loaded,u=(a.loaded?a.loaded.duration:0)+i;a.loaded={bytes:l,duration:u},a.realBitrate=Math.round(8*l/u)}if(t.bitrateTest){const i={stats:s,frag:t,part:r,id:t.type};this.onFragBuffered(C.FRAG_BUFFERED,i),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:s}=t,i=s!=null&&s.stats.loaded?s.stats:r.stats;if(i.aborted||this.ignoreFragment(r))return;const a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ve.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,i=this.findBestLevel(r,t,e,0,s,1,1);if(i>-1)return i;const a=this.hls.firstLevel,l=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=r&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,i)&&a[e].loadError<=a[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:s,config:i,minAutoLevel:a}=r,l=t?t.duration:e?e.duration:0,u=this.getBwEstimate(),d=this.getStarvationDelay();let f=i.abrBandWidthFactor,m=i.abrBandWidthUpFactor;if(d){const b=this.findBestLevel(u,a,s,d,0,f,m);if(b>=0)return this.rebufferNotice=-1,b}let g=l?Math.min(l,i.maxStarvationDelay):i.maxStarvationDelay;if(!d){const b=this.bitrateTestDelay;b&&(g=(l?Math.min(l,i.maxLoadingDelay):i.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*g)} ms`),f=m=1)}const x=this.findBestLevel(u,a,s,d,g,f,m);if(this.rebufferNotice!==x&&(this.rebufferNotice=x,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${x}`)),x>-1)return x;const y=r.levels[a],w=r.loadLevelObj;return w&&y?.bitrate<w.bitrate?a:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,s,i,a,l){var u;const d=s+i,f=this.lastLoadedFragLevel,m=f===-1?this.hls.firstLevel:f,{fragCurrent:g,partCurrent:x}=this,{levels:y,allAudioTracks:w,loadLevel:b,config:E}=this.hls;if(y.length===1)return 0;const T=y[m],_=!!((u=this.hls.latestLevelDetails)!=null&&u.live),A=b===-1||f===-1;let I,N="SDR",P=T?.frameRate||0;const{audioPreference:O,videoPreference:M}=E,D=this.audioTracksByGroup||(this.audioTracksByGroup=kb(w));let B=-1;if(A){if(this.firstSelection!==-1)return this.firstSelection;const ee=this.codecTiers||(this.codecTiers=LR(y,D,t,r)),Q=IR(ee,N,e,O,M),{codecSet:G,videoRanges:Y,minFramerate:Z,minBitrate:j,minIndex:$,preferHDR:fe}=Q;B=$,I=G,N=fe?Y[Y.length-1]:Y[0],P=Z,e=Math.max(e,j),this.log(`picked start tier ${rt(Q)}`)}else I=T?.codecSet,N=T?.videoRange;const q=x?x.duration:g?g.duration:0,ie=this.bwEstimator.getEstimateTTFB()/1e3,te=[];for(let ee=r;ee>=t;ee--){var re;const Q=y[ee],G=ee>m;if(!Q)continue;if(E.useMediaCapabilities&&!Q.supportedResult&&!Q.supportedPromise){const ae=navigator.mediaCapabilities;typeof ae?.decodingInfo=="function"&&vR(Q,D,N,P,e,O)?(Q.supportedPromise=Tb(Q,D,ae,this.supportedCache),Q.supportedPromise.then(ce=>{if(!this.hls)return;Q.supportedResult=ce;const _e=this.hls.levels,Ee=_e.indexOf(Q);ce.error?this.warn(`MediaCapabilities decodingInfo error: "${ce.error}" for level ${Ee} ${rt(ce)}`):ce.supported?ce.decodingInfoResults.some(Le=>Le.smooth===!1||Le.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Ee} not smooth or powerEfficient: ${rt(ce)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Ee} ${rt(ce)}`),Ee>-1&&_e.length>1&&(this.log(`Removing unsupported level ${Ee}`),this.hls.removeLevel(Ee),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(ce=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${ce}`)})):Q.supportedResult=Sb}if((I&&Q.codecSet!==I||N&&Q.videoRange!==N||G&&P>Q.frameRate||!G&&P>0&&P<Q.frameRate||(re=Q.supportedResult)!=null&&(re=re.decodingInfoResults)!=null&&re.some(ae=>ae.smooth===!1))&&(!A||ee!==B)){te.push(ee);continue}const Y=Q.details,Z=(x?Y?.partTarget:Y?.averagetargetduration)||q;let j;G?j=l*e:j=a*e;const $=q&&s>=q*2&&i===0?Q.averageBitrate:Q.maxBitrate,fe=this.getTimeToLoadFrag(ie,j,$*Z,Y===void 0);if(j>=$&&(ee===f||Q.loadError===0&&Q.fragmentError===0)&&(fe<=ie||!pe(fe)||_&&!this.bitrateTestDelay||fe<d)){const ae=this.forcedAutoLevel;return ee!==b&&(ae===-1||ae!==b)&&(te.length&&this.trace(`Skipped level(s) ${te.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${y[te[0]].codecs}" ${y[te[0]].videoRange}; not compatible with "${I}" ${N}`),this.info(`switch candidate:${m}->${ee} adjustedbw(${Math.round(j)})-bitrate=${Math.round(j-$)} ttfb:${ie.toFixed(1)} avgDuration:${Z.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${fe.toFixed(1)} firstSelection:${A} codecSet:${Q.codecSet} videoRange:${Q.videoRange} hls.loadLevel:${b}`)),A&&(this.firstSelection=ee),ee}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const Cb={search:function(n,e){let t=0,r=n.length-1,s=null,i=null;for(;t<=r;){s=(t+r)/2|0,i=n[s];const a=e(i);if(a>0)t=s+1;else if(a<0)r=s-1;else return i}return null}};function jR(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!pe(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const s=n[n.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let i=0;i<n.length;++i){const a=n[i];if(MR(e,t,a))return a}return null}function ki(n,e,t=0,r=0,s=.005){let i=null;if(n){i=e[1+n.sn-e[0].sn]||null;const l=n.endDTS-t;l>0&&l<15e-7&&(t+=15e-7),i&&n.level!==i.level&&i.end<=n.end&&(i=e[2+n.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(i=e[0]);if(i&&((!n||n.level===i.level)&&yv(t,r,i)===0||OR(i,n,Math.min(s,r))))return i;const a=Cb.search(e,yv.bind(null,t,r));return a&&(a!==n||!i)?a:i}function OR(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((s,i)=>(i[0]==="INF"&&(s+=parseFloat(i[1])),s),t);return n.start<=r}return!1}function yv(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function MR(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function Ab(n,e,t){if(n&&n.startCC<=e&&n.endCC>=e){let r=n.fragments;const{fragmentHint:s}=n;s&&(r=r.concat(s));let i;return Cb.search(r,a=>a.cc<e?1:a.cc>e?-1:(i=a,a.end<=t?1:a.start>t?-1:0)),i||null}return null}function Pu(n){switch(n.details){case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_TIMEOUT:case K.LEVEL_LOAD_TIMEOUT:case K.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ib(n){return n.details.startsWith("key")}function Lb(n){return Ib(n)&&!!n.frag&&!n.frag.decryptdata}function vv(n,e){const t=Pu(e);return n.default[`${t?"timeout":"error"}Retry`]}function Gp(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function wv(n){return Xe(Xe({},n),{errorRetry:null,timeoutRetry:null})}function Du(n,e,t,r){if(!n)return!1;const s=r?.code,i=e<n.maxNumRetry&&(FR(s)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,r,i):i}function FR(n){return Om(n)||!!n&&(n<400||n>499)}function Om(n){return n===0&&navigator.onLine===!1}var Kt={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},In={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class BR extends zn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.ERROR,this.onError,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.ERROR,this.onError,this),e.off(C.ERROR,this.onErrorOut,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===ve.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,r=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||r===-1?t.loadLevel:r}variantHasKey(e,t){if(e){var r;if((r=e.details)!=null&&r.hasKey(t))return!0;const s=e.audioGroups;if(s)return this.hls.allAudioTracks.filter(a=>s.indexOf(a.groupId)>=0).some(a=>{var l;return(l=a.details)==null?void 0:l.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const s=this.hls,i=t.context;switch(t.details){case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case K.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=xa();return}case K.FRAG_GAP:case K.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Kt.SendAlternateToPenaltyBox;return}case K.LEVEL_EMPTY_ERROR:case K.LEVEL_PARSING_ERROR:{var a;const u=t.parent===ve.MAIN?t.level:s.loadLevel;t.details===K.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(a=a.levelDetails)!=null&&a.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:typeof i?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level));return;case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.SUBTITLE_LOAD_ERROR:case K.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const u=s.loadLevelObj;if(u&&(i.type===Ge.AUDIO_TRACK&&u.hasAudioGroup(i.groupId)||i.type===Ge.SUBTITLE_TRACK&&u.hasSubtitleGroup(i.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Kt.SendAlternateToPenaltyBox,t.errorAction.flags=In.MoveAllAlternatesMatchingHost;return}}return;case K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Kt.SendAlternateToPenaltyBox,flags:In.MoveAllAlternatesMatchingHDCP};return;case K.KEY_SYSTEM_SESSION_UPDATE_FAILED:case K.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case K.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Kt.SendAlternateToPenaltyBox,flags:In.MoveAllAlternatesMatchingKey};return;case K.BUFFER_ADD_CODEC_ERROR:case K.REMUX_ALLOC_ERROR:case K.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:s.loadLevel)}return;case K.INTERNAL_EXCEPTION:case K.BUFFER_APPENDING_ERROR:case K.BUFFER_FULL_ERROR:case K.LEVEL_SWITCH_ERROR:case K.BUFFER_STALLED_ERROR:case K.BUFFER_SEEK_OVER_HOLE:case K.BUFFER_NUDGE_ON_STALL:t.errorAction=xa();return}t.type===Ce.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=xa())}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,s=vv(r.config.playlistLoadPolicy,e),i=this.playlistError++;if(Du(s,i,Pu(e),e.response))return{action:Kt.RetryRequest,flags:In.None,retryConfig:s,retryCount:i};const l=this.getLevelSwitchAction(e,t);return s&&(l.retryConfig=s,l.retryCount=i),l}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),s=t.levels[r],{fragLoadPolicy:i,keyLoadPolicy:a}=t.config,l=vv(Ib(e)?a:i,e),u=t.levels.reduce((f,m)=>f+m.fragmentError,0);if(s&&(e.details!==K.FRAG_GAP&&s.fragmentError++,!Lb(e)&&Du(l,u,Pu(e),e.response)))return{action:Kt.RetryRequest,flags:In.None,retryConfig:l,retryCount:u};const d=this.getLevelSwitchAction(e,r);return l&&(d.retryConfig=l,d.retryCount=u),d}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const s=this.hls.levels[t];if(s){var i,a;const d=e.details;s.loadError++,d===K.BUFFER_APPEND_ERROR&&s.fragmentError++;let f=-1;const{levels:m,loadLevel:g,minAutoLevel:x,maxAutoLevel:y}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const w=(i=e.frag)==null?void 0:i.type,E=(w===ve.AUDIO&&d===K.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===K.BUFFER_ADD_CODEC_ERROR||d===K.BUFFER_APPEND_ERROR))&&m.some(({audioCodec:N})=>s.audioCodec!==N),_=e.sourceBufferName==="video"&&(d===K.BUFFER_ADD_CODEC_ERROR||d===K.BUFFER_APPEND_ERROR)&&m.some(({codecSet:N,audioCodec:P})=>s.codecSet!==N&&s.audioCodec===P),{type:A,groupId:I}=(a=e.context)!=null?a:{};for(let N=m.length;N--;){const P=(N+g)%m.length;if(P!==g&&P>=x&&P<=y&&m[P].loadError===0){var l,u;const O=m[P];if(d===K.FRAG_GAP&&w===ve.MAIN&&e.frag){const M=m[P].details;if(M){const D=ki(e.frag,M.fragments,e.frag.start);if(D!=null&&D.gap)continue}}else{if(A===Ge.AUDIO_TRACK&&O.hasAudioGroup(I)||A===Ge.SUBTITLE_TRACK&&O.hasSubtitleGroup(I))continue;if(w===ve.AUDIO&&(l=s.audioGroups)!=null&&l.some(M=>O.hasAudioGroup(M))||w===ve.SUBTITLE&&(u=s.subtitleGroups)!=null&&u.some(M=>O.hasSubtitleGroup(M))||E&&s.audioCodec===O.audioCodec||_&&s.codecSet===O.codecSet||!E&&s.codecSet!==O.codecSet)continue}f=P;break}}if(f>-1&&r.loadLevel!==f)return e.levelRetry=!0,this.playlistError=0,{action:Kt.SendAlternateToPenaltyBox,flags:In.None,nextAutoLevel:f}}return{action:Kt.SendAlternateToPenaltyBox,flags:In.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case Kt.DoNothing:break;case Kt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==K.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:s}=r,i=r.nextAutoLevel;switch(s){case In.None:this.switchLevel(e,i);break;case In.MoveAllAlternatesMatchingHDCP:{const u=this.getVariantLevelIndex(e.frag),d=t.levels[u],f=d?.attrs["HDCP-LEVEL"];if(r.hdcpLevel=f,f==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(f){t.maxHdcpLevel=jm[jm.indexOf(f)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case In.MoveAllAlternatesMatchingKey:{const u=e.decryptdata;if(u){const d=this.hls.levels,f=d.length;for(let g=f;g--;)if(this.variantHasKey(d[g],u)){var a,l;this.log(`Banned key found in level ${g} (${d[g].bitrate}bps) or audio group "${(a=d[g].audioGroups)==null?void 0:a.join(",")}" (${(l=e.frag)==null?void 0:l.type} fragment) ${zt(u.keyId||[])}`),d[g].fragmentError++,d[g].loadError++,this.log(`Removing level ${g} with key error (${e.error})`),this.hls.removeLevel(g)}const m=e.frag;if(this.hls.levels.length<f)r.resolved=!0;else if(m&&m.type!==ve.MAIN){const g=m.decryptdata;g&&!u.matches(g)&&(r.resolved=!0)}}break}}r.resolved||this.switchLevel(e,i)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===K.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=Nm(e.mimeType),s=this.hls.levels;for(let i=s.length;i--;)s[i][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${i} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(i))}}}function xa(n){const e={action:Kt.DoNothing,flags:In.None};return n&&(e.resolved=!0),e}var Nt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class UR{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let s=r.length;s--;){const i=r[s];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){const{fragments:s}=this,i=Object.keys(s);for(let a=i.length;a--;){const l=s[i[a]];if(l?.body.type===t&&(!r||l.buffered)){const u=l.body;if(u.start<=e&&e<=u.end)return u}}return null}detectEvictedFragments(e,t,r,s,i){this.timeRanges&&(this.timeRanges[e]=t);const a=s?.fragment.sn||-1;Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u||a>=u.body.sn)return;if(!u.buffered&&(!u.loaded||i)){u.body.type===r&&this.removeFragment(u.body);return}const d=u.range[e];if(d){if(d.time.length===0){this.removeFragment(u.body);return}d.time.some(f=>{const m=!this.isTimeBuffered(f.startPTS,f.endPTS,t);return m&&this.removeFragment(u.body),m})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const r=e.frag,s=sa(r),i=this.fragments[s];if(!i||i.buffered&&r.gap)return;const a=!r.relurl;Object.keys(t).forEach(l=>{const u=r.elementaryStreams[l];if(!u)return;const d=t[l],f=a||u.partial===!0;i.range[l]=this.getBufferedTimes(r,e.part,f,d)}),i.loaded=null,Object.keys(i.range).length?(this.bufferedEnd(i,r),Gc(i)||this.removeParts(r.sn-1,r.type)):this.removeFragment(i.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=bv(r,s=>s.fragment.sn>=e))}fragBuffered(e,t){const r=sa(e);let s=this.fragments[r];!s&&t&&(s=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,this.bufferedEnd(s,e))}getBufferedTimes(e,t,r,s){const i={time:[],partial:r},a=e.start,l=e.end,u=e.minEndPTS||l,d=e.maxStartPTS||a;for(let f=0;f<s.length;f++){const m=s.start(f)-this.bufferPadding,g=s.end(f)+this.bufferPadding;if(d>=m&&u<=g){i.time.push({startPTS:Math.max(a,s.start(f)),endPTS:Math.min(l,s.end(f))});break}else if(a<g&&l>m){const x=Math.max(a,s.start(f)),y=Math.min(l,s.end(f));y>x&&(i.partial=!0,i.time.push({startPTS:x,endPTS:y}))}else if(l<=m)break}return i}getPartialFragment(e){let t=null,r,s,i,a=0;const{bufferPadding:l,fragments:u}=this;return Object.keys(u).forEach(d=>{const f=u[d];f&&Gc(f)&&(s=f.body.start-l,i=f.body.end+l,e>=s&&e<=i&&(r=Math.min(e-s,i-e),a<=r&&(t=f.body,a=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Gc(t))}getState(e){const t=sa(e),r=this.fragments[t];return r?r.buffered?Gc(r)?Nt.PARTIAL:Nt.OK:Nt.APPENDING:Nt.NOT_LOADED}isTimeBuffered(e,t,r){let s,i;for(let a=0;a<r.length;a++){if(s=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,e>=s&&t<=i)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const r=t.frag,s=t.part?null:t,i=sa(r);this.fragments[i]={body:r,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:s,timeRanges:i,type:a}=t;if(r.sn==="initSegment")return;const l=r.type;if(s){let d=this.activePartLists[l];d||(this.activePartLists[l]=d=[]),d.push(s)}this.timeRanges=i;const u=i[a];this.detectEvictedFragments(a,u,l,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=sa(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let s=r.length;s--;){const i=t[r[s]];if(i?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,s,i){s&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const l=this.fragments[a];if(!l)return;const u=l.body;u.type!==r||s&&!u.gap||u.start<t&&u.end>e&&(l.buffered||i)&&this.removeFragment(u)})}removeFragment(e){const t=sa(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const s=e.sn;this.activePartLists[e.type]=bv(r,i=>i.fragment.sn!==s)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(r=>r.clearElementaryStreamInfo())}}function Gc(n){var e,t,r;return n.buffered&&!!(n.body.gap||(e=n.range.video)!=null&&e.partial||(t=n.range.audio)!=null&&t.partial||(r=n.range.audiovideo)!=null&&r.partial)}function sa(n){return`${n.type}_${n.level}_${n.sn}`}function bv(n,e){return n.filter(t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r})}var Vs={cbc:0,ctr:1};class $R{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case Vs.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Vs.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function VR(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?n.slice(0,e-t):n}class GR{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let s=0;s<4;s++)r[s]=t.getUint32(s*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,s=r[0],i=r[1],a=r[2],l=r[3],u=this.invSubMix,d=u[0],f=u[1],m=u[2],g=u[3],x=new Uint32Array(256);let y=0,w=0,b=0;for(b=0;b<256;b++)b<128?x[b]=b<<1:x[b]=b<<1^283;for(b=0;b<256;b++){let E=w^w<<1^w<<2^w<<3^w<<4;E=E>>>8^E&255^99,e[y]=E,t[E]=y;const T=x[y],_=x[T],A=x[_];let I=x[E]*257^E*16843008;s[y]=I<<24|I>>>8,i[y]=I<<16|I>>>16,a[y]=I<<8|I>>>24,l[y]=I,I=A*16843009^_*65537^T*257^y*16843008,d[E]=I<<24|I>>>8,f[E]=I<<16|I>>>16,m[E]=I<<8|I>>>24,g[E]=I,y?(y=T^x[x[x[A^T]]],w^=x[x[w]]):y=w=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,s=0;for(;s<t.length&&r;)r=t[s]===this.key[s],s++;if(r)return;this.key=t;const i=this.keySize=t.length;if(i!==4&&i!==6&&i!==8)throw new Error("Invalid aes key size="+i);const a=this.ksRows=(i+6+1)*4;let l,u;const d=this.keySchedule=new Uint32Array(a),f=this.invKeySchedule=new Uint32Array(a),m=this.sBox,g=this.rcon,x=this.invSubMix,y=x[0],w=x[1],b=x[2],E=x[3];let T,_;for(l=0;l<a;l++){if(l<i){T=d[l]=t[l];continue}_=T,l%i===0?(_=_<<8|_>>>24,_=m[_>>>24]<<24|m[_>>>16&255]<<16|m[_>>>8&255]<<8|m[_&255],_^=g[l/i|0]<<24):i>6&&l%i===4&&(_=m[_>>>24]<<24|m[_>>>16&255]<<16|m[_>>>8&255]<<8|m[_&255]),d[l]=T=(d[l-i]^_)>>>0}for(u=0;u<a;u++)l=a-u,u&3?_=d[l]:_=d[l-4],u<4||l<=4?f[u]=_:f[u]=y[m[_>>>24]]^w[m[_>>>16&255]]^b[m[_>>>8&255]]^E[m[_&255]],f[u]=f[u]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const s=this.keySize+6,i=this.invKeySchedule,a=this.invSBox,l=this.invSubMix,u=l[0],d=l[1],f=l[2],m=l[3],g=this.uint8ArrayToUint32Array_(r);let x=g[0],y=g[1],w=g[2],b=g[3];const E=new Int32Array(e),T=new Int32Array(E.length);let _,A,I,N,P,O,M,D,B,q,ie,te,re,ee;const Q=this.networkToHostOrderSwap;for(;t<E.length;){for(B=Q(E[t]),q=Q(E[t+1]),ie=Q(E[t+2]),te=Q(E[t+3]),P=B^i[0],O=te^i[1],M=ie^i[2],D=q^i[3],re=4,ee=1;ee<s;ee++)_=u[P>>>24]^d[O>>16&255]^f[M>>8&255]^m[D&255]^i[re],A=u[O>>>24]^d[M>>16&255]^f[D>>8&255]^m[P&255]^i[re+1],I=u[M>>>24]^d[D>>16&255]^f[P>>8&255]^m[O&255]^i[re+2],N=u[D>>>24]^d[P>>16&255]^f[O>>8&255]^m[M&255]^i[re+3],P=_,O=A,M=I,D=N,re=re+4;_=a[P>>>24]<<24^a[O>>16&255]<<16^a[M>>8&255]<<8^a[D&255]^i[re],A=a[O>>>24]<<24^a[M>>16&255]<<16^a[D>>8&255]<<8^a[P&255]^i[re+1],I=a[M>>>24]<<24^a[D>>16&255]<<16^a[P>>8&255]<<8^a[O&255]^i[re+2],N=a[D>>>24]<<24^a[P>>16&255]<<16^a[O>>8&255]<<8^a[M&255]^i[re+3],T[t]=Q(_^x),T[t+1]=Q(N^y),T[t+2]=Q(I^w),T[t+3]=Q(A^b),x=B,y=q,w=ie,b=te,t=t+4}return T.buffer}}class HR{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=KR(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function KR(n){switch(n){case Vs.cbc:return"AES-CBC";case Vs.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}const zR=16;class Hp{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?VR(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,s){return this.useSoftware?new Promise((i,a)=>{const l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,t,r,s);const u=this.flush();u?i(u.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,s)}softwareDecrypt(e,t,r,s){const{currentIV:i,currentResult:a,remainderData:l}=this;if(s!==Vs.cbc||t.byteLength!==16)return Ze.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=Hn(l,e),this.remainderData=null);const u=this.getValidChunk(e);if(!u.length)return null;i&&(r=i);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new GR),d.expandKey(t);const f=a;return this.currentResult=d.decrypt(u.buffer,0,r),this.currentIV=u.slice(-16).buffer,f||null}webCryptoDecrypt(e,t,r,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,s));this.key=t,this.fastAesKey=new HR(this.subtle,t,s)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new $R(this.subtle,new Uint8Array(r),s).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(Ze.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,r,s)))}onWebCryptoError(e,t,r,s){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,s);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%zR;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(Ze.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Sv=Math.pow(2,17);class WR{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new Xr({type:Ce.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((l,u)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){u(Tv(e));return}else e.gap=!1;const d=this.loader=i?new i(s):new a(s),f=Ev(e);e.loader=d;const m=wv(s.fragLoadPolicy.default),g={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Sv};e.stats=d.stats;const x={onSuccess:(y,w,b,E)=>{this.resetLoader(e,d);let T=y.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(T.slice(0,16)),T=T.slice(16)),l({frag:e,part:null,payload:T,networkDetails:E})},onError:(y,w,b,E)=>{this.resetLoader(e,d),u(new Xr({type:Ce.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Xe({url:r,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:b,stats:E}))},onAbort:(y,w,b)=>{this.resetLoader(e,d),u(new Xr({type:Ce.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:y}))},onTimeout:(y,w,b)=>{this.resetLoader(e,d),u(new Xr({type:Ce.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:b,stats:y}))}};t&&(x.onProgress=(y,w,b,E)=>t({frag:e,part:null,payload:b,networkDetails:E})),d.load(f,g,x)})}loadPart(e,t,r){this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((l,u)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){u(Tv(e,t));return}const d=this.loader=i?new i(s):new a(s),f=Ev(e,t);e.loader=d;const m=wv(s.fragLoadPolicy.default),g={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Sv};t.stats=d.stats,d.load(f,g,{onSuccess:(x,y,w,b)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const E={frag:e,part:t,payload:x.data,networkDetails:b};r(E),l(E)},onError:(x,y,w,b)=>{this.resetLoader(e,d),u(new Xr({type:Ce.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Xe({url:f.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:w,stats:b}))},onAbort:(x,y,w)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),u(new Xr({type:Ce.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:w,stats:x}))},onTimeout:(x,y,w)=>{this.resetLoader(e,d),u(new Xr({type:Ce.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${g.timeout}ms`),networkDetails:w,stats:x}))}})})}updateStatsFromPart(e,t){const r=e.stats,s=t.stats,i=s.total;if(r.loaded+=s.loaded,i){const u=Math.round(e.duration/t.duration),d=Math.min(Math.round(r.loaded/i),u),m=(u-d)*Math.round(r.loaded/d);r.total=r.loaded+m}else r.total=Math.max(r.loaded,r.total);const a=r.loading,l=s.loading;a.start?a.first+=l.first-l.start:(a.start=l.start,a.first=l.first),a.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Ev(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,i=t.byteRangeEndOffset;if(pe(s)&&pe(i)){var a;let l=s,u=i;if(n.sn==="initSegment"&&qR((a=n.decryptdata)==null?void 0:a.method)){const d=i-s;d%16&&(u=i+(16-d%16)),s!==0&&(r.resetIV=!0,l=s-16)}r.rangeStart=l,r.rangeEnd=u}return r}function Tv(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:Ce.MEDIA_ERROR,details:K.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new Xr(r)}function qR(n){return n==="AES-128"||n==="AES-256"}class Xr extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Rb extends zn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Kp{constructor(e,t,r,s=0,i=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Hc(),this.buffering={audio:Hc(),video:Hc(),audiovideo:Hc()},this.level=e,this.sn=t,this.id=r,this.size=s,this.part=i,this.partial=a}}function Hc(){return{start:0,executeStart:0,executeEnd:0,end:0}}const _v={length:0,start:()=>0,end:()=>0};class Fe{static isBuffered(e,t){if(e){const r=Fe.getBuffered(e);for(let s=r.length;s--;)if(t>=r.start(s)&&t<=r.end(s))return!0}return!1}static bufferedRanges(e){if(e){const t=Fe.getBuffered(e);return Fe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const s=Fe.bufferedRanges(e);if(s.length)return Fe.bufferedInfo(s,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((f,m)=>f.start-m.start||m.end-f.end);let s=-1,i=[];if(r)for(let f=0;f<e.length;f++){t>=e[f].start&&t<=e[f].end&&(s=f);const m=i.length;if(m){const g=i[m-1].end;e[f].start-g<r?e[f].end>g&&(i[m-1].end=e[f].end):i.push(e[f])}else i.push(e[f])}else i=e;let a=0,l,u=t,d=t;for(let f=0;f<i.length;f++){const m=i[f].start,g=i[f].end;if(s===-1&&t>=m&&t<=g&&(s=f),t+r>=m&&t<g)u=m,d=g,a=d-t;else if(t+r<m){l=m;break}}return{len:a,start:u||0,end:d||0,nextStart:l,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||_v}catch(t){return Ze.log("failed to get media.buffered",t),_v}}}const Pb=/\{\$([a-zA-Z0-9-_]+)\}/g;function kv(n){return Pb.test(n)}function Mm(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(Pb,r=>{const s=r.substring(2,r.length-1),i=t?.[s];return i===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),r):i})}return e}function Cv(n,e,t){let r=n.variableList;r||(n.variableList=r={});let s,i;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(s))i=a.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${t}"`)}catch(a){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else s=e.NAME,i=e.VALUE;s in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=i||""}function YR(n,e,t){const r=e.IMPORT;if(t&&r in t){let s=n.variableList;s||(n.variableList=s={}),s[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const QR=/^(\d+)x(\d+)$/,Av=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ht{constructor(e,t){typeof e=="string"&&(e=ht.parseAttrList(e,t)),et(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let s=0;s<t.length/2;s++)r[s]=parseInt(t.slice(s*2,s*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((s,i)=>(s[i.toLowerCase()]=!0,s),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=QR.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const s={};for(Av.lastIndex=0;(r=Av.exec(e))!==null;){const a=r[1].trim();let l=r[2];const u=l.indexOf('"')===0&&l.lastIndexOf('"')===l.length-1;let d=!1;if(u)l=l.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(u||d))l=Mm(t,l);else if(!d&&!u)switch(a){case"CLOSED-CAPTIONS":if(l==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Ze.warn(`${e}: attribute ${a} is missing quotes`)}s[a]=l}return s}}const XR="com.apple.hls.interstitial";function ZR(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function JR(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}class Db{constructor(e,t,r=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(s=t?.tagOrder)!=null?s:r,t){const i=t.attr;for(const a in i)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==i[a]){Ze.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=et(new ht({}),i,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=t?.endDate||new Date(this.attr["END-DATE"]);pe(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Ze.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(pe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===XR}get isValid(){return!!this.id&&!this._badValueForSameId&&pe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const e3=10;class t3{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return this.fragments.length?pe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||e3}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Nu(n,e){return n.length===e.length?!n.some((t,r)=>t!==e[r]):!1}function Iv(n,e){return!n&&!e?!0:!n||!e?!1:Nu(n,e)}function ya(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function zp(n){switch(n){case"AES-128":case"AES-256":return Vs.cbc;case"AES-256-CTR":return Vs.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function Wp(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function Fm(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}function n3(n){const e=Fm(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function Nb(n){const e=function(r,s,i){const a=r[s];r[s]=r[i],r[i]=a};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function jb(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),s=r[r.length-1].split(",");if(s.length===2){const i=s[0]==="base64",a=s[1];i?(r.splice(-1,1),t=Wp(a)):t=n3(a)}}return t}const ju=typeof self<"u"?self:void 0;var pt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Wt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function pu(n){switch(n){case Wt.FAIRPLAY:return pt.FAIRPLAY;case Wt.PLAYREADY:return pt.PLAYREADY;case Wt.WIDEVINE:return pt.WIDEVINE;case Wt.CLEARKEY:return pt.CLEARKEY}}function kh(n){switch(n){case pt.FAIRPLAY:return Wt.FAIRPLAY;case pt.PLAYREADY:return Wt.PLAYREADY;case pt.WIDEVINE:return Wt.WIDEVINE;case pt.CLEARKEY:return Wt.CLEARKEY}}function Fo(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[pt.FAIRPLAY,pt.WIDEVINE,pt.PLAYREADY,pt.CLEARKEY].filter(s=>!!e[s]):[];return!r[pt.WIDEVINE]&&t&&r.push(pt.WIDEVINE),r}const Ob=(function(n){return ju!=null&&(n=ju.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function r3(n,e,t,r){let s;switch(n){case pt.FAIRPLAY:s=["cenc","sinf"];break;case pt.WIDEVINE:case pt.PLAYREADY:s=["cenc"];break;case pt.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return s3(s,e,t,r)}function s3(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(i=>({contentType:`audio/mp4; codecs=${i}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(i=>({contentType:`video/mp4; codecs=${i}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function i3(n){var e;return!!n&&(n.sessionType==="persistent-license"||!!((e=n.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function Mb(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(a){const l=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(l){const u=Wp(l).subarray(0,16);return Nb(u),u}}return null}let ia={};class Bs{static clearKeyUriToKeyIdMap(){ia={}}static setKeyIdForUri(e,t){ia[e]=t}static addKeyIdForUri(e){const t=Object.keys(ia).length%Number.MAX_SAFE_INTEGER,r=new Uint8Array(16);return new DataView(r.buffer,12,4).setUint32(0,t),ia[e]=r,r}constructor(e,t,r,s=[1],i=null,a){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=s,this.iv=i,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!ya(e),a!=null&&a.startsWith("0x")&&(this.keyId=new Uint8Array(db(a)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Nu(e.keyFormatVersions,this.keyFormatVersions)&&Iv(e.iv,this.iv)&&Iv(e.keyId,this.keyId)}isSupported(){if(this.method){if(ya(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Wt.FAIRPLAY:case Wt.WIDEVINE:case Wt.PLAYREADY:case Wt.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(ya(this.method)){let i=this.iv;return i||(typeof e!="number"&&(Ze.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),i=o3(e)),new Bs(this.method,this.uri,"identity",this.keyFormatVersions,i)}if(this.keyId){const i=ia[this.uri];if(i&&!Nu(this.keyId,i)&&Bs.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const r=jb(this.uri);if(r)switch(this.keyFormat){case Wt.WIDEVINE:if(this.pssh=r,!this.keyId){const i=uR(r.buffer);if(i.length){var s;const a=i[0];this.keyId=(s=a.kids)!=null&&s.length?a.kids[0]:null}}this.keyId||(this.keyId=Lv(t));break;case Wt.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=cR(i,null,r),this.keyId=Mb(r);break}default:{let i=r.subarray(0,16);if(i.length!==16){const a=new Uint8Array(16);a.set(i,16-i.length),i=a}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i;i=a3(t),i||(i=Lv(t),i||(i=ia[this.uri])),i&&(this.keyId=i,Bs.setKeyIdForUri(this.uri,i))}return this}}function a3(n){const e=n?.[Wt.WIDEVINE];return e?e.keyId:null}function Lv(n){const e=n?.[Wt.PLAYREADY];if(e){const t=jb(e.uri);if(t)return Mb(t)}return null}function o3(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const Rv=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Pv=/#EXT-X-MEDIA:(.*)/g,l3=/^#EXT(?:INF|-X-TARGETDURATION):/m,Ch=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),c3=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class kr{static findGroup(e,t){for(let r=0;r<e.length;r++){const s=e[r];if(s.id===t)return s}}static resolve(e,t){return Fp.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return l3.test(e)}static parseMasterPlaylist(e,t){const r=kv(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},i=[];if(Rv.lastIndex=0,!e.startsWith("#EXTM3U"))return s.playlistParsingError=new Error("no EXTM3U delimiter"),s;let a;for(;(a=Rv.exec(e))!=null;)if(a[1]){var l;const d=new ht(a[1],s),f=Mm(s,a[2]),m={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:kr.resolve(f,t)},g=d.decimalResolution("RESOLUTION");g&&(m.width=g.width,m.height=g.height),jv(d.CODECS,m);const x=d["SUPPLEMENTAL-CODECS"];x&&(m.supplemental={},jv(x,m.supplemental)),(l=m.unknownCodecs)!=null&&l.length||i.push(m),s.levels.push(m)}else if(a[3]){const d=a[3],f=a[4];switch(d){case"SESSION-DATA":{const m=new ht(f,s),g=m["DATA-ID"];g&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[g]=m);break}case"SESSION-KEY":{const m=Dv(f,t,s);m.encrypted&&m.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(m)):Ze.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${f}"`);break}case"DEFINE":{{const m=new ht(f,s);Cv(s,m,t)}break}case"CONTENT-STEERING":{const m=new ht(f,s);s.contentSteering={uri:kr.resolve(m["SERVER-URI"],t),pathwayId:m["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=Nv(f);break}}}const u=i.length>0&&i.length<s.levels.length;return s.levels=u?i:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,t,r){let s;const i={},a=r.levels,l={AUDIO:a.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:a.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let u=0;for(Pv.lastIndex=0;(s=Pv.exec(e))!==null;){const d=new ht(s[1],r),f=d.TYPE;if(f){const m=l[f],g=i[f]||[];i[f]=g;const x=d.LANGUAGE,y=d["ASSOC-LANGUAGE"],w=d.CHANNELS,b=d.CHARACTERISTICS,E=d["INSTREAM-ID"],T={attrs:d,bitrate:0,id:u++,groupId:d["GROUP-ID"]||"",name:d.NAME||x||"",type:f,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:x,url:d.URI?kr.resolve(d.URI,t):""};if(y&&(T.assocLang=y),w&&(T.channels=w),b&&(T.characteristics=b),E&&(T.instreamId=E),m!=null&&m.length){const _=kr.findGroup(m,T.groupId)||m[0];Ov(T,_,"audioCodec"),Ov(T,_,"textCodec")}g.push(T)}}return i}static parseLevelPlaylist(e,t,r,s,i,a){var l;const u={url:t},d=new t3(t),f=d.fragments,m=[];let g=null,x=0,y=0,w=0,b=0,E=0,T=null,_=new Eh(s,u),A,I,N,P=-1,O=!1,M=null,D;if(Ch.lastIndex=0,d.m3u8=e,d.hasVariableRefs=kv(e),((l=Ch.exec(e))==null?void 0:l[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(A=Ch.exec(e))!==null;){O&&(O=!1,_=new Eh(s,u),_.playlistOffset=w,_.setStart(w),_.sn=x,_.cc=b,E&&(_.bitrate=E),_.level=r,g&&(_.initSegment=g,g.rawProgramDateTime&&(_.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),M&&(_.setByteRange(M),M=null)));const te=A[1];if(te){_.duration=parseFloat(te);const re=(" "+A[2]).slice(1);_.title=re||null,_.tagList.push(re?["INF",te,re]:["INF",te])}else if(A[3]){if(pe(_.duration)){_.playlistOffset=w,_.setStart(w),N&&Fv(_,N,d),_.sn=x,_.level=r,_.cc=b,f.push(_);const re=(" "+A[3]).slice(1);_.relurl=Mm(d,re),Bm(_,T,m),T=_,w+=_.duration,x++,y=0,O=!0}}else{if(A=A[0].match(c3),!A){Ze.warn("No matches on slow regex match for level playlist!");continue}for(I=1;I<A.length&&A[I]===void 0;I++);const re=(" "+A[I]).slice(1),ee=(" "+A[I+1]).slice(1),Q=A[I+2]?(" "+A[I+2]).slice(1):null;switch(re){case"BYTERANGE":T?_.setByteRange(ee,T):_.setByteRange(ee);break;case"PROGRAM-DATE-TIME":_.rawProgramDateTime=ee,_.tagList.push(["PROGRAM-DATE-TIME",ee]),P===-1&&(P=f.length);break;case"PLAYLIST-TYPE":d.type&&Yr(d,re,A),d.type=ee.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?Yr(d,re,A):f.length>0&&Bv(d,re,A),x=d.startSN=parseInt(ee);break;case"SKIP":{d.skippedSegments&&Yr(d,re,A);const G=new ht(ee,d),Y=G.decimalInteger("SKIPPED-SEGMENTS");if(pe(Y)){d.skippedSegments+=Y;for(let j=Y;j--;)f.push(null);x+=Y}const Z=G.enumeratedString("RECENTLY-REMOVED-DATERANGES");Z&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(Z.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&Yr(d,re,A),d.targetduration=Math.max(parseInt(ee),1);break;case"VERSION":d.version!==null&&Yr(d,re,A),d.version=parseInt(ee);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||Yr(d,re,A),d.live=!1;break;case"#":(ee||Q)&&_.tagList.push(Q?[ee,Q]:[ee]);break;case"DISCONTINUITY":b++,_.tagList.push(["DIS"]);break;case"GAP":_.gap=!0,_.tagList.push([re]);break;case"BITRATE":_.tagList.push([re,ee]),E=parseInt(ee)*1e3,pe(E)?_.bitrate=E:E=0;break;case"DATERANGE":{const G=new ht(ee,d),Y=new Db(G,d.dateRanges[G.ID],d.dateRangeTagCount);d.dateRangeTagCount++,Y.isValid||d.skippedSegments?d.dateRanges[Y.id]=Y:Ze.warn(`Ignoring invalid DATERANGE tag: "${ee}"`),_.tagList.push(["EXT-X-DATERANGE",ee]);break}case"DEFINE":{{const G=new ht(ee,d);"IMPORT"in G?YR(d,G,a):Cv(d,G,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?Yr(d,re,A):f.length>0&&Bv(d,re,A),d.startCC=b=parseInt(ee);break;case"KEY":{const G=Dv(ee,t,d);if(G.isSupported()){if(G.method==="NONE"){N=void 0;break}N||(N={});const Y=N[G.keyFormat];Y!=null&&Y.matches(G)||(Y&&(N=et({},N)),N[G.keyFormat]=G)}else Ze.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${ee}"`);break}case"START":d.startTimeOffset=Nv(ee);break;case"MAP":{const G=new ht(ee,d);if(_.duration){const Y=new Eh(s,u);Mv(Y,G,r,N),g=Y,_.initSegment=g,g.rawProgramDateTime&&!_.rawProgramDateTime&&(_.rawProgramDateTime=g.rawProgramDateTime)}else{const Y=_.byteRangeEndOffset;if(Y){const Z=_.byteRangeStartOffset;M=`${Y-Z}@${Z}`}else M=null;Mv(_,G,r,N),g=_,O=!0}g.cc=b;break}case"SERVER-CONTROL":{D&&Yr(d,re,A),D=new ht(ee),d.canBlockReload=D.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=D.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&D.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=D.optionalFloat("PART-HOLD-BACK",0),d.holdBack=D.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&Yr(d,re,A);const G=new ht(ee);d.partTarget=G.decimalFloatingPoint("PART-TARGET");break}case"PART":{let G=d.partList;G||(G=d.partList=[]);const Y=y>0?G[G.length-1]:void 0,Z=y++,j=new ht(ee,d),$=new YL(j,_,u,Z,Y);G.push($),_.duration+=$.duration;break}case"PRELOAD-HINT":{const G=new ht(ee,d);d.preloadHint=G;break}case"RENDITION-REPORT":{const G=new ht(ee,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(G);break}default:Ze.warn(`line parsed but not handled: ${A}`);break}}}T&&!T.relurl?(f.pop(),w-=T.duration,d.partList&&(d.fragmentHint=T)):d.partList&&(Bm(_,T,m),_.cc=b,d.fragmentHint=_,N&&Fv(_,N,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const B=f.length,q=f[0],ie=f[B-1];if(w+=d.skippedSegments*d.targetduration,w>0&&B&&ie){d.averagetargetduration=w/B;const te=ie.sn;d.endSN=te!=="initSegment"?te:0,d.live||(ie.endList=!0),P>0&&(d3(f,P),q&&m.unshift(q))}return d.fragmentHint&&(w+=d.fragmentHint.duration),d.totalduration=w,m.length&&d.dateRangeTagCount&&q&&Fb(m,d),d.endCC=b,d}}function Fb(n,e){let t=n.length;if(!t)if(e.hasProgramDateTime){const l=e.fragments[e.fragments.length-1];n.push(l),t++}else return;const r=n[t-1],s=e.live?1/0:e.totalduration,i=Object.keys(e.dateRanges);for(let l=i.length;l--;){const u=e.dateRanges[i[l]],d=u.startDate.getTime();u.tagAnchor=r.ref;for(let f=t;f--;){var a;if(((a=n[f])==null?void 0:a.sn)<e.startSN)break;const m=u3(e,d,n,f,s);if(m!==-1){u.tagAnchor=e.fragments[m].ref;break}}}}function u3(n,e,t,r,s){const i=t[r];if(i){const l=i.programDateTime;if(e>=l||r===0){var a;const u=(((a=t[r+1])==null?void 0:a.start)||s)-i.start;if(e<=l+u*1e3){const d=t[r].sn-n.startSN;if(d<0)return-1;const f=n.fragments;if(f.length>t.length){const g=(t[r+1]||f[f.length-1]).sn-n.startSN;for(let x=g;x>d;x--){const y=f[x].programDateTime;if(e>=y&&e<y+f[x].duration*1e3)return x}}return d}}}return-1}function Dv(n,e,t){var r,s;const i=new ht(n,t),a=(r=i.METHOD)!=null?r:"",l=i.URI,u=i.hexadecimalInteger("IV"),d=i.KEYFORMATVERSIONS,f=(s=i.KEYFORMAT)!=null?s:"identity";l&&i.IV&&!u&&Ze.error(`Invalid IV: ${i.IV}`);const m=l?kr.resolve(l,e):"",g=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Bs(a,m,f,g,u,i.KEYID)}function Nv(n){const t=new ht(n).decimalFloatingPoint("TIME-OFFSET");return pe(t)?t:null}function jv(n,e){let t=(n||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const s=t.filter(i=>$p(i,r));s.length&&(e[`${r}Codec`]=s.map(i=>i.split("/")[0]).join(","),t=t.filter(i=>s.indexOf(i)===-1))}),e.unknownCodecs=t}function Ov(n,e,t){const r=e[t];r&&(n[t]=r)}function d3(n,e){let t=n[e];for(let r=e;r--;){const s=n[r];if(!s)return;s.programDateTime=t.programDateTime-s.duration*1e3,t=s}}function Bm(n,e,t){n.rawProgramDateTime?t.push(n):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime)}function Mv(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function Fv(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&r.push(n)}function Yr(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function Bv(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Ah(n,e){const t=e.startPTS;if(pe(t)){let r=0,s;e.sn>n.sn?(r=t-n.start,s=n):(r=n.start-t,s=e),s.duration!==r&&s.setDuration(r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.setStart(n.start+(n.minEndPTS-n.start)):e.setStart(n.start+n.duration):e.setStart(Math.max(n.start-e.duration,0))}function Bb(n,e,t,r,s,i,a){r-t<=0&&(a.warn("Fragment should have a positive duration",e),r=t+e.duration,i=s+e.duration);let u=t,d=r;const f=e.startPTS,m=e.endPTS;if(pe(f)){const E=Math.abs(f-t);n&&E>n.totalduration?a.warn(`media timestamps and playlist times differ by ${E}s for level ${e.level} ${n.url}`):pe(e.deltaPTS)?e.deltaPTS=Math.max(E,e.deltaPTS):e.deltaPTS=E,u=Math.max(t,f),t=Math.min(t,f),s=e.startDTS!==void 0?Math.min(s,e.startDTS):s,d=Math.min(r,m),r=Math.max(r,m),i=e.endDTS!==void 0?Math.max(i,e.endDTS):i}const g=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=u,e.startDTS=s,e.endPTS=r,e.minEndPTS=d,e.endDTS=i;const x=e.sn;if(!n||x<n.startSN||x>n.endSN)return 0;let y;const w=x-n.startSN,b=n.fragments;for(b[w]=e,y=w;y>0;y--)Ah(b[y],b[y-1]);for(y=w;y<b.length-1;y++)Ah(b[y],b[y+1]);return n.fragmentHint&&Ah(b[b.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,g}function f3(n,e,t){if(n===e)return;let r=null;const s=n.fragments;for(let f=s.length-1;f>=0;f--){const m=s[f].initSegment;if(m){r=m;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let i;p3(n,e,(f,m,g,x)=>{if((!e.startCC||e.skippedSegments)&&m.cc!==f.cc){const y=f.cc-m.cc;for(let w=g;w<x.length;w++)x[w].cc+=y;e.endCC=x[x.length-1].cc}pe(f.startPTS)&&pe(f.endPTS)&&(m.setStart(m.startPTS=f.startPTS),m.startDTS=f.startDTS,m.maxStartPTS=f.maxStartPTS,m.endPTS=f.endPTS,m.endDTS=f.endDTS,m.minEndPTS=f.minEndPTS,m.setDuration(f.endPTS-f.startPTS),m.duration&&(i=m),e.PTSKnown=e.alignedSliding=!0),f.hasStreams&&(m.elementaryStreams=f.elementaryStreams),m.loader=f.loader,f.hasStats&&(m.stats=f.stats),f.initSegment&&(m.initSegment=f.initSegment,r=f.initSegment)});const a=e.fragments,l=e.fragmentHint?a.concat(e.fragmentHint):a;if(r&&l.forEach(f=>{var m;f&&(!f.initSegment||f.initSegment.relurl===((m=r)==null?void 0:m.relurl))&&(f.initSegment=r)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(f=>!f),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let f=e.skippedSegments;f--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=h3(n.dateRanges,e,t));const f=n.fragments.filter(m=>m.rawProgramDateTime);if(n.hasProgramDateTime&&!e.hasProgramDateTime)for(let m=1;m<l.length;m++)l[m].programDateTime===null&&Bm(l[m],l[m-1],f);Fb(f,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var u;const f=Vb(n,e.startSN-1);e.startCC=(u=f?.cc)!=null?u:a[0].cc}m3(n.partList,e.partList,(f,m)=>{m.elementaryStreams=f.elementaryStreams,m.stats=f.stats}),i?Bb(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS,t):Ub(n,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const f=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=f),e.driftEndTime=d,e.driftEnd=f}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=n.requestScheduled)}function h3(n,e,t){const{dateRanges:r,recentlyRemovedDateranges:s}=e,i=et({},n);s&&s.forEach(u=>{delete i[u]});const l=Object.keys(i).length;return l?(Object.keys(r).forEach(u=>{const d=i[u],f=new Db(r[u].attr,d);f.isValid?(i[u]=f,d||(f.tagOrder+=l)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${rt(r[u].attr)}"`)}),i):r}function m3(n,e,t){if(n&&e){let r=0;for(let s=0,i=n.length;s<=i;s++){const a=n[s],l=e[s+r];a&&l&&a.index===l.index&&a.fragment.sn===l.fragment.sn?t(a,l):r--}}}function p3(n,e,t){const r=e.skippedSegments,s=Math.max(n.startSN,e.startSN)-e.startSN,i=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,a=e.startSN-n.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let d=s;d<=i;d++){const f=u[a+d];let m=l[d];if(r&&!m&&f&&(m=e.fragments[d]=f),f&&m){t(f,m,d,l);const g=f.relurl,x=m.relurl;if(g&&g3(g,x)){e.playlistParsingError=Uv(`media sequence mismatch ${m.sn}:`,n,e,f,m);return}else if(f.cc!==m.cc){e.playlistParsingError=Uv(`discontinuity sequence mismatch (${f.cc}!=${m.cc})`,n,e,f,m);return}}}}function Uv(n,e,t,r,s){return new Error(`${n} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function Ub(n,e,t=!0){const r=e.startSN+e.skippedSegments-n.startSN,s=n.fragments,i=r>=0;let a=0;if(i&&r<s.length)a=s[r].start;else if(i&&e.startSN===n.endSN+1)a=n.fragmentEnd;else if(i&&t)a=n.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=n.fragmentStart;else return;Um(e,a)}function Um(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].addStart(e);n.fragmentHint&&n.fragmentHint.addStart(e)}}function $b(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments;if(r.length&&t*4>e){const i=r[r.length-1].duration*1e3;i<t&&(t=i)}}else t/=2;return Math.round(t)}function Vb(n,e,t){if(!n)return null;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function $v(n,e,t){return n?Gb(n.partList,e,t):null}function Gb(n,e,t){if(n)for(let r=n.length;r--;){const s=n[r];if(s.index===t&&s.fragment.sn===e)return s}return null}function Hb(n){n.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(s=>{s.level=t,s.initSegment&&(s.initSegment.level=t)})})}function g3(n,e){return n!==e&&e?Vv(n)!==Vv(e):!1}function Vv(n){return n.replace(/\?[^?]*$/,"")}function Vo(n,e){for(let r=0,s=n.length;r<s;r++){var t;if(((t=n[r])==null?void 0:t.cc)===e)return n[r]}return null}function x3(n,e){return!!(n&&e.startCC<n.endCC&&e.endCC>n.startCC)}function Gv(n,e){const t=n.start+e;n.startPTS=t,n.setStart(t),n.endPTS=t+n.duration}function Kb(n,e){const t=e.fragments;for(let r=0,s=t.length;r<s;r++)Gv(t[r],n);e.fragmentHint&&Gv(e.fragmentHint,n),e.alignedSliding=!0}function y3(n,e){n&&(zb(e,n),e.alignedSliding||Ou(e,n),!e.alignedSliding&&!e.skippedSegments&&Ub(n,e,!1))}function zb(n,e){if(!x3(e,n))return;const t=Math.min(e.endCC,n.endCC),r=Vo(e.fragments,t),s=Vo(n.fragments,t);if(!r||!s)return;Ze.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const i=r.start-s.start;Kb(i,n)}function Ou(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;let s,i;const a=Math.min(e.endCC,n.endCC);e.startCC<a&&n.startCC<a&&(s=Vo(r,a),i=Vo(t,a)),(!s||!i)&&(s=r[Math.floor(r.length/2)],i=Vo(t,s.cc)||t[Math.floor(t.length/2)]);const l=s.programDateTime,u=i.programDateTime;if(!l||!u)return;const d=(u-l)/1e3-(i.start-s.start);Kb(d,n)}function ln(n,e,t){bn(n,e,t),n.addEventListener(e,t)}function bn(n,e,t){n.removeEventListener(e,t)}const v3={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},se={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class qp extends Rb{constructor(e,t,r,s,i){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=se.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:l,media:u,mediaBuffer:d,state:f}=this,m=u?u.currentTime:0,g=Fe.bufferInfo(d||u,m,a.maxBufferHole),x=!g.len;if(this.log(`Media seeking to ${pe(m)?m.toFixed(3):m}, state: ${f}, ${x?"out of":"in"} buffer`),this.state===se.ENDED)this.resetLoadingState();else if(l){const y=a.maxFragLookUpTolerance,w=l.start-y,b=l.start+l.duration+y;if(x||b<g.start||w>g.end){const E=m>b;(m<w||E)&&(E&&l.loader&&(this.log(`Cancelling fragment load for seek (sn: ${l.sn})`),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(u){this.fragmentTracker.removeFragmentsInRange(m,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(m>y&&(this.lastCurrentTime=m),!this.loadingParts){const w=Math.max(g.end,m),b=this.shouldLoadParts(this.getLevelDetails(),w);b&&(this.log(`LL-Part loading ON after seeking to ${m.toFixed(2)} with buffer @${w.toFixed(2)}`),this.loadingParts=b)}}this.hls.hasEnoughToStart||(this.log(`Setting ${x?"startPosition":"nextLoadPosition"} to ${m} for seek without enough to start`),this.nextLoadPosition=m,x&&(this.startPosition=m)),x&&this.state===se.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=i,this.hls=e,this.fragmentLoader=new WR(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Hp(e.config)}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===se.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=se.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,s=this.config.timelineOffset||0;if(r<=s)return!1;const i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=Fe.bufferedInfo(i,e.start,0));const a=e.nextStart;if(a&&a>s&&a<t.edge||this.media.currentTime<e.start)return!1;const u=t.partList;if(u!=null&&u.length){const f=u[u.length-1];return Fe.isBuffered(this.media,f.start+f.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;ln(r,"seeking",this.onMediaSeeking),ln(r,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===se.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),bn(s,"seeking",this.onMediaSeeking),bn(s,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=se.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const s=i=>{const a=i.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(a,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(i)};this._doFragLoad(e,t,r,s).then(i=>{if(!i)return;const a=this.state,l=i.frag;if(this.fragContextChanged(l)){(a===se.FRAG_LOADING||!this.fragCurrent&&a===se.PARSING)&&(this.fragmentTracker.removeFragment(l),this.state=se.IDLE);return}"payload"in i&&(this.log(`Loaded ${l.type} sn: ${l.sn} of ${this.playlistLabel()} ${l.level}`),this.hls.trigger(C.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state===se.STOPPED||this.state===se.ERROR||(this.warn(`Frag error: ${i?.message||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===Nt.APPENDING){const i=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,i),l=Math.max(e.duration,a?a.len:this.config.maxBufferLength),u=this.backtrackFragment;((u?e.sn-u.sn:0)===1||this.reduceMaxBufferLength(l,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Nt.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:r};this.hls.trigger(C.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const s=r?.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:s}=this,{frag:i,payload:a}=r,l=i.decryptdata;if(a&&a.byteLength>0&&l!=null&&l.key&&l.iv&&ya(l.method)){const u=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),l.key.buffer,l.iv.buffer,zp(l.method)).catch(d=>{throw s.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:i}),d}).then(d=>{const f=self.performance.now();return s.trigger(C.FRAG_DECRYPTED,{frag:i,payload:d,stats:{tstart:u,tdecrypt:f}}),r.payload=d,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===se.STOPPED||this.state===se.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==se.STOPPED&&(this.state=se.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var r,s;const i=e.tracks;if(i&&!t.encrypted&&((r=i.audio)!=null&&r.encrypted||(s=i.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const a=this.media,l=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${a?"attached mediaKeys: "+a.mediaKeys:"detached"})`);return this.warn(l.message),!a||a.mediaKeys?!1:(this.hls.trigger(C.ERROR,{type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_KEYS,fatal:!1,error:l,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?v3.toString(Fe.getBuffered(r)):"(detached)"})`),kt(e)){var s;if(e.type!==ve.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(l=>!!a[l])){this.state=se.IDLE;return}}const i=(s=this.levels)==null?void 0:s[e.level];i!=null&&i.fragmentError&&(this.log(`Resetting level fragment error count of ${i.fragmentError} on frag buffered`),i.fragmentError=0)}this.state=se.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:s,partsLoaded:i}=e,a=!i||i.length===0||i.some(u=>!u),l=new Kp(r.level,r.sn,r.stats.chunkCount+1,0,s?s.index:-1,!a);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,s){var i;this.fragCurrent=e;const a=t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let l=null;if(e.encrypted&&!((i=e.decryptdata)!=null&&i.key)){if(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=se.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(g=>{if(!this.fragContextChanged(g.frag))return this.hls.trigger(C.KEY_LOADED,g),this.state===se.KEY_LOADING&&(this.state=se.IDLE),g}),this.hls.trigger(C.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(l=this.keyLoader.loadClear(e,a.encryptedFragments,this.startFragRequested),l&&this.log("[eme] blocking frag load until media-keys acquired"));const u=this.fragPrevious;if(kt(e)&&(!u||e.sn!==u.sn)){const g=this.shouldLoadParts(t.details,e.end);g!==this.loadingParts&&(this.log(`LL-Part loading ${g?"ON":"OFF"} loading sn ${u?.sn}->${e.sn}`),this.loadingParts=g)}if(r=Math.max(e.start,r||0),this.loadingParts&&kt(e)){const g=a.partList;if(g&&s){r>a.fragmentEnd&&a.fragmentHint&&(e=a.fragmentHint);const x=this.getNextPart(g,e,r);if(x>-1){const y=g[x];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${x}/${g.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=se.FRAG_LOADING;let w;return l?w=l.then(b=>!b||this.fragContextChanged(b.frag)?null:this.doFragPartsLoad(e,y,t,s)).catch(b=>this.handleFragLoadError(b)):w=this.doFragPartsLoad(e,y,t,s).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(C.FRAG_LOADING,{frag:e,part:y,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):w}else if(!e.url||this.loadedEndOfParts(g,r))return Promise.resolve(null)}}if(kt(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=a.partList)==null?void 0:d.filter(g=>g.loaded).map(g=>`[${g.start}-${g.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+a.startSN+"-"+a.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),pe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=se.FRAG_LOADING;const f=this.config.progressive&&e.type!==ve.SUBTITLE;let m;return f&&l?m=l.then(g=>!g||this.fragContextChanged(g.frag)?null:this.fragmentLoader.load(e,s)).catch(g=>this.handleFragLoadError(g)):m=Promise.all([this.fragmentLoader.load(e,f?s:void 0),l]).then(([g])=>(!f&&s&&s(g),g)).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(C.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):m}doFragPartsLoad(e,t,r,s){return new Promise((i,a)=>{var l;const u=[],d=(l=r.details)==null?void 0:l.partList,f=m=>{this.fragmentLoader.loadPart(e,m,s).then(g=>{u[m.index]=g;const x=g.part;this.hls.trigger(C.FRAG_LOADED,g);const y=$v(r.details,e.sn,m.index+1)||Gb(d,e.sn,m.index+1);if(y)f(y);else return i({frag:e,part:x,partsLoaded:u})}).catch(a)};f(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===K.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Ce.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(C.ERROR,t)}else this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==se.PARSING){!this.fragCurrent&&this.state!==se.STOPPED&&this.state!==se.ERROR&&(this.state=se.IDLE);return}const{frag:r,part:s,level:i}=t,a=self.performance.now();r.stats.parsing.end=a,s&&(s.stats.parsing.end=a);const l=this.getLevelDetails(),d=l&&r.sn>l.endSN||this.shouldLoadParts(l,r.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(r,s,i,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r;const i=e.partList[0];if(i.fragment.type===ve.SUBTITLE)return!1;const a=i.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=a){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:s,sn:i,part:a}=e;if(!(t!=null&&t[s]))return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const l=t[s],u=l.details,d=a>-1?$v(u,i,a):null,f=d?d.fragment:Vb(u,i,r);return f?(r&&r!==f&&(f.stats=r.stats),{frag:f,part:d,level:l}):null}bufferFragmentData(e,t,r,s,i){if(this.state!==se.PARSING)return;const{data1:a,data2:l}=e;let u=a;if(l&&(u=Hn(a,l)),!u.length)return;const d=this.initPTS[t.cc],f=d?-d.baseTime/d.timescale:void 0,m={type:e.type,frag:t,part:r,chunkMeta:s,offset:f,parent:t.type,data:u};if(this.hls.trigger(C.BUFFER_APPENDING,m),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Fe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,s=Fe.bufferInfo(t,r,0),i=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),l=Math.max(Math.min(e.start-a,s.end-a),r+a);e.start-l>a&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){var r;const s=this.getLoadPosition();if(!pe(s))return null;const a=this.lastCurrentTime>s||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,a)}getFwdBufferInfoAtPos(e,t,r,s){const i=Fe.bufferInfo(e,t,s);if(i.len===0&&i.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(i.nextStart<=a.end||a.gap)){const l=Math.max(Math.min(i.nextStart,a.end)-t,s);return Fe.bufferInfo(e,t,l)}}return i}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,s=Math.max(Math.min(e-t,r.maxBufferLength),t),i=Math.max(e-t*3,r.maxMaxBufferLength/2,s);return i>=s?(r.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0):!1}getAppendedFrag(e,t=ve.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,s=r.length;if(!s)return null;const{config:i}=this,a=r[0].start,l=i.lowLatencyMode&&!!t.partList;let u=null;if(t.live){const m=i.initialLiveManifestSize;if(s<m)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${m})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var d;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),u=this.getInitialLiveFragment(t);const g=this.hls.startPosition,x=this.hls.liveSyncPosition,y=u?(g!==-1&&g>=a?g:x)||u.start:e;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${g} liveSyncPosition: ${x} frag.start: ${(d=u)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=y}}else e<=a&&(u=r[0]);if(!u){const m=this.loadingParts?t.partEnd:t.fragmentEnd;u=this.getFragmentAtPosition(e,m,t)}let f=this.filterReplacedPrimary(u,t);if(!f&&u){const m=u.sn-t.startSN;f=this.filterReplacedPrimary(r[m+1]||null,t)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===Nt.OK||r===Nt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,s,i){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&r.nextStart)){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,s,0);if(l!==null&&r.len+l.len>=i){const u=a.sn;return this.loopSn!==u&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${u}`),this.loopSn=u),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(Hv(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(Hv(this.config)&&e.type!==ve.SUBTITLE){const r=this.hls.interstitialsManager,s=r?.bufferingItem;if(s){const a=s.event;if(a){if(a.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&t?.live===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const i=r?.playerQueue;if(i)for(let a=i.length;a--;){const l=i[a].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let s=-1,i=!1,a=!0;for(let l=0,u=e.length;l<u;l++){const d=e[l];if(a=a&&!d.independent,s>-1&&r<d.start)break;const f=d.loaded;f?s=-1:(i||(d.independent||a)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${d.start}`),s=l),i=f}return s}loadedEndOfParts(e,t){let r;for(let s=e.length;s--;){if(r=e[s],!r.loaded)return!1;if(t>r.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let s=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),s=jR(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){const a=t[i-e.startSN];r.cc===a.cc&&(s=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=Ab(e,r.cc,r.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const i=this.hls.liveSyncPosition;i!==null&&(s=this.getFragmentAtPosition(i,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,r){const{config:s}=this;let{fragPrevious:i}=this,{fragments:a,endSN:l}=r;const{fragmentHint:u}=r,{maxFragLookUpTolerance:d}=s,f=r.partList,m=!!(this.loadingParts&&f!=null&&f.length&&u);m&&!this.bitrateTest&&f[f.length-1].fragment.sn===u.sn&&(a=a.concat(u),l=u.sn);let g;if(e<t){var x;const w=e<this.lastCurrentTime||e>t-d||(x=this.media)!=null&&x.paused||!this.startFragRequested?0:d;g=ki(i,a,e,w)}else g=a[a.length-1];if(g){const y=g.sn-r.startSN,w=this.fragmentTracker.getState(g);if((w===Nt.OK||w===Nt.PARTIAL&&g.gap)&&(i=g),i&&g.sn===i.sn&&(!m||f[0].fragment.sn>g.sn||!r.live)&&g.level===i.level){const E=a[y+1];g.sn<l&&this.fragmentTracker.getState(E)!==Nt.OK?g=E:g=null}}return g}alignPlaylists(e,t,r){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const i=e.fragmentStart,a=!t,l=e.alignedSliding&&pe(i);if(a||!l&&!i){y3(r,e);const u=e.fragmentStart;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),u}return i}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const s=this.timelineOffset;if(r===-1){const i=this.startTimeOffset!==null,a=i?this.startTimeOffset:e.startTimeOffset;a!==null&&pe(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${a} found in ${i?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+s}this.nextLoadPosition=r+s}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&kt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==se.FRAG_LOADING_WAITING_RETRY)&&(this.state=se.IDLE)}onFragmentOrKeyLoadError(e,t){var r;if(t.chunkMeta&&!t.frag){const E=this.getCurrentContext(t.chunkMeta);E&&(t.frag=E.frag)}const s=t.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var i;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const a=t.details===K.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(s,!0);const l=t.errorAction;if(!l){this.state=se.ERROR;return}const{action:u,flags:d,retryCount:f=0,retryConfig:m}=l,g=!!m,x=g&&u===Kt.RetryRequest,y=g&&!l.resolved&&d===In.MoveAllAlternatesMatchingHost,w=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!x&&y&&kt(s)&&!s.endList&&w&&!Lb(t))this.resetFragmentErrors(e),this.treatAsGap(s),l.resolved=!0;else if((x||y)&&f<m.maxNumRetry){var b;const E=Om((b=t.response)==null?void 0:b.code),T=Gp(m,f);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+T,this.state=se.FRAG_LOADING_WAITING_RETRY,l.resolved=!0,E){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${t.details}, retrying loading ${f+1}/${m.maxNumRetry} in ${T}ms`)}else if(m)if(this.resetFragmentErrors(e),f<m.maxNumRetry)!a&&u!==Kt.RemoveAlternatePermanently&&(l.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${f})`);return}else u===Kt.SendAlternateToPenaltyBox?this.state=se.WAITING_LEVEL:this.state=se.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!Om(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=se.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===se.PARSING||this.state===se.PARSED){const t=e.frag,r=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,r),i=s&&s.len>.5;i&&this.reduceMaxBufferLength(s.len,t?.duration||10);const a=!i;return a&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===ve.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==se.STOPPED&&(this.state=se.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const s=Fe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,r),this.state===se.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==se.STOPPED&&(this.state=se.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,s){const i=r.details;if(!i){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((u,d)=>{const f=e.elementaryStreams[d];if(f){const m=f.endPTS-f.startPTS;if(m<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${m})`),u||!1;const g=s?0:Bb(i,e,f.startPTS,f.endPTS,f.startDTS,f.endDTS,this);return this.hls.trigger(C.LEVEL_PTS_UPDATED,{details:i,level:r,drift:g,type:d,frag:e,start:f.startPTS,end:f.endPTS}),!0}return u},!1)){var l;const u=((l=this.transmuxer)==null?void 0:l.error)===null;if((r.fragmentError===0||u&&(r.fragmentError<2||e.endList))&&this.treatAsGap(e,r),u){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=se.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(C.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ve.MAIN?"level":"track"}fragInfo(e,t=!0,r){var s,i;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((s=t&&!r?e.startPTS:(r||e).start)!=null?s:NaN).toFixed(3)}-${((i=t&&!r?e.endPTS:(r||e).end)!=null?i:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Hv(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}class Wb{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=w3(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function w3(n,e){const t=new Uint8Array(e);let r=0;for(let s=0;s<n.length;s++){const i=n[s];t.set(i,r),r+=i.length}return t}var Ih={exports:{}},Kv;function b3(){return Kv||(Kv=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function i(u,d,f,m,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var x=new s(f,m||u,g),y=t?t+d:d;return u._events[y]?u._events[y].fn?u._events[y]=[u._events[y],x]:u._events[y].push(x):(u._events[y]=x,u._eventsCount++),u}function a(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,m;if(this._eventsCount===0)return d;for(m in f=this._events)e.call(f,m)&&d.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=t?t+d:d,m=this._events[f];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,x=m.length,y=new Array(x);g<x;g++)y[g]=m[g].fn;return y},l.prototype.listenerCount=function(d){var f=t?t+d:d,m=this._events[f];return m?m.fn?1:m.length:0},l.prototype.emit=function(d,f,m,g,x,y){var w=t?t+d:d;if(!this._events[w])return!1;var b=this._events[w],E=arguments.length,T,_;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),E){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,f),!0;case 3:return b.fn.call(b.context,f,m),!0;case 4:return b.fn.call(b.context,f,m,g),!0;case 5:return b.fn.call(b.context,f,m,g,x),!0;case 6:return b.fn.call(b.context,f,m,g,x,y),!0}for(_=1,T=new Array(E-1);_<E;_++)T[_-1]=arguments[_];b.fn.apply(b.context,T)}else{var A=b.length,I;for(_=0;_<A;_++)switch(b[_].once&&this.removeListener(d,b[_].fn,void 0,!0),E){case 1:b[_].fn.call(b[_].context);break;case 2:b[_].fn.call(b[_].context,f);break;case 3:b[_].fn.call(b[_].context,f,m);break;case 4:b[_].fn.call(b[_].context,f,m,g);break;default:if(!T)for(I=1,T=new Array(E-1);I<E;I++)T[I-1]=arguments[I];b[_].fn.apply(b[_].context,T)}}return!0},l.prototype.on=function(d,f,m){return i(this,d,f,m,!1)},l.prototype.once=function(d,f,m){return i(this,d,f,m,!0)},l.prototype.removeListener=function(d,f,m,g){var x=t?t+d:d;if(!this._events[x])return this;if(!f)return a(this,x),this;var y=this._events[x];if(y.fn)y.fn===f&&(!g||y.once)&&(!m||y.context===m)&&a(this,x);else{for(var w=0,b=[],E=y.length;w<E;w++)(y[w].fn!==f||g&&!y[w].once||m&&y[w].context!==m)&&b.push(y[w]);b.length?this._events[x]=b.length===1?b[0]:b:a(this,x)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=t?t+d:d,this._events[f]&&a(this,f)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l})(Ih)),Ih.exports}var S3=b3(),Yp=WL(S3);const sl="1.6.15",Ca={};function E3(){return typeof __HLS_WORKER_BUNDLE__=="function"}function T3(){const n=Ca[sl];if(n)return n.clientCount++,n;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),s={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ca[sl]=s,s}function _3(n){const e=Ca[n];if(e)return e.clientCount++,e;const t=new self.URL(n,self.location.href).href,s={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ca[n]=s,s}function k3(n){const e=Ca[n||sl];if(e&&e.clientCount--===1){const{worker:r,objectURL:s}=e;delete Ca[n||sl],s&&self.URL.revokeObjectURL(s),r.terminate()}}function qb(n,e){return e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function Qp(n,e){return e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function ud(n,e){let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t}function il(n,e){const t=e;let r=0;for(;Qp(n,e);){r+=10;const s=ud(n,e+6);r+=s,qb(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)}function C3(n,e,t,r){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=e[t+2],a=i>>2&15;if(a>12){const x=new Error(`invalid ADTS sampling index:${a}`);n.emit(C.ERROR,C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!0,error:x,reason:x.message});return}const l=(i>>6&3)+1,u=e[t+3]>>6&3|(i&1)<<2,d="mp4a.40."+l,f=s[a];let m=a;(l===5||l===29)&&(m-=3);const g=[l<<3|(m&14)>>1,(m&1)<<7|u<<3];return Ze.log(`manifest codec:${r}, parsed codec:${d}, channels:${u}, rate:${f} (ADTS object type:${l} sampling index:${a})`),{config:g,samplerate:f,channelCount:u,codec:d,parsedCodec:d,manifestCodec:r}}function Yb(n,e){return n[e]===255&&(n[e+1]&246)===240}function Qb(n,e){return n[e+1]&1?7:9}function Xp(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function A3(n,e){return e+5<n.length}function Mu(n,e){return e+1<n.length&&Yb(n,e)}function I3(n,e){return A3(n,e)&&Yb(n,e)&&Xp(n,e)<=n.length-e}function L3(n,e){if(Mu(n,e)){const t=Qb(n,e);if(e+t>=n.length)return!1;const r=Xp(n,e);if(r<=t)return!1;const s=e+r;return s===n.length||Mu(n,s)}return!1}function Xb(n,e,t,r,s){if(!n.samplerate){const i=C3(e,t,r,s);if(!i)return;et(n,i)}}function Zb(n){return 1024*9e4/n}function R3(n,e){const t=Qb(n,e);if(e+t<=n.length){const r=Xp(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function Jb(n,e,t,r,s){const i=Zb(n.samplerate),a=r+s*i,l=R3(e,t);let u;if(l){const{frameLength:m,headerLength:g}=l,x=g+m,y=Math.max(0,t+x-e.length);y?(u=new Uint8Array(x-g),u.set(e.subarray(t+g,e.length),0)):u=e.subarray(t+g,t+x);const w={unit:u,pts:a};return y||n.samples.push(w),{sample:w,length:x,missing:y}}const d=e.length-t;return u=new Uint8Array(d),u.set(e.subarray(t,e.length),0),{sample:{unit:u,pts:a},length:d,missing:-1}}function P3(n,e){return Qp(n,e)&&ud(n,e+6)+10<=n.length-e}function D3(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function Lh(n,e=0,t=1/0){return N3(n,e,t,Uint8Array)}function N3(n,e,t,r){const s=j3(n);let i=1;"BYTES_PER_ELEMENT"in r&&(i=r.BYTES_PER_ELEMENT);const a=O3(n)?n.byteOffset:0,l=(a+n.byteLength)/i,u=(a+e)/i,d=Math.floor(Math.max(0,Math.min(u,l))),f=Math.floor(Math.min(d+Math.max(t,0),l));return new r(s,d,f-d)}function j3(n){return n instanceof ArrayBuffer?n:n.buffer}function O3(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function M3(n){const e={key:n.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(n.size<2)return;if(n.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=n.data.subarray(1).indexOf(0);if(r===-1)return;const s=Pn(Lh(n.data,1,r)),i=n.data[2+r],a=n.data.subarray(3+r).indexOf(0);if(a===-1)return;const l=Pn(Lh(n.data,3+r,a));let u;return s==="-->"?u=Pn(Lh(n.data,4+r+a)):u=D3(n.data.subarray(4+r+a)),e.mimeType=s,e.pictureType=i,e.description=l,e.data=u,e}function F3(n){if(n.size<2)return;const e=Pn(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}}function B3(n){if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=Pn(n.data.subarray(t),!0);t+=r.length+1;const s=Pn(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=Pn(n.data.subarray(1));return{key:n.type,info:"",data:e}}function U3(n){if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=Pn(n.data.subarray(t),!0);t+=r.length+1;const s=Pn(n.data.subarray(t));return{key:n.type,info:r,data:s}}const e=Pn(n.data);return{key:n.type,info:"",data:e}}function $3(n){return n.type==="PRIV"?F3(n):n.type[0]==="W"?U3(n):n.type==="APIC"?M3(n):B3(n)}function V3(n){const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=ud(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}}const Kc=10,G3=10;function eS(n){let e=0;const t=[];for(;Qp(n,e);){const r=ud(n,e+6);n[e+5]>>6&1&&(e+=Kc),e+=Kc;const s=e+r;for(;e+G3<s;){const i=V3(n.subarray(e)),a=$3(i);a&&t.push(a),e+=i.size+Kc}qb(n,e)&&(e+=Kc)}return t}function tS(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function H3(n){if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function Zp(n){const e=eS(n);for(let t=0;t<e.length;t++){const r=e[t];if(tS(r))return H3(r)}}let Rn=(function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n})({});function Tr(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Jp{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=Hn(this.cachedData,e),this.cachedData=null);let r=il(e,0),s=r?r.length:0,i;const a=this._audioTrack,l=this._id3Track,u=r?Zp(r):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&pe(u))&&(this.basePTS=K3(u,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Rn.audioId3,duration:Number.POSITIVE_INFINITY});s<d;){if(this.canParse(e,s)){const f=this.appendFrame(a,e,s);f?(this.frameIndex++,this.lastPTS=f.sample.pts,s+=f.length,i=s):s=d}else P3(e,s)?(r=il(e,s),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Rn.audioId3,duration:Number.POSITIVE_INFINITY}),s+=r.length,i=s):s++;if(s===d&&i!==d){const f=e.slice(i);this.cachedData?this.cachedData=Hn(this.cachedData,f):this.cachedData=f}}return{audioTrack:a,videoTrack:Tr(),id3Track:l,textTrack:Tr()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Tr(),id3Track:this._id3Track,textTrack:Tr()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const K3=(n,e,t)=>{if(pe(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let zc=null;const z3=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],W3=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],q3=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Y3=[0,1,1,4];function nS(n,e,t,r,s){if(t+24>e.length)return;const i=rS(e,t);if(i&&t+i.frameLength<=e.length){const a=i.samplesPerFrame*9e4/i.sampleRate,l=r+s*a,u={unit:e.subarray(t,t+i.frameLength),pts:l,dts:l};return n.config=[],n.channelCount=i.channelCount,n.samplerate=i.sampleRate,n.samples.push(u),{sample:u,length:i.frameLength,missing:0}}}function rS(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,s=n[e+2]>>4&15,i=n[e+2]>>2&3;if(t!==1&&s!==0&&s!==15&&i!==3){const a=n[e+2]>>1&1,l=n[e+3]>>6,u=t===3?3-r:r===3?3:4,d=z3[u*14+s-1]*1e3,m=W3[(t===3?0:t===2?1:2)*3+i],g=l===3?1:2,x=q3[t][r],y=Y3[r],w=x*8*y,b=Math.floor(x*d/m+a)*y;if(zc===null){const _=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);zc=_?parseInt(_[1]):0}return!!zc&&zc<=87&&r===2&&d>=224e3&&l===0&&(n[e+3]=n[e+3]|128),{sampleRate:m,channelCount:g,frameLength:b,samplesPerFrame:w}}}function e0(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function sS(n,e){return e+1<n.length&&e0(n,e)}function Q3(n,e){return e0(n,e)&&4<=n.length-e}function iS(n,e){if(e+1<n.length&&e0(n,e)){const r=rS(n,e);let s=4;r!=null&&r.frameLength&&(s=r.frameLength);const i=e+s;return i===n.length||sS(n,i)}return!1}class X3 extends Jp{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=il(e,0);let s=r?.length||0;if(iS(e,s))return!1;for(let i=e.length;s<i;s++)if(L3(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return I3(e,t)}appendFrame(e,t,r){Xb(e,this.observer,t,r,e.manifestCodec);const s=Jb(e,t,r,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const aS=(n,e)=>{let t=0,r=5;e+=r;const s=new Uint32Array(1),i=new Uint32Array(1),a=new Uint8Array(1);for(;r>0;){a[0]=n[e];const l=Math.min(r,8),u=8-l;i[0]=4278190080>>>24+u<<u,s[0]=(a[0]&i[0])>>u,t=t?t<<l|s[0]:s[0],e+=1,r-=l}return t};class Z3 extends Jp{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const s=oS(e,t,r,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const t=il(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&Zp(t)!==void 0&&aS(e,r)<16}}function oS(n,e,t,r,s){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const i=e[t+4]>>6;if(i>=3)return-1;const l=[48e3,44100,32e3][i],u=e[t+4]&63,f=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][u*3+i]*2;if(t+f>e.length)return-1;const m=e[t+6]>>5;let g=0;m===2?g+=2:(m&1&&m!==1&&(g+=2),m&4&&(g+=2));const x=(e[t+6]<<8|e[t+7])>>12-g&1,w=[2,1,2,3,3,4,4,5][m]+x,b=e[t+5]>>3,E=e[t+5]&7,T=new Uint8Array([i<<6|b<<1|E>>2,(E&3)<<6|m<<3|x<<2|u>>4,u<<4&224]),_=1536/l*9e4,A=r+s*_,I=e.subarray(t,t+f);return n.config=T,n.channelCount=w,n.samplerate=l,n.samples.push({unit:I,pts:A}),f}class J3 extends Jp{resetInitSegment(e,t,r,s){super.resetInitSegment(e,t,r,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=il(e,0);let r=t?.length||0;if(t&&e[r]===11&&e[r+1]===119&&Zp(t)!==void 0&&aS(e,r)<=16)return!1;for(let s=e.length;r<s;r++)if(iS(e,r))return Ze.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Q3(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return nS(e,t,r,this.basePTS,this.frameIndex)}}const eP=/\/emsg[-/]ID3/i;class tP{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,s){const i=this.videoTrack=Tr("video",1),a=this.audioTrack=Tr("audio",1),l=this.txtTrack=Tr("text",1);if(this.id3Track=Tr("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const u=xb(e);if(u.video){const{id:d,timescale:f,codec:m,supplemental:g}=u.video;i.id=d,i.timescale=l.timescale=f,i.codec=m,i.supplemental=g}if(u.audio){const{id:d,timescale:f,codec:m}=u.audio;a.id=d,a.timescale=f,a.codec=m}l.id=mb.text,i.sampleDuration=0,i.duration=a.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return ZL(e)}demux(e,t){this.timeOffset=t;let r=e;const s=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Hn(this.remainderData,e));const l=iR(r);this.remainderData=l.remainder,s.samples=l.valid||new Uint8Array}else s.samples=r;const a=this.extractID3Track(s,t);return i.samples=cv(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return r.samples=cv(e,t),{videoTrack:t,audioTrack:Tr(),id3Track:s,textTrack:Tr()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const s=$e(e.samples,["emsg"]);s&&s.forEach(i=>{const a=oR(i);if(eP.test(a.schemeIdUri)){const l=zv(a,t);let u=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;u<=.001&&(u=Number.POSITIVE_INFINITY);const d=a.payload;r.samples.push({data:d,len:d.byteLength,dts:l,pts:l,type:Rn.emsg,duration:u})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const l=zv(a,t);r.samples.push({data:a.payload,len:a.payload.byteLength,dts:l,pts:l,type:Rn.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function zv(n,e){return pe(n.presentationTime)?n.presentationTime/n.timeScale:e+n.presentationTimeDelta/n.timeScale}class nP{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Hp(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Vs.cbc)}decryptAacSample(e,t,r){const s=e[t].unit;if(s.length<=16)return;const i=s.subarray(16,s.length-s.length%16),a=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(a).then(l=>{const u=new Uint8Array(l);s.set(u,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}).catch(r)}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)r.set(e.subarray(i,i+16),s);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)e.set(r.subarray(s,s+16),i);return e}decryptAvcSample(e,t,r,s,i){const a=wb(i.data),l=this.getAvcEncryptedData(a);this.decryptBuffer(l.buffer).then(u=>{i.data=this.getAvcDecryptedUnit(a,u),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,s)}).catch(s)}decryptAvcSamples(e,t,r,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){s();return}const i=e[t].units;for(;!(r>=i.length);r++){const a=i[r];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,r,s,a),!this.decrypter.isSync()))return}}}}class lS{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,s;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const i=r.units;s=i[i.length-1]}return s}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,s=r.length;if(s){const i=r[s-1];e.pts=i.pts,e.dts=i.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const s=t.byteLength;let i=e.naluState||0;const a=i,l=[];let u=0,d,f,m,g=-1,x=0;for(i===-1&&(g=0,x=this.getNALuType(t,0),i=0,u=1);u<s;){if(d=t[u++],!i){i=d?0:1;continue}if(i===1){i=d?0:2;continue}if(!d)i=3;else if(d===1){if(f=u-i-1,g>=0){const y={data:t.subarray(g,f),type:x};l.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(a&&u<=4-a&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-a)),f>0&&(y.data=Hn(y.data,t.subarray(0,f)),y.state=0))}u<s?(m=this.getNALuType(t,u),g=u,x=m,i=0):i=-1}else i=0}if(g>=0&&i>=0){const y={data:t.subarray(g,s),type:x,state:i};l.push(y)}if(l.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=Hn(y.data,t))}return e.naluState=i,l}}class Go{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,s=new Uint8Array(4),i=Math.min(4,t);if(i===0)throw new Error("no bytes available");s.set(e.subarray(r,r+i)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&Ze.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class rP extends lS{parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let a=this.VideoSample,l,u=!1;r.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(d=>{var f,m;switch(d.type){case 1:{let w=!1;l=!0;const b=d.data;if(u&&b.length>4){const E=this.readSliceType(b);(E===2||E===4||E===7||E===9)&&(w=!0)}if(w){var g;(g=a)!=null&&g.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.frame=!0,a.key=w;break}case 5:l=!0,(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 6:{l=!0,Up(d.data,1,r.pts,t.samples);break}case 7:{var x,y;l=!0,u=!0;const w=d.data,b=this.readSPS(w);if(!e.sps||e.width!==b.width||e.height!==b.height||((x=e.pixelRatio)==null?void 0:x[0])!==b.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[w];const E=w.subarray(1,4);let T="avc1.";for(let _=0;_<3;_++){let A=E[_].toString(16);A.length<2&&(A="0"+A),T+=A}e.codec=T}break}case 8:l=!0,e.pps=[d.data];break;case 9:l=!0,e.audFound=!0,(m=a)!=null&&m.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:l=!0;break;default:l=!1;break}a&&l&&a.units.push(d)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Go(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,s=8,i;for(let a=0;a<e;a++)s!==0&&(i=t.readEG(),s=(r+i+256)%256),r=s===0?r:s}readSPS(e){const t=new Go(e);let r=0,s=0,i=0,a=0,l,u,d;const f=t.readUByte.bind(t),m=t.readBits.bind(t),g=t.readUEG.bind(t),x=t.readBoolean.bind(t),y=t.skipBits.bind(t),w=t.skipEG.bind(t),b=t.skipUEG.bind(t),E=this.skipScalingList.bind(this);f();const T=f();if(m(5),y(3),f(),b(),T===100||T===110||T===122||T===244||T===44||T===83||T===86||T===118||T===128){const O=g();if(O===3&&y(1),b(),b(),y(1),x())for(u=O!==3?8:12,d=0;d<u;d++)x()&&(d<6?E(16,t):E(64,t))}b();const _=g();if(_===0)g();else if(_===1)for(y(1),w(),w(),l=g(),d=0;d<l;d++)w();b(),y(1);const A=g(),I=g(),N=m(1);N===0&&y(1),y(1),x()&&(r=g(),s=g(),i=g(),a=g());let P=[1,1];if(x()&&x())switch(f()){case 1:P=[1,1];break;case 2:P=[12,11];break;case 3:P=[10,11];break;case 4:P=[16,11];break;case 5:P=[40,33];break;case 6:P=[24,11];break;case 7:P=[20,11];break;case 8:P=[32,11];break;case 9:P=[80,33];break;case 10:P=[18,11];break;case 11:P=[15,11];break;case 12:P=[64,33];break;case 13:P=[160,99];break;case 14:P=[4,3];break;case 15:P=[3,2];break;case 16:P=[2,1];break;case 255:{P=[f()<<8|f(),f()<<8|f()];break}}return{width:Math.ceil((A+1)*16-r*2-s*2),height:(2-N)*(I+1)*16-(N?2:4)*(i+a),pixelRatio:P}}}class sP extends lS{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,s){const i=this.parseNALu(e,r.data,s);let a=this.VideoSample,l,u=!1;r.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach(d=>{var f,m;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.frame=!0,l=!0;break;case 16:case 17:case 18:case 21:if(l=!0,u){var g;(g=a)!=null&&g.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:l=!0,(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0,a.frame=!0;break;case 39:l=!0,Up(d.data,2,r.pts,t.samples);break;case 32:l=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=et(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(l=!0,u=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const x=this.readSPS(d.data);e.width=x.width,e.height=x.height,e.pixelRatio=x.pixelRatio,e.codec=x.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const y in x.params)e.params[y]=x.params[y]}this.pushParameterSet(e.sps,d.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),a.key=!0;break;case 34:if(l=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const x=this.readPPS(d.data);for(const y in x)e.params[y]=x[y]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:l=!0,e.audFound=!0,(m=a)!=null&&m.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:l=!1;break}a&&l&&a.units.push(d)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(t[r]=e[s],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Go(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),s=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:s}}readSPS(e){const t=new Go(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const s=t.readBits(2),i=t.readBoolean(),a=t.readBits(5),l=t.readUByte(),u=t.readUByte(),d=t.readUByte(),f=t.readUByte(),m=t.readUByte(),g=t.readUByte(),x=t.readUByte(),y=t.readUByte(),w=t.readUByte(),b=t.readUByte(),E=t.readUByte(),T=[],_=[];for(let we=0;we<r;we++)T.push(t.readBoolean()),_.push(t.readBoolean());if(r>0)for(let we=r;we<8;we++)t.readBits(2);for(let we=0;we<r;we++)T[we]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),_[we]&&t.readUByte();t.readUEG();const A=t.readUEG();A==3&&t.skipBits(1);const I=t.readUEG(),N=t.readUEG(),P=t.readBoolean();let O=0,M=0,D=0,B=0;P&&(O+=t.readUEG(),M+=t.readUEG(),D+=t.readUEG(),B+=t.readUEG());const q=t.readUEG(),ie=t.readUEG(),te=t.readUEG(),re=t.readBoolean();for(let we=re?0:r;we<=r;we++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Ue=0;Ue<4;Ue++)for(let Je=0;Je<(Ue===3?2:6);Je++)if(!t.readBoolean())t.readUEG();else{const Et=Math.min(64,1<<4+(Ue<<1));Ue>1&&t.readEG();for(let nn=0;nn<Et;nn++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const G=t.readUEG();let Y=0;for(let we=0;we<G;we++){let Ue=!1;if(we!==0&&(Ue=t.readBoolean()),Ue){we===G&&t.readUEG(),t.readBoolean(),t.readUEG();let Je=0;for(let Yt=0;Yt<=Y;Yt++){const Et=t.readBoolean();let nn=!1;Et||(nn=t.readBoolean()),(Et||nn)&&Je++}Y=Je}else{const Je=t.readUEG(),Yt=t.readUEG();Y=Je+Yt;for(let Et=0;Et<Je;Et++)t.readUEG(),t.readBoolean();for(let Et=0;Et<Yt;Et++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const we=t.readUEG();for(let Ue=0;Ue<we;Ue++){for(let Je=0;Je<te+4;Je++)t.readBits(1);t.readBits(1)}}let j=0,$=1,fe=1,ne=!0,ae=1,ce=0;t.readBoolean(),t.readBoolean();let _e=!1;if(t.readBoolean()){if(t.readBoolean()){const En=t.readUByte(),Fr=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ls=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];En>0&&En<16?($=Fr[En-1],fe=ls[En-1]):En===255&&($=t.readBits(16),fe=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),_e=t.readBoolean(),_e&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ae=t.readBits(32),ce=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const ls=t.readBoolean(),cs=t.readBoolean();let Br=!1;(ls||cs)&&(Br=t.readBoolean(),Br&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Br&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let us=0;us<=r;us++){ne=t.readBoolean();const Ur=ne||t.readBoolean();let ds=!1;Ur?t.readEG():ds=t.readBoolean();const dr=ds?1:t.readUEG()+1;if(ls)for(let rn=0;rn<dr;rn++)t.readUEG(),t.readUEG(),Br&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(cs)for(let rn=0;rn<dr;rn++)t.readUEG(),t.readUEG(),Br&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),j=t.readUEG())}let Le=I,oe=N;if(P){let we=1,Ue=1;A===1?we=Ue=2:A==2&&(we=2),Le=I-we*M-we*O,oe=N-Ue*B-Ue*D}const Re=s?["A","B","C"][s]:"",We=l<<24|u<<16|d<<8|f;let ge=0;for(let we=0;we<32;we++)ge=(ge|(We>>we&1)<<31-we)>>>0;let Ie=ge.toString(16);return a===1&&Ie==="2"&&(Ie="6"),{codecString:`hvc1.${Re}${a}.${Ie}.${i?"H":"L"}${E}.B0`,params:{general_tier_flag:i,general_profile_idc:a,general_profile_space:s,general_profile_compatibility_flags:[l,u,d,f],general_constraint_indicator_flags:[m,g,x,y,w,b],general_level_idc:E,bit_depth:q+8,bit_depth_luma_minus8:q,bit_depth_chroma_minus8:ie,min_spatial_segmentation_idc:j,chroma_format_idc:A,frame_rate:{fixed:ne,fps:ce/ae}},width:Le,height:oe,pixelRatio:[$,fe]}}readPPS(e){const t=new Go(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const s=t.readBoolean(),i=t.readBoolean();let a=1;return i&&s?a=0:i?a=3:s&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Ut=188;class js{constructor(e,t,r,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=s,this.videoParser=null}static probe(e,t){const r=js.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Ut*5,t-Ut)+1,s=0;for(;s<r;){let i=!1,a=-1,l=0;for(let u=s;u<t;u+=Ut)if(e[u]===71&&(t-u===Ut||e[u+Ut]===71)){if(l++,a===-1&&(a=u,a!==0&&(r=Math.min(a+Ut*99,e.length-Ut)+1)),i||(i=$m(e,u)===0),i&&l>1&&(a===0&&l>2||u+Ut>r))return a}else{if(l)return-1;break}s++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:mb[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=js.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=js.createTrack("audio",s),this._id3Track=js.createTrack("id3"),this._txtTrack=js.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,s=!1){r||(this.sampleAes=null);let i;const a=this._videoTrack,l=this._audioTrack,u=this._id3Track,d=this._txtTrack;let f=a.pid,m=a.pesData,g=l.pid,x=u.pid,y=l.pesData,w=u.pesData,b=null,E=this.pmtParsed,T=this._pmtId,_=e.length;if(this.remainderData&&(e=Hn(this.remainderData,e),_=e.length,this.remainderData=null),_<Ut&&!s)return this.remainderData=e,{audioTrack:l,videoTrack:a,id3Track:u,textTrack:d};const A=Math.max(0,js.syncOffset(e));_-=(_-A)%Ut,_<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,_,e.buffer.byteLength-_));let I=0;for(let P=A;P<_;P+=Ut)if(e[P]===71){const O=!!(e[P+1]&64),M=$m(e,P),D=(e[P+3]&48)>>4;let B;if(D>1){if(B=P+5+e[P+4],B===P+Ut)continue}else B=P+4;switch(M){case f:O&&(m&&(i=aa(m,this.logger))&&(this.readyVideoParser(a.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(a,d,i,!1)),m={data:[],size:0}),m&&(m.data.push(e.subarray(B,P+Ut)),m.size+=P+Ut-B);break;case g:if(O){if(y&&(i=aa(y,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,i);break;case"mp3":this.parseMPEGPES(l,i);break;case"ac3":this.parseAC3PES(l,i);break}y={data:[],size:0}}y&&(y.data.push(e.subarray(B,P+Ut)),y.size+=P+Ut-B);break;case x:O&&(w&&(i=aa(w,this.logger))&&this.parseID3PES(u,i),w={data:[],size:0}),w&&(w.data.push(e.subarray(B,P+Ut)),w.size+=P+Ut-B);break;case 0:O&&(B+=e[B]+1),T=this._pmtId=iP(e,B);break;case T:{O&&(B+=e[B]+1);const q=aP(e,B,this.typeSupported,r,this.observer,this.logger);f=q.videoPid,f>0&&(a.pid=f,a.segmentCodec=q.segmentVideoCodec),g=q.audioPid,g>0&&(l.pid=g,l.segmentCodec=q.segmentAudioCodec),x=q.id3Pid,x>0&&(u.pid=x),b!==null&&!E&&(this.logger.warn(`MPEG-TS PMT found at ${P} after unknown PID '${b}'. Backtracking to sync byte @${A} to parse all TS packets.`),b=null,P=A-188),E=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=M;break}}else I++;I>0&&Vm(this.observer,new Error(`Found ${I} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=m,l.pesData=y,u.pesData=w;const N={audioTrack:l,videoTrack:a,id3Track:u,textTrack:d};return s&&this.extractRemainingSamples(N),N}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:s,textTrack:i}=e,a=r.pesData,l=t.pesData,u=s.pesData;let d;if(a&&(d=aa(a,this.logger))?(this.readyVideoParser(r.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(r,i,d,!0),r.pesData=null)):r.pesData=a,l&&(d=aa(l,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else l!=null&&l.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=l;u&&(d=aa(u,this.logger))?(this.parseID3PES(s,d),s.pesData=null):s.pesData=u}demuxSampleAes(e,t,r){const s=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new nP(this.observer,this.config,t);return this.decrypt(s,i)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new rP:e==="hevc"&&(this.videoParser=new sP))}decrypt(e,t){return new Promise(r=>{const{audioTrack:s,videoTrack:i}=e;s.samples&&s.segmentCodec==="aac"?t.decryptAacSamples(s.samples,0,()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,()=>{r(e)}):r(e)}):i.samples&&t.decryptAvcSamples(i.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const s=this.aacOverFlow;let i=t.data;if(s){this.aacOverFlow=null;const m=s.missing,g=s.sample.unit.byteLength;if(m===-1)i=Hn(s.sample.unit,i);else{const x=g-m;s.sample.unit.set(i.subarray(0,m),x),e.samples.push(s.sample),r=s.missing}}let a,l;for(a=r,l=i.length;a<l-1&&!Mu(i,a);a++);if(a!==r){let m;const g=a<l-1;if(g?m=`AAC PES did not start with ADTS header,offset:${a}`:m="No ADTS header found in AAC PES",Vm(this.observer,new Error(m),g,this.logger),!g)return}Xb(e,this.observer,i,a,this.audioCodec);let u;if(t.pts!==void 0)u=t.pts;else if(s){const m=Zb(e.samplerate);u=s.sample.pts+m}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,f;for(;a<l;)if(f=Jb(e,i,a,u,d),a+=f.length,f.missing){this.aacOverFlow=f;break}else for(d++;a<l-1&&!Mu(i,a);a++);}parseMPEGPES(e,t){const r=t.data,s=r.length;let i=0,a=0;const l=t.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<s;)if(sS(r,a)){const u=nS(e,r,a,l,i);if(u)a+=u.length,i++;else break}else a++}parseAC3PES(e,t){{const r=t.data,s=t.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const i=r.length;let a=0,l=0,u;for(;l<i&&(u=oS(e,r,l,s,a++))>0;)l+=u}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=et({},t,{type:this._videoTrack?Rn.emsg:Rn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function $m(n,e){return((n[e+1]&31)<<8)+n[e+2]}function iP(n,e){return(n[e+10]&31)<<8|n[e+11]}function aP(n,e,t,r,s,i){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(n[e+1]&15)<<8|n[e+2],u=e+3+l-4,d=(n[e+10]&15)<<8|n[e+11];for(e+=12+d;e<u;){const f=$m(n,e),m=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!r){Rh("ADTS AAC",i);break}case 15:a.audioPid===-1&&(a.audioPid=f);break;case 21:a.id3Pid===-1&&(a.id3Pid=f);break;case 219:if(!r){Rh("H.264",i);break}case 27:a.videoPid===-1&&(a.videoPid=f);break;case 3:case 4:!t.mpeg&&!t.mp3?i.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=f,a.segmentAudioCodec="mp3");break;case 193:if(!r){Rh("AC-3",i);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=f,a.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&m>0){let g=e+5,x=m;for(;x>2;){switch(n[g]){case 106:t.ac3!==!0?i.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=f,a.segmentAudioCodec="ac3");break}const w=n[g+1]+2;g+=w,x-=w}}break;case 194:case 135:return Vm(s,new Error("Unsupported EC-3 in M2TS found"),void 0,i),a;case 36:a.videoPid===-1&&(a.videoPid=f,a.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"));break}e+=m+5}return a}function Vm(n,e,t,r){r.warn(`parsing error: ${e.message}`),n.emit(C.ERROR,C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Rh(n,e){e.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function aa(n,e){let t=0,r,s,i,a,l;const u=n.data;if(!n||n.size===0)return null;for(;u[0].length<19&&u.length>1;)u[0]=Hn(u[0],u[1]),u.splice(1,1);if(r=u[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(s=(r[4]<<8)+r[5],s&&s>n.size-6)return null;const f=r[7];f&192&&(a=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,f&64?(l=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,a-l>60*9e4&&(e.warn(`${Math.round((a-l)/9e4)}s delta between PTS and DTS, align them`),a=l)):l=a),i=r[8];let m=i+9;if(n.size<=m)return null;n.size-=m;const g=new Uint8Array(n.size);for(let x=0,y=u.length;x<y;x++){r=u[x];let w=r.byteLength;if(m)if(m>w){m-=w;continue}else r=r.subarray(m),w-=m,m=0;g.set(r,t),t+=w}return s&&(s-=i+3),{data:g,pts:a,dts:l,len:s}}return null}class oP{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Rs=Math.pow(2,32)-1;class H{static init(){H.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in H.types)H.types.hasOwnProperty(e)&&(H.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);H.HDLR_TYPES={video:t,audio:r};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);H.STTS=H.STSC=H.STCO=i,H.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),H.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),H.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),H.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);H.FTYP=H.box(H.types.ftyp,a,u,a,l),H.DINF=H.box(H.types.dinf,H.box(H.types.dref,s))}static box(e,...t){let r=8,s=t.length;const i=s;for(;s--;)r+=t[s].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(e,4),s=0,r=8;s<i;s++)a.set(t[s],r),r+=t[s].byteLength;return a}static hdlr(e){return H.box(H.types.hdlr,H.HDLR_TYPES[e])}static mdat(e){return H.box(H.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(Rs+1)),s=Math.floor(t%(Rs+1));return H.box(H.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return H.box(H.types.mdia,H.mdhd(e.timescale||0,e.duration||0),H.hdlr(e.type),H.minf(e))}static mfhd(e){return H.box(H.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?H.box(H.types.minf,H.box(H.types.smhd,H.SMHD),H.DINF,H.stbl(e)):H.box(H.types.minf,H.box(H.types.vmhd,H.VMHD),H.DINF,H.stbl(e))}static moof(e,t,r){return H.box(H.types.moof,H.mfhd(e),H.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=H.trak(e[t]);return H.box.apply(null,[H.types.moov,H.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(H.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=H.trex(e[t]);return H.box.apply(null,[H.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(Rs+1)),s=Math.floor(t%(Rs+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return H.box(H.types.mvhd,i)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let s,i;for(s=0;s<t.length;s++)i=t[s].flags,r[s+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return H.box(H.types.sdtp,r)}static stbl(e){return H.box(H.types.stbl,H.stsd(e),H.box(H.types.stts,H.STTS),H.box(H.types.stsc,H.STSC),H.box(H.types.stsz,H.STSZ),H.box(H.types.stco,H.STCO))}static avc1(e){let t=[],r=[],s,i,a;for(s=0;s<e.sps.length;s++)i=e.sps[s],a=i.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(i));for(s=0;s<e.pps.length;s++)i=e.pps[s],a=i.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(i));const l=H.box(H.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),u=e.width,d=e.height,f=e.pixelRatio[0],m=e.pixelRatio[1];return H.box(H.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,H.box(H.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),H.box(H.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,m>>24,m>>16&255,m>>8&255,m&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return H.box(H.types.mp4a,H.audioStsd(e),H.box(H.types.esds,H.esds(e)))}static mp3(e){return H.box(H.types[".mp3"],H.audioStsd(e))}static ac3(e){return H.box(H.types["ac-3"],H.audioStsd(e),H.box(H.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return H.box(H.types.stsd,H.STSD,H.mp4a(e));if(t==="ac3"&&e.config)return H.box(H.types.stsd,H.STSD,H.ac3(e));if(t==="mp3"&&e.codec==="mp3")return H.box(H.types.stsd,H.STSD,H.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return H.box(H.types.stsd,H.STSD,H.avc1(e));if(t==="hevc"&&e.vps)return H.box(H.types.stsd,H.STSD,H.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),s=e.width||0,i=e.height||0,a=Math.floor(r/(Rs+1)),l=Math.floor(r%(Rs+1));return H.box(H.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,i>>8&255,i&255,0,0]))}static traf(e,t){const r=H.sdtp(e),s=e.id,i=Math.floor(t/(Rs+1)),a=Math.floor(t%(Rs+1));return H.box(H.types.traf,H.box(H.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),H.box(H.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,a>>24,a>>16&255,a>>8&255,a&255])),H.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,H.box(H.types.trak,H.tkhd(e),H.mdia(e))}static trex(e){const t=e.id;return H.box(H.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],s=r.length,i=12+16*s,a=new Uint8Array(i);let l,u,d,f,m,g;for(t+=8+i,a.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),l=0;l<s;l++)u=r[l],d=u.duration,f=u.size,m=u.flags,g=u.cts,a.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,m.isLeading<<2|m.dependsOn,m.isDependedOn<<6|m.hasRedundancy<<4|m.paddingValue<<1|m.isNonSync,m.degradPrio&61440,m.degradPrio&15,g>>>24&255,g>>>16&255,g>>>8&255,g&255],12+16*l);return H.box(H.types.trun,a)}static initSegment(e){H.types||H.init();const t=H.moov(e);return Hn(H.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],s=4,i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),s-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let a=i.length;for(let y=0;y<r.length;y+=1){a+=3;for(let w=0;w<r[y].length;w+=1)a+=2+r[y][w].length}const l=new Uint8Array(a);l.set(i,0),a=i.length;const u=r.length-1;for(let y=0;y<r.length;y+=1){l.set(new Uint8Array([32+y|(y===u?128:0),0,r[y].length]),a),a+=3;for(let w=0;w<r[y].length;w+=1)l.set(new Uint8Array([r[y][w].length>>8,r[y][w].length&255]),a),a+=2,l.set(r[y][w],a),a+=r[y][w].length}const d=H.box(H.types.hvcC,l),f=e.width,m=e.height,g=e.pixelRatio[0],x=e.pixelRatio[1];return H.box(H.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,H.box(H.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),H.box(H.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,x>>24,x>>16&255,x>>8&255,x&255])))}}H.types=void 0;H.HDLR_TYPES=void 0;H.STTS=void 0;H.STSC=void 0;H.STCO=void 0;H.STSZ=void 0;H.VMHD=void 0;H.SMHD=void 0;H.STSD=void 0;H.FTYP=void 0;H.DINF=void 0;const cS=9e4;function t0(n,e,t=1,r=!1){const s=n*e*t;return r?Math.round(s):s}function lP(n,e,t=1,r=!1){return t0(n,e,1/t,r)}function Po(n,e=!1){return t0(n,1e3,1/cS,e)}function cP(n,e=1){return t0(n,cS,1/e)}function Wv(n){const{baseTime:e,timescale:t,trackId:r}=n;return`${e/t} (${e}/${t}) trackId: ${r}`}const uP=10*1e3,dP=1024,fP=1152,hP=1536;let oa=null,Ph=null;function qv(n,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class gu extends zn{constructor(e,t,r,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,oa===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);oa=a?parseInt(a[1]):0}if(Ph===null){const i=navigator.userAgent.match(/Safari\/(\d+)/i);Ph=i?parseInt(i[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&Wv(t)} > ${e&&Wv(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,s=e.reduce((i,a)=>{let l=a.pts,u=l-i;return u<-4294967296&&(t=!0,l=Ln(l,r),u=l-i),u>0?i:l},r);return t&&this.debug("PTS rollover detected"),s}remux(e,t,r,s,i,a,l,u){let d,f,m,g,x,y,w=i,b=i;const E=e.pid>-1,T=t.pid>-1,_=t.samples.length,A=e.samples.length>0,I=l&&_>0||_>1;if((!E||A)&&(!T||I)||this.ISGenerated||l){if(this.ISGenerated){var P,O,M,D;const te=this.videoTrackConfig;(te&&(t.width!==te.width||t.height!==te.height||((P=t.pixelRatio)==null?void 0:P[0])!==((O=te.pixelRatio)==null?void 0:O[0])||((M=t.pixelRatio)==null?void 0:M[1])!==((D=te.pixelRatio)==null?void 0:D[1]))||!te&&I||this.nextAudioTs===null&&A)&&this.resetInitSegment()}this.ISGenerated||(m=this.generateIS(e,t,i,a));const B=this.isVideoContiguous;let q=-1,ie;if(I&&(q=mP(t.samples),!B&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,q>0){this.warn(`Dropped ${q} out of ${_} video samples due to a missing keyframe`);const te=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(q),t.dropped+=q,b+=(t.samples[0].pts-te)/t.inputTimeScale,ie=b}else q===-1&&(this.warn(`No keyframe found out of ${_} video samples`),y=!1);if(this.ISGenerated){if(A&&I){const te=this.getVideoStartPts(t.samples),ee=(Ln(e.samples[0].pts,te)-te)/t.inputTimeScale;w+=Math.max(0,ee),b+=Math.max(0,-ee)}if(A){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),m=this.generateIS(e,t,i,a)),f=this.remuxAudio(e,w,this.isAudioContiguous,a,T||I||u===ve.AUDIO?b:void 0),I){const te=f?f.endPTS-f.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),m=this.generateIS(e,t,i,a)),d=this.remuxVideo(t,b,B,te)}}else I&&(d=this.remuxVideo(t,b,B,0));d&&(d.firstKeyFrame=q,d.independent=q!==-1,d.firstKeyFramePTS=ie)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(x=uS(r,i,this._initPTS,this._initDTS)),s.samples.length&&(g=dS(s,i,this._initPTS))),{audio:f,video:d,initSegment:m,independent:y,text:g,id3:x}}computeInitPts(e,t,r,s){const i=Math.round(r*t);let a=Ln(e,i);if(a<i+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(i-a)/t} ${s}`);a<i+t;)a+=8589934592;return a-i}generateIS(e,t,r,s){const i=e.samples,a=t.samples,l=this.typeSupported,u={},d=this._initPTS;let f=!d||s,m="audio/mp4",g,x,y,w=-1;if(f&&(g=x=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(m="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}u.audio={id:"audio",container:m,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):H.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(w=e.id,y=e.inputTimeScale,!d||y!==d.timescale?g=x=this.computeInitPts(i[0].pts,y,r,"audio"):f=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:H.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(w=t.id,y=t.inputTimeScale,!d||y!==d.timescale){const b=this.getVideoStartPts(a),E=Ln(a[0].dts,b),T=this.computeInitPts(E,y,r,"video"),_=this.computeInitPts(b,y,r,"video");x=Math.min(x,T),g=Math.min(g,_)}else f=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(u).length)return this.ISGenerated=!0,f?(d&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${r} ${g/y} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${g/y} (${g}/${y}) trackId: ${w}`),this._initPTS={baseTime:g,timescale:y,trackId:w},this._initDTS={baseTime:x,timescale:y,trackId:w}):g=y=void 0,{tracks:u,initPTS:g,timescale:y,trackId:w}}remuxVideo(e,t,r,s){const i=e.inputTimeScale,a=e.samples,l=[],u=a.length,d=this._initPTS,f=d.baseTime*i/d.timescale;let m=this.nextVideoTs,g=8,x=this.videoSampleDuration,y,w,b=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,T=!1;if(!r||m===null){const j=f+t*i,$=a[0].pts-Ln(a[0].dts,a[0].pts);oa&&m!==null&&Math.abs(j-$-(m+f))<15e3?r=!0:m=j-$-f}const _=m+f;for(let j=0;j<u;j++){const $=a[j];$.pts=Ln($.pts,_),$.dts=Ln($.dts,_),$.dts<a[j>0?j-1:j].dts&&(T=!0)}T&&a.sort(function(j,$){const fe=j.dts-$.dts,ne=j.pts-$.pts;return fe||ne}),y=a[0].dts,w=a[a.length-1].dts;const A=w-y,I=A?Math.round(A/(u-1)):x||e.inputTimeScale/30;if(r){const j=y-_,$=j>I,fe=j<-1;if(($||fe)&&($?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Po(j,!0)} ms (${j}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Po(-j,!0)} ms (${j}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!fe||_>=a[0].pts||oa)){y=_;const ne=a[0].pts-j;if($)a[0].dts=y,a[0].pts=ne;else{let ae=!0;for(let ce=0;ce<a.length&&!(a[ce].dts>ne&&ae);ce++){const _e=a[ce].pts;if(a[ce].dts-=j,a[ce].pts-=j,ce<a.length-1){const Ee=a[ce+1].pts,Le=a[ce].pts,oe=Ee<=Le,Re=Ee<=_e;ae=oe==Re}}}this.log(`Video: Initial PTS/DTS adjusted: ${Po(ne,!0)}/${Po(y,!0)}, delta: ${Po(j,!0)} ms`)}}y=Math.max(0,y);let N=0,P=0,O=y;for(let j=0;j<u;j++){const $=a[j],fe=$.units,ne=fe.length;let ae=0;for(let ce=0;ce<ne;ce++)ae+=fe[ce].data.length;P+=ae,N+=ne,$.length=ae,$.dts<O?($.dts=O,O+=I/4|0||1):O=$.dts,b=Math.min($.pts,b),E=Math.max($.pts,E)}w=a[u-1].dts;const M=P+4*N+8;let D;try{D=new Uint8Array(M)}catch(j){this.observer.emit(C.ERROR,C.ERROR,{type:Ce.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:j,bytes:M,reason:`fail allocating video mdat ${M}`});return}const B=new DataView(D.buffer);B.setUint32(0,M),D.set(H.types.mdat,4);let q=!1,ie=Number.POSITIVE_INFINITY,te=Number.POSITIVE_INFINITY,re=Number.NEGATIVE_INFINITY,ee=Number.NEGATIVE_INFINITY;for(let j=0;j<u;j++){const $=a[j],fe=$.units;let ne=0;for(let _e=0,Ee=fe.length;_e<Ee;_e++){const Le=fe[_e],oe=Le.data,Re=Le.data.byteLength;B.setUint32(g,Re),g+=4,D.set(oe,g),g+=Re,ne+=4+Re}let ae;if(j<u-1)x=a[j+1].dts-$.dts,ae=a[j+1].pts-$.pts;else{const _e=this.config,Ee=j>0?$.dts-a[j-1].dts:I;if(ae=j>0?$.pts-a[j-1].pts:I,_e.stretchShortVideoTrack&&this.nextAudioTs!==null){const Le=Math.floor(_e.maxBufferHole*i),oe=(s?b+s*i:this.nextAudioTs+f)-$.pts;oe>Le?(x=oe-Ee,x<0?x=Ee:q=!0,this.log(`It is approximately ${oe/90} ms to the next segment; using duration ${x/90} ms for the last video frame.`)):x=Ee}else x=Ee}const ce=Math.round($.pts-$.dts);ie=Math.min(ie,x),re=Math.max(re,x),te=Math.min(te,ae),ee=Math.max(ee,ae),l.push(qv($.key,x,ne,ce))}if(l.length){if(oa){if(oa<70){const j=l[0].flags;j.dependsOn=2,j.isNonSync=0}}else if(Ph&&ee-te<re-ie&&I/re<.025&&l[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let j=y;for(let $=0,fe=l.length;$<fe;$++){const ne=j+l[$].duration,ae=j+l[$].cts;if($<fe-1){const ce=ne+l[$+1].cts;l[$].duration=ce-ae}else l[$].duration=$?l[$-1].duration:I;l[$].cts=0,j=ne}}}x=q||!x?I:x;const Q=w+x;this.nextVideoTs=m=Q-f,this.videoSampleDuration=x,this.isVideoContiguous=!0;const Z={data1:H.moof(e.sequenceNumber++,y,et(e,{samples:l})),data2:D,startPTS:(b-f)/i,endPTS:(E+x-f)/i,startDTS:(y-f)/i,endDTS:m/i,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Z}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return fP;case"ac3":return hP;default:return dP}}remuxAudio(e,t,r,s,i){const a=e.inputTimeScale,l=e.samplerate?e.samplerate:a,u=a/l,d=this.getSamplesPerFrame(e),f=d*u,m=this._initPTS,g=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,x=[],y=i!==void 0;let w=e.samples,b=g?0:8,E=this.nextAudioTs||-1;const T=m.baseTime*a/m.timescale,_=T+t*a;if(this.isAudioContiguous=r=r||w.length&&E>0&&(s&&Math.abs(_-(E+T))<9e3||Math.abs(Ln(w[0].pts,_)-(E+T))<20*f),w.forEach(function(ee){ee.pts=Ln(ee.pts,_)}),!r||E<0){const ee=w.length;if(w=w.filter(Q=>Q.pts>=0),ee!==w.length&&this.warn(`Removed ${w.length-ee} of ${ee} samples (initPTS ${T} / ${a})`),!w.length)return;i===0?E=0:s&&!y?E=Math.max(0,_-T):E=w[0].pts-T}if(e.segmentCodec==="aac"){const ee=this.config.maxAudioFramesDrift;for(let Q=0,G=E+T;Q<w.length;Q++){const Y=w[Q],Z=Y.pts,j=Z-G,$=Math.abs(1e3*j/a);if(j<=-ee*f&&y)Q===0&&(this.warn(`Audio frame @ ${(Z/a).toFixed(3)}s overlaps marker by ${Math.round(1e3*j/a)} ms.`),this.nextAudioTs=E=Z-T,G=Z);else if(j>=ee*f&&$<uP&&y){let fe=Math.round(j/f);for(G=Z-fe*f;G<0&&fe&&f;)fe--,G+=f;Q===0&&(this.nextAudioTs=E=G-T),this.warn(`Injecting ${fe} audio frames @ ${((G-T)/a).toFixed(3)}s due to ${Math.round(1e3*j/a)} ms gap.`);for(let ne=0;ne<fe;ne++){let ae=oP.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);ae||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ae=Y.unit.subarray()),w.splice(Q,0,{unit:ae,pts:G}),G+=f,Q++}}Y.pts=G,G+=f}}let A=null,I=null,N,P=0,O=w.length;for(;O--;)P+=w[O].unit.byteLength;for(let ee=0,Q=w.length;ee<Q;ee++){const G=w[ee],Y=G.unit;let Z=G.pts;if(I!==null){const $=x[ee-1];$.duration=Math.round((Z-I)/u)}else if(r&&e.segmentCodec==="aac"&&(Z=E+T),A=Z,P>0){P+=b;try{N=new Uint8Array(P)}catch($){this.observer.emit(C.ERROR,C.ERROR,{type:Ce.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:P,reason:`fail allocating audio mdat ${P}`});return}g||(new DataView(N.buffer).setUint32(0,P),N.set(H.types.mdat,4))}else return;N.set(Y,b);const j=Y.byteLength;b+=j,x.push(qv(!0,d,j,0)),I=Z}const M=x.length;if(!M)return;const D=x[x.length-1];E=I-T,this.nextAudioTs=E+u*D.duration;const B=g?new Uint8Array(0):H.moof(e.sequenceNumber++,A/u,et({},e,{samples:x}));e.samples=[];const q=(A-T)/a,ie=this.nextAudioTs/a,re={data1:B,data2:N,startPTS:q,endPTS:ie,startDTS:q,endDTS:ie,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,re}}function Ln(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function mP(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function uS(n,e,t,r){const s=n.samples.length;if(!s)return;const i=n.inputTimeScale;for(let l=0;l<s;l++){const u=n.samples[l];u.pts=Ln(u.pts-t.baseTime*i/t.timescale,e*i)/i,u.dts=Ln(u.dts-r.baseTime*i/r.timescale,e*i)/i}const a=n.samples;return n.samples=[],{samples:a}}function dS(n,e,t){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let a=0;a<r;a++){const l=n.samples[a];l.pts=Ln(l.pts-t.baseTime*s/t.timescale,e*s)/s}n.samples.sort((a,l)=>a.pts-l.pts);const i=n.samples;return n.samples=[],{samples:i}}class pP extends zn{constructor(e,t,r,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,s){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,s),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:r,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:i,video:a}=this.initData=xb(e);if(t)nR(e,t);else{const u=i||a;u!=null&&u.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${u.codec}")!`)}i&&(r=Yv(i,nt.AUDIO,this)),a&&(s=Yv(a,nt.VIDEO,this));const l={};i&&a?l.audiovideo={container:"video/mp4",codec:r+","+s,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:i?l.audio={container:"audio/mp4",codec:r,encrypted:i.encrypted,initSegment:e,id:"audio"}:a?l.video={container:"video/mp4",codec:s,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,t,r,s,i,a){var l,u;let{initPTS:d,lastEndTime:f}=this;const m={audio:void 0,video:void 0,text:s,id3:r,initSegment:void 0};pe(f)||(f=this.lastEndTime=i||0);const g=t.samples;if(!g.length)return m;const x={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((l=y)!=null&&l.length||(this.generateInitSegment(g),y=this.initData),!((u=y)!=null&&u.length))return this.warn("Failed to generate initSegment."),m;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const w=sR(g,y,this),b=y.audio?w[y.audio.id]:null,E=y.video?w[y.video.id]:null,T=Wc(E,1/0),_=Wc(b,1/0),A=Wc(E,0,!0),I=Wc(b,0,!0);let N=i,P=0;const O=b&&(!E||!d&&_<T||d&&d.trackId===y.audio.id),M=O?b:E;if(M){const G=M.timescale,Y=M.start-i*G,Z=O?y.audio.id:y.video.id;N=M.start/G,P=O?I-_:A-T,(a||!d)&&(gP(d,N,i,P)||G!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${a?"":"~"}${i} ${Y/G} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${N-i} (${Y}/${G}) trackId: ${Z}`),d=null,x.initPTS=Y,x.timescale=G,x.trackId=Z)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${i}`);d?(x.initPTS=d.baseTime,x.timescale=d.timescale,x.trackId=d.trackId):((!x.timescale||x.trackId===void 0||x.initPTS===void 0)&&(this.warn("Could not set initPTS"),x.initPTS=N,x.timescale=1,x.trackId=-1),this.initPTS=d={baseTime:x.initPTS,timescale:x.timescale,trackId:x.trackId});const D=N-d.baseTime/d.timescale,B=D+P;P>0?this.lastEndTime=B:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const q=!!y.audio,ie=!!y.video;let te="";q&&(te+="audio"),ie&&(te+="video");const re=(y.audio?y.audio.encrypted:!1)||(y.video?y.video.encrypted:!1),ee={data1:g,startPTS:D,startDTS:D,endPTS:B,endDTS:B,type:te,hasAudio:q,hasVideo:ie,nb:1,dropped:0,encrypted:re};m.audio=q&&!ie?ee:void 0,m.video=ie?ee:void 0;const Q=E?.sampleCount;if(Q){const G=E.keyFrameIndex,Y=G!==-1;ee.nb=Q,ee.dropped=G===0||this.isVideoContiguous?0:Y?G:Q,ee.independent=Y,ee.firstKeyFrame=G,Y&&E.keyFrameStart&&(ee.firstKeyFramePTS=(E.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(m.independent=Y),this.isVideoContiguous||(this.isVideoContiguous=Y),ee.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${G}/${Q} dropped: ${ee.dropped} start: ${ee.firstKeyFramePTS||"NA"}`)}return m.initSegment=x,m.id3=uS(r,i,d,d),s.samples.length&&(m.text=dS(s,i,d)),m}}function Wc(n,e,t=!1){return n?.start!==void 0?(n.start+(t?n.duration:0))/n.timescale:e}function gP(n,e,t,r){if(n===null)return!0;const s=Math.max(r,1),i=e-n.baseTime/n.timescale;return Math.abs(i-t)>s}function Yv(n,e,t){const r=n.codec;return r&&r.length>4?r:e===nt.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?Iu(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let Zr;try{Zr=self.performance.now.bind(self.performance)}catch{Zr=Date.now}const xu=[{demux:tP,remux:pP},{demux:js,remux:gu},{demux:X3,remux:gu},{demux:J3,remux:gu}];xu.splice(2,0,{demux:Z3,remux:gu});class Qv{constructor(e,t,r,s,i,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=i,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,s){const i=r.transmuxing;i.executeStart=Zr();let a=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:u}=this;s&&(this.currentTransmuxState=s);const{contiguous:d,discontinuity:f,trackSwitch:m,accurateTimeOffset:g,timeOffset:x,initSegmentChange:y}=s||l,{audioCodec:w,videoCodec:b,defaultInitPts:E,duration:T,initSegmentData:_}=u,A=xP(a,t);if(A&&ya(A.method)){const O=this.getDecrypter(),M=zp(A.method);if(O.isSync()){let D=O.softwareDecrypt(a,A.key.buffer,A.iv.buffer,M);if(r.part>-1){const q=O.flush();D=q&&q.buffer}if(!D)return i.executeEnd=Zr(),Dh(r);a=new Uint8Array(D)}else return this.asyncResult=!0,this.decryptionPromise=O.webCryptoDecrypt(a,A.key.buffer,A.iv.buffer,M).then(D=>{const B=this.push(D,null,r);return this.decryptionPromise=null,B}),this.decryptionPromise}const I=this.needsProbing(f,m);if(I){const O=this.configureTransmuxer(a);if(O)return this.logger.warn(`[transmuxer] ${O.message}`),this.observer.emit(C.ERROR,C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:O,reason:O.message}),i.executeEnd=Zr(),Dh(r)}(f||m||y||I)&&this.resetInitSegment(_,w,b,T,t),(f||y||I)&&this.resetInitialTimestamp(E),d||this.resetContiguity();const N=this.transmux(a,A,x,g,r);this.asyncResult=al(N);const P=this.currentTransmuxState;return P.contiguous=!0,P.discontinuity=!1,P.trackSwitch=!1,i.executeEnd=Zr(),N}flush(e){const t=e.transmuxing;t.executeStart=Zr();const{decrypter:r,currentTransmuxState:s,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then(()=>this.flush(e));const a=[],{timeOffset:l}=s;if(r){const m=r.flush();m&&a.push(this.push(m.buffer,null,e))}const{demuxer:u,remuxer:d}=this;if(!u||!d){t.executeEnd=Zr();const m=[Dh(e)];return this.asyncResult?Promise.resolve(m):m}const f=u.flush(l);return al(f)?(this.asyncResult=!0,f.then(m=>(this.flushRemux(a,m,e),a))):(this.flushRemux(a,f,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,r){const{audioTrack:s,videoTrack:i,id3Track:a,textTrack:l}=t,{accurateTimeOffset:u,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===ve.MAIN?"level":"track"} ${r.level}`);const f=this.remuxer.remux(s,i,a,l,d,u,!0,this.id);e.push({remuxResult:f,chunkMeta:r}),r.transmuxing.executeEnd=Zr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,s,i){const{demuxer:a,remuxer:l}=this;!a||!l||(a.resetInitSegment(e,t,r,s),l.resetInitSegment(e,t,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,s,i){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,r,s,i):a=this.transmuxUnencrypted(e,r,s,i),a}transmuxUnencrypted(e,t,r,s){const{audioTrack:i,videoTrack:a,id3Track:l,textTrack:u}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,a,l,u,t,r,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,r,s,i){return this.demuxer.demuxSampleAes(e,t,r).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,r,s,!1,this.id),chunkMeta:i}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:s}=this;let i;for(let m=0,g=xu.length;m<g;m++){var a;if((a=xu[m].demux)!=null&&a.probe(e,this.logger)){i=xu[m];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,d=i.remux,f=i.demux;(!u||!(u instanceof d))&&(this.remuxer=new d(r,t,s,this.logger)),(!l||!(l instanceof f))&&(this.demuxer=new f(r,t,s,this.logger),this.probe=f.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Hp(this.config)),e}}function xP(n,e){let t=null;return n.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Dh=n=>({remuxResult:{},chunkMeta:n});function al(n){return"then"in n&&n.then instanceof Function}class yP{constructor(e,t,r,s,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=s,this.defaultInitPts=i||null}}class vP{constructor(e,t,r,s,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=s,this.timeOffset=i,this.initSegmentChange=a}}let Xv=0;class fS{constructor(e,t,r,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Xv++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=u=>{const d=u.data,f=this.hls;if(!(!f||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var m;const g=(m=this.workerContext)==null?void 0:m.objectURL;g&&self.URL.revokeObjectURL(g);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{f.logger[d.data.logType]&&f.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,f.trigger(d.event,d.data);break}}},this.onWorkerError=u=>{if(!this.hls)return;const d=new Error(`${u.message}  (${u.filename}:${u.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=s;const a=(u,d)=>{d=d||{},d.frag=this.frag||void 0,u===C.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(u,d)};this.observer=new Yp,this.observer.on(C.FRAG_DECRYPTED,a),this.observer.on(C.ERROR,a);const l=fv(i.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const u=this.hls.logger;if(i.workerPath||E3()){try{i.workerPath?(u.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=_3(i.workerPath)):(u.log(`injecting Web Worker for "${t}"`),this.workerContext=T3());const{worker:f}=this.workerContext;f.addEventListener("message",this.onWorkerMessage),f.addEventListener("error",this.onWorkerError),f.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:rt(i)})}catch(f){u.warn(`Error setting up "${t}" Web Worker, fallback to inline`,f),this.terminateWorker(),this.error=null,this.transmuxer=new Qv(this.observer,l,i,"",t,e.logger)}return}}this.transmuxer=new Qv(this.observer,l,i,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=Xv++;const t=this.hls.config,r=fv(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:rt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),k3(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,s,i,a,l,u,d,f){var m,g;d.transmuxing.start=self.performance.now();const{instanceNo:x,transmuxer:y}=this,w=a?a.start:i.start,b=i.decryptdata,E=this.frag,T=!(E&&i.cc===E.cc),_=!(E&&d.level===E.level),A=E?d.sn-E.sn:-1,I=this.part?d.part-this.part.index:-1,N=A===0&&d.id>1&&d.id===E?.stats.chunkCount,P=!_&&(A===1||A===0&&(I===1||N&&I<=0)),O=self.performance.now();(_||A||i.stats.parsing.start===0)&&(i.stats.parsing.start=O),a&&(I||!P)&&(a.stats.parsing.start=O);const M=!(E&&((m=i.initSegment)==null?void 0:m.url)===((g=E.initSegment)==null?void 0:g.url)),D=new vP(T,P,u,_,w,M);if(!P||T||M){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===ve.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${T}
        trackSwitch: ${_}
        contiguous: ${P}
        accurateTimeOffset: ${u}
        timeOffset: ${w}
        initSegmentChange: ${M}`);const B=new yP(r,s,t,l,f);this.configureTransmuxer(B)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:x,cmd:"demux",data:e,decryptdata:b,chunkMeta:d,state:D},e instanceof ArrayBuffer?[e]:[]);else if(y){const B=y.push(e,b,d,D);al(B)?B.then(q=>{this.handleTransmuxComplete(q)}).catch(q=>{this.transmuxerError(q,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(B)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const s=r.flush(e);al(s)?s.then(i=>{this.handleFlushResult(i,e)}).catch(i=>{this.transmuxerError(i,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Zv=100;class wP extends qp{constructor(e,t,r){super(e,t,r,"audio-stream-controller",ve.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:a}){if(r===ve.MAIN){const l=t.cc,u=this.fragCurrent;if(this.initPTS[l]={baseTime:s,timescale:i,trackId:a},this.log(`InitPTS for cc: ${l} found from main: ${s/i} (${s}/${i}) trackId: ${a}`),this.mainAnchor=t,this.state===se.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==l)&&this.syncWithAnchor(t,d?.frag)}else!this.hls.hasEnoughToStart&&u&&u.cc!==l?(u.abortRequests(),this.syncWithAnchor(t,u)):this.state===se.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const s=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&s?.cc===t.cc)return;const i=(s||e).cc,a=this.getLevelDetails(),l=this.getLoadPosition(),u=Ab(a,i,l);u&&(this.log(`Syncing with main frag at ${u.start} cc ${u.cc}`),this.startFragRequested=!1,this.nextLoadPosition=u.start,this.resetLoadingState(),this.state===se.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=se.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(Zv),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=se.IDLE):this.state=se.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case se.IDLE:this.doTickIdle();break;case se.WAITING_TRACK:{const{levels:e,trackId:t}=this,r=e?.[t],s=r?.details;if(s&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(s))break;this.state=se.WAITING_INIT_PTS}break}case se.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case se.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:r,cache:s,complete:i}=e,a=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=se.FRAG_LOADING;const l=s.flush().buffer,u={frag:t,part:r,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),i&&super._handleFragmentLoadComplete(u)}else a&&a.cc!==e.frag.cc&&this.syncWithAnchor(a,e.frag)}else this.state=se.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:s,trackId:i}=this,a=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(r!=null&&r[i]))return;const l=r[i],u=l.details;if(!u||this.waitForLive(l)||this.waitForCdnTuneIn(u)){this.state=se.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,nt.AUDIO,ve.AUDIO));const f=this.getFwdBufferInfo(d,ve.AUDIO);if(f===null)return;if(!this.switchingTrack&&this._streamEnded(f,u)){t.trigger(C.BUFFER_EOS,{type:"audio"}),this.state=se.ENDED;return}const m=f.len,g=t.maxBufferLength,x=u.fragments,y=x[0].start,w=this.getLoadPosition(),b=this.flushing?w:f.end;if(this.switchingTrack&&s){const _=w;u.PTSKnown&&_<y&&(f.end>y||f.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=y+.05)}if(m>=g&&!this.switchingTrack&&b<x[x.length-1].start)return;let E=this.getNextFragment(b,u);if(E&&this.isLoopLoading(E,b)&&(E=this.getNextFragmentLoopLoading(E,u,f,ve.MAIN,g)),!E){this.bufferFlushed=!0;return}let T=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&T&&kt(E)&&!E.endList&&(!u.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(T)===Nt.OK&&(this.mainFragLoading=T=null),T&&kt(T))){if(E.start>T.end){const A=this.fragmentTracker.getFragAtPos(b,ve.MAIN);A&&A.end>T.end&&(T=A,this.mainFragLoading={frag:A,targetBufferTime:null})}if(E.start>T.end)return}this.loadFragment(E,l,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new rl(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==se.STOPPED&&(this.setInterval(Zv),this.state=se.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(C.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:s}=this,{details:i,id:a,groupId:l,track:u}=t;if(!s){this.warn(`Audio tracks reset while loading track ${a} "${u.name}" of "${l}"`);return}const d=this.mainDetails;if(!d||i.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==se.STOPPED&&(this.state=se.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${u.name}" of "${l}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const f=s[a];let m=0;if(i.live||(r=f.details)!=null&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;if(f.details){var g;m=this.alignPlaylists(i,f.details,(g=this.levelLastLoaded)==null?void 0:g.details)}i.alignedSliding||(zb(i,d),i.alignedSliding||Ou(i,d),m=i.fragmentStart)}f.details=i,this.levelLastLoaded=f,this.startFragRequested||this.setStartPosition(d,m),this.hls.trigger(C.AUDIO_TRACK_UPDATED,{details:i,id:a,groupId:t.groupId}),this.state===se.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=se.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{config:a,trackId:l,levels:u}=this;if(!u){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const d=u[l];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const f=d.details;if(!f){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const m=a.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let g=this.transmuxer;g||(g=this.transmuxer=new fS(this.hls,ve.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[r.cc],y=(t=r.initSegment)==null?void 0:t.data;if(x!==void 0){const b=s?s.index:-1,E=b!==-1,T=new Kp(r.level,r.sn,r.stats.chunkCount,i.byteLength,b,E);g.push(i,y,m,"",r,s,f.totalduration,!1,T,x)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${f.startSN} ,${f.endSN}],track ${l}`);const{cache:w}=this.waitingData=this.waitingData||{frag:r,part:s,cache:new Wb,complete:!1};w.push(new Uint8Array(i)),this.state!==se.STOPPED&&(this.state=se.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ve.MAIN&&kt(t.frag)&&(this.mainFragLoading=t,this.state===se.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:s}=t;if(r.type!==ve.AUDIO){!this.audioOnly&&r.type===ve.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(kt(r)){this.fragPrevious=r;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(C.AUDIO_TRACK_SWITCHED,Xe({},i)))}this.fragBufferedComplete(r,s),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=se.ERROR;return}switch(t.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ve.AUDIO,t);break;case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===se.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===Ge.AUDIO_TRACK&&(this.state=se.IDLE);break;case K.BUFFER_ADD_CODEC_ERROR:case K.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case K.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==nt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==nt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===se.ENDED&&(this.state=se.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,ve.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:s}=this,{remuxResult:i,chunkMeta:a}=e,l=this.getCurrentContext(a);if(!l){this.resetWhenMissingContext(a);return}const{frag:u,part:d,level:f}=l,{details:m}=f,{audio:g,text:x,id3:y,initSegment:w}=i;if(this.fragContextChanged(u)||!m){this.fragmentTracker.removeFragment(u);return}if(this.state=se.PARSING,this.switchingTrack&&g&&this.completeAudioSwitch(this.switchingTrack),w!=null&&w.tracks){const b=u.initSegment||u;if(this.unhandledEncryptionError(w,u))return;this._bufferInitSegment(f,w.tracks,b,a),s.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:r,tracks:w.tracks})}if(g){const{startPTS:b,endPTS:E,startDTS:T,endDTS:_}=g;d&&(d.elementaryStreams[nt.AUDIO]={startPTS:b,endPTS:E,startDTS:T,endDTS:_}),u.setElementaryStreamInfo(nt.AUDIO,b,E,T,_),this.bufferFragmentData(g,u,d,a)}if(y!=null&&(t=y.samples)!=null&&t.length){const b=et({id:r,frag:u,details:m},y);s.trigger(C.FRAG_PARSING_METADATA,b)}if(x){const b=et({id:r,frag:u,details:m},x);s.trigger(C.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,r,s){if(this.state!==se.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const i=t.audio;i.id=ve.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${a}/${i.codec}]`),a&&a.split(",").length===1&&(i.levelCodec=a),this.hls.trigger(C.BUFFER_CODECS,t);const l=i.initSegment;if(l!=null&&l.byteLength){const u={type:"audio",frag:r,part:null,chunkMeta:s,parent:r.type,data:l};this.hls.trigger(C.BUFFER_APPENDING,u)}this.tickImmediate()}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===Nt.NOT_LOADED||s===Nt.PARTIAL){var i;if(!kt(e))this._loadInitSegment(e,t);else if((i=t.details)!=null&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=se.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&Ou(t.details,a)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:s,characteristics:i,audioCodec:a,channels:l}=this.bufferedTrack;bi({name:t,lang:r,assocLang:s,characteristics:i,audioCodec:a,channels:l},e,mi)||(Ru(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(C.AUDIO_TRACK_SWITCHED,Xe({},e))}}class n0 extends zn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const s=t?.renditionReports;if(s){let i=-1;for(let a=0;a<s.length;a++){const l=s[a];let u;try{u=new self.URL(l.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),u=l.URI||""}if(u===e){i=a;break}else u===e.substring(0,u.length)&&(i=a)}if(i!==-1){const a=s[i],l=parseInt(a["LAST-MSN"])||t.lastPartSn;let u=parseInt(a["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const f=Math.min(t.age-t.partTarget,t.targetduration);u>=0&&f>t.partTarget&&(u+=1)}const d=r&&hv(r);return new mv(l,u>=0?u:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:s,stats:i}=t,a=self.performance.now(),l=i.loading.first?Math.max(0,a-i.loading.first):0;s.advancedDateTime=Date.now()-l;const u=this.hls.config.timelineOffset;if(u!==s.appliedTimelineOffset){const f=Math.max(u||0,0);s.appliedTimelineOffset=f,s.fragments.forEach(m=>{m.setStart(m.playlistOffset+f)})}if(s.live||r!=null&&r.live){const f="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(r),r&&s.fragments.length>0){f3(r,s,this);const T=s.playlistParsingError;if(T){this.warn(T);const _=this.hls;if(!_.config.ignorePlaylistParsingErrors){var d;const{networkDetails:A}=t;_.trigger(C.ERROR,{type:Ce.NETWORK_ERROR,details:K.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:T,reason:T.message,level:t.level||void 0,parent:(d=s.fragments[0])==null?void 0:d.type,networkDetails:A,stats:i});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=i.loading.start);const m=this.hls.mainForwardBufferInfo,g=m?m.end-m.len:0,x=(s.edge-g)*1e3,y=$b(s,x);if(s.requestScheduled+y<a?s.requestScheduled=a:s.requestScheduled+=y,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let w,b,E;if(s.canBlockReload&&s.endSN&&s.advanced){const T=this.hls.config.lowLatencyMode,_=s.lastPartSn,A=s.endSN,I=s.lastPartIndex,N=I!==-1,P=_===A;N?P?(b=A+1,E=T?0:I):(b=_,E=T?I+1:s.maxPartIndex):b=A+1;const O=s.age,M=O+s.ageHeader;let D=Math.min(M-s.partTarget,s.targetduration*1.5);if(D>0){if(M>s.targetduration*3)this.log(`Playlist last advanced ${O.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,E=void 0;else if(r!=null&&r.tuneInGoal&&M-s.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${D} with playlist age: ${s.age}`),D=0;else{const B=Math.floor(D/s.targetduration);if(b+=B,E!==void 0){const q=Math.round(D%s.targetduration/s.partTarget);E+=q}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${O.toFixed(2)}s goal: ${D} skip sn ${B} to part ${E}`)}s.tuneInGoal=D}if(w=this.getDeliveryDirectives(s,t.deliveryDirectives,b,E),T||!P){s.requestScheduled=a,this.loadingPlaylist(f,w);return}}else(s.canBlockReload||s.canSkipUntil)&&(w=this.getDeliveryDirectives(s,t.deliveryDirectives,b,E));w&&b!==void 0&&s.canBlockReload&&(s.requestScheduled=i.loading.first+Math.max(y-l*2,y/2)),this.scheduleLoading(f,w,s)}else this.clearTimer()}scheduleLoading(e,t,r){const s=r||e.details;if(!s){this.loadingPlaylist(e,t);return}const i=self.performance.now(),a=s.requestScheduled;if(i>=a){this.loadingPlaylist(e,t);return}const l=a-i;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),l)}getDeliveryDirectives(e,t,r,s){let i=hv(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,s=t.part,i=mu.No),new mv(r,s,i)}checkRetry(e){const t=e.details,r=Pu(e),s=e.errorAction,{action:i,retryCount:a=0,retryConfig:l}=s||{},u=!!s&&!!l&&(i===Kt.RetryRequest||!s.resolved&&i===Kt.SendAlternateToPenaltyBox);if(u){var d;if(a>=l.maxNumRetry)return!1;if(r&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const f=Gp(l,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),f),this.warn(`Retrying playlist loading ${a+1}/${l.maxNumRetry} after "${t}" in ${f}ms`)}e.levelRetry=!0,s.resolved=!0}return u}}function hS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!ol(n[t].attrs,e[t].attrs))return!1;return!0}function ol(n,e,t){const r=n["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>n[s]!==e[s])}function Gm(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class bP extends n0{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(C.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==s){this.warn(`Audio track with id:${r} and group:${s} not found in active group ${a?.groupId}`);return}const l=a.details;a.details=t.details,this.log(`Audio track ${r} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(l=>s?.indexOf(l)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(g=>!r||r.indexOf(g.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(g=>g.default)&&(this.selectDefaultTrack=!1),l.forEach((g,x)=>{g.id=x});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.audioPreference;if(!i&&u){const g=_r(u,l,mi);if(g>-1)i=l[g];else{const x=_r(u,this.tracks);i=this.tracks[x]}}let d=this.findTrackId(i);d===-1&&i&&(d=this.findTrackId(null));const f={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${r?.join(",")}`),this.hls.trigger(C.AUDIO_TRACKS_UPDATED,f);const m=this.trackId;if(d!==-1&&m===-1)this.setAudioTrack(d);else if(l.length&&m===-1){var a;const g=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${l.length}`);this.warn(g.message),this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:g})}}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const s=this.currentTrack;if(s&&bi(e,s,mi))return s;const i=_r(e,this.tracksInGroup,mi);if(i>-1){const a=this.tracksInGroup[i];return this.setAudioTrack(i),a}else if(s){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const l=DR(e,t.levels,r,a,mi);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){const a=_r(e,r);if(a>-1)return r[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e],i=s.details&&!s.details.live;if(e===this.trackId&&s===r&&i||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(C.AUDIO_TRACK_SWITCHING,Xe({},s)),i))return;const a=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(!(this.selectDefaultTrack&&!s.default)&&(!e||bi(e,s,mi)))return r}if(e){const{name:r,lang:s,assocLang:i,characteristics:a,audioCodec:l,channels:u}=e;for(let d=0;d<t.length;d++){const f=t[d];if(bi({name:r,lang:s,assocLang:i,characteristics:a,audioCodec:l,channels:u},f,mi))return d}for(let d=0;d<t.length;d++){const f=t[d];if(ol(e.attrs,f.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const f=t[d];if(ol(e.attrs,f.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Ru(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),a=e.details,l=a?.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(C.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}}class SP{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const s=this.queues[t];s.push(e),s.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(i){var r;if(s.onError(i),this.queues===null||this.tracks===null)return;const a=(r=this.tracks[e])==null?void 0:r.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],s=r?.buffer;return s?`SourceBuffer${s.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const Jv=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,mS="HlsJsTrackRemovedError";class EP extends Error{constructor(e){super(e),this.name=mS}}class TP extends zn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:s,mediaSource:i}=this;r&&this.log("Media source opened"),!(!s||!i)&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(C.MEDIA_ATTACHED,{media:s,mediaSource:i}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:s}=this;r!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=zL($s(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.BUFFER_RESET,this.onBufferReset,this),e.on(C.BUFFER_APPENDING,this.onBufferAppending,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.BUFFER_EOS,this.onBufferEos,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.FRAG_PARSED,this.onFragParsed,this),e.on(C.FRAG_CHANGED,this.onFragChanged,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.BUFFER_RESET,this.onBufferReset,this),e.off(C.BUFFER_APPENDING,this.onBufferAppending,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_EOS,this.onBufferEos,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.FRAG_PARSED,this.onFragParsed,this),e.off(C.FRAG_CHANGED,this.onFragChanged,this),e.off(C.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const i=this.isUpdating();i||this.operationQueue.removeBlockers();const a=this.isQueued();(i||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${i?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?et(r,s.tracks):this.sourceBuffers.forEach(i=>{const[a]=i;a&&(r[a]=et({},this.tracks[a]),this.removeBuffer(a)),i[0]=i[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media;this.transferData=this.overrides=void 0;const s=$s(this.appendSource);if(s){const i=!!t.mediaSource;(i||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(a),i)this._objectUrl=r.src,this.attachTransferred();else{const l=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");const u=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||u&&a instanceof u,e1(r),_P(r,l),r.load()}catch{r.src=l}else r.src=l}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,s=t.tracks,i=s?Object.keys(s):null,a=i?i.length:0,l=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&i&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${rt(r,(u,d)=>u==="initSegment"?void 0:d)};
transfer tracks: ${rt(s,(u,d)=>u==="initSegment"?void 0:d)}}`),!ub(s,r)){t.mediaSource=null,t.tracks=void 0;const u=e.currentTime,d=this.details,f=Math.max(u,d?.fragments[0].start||0);if(f-u>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${u} -> ${f}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(r)}") start time: ${f} currentTime: ${u}`),this.onMediaDetaching(C.MEDIA_DETACHING,{}),this.onMediaAttaching(C.MEDIA_ATTACHING,t),e.currentTime=f;return}this.transferData=void 0,i.forEach(u=>{const d=u,f=s[d];if(f){const m=f.buffer;if(m){const g=this.fragmentTracker,x=f.id;if(g.hasFragments(x)||g.hasParts(x)){const b=Fe.getBuffered(m);g.detectEvictedFragments(d,b,x,null,!0)}const y=Nh(d),w=[d,m];this.sourceBuffers[y]=w,m.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,f)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:i,_objectUrl:a}=this;if(i){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const l=i.readyState==="open";try{const u=i.sourceBuffers;for(let d=u.length;d--;)l&&u[d].abort(),i.removeSourceBuffer(u[d]);l&&i.endOfStream()}catch(u){this.warn(`onMediaDetaching: ${u.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),r||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(s.removeAttribute("src"),this.appendSource&&e1(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(C.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(i){this.warn(`onBufferReset ${e}`,i)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Nh(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new SP(this.tracks)}onBufferCodecs(e,t){var r;const s=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in t&&(s.audio||s.video)||s.audiovideo&&("audio"in t||"video"in t),l=!a&&this.sourceBufferCount&&this.media&&i.some(u=>!s[u]);if(a||l){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${i}" SourceBuffers`);return}i.forEach(u=>{var d,f;const m=t[u],{id:g,codec:x,levelCodec:y,container:w,metadata:b,supplemental:E}=m;let T=s[u];const _=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[u],A=_!=null&&_.buffer?_:T,I=A?.pendingCodec||A?.codec,N=A?.levelCodec;T||(T=s[u]={buffer:void 0,listeners:[],codec:x,supplemental:E,container:w,levelCodec:y,metadata:b,id:g});const P=hu(I,N),O=P?.replace(Jv,"$1");let M=hu(x,y);const D=(f=M)==null?void 0:f.replace(Jv,"$1");M&&P&&O!==D&&(u.slice(0,5)==="audio"&&(M=Iu(M,this.appendSource)),this.log(`switching codec ${I} to ${M}`),M!==(T.pendingCodec||T.codec)&&(T.pendingCodec=M),T.container=w,this.appendChangeType(u,w,M))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((r=t.audio)==null?void 0:r.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const s=`${t};codecs=${r}`,i={label:`change-type=${s}`,execute:()=>{const a=this.tracks[e];if(a){const l=a.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),l.changeType(s),a.codec=r,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(i,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,s=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,ve.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var l;const u=this.tracks.video;(this.lastVideoAppendEnd>s||u!=null&&u.buffer&&Fe.isBuffered(u.buffer,s)||((l=this.fragmentTracker.getAppendedFrag(s,ve.MAIN))==null?void 0:l.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn("Error executing block-audio operation",l)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:s,type:i,parent:a,frag:l,part:u,chunkMeta:d,offset:f}=t,m=d.buffering[i],{sn:g,cc:x}=l,y=self.performance.now();m.start=y;const w=l.stats.buffering,b=u?u.stats.buffering:null;w.start===0&&(w.start=y),b&&b.start===0&&(b.start=y);const E=r.audio;let T=!1;i==="audio"&&E?.container==="audio/mpeg"&&(T=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const _=r.video,A=_?.buffer;if(A&&g!=="initSegment"){const P=u||l,O=this.blockedAudioAppend;if(i==="audio"&&a!=="main"&&!this.blockedAudioAppend&&!(_.ending||_.ended)){const D=P.start+P.duration*.05,B=A.buffered,q=this.currentOp("video");!B.length&&!q?this.blockAudio(P):!q&&!Fe.isBuffered(A,D)&&this.lastVideoAppendEnd<D&&this.blockAudio(P)}else if(i==="video"){const M=P.end;if(O){const D=O.frag.start;(M>D||M<this.lastVideoAppendEnd||Fe.isBuffered(A,D))&&this.unblockAudio()}this.lastVideoAppendEnd=M}}const I=(u||l).start,N={label:`append-${i}`,execute:()=>{var P;m.executeStart=self.performance.now();const O=(P=this.tracks[i])==null?void 0:P.buffer;O&&(T?this.updateTimestampOffset(O,I,.1,i,g,x):f!==void 0&&pe(f)&&this.updateTimestampOffset(O,f,1e-6,i,g,x)),this.appendExecutor(s,i)},onStart:()=>{},onComplete:()=>{const P=self.performance.now();m.executeEnd=m.end=P,w.first===0&&(w.first=P),b&&b.first===0&&(b.first=P);const O={};this.sourceBuffers.forEach(([M,D])=>{M&&(O[M]=Fe.getBuffered(D))}),this.appendErrors[i]=0,i==="audio"||i==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(C.BUFFER_APPENDED,{type:i,frag:l,part:u,chunkMeta:d,parent:l.type,timeRanges:O})},onError:P=>{var O;const M={type:Ce.MEDIA_ERROR,parent:l.type,details:K.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:l,part:u,chunkMeta:d,error:P,err:P,fatal:!1},D=(O=this.media)==null?void 0:O.error;if(P.code===DOMException.QUOTA_EXCEEDED_ERR||P.name=="QuotaExceededError"||"quota"in P)M.details=K.BUFFER_FULL_ERROR;else if(P.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!D)M.errorAction=xa(!0);else if(P.name===mS&&this.sourceBufferCount===0)M.errorAction=xa(!0);else{const B=++this.appendErrors[i];this.warn(`Failed ${B}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${i}" sourceBuffer (${D||"no media error"})`),(B>=this.hls.config.appendErrorMaxRetry||D)&&(M.fatal=!0)}this.hls.trigger(C.ERROR,M)}};this.log(`queuing "${i}" append sn: ${g}${u?" p: "+u.index:""} of ${l.type===ve.MAIN?"level":"track"} ${l.level} cc: ${x}`),this.append(N,i,this.isPending(this.tracks[i]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(C.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:r,startOffset:s,endOffset:i}=t;r?this.append(this.getFlushOp(r,s,i),r):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,s,i),a)})}onFragParsed(e,t){const{frag:r,part:s}=t,i=[],a=s?s.elementaryStreams:r.elementaryStreams;a[nt.AUDIOVIDEO]?i.push("audiovideo"):(a[nt.AUDIO]&&i.push("audio"),a[nt.VIDEO]&&i.push("video"));const l=()=>{const u=self.performance.now();r.stats.buffering.end=u,s&&(s.stats.buffering.end=u);const d=s?s.stats:r.stats;this.hls.trigger(C.FRAG_BUFFERED,{frag:r,part:s,stats:d,id:r.type})};i.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(l,i).catch(u=>{this.warn(`Fragment buffered callback ${u}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){const l=this.tracks[a];(!t.type||t.type===a)&&(l.ending=!0,l.ended||(l.ended=!0,this.log(`${a} buffer reached EOS`)))}});const s=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var l;return a&&!((l=this.tracks[a])!=null&&l.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(C.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(C.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===K.BUFFER_APPEND_ERROR&&t.frag){var r;const s=(r=t.errorAction)==null?void 0:r.nextAutoLevel;pe(s)&&s!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const s=e.config,i=r.currentTime,a=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(pe(l)&&l>=0){const d=Math.max(l,a),f=Math.floor(i/a)*a-d;this.flushBackBuffer(i,a,f)}const u=s.frontBufferFlushThreshold;if(pe(u)&&u>0){const d=Math.max(s.maxBufferLength,u),f=Math.max(d,a),m=Math.floor(i/a)*a+f;this.flushFrontBuffer(i,a,m)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const l=Fe.getBuffered(i);if(l.length>0&&r>l.start(0)){var a;this.hls.trigger(C.BACK_BUFFER_REACHED,{bufferEnd:r});const u=this.tracks[s];if((a=this.details)!=null&&a.live)this.hls.trigger(C.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(u!=null&&u.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:s})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([s,i])=>{if(i){const a=Fe.getBuffered(i),l=a.length;if(l<2)return;const u=a.start(l-1),d=a.end(l-1);if(r>u||e>=u&&e<=d)return;this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||r?.readyState!=="open")return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),f=Math.max(d,s);return{duration:1/0,start:d,end:f}}return{duration:1/0}}const i=(e=this.overrides)==null?void 0:e.duration;if(i)return pe(i)?{duration:i}:null;const a=this.media.duration,l=pe(r.duration)?r.duration:0;return s>l&&s>a||!pe(a)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:r}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(pe(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${r}.`),s.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${rt(r)}`),this.tracksReady){var s;const i=(s=this.transferData)==null?void 0:s.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const s=this.tracks[t];e[t]={buffer:r,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(C.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in e){const a=i,l=e[a];if(this.isPending(l)){const u=this.getTrackCodec(l,a),d=`${l.container};codecs=${u}`;l.codec=u,this.log(`creating sourceBuffer(${d})${this.currentOp(a)?" Queued":""} ${rt(l)}`);try{const f=r.addSourceBuffer(d),m=Nh(a),g=[a,f];t[m]=g,l.buffer=f}catch(f){var s;this.error(`error while trying to add sourceBuffer: ${f.message}`),this.shiftAndExecuteNext(a),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[a],this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:f,sourceBufferName:a,mimeType:d,parent:l.id});return}this.trackSourceBuffer(a,l)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let s=e.codec;r&&(t==="video"||t==="audiovideo")&&tl(r,"video")&&(s=mR(s,r));const i=hu(s,e.levelCodec);return i?t.slice(0,5)==="audio"?Iu(i,this.appendSource):i:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(i,a)=>{const l=a.removedRanges;l!=null&&l.length&&this.hls.trigger(C.BUFFER_FLUSHED,{type:i})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${s}`,t),this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const i=this.currentOp(e);i&&i.onError(s)}updateTimestampOffset(e,t,r,s,i,a){const l=t-e.timestampOffset;Math.abs(l)>=r&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${t} (sn: ${i} cc: ${a})`),e.timestampOffset=t)}removeExecutor(e,t,r){const{media:s,mediaSource:i}=this,a=this.tracks[e],l=a?.buffer;if(!s||!i||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const u=pe(s.duration)?s.duration:1/0,d=pe(i.duration)?i.duration:1/0,f=Math.max(0,t),m=Math.min(r,u,d);m>f&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${f},${m}] from the ${e} SourceBuffer`),l.remove(f,m)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],s=r?.buffer;if(!s)throw new EP(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,s=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const s=(r=this.tracks[t])==null?void 0:r.buffer;!s||s.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const s=this.tracks[e];if(!s)return;const i=s.buffer;if(!i)return;const a=r.bind(this,e);s.listeners.push({event:t,listener:a}),i.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(s=>{r.removeEventListener(s.event,s.listener)}),t.listeners.length=0)}}function e1(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function _P(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}function Nh(n){return n==="audio"?1:0}class r0{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.BUFFER_CODECS,this.onBufferCodecs,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(C.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&pe(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((s,i)=>this.isLevelAllowed(s)&&i<=e);return this.clientRect=null,r0.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const s=(l,u)=>u?l.width!==u.width||l.height!==u.height:!0;let i=e.length-1;const a=Math.max(t,r);for(let l=0;l<e.length;l+=1){const u=e[l];if((u.width>=a||u.height>=a)&&s(u,e[l+1])){i=l;break}}return i}}const kP={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},yn=kP,CP={HLS:"h"},AP=CP;class Ar{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof Ar?r:new Ar(r))),this.value=e,this.params=t}}const IP="Dict";function LP(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function RP(n,e,t,r){return new Error(`failed to ${n} "${LP(e)}" as ${t}`,{cause:r})}function Ir(n,e,t){return RP("serialize",n,e,t)}class pS{constructor(e){this.description=e}}const t1="Bare Item",PP="Boolean";function DP(n){if(typeof n!="boolean")throw Ir(n,PP);return n?"?1":"?0"}function NP(n){return btoa(String.fromCharCode(...n))}const jP="Byte Sequence";function OP(n){if(ArrayBuffer.isView(n)===!1)throw Ir(n,jP);return`:${NP(n)}:`}const MP="Integer";function FP(n){return n<-999999999999999||999999999999999<n}function gS(n){if(FP(n))throw Ir(n,MP);return n.toString()}function BP(n){return`@${gS(n.getTime()/1e3)}`}function xS(n,e){if(n<0)return-xS(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const s=Math.floor(n*t);return(s%2===0?s:s+1)/t}else return Math.round(n*t)/t}const UP="Decimal";function $P(n){const e=xS(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Ir(n,UP);const t=e.toString();return t.includes(".")?t:`${t}.0`}const VP="String",GP=/[\x00-\x1f\x7f]+/;function HP(n){if(GP.test(n))throw Ir(n,VP);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function KP(n){return n.description||n.toString().slice(7,-1)}const zP="Token";function n1(n){const e=KP(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Ir(e,zP);return e}function Hm(n){switch(typeof n){case"number":if(!pe(n))throw Ir(n,t1);return Number.isInteger(n)?gS(n):$P(n);case"string":return HP(n);case"symbol":return n1(n);case"boolean":return DP(n);case"object":if(n instanceof Date)return BP(n);if(n instanceof Uint8Array)return OP(n);if(n instanceof pS)return n1(n);default:throw Ir(n,t1)}}const WP="Key";function Km(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw Ir(n,WP);return n}function s0(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${Km(e)}`:`;${Km(e)}=${Hm(t)}`).join("")}function yS(n){return n instanceof Ar?`${Hm(n.value)}${s0(n.params)}`:Hm(n)}function qP(n){return`(${n.value.map(yS).join(" ")})${s0(n.params)}`}function YP(n,e={whitespace:!0}){if(typeof n!="object"||n==null)throw Ir(n,IP);const t=n instanceof Map?n.entries():Object.entries(n),r=e?.whitespace?" ":"";return Array.from(t).map(([s,i])=>{i instanceof Ar||(i=new Ar(i));let a=Km(s);return i.value===!0?a+=s0(i.params):(a+="=",Array.isArray(i.value)?a+=qP(i):a+=yS(i)),a}).join(`,${r}`)}function vS(n,e){return YP(n,e)}const vr="CMCD-Object",wt="CMCD-Request",ci="CMCD-Session",Ps="CMCD-Status",QP={br:vr,ab:vr,d:vr,ot:vr,tb:vr,tpb:vr,lb:vr,tab:vr,lab:vr,url:vr,pb:wt,bl:wt,tbl:wt,dl:wt,ltc:wt,mtp:wt,nor:wt,nrr:wt,rc:wt,sn:wt,sta:wt,su:wt,ttfb:wt,ttfbb:wt,ttlb:wt,cmsdd:wt,cmsds:wt,smrt:wt,df:wt,cs:wt,ts:wt,cid:ci,pr:ci,sf:ci,sid:ci,st:ci,v:ci,msd:ci,bs:Ps,bsd:Ps,cdn:Ps,rtp:Ps,bg:Ps,pt:Ps,ec:Ps,e:Ps},XP={REQUEST:wt};function ZP(n){return Object.keys(n).reduce((e,t)=>{var r;return(r=n[t])===null||r===void 0||r.forEach(s=>e[s]=t),e},{})}function JP(n,e){const t={};if(!n)return t;const r=Object.keys(n),s=e?ZP(e):{};return r.reduce((i,a)=>{var l;const u=QP[a]||s[a]||XP.REQUEST,d=(l=i[u])!==null&&l!==void 0?l:i[u]={};return d[a]=n[a],i},t)}function e5(n){return["ot","sf","st","e","sta"].includes(n)}function t5(n){return typeof n=="number"?pe(n):n!=null&&n!==""&&n!==!1}const wS="event";function n5(n,e){const t=new URL(n),r=new URL(e);if(t.origin!==r.origin)return n;const s=t.pathname.split("/").slice(1),i=r.pathname.split("/").slice(1,-1);for(;s[0]===i[0];)s.shift(),i.shift();for(;i.length;)i.shift(),s.unshift("..");return s.join("/")+t.search+t.hash}const yu=n=>Math.round(n),zm=(n,e)=>Array.isArray(n)?n.map(t=>zm(t,e)):n instanceof Ar&&typeof n.value=="string"?new Ar(zm(n.value,e),n.params):(e.baseUrl&&(n=n5(n,e.baseUrl)),e.version===1?encodeURIComponent(n):n),qc=n=>yu(n/100)*100,r5=(n,e)=>{let t=n;return e.version>=2&&(n instanceof Ar&&typeof n.value=="string"?t=new Ar([n]):typeof n=="string"&&(t=[n])),zm(t,e)},s5={br:yu,d:yu,bl:qc,dl:qc,mtp:qc,nor:r5,rtp:qc,tb:yu},bS="request",SS="response",i0=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],i5=["e"],a5=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function dd(n){return a5.test(n)}function o5(n){return i0.includes(n)||i5.includes(n)||dd(n)}const ES=["d","dl","nor","ot","rtp","su"];function l5(n){return i0.includes(n)||ES.includes(n)||dd(n)}const c5=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function u5(n){return i0.includes(n)||ES.includes(n)||c5.includes(n)||dd(n)}const d5=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function f5(n){return d5.includes(n)||dd(n)}const h5={[SS]:u5,[wS]:o5,[bS]:l5};function TS(n,e={}){const t={};if(n==null||typeof n!="object")return t;const r=e.version||n.v||1,s=e.reportingMode||bS,i=r===1?f5:h5[s];let a=Object.keys(n).filter(i);const l=e.filter;typeof l=="function"&&(a=a.filter(l));const u=s===SS||s===wS;u&&!a.includes("ts")&&a.push("ts"),r>1&&!a.includes("v")&&a.push("v");const d=et({},s5,e.formatters),f={version:r,reportingMode:s,baseUrl:e.baseUrl};return a.sort().forEach(m=>{let g=n[m];const x=d[m];if(typeof x=="function"&&(g=x(g,f)),m==="v"){if(r===1)return;g=r}m=="pr"&&g===1||(u&&m==="ts"&&!pe(g)&&(g=Date.now()),t5(g)&&(e5(m)&&typeof g=="string"&&(g=new pS(g)),t[m]=g))}),t}function m5(n,e={}){const t={};if(!n)return t;const r=TS(n,e),s=JP(r,e?.customHeaderMap);return Object.entries(s).reduce((i,[a,l])=>{const u=vS(l,{whitespace:!1});return u&&(i[a]=u),i},t)}function p5(n,e,t){return et(n,m5(e,t))}const g5="CMCD";function x5(n,e={}){return n?vS(TS(n,e),{whitespace:!1}):""}function y5(n,e={}){if(!n)return"";const t=x5(n,e);return encodeURIComponent(t)}function v5(n,e={}){if(!n)return"";const t=y5(n,e);return`${g5}=${t}`}const r1=/CMCD=[^&#]+/;function w5(n,e,t){const r=v5(e,t);if(!r)return n;if(r1.test(n))return n.replace(r1,r);const s=n.includes("?")?"&":"?";return`${n}${s}${r}`}class b5{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:yn.MANIFEST,su:!this.initialized})}catch(i){this.hls.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=s=>{try{const{frag:i,part:a}=s,l=this.hls.levels[i.level],u=this.getObjectType(i),d={d:(a||i).duration*1e3,ot:u};(u===yn.VIDEO||u===yn.AUDIO||u==yn.MUXED)&&(d.br=l.bitrate/1e3,d.tb=this.getTopBandwidth(u)/1e3,d.bl=this.getBufferLength(u));const f=a?this.getNextPart(a):this.getNextFrag(i);f!=null&&f.url&&f.url!==i.url&&(d.nor=f.url),this.apply(s,d)}catch(i){this.hls.logger.warn("Could not generate segment CMCD data.",i)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHED,this.onMediaDetached,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHED,this.onMediaDetached,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,s;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(s=t.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:AP.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){et(t,this.createData());const r=t.ot===yn.INIT||t.ot===yn.VIDEO||t.ot===yn.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((a,l)=>(s.includes(l)&&(a[l]=t[l]),a),{}));const i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),p5(e.headers,t,i)):e.url=w5(e.url,t,i)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const s=e.sn-r.startSN;return r.fragments[s+1]}}getNextPart(e){var t;const{index:r,fragment:s}=e,i=(t=this.hls.levels[s.level])==null||(t=t.details)==null?void 0:t.partList;if(i){const{sn:a}=s;for(let l=i.length-1;l>=0;l--){const u=i[l];if(u.index===r&&u.fragment.sn===a)return i[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return yn.TIMED_TEXT;if(e.sn==="initSegment")return yn.INIT;if(t==="audio")return yn.AUDIO;if(t==="main")return this.hls.audioTracks.length?yn.VIDEO:yn.MUXED}getTopBandwidth(e){let t=0,r;const s=this.hls;if(e===yn.AUDIO)r=s.audioTracks;else{const i=s.maxAutoLevel,a=i>-1?i+1:s.levels.length;r=s.levels.slice(0,a)}return r.forEach(i=>{i.bitrate>t&&(t=i.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===yn.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Fe.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,l){t(i),this.loader.load(i,a,l)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,l){t(i),this.loader.load(i,a,l)}}}}const S5=3e5;class E5 extends zn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if(r?.action===Kt.SendAlternateToPenaltyBox&&r.flags===In.MoveAllAlternatesMatchingHost){const s=this.levels;let i=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:l,pathwayId:u,type:d}=t.context;l&&s?a=this.getPathwayForGroupId(l,d,a):u&&(a=u)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!i&&s&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),r.resolved=this.pathwayId!==a),t.details===K.BUFFER_APPEND_ERROR&&!t.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${s&&s.length} priorities: ${rt(i)} penalized: ${rt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,s=performance.now();Object.keys(r).forEach(i=>{s-r[i]>S5&&delete r[i]});for(let i=0;i<e.length;i++){const a=e[i];if(a in r)continue;if(a===this.pathwayId)return;const l=this.hls.nextLoadLevel,u=this.hls.levels[l];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,Hb(t),this.hls.trigger(C.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[l];u&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==u.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==u.bitrate&&this.log(`Unstable Pathways change from bitrate ${u.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,r){const s=this.getLevelsForPathway(r).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(t===Ge.AUDIO_TRACK&&s[i].hasAudioGroup(e)||t===Ge.SUBTITLE_TRACK&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},s={};e.forEach(i=>{const{ID:a,"BASE-ID":l,"URI-REPLACEMENT":u}=i;if(t.some(f=>f.pathwayId===a))return;const d=this.getLevelsForPathway(l).map(f=>{const m=new ht(f.attrs);m["PATHWAY-ID"]=a;const g=m.AUDIO&&`${m.AUDIO}_clone_${a}`,x=m.SUBTITLES&&`${m.SUBTITLES}_clone_${a}`;g&&(r[m.AUDIO]=g,m.AUDIO=g),x&&(s[m.SUBTITLES]=x,m.SUBTITLES=x);const y=_S(f.uri,m["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",u),w=new rl({attrs:m,audioCodec:f.audioCodec,bitrate:f.bitrate,height:f.height,name:f.name,url:y,videoCodec:f.videoCodec,width:f.width});if(f.audioGroups)for(let b=1;b<f.audioGroups.length;b++)w.addGroupId("audio",`${f.audioGroups[b]}_clone_${a}`);if(f.subtitleGroups)for(let b=1;b<f.subtitleGroups.length;b++)w.addGroupId("text",`${f.subtitleGroups[b]}_clone_${a}`);return w});t.push(...d),s1(this.audioTracks,r,u,a),s1(this.subtitleTracks,s,u,a)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const f=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+f)}const i={responseType:"json",url:s.href},a=t.steeringManifestLoadPolicy.default,l=a.errorRetry||a.timeoutRetry||{},u={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},d={onSuccess:(f,m,g,x)=>{this.log(`Loaded steering manifest: "${s}"`);const y=f.data;if(y?.VERSION!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":w,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":E}=y;if(w)try{this.uri=new self.URL(w,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${w}`);return}this.scheduleRefresh(this.uri||g.url),b&&this.clonePathways(b);const T={steeringManifest:y,url:s.toString()};this.hls.trigger(C.STEERING_MANIFEST_LOADED,T),E&&this.updatePathwayPriority(E)},onError:(f,m,g,x)=>{if(this.log(`Error loading steering manifest: ${f.code} ${f.text} (${m.url})`),this.stopLoad(),f.code===410){this.enabled=!1,this.log(`Steering manifest ${m.url} no longer available`);return}let y=this.timeToLoad*1e3;if(f.code===429){const w=this.loader;if(typeof w?.getResponseHeader=="function"){const b=w.getResponseHeader("Retry-After");b&&(y=parseFloat(b)*1e3)}this.log(`Steering manifest ${m.url} rate limited`);return}this.scheduleRefresh(this.uri||m.url,y)},onTimeout:(f,m,g)=>{this.log(`Timeout loading steering manifest (${m.url})`),this.scheduleRefresh(this.uri||m.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(i,u,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const s=(r=this.hls)==null?void 0:r.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function s1(n,e,t,r){n&&Object.keys(e).forEach(s=>{const i=n.filter(a=>a.groupId===s).map(a=>{const l=et({},a);return l.details=void 0,l.attrs=new ht(l.attrs),l.url=l.attrs.URI=_S(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[s],l.attrs["PATHWAY-ID"]=r,l});n.push(...i)})}function _S(n,e,t,r){const{HOST:s,PARAMS:i,[t]:a}=r;let l;e&&(l=a?.[e],l&&(n=l));const u=new self.URL(n);return s&&!l&&(u.host=s),i&&Object.keys(i).sort().forEach(d=>{d&&u.searchParams.set(d,i[d])}),u.href}class va extends zn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=va.CDMCleanupPromise?[va.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:r,initData:s}=t,i=`"${t.type}" event: init data type: "${r}"`;if(this.debug(i),s!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=Fo(this.config));const l=a.map(kh).filter(u=>!!u);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(a=>{const l=pu(a);if(r!=="sinf"||l!==pt.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${r}" for selected key-system ${l}`);return}let u;try{const x=Dt(new Uint8Array(s)),y=Wp(JSON.parse(x).sinf),w=vb(y);if(!w)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");u=new Uint8Array(w.subarray(8,24))}catch(x){this.warn(`${i} Failed to parse sinf: ${x}`);return}const d=zt(u),{keyIdToKeySessionPromise:f,mediaKeySessions:m}=this;let g=f[d];for(let x=0;x<m.length;x++){const y=m[x],w=y.decryptdata;if(!w.keyId)continue;const b=zt(w.keyId);if(Nu(u,w.keyId)||w.uri.replace(/-/g,"").indexOf(d)!==-1){if(g=f[b],!g)continue;if(w.pssh)break;delete f[b],w.pssh=new Uint8Array(s),w.keyId=u,g=f[d]=g.then(()=>this.generateRequestWithPreferredKeySession(y,r,s,"encrypted-event-key-match")),g.catch(E=>this.handleError(E));break}}g||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${m.length}.`))}).catch(a=>this.handleError(a))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(C.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(C.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(C.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(C.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,s=t?.[e];if(s)return s.licenseUrl;if(e===pt.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t?.[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(a,l,u)=>!!a&&u.indexOf(a)===l,s=t.map(a=>a.audioCodec).filter(r),i=t.map(a=>a.videoCodec).filter(r);return s.length+i.length===0&&i.push("avc1.42e01e"),new Promise((a,l)=>{const u=d=>{const f=d.shift();this.getMediaKeysPromise(f,s,i).then(m=>a({keySystem:f,mediaKeys:m})).catch(m=>{d.length?u(d):m instanceof An?l(m):l(new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_ACCESS,error:m,fatal:!0},m.message))})};u(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return Ob===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(e,t)}getMediaKeysPromise(e,t,r){var s;const i=r3(e,t,r,this.config.drmSystemOptions||{});let a=this.keySystemAccessPromises[e],l=(s=a)==null?void 0:s.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${rt(i)}`),l=this.requestMediaKeySystemAccess(e,i);const u=a=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),l.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const f=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const m=u.mediaKeys=d.createMediaKeys().then(g=>(this.log(`Media-keys created for "${e}"`),u.hasMediaKeys=!0,f.then(x=>x?this.setMediaKeysServerCertificate(g,e,x):g)));return m.catch(g=>{this.error(`Failed to create media-keys for "${e}"}: ${g}`)}),m})}return l.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${zt(e.keyId||[])} keyUri: ${e.uri}`);const s=r.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),s=Yc(t),i="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,i,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${zt(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>kh(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const i=kh(s);i?t(i):r(new Error(`Unable to find format for key-system "${s}"`))}).catch(r)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Fo(this.config),r=e.map(pu).filter(s=>!!s&&t.indexOf(s)!==-1);return this.selectKeySystem(r)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let r=0;r<t.length;r++){const s=T5(e,t[r]);if(s)return s}}loadKey(e){const t=e.keyInfo.decryptdata,r=Yc(t),s=this.bannedKeyIds[r];if(s||this.getKeyStatus(t)==="internal-error"){const l=i1(s||"internal-error",t);return this.handleError(l,e.frag),Promise.reject(l)}const i=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);const a=this.keyIdToKeySessionPromise[r];if(!a){const l=this.getKeySystemForKeyPromise(t).then(({keySystem:u,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(u,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:u,mediaKeys:d,decryptdata:t}))))).then(u=>{const d="cenc",f=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(u,d,f,"playlist-key")});return l.catch(u=>this.handleError(u,e.frag)),this.keyIdToKeySessionPromise[r]=l,l}return a.catch(l=>{if(l instanceof An){const u=Xe({},l.data);this.getKeyStatus(t)==="internal-error"&&(u.decryptdata=t);const d=new An(u,l.message);this.handleError(d,e.frag)}}),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof An){t&&(e.data.frag=t);const r=e.data.decryptdata;this.error(`${e.message}${r?` (${zt(r.keyId||[])})`:""}`),this.hls.trigger(C.ERROR,e.data)}else this.error(e.message),this.hls.trigger(C.ERROR,{type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=Yc(e),r=this.keyIdToKeySessionPromise[t];if(!r){const s=pu(e.keyFormat),i=s?[s]:Fo(this.config);return this.attemptKeySystemAccess(i)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=Fo(this.config)),e.length===0)throw new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${rt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(r).then(()=>this.media?this.media.setMediaKeys(t):new Promise((i,a)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return a(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(i).catch(a)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(i=>r.indexOf(i)===-1)})}generateRequestWithPreferredKeySession(e,t,r,s){var i;const a=(i=this.config.drmSystems)==null||(i=i[e.keySystem])==null?void 0:i.generateRequest;if(a)try{const y=a.call(this.hls,t,r,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,r=y.initData?y.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=Yc(e.decryptdata),u=e.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${l} URI: ${u} (init data type: ${t} length: ${r.byteLength})`);const d=new Yp,f=e._onmessage=y=>{const w=e.mediaKeysSession;if(!w){d.emit("error",new Error("invalid state"));return}const{messageType:b,message:E}=y;this.log(`"${b}" message event for session "${w.sessionId}" message size: ${E.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,E).catch(T=>{d.eventNames().length?d.emit("error",T):this.handleError(T)}):b==="license-release"?e.keySystem===pt.FAIRPLAY&&this.updateKeySession(e,Fm("acknowledged")).then(()=>this.removeSession(e)).catch(T=>this.handleError(T)):this.warn(`unhandled media key message type "${b}"`)},m=(y,w)=>{w.keyStatus=y;let b;y.startsWith("usable")?d.emit("resolved"):y==="internal-error"||y==="output-restricted"||y==="output-downscaled"?b=i1(y,w.decryptdata):y==="expired"?b=new Error(`key expired (keyId: ${l})`):y==="released"?b=new Error("key released"):y==="status-pending"||this.warn(`unhandled key status change "${y}" (keyId: ${l})`),b&&(d.eventNames().length?d.emit("error",b):this.handleError(b))},g=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const b=this.getKeyStatuses(e);if(!Object.keys(b).some(A=>b[A]!=="status-pending"))return;if(b[l]==="expired"){this.log(`Expired key ${rt(b)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let T=b[l];if(T)m(T,e);else{var _;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(_=e.keyStatusTimeouts)[l]||(_[l]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const I=this.getKeyStatus(e.decryptdata);if(I&&I!=="status-pending")return this.log(`No status for keyId ${l} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${I} from other session.`),m(I,e);this.log(`key status for ${l} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),T="internal-error",m(T,e)},1e3)),this.log(`No status for keyId ${l} (${rt(b)}).`)}};ln(e.mediaKeysSession,"message",f),ln(e.mediaKeysSession,"keystatuseschange",g);const x=new Promise((y,w)=>{d.on("error",w),d.on("resolved",y)});return e.mediaKeysSession.generateRequest(t,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l} URI: ${u}`)}).catch(y=>{throw new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>x).catch(y=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw y}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((r,s)=>{if(typeof s=="string"&&typeof r=="object"){const l=s;s=r,r=l}const i="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);if(e.keySystem===pt.PLAYREADY&&i.length===16){const l=zt(i);t[l]=r,Nb(i)}const a=zt(i);r==="internal-error"&&(this.bannedKeyIds[a]=r),this.log(`key status change "${r}" for keyStatuses keyId: ${a} key-session "${e.mediaKeysSession.sessionId}"`),t[a]=r}),t}fetchServerCertificate(e){const t=this.config,r=t.loader,s=new r(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,l)=>{const u={responseType:"arraybuffer",url:i},d=t.certLoadPolicy.default,f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(g,x,y,w)=>{a(g.data)},onError:(g,x,y,w)=>{l(new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:Xe({url:u.url,data:void 0},g)},`"${e}" certificate request failed (${i}). Status: ${g.code} (${g.text})`))},onTimeout:(g,x,y)=>{l(new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(g,x,y)=>{l(new Error("aborted"))}};s.load(u,f,m)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((s,i)=>{e.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r.byteLength}) on "${t}"`),s(e)}).catch(a=>{i(new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(s=>{throw new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=new DOMParser().parseFromString(r,"application/xml"),i=s.querySelectorAll("HttpHeader");if(i.length>0){let f;for(let m=0,g=i.length;m<g;m++){var a,l;f=i[m];const x=(a=f.querySelector("name"))==null?void 0:a.textContent,y=(l=f.querySelector("value"))==null?void 0:l.textContent;x&&y&&e.setRequestHeader(x,y)}}const u=s.querySelector("Challenge"),d=u?.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Fm(atob(d))}setupLicenseXHR(e,t,r,s){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,r,s)}).catch(a=>{if(!r.decryptdata)throw a;return e.open("POST",t,!0),i.call(this.hls,e,t,r,s)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||s})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((s,i)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let u=l.response;this.log(`License received ${u instanceof ArrayBuffer?u.byteLength:u}`);const d=this.config.licenseResponseCallback;if(d)try{u=d.call(this.hls,l,a,e)}catch(f){this.error(f)}s(u)}else{const u=r.errorRetry,d=u?u.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||l.status>=400&&l.status<500)i(new An({type:Ce.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:a,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${a}). Status: ${l.status} (${l.statusText})`));else{const f=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${f} attempts left`),this.requestLicense(e,t).then(s,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,a,e,t).then(({xhr:u,licenseChallenge:d})=>{e.keySystem==pt.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(u,d)),u.send(d)}).catch(i)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,ln(r,"encrypted",this.onMediaEncrypted),ln(r,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=r.mediaKeys}onMediaDetached(){const e=this.media;e&&(bn(e,"encrypted",this.onMediaEncrypted),bn(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const r=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Bs.clearKeyUriToKeyIdMap();const i=s.length;va.CDMCleanupPromise=Promise.all(s.map(a=>this.removeSession(a)).concat((r==null||(e=r.setMediaKeys(null))==null?void 0:e.catch(a=>{this.log(`Could not clear media keys: ${a}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))||Promise.resolve())).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((s,i)=>(s.indexOf(i.keyFormat)===-1&&s.push(i.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r,decryptdata:s}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${zt(s?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{keyStatusTimeouts:a}=e;a&&Object.keys(a).forEach(d=>self.clearTimeout(a[d]));const{drmSystemOptions:l}=this.config;return(i3(l)?new Promise((d,f)=>{self.setTimeout(()=>f(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(f)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}va.CDMCleanupPromise=void 0;function Yc(n){if(!n)throw new Error("Could not read keyId of undefined decryptdata");if(n.keyId===null)throw new Error("keyId is null");return zt(n.keyId)}function T5(n,e){if(n.keyId&&e.mediaKeysSession.keyStatuses.has(n.keyId))return e.mediaKeysSession.keyStatuses.get(n.keyId);if(n.matches(e.decryptdata))return e.keyStatus}class An extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function i1(n,e){const t=n==="output-restricted",r=t?K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:K.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new An({type:Ce.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${n}"`)}class _5{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(C.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(C.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const s=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const s=performance.now();if(t){if(this.lastTime){const i=s-this.lastTime,a=r-this.lastDroppedFrames,l=t-this.lastDecodedFrames,u=1e3*a/i,d=this.hls;if(d.trigger(C.FPS_DROP,{currentDropped:a,currentDecoded:l,totalDroppedFrames:r}),u>0&&a>d.config.fpsDroppedMonitoringThreshold*l){let f=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=f)&&(f=f-1,d.trigger(C.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:d.currentLevel}),d.autoLevelCapping=f,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function kS(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function CS(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){Ze.debug(`[texttrack-utils]: ${r}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,n.addCue(s)}catch(s){Ze.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}t==="disabled"&&(n.mode=t)}function fa(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues)for(let r=n.cues.length;r--;)e&&n.cues[r].removeEventListener("enter",e),n.removeCue(n.cues[r]);t==="disabled"&&(n.mode=t)}function Wm(n,e,t,r){const s=n.mode;if(s==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const i=C5(n.cues,e,t);for(let a=0;a<i.length;a++)(!r||r(i[a]))&&n.removeCue(i[a])}s==="disabled"&&(n.mode=s)}function k5(n,e){if(e<=n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,s=t,i;for(;r<=s;)if(i=Math.floor((s+r)/2),e<n[i].startTime)s=i-1;else if(e>n[i].startTime&&r<t)r=i+1;else return i;return n[r].startTime-e<e-n[s].startTime?r:s}function C5(n,e,t){const r=[],s=k5(n,e);if(s>-1)for(let i=s,a=n.length;i<a;i++){const l=n[i];if(l.startTime>=e&&l.endTime<=t)r.push(l);else if(l.startTime>t)return r}return r}function vu(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}class A5 extends n0{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=vu(this.media.textTracks);for(let i=0;i<r.length;i++)if(r[i].mode==="hidden")t=r[i];else if(r[i].mode==="showing"){t=r[i];break}const s=this.findTrackForTextTrack(t);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;vu(r.textTracks).forEach(a=>{fa(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:s,details:i}=t,a=this.tracksInGroup[r];if(!a||a.groupId!==s){this.warn(`Subtitle track with id:${r} and group:${s} not found in active group ${a?.groupId}`);return}const l=a.details;a.details=t.details,this.log(`Subtitle track ${r} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,s=this.groupIds;let i=this.currentTrack;if(!r||s?.length!==r?.length||r!=null&&r.some(a=>s?.indexOf(a)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!r||r.indexOf(f.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,m)=>{f.id=m});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.subtitlePreference;if(!i&&l){this.selectDefaultTrack=!1;const f=_r(l,a);if(f>-1)i=a[f];else{const m=_r(l,this.tracks);i=this.tracks[m]}}let u=this.findTrackId(i);u===-1&&i&&(u=this.findTrackId(null));const d={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${r?.join(",")}" group-id`),this.hls.trigger(C.SUBTITLE_TRACKS_UPDATED,d),u!==-1&&this.trackId===-1&&this.setSubtitleTrack(u)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const i=t[s];if(!(r&&!i.default||!r&&!e)&&(!e||bi(i,e)))return s}if(e){for(let s=0;s<t.length;s++){const i=t[s];if(ol(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<t.length;s++){const i=t[s];if(ol(e.attrs,i.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const s=t[r];if(Gm(s,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Ge.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&bi(e,r))return r;const s=_r(e,this.tracksInGroup);if(s>-1){const i=this.tracksInGroup[s];return this.setSubtitleTrack(s),i}else{if(r)return null;{const i=_r(e,t);if(i>-1)return t[i]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,t),a=e.details,l=a?.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(C.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=vu(e.textTracks),r=this.currentTrack;let s;if(r&&(s=t.filter(i=>Gm(r,i))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(i=>{i.mode!=="disabled"&&i!==s&&(i.mode="disabled")}),s){const i=this.subtitleDisplay?"showing":"hidden";s.mode!==i&&(s.mode=i)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!pe(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:e});return}const i=!!s.details&&!s.details.live;if(e===this.trackId&&s===r&&i)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:a,groupId:l="",name:u,type:d,url:f}=s;this.hls.trigger(C.SUBTITLE_TRACK_SWITCH,{id:a,groupId:l,name:u,type:d,url:f});const m=this.switchParams(s.url,r?.details,s.details);this.loadPlaylist(m)}}function I5(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?i:i&3|8).toString(16)})}}}function Ho(n){let e=5381,t=n.length;for(;t;)e=e*33^n.charCodeAt(--t);return(e>>>0).toString()}const wa=.025;let Fu=(function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n})({});function L5(n,e,t){return`${n.identifier}-${t+1}-${Ho(e)}`}class R5{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return jh(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=jh(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=pe(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return jh(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<wa))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Fu.Range:Fu.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return P5(this)}}function jh(n,e){return n-e.start<e.duration/2&&!(Math.abs(n-(e.start+e.duration))<wa)?e.start:e.start+e.duration}function AS(n,e,t){const r=new self.URL(n,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function Oh(n,e){for(;(t=n.assetList[++e])!=null&&t.error;)var t;return e}function P5(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function ca(n){const e=n.timelineStart,t=n.duration||0;return`["${n.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class D5{constructor(e,t,r,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(C.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new e(t);this.interstitial=r,this.assetItem=s;const a=()=>{this.hasDetails=!0};i.once(C.LEVEL_LOADED,a),i.once(C.AUDIO_TRACK_LOADED,a),i.once(C.SUBTITLE_TRACK_LOADED,a),i.on(C.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(C.BUFFER_APPENDED,()=>{const f=this.bufferedEnd;this.reachedPlayout(f)&&(this._bufferedEosTime=f,i.trigger(C.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=AS(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,i=Fe.bufferInfo(e,s,0);return this.getAssetTime(i.end)>=r-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Fe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const r=t-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){var s;(s=this.hls)==null||s.on(e,t)}once(e,t,r){var s;(s=this.hls)==null||s.once(e,t)}off(e,t,r){var s;(s=this.hls)==null||s.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${ca(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const a1=.033;class N5 extends zn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(i=s[r])!=null&&i.event;){var i;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let s=0;s<r.length;s++){let i=r[s];if(t&&t!=="primary"&&(i=i[t]),e===i.start||e>i.start&&e<i.end)return s}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let s=e;s<=t&&r[s];s++){const i=r[s].event;if(i!=null&&i.restrictions.jump&&!i.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var r;if(((r=t[s].event)==null?void 0:r.identifier)===e)return s}return-1}findAssetIndex(e,t){const r=e.assetList,s=r.length;if(s>1)for(let i=0;i<s;i++){const a=r[i];if(!a.error){const l=a.timelineStart;if(t===l||t>l&&(t<l+(a.duration||0)||i===s-1))return i}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const r=t.assetList,s=r[r.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:s}=r,i=this.events,a=this.parseDateRanges(s,{url:r.url},t),l=Object.keys(s),u=i?i.filter(d=>!l.includes(d.identifier)):[];a.length&&a.sort((d,f)=>{const m=d.cue.pre,g=d.cue.post,x=f.cue.pre,y=f.cue.post;if(m&&!x)return-1;if(x&&!m||g&&!y)return 1;if(y&&!g)return-1;if(!m&&!x&&!g&&!y){const w=d.startTime,b=f.startTime;if(w!==b)return w-b}return d.dateRange.tagOrder-f.dateRange.tagOrder}),this.events=a,u.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,u)}updateSchedule(e,t=[],r=!1){const s=this.events||[];if(s.length||t.length||this.length<2){const i=this.items,a=this.parseSchedule(s,e);(r||t.length||i?.length!==a.length||a.some((u,d)=>Math.abs(u.playout.start-i[d].playout.start)>.005||Math.abs(u.playout.end-i[d].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(t,i))}}parseDateRanges(e,t,r){const s=[],i=Object.keys(e);for(let a=0;a<i.length;a++){const l=i[a],u=e[l];if(u.isInterstitial){let d=this.eventMap[l];d?d.setDateRange(u):(d=new R5(u,t),this.eventMap[l]=d,r===!1&&(d.appendInPlace=r)),s.push(d)}}return s}parseSchedule(e,t){const r=[],s=t.main.details,i=s.live?1/0:s.edge;let a=0;if(e=e.filter(u=>!u.error&&!(u.cue.once&&u.hasPlayed)),e.length){this.resolveOffsets(e,t);let u=0,d=0;if(e.forEach((f,m)=>{const g=f.cue.pre,x=f.cue.post,y=e[m-1]||null,w=f.appendInPlace,b=x?i:f.startOffset,E=f.duration,T=f.timelineOccupancy===Fu.Range?E:0,_=f.resumptionOffset,A=y?.startTime===b,I=b+f.cumulativeDuration;let N=w?I+E:b+_;if(g||!x&&b<=0){const O=d;d+=T,f.timelineStart=I;const M=a;a+=E,r.push({event:f,start:I,end:N,playout:{start:M,end:a},integrated:{start:O,end:d}})}else if(b<=i){if(!A){const D=b-u;if(D>a1){const B=u,q=d;d+=D;const ie=a;a+=D;const te={previousEvent:e[m-1]||null,nextEvent:f,start:B,end:B+D,playout:{start:ie,end:a},integrated:{start:q,end:d}};r.push(te)}else D>0&&y&&(y.cumulativeDuration+=D,r[r.length-1].end=b)}x&&(N=I),f.timelineStart=I;const O=d;d+=T;const M=a;a+=E,r.push({event:f,start:I,end:N,playout:{start:M,end:a},integrated:{start:O,end:d}})}else return;const P=f.resumeTime;x||P>i?u=i:u=P}),u<i){var l;const f=u,m=d,g=i-u;d+=g;const x=a;a+=g,r.push({previousEvent:((l=r[r.length-1])==null?void 0:l.event)||null,nextEvent:null,start:u,end:f+g,playout:{start:x,end:a},integrated:{start:m,end:d}})}this.setDurations(i,a,d)}else r.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,s=r.live?1/0:r.edge;let i=0,a=-1;e.forEach((l,u)=>{const d=l.cue.pre,f=l.cue.post,m=d?0:f?s:l.startTime;this.updateAssetDurations(l),a===m?l.cumulativeDuration=i:(i=0,a=m),!f&&l.snapOptions.in&&(l.resumeAnchor=ki(null,r.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),l.appendInPlace&&!l.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(l,t)||(l.appendInPlace=!1)),!l.appendInPlace&&u+1<e.length&&e[u+1].startTime-e[u].resumeTime<a1&&(e[u+1].appendInPlace=!1,e[u+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));const x=pe(l.resumeOffset)?l.resumeOffset:l.duration;i+=x})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(r-s)>wa?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${s}`),!1):!Object.keys(t).some(a=>{const l=t[a].details,u=l.edge;if(r>=u)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${u}`),!1;const d=ki(null,l.fragments,r);if(!d)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${l.fragStart}-${l.fragmentEnd})`),!0;const f=a==="audio"?.175:0;return Math.abs(d.start-r)<wa+f||Math.abs(d.end-r)<wa+f?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,s=!1,i=!1;for(let a=0;a<e.assetList.length;a++){const l=e.assetList[a],u=t+r;l.startOffset=r,l.timelineStart=u,s||(s=l.duration===null),i||(i=!!l.error);const d=l.error?0:l.duration||0;r+=d}s&&!i?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function nr(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class j5{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let s;try{s=AS(r,this.hls.sessionId,e.baseUrl)}catch(g){const x=this.assignAssetListError(e,K.ASSET_LIST_LOAD_ERROR,g,r);this.hls.trigger(C.ERROR,x);return}t&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+t);const i=this.hls.config,a=i.loader,l=new a(i),u={responseType:"json",url:s.href},d=i.interstitialAssetListLoadPolicy.default,f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(g,x,y,w)=>{const b=g.data,E=b?.ASSETS;if(!Array.isArray(E)){const T=this.assignAssetListError(e,K.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,x,w);this.hls.trigger(C.ERROR,T);return}e.assetListResponse=b,this.hls.trigger(C.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:w})},onError:(g,x,y,w)=>{const b=this.assignAssetListError(e,K.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${g.code} ${g.text} (${x.url})`),x.url,w,y);this.hls.trigger(C.ERROR,b)},onTimeout:(g,x,y)=>{const w=this.assignAssetListError(e,K.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${x.url})`),x.url,g,y);this.hls.trigger(C.ERROR,w)}};return l.load(u,f,m),this.hls.trigger(C.ASSET_LIST_LOADING,{event:e}),l}assignAssetListError(e,t,r,s,i,a){return e.error=r,{type:Ce.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:r,networkDetails:a,stats:i}}}function o1(n){var e;n==null||(e=n.play())==null||e.catch(()=>{})}function Qc(n,e){return`[${n}] Advancing timeline position to ${e}`}class O5 extends zn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled||!this.schedule)return;const s=r-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const a=s<=-.01;this.timelinePos=r,this.bufferedPos=r;const l=this.playingItem;if(!l){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(r,r-s)&&this.updateSchedule(!0),this.checkBuffer(),a&&r<l.start||r>=l.end){var u;const x=this.findItemIndex(l);let y=this.schedule.findItemIndexAtTime(r);if(y===-1&&(y=x+(a?-1:1),this.log(`seeked ${a?"back ":""}to position not covered by schedule ${r} (resolving from ${x} to ${y})`)),!this.isInterstitial(l)&&(u=this.media)!=null&&u.paused&&(this.shouldPlay=!1),!a&&y>x){const w=this.schedule.findJumpRestrictedIndex(x+1,y);if(w>x){this.setSchedulePosition(w);return}}this.setSchedulePosition(y);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(l)){const x=l.event.assetList[0];x&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,x))}return}const f=d.timelineStart,m=d.duration||0;if(a&&r<f||r>=f+m){var g;(g=l.event)!=null&&g.appendInPlace&&(this.clearAssetPlayers(l.event,l),this.flushFrontBuffer(r)),this.setScheduleToAssetAtTime(r,d)}},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(r>=s.end){this.timelinePos=s.end;const l=this.findItemIndex(s);this.setSchedulePosition(l+1)}const i=this.playingAsset;if(!i)return;const a=i.timelineStart+(i.duration||0);r>=a&&this.setScheduleToAssetAtTime(r,i)},this.onScheduleUpdate=(r,s)=>{const i=this.schedule;if(!i)return;const a=this.playingItem,l=i.events||[],u=i.items||[],d=i.durations,f=r.map(w=>w.identifier),m=!!(l.length||f.length);(m||s)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${u.map(w=>nr(w))} pos: ${this.timelinePos}`),f.length&&this.log(`Removed events ${f}`);let g=null,x=null;a&&(g=this.updateItem(a,this.timelinePos),this.itemsMatch(a,g)?this.playingItem=g:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y&&(x=this.updateItem(y,this.bufferedPos),this.itemsMatch(y,x)?this.bufferingItem=x:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))),r.forEach(w=>{w.assetList.forEach(b=>{this.clearAssetPlayer(b.identifier,null)})}),this.playerQueue.forEach(w=>{if(w.interstitial.appendInPlace){const b=w.assetItem.timelineStart,E=w.timelineOffset-b;if(E)try{w.timelineOffset=b}catch(T){Math.abs(E)>wa&&this.warn(`${T} ("${w.assetId}" ${w.timelineOffset}->${b})`)}}}),m||s){if(this.hls.trigger(C.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:u.slice(0),durations:d,removedIds:f}),this.isInterstitial(a)&&f.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}a&&this.trimInPlace(g,a),y&&x!==g&&this.trimInPlace(x,y),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new j5(e),this.schedule=new N5(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(C.MEDIA_ENDED,this.onMediaEnded,this),e.on(C.ERROR,this.onError,this),e.on(C.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(C.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(C.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(C.BUFFER_CODECS,this.onBufferCodecs,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(C.MEDIA_ENDED,this.onMediaEnded,this),e.off(C.ERROR,this.onError,this),e.off(C.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){bn(e,"play",this.onPlay),bn(e,"pause",this.onPause),bn(e,"seeking",this.onSeeking),bn(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;ln(r,"seeking",this.onSeeking),ln(r,"timeupdate",this.onTimeupdate),ln(r,"play",this.onPlay),ln(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!s){this.clearScheduleState();const i=this.findItemIndex(r);this.setSchedulePosition(i)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,s=this.media;if(this.media=null,!r&&(s&&this.removeMediaListeners(s),this.detachedData)){const i=this.getBufferingPlayer();i&&(this.log(`Removing schedule state for detachedData and ${i}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=m=>m&&e.getAssetPlayer(m.identifier),s=(m,g,x,y,w)=>{if(m){let b=m[g].start;const E=m.event;if(E){if(g==="playout"||E.timelineOccupancy!==Fu.Point){const T=r(x);T?.interstitial===E&&(b+=T.assetItem.startOffset+T[w])}}else{const T=y==="bufferedPos"?a():e[y];b+=T-m.start}return b}return 0},i=(m,g)=>{var x;if(m!==0&&g!=="primary"&&(x=e.schedule)!=null&&x.length){var y;const w=e.schedule.findItemIndexAtTime(m),b=(y=e.schedule.items)==null?void 0:y[w];if(b){const E=b[g].start-b.start;return m+E}}return m},a=()=>{const m=e.bufferedPos;return m===Number.MAX_VALUE?l("primary"):Math.max(m,0)},l=m=>{var g,x;return(g=e.primaryDetails)!=null&&g.live?e.primaryDetails.edge:((x=e.schedule)==null?void 0:x.durations[m])||0},u=(m,g)=>{var x,y;const w=e.effectivePlayingItem;if(w!=null&&(x=w.event)!=null&&x.restrictions.skip||!e.schedule)return;e.log(`seek to ${m} "${g}"`);const b=e.effectivePlayingItem,E=e.schedule.findItemIndexAtTime(m,g),T=(y=e.schedule.items)==null?void 0:y[E],_=e.getBufferingPlayer(),A=_?.interstitial,I=A?.appendInPlace,N=b&&e.itemsMatch(b,T);if(b&&(I||N)){const P=r(e.playingAsset),O=P?.media||e.primaryMedia;if(O){const M=g==="primary"?O.currentTime:s(b,g,e.playingAsset,"timelinePos","currentTime"),D=m-M,B=(I?M:O.currentTime)+D;if(B>=0&&(!P||I||B<=P.duration)){O.currentTime=B;return}}}if(T){let P=m;if(g!=="primary"){const M=T[g].start,D=m-M;P=T.start+D}const O=!e.isInterstitial(T);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(O||T.event.appendInPlace)){const M=e.media||(I?_?.media:null);M&&(M.currentTime=P)}else if(b){const M=e.findItemIndex(b);if(E>M){const B=e.schedule.findJumpRestrictedIndex(M+1,E);if(B>M){e.setSchedulePosition(B);return}}let D=0;if(O)e.timelinePos=P,e.checkBuffer();else{const B=T.event.assetList,q=m-(T[g]||T).start;for(let ie=B.length;ie--;){const te=B[ie];if(te.duration&&q>=te.startOffset&&q<te.startOffset+te.duration){D=ie;break}}}e.setSchedulePosition(E,D)}}},d=()=>{const m=e.effectivePlayingItem;if(e.isInterstitial(m))return m;const g=t();return e.isInterstitial(g)?g:null},f={get bufferedEnd(){const m=t(),g=e.bufferingItem;if(g&&g===m){var x;return s(g,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-g.playout.start||((x=e.bufferingAsset)==null?void 0:x.startOffset)||0}return 0},get currentTime(){const m=d(),g=e.effectivePlayingItem;return g&&g===m?s(g,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-g.playout.start:0},set currentTime(m){const g=d(),x=e.effectivePlayingItem;x&&x===g&&u(m+x.playout.start,"playout")},get duration(){const m=d();return m?m.playout.end-m.playout.start:0},get assetPlayers(){var m;const g=(m=d())==null?void 0:m.event.assetList;return g?g.map(x=>e.getAssetPlayer(x.identifier)):[]},get playingIndex(){var m;const g=(m=d())==null?void 0:m.event;return g&&e.effectivePlayingAsset?g.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var m;return((m=e.schedule)==null||(m=m.events)==null?void 0:m.slice(0))||[]},get schedule(){var m;return((m=e.schedule)==null||(m=m.items)==null?void 0:m.slice(0))||[]},get interstitialPlayer(){return d()?f:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const m=t();return e.findItemIndex(m)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const m=e.effectivePlayingItem;return e.findItemIndex(m)},primary:{get bufferedEnd(){return a()},get currentTime(){const m=e.timelinePos;return m>0?m:0},set currentTime(m){u(m,"primary")},get duration(){return l("primary")},get seekableStart(){var m;return((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(m){u(m,"integrated")},get duration(){return l("integrated")},get seekableStart(){var m;return i(((m=e.primaryDetails)==null?void 0:m.fragmentStart)||0,"integrated")}},skip:()=>{const m=e.effectivePlayingItem,g=m?.event;if(g&&!g.restrictions.skip){const x=e.findItemIndex(m);if(g.appendInPlace){const y=m.playout.start+m.event.duration;u(y+.001,"playout")}else e.advanceAfterAssetEnded(g,x,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(s=this.primaryMedia);const i=(t=s)==null?void 0:t.currentTime;if(!(i===void 0||!pe(i)))return i}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,s=e.media;if(r&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s){this.detachedData={media:s};return}const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${rt(i)}`),this.detachedData=i}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var r,s;if(e.media===t)return;let i=null;const a=this.hls,l=e!==a,u=l&&e.interstitial.appendInPlace,d=(r=this.detachedData)==null?void 0:r.mediaSource;let f;if(a.media)u&&(i=a.transferMedia(),this.detachedData=i),f="Primary";else if(d){const y=this.getBufferingPlayer();y?(i=y.transferMedia(),f=`${y}`):f="detached MediaSource"}else f="detached media";if(!i){if(d)i=this.detachedData,this.log(`using detachedData: MediaSource ${rt(i)}`);else if(!this.detachedData||a.media===t){const y=this.playerQueue;y.length>1&&y.forEach(w=>{if(l&&w.interstitial.appendInPlace!==u){const b=w.interstitial;this.clearInterstitial(w.interstitial,null),b.appendInPlace=!1,b.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${b}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const m=i&&"mediaSource"in i&&((s=i.mediaSource)==null?void 0:s.readyState)!=="closed",g=m&&i?i:t;this.log(`${m?"transfering MediaSource":"attaching media"} to ${l?e:"Primary"} from ${f} (media.currentTime: ${t.currentTime})`);const x=this.schedule;if(g===i&&x){const y=l&&e.assetId===x.assetIdAtEnd;g.overrides={duration:x.duration,endOfStream:!l||y,cueRemoval:!l}}e.attachMedia(g)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,s=this.effectivePlayingItem;if(r===-1){const i=this.hls.startPosition;if(this.log(Qc("checkStart",i)),this.timelinePos=i,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(i>=0||!this.primaryLive){const a=this.timelinePos=i>0?i:0,l=e.findItemIndexAtTime(a);this.setSchedulePosition(l)}}else if(s&&!this.playingItem){const i=e.findItemIndex(s);this.setSchedulePosition(i)}}advanceAssetBuffering(e,t){const r=e.event,s=r.findAssetIndex(t),i=Oh(r,s);if(!r.isAssetPastPlayoutLimit(i))this.bufferedToEvent(e,i);else if(this.schedule){var a;const l=(a=this.schedule.items)==null?void 0:a[this.findItemIndex(e)+1];l&&this.bufferedToItem(l)}}advanceAfterAssetEnded(e,t,r){const s=Oh(e,r);if(e.isAssetPastPlayoutLimit(s)){if(this.schedule){const i=this.schedule.items;if(i){const a=t+1,l=i.length;if(a>=l){this.setSchedulePosition(-1);return}const u=e.resumeTime;this.timelinePos<u&&(this.log(Qc("advanceAfterAssetEnded",u)),this.timelinePos=u,e.appendInPlace&&this.advanceInPlace(u),this.checkBuffer(this.bufferedPos<u)),this.setSchedulePosition(a)}}}else{if(e.appendInPlace){const i=e.assetList[s];i&&this.advanceInPlace(i.timelineStart)}this.setSchedulePosition(t,s)}}setScheduleToAssetAtTime(e,t){const r=this.schedule;if(!r)return;const s=t.parentIdentifier,i=r.getEvent(s);if(i){const a=r.findEventIndex(s),l=r.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,a,l-1)}}setSchedulePosition(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(!s||this.playbackDisabled)return;const i=e>=0?s[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${i&&nr(i)}) pos: ${this.timelinePos}`);const a=this.waitingItem||this.playingItem,l=this.playingLastItem;if(this.isInterstitial(a)){const f=a.event,m=this.playingAsset,g=m?.identifier,x=g?this.getAssetPlayer(g):null;if(x&&g&&(!this.eventItemsMatch(a,i)||t!==void 0&&g!==f.assetList[t].identifier)){var u;const y=f.findAssetIndex(m);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${f.assetList.length} ${ca(m)}`),this.endedAsset=m,this.playingAsset=null,this.hls.trigger(C.INTERSTITIAL_ASSET_ENDED,{asset:m,assetListIndex:y,event:f,schedule:s.slice(0),scheduleIndex:e,player:x}),a!==this.playingItem){this.itemsMatch(a,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(f,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(g,i),x.media&&!((u=this.detachedData)!=null&&u.mediaSource)&&x.detachMedia()}if(!this.eventItemsMatch(a,i)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${f} ${nr(a)}`),f.hasPlayed=!0,this.hls.trigger(C.INTERSTITIAL_ENDED,{event:f,schedule:s.slice(0),scheduleIndex:e}),f.cue.once)){var d;this.updateSchedule();const y=(d=this.schedule)==null?void 0:d.items;if(i&&y){const w=this.findItemIndex(i);this.advanceSchedule(w,y,t,a,l)}return}}this.advanceSchedule(e,s,t,a,l)}advanceSchedule(e,t,r,s,i){const a=this.schedule;if(!a)return;const l=t[e]||null,u=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(f=>{const m=f.interstitial,g=a.findEventIndex(m.identifier);(g<e||g>e+1)&&this.clearInterstitial(m,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);const f=l.event;if(r===void 0){r=a.findAssetIndex(f,this.timelinePos);const y=Oh(f,r-1);if(f.isAssetPastPlayoutLimit(y)||f.appendInPlace&&this.timelinePos===l.end){this.advanceAfterAssetEnded(f,e,r);return}r=y}const m=this.waitingItem;this.assetsBuffered(l,u)||this.setBufferingItem(l);let g=this.preloadAssets(f,r);if(this.eventItemsMatch(l,m||s)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${nr(l)} ${f.appendInPlace?"append in place":""}`),this.hls.trigger(C.INTERSTITIAL_STARTED,{event:f,schedule:t.slice(0),scheduleIndex:e})),!f.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${f}`);return}if(f.assetListLoader&&(f.assetListLoader.destroy(),f.assetListLoader=void 0),!u){this.log(`Waiting for attachMedia to start Interstitial ${f}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;const x=f.assetList[r];if(!x){this.advanceAfterAssetEnded(f,e,r||0);return}if(g||(g=this.getAssetPlayer(x.identifier)),g===null||g.destroyed){const y=f.assetList.length;this.warn(`asset ${r+1}/${y} player destroyed ${f}`),g=this.createAssetPlayer(f,x,r),g.loadSource()}if(!this.eventItemsMatch(l,this.bufferingItem)&&f.appendInPlace&&this.isAssetBuffered(x))return;this.startAssetPlayer(g,r,t,e,u),this.shouldPlay&&o1(g.media)}else l?(this.resumePrimary(l,e,s),this.shouldPlay&&o1(this.hls.media)):i&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(a.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var s,i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${nr(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,t),this.log(Qc("resumePrimary",l)),this.timelinePos=l),this.attachPrimary(l,e)}if(!r)return;const a=(i=this.schedule)==null?void 0:i.items;a&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${nr(e)}`),this.hls.trigger(C.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const s=this.primaryDetails;if(t===0)return this.hls.startPosition;if(s&&(r<s.fragmentStart||r>s.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Fe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,s),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Qc("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((r=s.mainForwardBufferInfo)==null?void 0:r.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(C.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(C.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const r=this.hls.levels[t.level];if(!r.details)return;const s=Xe(Xe({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Xe(Xe({},this.altSelection),{},{audio:r});return}const i=Xe(Xe({},s),{},{audio:r});this.mediaSelection=i}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s){this.altSelection=Xe(Xe({},this.altSelection),{},{subtitles:r});return}const i=Xe(Xe({},s),{},{subtitles:r});this.mediaSelection=i}onAudioTrackSwitching(e,t){const r=gv(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(t)||s.setAudioOption(r)))}onSubtitleTrackSwitch(e,t){const r=gv(t);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(t)||t.id!==-1&&s.setSubtitleOption(r)))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let s=0;s<t.length;s++){const i=t[s];if(i.cue.post){var r;const a=this.schedule.findEventIndex(i.identifier),l=(r=this.schedule.items)==null?void 0:r[a];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){var r;const s=(r=this.schedule)==null?void 0:r.items;if(e&&s){const i=this.findItemIndex(e,t);return s[i]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((i,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(i.identifier,null)});const r=e.end+.25,s=Fe.bufferInfo(this.primaryMedia,r,0);(s.end>r||(s.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${nr(e)} (was ${nr(t)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const r=this.mediaSelection;r&&((t=this.schedule)==null||t.updateSchedule(r,[],e))}checkBuffer(e){var t;const r=(t=this.schedule)==null?void 0:t.items;if(!r)return;const s=Fe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=s.len<1),this.updateBufferedPos(s.end,r,e)}updateBufferedPos(e,t,r){const s=this.schedule,i=this.bufferingItem;if(this.bufferedPos>e||!s)return;if(t.length===1&&this.itemsMatch(t[0],i)){this.bufferedPos=e;return}const a=this.playingItem,l=this.findItemIndex(a);let u=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const f=this.findItemIndex(i),m=Math.min(f+1,t.length-1),g=t[m];if((u===-1&&i&&e>=i.end||(d=g.event)!=null&&d.appendInPlace&&e+.01>=g.start)&&(u=m),this.isInterstitial(i)){const x=i.event;if(m-l>1&&x.appendInPlace===!1||x.assetList.length===0&&x.assetListLoader)return}if(this.bufferedPos=e,u>f&&u>l)this.bufferedToItem(g);else{const x=this.primaryDetails;this.primaryLive&&x&&e>x.edge-x.targetduration&&g.start<x.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else r&&a&&!this.itemsMatch(a,i)&&(u===l?this.bufferedToItem(a):u===l+1&&this.bufferedToItem(t[u]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const i=this.getAssetPlayer(s.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,t)&&r){const{items:s,events:i}=r;if(!s||!i)return t;const a=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const u=l?l.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${nr(e)}`+(t?` (${u.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(a){const d=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((f,m)=>{const g=this.getAssetPlayer(f.identifier);g&&(m===d&&g.loadSource(),g.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(C.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,s=r.assetList.length===0&&!r.assetListLoader,i=r.cue.once;if(s||!i){const a=this.preloadAssets(r,t);if(a!=null&&a.interstitial.appendInPlace){const l=this.primaryMedia;l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,t){const r=e.assetUrl,s=e.assetList.length,i=s===0&&!e.assetListLoader,a=e.cue.once;if(i){const u=e.timelineStart;if(e.appendInPlace){var l;const g=this.playingItem;!this.isInterstitial(g)&&(g==null||(l=g.nextEvent)==null?void 0:l.identifier)===e.identifier&&this.flushFrontBuffer(u+.25)}let d,f=0;if(!this.playingItem&&this.primaryLive&&(f=this.hls.startPosition,f===-1&&(f=this.hls.liveSyncPosition||0)),f&&!(e.cue.pre||e.cue.post)){const g=f-u;g>0&&(d=Math.round(g*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:s} ${e}${d?` live-start: ${f} start-offset: ${d}`:""}`),r)return this.createAsset(e,0,0,u,e.duration,r);const m=this.assetListLoader.loadAssetList(e,d);m&&(e.assetListLoader=m)}else if(!a&&s){for(let d=t;d<s;d++){const f=e.assetList[d],m=this.getAssetPlayerQueueIndex(f.identifier);(m===-1||this.playerQueue[m].destroyed)&&!f.error&&this.createAssetPlayer(e,f,d)}const u=e.assetList[t];if(u){const d=this.getAssetPlayer(u.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(s=>{this.hls.trigger(C.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,s,i,a){const l={parentIdentifier:e.identifier,identifier:L5(e,a,t),duration:i,startOffset:r,timelineStart:s,uri:a};return this.createAssetPlayer(e,l,t)}createAssetPlayer(e,t,r){const s=this.hls,i=s.userConfig;let a=i.videoPreference;const l=s.loadLevelObj||s.levels[s.currentLevel];(a||l)&&(a=et({},a),l.videoCodec&&(a.videoCodec=l.videoCodec),l.videoRange&&(a.allowedVideoRanges=[l.videoRange]));const u=s.audioTracks[s.audioTrack],d=s.subtitleTracks[s.subtitleTrack];let f=0;if(this.primaryLive||e.appendInPlace){const A=this.timelinePos-t.timelineStart;if(A>1){const I=t.duration;I&&A<I&&(f=A)}}const m=t.identifier,g=Xe(Xe({},i),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:m,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:f,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:u||i.audioPreference,subtitlePreference:d||i.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(g.timelineOffset=t.timelineStart));const x=g.cmcd;x!=null&&x.sessionId&&x.contentId&&(g.cmcd=et({},x,{contentId:Ho(t.uri)})),this.getAssetPlayer(m)&&this.warn(`Duplicate date range identifier ${e} and asset ${m}`);const y=new D5(this.HlsPlayerClass,g,e,t);this.playerQueue.push(y),e.assetList[r]=t;let w=!0;const b=A=>{if(A.live){var I;const O=new Error(`Interstitials MUST be VOD assets ${e}`),M={fatal:!0,type:Ce.OTHER_ERROR,details:K.INTERSTITIAL_ASSET_ITEM_ERROR,error:O},D=((I=this.schedule)==null?void 0:I.findEventIndex(e.identifier))||-1;this.handleAssetItemError(M,e,D,r,O.message);return}const N=A.edge-A.fragmentStart,P=t.duration;(w||P===null||N>P)&&(w=!1,this.log(`Interstitial asset "${m}" duration change ${P} > ${N}`),t.duration=N,this.updateSchedule())};y.on(C.LEVEL_UPDATED,(A,{details:I})=>b(I)),y.on(C.LEVEL_PTS_UPDATED,(A,{details:I})=>b(I)),y.on(C.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const E=(A,I)=>{const N=this.getAssetPlayer(m);if(N&&I.tracks){N.off(C.BUFFER_CODECS,E),N.tracks=I.tracks;const P=this.primaryMedia;this.bufferingAsset===N.assetItem&&P&&!N.media&&this.bufferAssetPlayer(N,P)}};y.on(C.BUFFER_CODECS,E);const T=()=>{var A;const I=this.getAssetPlayer(m);if(this.log(`buffered to end of asset ${I}`),!I||!this.schedule)return;const N=this.schedule.findEventIndex(e.identifier),P=(A=this.schedule.items)==null?void 0:A[N];this.isInterstitial(P)&&this.advanceAssetBuffering(P,t)};y.on(C.BUFFERED_TO_END,T);const _=A=>()=>{if(!this.getAssetPlayer(m)||!this.schedule)return;this.shouldPlay=!0;const N=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,N,A)};return y.once(C.MEDIA_ENDED,_(r)),y.once(C.PLAYOUT_LIMIT_REACHED,_(1/0)),y.on(C.ERROR,(A,I)=>{if(!this.schedule)return;const N=this.getAssetPlayer(m);if(I.details===K.BUFFER_STALLED_ERROR){if(N!=null&&N.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(I,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${I.error} ${e}`)}),y.on(C.DESTROYING,()=>{if(!this.getAssetPlayer(m)||!this.schedule)return;const I=new Error(`Asset player destroyed unexpectedly ${m}`),N={fatal:!0,type:Ce.OTHER_ERROR,details:K.INTERSTITIAL_ASSET_ITEM_ERROR,error:I};this.handleAssetItemError(N,e,this.schedule.findEventIndex(e.identifier),r,I.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${ca(t)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:y}),y}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){const s=this.playerQueue[r];this.log(`clear ${s} toSegment: ${t&&nr(t)}`),this.transferMediaFromPlayer(s,t),this.playerQueue.splice(r,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,s,i){const{interstitial:a,assetItem:l,assetId:u}=e,d=a.assetList.length,f=this.playingAsset;this.endedAsset=null,this.playingAsset=l,(!f||f.identifier!==u)&&(f&&(this.clearAssetPlayer(f.identifier,r[s]),delete f.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${ca(l)}`),this.hls.trigger(C.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,i)}bufferAssetPlayer(e,t){var r,s;if(!this.schedule)return;const{interstitial:i,assetItem:a}=e,l=this.schedule.findEventIndex(i.identifier),u=(r=this.schedule.items)==null?void 0:r[l];if(!u)return;e.loadSource(),this.setBufferingItem(u),this.bufferingAsset=a;const d=this.getBufferingPlayer();if(d===e)return;const f=i.appendInPlace;if(f&&d?.interstitial.appendInPlace===!1)return;const m=d?.tracks||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(f&&a!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(m&&!ub(m,e.tracks)){const g=new Error(`Asset ${ca(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(m)}')`),x={fatal:!0,type:Ce.OTHER_ERROR,details:K.INTERSTITIAL_ASSET_ITEM_ERROR,error:g},y=i.findAssetIndex(a);this.handleAssetItemError(x,i,l,y,g.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,r=this.primaryMedia;if(!t||!r)return;const s=r.currentTime,i=t.findAssetIndex(e,s),a=e.assetList[i];if(a){const l=this.getAssetPlayer(a.identifier);if(l){const u=l.currentTime||s-a.timelineStart,d=l.duration-u;if(this.warn(`Stalled at ${u} of ${u+d} in ${l} ${e} (media.currentTime: ${s})`),u&&(d/r.playbackRate<.5||l.bufferedInPlaceToEnd(r))&&l.hls){const f=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,f,i)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,r,s,i){if(e.details===K.BUFFER_STALLED_ERROR)return;const a=t.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&ca(a)} ${e.error}`),!this.schedule)return;const l=a?.identifier||"",u=this.getAssetPlayerQueueIndex(l),d=this.playerQueue[u]||null,f=this.schedule.items,m=et({},e,{fatal:!1,errorAction:xa(!0),asset:a,assetListIndex:s,event:t,schedule:f,scheduleIndex:r,player:d});if(this.hls.trigger(C.INTERSTITIAL_ASSET_ERROR,m),!e.fatal)return;const g=this.playingAsset,x=this.bufferingAsset,y=new Error(i);if(a&&(this.clearAssetPlayer(l,null),a.error=y),!t.assetList.some(w=>!w.error))t.error=y;else for(let w=s;w<t.assetList.length;w++)this.resetAssetPlayer(t.assetList[w].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):g&&g.identifier===l?this.advanceAfterAssetEnded(t,r,s):x&&x.identifier===l&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,x)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;let s=this.timelinePos;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${s} playing: ${nr(r)} error: ${e.error}`),s===-1&&(s=this.hls.startPosition);const a=this.updateItem(r,s);this.itemsMatch(r,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(s===-1){this.checkStart();return}if(!this.schedule)return;const i=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(i)}onAssetListLoaded(e,t){var r,s;const i=t.event,a=i.identifier,l=t.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(a)))return;const u=i.timelineStart,d=i.duration;let f=0;l.forEach((w,b)=>{const E=parseFloat(w.DURATION);this.createAsset(i,b,f,u+f,E,w.URI),f+=E}),i.duration=f,this.log(`Loaded asset-list with duration: ${f} (was: ${d}) ${i}`);const m=this.waitingItem,g=m?.event.identifier===a;this.updateSchedule();const x=(s=this.bufferingItem)==null?void 0:s.event;if(g){var y;const w=this.schedule.findEventIndex(a),b=(y=this.schedule.items)==null?void 0:y[w];if(b){if(!this.playingItem&&this.timelinePos>b.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==w){i.error=new Error(`Interstitial ${l.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${i}`),this.log(i.error.message),this.updateSchedule(!0),this.primaryFallback(i);return}this.setBufferingItem(b)}this.setSchedulePosition(w)}else if(x?.identifier===a){const w=i.assetList[0];if(w){const b=this.getAssetPlayer(w.identifier);if(x.appendInPlace){const E=this.primaryMedia;b&&E&&this.bufferAssetPlayer(b,E)}else b&&b.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case K.ASSET_LIST_PARSING_ERROR:case K.ASSET_LIST_LOAD_ERROR:case K.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case K.BUFFER_STALLED_ERROR:{const r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const l1=500;class M5 extends qp{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",ve.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(C.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(C.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=se.IDLE,this.setInterval(l1),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:s}=t;if(this.fragContextChanged(r)||(kt(r)&&(this.fragPrevious=r),this.state=se.IDLE),!s)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let a;const l=r.start;for(let d=0;d<i.length;d++)if(l>=i[d].start&&l<=i[d].end){a=i[d];break}const u=r.start+r.duration;a?a.end=u:(a={start:l,end:u},i.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:s}=t;if(r===0&&s!==Number.POSITIVE_INFINITY){const i=s-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach(a=>{for(let l=0;l<a.length;){if(a[l].end<=i){a.shift();continue}else if(a[l].start<i)a[l].start=i;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(r,i,ve.SUBTITLE)}}onError(e,t){const r=t.frag;r?.type===ve.SUBTITLE&&(t.details===K.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==se.STOPPED&&(this.state=se.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&hS(this.levels,t)){this.levels=t.map(r=>new rl(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const s=new rl(r);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ve.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==se.STOPPED&&this.setInterval(l1)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:s,levels:i}=this,{details:a,id:l}=t;if(!i){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const u=i[l];if(l>=i.length||!u)return;this.log(`Subtitle track ${l} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(a.live||(r=u.details)!=null&&r.live){if(a.deltaUpdateFailed)return;const m=this.mainDetails;if(!m){this.startFragRequested=!1;return}const g=m.fragments[0];if(!u.details)a.hasProgramDateTime&&m.hasProgramDateTime?(Ou(a,m),d=a.fragmentStart):g&&(d=g.start,Um(a,d));else{var f;d=this.alignPlaylists(a,u.details,(f=this.levelLastLoaded)==null?void 0:f.details),d===0&&g&&(d=g.start,Um(a,d))}m&&!this.startFragRequested&&this.setStartPosition(m,d)}u.details=a,this.levelLastLoaded=u,l===s&&(this.hls.trigger(C.SUBTITLE_TRACK_UPDATED,{details:a,id:l,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===se.IDLE&&(ki(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),u.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,s=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&s!=null&&s.key&&s.iv&&ya(s.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(r),s.key.buffer,s.iv.buffer,zp(s.method)).catch(l=>{throw i.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{const u=performance.now();i.trigger(C.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:a,tdecrypt:u}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=se.IDLE})}}doTick(){if(!this.media){this.state=se.IDLE;return}if(this.state===se.IDLE){const{currentTrackId:e,levels:t}=this,r=t?.[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:s}=this,i=this.getLoadPosition(),a=Fe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,s.maxBufferHole),{end:l,len:u}=a,d=r.details,f=this.hls.maxBufferLength+d.levelTargetDuration;if(u>f)return;const m=d.fragments,g=m.length,x=d.edge;let y=null;const w=this.fragPrevious;if(l<x){const T=s.maxFragLookUpTolerance,_=l>x-T?0:T;y=ki(w,m,Math.max(m[0].start,l),_),!y&&w&&w.start<m[0].start&&(y=m[0])}else y=m[g-1];if(y=this.filterReplacedPrimary(y,r.details),!y)return;const b=y.sn-d.startSN,E=m[b-1];if(E&&E.cc===y.cc&&this.fragmentTracker.getState(E)===Nt.NOT_LOADED&&(y=E),this.fragmentTracker.getState(y)===Nt.NOT_LOADED){const T=this.mapToInitFragWhenRequired(y);T&&this.loadFragment(T,r,l)}}}loadFragment(e,t,r){kt(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new F5(this.tracksBuffered[this.currentTrackId]||[])}}class F5{constructor(e){this.buffered=void 0;const t=(r,s,i)=>{if(s=s>>>0,s>i-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${i})`);return e[s][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const B5={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},IS=n=>String.fromCharCode(B5[n]||n),ar=15,Qr=100,U5={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},$5={17:2,18:4,21:6,22:8,23:10,19:13,20:15},V5={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},G5={25:2,26:4,29:6,30:8,31:10,27:13,28:15},H5=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class K5{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;Ze.log(`${this.time} [${e}] ${r}`)}}}const ui=function(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class LS{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const s=t[r];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class z5{constructor(){this.uchar=" ",this.penState=new LS}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class W5{constructor(e){this.chars=[],this.pos=0,this.currPenState=new LS,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Qr;t++)this.chars.push(new z5);this.logger=e}equals(e){for(let t=0;t<Qr;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Qr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Qr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Qr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Qr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=IS(e);if(this.pos>=Qr){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Qr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<Qr;r++){const s=this.chars[r].uchar;s!==" "&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Mh{constructor(e){this.rows=[],this.currRow=ar-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<ar;t++)this.rows.push(new W5(e));this.logger=e}reset(){for(let e=0;e<ar;e++)this.rows[e].clear();this.currRow=ar-1}equals(e){let t=!0;for(let r=0;r<ar;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<ar;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<ar;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+rt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<ar;l++)this.rows[l].clear();const i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const l=a.rows[i].cueStartTime,u=this.logger.time;if(l!==null&&u!==null&&l<u)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(a.rows[i+d])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const i=e.indent,a=Math.max(i-1,0);r.setCursor(e.indent),e.color=r.chars[a].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+rt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",s=-1;for(let i=0;i<ar;i++){const a=this.rows[i].getTextString();a&&(s=i+1,e?t.push("Row "+s+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class c1{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Mh(r),this.nonDisplayedMemory=new Mh(r),this.lastOutputScreen=new Mh(r),this.currRollUpRow=this.displayedMemory.rows[ar-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ar-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[r]}this.logger.log(2,"MIDROW: "+rt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class u1{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Y5(),this.logger=void 0;const s=this.logger=new K5;this.channels=[null,new c1(e,t,s),new c1(e+1,r,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const s=t[r]&127,i=t[r+1]&127;let a=!1,l=null;if(s===0&&i===0)continue;this.logger.log(3,()=>"["+ui([t[r],t[r+1]])+"] -> ("+ui([s,i])+")");const u=this.cmdHistory;if(s>=16&&s<=31){if(q5(s,i,u)){Xc(null,null,u),this.logger.log(3,()=>"Repeated command ("+ui([s,i])+") is dropped");continue}Xc(s,i,this.cmdHistory),a=this.parseCmd(s,i),a||(a=this.parseMidrow(s,i)),a||(a=this.parsePAC(s,i)),a||(a=this.parseBackgroundAttributes(s,i))}else Xc(null,null,u);if(!a&&(l=this.parseChars(s,i),l)){const f=this.currentChannel;f&&f>0?this.channels[f].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+ui([s,i])+" orig: "+ui([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(r||s))return!1;const i=e===20||e===21||e===23?1:2,a=this.channels[i];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[r];return s?(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+ui([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,i=(e===16||e===24)&&t>=64&&t<=95;if(!(s||i))return!1;const a=e<=23?1:2;t>=64&&t<=95?r=a===1?U5[e]:V5[e]:r=a===1?$5[e]:G5[e];const l=this.channels[a];return l?(l.setPAC(this.interpretPAC(r,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let r;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,s.underline=(r&1)===1,r<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((r-16)/2)*4,s}parseChars(e,t){let r,s=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),i>=17&&i<=19){let a;i===17?a=t+80:i===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+IS(a)+"' in channel "+r),s=[a]}else e>=32&&e<=127&&(s=t===0?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+ui(s).join(",")),s}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=45&&t<=47;if(!(r||s))return!1;let i;const a={};e===16||e===24?(i=Math.floor((t-32)/2),a.background=H5[i],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Xc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function Xc(n,e,t){t.a=n,t.b=e}function q5(n,e,t){return t.a===n&&t.b===e}function Y5(){return{a:null,b:null}}var a0=(function(){if(ju!=null&&ju.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(l,u){if(typeof u!="string"||!Array.isArray(l))return!1;const d=u.toLowerCase();return~l.indexOf(d)?d:!1}function r(l){return t(n,l)}function s(l){return t(e,l)}function i(l,...u){let d=1;for(;d<arguments.length;d++){const f=arguments[d];for(const m in f)l[m]=f[m]}return l}function a(l,u,d){const f=this,m={enumerable:!0};f.hasBeenReset=!1;let g="",x=!1,y=l,w=u,b=d,E=null,T="",_=!0,A="auto",I="start",N=50,P="middle",O=50,M="middle";Object.defineProperty(f,"id",i({},m,{get:function(){return g},set:function(D){g=""+D}})),Object.defineProperty(f,"pauseOnExit",i({},m,{get:function(){return x},set:function(D){x=!!D}})),Object.defineProperty(f,"startTime",i({},m,{get:function(){return y},set:function(D){if(typeof D!="number")throw new TypeError("Start time must be set to a number.");y=D,this.hasBeenReset=!0}})),Object.defineProperty(f,"endTime",i({},m,{get:function(){return w},set:function(D){if(typeof D!="number")throw new TypeError("End time must be set to a number.");w=D,this.hasBeenReset=!0}})),Object.defineProperty(f,"text",i({},m,{get:function(){return b},set:function(D){b=""+D,this.hasBeenReset=!0}})),Object.defineProperty(f,"region",i({},m,{get:function(){return E},set:function(D){E=D,this.hasBeenReset=!0}})),Object.defineProperty(f,"vertical",i({},m,{get:function(){return T},set:function(D){const B=r(D);if(B===!1)throw new SyntaxError("An invalid or illegal string was specified.");T=B,this.hasBeenReset=!0}})),Object.defineProperty(f,"snapToLines",i({},m,{get:function(){return _},set:function(D){_=!!D,this.hasBeenReset=!0}})),Object.defineProperty(f,"line",i({},m,{get:function(){return A},set:function(D){if(typeof D!="number"&&D!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");A=D,this.hasBeenReset=!0}})),Object.defineProperty(f,"lineAlign",i({},m,{get:function(){return I},set:function(D){const B=s(D);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");I=B,this.hasBeenReset=!0}})),Object.defineProperty(f,"position",i({},m,{get:function(){return N},set:function(D){if(D<0||D>100)throw new Error("Position must be between 0 and 100.");N=D,this.hasBeenReset=!0}})),Object.defineProperty(f,"positionAlign",i({},m,{get:function(){return P},set:function(D){const B=s(D);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");P=B,this.hasBeenReset=!0}})),Object.defineProperty(f,"size",i({},m,{get:function(){return O},set:function(D){if(D<0||D>100)throw new Error("Size must be between 0 and 100.");O=D,this.hasBeenReset=!0}})),Object.defineProperty(f,"align",i({},m,{get:function(){return M},set:function(D){const B=s(D);if(!B)throw new SyntaxError("An invalid or illegal string was specified.");M=B,this.hasBeenReset=!0}})),f.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a})();class Q5{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function RS(n){function e(r,s,i,a){return(r|0)*3600+(s|0)*60+(i|0)+parseFloat(a||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class X5{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let s=0;s<r.length;++s)if(t===r[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function PS(n,e,t,r){const s=r?n.split(r):[n];for(const i in s){if(typeof s[i]!="string")continue;const a=s[i].split(t);if(a.length!==2)continue;const l=a[0],u=a[1];e(l,u)}}const qm=new a0(0,0,""),Zc=qm.align==="middle"?"middle":"center";function Z5(n,e,t){const r=n;function s(){const l=RS(n);if(l===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),l}function i(l,u){const d=new X5;PS(l,function(g,x){let y;switch(g){case"region":for(let w=t.length-1;w>=0;w--)if(t[w].id===x){d.set(g,t[w].region);break}break;case"vertical":d.alt(g,x,["rl","lr"]);break;case"line":y=x.split(","),d.integer(g,y[0]),d.percent(g,y[0])&&d.set("snapToLines",!1),d.alt(g,y[0],["auto"]),y.length===2&&d.alt("lineAlign",y[1],["start",Zc,"end"]);break;case"position":y=x.split(","),d.percent(g,y[0]),y.length===2&&d.alt("positionAlign",y[1],["start",Zc,"end","line-left","line-right","auto"]);break;case"size":d.percent(g,x);break;case"align":d.alt(g,x,["start",Zc,"end","left","right"]);break}},/:/,/\s/),u.region=d.get("region",null),u.vertical=d.get("vertical","");let f=d.get("line","auto");f==="auto"&&qm.line===-1&&(f=-1),u.line=f,u.lineAlign=d.get("lineAlign","start"),u.snapToLines=d.get("snapToLines",!0),u.size=d.get("size",100),u.align=d.get("align",Zc);let m=d.get("position","auto");m==="auto"&&qm.position===50&&(m=u.align==="start"||u.align==="left"?0:u.align==="end"||u.align==="right"?100:50),u.position=m}function a(){n=n.replace(/^\s+/,"")}if(a(),e.startTime=s(),a(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),a(),e.endTime=s(),a(),i(n,e)}function DS(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class J5{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Q5,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let i=t.buffer,a=0;for(i=DS(i);a<i.length&&i[a]!=="\r"&&i[a]!==`
`;)++a;const l=i.slice(0,a);return i[a]==="\r"&&++a,i[a]===`
`&&++a,t.buffer=i.slice(a),l}function s(i){PS(i,function(a,l){},/:/)}try{let i="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;i=r();const l=i.match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:i=r(),t.state){case"HEADER":/:/.test(i)?s(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new a0(0,0,""),t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Z5(i,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const l=i.indexOf("-->")!==-1;if(!i||l&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=i}continue;case"BADCUE":i||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const eD=/\r\n|\n\r|\n|\r/g,Fh=function(e,t,r=0){return e.slice(r,r+t.length)===t},tD=function(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!pe(t)||!pe(r)||!pe(s)||!pe(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*s,t+=3600*1e3*i,t};function o0(n,e,t){return Ho(n.toString())+Ho(e.toString())+Ho(t)}const nD=function(e,t,r){let s=e[t],i=e[s.prevCC];if(!i||!i.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(a=i)!=null&&a.new;){var a;e.ccOffset+=s.start-i.start,s.new=!1,s=i,i=e[s.prevCC]}e.presentationOffset=r};function rD(n,e,t,r,s,i,a){const l=new J5,u=Pn(new Uint8Array(n)).trim().replace(eD,`
`).split(`
`),d=[],f=e?cP(e.baseTime,e.timescale):0;let m="00:00.000",g=0,x=0,y,w=!0;l.oncue=function(b){const E=t[r];let T=t.ccOffset;const _=(g-f)/9e4;if(E!=null&&E.new&&(x!==void 0?T=t.ccOffset=E.start:nD(t,r,_)),_){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}T=_-t.presentationOffset}const A=b.endTime-b.startTime,I=Ln((b.startTime+T-x)*9e4,s*9e4)/9e4;b.startTime=Math.max(I,0),b.endTime=Math.max(I+A,0);const N=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(N)),b.id||(b.id=o0(b.startTime,b.endTime,N)),b.endTime>0&&d.push(b)},l.onparsingerror=function(b){y=b},l.onflush=function(){if(y){a(y);return}i(d)},u.forEach(b=>{if(w)if(Fh(b,"X-TIMESTAMP-MAP=")){w=!1,b.slice(16).split(",").forEach(E=>{Fh(E,"LOCAL:")?m=E.slice(6):Fh(E,"MPEGTS:")&&(g=parseInt(E.slice(7)))});try{x=tD(m)/1e3}catch(E){y=E}return}else b===""&&(w=!1);l.parse(b+`
`)}),l.flush()}const Bh="stpp.ttml.im1t",NS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,jS=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,sD={left:"start",center:"center",right:"end",start:"start",end:"end"};function d1(n,e,t,r){const s=$e(new Uint8Array(n),["mdat"]);if(s.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const i=s.map(l=>Pn(l)),a=lP(e.baseTime,1,e.timescale);try{i.forEach(l=>t(iD(l,a)))}catch(l){r(l)}}function iD(n,e){const s=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(i).reduce((m,g)=>(m[g]=s.getAttribute(`ttp:${g}`)||i[g],m),{}),l=s.getAttribute("xml:space")!=="preserve",u=f1(Uh(s,"styling","style")),d=f1(Uh(s,"layout","region")),f=Uh(s,"body","[begin]");return[].map.call(f,m=>{const g=OS(m,l);if(!g||!m.hasAttribute("begin"))return null;const x=Vh(m.getAttribute("begin"),a),y=Vh(m.getAttribute("dur"),a);let w=Vh(m.getAttribute("end"),a);if(x===null)throw h1(m);if(w===null){if(y===null)throw h1(m);w=x+y}const b=new a0(x-e,w-e,g);b.id=o0(b.startTime,b.endTime,b.text);const E=d[m.getAttribute("region")],T=u[m.getAttribute("style")],_=aD(E,T,u),{textAlign:A}=_;if(A){const I=sD[A];I&&(b.lineAlign=I),b.align=A}return et(b,_),b}).filter(m=>m!==null)}function Uh(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function f1(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function OS(n,e){return[].slice.call(n.childNodes).reduce((t,r,s)=>{var i;return r.nodeName==="br"&&s?t+`
`:(i=r.childNodes)!=null&&i.length?OS(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function aD(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let s=null;const i=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(s=t[a]),i.reduce((l,u)=>{const d=$h(e,r,u)||$h(n,r,u)||$h(s,r,u);return d&&(l[u]=d),l},{})}function $h(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function h1(n){return new Error(`Could not parse ttml timestamp ${n}`)}function Vh(n,e){if(!n)return null;let t=RS(n);return t===null&&(NS.test(n)?t=oD(n,e):jS.test(n)&&(t=lD(n,e))),t}function oD(n,e){const t=NS.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function lD(n,e){const t=jS.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class Jc{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class cD{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=p1(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(C.FRAG_LOADING,this.onFragLoading,this),e.on(C.FRAG_LOADED,this.onFragLoaded,this),e.on(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(C.FRAG_LOADING,this.onFragLoading,this),e.off(C.FRAG_LOADED,this.onFragLoaded,this),e.off(C.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(C.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(C.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(C.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Jc(this,"textTrack1"),t=new Jc(this,"textTrack2"),r=new Jc(this,"textTrack3"),s=new Jc(this,"textTrack4");this.cea608Parser1=new u1(1,e,t),this.cea608Parser2=new u1(3,r,s)}addCues(e,t,r,s,i){let a=!1;for(let l=i.length;l--;){const u=i[l],d=uD(u[0],u[1],t,r);if(d>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],r),a=!0,d/(r-t)>.5))return}if(a||i.push([t,r]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,t,r,s)}else{const l=this.Cues.newCue(null,t,r,s);this.hls.trigger(C.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:s,timescale:i,trackId:a}){const{unparsedVttFrags:l}=this;r===ve.MAIN&&(this.initPTS[t.cc]={baseTime:s,timescale:i,trackId:a}),l.length&&(this.unparsedVttFrags=[],l.forEach(u=>{this.initPTS[u.frag.cc]?this.onFragLoaded(C.FRAG_LOADED,u):this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let s=0;s<r.textTracks.length;s++){const i=r.textTracks[s];if(m1(i,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:s}=this,{label:i,languageCode:a}=t[e],l=this.getExistingTrack(i,a);if(l)r[e]=l,fa(r[e]),kS(r[e],s);else{const u=this.createTextTrack("captions",i,a);u&&(u[e]=!0,r[e]=u)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,s={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,t,r){const s=this.media;if(s)return s.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:s}=this;Object.keys(s).forEach(i=>{fa(s[i]),delete s[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=p1(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)fa(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],s=r.some(i=>i.textCodec===Bh);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(hS(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const a=this.media,l=a?vu(a.textTracks):null;if(this.tracks.forEach((u,d)=>{let f;if(l){let m=null;for(let g=0;g<l.length;g++)if(l[g]&&m1(l[g],u)){m=l[g],l[g]=null;break}m&&(f=m)}if(f)fa(f);else{const m=MS(u);f=this.createTextTrack(m,u.name,u.lang),f&&(f.mode="disabled")}f&&this.textTracks.push(f)}),l!=null&&l.length){const u=l.filter(d=>d!==null).map(d=>d.label);u.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${u.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(l=>({label:l.name,kind:l.type.toLowerCase(),default:l.default,subtitleTrack:l}));this.hls.trigger(C.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const s=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!s)return;const i=`textTrack${s[1]}`,a=this.captionsProperties[i];a&&(a.label=r.name,r.lang&&(a.languageCode=r.lang),a.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ve.MAIN){var r,s;const{cea608Parser1:i,cea608Parser2:a,lastSn:l}=this,{cc:u,sn:d}=t.frag,f=(r=(s=t.part)==null?void 0:s.index)!=null?r:-1;i&&a&&(d!==l+1||d===l&&f!==this.lastPartIndex+1||u!==this.lastCc)&&(i.reset(),a.reset()),this.lastCc=u,this.lastSn=d,this.lastPartIndex=f}}onFragLoaded(e,t){const{frag:r,payload:s}=t;if(r.type===ve.SUBTITLE)if(s.byteLength){const i=r.decryptdata,a="stats"in t;if(i==null||!i.encrypted||a){const l=this.tracks[r.level],u=this.vttCCs;u[r.cc]||(u[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),l&&l.textCodec===Bh?this._parseIMSC1(r,s):this._parseVTTs(t)}}else this.hls.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;d1(t,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),r.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{r.logger.log(`Failed to parse IMSC1: ${s}`),r.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var t;const{frag:r,payload:s}=e,{initPTS:i,unparsedVttFrags:a}=this,l=i.length-1;if(!i[r.cc]&&l===-1){a.push(e);return}const u=this.hls,d=(t=r.initSegment)!=null&&t.data?Hn(r.initSegment.data,new Uint8Array(s)).buffer:s;rD(d,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,f=>{this._appendCues(f,r.level),u.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},f=>{const m=f.message==="Missing initPTS for VTT MPEGTS";m?a.push(e):this._fallbackToIMSC1(r,s),u.logger.log(`Failed to parse VTT cue: ${f}`),!(m&&l>r.cc)&&u.trigger(C.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:f})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||d1(t,this.initPTS[e.cc],()=>{r.textCodec=Bh,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[t];if(!s||s.mode==="disabled")return;e.forEach(i=>CS(s,i))}else{const s=this.tracks[t];if(!s)return;const i=s.default?"default":"subtitles"+t;r.trigger(C.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===ve.SUBTITLE&&this.onFragLoaded(C.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:s}=t;if(!(r.type===ve.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let i=0;i<s.length;i++){const a=s[i].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const l=this.extractCea608Data(a);this.cea608Parser1.addData(s[i].pts,l[0]),this.cea608Parser2.addData(s[i].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:s,type:i}){const{media:a}=this;if(!(!a||a.currentTime<r)){if(!i||i==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(u=>Wm(l[u],t,r))}if(this.config.renderTextTracksNatively&&t===0&&s!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(u=>Wm(l[u],t,s))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let s=2;for(let i=0;i<r;i++){const a=e[s++],l=127&e[s++],u=127&e[s++];if(l===0&&u===0)continue;if((4&a)!==0){const f=3&a;(f===0||f===1)&&(t[f].push(l),t[f].push(u))}}return t}}function MS(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function m1(n,e){return!!n&&n.kind===MS(e)&&Gm(e,n)}function uD(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function p1(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const dD=/\s/,fD={newCue(n,e,t,r){const s=[];let i,a,l,u,d;const f=self.VTTCue||self.TextTrackCue;for(let g=0;g<r.rows.length;g++)if(i=r.rows[g],l=!0,u=0,d="",!i.isEmpty()){var m;for(let w=0;w<i.chars.length;w++)dD.test(i.chars[w].uchar)&&l?u++:(d+=i.chars[w].uchar,l=!1);i.cueStartTime=e,e===t&&(t+=1e-4),u>=16?u--:u++;const x=DS(d.trim()),y=o0(e,t,x);n!=null&&(m=n.cues)!=null&&m.getCueById(y)||(a=new f(e,t,x),a.id=y,a.line=g+1,a.align="left",a.position=10+Math.min(80,Math.floor(u*8/32)*10),s.push(a))}return n&&s.length&&(s.sort((g,x)=>g.line==="auto"||x.line==="auto"?0:g.line>8&&x.line>8?x.line-g.line:g.line-x.line),s.forEach(g=>CS(n,g))),s}};function hD(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const mD=/(\d+)-(\d+)\/(\d+)/;class g1{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||yD,this.controller=new self.AbortController,this.stats=new Bp}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const i=pD(e,this.controller.signal),a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=u&&pe(u)?u:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout),(al(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(m=>{var g;this.response=this.loader=m;const x=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},d-(x-s.loading.start)),!m.ok){const{status:w,statusText:b}=m;throw new vD(b||"fetch, bad network response",w,m)}s.loading.first=x,s.total=xD(m.headers)||s.total;const y=(g=this.callbacks)==null?void 0:g.onProgress;return y&&pe(t.highWaterMark)?this.loadProgressively(m,s,e,t.highWaterMark,y):a?m.arrayBuffer():e.responseType==="json"?m.json():m.text()}).then(m=>{var g,x;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const w=m[l];w&&(s.loaded=s.total=w);const b={url:y.url,data:m,code:y.status},E=(g=this.callbacks)==null?void 0:g.onProgress;E&&!pe(t.highWaterMark)&&E(s,e,m,y),(x=this.callbacks)==null||x.onSuccess(b,s,e,y)}).catch(m=>{var g;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const x=m&&m.code||0,y=m?m.message:null;(g=this.callbacks)==null||g.onError({code:x,text:y},e,m?m.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,s=0,i){const a=new Wb,l=e.body.getReader(),u=()=>l.read().then(d=>{if(d.done)return a.dataLength&&i(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const f=d.value,m=f.length;return t.loaded+=m,m<s||a.dataLength?(a.push(f),a.dataLength>=s&&i(t,r,a.flush().buffer,e)):i(t,r,f.buffer,e),u()}).catch(()=>Promise.reject());return u()}}function pD(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(et({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function gD(n){const e=mD.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function xD(n){const e=n.get("Content-Range");if(e){const r=gD(e);if(pe(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function yD(n,e){return new self.Request(n.url,e)}class vD extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const wD=/^age:\s*[\d.]+\s*$/im;class FS{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Bp,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return i(r,t.url)}).catch(a=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),i(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(a=>{var l;(l=this.callbacks)==null||l.onError({code:r.status,text:a.message},t,r,s)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:a}=r.loadPolicy;if(s)for(const l in s)e.setRequestHeader(l,s[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=i&&pe(i)?i:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const s=t.readyState,i=this.config;if(!r.aborted&&s>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,f=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const y=f??t.response;if(y!=null){var a,l;r.loading.end=Math.max(self.performance.now(),r.loading.first);const w=t.responseType==="arraybuffer"?y.byteLength:y.length;r.loaded=r.total=w,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const b=(a=this.callbacks)==null?void 0:a.onProgress;b&&b(r,e,y,t);const E={url:t.responseURL,data:y,code:d};(l=this.callbacks)==null||l.onSuccess(E,r,e,t);return}}const m=i.loadPolicy.errorRetry,g=r.retry,x={url:e.url,data:void 0,code:d};if(Du(m,g,!1,x))this.retry(m);else{var u;Ze.error(`${d} while loading ${e.url}`),(u=this.callbacks)==null||u.onError({code:d,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Du(e,t,!0))this.retry(e);else{var r;Ze.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=Gp(e,r.retry),r.retry++,Ze.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&wD.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const bD={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},SD=Xe(Xe({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:FS,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:NR,bufferController:TP,capLevelController:r0,errorController:BR,fpsController:_5,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ob,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:bD},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},ED()),{},{subtitleStreamController:M5,subtitleTrackController:A5,timelineController:cD,audioStreamController:wP,audioTrackController:bP,emeController:va,cmcdController:b5,contentSteeringController:E5,interstitialsController:O5});function ED(){return{cueHandler:fD,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function TD(n,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=Ym(n),s=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(a=>{const l=`${a==="level"?"playlist":a}LoadPolicy`,u=e[l]===void 0,d=[];i.forEach(f=>{const m=`${a}Loading${f}`,g=e[m];if(g!==void 0&&u){d.push(m);const x=r[l].default;switch(e[l]={default:x},f){case"TimeOut":x.maxLoadTimeMs=g,x.maxTimeToFirstByteMs=g;break;case"MaxRetry":x.errorRetry.maxNumRetry=g,x.timeoutRetry.maxNumRetry=g;break;case"RetryDelay":x.errorRetry.retryDelayMs=g,x.timeoutRetry.retryDelayMs=g;break;case"MaxRetryTimeout":x.errorRetry.maxRetryDelayMs=g,x.timeoutRetry.maxRetryDelayMs=g;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${l}": ${rt(e[l])}`)}),Xe(Xe({},r),e)}function Ym(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(Ym):Object.keys(n).reduce((e,t)=>(e[t]=Ym(n[t]),e),{}):n}function _D(n,e){const t=n.loader;t!==g1&&t!==FS?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):hD()&&(n.loader=g1,n.progressive=!0,n.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const wu=2,kD=.1,CD=.05,AD=100;class ID extends Rb{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(AD),this.mediaSource=t.mediaSource;const r=this.media=t.media;ln(r,"playing",this.onMediaPlaying),ln(r,"waiting",this.onMediaWaiting),ln(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:r}=this;r&&(bn(r,"playing",this.onMediaPlaying),bn(r,"waiting",this.onMediaWaiting),bn(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,s;const i=(r=this.hls)==null?void 0:r.config;if(!i)return;const a=this.media;if(!a)return;const{seeking:l}=a,u=this.seeking&&!l,d=!this.seeking&&l,f=a.paused&&!l||a.ended||a.playbackRate===0;if(this.seeking=l,e!==t){t&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!f&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||u){u&&this.stallResolved(e);return}if(f){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!1}));return}if(!Fe.getBuffered(a).length){this.nudgeRetry=0;return}const m=Fe.bufferInfo(a,e,0),g=m.nextStart||0,x=this.fragmentTracker;if(l&&x&&this.hls){const N=x1(this.hls.inFlightFragments,e),P=m.len>wu,O=!g||N||g-e>wu&&!x.getPartialFragment(e);if(P||O)return;this.moved=!1}const y=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&x){if(!(m.len>0)&&!g)return;const P=Math.max(g,m.start||0)-e,M=!!(y!=null&&y.live)?y.targetduration*2:wu,D=eu(e,x);if(P>0&&(P<=M||D)){a.paused||this._trySkipBufferHole(D);return}}const w=i.detectStallWithCurrentTimeMs,b=self.performance.now(),E=this.waiting;let T=this.stalled;if(T===null)if(E>0&&b-E<w)T=this.stalled=E;else{this.stalled=b;return}const _=b-T;if(!l&&(_>=w||E)&&this.hls){var A;if(((A=this.mediaSource)==null?void 0:A.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(e-(y?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(C.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(m),!this.media||!this.hls)return}const I=Fe.bufferInfo(a,e,i.maxBufferHole);this._tryFixBufferStall(I,_,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(C.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&s&&s.length>1&&e>s.end(0)){const i=Fe.bufferedInfo(Fe.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){const a=Fe.timeRangesToArray(s),l=Fe.bufferedInfo(a,t,0).bufferedIndex;if(l>-1&&l<a.length-1){const u=Fe.bufferedInfo(a,e,0).bufferedIndex,d=a[l].end,f=a[l+1].start;if((u===-1||u>l)&&f-d<1&&e-d<2){const m=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${f} buffered index: ${u}`);this.warn(m.message),this.media.currentTime+=1e-6;let g=eu(e,this.fragmentTracker);g&&"fragment"in g?g=g.fragment:g||(g=void 0);const x=Fe.bufferInfo(this.media,e,0);this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:g,buffer:x.len,bufferInfo:x})}}}}}_tryFixBufferStall(e,t,r){var s,i;const{fragmentTracker:a,media:l}=this,u=(s=this.hls)==null?void 0:s.config;if(!l||!a||!u)return;const d=(i=this.hls)==null?void 0:i.latestLevelDetails,f=eu(r,a);if((f||d!=null&&d.live&&r<d.fragmentStart)&&(this._trySkipBufferHole(f)||!this.media))return;const m=e.buffered,g=this.adjacentTraversal(e,r);(m&&m.length>1&&e.len>u.maxBufferHole||e.nextStart&&(e.nextStart-r<u.maxBufferHole||g))&&(t>u.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const r=this.fragmentTracker,s=e.nextStart;if(r&&s){const i=r.getFragAtPos(t,ve.MAIN),a=r.getFragAtPos(s,ve.MAIN);if(i&&a)return a.sn-i.sn<2}return!1}_reportStall(e){const{hls:t,media:r,stallReported:s,stalled:i}=this;if(!s&&i!==null&&r&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${rt(e)})`);this.warn(a.message),t.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:r,media:s}=this,i=(t=this.hls)==null?void 0:t.config;if(!s||!r||!i)return 0;const a=s.currentTime,l=Fe.bufferInfo(s,a,0),u=a<l.start?l.start:l.nextStart;if(u&&this.hls){const f=l.len<=i.maxBufferHole,m=l.len>0&&l.len<1&&s.readyState<3,g=u-a;if(g>0&&(f||m)){if(g>i.maxBufferHole){let y=!1;if(a===0){const w=r.getAppendedFrag(0,ve.MAIN);w&&u<w.end&&(y=!0)}if(!y&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||x1(this.hls.inFlightFragments,u))return 0;let b=!1,E=e.end;for(;E<u;){const T=eu(E,r);if(T)E+=T.duration;else{b=!0;break}}if(b)return 0}}const x=Math.max(u+CD,a+kD);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${x}`),this.moved=!0,s.currentTime=x,!(e!=null&&e.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${x}`),w={type:Ce.MEDIA_ERROR,details:K.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:l.len,bufferInfo:l};e&&("fragment"in e?w.part=e:w.frag=e),this.hls.trigger(C.ERROR,w)}return x}}return 0}_tryNudgeBuffer(e){const{hls:t,media:r,nudgeRetry:s}=this,i=t?.config;if(!r||!i)return 0;const a=r.currentTime;if(this.nudgeRetry++,s<i.nudgeMaxRetry){const l=a+(s+1)*i.nudgeOffset,u=new Error(`Nudging 'currentTime' from ${a} to ${l}`);this.warn(u.message),r.currentTime=l,t.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1,buffer:e.len,bufferInfo:e})}else{const l=new Error(`Playhead still not moving while enough data buffered @${a} after ${i.nudgeMaxRetry} nudges`);this.error(l.message),t.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}}function x1(n,e){const t=y1(n.main);if(t&&t.start<=e)return t;const r=y1(n.audio);return r&&r.start<=e?r:null}function y1(n){if(!n)return null;switch(n.state){case se.IDLE:case se.STOPPED:case se.ENDED:case se.ERROR:return null}return n.frag}function eu(n,e){return e.getAppendedFrag(n,ve.MAIN)||e.getPartialFragment(n)}const LD=.25;function Qm(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Gh(n,e,t,r,s){let i=new n(e,t,"");try{i.value=r,s&&(i.type=s)}catch{i=new n(e,t,rt(s?Xe({type:s},r):r))}return i}const tu=(()=>{const n=Qm();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class RD{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(C.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(C.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&fa(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return kS(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:s}=this.hls.config;if(!r&&!s)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=Qm();if(a)for(let l=0;l<i.length;l++){const u=i[l].type;if(u===Rn.emsg&&!r||!s)continue;const d=eS(i[l].data),f=i[l].pts;let m=f+i[l].duration;m>tu&&(m=tu),m-f<=0&&(m=f+LD);for(let x=0;x<d.length;x++){const y=d[x];if(!tS(y)){this.updateId3CueEnds(f,u);const w=Gh(a,f,m,y,u);w&&this.id3Track.addCue(w)}}}}updateId3CueEnds(e,t){var r;const s=(r=this.id3Track)==null?void 0:r.cues;if(s)for(let i=s.length;i--;){const a=s[i];a.type===t&&a.startTime<e&&a.endTime===tu&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:s}){const{id3Track:i,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:u}}=a;if(i&&(l||u)){let d;s==="audio"?d=f=>f.type===Rn.audioId3&&u:s==="video"?d=f=>f.type===Rn.emsg&&l:d=f=>f.type===Rn.audioId3&&u||f.type===Rn.emsg&&l,Wm(i,t,r,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:s,enableDateRangeMetadataCues:i,interstitialsController:a}=this.hls.config;if(!i)return;const l=Qm();if(r&&s&&!a){const{fragmentStart:w,fragmentEnd:b}=e;let E=this.assetCue;E?(E.startTime=w,E.endTime=b):l&&(E=this.assetCue=Gh(l,w,b,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),E&&(E.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(E),E.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:u}=this,{dateRanges:d}=e,f=Object.keys(d);let m=this.dateRangeCuesAppended;if(u&&t){var g;if((g=u.cues)!=null&&g.length){const w=Object.keys(m).filter(b=>!f.includes(b));for(let b=w.length;b--;){var x;const E=w[b],T=(x=m[E])==null?void 0:x.cues;delete m[E],T&&Object.keys(T).forEach(_=>{const A=T[_];if(A){A.removeEventListener("enter",this.onEventCueEnter);try{u.removeCue(A)}catch{}}})}}else m=this.dateRangeCuesAppended={}}const y=e.fragments[e.fragments.length-1];if(!(f.length===0||!pe(y?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let w=0;w<f.length;w++){const b=f[w],E=d[b],T=E.startTime,_=m[b],A=_?.cues||{};let I=_?.durationKnown||!1,N=tu;const{duration:P,endDate:O}=E;if(O&&P!==null)N=T+P,I=!0;else if(E.endOnNext&&!I){const D=f.reduce((B,q)=>{if(q!==E.id){const ie=d[q];if(ie.class===E.class&&ie.startDate>E.startDate&&(!B||E.startDate<B.startDate))return ie}return B},null);D&&(N=D.startTime,I=!0)}const M=Object.keys(E.attr);for(let D=0;D<M.length;D++){const B=M[D];if(!ZR(B))continue;const q=A[B];if(q)I&&!(_!=null&&_.durationKnown)?q.endTime=N:Math.abs(q.startTime-T)>.01&&(q.startTime=T,q.endTime=N);else if(l){let ie=E.attr[B];JR(B)&&(ie=db(ie));const re=Gh(l,T,N,{key:B,data:ie},Rn.dateRange);re&&(re.id=b,this.id3Track.addCue(re),A[B]=re,a&&(B==="X-ASSET-LIST"||B==="X-ASSET-URL")&&re.addEventListener("enter",this.onEventCueEnter))}}m[b]={cues:A,dateRange:E,durationKnown:I}}}}}class PD{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:a}=this.config;if(!i||a===1||!r.live)return;const l=this.targetLatency;if(l===null)return;const u=s-l,d=Math.min(this.maxLatency,l+r.targetduration);if(u<d&&u>.05&&this.forwardBufferLength>1){const m=Math.min(2,Math.max(1,a)),g=Math.round(2/(1+Math.exp(-.75*u-this.edgeStalled))*20)/20,x=Math.min(m,Math.max(1,g));this.changeMediaPlaybackRate(t,x)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:r,targetduration:s}=e,{liveSyncDuration:i,liveSyncDurationCount:a,lowLatencyMode:l}=this.config,u=this.hls.userConfig;let d=l&&r||t;(this._targetLatencyUpdated||u.liveSyncDuration||u.liveSyncDurationCount||d===0)&&(d=i!==void 0?i:a*s);const f=s;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,f)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const r=this.levelDetails;if(r===null)return null;const s=r.edge,i=e-t-this.edgeStalled,a=s-r.totalduration,l=s-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,i),l)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(C.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(C.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(C.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(C.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===K.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,s;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class DD extends n0{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this),e.on(C.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this),e.off(C.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,s=[],i={},a={};let l=!1,u=!1,d=!1;t.levels.forEach(f=>{const m=f.attrs;let{audioCodec:g,videoCodec:x}=f;g&&(f.audioCodec=g=Iu(g,r)||void 0),x&&(x=f.videoCodec=pR(x));const{width:y,height:w,unknownCodecs:b}=f,E=b?.length||0;if(l||(l=!!(y&&w)),u||(u=!!x),d||(d=!!g),E||g&&!this.isAudioSupported(g)||x&&!this.isVideoSupported(x)){this.log(`Some or all CODECS not supported "${m.CODECS}"`);return}const{CODECS:T,"FRAME-RATE":_,"HDCP-LEVEL":A,"PATHWAY-ID":I,RESOLUTION:N,"VIDEO-RANGE":P}=m,M=`${`${I||"."}-`}${f.bitrate}-${N}-${_}-${T}-${P}-${A}`;if(i[M])if(i[M].uri!==f.url&&!f.attrs["PATHWAY-ID"]){const D=a[M]+=1;f.attrs["PATHWAY-ID"]=new Array(D+1).join(".");const B=this.createLevel(f);i[M]=B,s.push(B)}else i[M].addGroupId("audio",m.AUDIO),i[M].addGroupId("text",m.SUBTITLES);else{const D=this.createLevel(f);i[M]=D,a[M]=1,s.push(D)}}),this.filterAndSortMediaOptions(s,t,l,u,d)}createLevel(e){const t=new rl(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(s.message),t.supportedResult=Eb(s,[])}return t}isAudioSupported(e){return tl(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return tl(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,s,i){var a;let l=[],u=[],d=e;const f=((a=t.stats)==null?void 0:a.parsing)||{};if((r||s)&&i&&(d=d.filter(({videoCodec:T,videoRange:_,width:A,height:I})=>(!!T||!!(A&&I))&&_R(_))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let T="no level with compatible codecs found in manifest",_=T;t.levels.length&&(_=`one or more CODECS in variant not supported: ${rt(t.levels.map(I=>I.attrs.CODECS).filter((I,N,P)=>P.indexOf(I)===N))}`,this.warn(_),T+=` (${_})`);const A=new Error(T);this.hls.trigger(C.ERROR,{type:Ce.MEDIA_ERROR,details:K.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:A,reason:_})}}),f.end=performance.now();return}t.audioTracks&&(l=t.audioTracks.filter(T=>!T.audioCodec||this.isAudioSupported(T.audioCodec)),v1(l)),t.subtitles&&(u=t.subtitles,v1(u));const m=d.slice(0);d.sort((T,_)=>{if(T.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"])return(T.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&T.height!==_.height)return T.height-_.height;if(T.frameRate!==_.frameRate)return T.frameRate-_.frameRate;if(T.videoRange!==_.videoRange)return Lu.indexOf(T.videoRange)-Lu.indexOf(_.videoRange);if(T.videoCodec!==_.videoCodec){const A=uv(T.videoCodec),I=uv(_.videoCodec);if(A!==I)return I-A}if(T.uri===_.uri&&T.codecSet!==_.codecSet){const A=Au(T.codecSet),I=Au(_.codecSet);if(A!==I)return I-A}return T.averageBitrate!==_.averageBitrate?T.averageBitrate-_.averageBitrate:0});let g=m[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==m.length)){for(let T=0;T<m.length;T++)if(m[T].pathwayId===d[0].pathwayId){g=m[T];break}}this._levels=d;for(let T=0;T<d.length;T++)if(d[T]===g){var x;this._firstLevel=T;const _=g.bitrate,A=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${_}`),((x=this.hls.userConfig)==null?void 0:x.abrEwmaDefaultEstimate)===void 0){const I=Math.min(_,this.hls.config.abrEwmaDefaultEstimateMax);I>A&&A===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=I)}break}const y=i&&!s,w=this.hls.config,b=!!(w.audioStreamController&&w.audioTrackController),E={levels:d,audioTracks:l,subtitleTracks:u,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:s,altAudio:b&&!y&&l.some(T=>!!T.url)};f.end=performance.now(),this.hls.trigger(C.MANIFEST_PARSED,E)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const f=new Error("invalid level idx"),m=e<0;if(this.hls.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.LEVEL_SWITCH_ERROR,level:e,fatal:m,error:f,reason:f.message}),m)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,s=this.currentLevel,i=s?s.attrs["PATHWAY-ID"]:void 0,a=t[e],l=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,r===e&&s&&i===l)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${l?" with Pathway "+l:""} from level ${r}${i?" with Pathway "+i:""}`);const u={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(C.LEVEL_SWITCHING,u);const d=a.details;if(!d||d.live){const f=this.switchParams(a.uri,s?.details,d);this.loadPlaylist(f)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),r=e.filter(s=>t.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ve.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(i=>!!r[i]))return;const s=this._levels[t.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,t){var r;const{level:s,details:i}=t,a=t.levelInfo;if(!a){var l;this.warn(`Invalid level index ${s}`),(l=t.deliveryDirectives)!=null&&l.skip&&(i.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let u=a.details;u===t.details&&u.advanced&&(u=void 0),this.playlistLoaded(s,t,u)}else(r=t.deliveryDirectives)!=null&&r.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,i=e.attrs["PATHWAY-ID"],a=e.details,l=a?.age;this.log(`Loading level index ${s}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${i?" Pathway "+i:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${r}`),this.hls.trigger(C.LEVEL_LOADING,{url:r,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const r=this._levels.filter((i,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(l=>l.level=-1)),!1));Hb(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=r.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(C.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(C.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function v1(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function BS(){return self.SourceBuffer||self.WebKitSourceBuffer}function US(){if(!$s())return!1;const e=BS();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function ND(){if(!US())return!1;const n=$s();return typeof n?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(nl(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(nl(e,"audio"))))}function jD(){var n;const e=BS();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const OD=100;class MD extends qp{constructor(e,t,r){super(e,t,r,"stream-controller",ve.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,i=s?s.currentTime:null;if(i===null||!pe(i)||(this.log(`Media seeked to ${i.toFixed(3)}`),!this.getBufferedFrag(i)))return;const a=this.getFwdBufferInfoAtPos(s,i,ve.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${i} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(C.MANIFEST_PARSED,this.onManifestParsed,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.LEVEL_LOADED,this.onLevelLoaded,this),e.on(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(C.BUFFER_CREATED,this.onBufferCreated,this),e.on(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(C.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(C.MANIFEST_PARSED,this.onManifestParsed,this),e.off(C.LEVEL_LOADED,this.onLevelLoaded,this),e.off(C.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(C.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(C.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(C.BUFFER_CREATED,this.onBufferCreated,this),e.off(C.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(C.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:r,hls:s}=this;if(this.stopLoad(),this.setInterval(OD),this.level=-1,!this.startFragRequested){let i=s.startLevel;i===-1&&(s.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=s.firstAutoLevel),s.nextLoadLevel=i,this.level=s.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=se.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=se.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case se.WAITING_LEVEL:{const{levels:e,level:t}=this,r=e?.[t],s=r?.details;if(s&&(!s.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(s))break;this.state=se.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=se.IDLE;break}break}case se.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===se.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:s}=this;if(t===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const i=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[i]))return;const a=r[i],l=this.getMainFwdBufferInfo();if(l===null)return;const u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){const w={};this.altAudio===2&&(w.type="video"),this.hls.trigger(C.BUFFER_EOS,w),this.state=se.ENDED;return}if(!this.buffering)return;e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const d=a.details;if(!d||this.state===se.WAITING_LEVEL||this.waitForLive(a)){this.level=i,this.state=se.WAITING_LEVEL,this.startFragRequested=!1;return}const f=l.len,m=this.getMaxBufferLength(a.maxBitrate);if(f>=m)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const g=this.backtrackFragment?this.backtrackFragment.start:l.end;let x=this.getNextFragment(g,d);if(this.couldBacktrack&&!this.fragPrevious&&x&&kt(x)&&this.fragmentTracker.getState(x)!==Nt.OK){var y;const b=((y=this.backtrackFragment)!=null?y:x).sn-d.startSN,E=d.fragments[b-1];E&&x.cc===E.cc&&(x=E,this.fragmentTracker.removeFragment(E))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(x&&this.isLoopLoading(x,g)){if(!x.gap){const b=this.audioOnly&&!this.altAudio?nt.AUDIO:nt.VIDEO,E=(b===nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;E&&this.afterBufferFlushed(E,b,ve.MAIN)}x=this.getNextFragmentLoopLoading(x,d,l,ve.MAIN,m)}x&&(x.initSegment&&!x.initSegment.data&&!this.bitrateTest&&(x=x.initSegment),this.loadFragment(x,a,g))}loadFragment(e,t,r){const s=this.fragmentTracker.getState(e);s===Nt.NOT_LOADED||s===Nt.PARTIAL?kt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ve.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const i=this.getLevelDetails();if(i!=null&&i.live){const l=this.getMainFwdBufferInfo();if(!l||l.len<i.targetduration*2)return}if(!t.paused&&e){const l=this.hls.nextLoadLevel,u=e[l],d=this.fragLastKbps;d&&this.fragCurrent?r=this.fragCurrent.duration*u.maxBitrate/(1e3*d)+1:r=0}else r=0;const a=this.getBufferedFrag(t.currentTime+r);if(a){const l=this.followingBufferedFrag(a);if(l){this.abortCurrentFrag();const u=l.maxStartPTS?l.maxStartPTS:l.start,d=l.duration,f=Math.max(a.end,u+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(f,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case se.KEY_LOADING:case se.FRAG_LOADING:case se.FRAG_LOADING_WAITING_RETRY:case se.PARSING:case se.PARSED:this.state=se.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;ln(r,"playing",this.onMediaPlaying),ln(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:r}=this;r&&(bn(r,"playing",this.onMediaPlaying),bn(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(C.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,s=!1;for(let i=0;i<t.levels.length;i++){const a=t.levels[i].audioCodec;a&&(r=r||a.indexOf("mp4a.40.2")!==-1,s=s||a.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&s&&!jD(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==se.IDLE)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=se.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:s,startFragRequested:i}=this,a=t.level,l=t.details,u=l.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""}, cc [${l.startCC}, ${l.endCC}] duration:${u}`);const d=t.levelInfo,f=this.fragCurrent;f&&(this.state===se.FRAG_LOADING||this.state===se.FRAG_LOADING_WAITING_RETRY)&&f.level!==t.level&&f.loader&&this.abortCurrentFrag();let m=0;if(l.live||(r=d.details)!=null&&r.live){var g;if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;m=this.alignPlaylists(l,d.details,(g=this.levelLastLoaded)==null?void 0:g.details)}if(d.details=l,this.levelLastLoaded=d,i||this.setStartPosition(l,m),this.hls.trigger(C.LEVEL_UPDATED,{details:l,level:a}),this.state===se.WAITING_LEVEL){if(this.waitForCdnTuneIn(l))return;this.state=se.IDLE}i&&l.live&&this.synchronizeToLiveEdge(l),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const s=this.hls.liveSyncPosition,i=this.getLoadPosition(),a=e.fragmentStart,l=e.edge,u=i>=a-t.maxFragLookUpTolerance&&i<=l;if(s!==null&&r.duration>s&&(i<s||!u)){const f=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!u&&r.readyState<4||i<l-f)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),r.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const m=Fe.bufferInfo(r,s,0);if(!((d=m.buffered)!=null&&d.length)){r.currentTime=s;return}if(m.start<=i){r.currentTime=s;return}const{nextStart:x}=Fe.bufferedInfo(m.buffered,i,0);x&&(r.currentTime=x)}else r.currentTime=s}}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:s,payload:i}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const l=a[r.level];if(!l){this.warn(`Level ${r.level} not found on progress`);return}const u=l.details;if(!u){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const d=l.videoCodec,f=u.PTSKnown||!u.live,m=(t=r.initSegment)==null?void 0:t.data,g=this._getAudioCodec(l),x=this.transmuxer=this.transmuxer||new fS(this.hls,ve.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=s?s.index:-1,w=y!==-1,b=new Kp(r.level,r.sn,r.stats.chunkCount,i.byteLength,y,w),E=this.initPTS[r.cc];x.push(i,m,g,d,r,s,u.totalduration,f,b,E)}onAudioTrackSwitching(e,t){const r=this.hls,s=this.altAudio!==0;if(Ru(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.altAudio=0,this.fragmentTracker.removeAllFragments(),r.once(C.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(C.AUDIO_TRACK_SWITCHED,t)}),r.trigger(C.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(C.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=Ru(t.url,this.hls);if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){const r=t.tracks;let s,i,a=!1;for(const l in r){const u=r[l];if(u.id==="main"){if(i=l,s=u,l==="video"){const d=r[l];d&&(this.videoBuffer=d.buffer)}}else a=!0}a&&s?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:s}=t,i=r.type===ve.MAIN;if(i){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${s?" p: "+s.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===se.PARSED&&(this.state=se.IDLE);return}const l=s?s.stats:r.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),kt(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,s)}const a=this.media;a&&(!this._hasEnoughToStart&&Fe.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=se.ERROR;return}switch(t.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ve.MAIN,t);break;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===se.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===Ge.LEVEL&&(this.state=se.IDLE);break;case K.BUFFER_ADD_CODEC_ERROR:case K.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case K.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=se.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==nt.AUDIO||!this.altAudio){const r=(t===nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,ve.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const s=this.timelineOffset;s&&r&&(r+=s);const i=this.getLevelDetails(),a=Fe.getBuffered(e),l=a.length?a.start(0):0,u=l-r,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||u>0&&(u<d||this.loadingParts&&u<2*(i?.partTarget||0)))&&(this.log(`adjusting start position by ${u} to match buffer start`),r+=u,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${l}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:s}=this,i=r?.frag;if(!i||this.fragContextChanged(i))return;t.fragmentError=0,this.state=se.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=i.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(C.FRAG_LOADED,r),i.bitrateTest=!1}).catch(r=>{this.state===se.STOPPED||this.state===se.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:i}=e,a=this.getCurrentContext(i);if(!a){this.resetWhenMissingContext(i);return}const{frag:l,part:u,level:d}=a,{video:f,text:m,id3:g,initSegment:x}=s,{details:y}=d,w=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=se.PARSING,x){const b=x.tracks;if(b){const A=l.initSegment||l;if(this.unhandledEncryptionError(x,l))return;this._bufferInitSegment(d,b,A,i),r.trigger(C.FRAG_PARSING_INIT_SEGMENT,{frag:A,id:t,tracks:b})}const E=x.initPTS,T=x.timescale,_=this.initPTS[l.cc];if(pe(E)&&(!_||_.baseTime!==E||_.timescale!==T)){const A=x.trackId;this.initPTS[l.cc]={baseTime:E,timescale:T,trackId:A},r.trigger(C.INIT_PTS_FOUND,{frag:l,id:t,initPTS:E,timescale:T,trackId:A})}}if(f&&y){w&&f.type==="audiovideo"&&this.logMuxedErr(l);const b=y.fragments[l.sn-1-y.startSN],E=l.sn===y.startSN,T=!b||l.cc>b.cc;if(s.independent!==!1){const{startPTS:_,endPTS:A,startDTS:I,endDTS:N}=f;if(u)u.elementaryStreams[f.type]={startPTS:_,endPTS:A,startDTS:I,endDTS:N};else if(f.firstKeyFrame&&f.independent&&i.id===1&&!T&&(this.couldBacktrack=!0),f.dropped&&f.independent){const P=this.getMainFwdBufferInfo(),O=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,M=f.firstKeyFramePTS?f.firstKeyFramePTS:_;if(!E&&O<M-this.config.maxBufferHole&&!T){this.backtrack(l);return}else T&&(l.gap=!0);l.setElementaryStreamInfo(f.type,l.start,A,l.start,N,!0)}else E&&_-(y.appliedTimelineOffset||0)>wu&&(l.gap=!0);l.setElementaryStreamInfo(f.type,_,A,I,N),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,u,i,E||T)}else if(E||T)l.gap=!0;else{this.backtrack(l);return}}if(w){const{startPTS:b,endPTS:E,startDTS:T,endDTS:_}=w;u&&(u.elementaryStreams[nt.AUDIO]={startPTS:b,endPTS:E,startDTS:T,endDTS:_}),l.setElementaryStreamInfo(nt.AUDIO,b,E,T,_),this.bufferFragmentData(w,l,u,i)}if(y&&g!=null&&g.samples.length){const b={id:t,frag:l,details:y,samples:g.samples};r.trigger(C.FRAG_PARSING_METADATA,b)}if(y&&m){const b={id:t,frag:l,details:y,samples:m.samples};r.trigger(C.FRAG_PARSING_USERDATA,b)}}logMuxedErr(e){this.warn(`${kt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,s){if(this.state!==se.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));const{audio:i,video:a,audiovideo:l}=t;if(i){const d=e.audioCodec;let f=hu(i.codec,d);f==="mp4a"&&(f="mp4a.40.5");const m=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){f&&(f.indexOf("mp4a.40.5")!==-1?f="mp4a.40.2":f="mp4a.40.5");const g=i.metadata;g&&"channelCount"in g&&(g.channelCount||1)!==1&&m.indexOf("firefox")===-1&&(f="mp4a.40.5")}f&&f.indexOf("mp4a.40.5")!==-1&&m.indexOf("android")!==-1&&i.container!=="audio/mpeg"&&(f="mp4a.40.2",this.log(`Android: force audio codec to ${f}`)),d&&d!==f&&this.log(`Swapping manifest audio codec "${d}" for "${f}"`),i.levelCodec=f,i.id=ve.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${f||""}/${d||""}/${i.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=ve.MAIN;const d=a.codec;if(d?.length===4)switch(d){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${a.codec!==d?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}l&&(this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),delete t.video,delete t.audio);const u=Object.keys(t);if(u.length){if(this.hls.trigger(C.BUFFER_CODECS,t),!this.hls)return;u.forEach(d=>{const m=t[d].initSegment;m!=null&&m.byteLength&&this.hls.trigger(C.BUFFER_APPENDING,{type:d,data:m,frag:r,part:null,chunkMeta:s,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ve.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,r=e?.[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=se.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Fe.isBuffered(e,r)?t=this.getAppendedFrag(r):Fe.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const s=this.fragPlaying,i=t.level;(!s||t.sn!==s.sn||s.level!==i)&&(this.fragPlaying=t,this.hls.trigger(C.FRAG_CHANGED,{frag:t}),(!s||s.level!==i)&&this.hls.trigger(C.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return pe(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(pe(t)){const r=this.getLevelDetails(),s=this.currentFrag||(r?ki(null,r.fragments,t):null);if(s){const i=s.programDateTime;if(i!==null){const a=i+(t-s.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class FD extends zn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[r].loader;if(s){var t;if(e&&e!==((t=s.context)==null?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=K.KEY_LOAD_ERROR,r,s,i){return new Xr({type:Ce.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:s})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let s=0,i=t.length;s<i;s++){const a=t[s];if(e.cc<=a.cc&&(!kt(e)||!kt(a)||e.sn<a.sn)||!r&&s==i-1)return this.emeController.selectKeySystemFormat(a).then(l=>{if(!this.emeController)return;a.setKeyFormat(l);const u=pu(l);if(u)return this.emeController.getKeySystemAccess([u])})}if(this.config.requireKeySystemAccessOnStart){const s=Fo(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,s;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,K.KEY_LOAD_ERROR,d))}const a=i.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,K.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));const l=Hh(i);let u=this.keyIdToKeyInfo[l];if((r=u)!=null&&r.decryptdata.key)return i.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if(this.emeController&&(s=u)!=null&&s.keyLoadPromise)switch(this.emeController.getKeyStatus(u.decryptdata)){case"usable":case"usable-in-future":return u.keyLoadPromise.then(f=>{const{keyInfo:m}=f;return i.key=m.decryptdata.key,{frag:e,keyInfo:m}})}switch(this.log(`${this.keyIdToKeyInfo[l]?"Rel":"L"}oading${i.keyId?" keyId: "+zt(i.keyId):""} URI: ${i.uri} from ${e.type} ${e.level}`),u=this.keyIdToKeyInfo[l]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return i.keyFormat==="identity"?this.loadKeyHTTP(u,e):this.loadKeyEME(u,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,K.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var s;if(!e.decryptdata.keyId&&(s=t.initSegment)!=null&&s.data){const a=rR(t.initSegment.data);if(a.length){let l=a[0];l.some(u=>u!==0)?(this.log(`Using keyId found in init segment ${zt(l)}`),Bs.setKeyIdForUri(e.decryptdata.uri,l)):(l=Bs.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${zt(l)}`)),e.decryptdata.keyId=l}}if(!e.decryptdata.keyId&&!kt(t))return Promise.resolve(r);const i=this.emeController.loadKey(r);return(e.keyLoadPromise=i.then(a=>(e.mediaKeySessionContext=a,r))).catch(a=>{throw e.keyLoadPromise=null,"data"in a&&(a.data.frag=t),a})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,s=r.loader,i=new s(r);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((a,l)=>{const u={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=r.keyLoadPolicy.default,f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(g,x,y,w)=>{const{frag:b,keyInfo:E}=y,T=Hh(E.decryptdata);if(!b.decryptdata||E!==this.keyIdToKeyInfo[T])return l(this.createKeyLoadError(b,K.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),w));E.decryptdata.key=b.decryptdata.key=new Uint8Array(g.data),b.keyLoader=null,E.loader=null,a({frag:b,keyInfo:E})},onError:(g,x,y,w)=>{this.resetLoader(x),l(this.createKeyLoadError(t,K.KEY_LOAD_ERROR,new Error(`HTTP Error ${g.code} loading key ${g.text}`),y,Xe({url:u.url,data:void 0},g)))},onTimeout:(g,x,y)=>{this.resetLoader(x),l(this.createKeyLoadError(t,K.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(g,x,y)=>{this.resetLoader(x),l(this.createKeyLoadError(t,K.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};i.load(u,f,m)})}resetLoader(e){const{frag:t,keyInfo:r,url:s}=e,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null);const a=Hh(r.decryptdata)||s;delete this.keyIdToKeyInfo[a],i&&i.destroy()}}function Hh(n){if(n.keyFormat!==Wt.FAIRPLAY){const e=n.keyId;if(e)return zt(e)}return n.uri}function w1(n){const{type:e}=n;switch(e){case Ge.AUDIO_TRACK:return ve.AUDIO;case Ge.SUBTITLE_TRACK:return ve.SUBTITLE;default:return ve.MAIN}}function Kh(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class BD{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(C.MANIFEST_LOADING,this.onManifestLoading,this),e.on(C.LEVEL_LOADING,this.onLevelLoading,this),e.on(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(C.MANIFEST_LOADING,this.onManifestLoading,this),e.off(C.LEVEL_LOADING,this.onLevelLoading,this),e.off(C.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(C.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(C.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,s=t.loader,i=r||s,a=new i(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ge.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:r,level:s,pathwayId:i,url:a,deliveryDirectives:l,levelInfo:u}=t;this.load({id:r,level:s,pathwayId:i,responseType:"text",type:Ge.LEVEL,url:a,deliveryDirectives:l,levelOrTrack:u})}onAudioTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:a,track:l}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:Ge.AUDIO_TRACK,url:i,deliveryDirectives:a,levelOrTrack:l})}onSubtitleTrackLoading(e,t){const{id:r,groupId:s,url:i,deliveryDirectives:a,track:l}=t;this.load({id:r,groupId:s,level:null,responseType:"text",type:Ge.SUBTITLE_TRACK,url:i,deliveryDirectives:a,levelOrTrack:l})}onLevelsUpdated(e,t){const r=this.loaders[Ge.LEVEL];if(r){const s=r.context;s&&!t.levels.some(i=>i===s.levelOrTrack)&&(r.abort(),delete this.loaders[Ge.LEVEL])}}load(e){var t;const r=this.hls.config;let s=this.getInternalLoader(e);if(s){const d=this.hls.logger,f=s.context;if(f&&f.levelOrTrack===e.levelOrTrack&&(f.url===e.url||f.deliveryDirectives&&!e.deliveryDirectives)){f.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${f.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let i;if(e.type===Ge.MANIFEST?i=r.manifestLoadPolicy.default:i=et({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),pe((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===Ge.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===Ge.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===Ge.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const f=d.partTarget,m=d.targetduration;if(f&&m){const g=Math.max(f*3,m*.8)*1e3;i=et({},i,{maxTimeToFirstByteMs:Math.min(g,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(g,i.maxTimeToFirstByteMs)})}}}const a=i.errorRetry||i.timeoutRetry||{},l={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},u={onSuccess:(d,f,m,g)=>{const x=this.getInternalLoader(m);this.resetInternalLoader(m.type);const y=d.data;f.parsing.start=performance.now(),kr.isMediaPlaylist(y)||m.type!==Ge.MANIFEST?this.handleTrackOrLevelPlaylist(d,f,m,g||null,x):this.handleMasterPlaylist(d,f,m,g)},onError:(d,f,m,g)=>{this.handleNetworkError(f,m,!1,d,g)},onTimeout:(d,f,m)=>{this.handleNetworkError(f,m,!0,void 0,d)}};s.load(e,l,u)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,s){const i=this.hls,a=e.data,l=Kh(e,r),u=kr.parseMasterPlaylist(a,l);if(u.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,r,u.playlistParsingError,s,t);return}const{contentSteering:d,levels:f,sessionData:m,sessionKeys:g,startTimeOffset:x,variableList:y}=u;this.variableList=y,f.forEach(T=>{const{unknownCodecs:_}=T;if(_){const{preferManagedMediaSource:A}=this.hls.config;let{audioCodec:I,videoCodec:N}=T;for(let P=_.length;P--;){const O=_[P];tl(O,"audio",A)?(T.audioCodec=I=I?`${I},${O}`:O,ka.audio[I.substring(0,4)]=2,_.splice(P,1)):tl(O,"video",A)&&(T.videoCodec=N=N?`${N},${O}`:O,ka.video[N.substring(0,4)]=2,_.splice(P,1))}}});const{AUDIO:w=[],SUBTITLES:b,"CLOSED-CAPTIONS":E}=kr.parseMasterPlaylistMedia(a,l,u);w.length&&!w.some(_=>!_.url)&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),w.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ht({}),bitrate:0,url:""})),i.trigger(C.MANIFEST_LOADED,{levels:f,audioTracks:w,subtitles:b,captions:E,contentSteering:d,url:l,stats:t,networkDetails:s,sessionData:m,sessionKeys:g,startTimeOffset:x,variableList:y})}handleTrackOrLevelPlaylist(e,t,r,s,i){const a=this.hls,{id:l,level:u,type:d}=r,f=Kh(e,r),m=pe(u)?u:pe(l)?l:0,g=w1(r),x=kr.parseLevelPlaylist(e.data,f,m,g,0,this.variableList);if(d===Ge.MANIFEST){const y={attrs:new ht({}),bitrate:0,details:x,name:"",url:f};x.requestScheduled=t.loading.start+$b(x,0),a.trigger(C.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:f,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=x,this.handlePlaylistLoaded(x,e,t,r,s,i)}handleManifestParsingError(e,t,r,s,i){this.hls.trigger(C.ERROR,{type:Ce.NETWORK_ERROR,details:K.MANIFEST_PARSING_ERROR,fatal:t.type===Ge.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:s,stats:i})}handleNetworkError(e,t,r=!1,s,i){let a=`A network ${r?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===Ge.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===Ge.AUDIO_TRACK||e.type===Ge.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const l=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let u=K.UNKNOWN,d=!1;const f=this.getInternalLoader(e);switch(e.type){case Ge.MANIFEST:u=r?K.MANIFEST_LOAD_TIMEOUT:K.MANIFEST_LOAD_ERROR,d=!0;break;case Ge.LEVEL:u=r?K.LEVEL_LOAD_TIMEOUT:K.LEVEL_LOAD_ERROR,d=!1;break;case Ge.AUDIO_TRACK:u=r?K.AUDIO_TRACK_LOAD_TIMEOUT:K.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Ge.SUBTITLE_TRACK:u=r?K.SUBTITLE_TRACK_LOAD_TIMEOUT:K.SUBTITLE_LOAD_ERROR,d=!1;break}f&&this.resetInternalLoader(e.type);const m={type:Ce.NETWORK_ERROR,details:u,fatal:d,url:e.url,loader:f,context:e,error:l,networkDetails:t,stats:i};if(s){const g=t?.url||e.url;m.response=Xe({url:g,data:void 0},s)}this.hls.trigger(C.ERROR,m)}handlePlaylistLoaded(e,t,r,s,i,a){const l=this.hls,{type:u,level:d,levelOrTrack:f,id:m,groupId:g,deliveryDirectives:x}=s,y=Kh(t,s),w=w1(s);let b=typeof s.level=="number"&&w===ve.MAIN?d:void 0;const E=e.playlistParsingError;if(E){if(this.hls.logger.warn(`${E} ${e.url}`),!l.config.ignorePlaylistParsingErrors){l.trigger(C.ERROR,{type:Ce.NETWORK_ERROR,details:K.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:E,reason:E.message,response:t,context:s,level:b,parent:w,networkDetails:i,stats:r});return}e.playlistParsingError=null}if(!e.fragments.length){const T=e.playlistParsingError=new Error("No Segments found in Playlist");l.trigger(C.ERROR,{type:Ce.NETWORK_ERROR,details:K.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:T,reason:T.message,response:t,context:s,level:b,parent:w,networkDetails:i,stats:r});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),u){case Ge.MANIFEST:case Ge.LEVEL:if(b){if(!f)b=0;else if(f!==l.levels[b]){const T=l.levels.indexOf(f);T>-1&&(b=T)}}l.trigger(C.LEVEL_LOADED,{details:e,levelInfo:f||l.levels[0],level:b||0,id:m||0,stats:r,networkDetails:i,deliveryDirectives:x,withoutMultiVariant:u===Ge.MANIFEST});break;case Ge.AUDIO_TRACK:l.trigger(C.AUDIO_TRACK_LOADED,{details:e,track:f,id:m||0,groupId:g||"",stats:r,networkDetails:i,deliveryDirectives:x});break;case Ge.SUBTITLE_TRACK:l.trigger(C.SUBTITLE_TRACK_LOADED,{details:e,track:f,id:m||0,groupId:g||"",stats:r,networkDetails:i,deliveryDirectives:x});break}}}class wn{static get version(){return sl}static isMSESupported(){return US()}static isSupported(){return ND()}static getMediaSource(){return $s()}static get Events(){return C}static get MetadataSchema(){return Rn}static get ErrorTypes(){return Ce}static get ErrorDetails(){return K}static get DefaultConfig(){return wn.defaultConfig?wn.defaultConfig:SD}static set DefaultConfig(e){wn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Yp,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=KL(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=TD(wn.DefaultConfig,e,t);this.userConfig=e,r.progressive&&_D(r,t);const{abrController:s,bufferController:i,capLevelController:a,errorController:l,fpsController:u}=r,d=new l(this),f=this.abrController=new s(this),m=new UR(this),g=r.interstitialsController,x=g?this.interstitialsController=new g(this,wn):null,y=this.bufferController=new i(this,m),w=this.capLevelController=new a(this),b=new u(this),E=new BD(this),T=r.contentSteeringController,_=T?new T(this):null,A=this.levelController=new DD(this,_),I=new RD(this),N=new FD(this.config,this.logger),P=this.streamController=new MD(this,m,N),O=this.gapController=new ID(this,m);w.setStreamController(P),b.setStreamController(P);const M=[E,A,P];x&&M.splice(1,0,x),_&&M.splice(1,0,_),this.networkControllers=M;const D=[f,y,O,w,b,I,m];this.audioTrackController=this.createController(r.audioTrackController,M);const B=r.audioStreamController;B&&M.push(this.audioStreamController=new B(this,m,N)),this.subtitleTrackController=this.createController(r.subtitleTrackController,M);const q=r.subtitleStreamController;q&&M.push(this.subtititleStreamController=new q(this,m,N)),this.createController(r.timelineController,D),N.emeController=this.emeController=this.createController(r.emeController,D),this.cmcdController=this.createController(r.cmcdController,D),this.latencyController=this.createController(PD,D),this.coreComponents=D,M.push(d);const ie=d.onErrorOut;typeof ie=="function"&&this.on(C.ERROR,ie,d),this.on(C.MANIFEST_LOADED,E.onManifestLoaded,E)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,s){this._emitter.off(e,t,r,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const s=e===C.ERROR;this.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:s,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(C.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const i=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(C.ERROR,{type:Ce.OTHER_ERROR,details:K.ATTACH_MEDIA_ERROR,fatal:!0,error:i});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,r=t?e.media:e,s=t?e:{media:r};this._media=r,this.trigger(C.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(C.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(C.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,r=this._url,s=this._url=Fp.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(C.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ve.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ve.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ve.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=I5()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){TR(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let s=0;s<r;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let s;if(t===-1&&e!=null&&e.length?s=e.length-1:s=t,r)for(let i=s;i--;){const a=e[i].attrs["HDCP-LEVEL"];if(a&&a<=r)return i}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const r=kb(t);return Tb(e,r,navigator.mediaCapabilities)}}wn.defaultConfig=void 0;var UD=Object.create,$S=Object.defineProperty,$D=Object.getOwnPropertyDescriptor,VD=Object.getOwnPropertyNames,GD=Object.getPrototypeOf,HD=Object.prototype.hasOwnProperty,VS=function(n,e){return function(){return n&&(e=n(n=0)),e}},Sn=function(n,e){return function(){return e||n((e={exports:{}}).exports,e),e.exports}},KD=function(n,e,t,r){if(e&&typeof e=="object"||typeof e=="function")for(var s=VD(e),i=0,a=s.length,l;i<a;i++)l=s[i],!HD.call(n,l)&&l!==t&&$S(n,l,{get:function(u){return e[u]}.bind(null,l),enumerable:!(r=$D(e,l))||r.enumerable});return n},Wn=function(n,e,t){return t=n!=null?UD(GD(n)):{},KD(!n||!n.__esModule?$S(t,"default",{value:n,enumerable:!0}):t,n)},Nr=Sn(function(n,e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={},e.exports=t});function Ai(n,e){return e!=null&&typeof Symbol<"u"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](n):Ai(n,e)}var Ii=VS(function(){Ii()});function GS(n){"@swc/helpers - typeof";return n&&typeof Symbol<"u"&&n.constructor===Symbol?"symbol":typeof n}var HS=VS(function(){}),KS=Sn(function(n,e){var t=Array.prototype.slice;e.exports=r;function r(s,i){for(("length"in s)||(s=[s]),s=t.call(s);s.length;){var a=s.shift(),l=i(a);if(l)return l;a.childNodes&&a.childNodes.length&&(s=t.call(a.childNodes).concat(s))}}}),zD=Sn(function(n,e){Ii(),e.exports=t;function t(r,s){if(!Ai(this,t))return new t(r,s);this.data=r,this.nodeValue=r,this.length=r.length,this.ownerDocument=s||null}t.prototype.nodeType=8,t.prototype.nodeName="#comment",t.prototype.toString=function(){return"[object Comment]"}}),WD=Sn(function(n,e){Ii(),e.exports=t;function t(r,s){if(!Ai(this,t))return new t(r);this.data=r||"",this.length=this.data.length,this.ownerDocument=s||null}t.prototype.type="DOMTextNode",t.prototype.nodeType=3,t.prototype.nodeName="#text",t.prototype.toString=function(){return this.data},t.prototype.replaceData=function(r,s,i){var a=this.data,l=a.substring(0,r),u=a.substring(r+s,a.length);this.data=l+i+u,this.length=this.data.length}}),zS=Sn(function(n,e){e.exports=t;function t(r){var s=this,i=r.type;r.target||(r.target=s),s.listeners||(s.listeners={});var a=s.listeners[i];if(a)return a.forEach(function(l){r.currentTarget=s,typeof l=="function"?l(r):l.handleEvent(r)});s.parentNode&&s.parentNode.dispatchEvent(r)}}),WS=Sn(function(n,e){e.exports=t;function t(r,s){var i=this;i.listeners||(i.listeners={}),i.listeners[r]||(i.listeners[r]=[]),i.listeners[r].indexOf(s)===-1&&i.listeners[r].push(s)}}),qS=Sn(function(n,e){e.exports=t;function t(r,s){var i=this;if(i.listeners&&i.listeners[r]){var a=i.listeners[r],l=a.indexOf(s);l!==-1&&a.splice(l,1)}}}),qD=Sn(function(n,e){HS(),e.exports=r;var t=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function r(g){switch(g.nodeType){case 3:return f(g.data);case 8:return"<!--"+g.data+"-->";default:return s(g)}}function s(g){var x=[],y=g.tagName;return g.namespaceURI==="http://www.w3.org/1999/xhtml"&&(y=y.toLowerCase()),x.push("<"+y+d(g)+l(g)),t.indexOf(y)>-1?x.push(" />"):(x.push(">"),g.childNodes.length?x.push.apply(x,g.childNodes.map(r)):g.textContent||g.innerText?x.push(f(g.textContent||g.innerText)):g.innerHTML&&x.push(g.innerHTML),x.push("</"+y+">")),x.join("")}function i(g,x){var y=GS(g[x]);return x==="style"&&Object.keys(g.style).length>0?!0:g.hasOwnProperty(x)&&(y==="string"||y==="boolean"||y==="number")&&x!=="nodeName"&&x!=="className"&&x!=="tagName"&&x!=="textContent"&&x!=="innerText"&&x!=="namespaceURI"&&x!=="innerHTML"}function a(g){if(typeof g=="string")return g;var x="";return Object.keys(g).forEach(function(y){var w=g[y];y=y.replace(/[A-Z]/g,function(b){return"-"+b.toLowerCase()}),x+=y+":"+w+";"}),x}function l(g){var x=g.dataset,y=[];for(var w in x)y.push({name:"data-"+w,value:x[w]});return y.length?u(y):""}function u(g){var x=[];return g.forEach(function(y){var w=y.name,b=y.value;w==="style"&&(b=a(b)),x.push(w+'="'+m(b)+'"')}),x.length?" "+x.join(" "):""}function d(g){var x=[];for(var y in g)i(g,y)&&x.push({name:y,value:g[y]});for(var w in g._attributes)for(var b in g._attributes[w]){var E=g._attributes[w][b],T=(E.prefix?E.prefix+":":"")+b;x.push({name:T,value:E.value})}return g.className&&x.push({name:"class",value:g.className}),x.length?u(x):""}function f(g){var x="";return typeof g=="string"?x=g:g&&(x=g.toString()),x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(g){return f(g).replace(/"/g,"&quot;")}}),YS=Sn(function(n,e){Ii();var t=KS(),r=zS(),s=WS(),i=qS(),a=qD(),l="http://www.w3.org/1999/xhtml";e.exports=u;function u(d,f,m){if(!Ai(this,u))return new u(d);var g=m===void 0?l:m||null;this.tagName=g===l?String(d).toUpperCase():d,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=f||null,this.namespaceURI=g,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}u.prototype.type="DOMElement",u.prototype.nodeType=1,u.prototype.appendChild=function(d){return d.parentNode&&d.parentNode.removeChild(d),this.childNodes.push(d),d.parentNode=this,d},u.prototype.replaceChild=function(d,f){d.parentNode&&d.parentNode.removeChild(d);var m=this.childNodes.indexOf(f);return f.parentNode=null,this.childNodes[m]=d,d.parentNode=this,f},u.prototype.removeChild=function(d){var f=this.childNodes.indexOf(d);return this.childNodes.splice(f,1),d.parentNode=null,d},u.prototype.insertBefore=function(d,f){d.parentNode&&d.parentNode.removeChild(d);var m=f==null?-1:this.childNodes.indexOf(f);return m>-1?this.childNodes.splice(m,0,d):this.childNodes.push(d),d.parentNode=this,d},u.prototype.setAttributeNS=function(d,f,m){var g=null,x=f,y=f.indexOf(":");if(y>-1&&(g=f.substr(0,y),x=f.substr(y+1)),this.tagName==="INPUT"&&f==="type")this.type=m;else{var w=this._attributes[d]||(this._attributes[d]={});w[x]={value:m,prefix:g}}},u.prototype.getAttributeNS=function(d,f){var m=this._attributes[d],g=m&&m[f]&&m[f].value;return this.tagName==="INPUT"&&f==="type"?this.type:typeof g!="string"?null:g},u.prototype.removeAttributeNS=function(d,f){var m=this._attributes[d];m&&delete m[f]},u.prototype.hasAttributeNS=function(d,f){var m=this._attributes[d];return!!m&&f in m},u.prototype.setAttribute=function(d,f){return this.setAttributeNS(null,d,f)},u.prototype.getAttribute=function(d){return this.getAttributeNS(null,d)},u.prototype.removeAttribute=function(d){return this.removeAttributeNS(null,d)},u.prototype.hasAttribute=function(d){return this.hasAttributeNS(null,d)},u.prototype.removeEventListener=i,u.prototype.addEventListener=s,u.prototype.dispatchEvent=r,u.prototype.focus=function(){},u.prototype.toString=function(){return a(this)},u.prototype.getElementsByClassName=function(d){var f=d.split(" "),m=[];return t(this,function(g){if(g.nodeType===1){var x=g.className||"",y=x.split(" ");f.every(function(w){return y.indexOf(w)!==-1})&&m.push(g)}}),m},u.prototype.getElementsByTagName=function(d){d=d.toLowerCase();var f=[];return t(this.childNodes,function(m){m.nodeType===1&&(d==="*"||m.tagName.toLowerCase()===d)&&f.push(m)}),f},u.prototype.contains=function(d){return t(this,function(f){return d===f})||!1}}),YD=Sn(function(n,e){Ii();var t=YS();e.exports=r;function r(s){if(!Ai(this,r))return new r;this.childNodes=[],this.parentNode=null,this.ownerDocument=s||null}r.prototype.type="DocumentFragment",r.prototype.nodeType=11,r.prototype.nodeName="#document-fragment",r.prototype.appendChild=t.prototype.appendChild,r.prototype.replaceChild=t.prototype.replaceChild,r.prototype.removeChild=t.prototype.removeChild,r.prototype.toString=function(){return this.childNodes.map(function(s){return String(s)}).join("")}}),QD=Sn(function(n,e){e.exports=t;function t(r){}t.prototype.initEvent=function(r,s,i){this.type=r,this.bubbles=s,this.cancelable=i},t.prototype.preventDefault=function(){}}),XD=Sn(function(n,e){Ii();var t=KS(),r=zD(),s=WD(),i=YS(),a=YD(),l=QD(),u=zS(),d=WS(),f=qS();e.exports=m;function m(){if(!Ai(this,m))return new m;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var g=m.prototype;g.createTextNode=function(x){return new s(x,this)},g.createElementNS=function(x,y){var w=x===null?null:String(x);return new i(y,this,w)},g.createElement=function(x){return new i(x,this)},g.createDocumentFragment=function(){return new a(this)},g.createEvent=function(x){return new l(x)},g.createComment=function(x){return new r(x,this)},g.getElementById=function(x){x=String(x);var y=t(this.childNodes,function(w){if(String(w.id)===x)return w});return y||null},g.getElementsByClassName=i.prototype.getElementsByClassName,g.getElementsByTagName=i.prototype.getElementsByTagName,g.contains=i.prototype.contains,g.removeEventListener=f,g.addEventListener=d,g.dispatchEvent=u}),ZD=Sn(function(n,e){var t=XD();e.exports=new t}),QS=Sn(function(n,e){var t=typeof global<"u"?global:typeof window<"u"?window:{},r=ZD(),s;typeof document<"u"?s=document:(s=t["__GLOBAL_DOCUMENT_CACHE@4"],s||(s=t["__GLOBAL_DOCUMENT_CACHE@4"]=r)),e.exports=s});function JD(n){if(Array.isArray(n))return n}function eN(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r=[],s=!0,i=!1,a,l;try{for(t=t.call(n);!(s=(a=t.next()).done)&&(r.push(a.value),!(e&&r.length===e));s=!0);}catch(u){i=!0,l=u}finally{try{!s&&t.return!=null&&t.return()}finally{if(i)throw l}}return r}}function tN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xm(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function XS(n,e){if(n){if(typeof n=="string")return Xm(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Xm(n,e)}}function ns(n,e){return JD(n)||eN(n,e)||XS(n,e)||tN()}var Ko=Wn(Nr()),b1=Wn(Nr()),nN=Wn(Nr()),rN={now:function(){var n=nN.default.performance,e=n&&n.timing,t=e&&e.navigationStart,r=typeof t=="number"&&typeof n.now=="function"?t+n.now():Date.now();return Math.round(r)}},$t=rN,ll=function(){var n,e,t;if(typeof((n=b1.default.crypto)===null||n===void 0?void 0:n.getRandomValues)=="function"){t=new Uint8Array(32),b1.default.crypto.getRandomValues(t);for(var r=0;r<32;r++)t[r]=t[r]%16}else{t=[];for(var s=0;s<32;s++)t[s]=Math.random()*16|0}var i=0;e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var d=u==="x"?t[i]:t[i]&3|8;return i++,d.toString(16)});var a=$t.now(),l=a?.toString(16).substring(3);return l?e.substring(0,28)+l:e},ZS=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},sr=function(n){if(n&&typeof n.nodeName<"u")return n.muxId||(n.muxId=ZS()),n.muxId;var e;try{e=document.querySelector(n)}catch{}return e&&!e.muxId&&(e.muxId=n),e?.muxId||n},Bu=function(n){var e;n&&typeof n.nodeName<"u"?(e=n,n=sr(e)):e=document.querySelector(n);var t=e&&e.nodeName?e.nodeName.toLowerCase():"";return[e,n,t]};function sN(n){if(Array.isArray(n))return Xm(n)}function iN(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function aN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ir(n){return sN(n)||iN(n)||XS(n)||aN()}var gi={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4},oN=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t,r,s,i,a,l=[console,n],u=(t=console.trace).bind.apply(t,ir(l)),d=(r=console.info).bind.apply(r,ir(l)),f=(s=console.debug).bind.apply(s,ir(l)),m=(i=console.warn).bind.apply(i,ir(l)),g=(a=console.error).bind.apply(a,ir(l)),x=e;return{trace:function(){for(var y=arguments.length,w=new Array(y),b=0;b<y;b++)w[b]=arguments[b];if(!(x>gi.TRACE))return u.apply(void 0,ir(w))},debug:function(){for(var y=arguments.length,w=new Array(y),b=0;b<y;b++)w[b]=arguments[b];if(!(x>gi.DEBUG))return f.apply(void 0,ir(w))},info:function(){for(var y=arguments.length,w=new Array(y),b=0;b<y;b++)w[b]=arguments[b];if(!(x>gi.INFO))return d.apply(void 0,ir(w))},warn:function(){for(var y=arguments.length,w=new Array(y),b=0;b<y;b++)w[b]=arguments[b];if(!(x>gi.WARN))return m.apply(void 0,ir(w))},error:function(){for(var y=arguments.length,w=new Array(y),b=0;b<y;b++)w[b]=arguments[b];if(!(x>gi.ERROR))return g.apply(void 0,ir(w))},get level(){return x},set level(y){y!==this.level&&(x=y??e)}}},tt=oN("[mux]"),zh=Wn(Nr());function Zm(){var n=zh.default.doNotTrack||zh.default.navigator&&zh.default.navigator.doNotTrack;return n==="1"}function Ne(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}Ii();function Ot(n,e){if(!Ai(n,e))throw new TypeError("Cannot call a class as a function")}function lN(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function jr(n,e,t){return e&&lN(n.prototype,e),n}function me(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Aa(n){return Aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Aa(n)}function cN(n,e){for(;!Object.prototype.hasOwnProperty.call(n,e)&&(n=Aa(n),n!==null););return n}function bu(n,e,t){return typeof Reflect<"u"&&Reflect.get?bu=Reflect.get:bu=function(r,s,i){var a=cN(r,s);if(a){var l=Object.getOwnPropertyDescriptor(a,s);return l.get?l.get.call(i||r):l.value}},bu(n,e,t||n)}function Jm(n,e){return Jm=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},Jm(n,e)}function uN(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&Jm(n,e)}function dN(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function fN(n,e){if(n==null)return{};var t=dN(n,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function hN(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}HS();function mN(n,e){return e&&(GS(e)==="object"||typeof e=="function")?e:Ne(n)}function pN(n){var e=hN();return function(){var t=Aa(n),r;if(e){var s=Aa(this).constructor;r=Reflect.construct(t,arguments,s)}else r=t.apply(this,arguments);return mN(this,r)}}var lr=function(n){return cl(n)[0]},cl=function(n){if(typeof n!="string"||n==="")return["localhost"];var e=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t=n.match(e)||[],r=t[4],s;return r&&(s=(r.match(/[^\.]+\.[^\.]+$/)||[])[0]),[r,s]},Wh=Wn(Nr()),gN={exists:function(){var n=Wh.default.performance,e=n&&n.timing;return e!==void 0},domContentLoadedEventEnd:function(){var n=Wh.default.performance,e=n&&n.timing;return e&&e.domContentLoadedEventEnd},navigationStart:function(){var n=Wh.default.performance,e=n&&n.timing;return e&&e.navigationStart}},Uu=gN;function jt(n,e,t){t=t===void 0?1:t,n[e]=n[e]||0,n[e]+=t}function $u(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){me(n,s,t[s])})}return n}function xN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t.push.apply(t,r)}return t}function l0(n,e){return e=e??{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):xN(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n}var yN=["x-cdn","content-type"],JS=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],vN=yN.concat(JS);function c0(n){n=n||"";var e={},t=n.trim().split(/[\r\n]+/);return t.forEach(function(r){if(r){var s=r.split(": "),i=s.shift();i&&(vN.indexOf(i.toLowerCase())>=0||i.toLowerCase().indexOf("x-litix-")===0)&&(e[i]=s.join(": "))}}),e}function Vu(n){if(n){var e=JS.find(function(t){return n[t]!==void 0});return e?n[e]:void 0}}var wN=function(n){var e={};for(var t in n){var r=n[t],s=r["DATA-ID"].search("io.litix.data.");if(s!==-1){var i=r["DATA-ID"].replace("io.litix.data.","");e[i]=r.VALUE}}return e},eE=wN,nu=function(n){if(!n)return{};var e=Uu.navigationStart(),t=n.loading,r=t?t.start:n.trequest,s=t?t.first:n.tfirst,i=t?t.end:n.tload;return{bytesLoaded:n.total,requestStart:Math.round(e+r),responseStart:Math.round(e+s),responseEnd:Math.round(e+i)}},Do=function(n){if(!(!n||typeof n.getAllResponseHeaders!="function"))return c0(n.getAllResponseHeaders())},bN=function(n,e,t){var r=arguments.length>4?arguments[4]:void 0,s=n.log,i=n.utils.secondsToMs,a=function(b){var E=parseInt(r.version),T;return E===1&&b.programDateTime!==null&&(T=b.programDateTime),E===0&&b.pdt!==null&&(T=b.pdt),T};if(!Uu.exists()){s.warn("performance timing not supported. Not tracking HLS.js.");return}var l=function(b,E){return n.emit(e,b,E)},u=function(b,E){var T=E.levels,_=E.audioTracks,A=E.url,I=E.stats,N=E.networkDetails,P=E.sessionData,O={},M={};T.forEach(function(re,ee){O[ee]={width:re.width,height:re.height,bitrate:re.bitrate,attrs:re.attrs}}),_.forEach(function(re,ee){M[ee]={name:re.name,language:re.lang,bitrate:re.bitrate}});var D=nu(I),B=D.bytesLoaded,q=D.requestStart,ie=D.responseStart,te=D.responseEnd;l("requestcompleted",l0($u({},eE(P)),{request_event_type:b,request_bytes_loaded:B,request_start:q,request_response_start:ie,request_response_end:te,request_type:"manifest",request_hostname:lr(A),request_response_headers:Do(N),request_rendition_lists:{media:O,audio:M,video:{}}}))};t.on(r.Events.MANIFEST_LOADED,u);var d=function(b,E){var T=E.details,_=E.level,A=E.networkDetails,I=E.stats,N=nu(I),P=N.bytesLoaded,O=N.requestStart,M=N.responseStart,D=N.responseEnd,B=T.fragments[T.fragments.length-1],q=a(B)+i(B.duration);l("requestcompleted",{request_event_type:b,request_bytes_loaded:P,request_start:O,request_response_start:M,request_response_end:D,request_current_level:_,request_type:"manifest",request_hostname:lr(T.url),request_response_headers:Do(A),video_holdback:T.holdBack&&i(T.holdBack),video_part_holdback:T.partHoldBack&&i(T.partHoldBack),video_part_target_duration:T.partTarget&&i(T.partTarget),video_target_duration:T.targetduration&&i(T.targetduration),video_source_is_live:T.live,player_manifest_newest_program_time:isNaN(q)?void 0:q})};t.on(r.Events.LEVEL_LOADED,d);var f=function(b,E){var T=E.details,_=E.networkDetails,A=E.stats,I=nu(A),N=I.bytesLoaded,P=I.requestStart,O=I.responseStart,M=I.responseEnd;l("requestcompleted",{request_event_type:b,request_bytes_loaded:N,request_start:P,request_response_start:O,request_response_end:M,request_type:"manifest",request_hostname:lr(T.url),request_response_headers:Do(_)})};t.on(r.Events.AUDIO_TRACK_LOADED,f);var m=function(b,E){var T=E.stats,_=E.networkDetails,A=E.frag;T=T||A.stats;var I=nu(T),N=I.bytesLoaded,P=I.requestStart,O=I.responseStart,M=I.responseEnd,D=_?Do(_):void 0,B={request_event_type:b,request_bytes_loaded:N,request_start:P,request_response_start:O,request_response_end:M,request_hostname:_?lr(_.responseURL):void 0,request_id:D?Vu(D):void 0,request_response_headers:D,request_media_duration:A.duration,request_url:_?.responseURL};A.type==="main"?(B.request_type="media",B.request_current_level=A.level,B.request_video_width=(t.levels[A.level]||{}).width,B.request_video_height=(t.levels[A.level]||{}).height,B.request_labeled_bitrate=(t.levels[A.level]||{}).bitrate):B.request_type=A.type,l("requestcompleted",B)};t.on(r.Events.FRAG_LOADED,m);var g=function(b,E){var T=E.frag,_=T.start,A=a(T),I={currentFragmentPDT:A,currentFragmentStart:i(_)};l("fragmentchange",I)};t.on(r.Events.FRAG_CHANGED,g);var x=function(b,E){var T=E.type,_=E.details,A=E.response,I=E.fatal,N=E.frag,P=E.networkDetails,O=N?.url||E.url||"",M=P?Do(P):void 0;if((_===r.ErrorDetails.MANIFEST_LOAD_ERROR||_===r.ErrorDetails.MANIFEST_LOAD_TIMEOUT||_===r.ErrorDetails.FRAG_LOAD_ERROR||_===r.ErrorDetails.FRAG_LOAD_TIMEOUT||_===r.ErrorDetails.LEVEL_LOAD_ERROR||_===r.ErrorDetails.LEVEL_LOAD_TIMEOUT||_===r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||_===r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||_===r.ErrorDetails.SUBTITLE_LOAD_ERROR||_===r.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||_===r.ErrorDetails.KEY_LOAD_ERROR||_===r.ErrorDetails.KEY_LOAD_TIMEOUT)&&l("requestfailed",{request_error:_,request_url:O,request_hostname:lr(O),request_id:M?Vu(M):void 0,request_type:_===r.ErrorDetails.FRAG_LOAD_ERROR||_===r.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":_===r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||_===r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":_===r.ErrorDetails.SUBTITLE_LOAD_ERROR||_===r.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":_===r.ErrorDetails.KEY_LOAD_ERROR||_===r.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:A?.code,request_error_text:A?.text}),I){var D,B="".concat(O?"url: ".concat(O,`
`):"")+"".concat(A&&(A.code||A.text)?"response: ".concat(A.code,", ").concat(A.text,`
`):"")+"".concat(E.reason?"failure reason: ".concat(E.reason,`
`):"")+"".concat(E.level?"level: ".concat(E.level,`
`):"")+"".concat(E.parent?"parent stream controller: ".concat(E.parent,`
`):"")+"".concat(E.buffer?"buffer length: ".concat(E.buffer,`
`):"")+"".concat(E.error?"error: ".concat(E.error,`
`):"")+"".concat(E.event?"event: ".concat(E.event,`
`):"")+"".concat(E.err?"error message: ".concat((D=E.err)===null||D===void 0?void 0:D.message,`
`):"");l("error",{player_error_code:T,player_error_message:_,player_error_context:B})}};t.on(r.Events.ERROR,x);var y=function(b,E){var T=E.frag,_=T&&T._url||"";l("requestcanceled",{request_event_type:b,request_url:_,request_type:"media",request_hostname:lr(_)})};t.on(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,y);var w=function(b,E){var T=E.level,_=t.levels[T];if(_&&_.attrs&&_.attrs.BANDWIDTH){var A=_.attrs.BANDWIDTH,I,N=parseFloat(_.attrs["FRAME-RATE"]);isNaN(N)||(I=N),A?l("renditionchange",{video_source_fps:I,video_source_bitrate:A,video_source_width:_.width,video_source_height:_.height,video_source_rendition_name:_.name,video_source_codec:_?.videoCodec}):s.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};t.on(r.Events.LEVEL_SWITCHED,w),t._stopMuxMonitor=function(){t.off(r.Events.MANIFEST_LOADED,u),t.off(r.Events.LEVEL_LOADED,d),t.off(r.Events.AUDIO_TRACK_LOADED,f),t.off(r.Events.FRAG_LOADED,m),t.off(r.Events.FRAG_CHANGED,g),t.off(r.Events.ERROR,x),t.off(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,y),t.off(r.Events.LEVEL_SWITCHED,w),t.off(r.Events.DESTROYING,t._stopMuxMonitor),delete t._stopMuxMonitor},t.on(r.Events.DESTROYING,t._stopMuxMonitor)},SN=function(n){n&&typeof n._stopMuxMonitor=="function"&&n._stopMuxMonitor()},S1=function(n,e){if(!n||!n.requestEndDate)return{};var t=lr(n.url),r=n.url,s=n.bytesLoaded,i=new Date(n.requestStartDate).getTime(),a=new Date(n.firstByteDate).getTime(),l=new Date(n.requestEndDate).getTime(),u=isNaN(n.duration)?0:n.duration,d=typeof e.getMetricsFor=="function"?e.getMetricsFor(n.mediaType).HttpList:e.getDashMetrics().getHttpRequests(n.mediaType),f;d.length>0&&(f=c0(d[d.length-1]._responseHeaders||""));var m=f?Vu(f):void 0;return{requestStart:i,requestResponseStart:a,requestResponseEnd:l,requestBytesLoaded:s,requestResponseHeaders:f,requestMediaDuration:u,requestHostname:t,requestUrl:r,requestId:m}},EN=function(n,e){var t=e.getQualityFor(n),r=e.getCurrentTrackFor(n).bitrateList;return r?{currentLevel:t,renditionWidth:r[t].width||null,renditionHeight:r[t].height||null,renditionBitrate:r[t].bandwidth}:{}},TN=function(n){var e;return(e=n.match(/.*codecs\*?="(.*)"/))===null||e===void 0?void 0:e[1]},_N=function(n){try{var e,t,r=(t=n.getVersion)===null||t===void 0||(e=t.call(n))===null||e===void 0?void 0:e.split(".").map(function(s){return parseInt(s)})[0];return r}catch{return!1}},kN=function(n,e,t){var r=n.log;if(!t||!t.on){r.warn("Invalid dash.js player reference. Monitoring blocked.");return}var s=_N(t),i=function(T,_){return n.emit(e,T,_)},a=function(T){var _=T.type,A=T.data,I=(A||{}).url;i("requestcompleted",{request_event_type:_,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:lr(I),request_url:I})};t.on("manifestLoaded",a);var l={},u=function(T){if(typeof T.getRequests!="function")return null;var _=T.getRequests({state:"executed"});return _.length===0?null:_[_.length-1]},d=function(T){var _=T.type,A=T.fragmentModel,I=T.chunk,N=u(A);f({type:_,request:N,chunk:I})},f=function(T){var _=T.type,A=T.chunk,I=T.request,N=(A||{}).mediaInfo,P=N||{},O=P.type,M=P.bitrateList;M=M||[];var D={};M.forEach(function(Z,j){D[j]={},D[j].width=Z.width,D[j].height=Z.height,D[j].bitrate=Z.bandwidth,D[j].attrs={}}),O==="video"?l.video=D:O==="audio"?l.audio=D:l.media=D;var B=S1(I,t),q=B.requestStart,ie=B.requestResponseStart,te=B.requestResponseEnd,re=B.requestResponseHeaders,ee=B.requestMediaDuration,Q=B.requestHostname,G=B.requestUrl,Y=B.requestId;i("requestcompleted",{request_event_type:_,request_start:q,request_response_start:ie,request_response_end:te,request_bytes_loaded:-1,request_type:O+"_init",request_response_headers:re,request_hostname:Q,request_id:Y,request_url:G,request_media_duration:ee,request_rendition_lists:l})};s>=4?t.on("initFragmentLoaded",f):t.on("initFragmentLoaded",d);var m=function(T){var _=T.type,A=T.fragmentModel,I=T.chunk,N=u(A);g({type:_,request:N,chunk:I})},g=function(T){var _=T.type,A=T.chunk,I=T.request,N=A||{},P=N.mediaInfo,O=N.start,M=P||{},D=M.type,B=S1(I,t),q=B.requestStart,ie=B.requestResponseStart,te=B.requestResponseEnd,re=B.requestBytesLoaded,ee=B.requestResponseHeaders,Q=B.requestMediaDuration,G=B.requestHostname,Y=B.requestUrl,Z=B.requestId,j=EN(D,t),$=j.currentLevel,fe=j.renditionWidth,ne=j.renditionHeight,ae=j.renditionBitrate;i("requestcompleted",{request_event_type:_,request_start:q,request_response_start:ie,request_response_end:te,request_bytes_loaded:re,request_type:D,request_response_headers:ee,request_hostname:G,request_id:Z,request_url:Y,request_media_start_time:O,request_media_duration:Q,request_current_level:$,request_labeled_bitrate:ae,request_video_width:fe,request_video_height:ne})};s>=4?t.on("mediaFragmentLoaded",g):t.on("mediaFragmentLoaded",m);var x={video:void 0,audio:void 0,totalBitrate:void 0},y=function(){if(x.video&&typeof x.video.bitrate=="number"){if(!(x.video.width&&x.video.height)){r.warn("have bitrate info for video but missing width/height");return}var T=x.video.bitrate;if(x.audio&&typeof x.audio.bitrate=="number"&&(T+=x.audio.bitrate),T!==x.totalBitrate)return x.totalBitrate=T,{video_source_bitrate:T,video_source_height:x.video.height,video_source_width:x.video.width,video_source_codec:TN(x.video.codec)}}},w=function(T,_,A){if(typeof T.newQuality!="number"){r.warn("missing evt.newQuality in qualityChangeRendered event",T);return}var I=T.mediaType;if(I==="audio"||I==="video"){var N=t.getBitrateInfoListFor(I).find(function(O){var M=O.qualityIndex;return M===T.newQuality});if(!(N&&typeof N.bitrate=="number")){r.warn("missing bitrate info for ".concat(I));return}x[I]=l0($u({},N),{codec:t.getCurrentTrackFor(I).codec});var P=y();P&&i("renditionchange",P)}};t.on("qualityChangeRendered",w);var b=function(T){var _=T.request,A=T.mediaType;_=_||{},i("requestcanceled",{request_event_type:_.type+"_"+_.action,request_url:_.url,request_type:A,request_hostname:lr(_.url)})};t.on("fragmentLoadingAbandoned",b);var E=function(T){var _=T.error,A,I,N=(_==null||(A=_.data)===null||A===void 0?void 0:A.request)||{},P=(_==null||(I=_.data)===null||I===void 0?void 0:I.response)||{};_?.code===27&&i("requestfailed",{request_error:N.type+"_"+N.action,request_url:N.url,request_hostname:lr(N.url),request_type:N.mediaType,request_error_code:P.status,request_error_text:P.statusText});var O="".concat(N!=null&&N.url?"url: ".concat(N.url,`
`):"")+"".concat(P!=null&&P.status||P!=null&&P.statusText?"response: ".concat(P?.status,", ").concat(P?.statusText,`
`):"");i("error",{player_error_code:_?.code,player_error_message:_?.message,player_error_context:O})};t.on("error",E),t._stopMuxMonitor=function(){t.off("manifestLoaded",a),t.off("initFragmentLoaded",f),t.off("mediaFragmentLoaded",g),t.off("qualityChangeRendered",w),t.off("error",E),t.off("fragmentLoadingAbandoned",b),delete t._stopMuxMonitor}},CN=function(n){n&&typeof n._stopMuxMonitor=="function"&&n._stopMuxMonitor()},E1=0,AN=(function(){function n(){Ot(this,n),me(this,"_listeners",void 0)}return jr(n,[{key:"on",value:function(e,t,r){return t._eventEmitterGuid=t._eventEmitterGuid||++E1,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],r&&(t=t.bind(r)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var r=this._listeners&&this._listeners[e];r&&r.forEach(function(s,i){s._eventEmitterGuid===t._eventEmitterGuid&&r.splice(i,1)})}},{key:"one",value:function(e,t,r){var s=this;t._eventEmitterGuid=t._eventEmitterGuid||++E1;var i=function(){s.off(e,i),t.apply(r||this,arguments)};i._eventEmitterGuid=t._eventEmitterGuid,this.on(e,i)}},{key:"emit",value:function(e,t){var r=this;if(this._listeners){t=t||{};var s=this._listeners["before"+e]||[],i=this._listeners["before*"]||[],a=this._listeners[e]||[],l=this._listeners["after"+e]||[],u=function(d,f){d=d.slice(),d.forEach(function(m){m.call(r,{type:e},f)})};u(s,t),u(i,t),u(a,t),u(l,t)}}}]),n})(),IN=AN,qh=Wn(Nr()),LN=(function(){function n(e){var t=this;Ot(this,n),me(this,"_playbackHeartbeatInterval",void 0),me(this,"_playheadShouldBeProgressing",void 0),me(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(r,s){t._playbackHeartbeatInterval!==null&&(qh.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:s.viewer_time}),t._playbackHeartbeatInterval=null)})}return jr(n,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=qh.default.setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(qh.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),n})(),RN=LN,PN=function n(e){var t=this;Ot(this,n),me(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(r,s){try{var i=e.errorTranslator({player_error_code:s.player_error_code,player_error_message:s.player_error_message,player_error_context:s.player_error_context,player_error_severity:s.player_error_severity,player_error_business_exception:s.player_error_business_exception});i&&(e.data.player_error_code=i.player_error_code||s.player_error_code,e.data.player_error_message=i.player_error_message||s.player_error_message,e.data.player_error_context=i.player_error_context||s.player_error_context,e.data.player_error_severity=i.player_error_severity||s.player_error_severity,e.data.player_error_business_exception=i.player_error_business_exception||s.player_error_business_exception,t.viewErrored=!0)}catch(a){e.mux.log.warn("Exception in error translator callback.",a),t.viewErrored=!0}}),e.on("aftererror",function(){var r,s,i,a,l;(r=e.data)===null||r===void 0||delete r.player_error_code,(s=e.data)===null||s===void 0||delete s.player_error_message,(i=e.data)===null||i===void 0||delete i.player_error_context,(a=e.data)===null||a===void 0||delete a.player_error_severity,(l=e.data)===null||l===void 0||delete l.player_error_business_exception})},DN=PN,NN=(function(){function n(e){Ot(this,n),me(this,"_watchTimeTrackerLastCheckedTime",void 0),me(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return jr(n,[{key:"_updateWatchTime",value:function(e,t){var r=t.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=r),jt(this.pm.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),n})(),jN=NN,ON=(function(){function n(e){var t=this;Ot(this,n),me(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),me(this,"_lastTime",void 0),me(this,"_isAdPlaying",void 0),me(this,"_callbackUpdatePlaybackTime",void 0),me(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=$t.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null,e.on("viewinit",function(){t.pm.data.view_playing_time_ms_cumulative=0});var r=this._startPlaybackTimeTracking.bind(this);e.on("playing",r),e.on("adplaying",r),e.on("seeked",r),e.on("rebufferend",r);var s=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",s),e.on("seeking",s),e.on("rebufferstart",s),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=$t.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return jr(n,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this._lastTime=$t.now(),this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time||0,t=$t.now(),r=t-this._lastTime,s=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?s=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(s=r),s>0&&s<=1e3&&jt(this.pm.data,"view_content_playback_time",s),this._callbackUpdatePlaybackTime!==null&&r>0&&r<=1e3&&(this._isAdPlaying&&jt(this.pm.data,"ad_playing_time_ms_cumulative",r),jt(this.pm.data,"view_playing_time_ms_cumulative",r)),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}]),n})(),MN=ON,FN=(function(){function n(e){Ot(this,n),me(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return jr(n,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position>"u"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var r=this,s=function(){r.pm.currentFragmentPDT&&r.pm.currentFragmentStart&&(r.pm.data.player_program_time=r.pm.currentFragmentPDT+r.pm.data.player_playhead_time-r.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,s(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var i=this.pm.getPlayheadTime();typeof i<"u"&&(this.pm.data.player_playhead_time=i,s(),this._updateMaxPlayheadPosition())}}}]),n})(),BN=FN,T1=300*1e3,UN=function n(e){if(Ot(this,n),!e.disableRebufferTracking){var t,r=function(i,a){s(a),t=void 0},s=function(i){if(t){var a=i.viewer_time-t;jt(e.data,"view_rebuffer_duration",a),t=i.viewer_time,e.data.view_rebuffer_duration>T1&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat(T1,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(i,a){return s(a)}),e.on("rebufferstart",function(i,a){t||(jt(e.data,"view_rebuffer_count",1),t=a.viewer_time,e.one("rebufferend",r))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",r)})}},$N=UN,VN=(function(){function n(e){var t=this;Ot(this,n),me(this,"_lastCheckedTime",void 0),me(this,"_lastPlayheadTime",void 0),me(this,"_lastPlayheadTimeUpdatedTime",void 0),me(this,"_rebuffering",void 0),me(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:$t.now()})}))}return jr(n,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(e,t);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(t.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(e,t,!0);return}var r=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&r>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(this._lastCheckedTime===null)return;var s=this.pm.data.player_playhead_time-this._lastPlayheadTime,i=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&s>0&&i-s>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+i-s}))}r?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),n})(),GN=VN,HN=(function(){function n(e){var t=this;Ot(this,n),me(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var r=e.data,s=r.view_id;if(!r.view_program_changed){var i=function(a,l){var u=l.viewer_time;(a.type==="playing"&&typeof e.data.view_time_to_first_frame>"u"||a.type==="adplaying"&&(typeof e.data.view_time_to_first_frame>"u"||t._inPrerollPosition()))&&t.calculateTimeToFirstFrame(u||$t.now(),s)};e.one("playing",i),e.one("adplaying",i),e.one("viewend",function(){e.off("playing",i),e.off("adplaying",i)})}})}return jr(n,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time>"u"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.pm.pageLoadInitTime&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.pm.pageLoadInitTime))}}]),n})(),KN=HN,zN=function n(e){var t=this;Ot(this,n),me(this,"_lastPlayerHeight",void 0),me(this,"_lastPlayerWidth",void 0),me(this,"_lastPlayheadPosition",void 0),me(this,"_lastSourceHeight",void 0),me(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var r=["pause","rebufferstart","seeking","error","adbreakstart","hb","renditionchange","orientationchange","viewend","playbackmodechange"],s=["playing","hb","renditionchange","orientationchange","playbackmodechange"];r.forEach(function(i){e.on(i,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var a=e.data.player_playhead_time-t._lastPlayheadPosition;if(a<0){t._lastPlayheadPosition=-1;return}var l=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),u=Math.max(0,l-1),d=Math.max(0,1-l);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,u),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,d),jt(e.data,"view_total_content_playback_time",a),jt(e.data,"view_total_upscaling",u*a),jt(e.data,"view_total_downscaling",d*a)}t._lastPlayheadPosition=-1})}),s.forEach(function(i){e.on(i,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},WN=zN,qN=2e3,YN=function n(e){var t=this;Ot(this,n),me(this,"isSeeking",void 0),this.isSeeking=!1;var r=-1,s=function(){var i=$t.now(),a=(e.data.viewer_time||i)-(r||i);jt(e.data,"view_seek_duration",a),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,a),t.isSeeking=!1,r=-1};e.on("seeking",function(i,a){if(Object.assign(e.data,a),t.isSeeking&&a.viewer_time-r<=qN){r=a.viewer_time;return}t.isSeeking&&s(),t.isSeeking=!0,r=a.viewer_time,jt(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){s()}),e.on("viewend",function(){t.isSeeking&&(s(),e.send("seeked")),t.isSeeking=!1,r=-1})},QN=YN,_1=function(n,e){n.push(e),n.sort(function(t,r){return t.viewer_time-r.viewer_time})},XN=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],ZN=(function(){function n(e){var t=this;Ot(this,n),me(this,"_adHasPlayed",void 0),me(this,"_adRequests",void 0),me(this,"_adResponses",void 0),me(this,"_currentAdRequestNumber",void 0),me(this,"_currentAdResponseNumber",void 0),me(this,"_prerollPlayTime",void 0),me(this,"_wouldBeNewAdPlay",void 0),me(this,"isAdBreak",void 0),me(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),XN.forEach(function(s){return e.on(s,t._updateAdData.bind(t))});var r=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",r),e.on("playing",r),e.on("viewend",r),e.on("adrequest",function(s,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},i),_1(t._adRequests,i),jt(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||jt(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(s,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},i),_1(t._adResponses,i);var a=t.findAdRequest(i.ad_request_id);a&&jt(e.data,"view_ad_request_time",Math.max(0,i.viewer_time-a.viewer_time))}),e.on("adplay",function(s,i){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,jt(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,i.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,i.viewer_time-e.data.view_start)),t._prerollPlayTime=i.viewer_time)}),e.on("adplaying",function(s,i){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time>"u"&&typeof t._prerollPlayTime<"u"&&(e.data.view_preroll_load_time=i.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=i.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(s,i){t._wouldBeNewAdPlay||jt(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(s,i){t._wouldBeNewAdPlay||jt(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return jr(n,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time>"u"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var r=ns(cl(t.ad_tag_url),2),s=r[0],i=r[1];this.pm.data.view_preroll_ad_tag_domain=i,this.pm.data.view_preroll_ad_tag_hostname=s}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=ns(cl(t.ad_asset_url),2),l=a[0],u=a[1];this.pm.data.view_preroll_ad_asset_domain=u,this.pm.data.view_preroll_ad_asset_hostname=l}this.pm.data.ad_type="preroll"}this.pm.data.ad_asset_url=t?.ad_asset_url,this.pm.data.ad_tag_url=t?.ad_tag_url,this.pm.data.ad_creative_id=t?.ad_creative_id,this.pm.data.ad_id=t?.ad_id,this.pm.data.ad_universal_id=t?.ad_universal_id,t!=null&&t.ad_type&&(this.pm.data.ad_type=t?.ad_type)}}]),n})(),JN=ZN,e4=function n(e){var t=this;Ot(this,n),me(this,"lastWallClockTime",void 0);var r=function(){t.lastWallClockTime=$t.now(),e.on("before*",s)},s=function(i){var a=$t.now(),l=t.lastWallClockTime;t.lastWallClockTime=a,a-l>3e4&&(e.emit("devicesleep",{viewer_time:l}),Object.assign(e.data,{viewer_time:l}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:a}),Object.assign(e.data,{viewer_time:a}),e.send("devicewake"))};e.one("playbackheartbeat",r),e.on("playbackheartbeatend",function(){e.off("before*",s),e.one("playbackheartbeat",r)})},t4=e4,Yh=Wn(Nr()),tE=(function(n){return n()})(function(){var n=function(){for(var t=0,r={};t<arguments.length;t++){var s=arguments[t];for(var i in s)r[i]=s[i]}return r};function e(t){function r(s,i,a){var l;if(typeof document<"u"){if(arguments.length>1){if(a=n({path:"/"},r.defaults,a),typeof a.expires=="number"){var u=new Date;u.setMilliseconds(u.getMilliseconds()+a.expires*864e5),a.expires=u}try{l=JSON.stringify(i),/^[\{\[]/.test(l)&&(i=l)}catch{}return t.write?i=t.write(i,s):i=encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),s=encodeURIComponent(String(s)),s=s.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),s=s.replace(/[\(\)]/g,escape),document.cookie=[s,"=",i,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}s||(l={});for(var d=document.cookie?document.cookie.split("; "):[],f=/(%[0-9A-Z]{2})+/g,m=0;m<d.length;m++){var g=d[m].split("="),x=g.slice(1).join("=");x.charAt(0)==='"'&&(x=x.slice(1,-1));try{var y=g[0].replace(f,decodeURIComponent);if(x=t.read?t.read(x,y):t(x,y)||x.replace(f,decodeURIComponent),this.json)try{x=JSON.parse(x)}catch{}if(s===y){l=x;break}s||(l[y]=x)}catch{}}return l}}return r.set=r,r.get=function(s){return r.call(r,s)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(s,i){r(s,"",n(i,{expires:-1}))},r.withConverter=e,r}return e(function(){})}),nE="muxData",n4=function(n){return Object.entries(n).map(function(e){var t=ns(e,2),r=t[0],s=t[1];return"".concat(r,"=").concat(s)}).join("&")},r4=function(n){return n.split("&").reduce(function(e,t){var r=ns(t.split("="),2),s=r[0],i=r[1],a=+i,l=i&&a==i?a:i;return e[s]=l,e},{})},rE=function(){var n;try{n=r4(tE.get(nE)||"")}catch{n={}}return n},sE=function(n){try{tE.set(nE,n4(n),{expires:365})}catch{}},s4=function(){var n=rE();return n.mux_viewer_id=n.mux_viewer_id||ll(),n.msn=n.msn||Math.random(),sE(n),{mux_viewer_id:n.mux_viewer_id,mux_sample_number:n.msn}},i4=function(){var n=rE(),e=$t.now();return n.session_start&&(n.sst=n.session_start,delete n.session_start),n.session_id&&(n.sid=n.session_id,delete n.session_id),n.session_expires&&(n.sex=n.session_expires,delete n.session_expires),(!n.sex||n.sex<e)&&(n.sid=ll(),n.sst=e),n.sex=e+1500*1e3,sE(n),{session_id:n.sid,session_start:n.sst,session_expires:n.sex}};function a4(n,e){var t=e.beaconCollectionDomain,r=e.beaconDomain;if(t)return"https://"+t;n=n||"inferred";var s=r||"litix.io";return n.match(/^[a-z0-9]+$/)?"https://"+n+"."+s:"https://img.litix.io/a.gif"}var o4=Wn(Nr()),iE=function(){var n;switch(aE()){case"cellular":n="cellular";break;case"ethernet":n="wired";break;case"wifi":n="wifi";break;case void 0:break;default:n="other"}return n},aE=function(){var n=o4.default.navigator,e=n&&(n.connection||n.mozConnection||n.webkitConnection);return e&&e.type};iE.getConnectionFromAPI=aE;var l4=iE,c4={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},u4=oE(c4),d4={ad:"ad",af:"affiliate",ag:"aggregate",ap:"api",al:"application",ao:"audio",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",bn:"brand",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ci:"client",ck:"clicked",cl:"canceled",cm:"cmcd",cn:"config",co:"count",ce:"counter",cp:"complete",cq:"creator",cr:"creative",cs:"captions",ct:"content",cu:"current",cv:"cumulative",cx:"connection",cz:"context",da:"data",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",dy:"dynamic",eb:"enabled",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mp:"mode",ms:"ms",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",or:"origin",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pp:"pip",pr:"preload",ps:"position",pt:"part",pv:"previous",py:"property",px:"pop",pz:"plan",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rg:"range",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sh:"shift",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",ss:"status",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},k1=oE(d4);function oE(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function ep(n){var e={},t={};return Object.keys(n).forEach(function(r){var s=!1;if(n.hasOwnProperty(r)&&n[r]!==void 0){var i=r.split("_"),a=i[0],l=u4[a];l||(tt.info("Data key word `"+i[0]+"` not expected in "+r),l=a+"_"),i.splice(1).forEach(function(u){u==="url"&&(s=!0),k1[u]?l+=k1[u]:Number.isInteger(Number(u))?l+=u:(tt.info("Data key word `"+u+"` not expected in "+r),l+="_"+u+"_")}),s?t[l]=n[r]:e[l]=n[r]}}),Object.assign(e,t)}var xi=Wn(Nr()),f4=Wn(QS()),h4={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},m4=56*1024,p4=["hb","requestcompleted","requestfailed","requestcanceled"],g4="https://img.litix.io",as=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=n||g4,this._eventQueue=[],this._postInFlight=!1,this._resendAfterPost=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},h4,e)};as.prototype.queueEvent=function(n,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||n==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};as.prototype.flushEvents=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};as.prototype.destroy=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,n?this._clearBeaconQueue():this.flushEvents(),xi.default.clearTimeout(this._sendTimeout)};as.prototype._clearBeaconQueue=function(){var n=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(n);n>0&&Object.assign(e[e.length-1],ep({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);lE(this._beaconUrl,t,!0,function(){})};as.prototype._sendBeaconQueue=function(){var n=this;if(this._postInFlight){this._resendAfterPost=!0;return}var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),r=$t.now();lE(this._beaconUrl,t,!1,function(s,i){i?(n._eventQueue=e.concat(n._eventQueue),n._failureCount+=1,tt.info("Error sending beacon: "+i)):n._failureCount=0,n._roundTripTime=$t.now()-r,n._postInFlight=!1,n._resendAfterPost&&(n._resendAfterPost=!1,n._eventQueue.length>0&&n._sendBeaconQueue())})};as.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var n=Math.pow(2,this._failureCount-1);return n=n*Math.random(),(1+n)*this._options.baseTimeBetweenBeacons};as.prototype._startBeaconSending=function(){var n=this;xi.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=xi.default.setTimeout(function(){n._eventQueue.length&&n._sendBeaconQueue(),n._startBeaconSending()},this._getNextBeaconTime()))};as.prototype._createPayload=function(n){var e=this,t={transmission_timestamp:Math.round($t.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var r,s,i,a=function(){r=JSON.stringify({metadata:t,events:s||n}),i=r.length/1024},l=function(){return i<=e._options.maxPayloadKBSize};return a(),l()||(tt.info("Payload size is too big ("+i+" kb). Removing unnecessary events."),s=n.filter(function(u){return p4.indexOf(u.e)===-1}),a()),l()||(tt.info("Payload size still too big ("+i+" kb). Cropping fields.."),s.forEach(function(u){for(var d in u){var f=u[d],m=50*1024;typeof f=="string"&&f.length>m&&(u[d]=f.substring(0,m))}}),a()),r};var x4=typeof f4.default.exitPictureInPicture=="function"?function(n){return n.length<=m4}:function(n){return!1},lE=function(n,e,t,r){if(t&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(n,e)){r();return}if(xi.default.fetch){xi.default.fetch(n,{method:"POST",body:e,headers:{"Content-Type":"text/plain"},keepalive:x4(e)}).then(function(i){return r(null,i.ok?null:"Error")}).catch(function(i){return r(null,i)});return}if(xi.default.XMLHttpRequest){var s=new xi.default.XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===4)return r(null,s.status!==200?"error":void 0)},s.open("POST",n),s.setRequestHeader("Content-Type","text/plain"),s.send(e);return}r()},y4=as,v4=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception","view_playing_time_ms_cumulative","ad_playing_time_ms_cumulative"],w4=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],b4=["ad_id","ad_creative_id","ad_universal_id"],S4=["viewstart","error","ended","viewend"],E4=600*1e3,T4=(function(){function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ot(this,n);var s,i,a,l,u,d,f,m,g,x,y,w;me(this,"mux",void 0),me(this,"envKey",void 0),me(this,"options",void 0),me(this,"eventQueue",void 0),me(this,"sampleRate",void 0),me(this,"disableCookies",void 0),me(this,"respectDoNotTrack",void 0),me(this,"previousBeaconData",void 0),me(this,"lastEventTime",void 0),me(this,"rateLimited",void 0),me(this,"pageLevelData",void 0),me(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=r,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new y4(a4(this.envKey,this.options));var b;this.sampleRate=(b=this.options.sampleRate)!==null&&b!==void 0?b:1;var E;this.disableCookies=(E=this.options.disableCookies)!==null&&E!==void 0?E:!1;var T;this.respectDoNotTrack=(T=this.options.respectDoNotTrack)!==null&&T!==void 0?T:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(s=this.options.platform)===null||s===void 0?void 0:s.name,viewer_application_version:(i=this.options.platform)===null||i===void 0?void 0:i.version,viewer_application_engine:(a=this.options.platform)===null||a===void 0?void 0:a.layout,viewer_device_name:(l=this.options.platform)===null||l===void 0?void 0:l.product,viewer_device_category:"",viewer_device_manufacturer:(u=this.options.platform)===null||u===void 0?void 0:u.manufacturer,viewer_os_family:(f=this.options.platform)===null||f===void 0||(d=f.os)===null||d===void 0?void 0:d.family,viewer_os_architecture:(g=this.options.platform)===null||g===void 0||(m=g.os)===null||m===void 0?void 0:m.architecture,viewer_os_version:(y=this.options.platform)===null||y===void 0||(x=y.os)===null||x===void 0?void 0:x.version,viewer_connection_type:l4(),page_url:Yh.default===null||Yh.default===void 0||(w=Yh.default.location)===null||w===void 0?void 0:w.href},this.viewerData=this.disableCookies?{}:s4()}return jr(n,[{key:"send",value:function(e,t){if(!(!e||!(t!=null&&t.view_id))){if(this.respectDoNotTrack&&Zm())return tt.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||typeof t!="object")return tt.error("A data object was expected in send() but was not provided");var r=this.disableCookies?{}:i4(),s=l0($u({},this.pageLevelData,t,r,this.viewerData),{event:e,env_key:this.envKey});s.user_id&&(s.viewer_user_id=s.user_id,delete s.user_id);var i,a=((i=s.mux_sample_number)!==null&&i!==void 0?i:0)>=this.sampleRate,l=this._deduplicateBeaconData(e,s),u=ep(l);if(this.lastEventTime=this.mux.utils.now(),a)return tt.info("Not sending event due to sample rate restriction",e,s,u);if(this.envKey||tt.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,s,u),!this.rateLimited)if(tt.info("Sending event",e,s,u),this.rateLimited=!this.eventQueue.queueEvent(e,u),this.mux.WINDOW_UNLOADING&&e==="viewend")this.eventQueue.destroy(!0);else{if(this.mux.WINDOW_HIDDEN&&e==="hb")this.eventQueue.flushEvents(!0);else if(S4.indexOf(e)>=0){if(e==="error"&&t.player_error_severity==="warning")return;this.eventQueue.flushEvents()}if(this.rateLimited)return s.event="eventrateexceeded",u=ep(s),this.eventQueue.queueEvent(s.event,u),tt.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var r=this,s={},i=t.view_id;if(i==="-1"||e==="viewstart"||e==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=E4)s=$u({},t),i&&(this.previousBeaconData=s),i&&e==="viewend"&&(this.previousBeaconData=null);else{var a=e.indexOf("request")===0;Object.entries(t).forEach(function(l){var u=ns(l,2),d=u[0],f=u[1];r.previousBeaconData&&(f!==r.previousBeaconData[d]||v4.indexOf(d)>-1||r.objectHasChanged(a,d,f,r.previousBeaconData[d])||r.eventRequiresKey(e,d))&&(s[d]=f,r.previousBeaconData[d]=f)})}return s}},{key:"objectHasChanged",value:function(e,t,r,s){return!e||t.indexOf("request_")!==0?!1:t==="request_response_headers"||typeof r!="object"||typeof s!="object"?!0:Object.keys(r||{}).length!==Object.keys(s||{}).length}},{key:"eventRequiresKey",value:function(e,t){return!!(e==="renditionchange"&&t.indexOf("video_source_")===0||b4.includes(t)&&w4.includes(e))}}]),n})(),_4=function n(e){Ot(this,n);var t=0,r=0,s=0,i=0,a=0,l=0,u=0,d=function(g,x){var y=x.request_start,w=x.request_response_start,b=x.request_response_end,E=x.request_bytes_loaded;i++;var T,_;if(w?(T=w-(y??0),_=(b??0)-w):_=(b??0)-(y??0),_>0&&E&&E>0){var A=E/_*8e3;a++,r+=E,s+=_,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,A),e.data.view_average_request_throughput=r/s*8e3,e.data.view_request_count=i,T>0&&(t+=T,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,T),e.data.view_average_request_latency=t/a)}},f=function(g,x){i++,l++,e.data.view_request_count=i,e.data.view_request_failed_count=l},m=function(g,x){i++,u++,e.data.view_request_count=i,e.data.view_request_canceled_count=u};e.on("requestcompleted",d),e.on("requestfailed",f),e.on("requestcanceled",m)},k4=_4,C4=3600*1e3,A4=function n(e){var t=this;Ot(this,n),me(this,"_lastEventTime",void 0),e.on("before*",function(r,s){var i=s.viewer_time,a=$t.now(),l=t._lastEventTime;if(t._lastEventTime=a,l&&a-l>C4){var u=Object.keys(e.data).reduce(function(f,m){return m.indexOf("video_")===0?Object.assign(f,me({},m,e.data[m])):f},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view");var d=e.playbackHeartbeat._playheadShouldBeProgressing;e._resetView(Object.assign({viewer_time:i},u)),e.playbackHeartbeat._playheadShouldBeProgressing=d,e.playbackHeartbeat._playheadShouldBeProgressing&&r.type!=="play"&&r.type!=="adbreakstart"&&(e.emit("play",{viewer_time:i}),r.type!=="playing"&&e.emit("playing",{viewer_time:i}))}})},I4=A4,L4=function n(e){Ot(this,n);var t=function(l){var u=R4(l),d=P4(l);if(u!=null&&!C1(u,i)&&a<=d){i=u,a=d;var f={video_cdn:u};e.emit("cdnchange",f)}},r=null,s=null,i=null,a=0;e.on("viewinit",function(){r=null,s=null,i=null,a=0}),e.on("beforecdnchange",function(l,u){var d=u?.video_cdn;d&&(typeof u.video_previous_cdn>"u"||u.video_previous_cdn===null)&&(C1(d,s)?u.video_previous_cdn=r??void 0:(u.video_previous_cdn=s??void 0,r=s,s=d))}),e.on("requestcompleted",function(l,u){t(u)})};function C1(n,e){return n?.toLowerCase()===e?.toLowerCase()}function R4(n){var e;return n!=null&&n.request_type&&(n.request_type==="media"||n.request_type==="video")&&!((e=n.request_response_headers)===null||e===void 0)&&e["x-cdn"]?n.request_response_headers["x-cdn"]:n!=null&&n.video_cdn?n.video_cdn:null}function P4(n){return n!=null&&n.request_start?n.request_start:n!=null&&n.viewer_time?n.viewer_time:Date.now()}var D4=L4,N4=function(n){try{return JSON.parse(n),!0}catch{return!1}},j4=function n(e){var t=this;Ot(this,n),me(this,"_emittingAutomaticEvent",!1),me(this,"_hasInitialized",!1),e.on("viewstart",function(){t._hasInitialized||(t._hasInitialized=!0,t._emittingAutomaticEvent=!0,e.emit("playbackmodechange",{player_playback_mode:"standard",player_playback_mode_data:"{}"}),t._emittingAutomaticEvent=!1)}),e.on("viewend",function(){t._hasInitialized=!1}),e.on("playbackmodechange",function(r,s){t._emittingAutomaticEvent||(s.player_playback_mode_data?N4(s.player_playback_mode_data)||(e.mux.log.warn("Invalid JSON string for player_playback_mode_data"),s.player_playback_mode_data="{}"):s.player_playback_mode_data="{}",e.data.player_playback_mode_data=s.player_playback_mode_data,e.data.player_playback_mode=s.player_playback_mode)})},O4=j4,M4=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange","cdnchange","playbackmodechange"],F4=new Set(["requestcompleted","requestfailed","requestcanceled"]),B4=(function(n){uN(t,n);var e=pN(t);function t(r,s,i){Ot(this,t);var a;a=e.call(this),me(Ne(a),"pageLoadEndTime",void 0),me(Ne(a),"pageLoadInitTime",void 0),me(Ne(a),"_destroyed",void 0),me(Ne(a),"_heartBeatTimeout",void 0),me(Ne(a),"adTracker",void 0),me(Ne(a),"dashjs",void 0),me(Ne(a),"data",void 0),me(Ne(a),"disablePlayheadRebufferTracking",void 0),me(Ne(a),"disableRebufferTracking",void 0),me(Ne(a),"errorTracker",void 0),me(Ne(a),"errorTranslator",void 0),me(Ne(a),"emitTranslator",void 0),me(Ne(a),"getAdData",void 0),me(Ne(a),"getPlayheadTime",void 0),me(Ne(a),"getStateData",void 0),me(Ne(a),"stateDataTranslator",void 0),me(Ne(a),"hlsjs",void 0),me(Ne(a),"id",void 0),me(Ne(a),"longResumeTracker",void 0),me(Ne(a),"minimumRebufferDuration",void 0),me(Ne(a),"mux",void 0),me(Ne(a),"playbackEventDispatcher",void 0),me(Ne(a),"playbackHeartbeat",void 0),me(Ne(a),"playbackHeartbeatTime",void 0),me(Ne(a),"playheadTime",void 0),me(Ne(a),"seekingTracker",void 0),me(Ne(a),"sustainedRebufferThreshold",void 0),me(Ne(a),"watchTimeTracker",void 0),me(Ne(a),"currentFragmentPDT",void 0),me(Ne(a),"currentFragmentStart",void 0),a.pageLoadInitTime=Uu.navigationStart(),a.pageLoadEndTime=Uu.domContentLoadedEventEnd();var l={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(g){return g},emitTranslator:function(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];return x},stateDataTranslator:function(g){return g}};a.mux=r,a.id=s,i!=null&&i.beaconDomain&&a.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),i=Object.assign(l,i),i.data=i.data||{},i.data.property_key&&(i.data.env_key=i.data.property_key,delete i.data.property_key),tt.level=i.debug?gi.DEBUG:gi.WARN,a.getPlayheadTime=i.getPlayheadTime,a.getStateData=i.getStateData||function(){return{}},a.getAdData=i.getAdData||function(){},a.minimumRebufferDuration=i.minimumRebufferDuration,a.sustainedRebufferThreshold=i.sustainedRebufferThreshold,a.playbackHeartbeatTime=i.playbackHeartbeatTime,a.disableRebufferTracking=i.disableRebufferTracking,a.disableRebufferTracking&&a.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),a.disablePlayheadRebufferTracking=i.disablePlayheadRebufferTracking,a.errorTranslator=i.errorTranslator,a.emitTranslator=i.emitTranslator,a.stateDataTranslator=i.stateDataTranslator,a.playbackEventDispatcher=new T4(r,i.data.env_key,i),a.data={player_instance_id:ll(),mux_sample_rate:i.sampleRate,beacon_domain:i.beaconCollectionDomain||i.beaconDomain},a.data.view_sequence_number=1,a.data.player_sequence_number=1;var u=function(){typeof this.data.view_start>"u"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"),this.emit("renditionchange"))}.bind(Ne(a));if(a.on("viewinit",function(g,x){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,x),this._initializeViewData(),this.one("play",u),this.one("adbreakstart",u)}),a.on("videochange",function(g,x){this._resetView(x)}),a.on("programchange",function(g,x){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(x,{view_program_changed:!0})),u(),this.emit("play"),this.emit("playing")}),a.on("fragmentchange",function(g,x){this.currentFragmentPDT=x.currentFragmentPDT,this.currentFragmentStart=x.currentFragmentStart}),a.on("destroy",a.destroy),typeof window<"u"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var d=function(){var g=typeof a.data.view_start<"u";a.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",g&&a.mux.WINDOW_HIDDEN&&(a.data.player_is_paused||a.emit("hb"))};window.addEventListener("visibilitychange",d,!1);var f=function(g){g.persisted||a.destroy()};window.addEventListener("pagehide",f,!1),a.on("destroy",function(){window.removeEventListener("visibilitychange",d),window.removeEventListener("pagehide",f)})}a.on("playerready",function(g,x){Object.assign(this.data,x)}),M4.forEach(function(g){a.on(g,function(x,y){g.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,y),this._sanitizeData()}),a.on("after"+g,function(){(g!=="error"||this.errorTracker.viewErrored)&&this.send(g)})}),a.on("viewend",function(g,x){Object.assign(a.data,x)});var m=function(g){var x=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=x-this.data.player_init_time),this.pageLoadInitTime=this.data.page_load_init_time||this.pageLoadInitTime,this.pageLoadEndTime=this.data.page_load_end_time||this.pageLoadEndTime,!this.mux.PLAYER_TRACKED&&this.pageLoadInitTime&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.pageLoadEndTime)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.pageLoadEndTime||1/0)-this.pageLoadInitTime)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return a.one("playerready",m),a.longResumeTracker=new I4(Ne(a)),a.errorTracker=new DN(Ne(a)),new t4(Ne(a)),a.seekingTracker=new QN(Ne(a)),a.playheadTime=new BN(Ne(a)),a.playbackHeartbeat=new RN(Ne(a)),new WN(Ne(a)),a.watchTimeTracker=new jN(Ne(a)),new MN(Ne(a)),a.adTracker=new JN(Ne(a)),new GN(Ne(a)),new $N(Ne(a)),new KN(Ne(a)),new k4(Ne(a)),new D4(Ne(a)),new O4(Ne(a)),i.hlsjs&&a.addHLSJS(i),i.dashjs&&a.addDashJS(i),a.emit("viewinit",i.data),a}return jr(t,[{key:"emit",value:function(r,s){var i,a=Object.assign({viewer_time:this.mux.utils.now()},s),l=[r,a];if(this.emitTranslator)try{l=this.emitTranslator(r,a)}catch(u){this.mux.log.warn("Exception in emit translator callback.",u)}l!=null&&l.length&&(i=bu(Aa(t.prototype),"emit",this)).call.apply(i,[this].concat(ir(l)))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start<"u"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(r){if(this.data.view_id){var s=Object.assign({},this.data),i=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(s.video_source_is_live===void 0&&(s.player_source_duration===1/0||s.video_source_duration===1/0?s.video_source_is_live=!0:(s.player_source_duration>0||s.video_source_duration>0)&&(s.video_source_is_live=!1)),s.video_source_is_live||i.forEach(function(d){s[d]=void 0}),s.video_source_url=s.video_source_url||s.player_source_url,s.video_source_url){var a=ns(cl(s.video_source_url),2),l=a[0],u=a[1];s.video_source_domain=u,s.video_source_hostname=l}delete s.ad_request_id,this.playbackEventDispatcher.send(r,s),this.data.view_sequence_number++,this.data.player_sequence_number++,F4.has(r)||this._restartHeartBeat(),r==="viewend"&&delete this.data.view_id}}},{key:"_resetView",value:function(r){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",r)}},{key:"_updateStateData",value:function(){var r,s=this.getStateData();if(typeof this.stateDataTranslator=="function")try{s=this.stateDataTranslator(s)}catch(a){this.mux.log.warn("Exception in stateDataTranslator translator callback.",a)}if(!((r=this.data)===null||r===void 0)&&r.video_cdn&&s!=null&&s.video_cdn){s.video_cdn;var i=fN(s,["video_cdn"]);s=i}Object.assign(this.data,s),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var r=this,s=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];s.forEach(function(a){var l=parseInt(r.data[a],10);r.data[a]=isNaN(l)?void 0:l});var i=["player_source_url","video_source_url"];i.forEach(function(a){if(r.data[a]){var l=r.data[a].toLowerCase();(l.indexOf("data:")===0||l.indexOf("blob:")===0)&&(r.data[a]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var r=this;Object.keys(this.data).forEach(function(s){s.indexOf("video_")===0&&delete r.data[s]})}},{key:"_resetViewData",value:function(){var r=this;Object.keys(this.data).forEach(function(s){s.indexOf("view_")===0&&delete r.data[s]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var r=this,s=this.data.view_id=ll(),i=function(){s===r.data.view_id&&jt(r.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",i):i()}},{key:"_restartHeartBeat",value:function(){var r=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){r.data.player_is_paused||r.emit("hb")},1e4)}},{key:"addHLSJS",value:function(r){if(!r.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=r.hlsjs,bN(this.mux,this.id,r.hlsjs,{},r.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(SN(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(r){if(!r.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=r.dashjs,kN(this.mux,this.id,r.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(CN(this.dashjs),this.dashjs=void 0)}}]),t})(IN),U4=B4,No=Wn(QS());function $4(){return No.default&&!!(No.default.fullscreenElement||No.default.webkitFullscreenElement||No.default.mozFullScreenElement||No.default.msFullscreenElement)}var V4=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],G4={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function H4(n,e,t){var r=ns(Bu(e),3),s=r[0],i=r[1],a=r[2],l=n.log,u=n.utils.getComputedStyle,d=n.utils.secondsToMs,f={automaticErrorTracking:!0};if(s){if(a!=="video"&&a!=="audio")return l.error("The element of `"+i+"` was not a media element.")}else return l.error("No element was found with the `"+i+"` query selector.");s.mux&&(s.mux.destroy(),delete s.mux,l.warn("Already monitoring this video element, replacing existing event listeners"));var m={getPlayheadTime:function(){return d(s.currentTime)},getStateData:function(){var x,y,w,b=((x=(y=this).getPlayheadTime)===null||x===void 0?void 0:x.call(y))||d(s.currentTime),E=this.hlsjs&&this.hlsjs.url,T=this.dashjs&&typeof this.dashjs.getSource=="function"&&this.dashjs.getSource(),_={player_is_paused:s.paused,player_width:parseInt(u(s,"width")),player_height:parseInt(u(s,"height")),player_autoplay_on:s.autoplay,player_preload_on:s.preload,player_language_code:s.lang,player_is_fullscreen:$4(),video_poster_url:s.poster,video_source_url:E||T||s.currentSrc,video_source_duration:d(s.duration),video_source_height:s.videoHeight,video_source_width:s.videoWidth,view_dropped_frame_count:s==null||(w=s.getVideoPlaybackQuality)===null||w===void 0?void 0:w.call(s).droppedVideoFrames};if(s.getStartDate&&b>0){var A=s.getStartDate();if(A&&typeof A.getTime=="function"&&A.getTime()){var I=A.getTime();if(_.player_program_time=I+b,s.seekable.length>0){var N=I+s.seekable.end(s.seekable.length-1);_.player_live_edge_program_time=N}}}return _}};t=Object.assign(f,t,m),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:n.VERSION},t.data),s.mux=s.mux||{},s.mux.deleted=!1,s.mux.emit=function(x,y){n.emit(i,x,y)},s.mux.updateData=function(x){s.mux.emit("hb",x)};var g=function(){l.error("The monitor for this video element has already been destroyed.")};s.mux.destroy=function(){Object.keys(s.mux.listeners).forEach(function(x){s.removeEventListener(x,s.mux.listeners[x],!1)}),delete s.mux.listeners,s.mux.destroy=g,s.mux.swapElement=g,s.mux.emit=g,s.mux.addHLSJS=g,s.mux.addDashJS=g,s.mux.removeHLSJS=g,s.mux.removeDashJS=g,s.mux.updateData=g,s.mux.setEmitTranslator=g,s.mux.setStateDataTranslator=g,s.mux.setGetPlayheadTime=g,s.mux.deleted=!0,n.emit(i,"destroy")},s.mux.swapElement=function(x){var y=ns(Bu(x),3),w=y[0],b=y[1],E=y[2];if(w){if(E!=="video"&&E!=="audio")return n.log.error("The element of `"+b+"` was not a media element.")}else return n.log.error("No element was found with the `"+b+"` query selector.");w.muxId=s.muxId,delete s.muxId,w.mux=w.mux||{},w.mux.listeners=Object.assign({},s.mux.listeners),delete s.mux.listeners,Object.keys(w.mux.listeners).forEach(function(T){s.removeEventListener(T,w.mux.listeners[T],!1),w.addEventListener(T,w.mux.listeners[T],!1)}),w.mux.swapElement=s.mux.swapElement,w.mux.destroy=s.mux.destroy,delete s.mux,s=w},s.mux.addHLSJS=function(x){n.addHLSJS(i,x)},s.mux.addDashJS=function(x){n.addDashJS(i,x)},s.mux.removeHLSJS=function(){n.removeHLSJS(i)},s.mux.removeDashJS=function(){n.removeDashJS(i)},s.mux.setEmitTranslator=function(x){n.setEmitTranslator(i,x)},s.mux.setStateDataTranslator=function(x){n.setStateDataTranslator(i,x)},s.mux.setGetPlayheadTime=function(x){x||(x=t.getPlayheadTime),n.setGetPlayheadTime(i,x)},n.init(i,t),n.emit(i,"playerready"),s.paused||(n.emit(i,"play"),s.readyState>2&&n.emit(i,"playing")),s.mux.listeners={},V4.forEach(function(x){x==="error"&&!t.automaticErrorTracking||(s.mux.listeners[x]=function(){var y={};if(x==="error"){if(!s.error||s.error.code===1)return;y.player_error_code=s.error.code,y.player_error_message=G4[s.error.code]||s.error.message}n.emit(i,x,y)},s.addEventListener(x,s.mux.listeners[x],!1))})}function K4(n,e,t,r){var s=r;if(n&&typeof n[e]=="function")try{s=n[e].apply(n,t)}catch(i){tt.info("safeCall error",i)}return s}var zo=Wn(Nr()),ua;zo.default&&zo.default.WeakMap&&(ua=new WeakMap);function z4(n,e){if(!n||!e||!zo.default||typeof zo.default.getComputedStyle!="function")return"";var t;return ua&&ua.has(n)&&(t=ua.get(n)),t||(t=zo.default.getComputedStyle(n,null),ua&&ua.set(n,t)),t.getPropertyValue(e)}function W4(n){return Math.floor(n*1e3)}var di={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},fd=function(n){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(n),this.manifest};fd.prototype.process=function(n){var e;for(this.buffer+=n,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};fd.prototype.processLine=function(n){var e=n.indexOf(":"),t=X4(n,e),r=t[0],s=t.length===2?u0(t[1]):void 0;if(r[0]!=="#")this.currentUri.uri=r,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(r){case di.TARGET_DURATION:{if(!isFinite(s)||s<0)return;this.manifest.targetDuration=s,this.setHoldBack();break}case di.PART_INF:{Qh(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case di.SERVER_CONTROL:{Qh(this.manifest,t),this.setHoldBack();break}case di.INF:{s===0?this.currentUri.duration=.01:s>0&&(this.currentUri.duration=s);break}case di.PROGRAM_DATE_TIME:{var i=s,a=new Date(i);this.manifest.dateTimeString||(this.manifest.dateTimeString=i,this.manifest.dateTimeObject=a),this.currentUri.dateTimeString=i,this.currentUri.dateTimeObject=a;break}case di.VERSION:{Qh(this.manifest,t);break}case di.SESSION_DATA:{var l=Z4(t[1]),u=eE(l);Object.assign(this.manifest.sessionData,u)}}};fd.prototype.setHoldBack=function(){var n=this.manifest,e=n.serverControl,t=n.targetDuration,r=n.partTargetDuration;if(e){var s="holdBack",i="partHoldBack",a=t&&t*3,l=r&&r*2;t&&!e.hasOwnProperty(s)&&(e[s]=a),a&&e[s]<a&&(e[s]=a),r&&!e.hasOwnProperty(i)&&(e[i]=r*3),r&&e[i]<l&&(e[i]=l)}};var Qh=function(n,e){var t=cE(e[0].replace("#EXT-X-","")),r;Q4(e[1])?(r={},r=Object.assign(Y4(e[1]),r)):r=u0(e[1]),n[t]=r},cE=function(n){return n.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},u0=function(n){if(n.toLowerCase()==="yes"||n.toLowerCase()==="no")return n.toLowerCase()==="yes";var e=n.indexOf(":")!==-1?n:parseFloat(n);return isNaN(e)?n:e},q4=function(n){var e={},t=n.split("=");if(t.length>1){var r=cE(t[0]);e[r]=u0(t[1])}return e},Y4=function(n){for(var e=n.split(","),t={},r=0;e.length>r;r++){var s=e[r],i=q4(s);t=Object.assign(i,t)}return t},Q4=function(n){return n.indexOf("=")>-1},X4=function(n,e){return e===-1?[n]:[n.substring(0,e),n.substring(e+1)]},Z4=function(n){var e={};if(n){var t=n.search(","),r=n.slice(0,t),s=n.slice(t+1),i=[r,s];return i.forEach(function(a,l){for(var u=a.replace(/['"]+/g,"").split("="),d=0;d<u.length;d++)u[d]==="DATA-ID"&&(e["DATA-ID"]=u[1-d]),u[d]==="VALUE"&&(e.VALUE=u[1-d])}),{data:e}}},J4=fd,e8={safeCall:K4,safeIncrement:jt,getComputedStyle:z4,secondsToMs:W4,assign:Object.assign,headersStringToObject:c0,cdnHeadersToRequestId:Vu,extractHostnameAndDomain:cl,extractHostname:lr,manifestParser:J4,generateShortID:ZS,generateUUID:ll,now:$t.now,findMediaElement:Bu},t8=e8,n8={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",PLAYBACK_MODE_CHANGE:"playbackmodechange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},r8=n8,s8="mux-embed",i8="5.14.0",a8="2.1",At={},Us=function(n){var e=arguments;typeof n=="string"?Us.hasOwnProperty(n)?Ko.default.setTimeout(function(){e=Array.prototype.splice.call(e,1),Us[n].apply(null,e)},0):tt.warn("`"+n+"` is an unknown task"):typeof n=="function"?Ko.default.setTimeout(function(){n(Us)},0):tt.warn("`"+n+"` is invalid.")},o8={loaded:$t.now(),NAME:s8,VERSION:i8,API_VERSION:a8,PLAYER_TRACKED:!1,monitor:function(n,e){return H4(Us,n,e)},destroyMonitor:function(n){var e=ns(Bu(n),1),t=e[0];t&&t.mux&&typeof t.mux.destroy=="function"?t.mux.destroy():tt.error("A video element monitor for `"+n+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(n,e){var t=sr(n);At[t]?At[t].addHLSJS(e):tt.error("A monitor for `"+t+"` has not been initialized.")},addDashJS:function(n,e){var t=sr(n);At[t]?At[t].addDashJS(e):tt.error("A monitor for `"+t+"` has not been initialized.")},removeHLSJS:function(n){var e=sr(n);At[e]?At[e].removeHLSJS():tt.error("A monitor for `"+e+"` has not been initialized.")},removeDashJS:function(n){var e=sr(n);At[e]?At[e].removeDashJS():tt.error("A monitor for `"+e+"` has not been initialized.")},init:function(n,e){Zm()&&e&&e.respectDoNotTrack&&tt.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var t=sr(n);At[t]=new U4(Us,t,e)},emit:function(n,e,t){var r=sr(n);At[r]?(At[r].emit(e,t),e==="destroy"&&delete At[r]):tt.error("A monitor for `"+r+"` has not been initialized.")},updateData:function(n,e){var t=sr(n);At[t]?At[t].emit("hb",e):tt.error("A monitor for `"+t+"` has not been initialized.")},setEmitTranslator:function(n,e){var t=sr(n);At[t]?At[t].emitTranslator=e:tt.error("A monitor for `"+t+"` has not been initialized.")},setStateDataTranslator:function(n,e){var t=sr(n);At[t]?At[t].stateDataTranslator=e:tt.error("A monitor for `"+t+"` has not been initialized.")},setGetPlayheadTime:function(n,e){var t=sr(n);At[t]?At[t].getPlayheadTime=e:tt.error("A monitor for `"+t+"` has not been initialized.")},checkDoNotTrack:Zm,log:tt,utils:t8,events:r8,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(Us,o8);typeof Ko.default<"u"&&typeof Ko.default.addEventListener=="function"&&Ko.default.addEventListener("pagehide",function(n){n.persisted||(Us.WINDOW_UNLOADING=!0)},!1);var l8=Us;/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/function Os({src:n,poster:e,muxEnvKey:t,playerName:r="Portfolio Video Player",muxMetadata:s={},className:i="",autoPlay:a=!1,muted:l=!1,loop:u=!1,controls:d=!0,onLoaded:f}){const m=L.useRef(null),g=L.useRef(null),x=L.useRef(Date.now()),y=L.useRef(!1),w=L.useRef(f),b=L.useRef(t),E=L.useRef(r),T=L.useRef(s),_=L.useRef(a),A=L.useRef(l);return w.current=f,b.current=t,E.current=r,T.current=s,_.current=a,A.current=l,L.useEffect(()=>{const I=m.current;if(!I)return;A.current&&(I.muted=!0);const N=()=>{w.current&&!y.current&&(y.current=!0,w.current())};I.addEventListener("canplaythrough",N);const P=n.includes(".m3u8"),O=M=>{if(!b.current){console.warn("Mux env_key not provided. Video monitoring is disabled.");return}const D={data:{env_key:b.current,player_name:E.current,player_init_time:x.current,...T.current}};M&&(D.hlsjs=M,D.Hls=wn),l8.monitor(I,D)};if(P)if(wn.isSupported()){const M=new wn({enableWorker:!0,lowLatencyMode:!1,startLevel:-1});g.current=M,M.loadSource(n),M.attachMedia(I),M.on(wn.Events.MANIFEST_PARSED,(D,B)=>{console.log("Available quality levels:",B.levels.map(ie=>`${ie.height}p`));const q=B.levels.length-1;M.currentLevel=q,M.loadLevel=q,console.log(`Locked to level ${q}: ${B.levels[q]?.height}p`),O(M),_.current&&(A.current&&(I.muted=!0),I.play().catch(ie=>{console.log("Autoplay prevented by browser:",ie)}))}),M.on(wn.Events.ERROR,(D,B)=>{if(B.fatal)switch(B.type){case wn.ErrorTypes.NETWORK_ERROR:console.error("Network error, attempting to recover..."),M.startLoad();break;case wn.ErrorTypes.MEDIA_ERROR:console.error("Media error, attempting to recover..."),M.recoverMediaError();break;default:console.error("Fatal error, destroying HLS instance"),M.destroy();break}})}else I.canPlayType("application/vnd.apple.mpegurl")?(I.src=n,O()):console.error("HLS is not supported in this browser");else I.src=n,O();return()=>{I.removeEventListener("canplaythrough",N),g.current&&(g.current.destroy(),g.current=null)}},[n]),h.jsx("video",{ref:m,className:i,poster:e,autoPlay:a,muted:l,loop:u,controls:d,playsInline:!0})}const Ia="/assets/logo-CcKS_K74.png",A1="data:image/svg+xml,%3Csvg%20preserveAspectRatio%3D%22none%22%20width%3D%22100%25%22%20height%3D%22100%25%22%20overflow%3D%22visible%22%20style%3D%22display%3A%20block%3B%22%20viewBox%3D%220%200%2019%2019%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20id%3D%22SVGG1Ot4cAD%22%3E%0A%3Cpath%20id%3D%22Vector%22%20d%3D%22M0%200H19V19H0V0Z%22%20fill%3D%22var(--fill-0%2C%20black)%22%2F%3E%0A%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A";function Be({children:n,className:e,variant:t="slide",fast:r=!1,delay:s=0,threshold:i=.15,rootMargin:a="0px 0px -40px 0px",as:l="div",disabled:u=!1}){const d=L.useRef(null),f=r?"fast":t,m=L.useRef(null);if(L.useEffect(()=>{if(u)return;const x=d.current;if(!x)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){x.classList.add("revealed");return}const w=()=>{const T=x.getBoundingClientRect(),_=window.innerHeight||document.documentElement.clientHeight;return T.top<_+40&&T.bottom>-40};m.current===null&&(m.current=w(),m.current&&s>0&&(x.style.transitionDelay="0ms"));const b=()=>w()?(requestAnimationFrame(()=>{x.classList.add("revealed")}),!0):!1,E=new IntersectionObserver(T=>{T.forEach(_=>{_.isIntersecting&&(requestAnimationFrame(()=>{x.classList.add("revealed")}),E.unobserve(x))})},{threshold:0,rootMargin:"40px"});return E.observe(x),requestAnimationFrame(()=>{b()}),()=>{E.disconnect()}},[i,a,u,s]),u)return h.jsx(h.Fragment,{children:n});const g={slide:"scroll-reveal",fast:"scroll-reveal-fast",fade:"scroll-reveal-fade"}[f];return Er.createElement(l,{ref:d,className:J(g,e),style:s>0?{transitionDelay:`${s}ms`}:void 0},n)}function Gs({className:n=""}){return h.jsx("svg",{width:"0.6em",height:"0.6em",viewBox:"0 0 9 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`inline-block align-baseline ${n}`,style:{verticalAlign:"0.05em"},children:h.jsx("path",{d:"M0.928172 8.30395L0.0001719 7.35995L7.04017 0.319951L7.98417 1.26395L0.928172 8.30395ZM1.96817 1.35995V-4.95911e-05H8.30417L7.80817 1.34395L1.96817 1.35995ZM6.94417 6.33595L6.96017 0.479951L8.30417 -4.95911e-05V6.33595H6.94417Z",fill:"currentColor"})})}function c8(){const[n,e]=L.useState(null);return L.useEffect(()=>{(async()=>{try{const r=await fetch("https://api.github.com/repos/michelletliu/michelle-liu/commits?per_page=1");if(!r.ok)throw new Error("Failed to fetch");const s=await r.json();if(s&&s.length>0){const i=new Date(s[0].commit.committer.date),a=String(i.getMonth()+1).padStart(2,"0"),l=String(i.getDate()).padStart(2,"0"),u=String(i.getFullYear()).slice(-2);e(`${a}-${l}-${u}`)}}catch(r){console.error("Failed to fetch latest commit date:",r)}})()},[]),n}function u8({text:n,className:e}){const t=L.useRef(null),r=L.useRef(!1),s=L.useRef(n),i=L.useRef(!1),a="!@#$%^&*()_+-;:,.<>?ADELPSTUadelpstu0123456789";L.useEffect(()=>{s.current=n},[n]);const l=()=>{const d=t.current,f=s.current;if(!d||r.current)return;r.current=!0;const m=f.length,g=[];for(let w=0;w<m;w++){const b=f[w]||"",E=Math.floor(Math.random()*40),T=E+Math.floor(Math.random()*40);g.push({to:b,start:E,end:T})}let x=0;const y=()=>{let w="",b=0;for(let E=0;E<g.length;E++){const{to:T,start:_,end:A}=g[E];x>=A?(b++,w+=T):x>=_?((!g[E].char||Math.random()<.28)&&(g[E].char=a[Math.floor(Math.random()*a.length)]),w+=`<span style="color: #c4c4c4">${g[E].char}</span>`):w+=T}d.innerHTML=w,b===g.length?r.current=!1:(requestAnimationFrame(y),x++)};y()},u=()=>{l()};return L.useEffect(()=>{const d=t.current;if(!d)return;const f=new IntersectionObserver(m=>{m.forEach(g=>{g.isIntersecting&&!i.current&&(i.current=!0,setTimeout(()=>{l()},100))})},{threshold:.1});return f.observe(d),()=>f.disconnect()},[]),h.jsx("p",{ref:t,className:`${e} cursor-pointer`,onMouseEnter:u,children:n})}function ru({children:n}){return h.jsx("div",{className:"relative shrink-0 size-6",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 24 24",children:h.jsx("g",{id:"Social Links",children:n})})})}function la({text:n,href:e}){const t=h.jsx("p",{className:`font-['Figtree',sans-serif] leading-5 relative shrink-0 text-[#9ca3af] text-base text-nowrap tracking-[0.16px] ${e?"hover:text-blue-500 transition-colors duration-200":""}`,children:n});return e?h.jsx("a",{href:e,className:"content-stretch flex items-center justify-center px-0.5 py-0 relative rounded-full shrink-0",children:t}):h.jsx("div",{className:"content-stretch flex items-center justify-center px-0.5 py-0 relative rounded-full shrink-0",children:t})}function hd(){const n=c8(),e=n?`CHANGELOG: ${n}`:"CHANGELOG: ...";return h.jsx("div",{className:"relative shrink-0 w-full",children:h.jsx("div",{className:"flex flex-col items-center size-full",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-16 items-center px-16 max-md:px-8 pt-8 pb-8 max-md:pb-16 max-md:pt-4 relative w-full",children:[h.jsxs(Be,{className:"content-stretch flex flex-col gap-5 items-start relative shrink-0 w-full",children:[h.jsx("div",{className:"bg-gray-200 h-px shrink-0 w-full"}),h.jsxs("div",{className:"hidden md:grid gap-5 grid-cols-[repeat(4,_minmax(0px,_1fr))] grid-rows-[repeat(1,_fit-content(100%))] relative shrink-0 w-full",children:[h.jsx("div",{className:"[grid-area:1_/_1] content-stretch flex flex-col items-start relative shrink-0",children:h.jsxs("a",{href:"/",className:"content-stretch flex gap-3 items-center justify-center relative shrink-0 hover:opacity-80 transition-opacity",children:[h.jsx("div",{className:"relative shrink-0 size-7",children:h.jsx("img",{alt:"Michelle Liu Logo",className:"object-contain size-full",src:Ia})}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-[#374151] text-[32px] w-[212px]",children:"michelle liu"})]})}),h.jsxs("div",{className:"[grid-area:1_/_3] content-stretch flex flex-col gap-2 items-start relative shrink-0",children:[h.jsx(la,{text:"Work",href:"/"}),h.jsx(la,{text:"Art",href:"/art"}),h.jsx(la,{text:"About",href:"/about"})]}),h.jsxs("div",{className:"[grid-area:1_/_4] content-stretch flex flex-col gap-4 items-start relative shrink-0",children:[h.jsxs("div",{className:"content-stretch flex flex-col font-['Figtree',sans-serif] font-normal items-start relative shrink-0 text-gray-400 w-full",children:[h.jsx("p",{className:"leading-6 min-w-full relative shrink-0 text-base w-[min-content]",children:"Let's work together!"}),h.jsx("p",{className:"leading-6 relative shrink-0 text-base break-all",children:h.jsxs("a",{href:"mailto:michelletheresaliu@gmail.com",className:"hover:text-blue-500 text-gray-500 transition-colors duration-200",children:[h.jsx("span",{children:"michelletheresaliu@gmail.com "}),h.jsx("span",{className:"font-['Figtree',sans-serif] font-bold",children:h.jsx(Gs,{})})]})})]}),h.jsx("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0",children:h.jsxs("div",{className:"content-stretch flex gap-6 items-start relative shrink-0",children:[h.jsx("a",{href:"https://www.instagram.com/https.croissant/?hl=en",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:h.jsx(ru,{children:h.jsx("path",{d:hi.p2c5f2300,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})}),h.jsx("a",{href:"https://x.com/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:h.jsx("div",{className:"content-stretch flex items-center justify-center relative shrink-0 size-6",children:h.jsx("div",{className:"grid-cols-[max-content] grid-rows-[max-content] inline-grid leading-[0] place-items-start relative shrink-0",children:h.jsx("div",{className:"[grid-area:1_/_1] h-[17.219px] mask-alpha mask-intersect mask-no-clip mask-no-repeat mask-position-[0px_-0.89px] mask-size-[19px_19px] ml-0 mt-[4.69%] relative w-[19px]",style:{maskImage:`url('${A1}')`},children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 19 18",children:h.jsx("g",{id:"Group",children:h.jsx("path",{d:hi.p16308a80,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})})})})})}),h.jsx("a",{href:"https://www.linkedin.com/in/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link social-link-linkedin",children:h.jsx("div",{className:"content-stretch flex items-center justify-center relative shrink-0 size-6",children:h.jsx(ru,{children:h.jsx("path",{d:hi.p1e086000,fill:"var(--fill-0, #c4c9d0)",id:"Vector",stroke:"var(--stroke-0, #c4c9d0)"})})})})]})})]})]}),h.jsxs("div",{className:"md:hidden content-stretch flex flex-col gap-10 items-start relative shrink-0 w-full",children:[h.jsx("div",{className:"content-stretch flex flex-col gap-1.5 items-start relative shrink-0",children:h.jsxs("a",{href:"/",className:"content-stretch flex gap-2 items-center justify-center relative shrink-0 hover:opacity-80 transition-opacity",children:[h.jsx("div",{className:"relative shrink-0 size-7",children:h.jsx("img",{alt:"Michelle Liu Logo",className:"object-contain size-full",src:Ia})}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-[#374151] text-[32px] w-[212px]",children:"michelle liu"})]})}),h.jsxs("div",{className:"content-stretch flex flex-col gap-10 items-start relative shrink-0",children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0",children:[h.jsxs("div",{className:"content-stretch flex flex-col font-['Figtree',sans-serif] font-normal items-start relative shrink-0 text-gray-400 w-[326px]",children:[h.jsx("p",{className:"leading-6 relative shrink-0 text-base w-full",children:"Let's work together!"}),h.jsx("p",{className:"leading-6 relative shrink-0 text-base w-full break-all",children:h.jsxs("a",{href:"mailto:michelletheresaliu@gmail.com",className:"hover:text-blue-500 text-gray-500 transition-colors duration-200",children:[h.jsx("span",{children:"michelletheresaliu@gmail.com "}),h.jsx("span",{className:"font-['Figtree',sans-serif] font-bold",children:h.jsx(Gs,{})})]})})]}),h.jsx("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0 w-[326px]",children:h.jsxs("div",{className:"content-stretch flex gap-11 items-start relative shrink-0",children:[h.jsx("a",{href:"https://www.instagram.com/https.croissant/?hl=en",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:h.jsx(ru,{children:h.jsx("path",{d:hi.p2c5f2300,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})}),h.jsx("a",{href:"https://x.com/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link",children:h.jsx("div",{className:"content-stretch flex items-center justify-center p-2.5 relative shrink-0 size-6",children:h.jsx("div",{className:"grid-cols-[max-content] grid-rows-[max-content] inline-grid leading-[0] place-items-start relative shrink-0",children:h.jsx("div",{className:"[grid-area:1_/_1] h-[17.219px] mask-alpha mask-intersect mask-no-clip mask-no-repeat mask-position-[0px_-0.89px] mask-size-[19px_19px] ml-0 mt-[4.69%] relative w-[19px]",style:{maskImage:`url('${A1}')`},children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 19 18",children:h.jsx("g",{id:"Group",children:h.jsx("path",{d:hi.p16308a80,fill:"var(--fill-0, #c4c9d0)",id:"Vector"})})})})})})}),h.jsx("a",{href:"https://www.linkedin.com/in/michelletliu",target:"_blank",rel:"noopener noreferrer",className:"social-link social-link-linkedin",children:h.jsx("div",{className:"content-stretch flex items-center justify-center p-2.5 relative shrink-0 size-6",children:h.jsx(ru,{children:h.jsx("path",{d:hi.p1e086000,fill:"var(--fill-0, #c4c9d0)",id:"Vector",stroke:"var(--stroke-0, #c4c9d0)"})})})})]})})]}),h.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start relative shrink-0 w-[338px]",children:[h.jsx(la,{text:"WORK",href:"/"}),h.jsx(la,{text:"ART",href:"/art"}),h.jsx(la,{text:"ABOUT",href:"/about"})]})]})]})]}),h.jsxs(Be,{variant:"fade",delay:200,className:"content-stretch flex flex-col gap-0.5 items-center relative shrink-0",children:[h.jsxs("p",{className:"font-['Figtree',sans-serif] font-normal leading-7 relative shrink-0 text-gray-500 text-sm",children:[h.jsx("span",{children:"Built with Next.js & "}),h.jsxs("span",{className:"group",children:[h.jsx("a",{className:"[text-underline-position:from-font] cursor-pointer decoration-solid underline group-hover:!text-emerald-600 transition-colors",href:"https://www.rockysmatcha.com/blogs/matcha-guide/how-to-make-matcha-guide",target:"_blank",rel:"noopener noreferrer",children:"rocky's matcha"}),h.jsx("span",{children:" lattes."}),h.jsx("span",{className:"text-gray-400",children:" "})]})]}),h.jsx(u8,{text:e,className:"font-['Figtree',sans-serif] font-normal leading-5 tracking-wider relative shrink-0 text-[#9ca3af] text-xs text-nowrap"})]})]})})})}const d8="data:image/svg+xml,%3csvg%20width='19'%20height='28'%20viewBox='0%200%2019%2028'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.13274%2027.3175C2.1117%2027.3175%201.33199%2027.039%200.793626%2026.4821C0.264542%2025.9251%200%2025.099%200%2024.0037V14.4106C0%2013.3153%200.264542%2012.4938%200.793626%2011.9462C1.33199%2011.3892%202.1117%2011.1108%203.13274%2011.1108H15.8725C16.8936%2011.1108%2017.6686%2011.3892%2018.1977%2011.9462C18.7361%2012.4938%2019.0053%2013.3153%2019.0053%2014.4106V24.0037C19.0053%2025.099%2018.7361%2025.9251%2018.1977%2026.4821C17.6686%2027.039%2016.8936%2027.3175%2015.8725%2027.3175H3.13274ZM2.43657%2012.1829V7.78311C2.43657%206.03806%202.77073%204.59004%203.43905%203.43905C4.11665%202.28806%204.99381%201.42946%206.07054%200.863242C7.14728%200.287747%208.28899%200%209.49567%200C10.7116%200%2011.858%200.287747%2012.9347%200.863242C14.0114%201.42946%2014.884%202.28806%2015.5523%203.43905C16.2299%204.59004%2016.5687%206.03806%2016.5687%207.78311V12.1829H14.3688V7.47679C14.3688%206.30724%2014.1414%205.32333%2013.6866%204.52506C13.241%203.72679%2012.647%203.12345%2011.9044%202.71504C11.1711%202.30662%2010.3682%202.10241%209.49567%202.10241C8.63243%202.10241%207.82952%202.30662%207.08694%202.71504C6.35365%203.12345%205.76423%203.72679%205.31869%204.52506C4.87314%205.32333%204.65037%206.30724%204.65037%207.47679V12.1829H2.43657Z'%20fill='%236B7280'/%3e%3c/svg%3e",f8="/assets/quote%20gray%20200-CtrnUyGq.png";function h8({onClick:n,className:e}){return h.jsx("div",{className:J("content-stretch flex flex-col items-center relative shrink-0 w-full",e),children:h.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),n?.()},className:"bg-[#f9fafb] border border-[#e5e7eb] border-solid content-stretch flex items-center justify-center px-5 py-2.5 relative rounded-full shrink-0 hover:bg-[#f3f4f6] transition-colors cursor-pointer z-10",children:h.jsx("span",{className:"font-medium leading-normal relative shrink-0 text-gray-700 hover:text-gray-800 text-base",children:"View all projects"})})})}function m8({project:n,className:e,onClick:t}){return h.jsxs("button",{type:"button",onClick:r=>{r.stopPropagation(),r.preventDefault(),t?.()},className:J("flex flex-col gap-3 items-start cursor-pointer group text-left w-full",e),children:[h.jsx("div",{className:"w-full overflow-hidden rounded-[26px] transition-transform duration-300 group-hover:scale-[0.99]",children:h.jsx("div",{className:"aspect-[678/367.625] w-full relative",children:h.jsx("img",{className:"absolute inset-0 object-cover rounded-[26px] w-full h-full",alt:"",src:n.imageSrc})})}),h.jsxs("div",{className:"flex flex-col font-medium items-start px-[13px] !text-lg w-full",children:[h.jsxs("p",{className:"text-[#111827] w-full",children:[h.jsxs("span",{children:[n.title," "]}),h.jsxs("span",{className:"text-gray-400 font-normal",children:[" ",n.year]})]}),h.jsx("p",{className:"text-[#9ca3af] w-full leading-[1.3em] font-normal text-base project-card-text opacity-0 translate-y-1 transition-all duration-300 ease-out group-hover:opacity-100 group-hover:translate-y-0 max-md:opacity-100 max-md:translate-y-0",children:n.description})]})]})}function p8({device:n="Default",projects:e,onViewAll:t,onProjectClick:r}){const s=e.slice(0,2);return h.jsxs("div",{className:"flex flex-col items-start justify-center py-10 sm:py-16 px-8 md:px-[8%] xl:px-[175px] w-full max-w-[1440px] mx-auto",children:[h.jsxs("div",{className:J("flex flex-col gap-8 sm:gap-10 items-start w-full",t&&"mb-10 sm:mb-16"),children:[h.jsx("p",{className:"font-normal leading-7 text-[#6b7280] text-lg sm:text-xl",children:"Also check out..."}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-6 w-full",children:s.map(i=>h.jsx(m8,{project:i,onClick:()=>r?.(i),className:"w-full"},i.id))})]}),t&&h.jsx(h8,{onClick:t})]})}function Gu(n){return n._type==="span"&&"text"in n&&typeof n.text=="string"&&(n.marks===void 0||Array.isArray(n.marks)&&n.marks.every(e=>typeof e=="string"))}function uE(n){return typeof n._type=="string"&&n._type[0]!=="@"&&(!("markDefs"in n)||!n.markDefs||Array.isArray(n.markDefs)&&n.markDefs.every(e=>typeof e._key=="string"))&&"children"in n&&Array.isArray(n.children)&&n.children.every(e=>typeof e=="object"&&"_type"in e)}function dE(n){return uE(n)&&"listItem"in n&&typeof n.listItem=="string"&&(n.level===void 0||typeof n.level=="number")}function fE(n){return n._type==="@list"}function hE(n){return n._type==="@span"}function mE(n){return n._type==="@text"}const I1=["strong","em","code","underline","strike-through"];function g8(n,e,t){if(!Gu(n)||!n.marks||!n.marks.length)return[];let r=n.marks.slice(),s={};return r.forEach(i=>{s[i]=1;for(let a=e+1;a<t.length;a++){let l=t[a];if(l&&Gu(l)&&Array.isArray(l.marks)&&l.marks.indexOf(i)!==-1)s[i]++;else break}}),r.sort((i,a)=>x8(s,i,a))}function x8(n,e,t){let r=n[e],s=n[t];if(r!==s)return s-r;let i=I1.indexOf(e),a=I1.indexOf(t);return i===a?e.localeCompare(t):i-a}function y8(n){let{children:e}=n,t=n.markDefs??[];if(!e||!e.length)return[];let r=e.map(g8),s={_type:"@span",children:[],markType:"<unknown>"},i=[s];for(let a=0;a<e.length;a++){let l=e[a];if(!l)continue;let u=r[a]||[],d=1;if(i.length>1)for(;d<i.length;d++){let m=i[d]?.markKey||"",g=u.indexOf(m);if(g===-1)break;u.splice(g,1)}i=i.slice(0,d);let f=i[i.length-1];if(f){for(let m of u){let g=t?.find(y=>y._key===m),x={_type:"@span",_key:l._key,children:[],markDef:g,markType:g?g._type:m,markKey:m};f.children.push(x),i.push(x),f=x}if(Gu(l)){let m=l.text.split(`
`);for(let g=m.length;g-- >1;)m.splice(g,0,`
`);f.children=f.children.concat(m.map(g=>({_type:"@text",text:g})))}else f.children=f.children.concat(l)}}return s.children}function v8(n,e){let t=[],r;for(let s=0;s<n.length;s++){let i=n[s];if(i){if(!dE(i)){t.push(i),r=void 0;continue}if(!r){r=su(i,s,e),t.push(r);continue}if(w8(i,r)){r.children.push(i);continue}if((i.level||1)>r.level){let a=su(i,s,e);if(e==="html"){let l=r.children[r.children.length-1],u={...l,children:[...l.children,a]};r.children[r.children.length-1]=u}else r.children.push(a);r=a;continue}if((i.level||1)<r.level){let a=t[t.length-1],l=a&&tp(a,i);if(l){r=l,r.children.push(i);continue}r=su(i,s,e),t.push(r);continue}if(i.listItem!==r.listItem){let a=t[t.length-1],l=a&&tp(a,{level:i.level||1});if(l&&l.listItem===i.listItem){r=l,r.children.push(i);continue}else{r=su(i,s,e),t.push(r);continue}}console.warn("Unknown state encountered for block",i),t.push(i)}}return t}function w8(n,e){return(n.level||1)===e.level&&n.listItem===e.listItem}function su(n,e,t){return{_type:"@list",_key:`${n._key||`${e}`}-parent`,mode:t,level:n.level||1,listItem:n.listItem,children:[n]}}function tp(n,e){let t=e.level||1,r=e.listItem||"normal",s=typeof e.listItem=="string";if(fE(n)&&(n.level||1)===t&&s&&(n.listItem||"normal")===r)return n;if(!("children"in n))return;let i=n.children[n.children.length-1];return i&&!Gu(i)?tp(i,e):void 0}function pE(n){let e="";return n.children.forEach(t=>{mE(t)?e+=t.text:hE(t)&&(e+=pE(t))}),e}const b8="html",S8={number:({children:n})=>h.jsx("ol",{children:n}),bullet:({children:n})=>h.jsx("ul",{children:n})},E8=({children:n})=>h.jsx("li",{children:n}),T8=({children:n,value:e})=>h.jsx("a",{href:e?.href,children:n}),_8={textDecoration:"underline"},k8={em:({children:n})=>h.jsx("em",{children:n}),strong:({children:n})=>h.jsx("strong",{children:n}),code:({children:n})=>h.jsx("code",{children:n}),underline:({children:n})=>h.jsx("span",{style:_8,children:n}),"strike-through":({children:n})=>h.jsx("del",{children:n}),link:T8},bl=(n,e)=>`[@portabletext/react] Unknown ${n}, specify a component for it in the \`components.${e}\` prop`,gE=n=>bl(`block type "${n}"`,"types"),C8=n=>bl(`mark type "${n}"`,"marks"),A8=n=>bl(`block style "${n}"`,"block"),I8=n=>bl(`list style "${n}"`,"list"),L8=n=>bl(`list item style "${n}"`,"listItem");function R8(n){console.warn(n)}const P8={display:"none"},L1={types:{},block:{normal:({children:n})=>h.jsx("p",{children:n}),blockquote:({children:n})=>h.jsx("blockquote",{children:n}),h1:({children:n})=>h.jsx("h1",{children:n}),h2:({children:n})=>h.jsx("h2",{children:n}),h3:({children:n})=>h.jsx("h3",{children:n}),h4:({children:n})=>h.jsx("h4",{children:n}),h5:({children:n})=>h.jsx("h5",{children:n}),h6:({children:n})=>h.jsx("h6",{children:n})},marks:k8,list:S8,listItem:E8,hardBreak:()=>h.jsx("br",{}),unknownType:({value:n,isInline:e})=>{let t=gE(n._type);return h.jsx(e?"span":"div",{style:P8,children:t})},unknownMark:({markType:n,children:e})=>h.jsx("span",{className:`unknown__pt__mark__${n}`,children:e}),unknownList:({children:n})=>h.jsx("ul",{children:n}),unknownListItem:({children:n})=>h.jsx("li",{children:n}),unknownBlockStyle:({children:n})=>h.jsx("p",{children:n})};function D8(n,e){let{block:t,list:r,listItem:s,marks:i,types:a,...l}=e;return{...n,block:jo(n,e,"block"),list:jo(n,e,"list"),listItem:jo(n,e,"listItem"),marks:jo(n,e,"marks"),types:jo(n,e,"types"),...l}}function jo(n,e,t){let r=e[t],s=n[t];return typeof r=="function"||r&&typeof s=="function"?r:r?{...s,...r}:s}function vn({value:n,components:e,listNestingMode:t,onMissingComponent:r=R8}){let s=r||j8,i=v8(Array.isArray(n)?n:[n],t||b8),a=L.useMemo(()=>e?D8(L1,e):L1,[e]),l=L.useMemo(()=>N8(a,s),[a,s]);return h.jsx(h.Fragment,{children:i.map((u,d)=>l({node:u,index:d,isInline:!1,renderNode:l}))})}const N8=(n,e)=>{function t(m){let{node:g,index:x,isInline:y}=m,w=g._key||`node-${x}`;return fE(g)?i(g,x,w):dE(g)?s(g,x,w):hE(g)?a(g,x,w):r(g)?f(g,x,w,y):uE(g)?l(g,x,w,y):mE(g)?u(g,w):d(g,x,w,y)}function r(m){return m._type in n.types}function s(m,g,x){let y=R1({node:m,index:g,isInline:!1,renderNode:t}),w=n.listItem,b=(typeof w=="function"?w:w[m.listItem])||n.unknownListItem;if(b===n.unknownListItem){let T=m.listItem||"bullet";e(L8(T),{type:T,nodeType:"listItemStyle"})}let E=y.children;if(m.style&&m.style!=="normal"){let{listItem:T,..._}=m;E=t({node:_,index:g,isInline:!1})}return h.jsx(b,{value:m,index:g,isInline:!1,renderNode:t,children:E},x)}function i(m,g,x){let y=m.children.map((E,T)=>t({node:E._key?E:{...E,_key:`li-${g}-${T}`},index:T,isInline:!1})),w=n.list,b=(typeof w=="function"?w:w[m.listItem])||n.unknownList;if(b===n.unknownList){let E=m.listItem||"bullet";e(I8(E),{nodeType:"listStyle",type:E})}return h.jsx(b,{value:m,index:g,isInline:!1,renderNode:t,children:y},x)}function a(m,g,x){let{markDef:y,markType:w,markKey:b}=m,E=n.marks[w]||n.unknownMark,T=m.children.map((_,A)=>t({node:_,index:A,isInline:!0}));return E===n.unknownMark&&e(C8(w),{nodeType:"mark",type:w}),h.jsx(E,{text:pE(m),value:y,markType:w,markKey:b,renderNode:t,children:T},x)}function l(m,g,x,y){let{_key:w,...b}=R1({node:m,index:g,isInline:y,renderNode:t}),E=b.node.style||"normal",T=(typeof n.block=="function"?n.block:n.block[E])||n.unknownBlockStyle;return T===n.unknownBlockStyle&&e(A8(E),{nodeType:"blockStyle",type:E}),h.jsx(T,{...b,value:b.node,renderNode:t},x)}function u(m,g){if(m.text===`
`){let x=n.hardBreak;return x?h.jsx(x,{},g):`
`}return m.text}function d(m,g,x,y){let w={value:m,isInline:y,index:g,renderNode:t};e(gE(m._type),{nodeType:"block",type:m._type});let b=n.unknownType;return h.jsx(b,{...w},x)}function f(m,g,x,y){let w={value:m,isInline:y,index:g,renderNode:t},b=n.types[m._type];return b?h.jsx(b,{...w},x):null}return t};function R1(n){let{node:e,index:t,isInline:r,renderNode:s}=n,i=y8(e).map((a,l)=>s({node:a,isInline:!0,index:l,renderNode:s}));return{_key:e._key||`block-${t}`,children:i,index:t,isInline:r,node:e}}function j8(){}const O8="modulepreload",M8=function(n){return"/"+n},P1={},xE=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let a=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");s=a(t.map(d=>{if(d=M8(d),d in P1)return;P1[d]=!0;const f=d.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":O8,f||(g.as="script"),g.crossOrigin="",g.href=d,u&&g.setAttribute("nonce",u),document.head.appendChild(g),f)return new Promise((x,y)=>{g.addEventListener("load",x),g.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},yE=!(typeof navigator>"u")&&navigator.product==="ReactNative",vE={timeout:yE?6e4:12e4},F8=function(n){const e={...vE,...typeof n=="string"?{url:n}:n};if(e.timeout=wE(e.timeout),e.query){const{url:t,searchParams:r}=(function(s){const i=s.indexOf("?");if(i===-1)return{url:s,searchParams:new URLSearchParams};const a=s.slice(0,i),l=s.slice(i+1);if(!yE)return{url:a,searchParams:new URLSearchParams(l)};if(typeof decodeURIComponent!="function")throw new Error("Broken `URLSearchParams` implementation, and `decodeURIComponent` is not defined");const u=new URLSearchParams;for(const d of l.split("&")){const[f,m]=d.split("=");f&&u.append(D1(f),D1(m||""))}return{url:a,searchParams:u}})(e.url);for(const[s,i]of Object.entries(e.query)){if(i!==void 0)if(Array.isArray(i))for(const l of i)r.append(s,l);else r.append(s,i);const a=r.toString();a&&(e.url=`${t}?${a}`)}}return e.method=e.body&&!e.method?"POST":(e.method||"GET").toUpperCase(),e};function D1(n){return decodeURIComponent(n.replace(/\+/g," "))}function wE(n){if(n===!1||n===0)return!1;if(n.connect||n.socket)return n;const e=Number(n);return isNaN(e)?wE(vE.timeout):{connect:e,socket:e}}const B8=/^https?:\/\//i,U8=function(n){if(!B8.test(n.url))throw new Error(`"${n.url}" is not a valid URL`)};function bE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}const $8=["request","response","progress","error","abort"],N1=["processOptions","validateOptions","interceptRequest","finalizeOptions","onRequest","onResponse","onError","onReturn","onHeaders"];function SE(n,e){const t=[],r=N1.reduce((i,a)=>(i[a]=i[a]||[],i),{processOptions:[F8],validateOptions:[U8]});function s(i){const a=$8.reduce((x,y)=>(x[y]=(function(){const w=Object.create(null);let b=0;return{publish:function(E){for(const T in w)w[T](E)},subscribe:function(E){const T=b++;return w[T]=E,function(){delete w[T]}}}})(),x),{}),l=(x=>function(y,w,...b){const E=y==="onError";let T=w;for(let _=0;_<x[y].length&&(T=(0,x[y][_])(T,...b),!E||T);_++);return T})(r),u=l("processOptions",i);l("validateOptions",u);const d={options:u,channels:a,applyMiddleware:l};let f;const m=a.request.subscribe(x=>{f=e(x,(y,w)=>((b,E,T)=>{let _=b,A=E;if(!_)try{A=l("onResponse",E,T)}catch(I){A=null,_=I}_=_&&l("onError",_,T),_?a.error.publish(_):A&&a.response.publish(A)})(y,w,x))});a.abort.subscribe(()=>{m(),f&&f.abort()});const g=l("onReturn",a,d);return g===a&&a.request.publish(d),g}return s.use=function(i){if(!i)throw new Error("Tried to add middleware that resolved to falsey value");if(typeof i=="function")throw new Error("Tried to add middleware that was a function. It probably expects you to pass options to it.");if(i.onReturn&&r.onReturn.length>0)throw new Error("Tried to add new middleware with `onReturn` handler, but another handler has already been registered for this event");return N1.forEach(a=>{i[a]&&r[a].push(i[a])}),t.push(i),s},s.clone=()=>SE(t,e),n.forEach(s.use),s}var j1,O1,V8=bE((function(){if(O1)return j1;O1=1;var n=function(t){return t.replace(/^\s+|\s+$/g,"")},e=function(t){return Object.prototype.toString.call(t)==="[object Array]"};return j1=function(t){if(!t)return{};for(var r=Object.create(null),s=n(t).split(`
`),i=0;i<s.length;i++){var a=s[i],l=a.indexOf(":"),u=n(a.slice(0,l)).toLowerCase(),d=n(a.slice(l+1));typeof r[u]>"u"?r[u]=d:e(r[u])?r[u].push(d):r[u]=[r[u],d]}return r}})());let np=class{onabort;onerror;onreadystatechange;ontimeout;readyState=0;response;responseText="";responseType="";status;statusText;withCredentials;#t;#e;#r;#s={};#n;#i={};#a;open(e,t,r){this.#t=e,this.#e=t,this.#r="",this.readyState=1,this.onreadystatechange?.(),this.#n=void 0}abort(){this.#n&&this.#n.abort()}getAllResponseHeaders(){return this.#r}setRequestHeader(e,t){this.#s[e]=t}setInit(e,t=!0){this.#i=e,this.#a=t}send(e){const t=this.responseType!=="arraybuffer",r={...this.#i,method:this.#t,headers:this.#s,body:e};typeof AbortController=="function"&&this.#a&&(this.#n=new AbortController,typeof EventTarget<"u"&&this.#n.signal instanceof EventTarget&&(r.signal=this.#n.signal)),typeof document<"u"&&(r.credentials=this.withCredentials?"include":"omit"),fetch(this.#e,r).then(s=>(s.headers.forEach((i,a)=>{this.#r+=`${a}: ${i}\r
`}),this.status=s.status,this.statusText=s.statusText,this.readyState=3,this.onreadystatechange?.(),t?s.text():s.arrayBuffer())).then(s=>{typeof s=="string"?this.responseText=s:this.response=s,this.readyState=4,this.onreadystatechange?.()}).catch(s=>{s.name!=="AbortError"?this.onerror?.(s):this.onabort?.()})}};const rp=typeof XMLHttpRequest=="function"?"xhr":"fetch",G8=rp==="xhr"?XMLHttpRequest:np,H8=(n,e)=>{const t=n.options,r=n.applyMiddleware("finalizeOptions",t),s={},i=n.applyMiddleware("interceptRequest",void 0,{adapter:rp,context:n});if(i){const w=setTimeout(e,0,null,i);return{abort:()=>clearTimeout(w)}}let a=new G8;a instanceof np&&typeof r.fetch=="object"&&a.setInit(r.fetch,r.useAbortSignal??!0);const l=r.headers,u=r.timeout;let d=!1,f=!1,m=!1;if(a.onerror=w=>{y(a instanceof np?w instanceof Error?w:new Error(`Request error while attempting to reach is ${r.url}`,{cause:w}):new Error(`Request error while attempting to reach is ${r.url}${w.lengthComputable?`(${w.loaded} of ${w.total} bytes transferred)`:""}`))},a.ontimeout=w=>{y(new Error(`Request timeout while attempting to reach ${r.url}${w.lengthComputable?`(${w.loaded} of ${w.total} bytes transferred)`:""}`))},a.onabort=()=>{x(!0),d=!0},a.onreadystatechange=function(){u&&(x(),s.socket=setTimeout(()=>g("ESOCKETTIMEDOUT"),u.socket)),!d&&a&&a.readyState===4&&a.status!==0&&(function(){if(!(d||f||m)){if(a.status===0)return void y(new Error("Unknown XHR error"));x(),f=!0,e(null,{body:a.response||(a.responseType===""||a.responseType==="text"?a.responseText:""),url:r.url,method:r.method,headers:V8(a.getAllResponseHeaders()),statusCode:a.status,statusMessage:a.statusText})}})()},a.open(r.method,r.url,!0),a.withCredentials=!!r.withCredentials,l&&a.setRequestHeader)for(const w in l)l.hasOwnProperty(w)&&a.setRequestHeader(w,l[w]);return r.rawBody&&(a.responseType="arraybuffer"),n.applyMiddleware("onRequest",{options:r,adapter:rp,request:a,context:n}),a.send(r.body||null),u&&(s.connect=setTimeout(()=>g("ETIMEDOUT"),u.connect)),{abort:function(){d=!0,a&&a.abort()}};function g(w){m=!0,a.abort();const b=new Error(w==="ESOCKETTIMEDOUT"?`Socket timed out on request to ${r.url}`:`Connection timed out on request to ${r.url}`);b.code=w,n.channels.error.publish(b)}function x(w){(w||d||a&&a.readyState>=2&&s.connect)&&clearTimeout(s.connect),s.socket&&clearTimeout(s.socket)}function y(w){if(f)return;x(!0),f=!0,a=null;const b=w||new Error(`Network error while attempting to reach ${r.url}`);b.isNetworkError=!0,b.request=r,e(b)}},K8=(n=[],e=H8)=>SE(n,e);var z8={},M1,F1,B1,U1,$1,Xh={exports:{}};$1||($1=1,(function(n,e){e.formatArgs=function(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const s="color: "+this.color;r.splice(1,0,s,"color: inherit");let i=0,a=0;r[0].replace(/%[a-zA-Z%]/g,l=>{l!=="%%"&&(i++,l==="%c"&&(a=i))}),r.splice(a,0,s)},e.save=function(r){try{r?e.storage.setItem("debug",r):e.storage.removeItem("debug")}catch{}},e.load=function(){let r;try{r=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=z8.DEBUG),r},e.useColors=function(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let r;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(r[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=(function(){try{return localStorage}catch{}})(),e.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),n.exports=(U1?B1:(U1=1,B1=function(r){function s(l){let u,d,f,m=null;function g(...x){if(!g.enabled)return;const y=g,w=Number(new Date),b=w-(u||w);y.diff=b,y.prev=u,y.curr=w,u=w,x[0]=s.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let E=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(T,_)=>{if(T==="%%")return"%";E++;const A=s.formatters[_];if(typeof A=="function"){const I=x[E];T=A.call(y,I),x.splice(E,1),E--}return T}),s.formatArgs.call(y,x),(y.log||s.log).apply(y,x)}return g.namespace=l,g.useColors=s.useColors(),g.color=s.selectColor(l),g.extend=i,g.destroy=s.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(d!==s.namespaces&&(d=s.namespaces,f=s.enabled(l)),f),set:x=>{m=x}}),typeof s.init=="function"&&s.init(g),g}function i(l,u){const d=s(this.namespace+(typeof u>"u"?":":u)+l);return d.log=this.log,d}function a(l,u){let d=0,f=0,m=-1,g=0;for(;d<l.length;)if(f<u.length&&(u[f]===l[d]||u[f]==="*"))u[f]==="*"?(m=f,g=d,f++):(d++,f++);else{if(m===-1)return!1;f=m+1,g++,d=g}for(;f<u.length&&u[f]==="*";)f++;return f===u.length}return s.debug=s,s.default=s,s.coerce=function(l){return l instanceof Error?l.stack||l.message:l},s.disable=function(){const l=[...s.names,...s.skips.map(u=>"-"+u)].join(",");return s.enable(""),l},s.enable=function(l){s.save(l),s.namespaces=l,s.names=[],s.skips=[];const u=(typeof l=="string"?l:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const d of u)d[0]==="-"?s.skips.push(d.slice(1)):s.names.push(d)},s.enabled=function(l){for(const u of s.skips)if(a(l,u))return!1;for(const u of s.names)if(a(l,u))return!0;return!1},s.humanize=(function(){if(F1)return M1;F1=1;var l=1e3,u=60*l,d=60*u,f=24*d,m=7*f;function g(x,y,w,b){var E=y>=1.5*w;return Math.round(x/w)+" "+b+(E?"s":"")}return M1=function(x,y){y=y||{};var w,b,E=typeof x;if(E==="string"&&x.length>0)return(function(T){if(!((T=String(T)).length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(T);if(_){var A=parseFloat(_[1]);switch((_[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*A;case"weeks":case"week":case"w":return A*m;case"days":case"day":case"d":return A*f;case"hours":case"hour":case"hrs":case"hr":case"h":return A*d;case"minutes":case"minute":case"mins":case"min":case"m":return A*u;case"seconds":case"second":case"secs":case"sec":case"s":return A*l;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return A;default:return}}}})(x);if(E==="number"&&isFinite(x))return y.long?(w=x,(b=Math.abs(w))>=f?g(w,b,f,"day"):b>=d?g(w,b,d,"hour"):b>=u?g(w,b,u,"minute"):b>=l?g(w,b,l,"second"):w+" ms"):(function(T){var _=Math.abs(T);return _>=f?Math.round(T/f)+"d":_>=d?Math.round(T/d)+"h":_>=u?Math.round(T/u)+"m":_>=l?Math.round(T/l)+"s":T+"ms"})(x);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(x))}})(),s.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(r).forEach(l=>{s[l]=r[l]}),s.names=[],s.skips=[],s.formatters={},s.selectColor=function(l){let u=0;for(let d=0;d<l.length;d++)u=(u<<5)-u+l.charCodeAt(d),u|=0;return s.colors[Math.abs(u)%s.colors.length]},s.enable(s.load()),s}))(e);const{formatters:t}=n.exports;t.j=function(r){try{return JSON.stringify(r)}catch(s){return"[UnexpectedJSONParseError]: "+s.message}}})(Xh,Xh.exports)),Xh.exports;const W8=typeof Buffer>"u"?()=>!1:n=>Buffer.isBuffer(n);function V1(n){return Object.prototype.toString.call(n)==="[object Object]"}function q8(n){if(V1(n)===!1)return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(V1(t)===!1||t.hasOwnProperty("isPrototypeOf")===!1)}const Y8=["boolean","string","number"];function Q8(){return{processOptions:n=>{const e=n.body;return!e||typeof e.pipe=="function"||W8(e)||Y8.indexOf(typeof e)===-1&&!Array.isArray(e)&&!q8(e)?n:Object.assign({},n,{body:JSON.stringify(n.body),headers:Object.assign({},n.headers,{"Content-Type":"application/json"})})}}}function X8(n){return{onResponse:t=>{const r=t.headers["content-type"]||"",s=n&&n.force||r.indexOf("application/json")!==-1;return t.body&&r&&s?Object.assign({},t,{body:e(t.body)}):t},processOptions:t=>Object.assign({},t,{headers:Object.assign({Accept:"application/json"},t.headers)})};function e(t){try{return JSON.parse(t)}catch(r){throw r.message=`Failed to parsed response body as JSON: ${r.message}`,r}}}let Bo={};typeof globalThis<"u"?Bo=globalThis:typeof window<"u"?Bo=window:typeof global<"u"?Bo=global:typeof self<"u"&&(Bo=self);var Z8=Bo;function J8(n={}){const e=n.implementation||Z8.Observable;if(!e)throw new Error("`Observable` is not available in global scope, and no implementation was passed");return{onReturn:(t,r)=>new e(s=>(t.error.subscribe(i=>s.error(i)),t.progress.subscribe(i=>s.next(Object.assign({type:"progress"},i))),t.response.subscribe(i=>{s.next(Object.assign({type:"response"},i)),s.complete()}),t.request.publish(r),()=>t.abort.publish()))}}function e6(){return{onRequest:n=>{if(n.adapter!=="xhr")return;const e=n.request,t=n.context;function r(s){return i=>{const a=i.lengthComputable?i.loaded/i.total*100:-1;t.channels.progress.publish({stage:s,percent:a,total:i.total,loaded:i.loaded,lengthComputable:i.lengthComputable})}}"upload"in e&&"onprogress"in e.upload&&(e.upload.onprogress=r("upload")),"onprogress"in e&&(e.onprogress=r("download"))}}}var EE=(n,e,t)=>(t.method==="GET"||t.method==="HEAD")&&(n.isNetworkError||!1);function t6(n){return 100*Math.pow(2,n)+100*Math.random()}const d0=(n={})=>(e=>{const t=e.maxRetries||5,r=e.retryDelay||t6,s=e.shouldRetry;return{onError:(i,a)=>{const l=a.options,u=l.maxRetries||t,d=l.retryDelay||r,f=l.shouldRetry||s,m=l.attemptNumber||0;if((g=l.body)!==null&&typeof g=="object"&&typeof g.pipe=="function"||!f(i,m,l)||m>=u)return i;var g;const x=Object.assign({},a,{options:Object.assign({},l,{attemptNumber:m+1})});return setTimeout(()=>a.channels.request.publish(x),d(m)),null}}})({shouldRetry:EE,...n});d0.shouldRetry=EE;var sp=function(n,e){return sp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},sp(n,e)};function os(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");sp(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function n6(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(f){try{d(r.next(f))}catch(m){a(m)}}function u(f){try{d(r.throw(f))}catch(m){a(m)}}function d(f){f.done?i(f.value):s(f.value).then(l,u)}d((r=r.apply(n,e||[])).next())})}function TE(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(d){return function(f){return u([d,f])}}function u(d){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(t=0)),t;)try{if(r=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(d[0]===6&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(f){d=[6,f],s=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function La(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rs(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(l){a={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return i}function ss(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}function ba(n){return this instanceof ba?(this.v=n,this):new ba(n)}function r6(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(x){return function(y){return Promise.resolve(y).then(x,m)}}function l(x,y){r[x]&&(s[x]=function(w){return new Promise(function(b,E){i.push([x,w,b,E])>1||u(x,w)})},y&&(s[x]=y(s[x])))}function u(x,y){try{d(r[x](y))}catch(w){g(i[0][3],w)}}function d(x){x.value instanceof ba?Promise.resolve(x.value.v).then(f,m):g(i[0][2],x)}function f(x){u("next",x)}function m(x){u("throw",x)}function g(x,y){x(y),i.shift(),i.length&&u(i[0][0],i[0][1])}}function s6(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof La=="function"?La(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(a){return new Promise(function(l,u){a=n[i](a),s(l,u,a.done,a.value)})}}function s(i,a,l,u){Promise.resolve(u).then(function(d){i({value:d,done:l})},a)}}function ut(n){return typeof n=="function"}function f0(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Zh=f0(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Hu(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Sl=(function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,s,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var l=La(a),u=l.next();!u.done;u=l.next()){var d=u.value;d.remove(this)}}catch(w){e={error:w}}finally{try{u&&!u.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else a.remove(this);var f=this.initialTeardown;if(ut(f))try{f()}catch(w){i=w instanceof Zh?w.errors:[w]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var g=La(m),x=g.next();!x.done;x=g.next()){var y=x.value;try{G1(y)}catch(w){i=i??[],w instanceof Zh?i=ss(ss([],rs(i)),rs(w.errors)):i.push(w)}}}catch(w){r={error:w}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(r)throw r.error}}}if(i)throw new Zh(i)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)G1(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Hu(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&Hu(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=(function(){var e=new n;return e.closed=!0,e})(),n})(),_E=Sl.EMPTY;function kE(n){return n instanceof Sl||n&&"closed"in n&&ut(n.remove)&&ut(n.add)&&ut(n.unsubscribe)}function G1(n){ut(n)?n():n.unsubscribe()}var i6={Promise:void 0},a6={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,ss([n,e],rs(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function CE(n){a6.setTimeout(function(){throw n})}function H1(){}function Su(n){n()}var h0=(function(n){os(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,kE(t)&&t.add(r)):r.destination=c6,r}return e.create=function(t,r,s){return new Ra(t,r,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(Sl),o6=(function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){iu(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){iu(r)}else iu(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){iu(t)}},n})(),Ra=(function(n){os(e,n);function e(t,r,s){var i=n.call(this)||this,a;return ut(t)||!t?a={next:t??void 0,error:r??void 0,complete:s??void 0}:a=t,i.destination=new o6(a),i}return e})(h0);function iu(n){CE(n)}function l6(n){throw n}var c6={closed:!0,next:H1,error:l6,complete:H1},m0=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function md(n){return n}function u6(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return AE(n)}function AE(n){return n.length===0?md:n.length===1?n[0]:function(t){return n.reduce(function(r,s){return s(r)},t)}}var St=(function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var s=this,i=f6(e)?e:new Ra(e,t,r);return Su(function(){var a=s,l=a.operator,u=a.source;i.add(l?l.call(i,u):u?s._subscribe(i):s._trySubscribe(i))}),i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=K1(t),new t(function(s,i){var a=new Ra({next:function(l){try{e(l)}catch(u){i(u),a.unsubscribe()}},error:i,complete:s});r.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[m0]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return AE(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=K1(e),new e(function(r,s){var i;t.subscribe(function(a){return i=a},function(a){return s(a)},function(){return r(i)})})},n.create=function(e){return new n(e)},n})();function K1(n){var e;return(e=n??i6.Promise)!==null&&e!==void 0?e:Promise}function d6(n){return n&&ut(n.next)&&ut(n.error)&&ut(n.complete)}function f6(n){return n&&n instanceof h0||d6(n)&&kE(n)}function h6(n){return ut(n?.lift)}function Or(n){return function(e){if(h6(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Hs(n,e,t,r,s){return new m6(n,e,t,r,s)}var m6=(function(n){os(e,n);function e(t,r,s,i,a,l){var u=n.call(this,t)||this;return u.onFinalize=a,u.shouldUnsubscribe=l,u._next=r?function(d){try{r(d)}catch(f){t.error(f)}}:n.prototype._next,u._error=i?function(d){try{i(d)}catch(f){t.error(f)}finally{this.unsubscribe()}}:n.prototype._error,u._complete=s?function(){try{s()}catch(d){t.error(d)}finally{this.unsubscribe()}}:n.prototype._complete,u}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e})(h0),p6=f0(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),p0=(function(n){os(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new z1(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new p6},e.prototype.next=function(t){var r=this;Su(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=La(r.currentObservers),l=a.next();!l.done;l=a.next()){var u=l.value;u.next(t)}}catch(d){s={error:d}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var r=this;Su(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;Su(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=this,i=s.hasError,a=s.isStopped,l=s.observers;return i||a?_E:(this.currentObservers=null,l.push(t),new Sl(function(){r.currentObservers=null,Hu(l,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,i=r.thrownError,a=r.isStopped;s?t.error(i):a&&t.complete()},e.prototype.asObservable=function(){var t=new St;return t.source=this,t},e.create=function(t,r){return new z1(t,r)},e})(St),z1=(function(n){os(e,n);function e(t,r){var s=n.call(this)||this;return s.destination=t,s.source=r,s}return e.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},e.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:_E},e})(p0),g0={now:function(){return(g0.delegate||Date).now()},delegate:void 0},g6=(function(n){os(e,n);function e(t,r,s){t===void 0&&(t=1/0),r===void 0&&(r=1/0),s===void 0&&(s=g0);var i=n.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(t){var r=this,s=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,l=r._timestampProvider,u=r._windowTime;s||(i.push(t),!a&&i.push(l.now()+u)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),s=this,i=s._infiniteTimeWindow,a=s._buffer,l=a.slice(),u=0;u<l.length&&!t.closed;u+=i?1:2)t.next(l[u]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,s=t._timestampProvider,i=t._buffer,a=t._infiniteTimeWindow,l=(a?1:2)*r;if(r<1/0&&l<i.length&&i.splice(0,i.length-l),!a){for(var u=s.now(),d=0,f=1;f<i.length&&i[f]<=u;f+=2)d=f;d&&i.splice(0,d+1)}},e})(p0),x6=(function(n){os(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e})(Sl),W1={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,ss([n,e],rs(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},y6=(function(n){os(e,n);function e(t,r){var s=n.call(this,t,r)||this;return s.scheduler=t,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(t,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,a=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(a,i,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),W1.setInterval(t.flush.bind(t,this),s)},e.prototype.recycleAsyncId=function(t,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&W1.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var s=!1,i;try{this.work(t)}catch(a){s=!0,i=a||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,s=t.scheduler,i=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Hu(i,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e})(x6),q1=(function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=g0.now,n})(),v6=(function(n){os(e,n);function e(t,r){r===void 0&&(r=q1.now);var s=n.call(this,t,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var s;this._active=!0;do if(s=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,s){for(;t=r.shift();)t.unsubscribe();throw s}},e})(q1),w6=new v6(y6),b6=w6,S6=new St(function(n){return n.complete()});function E6(n){return n&&ut(n.schedule)}function x0(n){return n[n.length-1]}function T6(n){return ut(x0(n))?n.pop():void 0}function y0(n){return E6(x0(n))?n.pop():void 0}function _6(n,e){return typeof x0(n)=="number"?n.pop():e}var IE=(function(n){return n&&typeof n.length=="number"&&typeof n!="function"});function LE(n){return ut(n?.then)}function RE(n){return ut(n[m0])}function PE(n){return Symbol.asyncIterator&&ut(n?.[Symbol.asyncIterator])}function DE(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function k6(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var NE=k6();function jE(n){return ut(n?.[NE])}function OE(n){return r6(this,arguments,function(){var t,r,s,i;return TE(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,ba(t.read())];case 3:return r=a.sent(),s=r.value,i=r.done,i?[4,ba(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,ba(s)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function ME(n){return ut(n?.getReader)}function Mr(n){if(n instanceof St)return n;if(n!=null){if(RE(n))return C6(n);if(IE(n))return A6(n);if(LE(n))return I6(n);if(PE(n))return FE(n);if(jE(n))return L6(n);if(ME(n))return R6(n)}throw DE(n)}function C6(n){return new St(function(e){var t=n[m0]();if(ut(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function A6(n){return new St(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function I6(n){return new St(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,CE)})}function L6(n){return new St(function(e){var t,r;try{for(var s=La(n),i=s.next();!i.done;i=s.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(l){t={error:l}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}e.complete()})}function FE(n){return new St(function(e){P6(n,e).catch(function(t){return e.error(t)})})}function R6(n){return FE(OE(n))}function P6(n,e){var t,r,s,i;return n6(this,void 0,void 0,function(){var a,l;return TE(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),t=s6(n),u.label=1;case 1:return[4,t.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=u.sent(),s={error:l},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Si(n,e,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function BE(n,e){return e===void 0&&(e=0),Or(function(t,r){t.subscribe(Hs(r,function(s){return Si(r,n,function(){return r.next(s)},e)},function(){return Si(r,n,function(){return r.complete()},e)},function(s){return Si(r,n,function(){return r.error(s)},e)}))})}function UE(n,e){return e===void 0&&(e=0),Or(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function D6(n,e){return Mr(n).pipe(UE(e),BE(e))}function N6(n,e){return Mr(n).pipe(UE(e),BE(e))}function j6(n,e){return new St(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function O6(n,e){return new St(function(t){var r;return Si(t,e,function(){r=n[NE](),Si(t,e,function(){var s,i,a;try{s=r.next(),i=s.value,a=s.done}catch(l){t.error(l);return}a?t.complete():t.next(i)},0,!0)}),function(){return ut(r?.return)&&r.return()}})}function $E(n,e){if(!n)throw new Error("Iterable cannot be null");return new St(function(t){Si(t,e,function(){var r=n[Symbol.asyncIterator]();Si(t,e,function(){r.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function M6(n,e){return $E(OE(n),e)}function F6(n,e){if(n!=null){if(RE(n))return D6(n,e);if(IE(n))return j6(n,e);if(LE(n))return N6(n,e);if(PE(n))return $E(n,e);if(jE(n))return O6(n,e);if(ME(n))return M6(n,e)}throw DE(n)}function El(n,e){return e?F6(n,e):Mr(n)}function Sa(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=y0(n);return El(n,t)}function VE(n,e){var t=ut(n)?n:function(){return n},r=function(s){return s.error(t())};return new St(r)}function B6(n){return!!n&&(n instanceof St||ut(n.lift)&&ut(n.subscribe))}var GE=f0(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function He(n,e){return new Promise(function(t,r){var s=!1,i;n.subscribe({next:function(a){i=a,s=!0},error:r,complete:function(){s?t(i):r(new GE)}})})}function Jh(n,e){return new Promise(function(t,r){var s=new Ra({next:function(i){t(i),s.unsubscribe()},error:r,complete:function(){r(new GE)}});n.subscribe(s)})}function U6(n){return n instanceof Date&&!isNaN(n)}function tn(n,e){return Or(function(t,r){var s=0;t.subscribe(Hs(r,function(i){r.next(n.call(e,i,s++))}))})}var $6=Array.isArray;function V6(n,e){return $6(e)?n.apply(void 0,ss([],rs(e))):n(e)}function G6(n){return tn(function(e){return V6(n,e)})}function H6(n,e,t){return t===void 0&&(t=md),function(r){Y1(e,function(){for(var s=n.length,i=new Array(s),a=s,l=s,u=function(f){Y1(e,function(){var m=El(n[f],e),g=!1;m.subscribe(Hs(r,function(x){i[f]=x,g||(g=!0,l--),l||r.next(t(i.slice()))},function(){--a||r.complete()}))},r)},d=0;d<s;d++)u(d)})}}function Y1(n,e,t){e()}function K6(n,e,t,r,s,i,a,l){var u=[],d=0,f=0,m=!1,g=function(){m&&!u.length&&!d&&e.complete()},x=function(w){return d<r?y(w):u.push(w)},y=function(w){d++;var b=!1;Mr(t(w,f++)).subscribe(Hs(e,function(E){e.next(E)},function(){b=!0},void 0,function(){if(b)try{d--;for(var E=function(){var T=u.shift();a||y(T)};u.length&&d<r;)E();g()}catch(T){e.error(T)}}))};return n.subscribe(Hs(e,x,function(){m=!0,g()})),function(){}}function Ei(n,e,t){return t===void 0&&(t=1/0),ut(e)?Ei(function(r,s){return tn(function(i,a){return e(r,i,s,a)})(Mr(n(r,s)))},t):(typeof e=="number"&&(t=e),Or(function(r,s){return K6(r,s,n,t)}))}function HE(n){return n===void 0&&(n=1/0),Ei(md,n)}function z6(){return HE(1)}function W6(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return z6()(El(n,y0(n)))}function KE(n){return new St(function(e){Mr(n()).subscribe(e)})}function q6(n,e,t){return t===void 0&&(t=b6),new St(function(r){var s=U6(n)?+n-t.now():n;s<0&&(s=0);var i=0;return t.schedule(function(){r.closed||(r.next(i++),r.complete())},s)})}function Y6(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=y0(n),r=_6(n,1/0),s=n;return s.length?s.length===1?Mr(s[0]):HE(r)(El(s,t)):S6}var Q6=Array.isArray;function X6(n){return n.length===1&&Q6(n[0])?n[0]:n}function Ua(n,e){return Or(function(t,r){var s=0;t.subscribe(Hs(r,function(i){return n.call(e,i,s++)&&r.next(i)}))})}function Ku(n){return Or(function(e,t){var r=null,s=!1,i;r=e.subscribe(Hs(t,void 0,void 0,function(a){i=Mr(n(a,Ku(n)(e))),r?(r.unsubscribe(),r=null,i.subscribe(t)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(t))})}function zE(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=T6(n);return t?u6(zE.apply(void 0,ss([],rs(n))),G6(t)):Or(function(r,s){H6(ss([r],rs(X6(n))))(s)})}function Z6(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return zE.apply(void 0,ss([],rs(n)))}function WE(n){return Or(function(e,t){try{e.subscribe(t)}finally{t.add(n)}})}function qE(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new p0}:e,r=n.resetOnError,s=r===void 0?!0:r,i=n.resetOnComplete,a=i===void 0?!0:i,l=n.resetOnRefCountZero,u=l===void 0?!0:l;return function(d){var f,m,g,x=0,y=!1,w=!1,b=function(){m?.unsubscribe(),m=void 0},E=function(){b(),f=g=void 0,y=w=!1},T=function(){var _=f;E(),_?.unsubscribe()};return Or(function(_,A){x++,!w&&!y&&b();var I=g=g??t();A.add(function(){x--,x===0&&!w&&!y&&(m=em(T,u))}),I.subscribe(A),!f&&x>0&&(f=new Ra({next:function(N){return I.next(N)},error:function(N){w=!0,b(),m=em(E,s,N),I.error(N)},complete:function(){y=!0,b(),m=em(E,a),I.complete()}}),Mr(_).subscribe(f))})(d)}}function em(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var s=new Ra({next:function(){s.unsubscribe(),n()}});return Mr(e.apply(void 0,ss([],rs(t)))).subscribe(s)}}function J6(n,e,t){var r,s=!1;return r=n,qE({connector:function(){return new g6(r,e,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}function ej(n,e,t){var r=ut(n)||e||t?{next:n,error:e,complete:t}:n;return r?Or(function(s,i){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var l=!0;s.subscribe(Hs(i,function(u){var d;(d=r.next)===null||d===void 0||d.call(r,u),i.next(u)},function(){var u;l=!1,(u=r.complete)===null||u===void 0||u.call(r),i.complete()},function(u){var d;l=!1,(d=r.error)===null||d===void 0||d.call(r,u),i.error(u)},function(){var u,d;l&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(d=r.finalize)===null||d===void 0||d.call(r)}))}):md}function YE(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}var QE={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},XE={0:8203,1:8204,2:8205,3:65279};new Array(4).fill(String.fromCodePoint(XE[0])).join("");Object.fromEntries(Object.entries(XE).map(n=>n.reverse()));Object.fromEntries(Object.entries(QE).map(n=>n.reverse()));var tj=`${Object.values(QE).map(n=>`\\u{${n.toString(16)}}`).join("")}`,Q1=new RegExp(`[${tj}]{4,}`,"gu");function nj(n){var e;return{cleaned:n.replace(Q1,""),encoded:((e=n.match(Q1))==null?void 0:e[0])||""}}function rj(n){return n&&JSON.parse(nj(JSON.stringify(n)).cleaned)}function sj(n){return rj(n)}const ij="drafts",aj="versions",Pa=".",zu=`${ij}${Pa}`,ZE=`${aj}${Pa}`;function pd(n){return n.startsWith(zu)}function gd(n){return n.startsWith(ZE)}function JE(n){if(gd(n)){const e=xd(n);return zu+e}return pd(n)?n:zu+n}function Tl(n,e){if(e==="drafts"||e==="published")throw new Error('Version can not be "published" or "drafts"');return`${ZE}${e}${Pa}${xd(n)}`}function eT(n){if(!gd(n))return;const[e,t,...r]=n.split(Pa);return t}function xd(n){return gd(n)?n.split(Pa).slice(2).join(Pa):pd(n)?n.slice(zu.length):n}let oj=n=>crypto.getRandomValues(new Uint8Array(n)),lj=(n,e,t)=>{let r=(2<<Math.log(n.length-1)/Math.LN2)-1,s=-~(1.6*r*e/n.length);return(i=e)=>{let a="";for(;;){let l=t(s),u=s|0;for(;u--;)if(a+=n[l[u]&r]||"",a.length===i)return a}}},cj=(n,e=21)=>lj(n,e,oj);const X1=/\r\n|[\n\r\u2028\u2029]/;function uj(n,e,t){const r=n.split(X1),s={start:Z1(e.start,r),end:e.end?Z1(e.end,r):void 0},{start:i,end:a,markerLines:l}=dj(s,r),u=`${a}`.length;return n.split(X1,a).slice(i,a).map((d,f)=>{const m=i+1+f,g=` ${` ${m}`.slice(-u)} |`,x=l[m],y=!l[m+1];if(!x)return` ${g}${d.length>0?` ${d}`:""}`;let w="";if(Array.isArray(x)){const b=d.slice(0,Math.max(x[0]-1,0)).replace(/[^\t]/g," "),E=x[1]||1;w=[`
 `,g.replace(/\d/g," ")," ",b,"^".repeat(E)].join(""),y&&t&&(w+=" "+t)}return[">",g,d.length>0?` ${d}`:"",w].join("")}).join(`
`)}function dj(n,e){const t={...n.start},r={...t,...n.end},s=2,i=3,a=t.line??-1,l=t.column??0,u=r.line,d=r.column;let f=Math.max(a-(s+1),0),m=Math.min(e.length,u+i);a===-1&&(f=0),u===-1&&(m=e.length);const g=u-a,x={};if(g)for(let y=0;y<=g;y++){const w=y+a;if(!l)x[w]=!0;else if(y===0){const b=e[w-1].length;x[w]=[l,b-l+1]}else if(y===g)x[w]=[0,d];else{const b=e[w-y].length;x[w]=[0,b]}}else l===d?l?x[a]=[l,0]:x[a]=!0:x[a]=[l,d-l];return{start:f,end:m,markerLines:x}}function Z1(n,e){let t=0;for(let r=0;r<e.length;r++){const s=e[r].length+1;if(t+s>n)return{line:r+1,column:n-t};t+=s}return{line:e.length,column:e[e.length-1]?.length??0}}const tm=5;class fj extends Error{response;statusCode=400;responseBody;details;constructor(e,t){const r=tT(e,t);super(r.message),Object.assign(this,r)}}class hj extends Error{response;statusCode=500;responseBody;details;constructor(e){const t=tT(e);super(t.message),Object.assign(this,t)}}function tT(n,e){const t=n.body,r={response:n,statusCode:n.statusCode,responseBody:gj(t,n),message:"",details:void 0};if(!YE(t))return r.message=nm(n,t),r;const s=t.error;if(typeof s=="string"&&typeof t.message=="string")return r.message=`${s} - ${t.message}`,r;if(typeof s!="object"||s===null)return typeof s=="string"?r.message=s:typeof t.message=="string"?r.message=t.message:r.message=nm(n,t),r;if(mj(s)||pj(s)){const i=s.items||[],a=i.slice(0,tm).map(u=>u.error?.description).filter(Boolean);let l=a.length?`:
- ${a.join(`
- `)}`:"";return i.length>tm&&(l+=`
...and ${i.length-tm} more`),r.message=`${s.description}${l}`,r.details=t.error,r}if(nT(s)){const i=e?.options?.query?.tag;return r.message=rT(s,i),r.details=t.error,r}return"description"in s&&typeof s.description=="string"?(r.message=s.description,r.details=s,r):(r.message=nm(n,t),r)}function mj(n){return"type"in n&&n.type==="mutationError"&&"description"in n&&typeof n.description=="string"}function pj(n){return"type"in n&&n.type==="actionError"&&"description"in n&&typeof n.description=="string"}function nT(n){return YE(n)&&n.type==="queryParseError"&&typeof n.query=="string"&&typeof n.start=="number"&&typeof n.end=="number"}function rT(n,e){const{query:t,start:r,end:s,description:i}=n;if(!t||typeof r>"u")return`GROQ query parse error: ${i}`;const a=e?`

Tag: ${e}`:"";return`GROQ query parse error:
${uj(t,{start:r,end:s},i)}${a}`}function nm(n,e){const t=typeof e=="string"?` (${xj(e,100)})`:"",r=n.statusMessage?` ${n.statusMessage}`:"";return`${n.method}-request to ${n.url} resulted in HTTP ${n.statusCode}${r}${t}`}function gj(n,e){return(e.headers["content-type"]||"").toLowerCase().indexOf("application/json")!==-1?JSON.stringify(n,null,2):n}function xj(n,e){return n.length>e?`${n.slice(0,e)}`:n}class yj extends Error{projectId;addOriginUrl;constructor({projectId:e}){super("CorsOriginError"),this.name="CorsOriginError",this.projectId=e;const t=new URL(`https://sanity.io/manage/project/${e}/api`);if(typeof location<"u"){const{origin:r}=location;t.searchParams.set("cors","add"),t.searchParams.set("origin",r),this.addOriginUrl=t,this.message=`The current origin is not allowed to connect to the Live Content API. Add it here: ${t}`}else this.message=`The current origin is not allowed to connect to the Live Content API. Change your configuration here: ${t}`}}const vj={onResponse:(n,e)=>{if(n.statusCode>=500)throw new hj(n);if(n.statusCode>=400)throw new fj(n,e);return n}};function wj(n={}){const e={},t=r=>n.ignoreWarnings===void 0?!1:(Array.isArray(n.ignoreWarnings)?n.ignoreWarnings:[n.ignoreWarnings]).some(s=>typeof s=="string"?r.includes(s):s instanceof RegExp?s.test(r):!1);return{onResponse:r=>{const s=r.headers["x-sanity-warning"],i=Array.isArray(s)?s:[s];for(const a of i)!a||e[a]||t(a)||(e[a]=!0,console.warn(a));return r}}}function J1(n,e={}){return K8([d0({shouldRetry:bj}),...n,wj(e),Q8(),X8(),e6(),vj,J8({implementation:St})])}function bj(n,e,t){if(t.maxRetries===0)return!1;const r=t.method==="GET"||t.method==="HEAD",s=(t.uri||t.url).startsWith("/data/query"),i=n.response&&(n.response.statusCode===429||n.response.statusCode===502||n.response.statusCode===503);return(r||s)&&i?!0:d0.shouldRetry(n,e,t)}const Sj="https://www.sanity.io/help/";function v0(n){return Sj+n}const e2=["image","file"],t2=["before","after","replace"],sT=n=>{if(!/^(~[a-z0-9]{1}[-\w]{0,63}|[a-z0-9]{1}[-\w]{0,63})$/.test(n))throw new Error("Datasets can only contain lowercase characters, numbers, underscores and dashes, and start with tilde, and be maximum 64 characters")},Ej=n=>{if(!/^[-a-z0-9]+$/i.test(n))throw new Error("`projectId` can only contain only a-z, 0-9 and dashes")},Tj=n=>{if(e2.indexOf(n)===-1)throw new Error(`Invalid asset type: ${n}. Must be one of ${e2.join(", ")}`)},Wo=(n,e)=>{if(e===null||typeof e!="object"||Array.isArray(e))throw new Error(`${n}() takes an object of properties`)},Wu=(n,e)=>{if(typeof e!="string"||!/^[a-z0-9_][a-z0-9_.-]{0,127}$/i.test(e)||e.includes(".."))throw new Error(`${n}(): "${e}" is not a valid document ID`)},Da=(n,e)=>{if(!e._id)throw new Error(`${n}() requires that the document contains an ID ("_id" property)`);Wu(n,e._id)},_j=(n,e)=>{if(typeof e!="string")throw new Error(`\`${n}()\`: \`${e}\` is not a valid document type`)},iT=(n,e)=>{if(!e._type)throw new Error(`\`${n}()\` requires that the document contains a type (\`_type\` property)`);_j(n,e._type)},kj=(n,e)=>{if(e._id&&e._id!==n)throw new Error(`The provided document ID (\`${e._id}\`) does not match the generated version ID (\`${n}\`)`)},Cj=(n,e,t)=>{const r="insert(at, selector, items)";if(t2.indexOf(n)===-1){const s=t2.map(i=>`"${i}"`).join(", ");throw new Error(`${r} takes an "at"-argument which is one of: ${s}`)}if(typeof e!="string")throw new Error(`${r} takes a "selector"-argument which must be a string`);if(!Array.isArray(t))throw new Error(`${r} takes an "items"-argument which must be an array`)},Li=n=>{if(!n.dataset)throw new Error("`dataset` must be provided to perform queries");return n.dataset||""},aT=n=>{if(typeof n!="string"||!/^[a-z0-9._-]{1,75}$/i.test(n))throw new Error("Tag can only contain alphanumeric characters, underscores, dashes and dots, and be between one and 75 characters long.");return n},oT=n=>{if(!n["~experimental_resource"])throw new Error("`resource` must be provided to perform resource queries");const{type:e,id:t}=n["~experimental_resource"];switch(e){case"dataset":{if(t.split(".").length!==2)throw new Error('Dataset resource ID must be in the format "project.dataset"');return}case"dashboard":case"media-library":case"canvas":return;default:throw new Error(`Unsupported resource type: ${e.toString()}`)}},yi=(n,e)=>{if(e["~experimental_resource"])throw new Error(`\`${n}\` does not support resource-based operations`)};function Aj(n){let e=!1,t;return(...r)=>(e||(t=n(...r),e=!0),t)}const qs=n=>Aj((...e)=>console.warn(n.join(" "),...e)),Ij=qs(["Because you set `withCredentials` to true, we will override your `useCdn`","setting to be false since (cookie-based) credentials are never set on the CDN"]),Lj=qs(["Since you haven't set a value for `useCdn`, we will deliver content using our","global, edge-cached API-CDN. If you wish to have content delivered faster, set","`useCdn: false` to use the Live API. Note: You may incur higher costs using the live API."]),Rj=qs(["The Sanity client is configured with the `perspective` set to `drafts` or `previewDrafts`, which doesn't support the API-CDN.","The Live API will be used instead. Set `useCdn: false` in your configuration to hide this warning."]),Pj=qs(["The `previewDrafts` perspective has been renamed to  `drafts` and will be removed in a future API version"]),Dj=qs(["You have configured Sanity client to use a token in the browser. This may cause unintentional security issues.",`See ${v0("js-client-browser-token")} for more information and how to hide this warning.`]),Nj=qs(["You have configured Sanity client to use a token, but also provided `withCredentials: true`.","This is no longer supported - only token will be used - remove `withCredentials: true`."]),jj=qs(["Using the Sanity client without specifying an API version is deprecated.",`See ${v0("js-client-api-version")}`]),Oj=qs(["You have called `createVersion()` with a defined `document`. The recommended approach is to provide a `baseId` and `releaseId` instead."]),Mj="apicdn.sanity.io",qo={apiHost:"https://api.sanity.io",apiVersion:"1",useProjectHostname:!0,stega:{enabled:!1}},Fj=["localhost","127.0.0.1","0.0.0.0"],Bj=n=>Fj.indexOf(n)!==-1;function Uj(n){if(n==="1"||n==="X")return;const e=new Date(n);if(!(/^\d{4}-\d{2}-\d{2}$/.test(n)&&e instanceof Date&&e.getTime()>0))throw new Error("Invalid API version string, expected `1` or date in format `YYYY-MM-DD`")}function lT(n){if(Array.isArray(n)&&n.length>1&&n.includes("raw"))throw new TypeError('Invalid API perspective value: "raw". The raw-perspective can not be combined with other perspectives')}const cT=(n,e)=>{const t={...e,...n,stega:{...typeof e.stega=="boolean"?{enabled:e.stega}:e.stega||qo.stega,...typeof n.stega=="boolean"?{enabled:n.stega}:n.stega||{}}};t.apiVersion||jj();const r={...qo,...t},s=r.useProjectHostname&&!r["~experimental_resource"];if(typeof Promise>"u"){const g=v0("js-client-promise-polyfill");throw new Error(`No native Promise-implementation found, polyfill needed - see ${g}`)}if(s&&!r.projectId)throw new Error("Configuration must contain `projectId`");if(r["~experimental_resource"]&&oT(r),typeof r.perspective<"u"&&lT(r.perspective),"encodeSourceMap"in r)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMap' is not supported in '@sanity/client'. Did you mean 'stega.enabled'?");if("encodeSourceMapAtPath"in r)throw new Error("It looks like you're using options meant for '@sanity/preview-kit/client'. 'encodeSourceMapAtPath' is not supported in '@sanity/client'. Did you mean 'stega.filter'?");if(typeof r.stega.enabled!="boolean")throw new Error(`stega.enabled must be a boolean, received ${r.stega.enabled}`);if(r.stega.enabled&&r.stega.studioUrl===void 0)throw new Error("stega.studioUrl must be defined when stega.enabled is true");if(r.stega.enabled&&typeof r.stega.studioUrl!="string"&&typeof r.stega.studioUrl!="function")throw new Error(`stega.studioUrl must be a string or a function, received ${r.stega.studioUrl}`);const i=typeof window<"u"&&window.location&&window.location.hostname,a=i&&Bj(window.location.hostname),l=!!r.token;r.withCredentials&&l&&(Nj(),r.withCredentials=!1),i&&a&&l&&r.ignoreBrowserTokenWarning!==!0?Dj():typeof r.useCdn>"u"&&Lj(),s&&Ej(r.projectId),r.dataset&&sT(r.dataset),"requestTagPrefix"in r&&(r.requestTagPrefix=r.requestTagPrefix?aT(r.requestTagPrefix).replace(/\.+$/,""):void 0),r.apiVersion=`${r.apiVersion}`.replace(/^v/,""),r.isDefaultApi=r.apiHost===qo.apiHost,r.useCdn===!0&&r.withCredentials&&Ij(),r.useCdn=r.useCdn!==!1&&!r.withCredentials,Uj(r.apiVersion);const u=r.apiHost.split("://",2),d=u[0],f=u[1],m=r.isDefaultApi?Mj:f;return s?(r.url=`${d}://${r.projectId}.${f}/v${r.apiVersion}`,r.cdnUrl=`${d}://${r.projectId}.${m}/v${r.apiVersion}`):(r.url=`${r.apiHost}/v${r.apiVersion}`,r.cdnUrl=r.url),r};class uT extends Error{name="ConnectionFailedError"}class $j extends Error{name="DisconnectError";reason;constructor(e,t,r={}){super(e,r),this.reason=t}}class Vj extends Error{name="ChannelError";data;constructor(e,t){super(e),this.data=t}}class Gj extends Error{name="MessageError";data;constructor(e,t,r={}){super(e,r),this.data=t}}class n2 extends Error{name="MessageParseError"}const Hj=["channelError","disconnect"];function dT(n,e){return KE(()=>{const t=n();return B6(t)?t:Sa(t)}).pipe(Ei(t=>Kj(t,e)))}function Kj(n,e){return new St(t=>{const r=e.includes("open"),s=e.includes("reconnect");function i(d){if("data"in d){const[f,m]=r2(d);t.error(f?new n2("Unable to parse EventSource error message",{cause:m}):new Gj((m?.data).message,m));return}n.readyState===n.CLOSED?t.error(new uT("EventSource connection failed")):s&&t.next({type:"reconnect"})}function a(){t.next({type:"open"})}function l(d){const[f,m]=r2(d);if(f){t.error(new n2("Unable to parse EventSource message",{cause:f}));return}if(d.type==="channelError"){const g=new URL(n.url).searchParams.get("tag");t.error(new Vj(zj(m?.data,g),m.data));return}if(d.type==="disconnect"){t.error(new $j(`Server disconnected client: ${m.data?.reason||"unknown error"}`));return}t.next({type:d.type,id:d.lastEventId,...m.data?{data:m.data}:{}})}n.addEventListener("error",i),r&&n.addEventListener("open",a);const u=[...new Set([...Hj,...e])].filter(d=>d!=="error"&&d!=="open"&&d!=="reconnect");return u.forEach(d=>n.addEventListener(d,l)),()=>{n.removeEventListener("error",i),r&&n.removeEventListener("open",a),u.forEach(d=>n.removeEventListener(d,l)),n.close()}})}function r2(n){try{const e=typeof n.data=="string"&&JSON.parse(n.data);return[null,{type:n.type,id:n.lastEventId,...Wj(e)?{}:{data:e}}]}catch(e){return[e,null]}}function zj(n,e){const t=n.error;return t?nT(t)?rT(t,e):t.description?t.description:typeof t=="string"?t:JSON.stringify(t,null,2):n.message||"Unknown listener error"}function Wj(n){for(const e in n)return!1;return!0}function fT(n){if(typeof n=="string")return{id:n};if(Array.isArray(n))return{query:"*[_id in $ids]",params:{ids:n}};if(typeof n=="object"&&n!==null&&"query"in n&&typeof n.query=="string")return"params"in n&&typeof n.params=="object"&&n.params!==null?{query:n.query,params:n.params}:{query:n.query};const e=["* Document ID (<docId>)","* Array of document IDs","* Object containing `query`"].join(`
`);throw new Error(`Unknown selection - must be one of:

${e}`)}class hT{selection;operations;constructor(e,t={}){this.selection=e,this.operations=t}set(e){return this._assign("set",e)}setIfMissing(e){return this._assign("setIfMissing",e)}diffMatchPatch(e){return Wo("diffMatchPatch",e),this._assign("diffMatchPatch",e)}unset(e){if(!Array.isArray(e))throw new Error("unset(attrs) takes an array of attributes to unset, non-array given");return this.operations=Object.assign({},this.operations,{unset:e}),this}inc(e){return this._assign("inc",e)}dec(e){return this._assign("dec",e)}insert(e,t,r){return Cj(e,t,r),this._assign("insert",{[e]:t,items:r})}append(e,t){return this.insert("after",`${e}[-1]`,t)}prepend(e,t){return this.insert("before",`${e}[0]`,t)}splice(e,t,r,s){const i=typeof r>"u"||r===-1,a=t<0?t-1:t,l=i?-1:Math.max(0,t+r),u=a<0&&l>=0?"":l,d=`${e}[${a}:${u}]`;return this.insert("replace",d,s||[])}ifRevisionId(e){return this.operations.ifRevisionID=e,this}serialize(){return{...fT(this.selection),...this.operations}}toJSON(){return this.serialize()}reset(){return this.operations={},this}_assign(e,t,r=!0){return Wo(e,t),this.operations=Object.assign({},this.operations,{[e]:Object.assign({},r&&this.operations[e]||{},t)}),this}_set(e,t){return this._assign(e,t,!1)}}class Ti extends hT{#t;constructor(e,t,r){super(e,t),this.#t=r}clone(){return new Ti(this.selection,{...this.operations},this.#t)}commit(e){if(!this.#t)throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const t=typeof this.selection=="string",r=Object.assign({returnFirst:t,returnDocuments:!0},e);return this.#t.mutate({patch:this.serialize()},r)}}class Ms extends hT{#t;constructor(e,t,r){super(e,t),this.#t=r}clone(){return new Ms(this.selection,{...this.operations},this.#t)}commit(e){if(!this.#t)throw new Error("No `client` passed to patch, either provide one or pass the patch to a clients `mutate()` method");const t=typeof this.selection=="string",r=Object.assign({returnFirst:t,returnDocuments:!0},e);return this.#t.mutate({patch:this.serialize()},r)}}const mT={returnDocuments:!1};class pT{operations;trxId;constructor(e=[],t){this.operations=e,this.trxId=t}create(e){return Wo("create",e),this._add({create:e})}createIfNotExists(e){const t="createIfNotExists";return Wo(t,e),Da(t,e),this._add({[t]:e})}createOrReplace(e){const t="createOrReplace";return Wo(t,e),Da(t,e),this._add({[t]:e})}delete(e){return Wu("delete",e),this._add({delete:{id:e}})}transactionId(e){return e?(this.trxId=e,this):this.trxId}serialize(){return[...this.operations]}toJSON(){return this.serialize()}reset(){return this.operations=[],this}_add(e){return this.operations.push(e),this}}class yd extends pT{#t;constructor(e,t,r){super(e,r),this.#t=t}clone(){return new yd([...this.operations],this.#t,this.trxId)}commit(e){if(!this.#t)throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return this.#t.mutate(this.serialize(),Object.assign({transactionId:this.trxId},mT,e||{}))}patch(e,t){const r=typeof t=="function",s=typeof e!="string"&&e instanceof Ms,i=typeof e=="object"&&("query"in e||"id"in e);if(s)return this._add({patch:e.serialize()});if(r){const a=t(new Ms(e,{},this.#t));if(!(a instanceof Ms))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:a.serialize()})}if(i){const a=new Ms(e,t||{},this.#t);return this._add({patch:a.serialize()})}return this._add({patch:{id:e,...t}})}}class vd extends pT{#t;constructor(e,t,r){super(e,r),this.#t=t}clone(){return new vd([...this.operations],this.#t,this.trxId)}commit(e){if(!this.#t)throw new Error("No `client` passed to transaction, either provide one or pass the transaction to a clients `mutate()` method");return this.#t.mutate(this.serialize(),Object.assign({transactionId:this.trxId},mT,e||{}))}patch(e,t){const r=typeof t=="function";if(typeof e!="string"&&e instanceof Ti)return this._add({patch:e.serialize()});if(r){const s=t(new Ti(e,{},this.#t));if(!(s instanceof Ti))throw new Error("function passed to `patch()` must return the patch");return this._add({patch:s.serialize()})}return this._add({patch:{id:e,...t}})}}const qj="X-Sanity-Project-ID";function Yj(n,e={}){const t={};n.headers&&Object.assign(t,n.headers);const r=e.token||n.token;r&&(t.Authorization=`Bearer ${r}`),!e.useGlobalApi&&!n.useProjectHostname&&n.projectId&&(t[qj]=n.projectId);const s=!!(typeof e.withCredentials>"u"?n.withCredentials:e.withCredentials),i=typeof e.timeout>"u"?n.timeout:e.timeout;return Object.assign({},e,{headers:Object.assign({},t,e.headers||{}),timeout:typeof i>"u"?300*1e3:i,proxy:e.proxy||n.proxy,json:!0,withCredentials:s,fetch:typeof e.fetch=="object"&&typeof n.fetch=="object"?{...n.fetch,...e.fetch}:e.fetch||n.fetch})}const gT=({query:n,params:e={},options:t={}})=>{const r=new URLSearchParams,{tag:s,includeMutations:i,returnQuery:a,...l}=t;s&&r.append("tag",s),r.append("query",n);for(const[u,d]of Object.entries(e))d!==void 0&&r.append(`$${u}`,JSON.stringify(d));for(const[u,d]of Object.entries(l))d&&r.append(u,`${d}`);return a===!1&&r.append("returnQuery","false"),i===!1&&r.append("includeMutations","false"),`?${r}`},Qj=(n,e)=>n===!1?void 0:typeof n>"u"?e:n,Xj=(n={})=>({dryRun:n.dryRun,returnIds:!0,returnDocuments:Qj(n.returnDocuments,!0),visibility:n.visibility||"sync",autoGenerateArrayKeys:n.autoGenerateArrayKeys,skipCrossDatasetReferenceValidation:n.skipCrossDatasetReferenceValidation}),w0=n=>n.type==="response",Zj=n=>n.body,Jj=(n,e)=>n.reduce((t,r)=>(t[e(r)]=r,t),Object.create(null)),e9=11264;function xT(n,e,t,r,s={},i={}){const a="stega"in i?{...t||{},...typeof i.stega=="boolean"?{enabled:i.stega}:i.stega||{}}:t,l=a.enabled?sj(s):s,u=i.filterResponse===!1?y=>y:y=>y.result,{cache:d,next:f,...m}={useAbortSignal:typeof i.signal<"u",resultSourceMap:a.enabled?"withKeyArraySelector":i.resultSourceMap,...i,returnQuery:i.filterResponse===!1&&i.returnQuery!==!1},g=typeof d<"u"||typeof f<"u"?{...m,fetch:{cache:d,next:f}}:m,x=Ri(n,e,"query",{query:r,params:l},g);return a.enabled?x.pipe(Z6(El(xE(()=>import("./stegaEncodeSourceMap-DpHxbbpo.js"),[]).then(function(y){return y.stegaEncodeSourceMap$1}).then(({stegaEncodeSourceMap:y})=>y))),tn(([y,w])=>{const b=w(y.result,y.resultSourceMap,a);return u({...y,result:b})})):x.pipe(tn(u))}function Na(n,e,t,r={}){const s=(()=>{if(!r.releaseId)return t;const a=eT(t);if(!a){if(pd(t))throw new Error(`The document ID (\`${t}\`) is a draft, but \`options.releaseId\` is set as \`${r.releaseId}\``);return Tl(t,r.releaseId)}if(a!==r.releaseId)throw new Error(`The document ID (\`${t}\`) is already a version of \`${a}\` release, but this does not match the provided \`options.releaseId\` (\`${r.releaseId}\`)`);return t})(),i={uri:qn(n,"doc",s),json:!0,tag:r.tag,signal:r.signal,query:r.includeAllVersions!==void 0?{includeAllVersions:r.includeAllVersions}:void 0};return kl(n,e,i).pipe(Ua(w0),tn(a=>{const l=a.body.documents;return l?r.includeAllVersions?l:l[0]:r.includeAllVersions?[]:void 0}))}function yT(n,e,t,r={}){const s={uri:qn(n,"doc",t.join(",")),json:!0,tag:r.tag,signal:r.signal};return kl(n,e,s).pipe(Ua(w0),tn(i=>{const a=Jj(i.body.documents||[],l=>l._id);return t.map(l=>a[l]||null)}))}function vT(n,e,t,r={}){return Ri(n,e,"query",{query:"*[sanity::partOfRelease($releaseId)]",params:{releaseId:t}},r)}function wT(n,e,t,r){return Da("createIfNotExists",t),wd(n,e,t,"createIfNotExists",r)}function bT(n,e,t,r){return Da("createOrReplace",t),wd(n,e,t,"createOrReplace",r)}function ST(n,e,t,r,s){return Da("createVersion",t),iT("createVersion",t),Oj(),mt(n,e,{actionType:"sanity.action.document.version.create",publishedId:r,document:t},s)}function ET(n,e,t,r,s,i,a){if(!r)throw new Error("`createVersion()` requires `baseId` when no `document` is provided");if(!t)throw new Error("`createVersion()` requires `publishedId` when `baseId` is provided");Wu("createVersion",r),Wu("createVersion",t);const l={actionType:"sanity.action.document.version.create",publishedId:t,baseId:r,versionId:s?Tl(t,s):JE(t),ifBaseRevisionId:i};return mt(n,e,l,a)}function TT(n,e,t,r){return Ri(n,e,"mutate",{mutations:[{delete:fT(t)}]},r)}function _T(n,e,t,r=!1,s){return mt(n,e,{actionType:"sanity.action.document.version.discard",versionId:t,purge:r},s)}function kT(n,e,t,r){return Da("replaceVersion",t),iT("replaceVersion",t),mt(n,e,{actionType:"sanity.action.document.version.replace",document:t},r)}function CT(n,e,t,r,s){return mt(n,e,{actionType:"sanity.action.document.version.unpublish",versionId:t,publishedId:r},s)}function AT(n,e,t,r){let s;t instanceof Ms||t instanceof Ti?s={patch:t.serialize()}:t instanceof yd||t instanceof vd?s=t.serialize():s=t;const i=Array.isArray(s)?s:[s],a=r&&r.transactionId||void 0;return Ri(n,e,"mutate",{mutations:i,transactionId:a},r)}function mt(n,e,t,r){const s=Array.isArray(t)?t:[t],i=r&&r.transactionId||void 0,a=r&&r.skipCrossDatasetReferenceValidation||void 0,l=r&&r.dryRun||void 0;return Ri(n,e,"actions",{actions:s,transactionId:i,skipCrossDatasetReferenceValidation:a,dryRun:l},r)}function Ri(n,e,t,r,s={}){const i=t==="mutate",a=t==="actions",l=t==="query",u=i||a?"":gT(r),d=!i&&!a&&u.length<e9,f=d?u:"",m=s.returnFirst,{timeout:g,token:x,tag:y,headers:w,returnQuery:b,lastLiveEventId:E,cacheMode:T}=s,_=qn(n,t,f),A={method:d?"GET":"POST",uri:_,json:!0,body:d?void 0:r,query:i&&Xj(s),timeout:g,headers:w,token:x,tag:y,returnQuery:b,perspective:s.perspective,resultSourceMap:s.resultSourceMap,lastLiveEventId:Array.isArray(E)?E[0]:E,cacheMode:T,canUseCdn:l,signal:s.signal,fetch:s.fetch,useAbortSignal:s.useAbortSignal,useCdn:s.useCdn};return kl(n,e,A).pipe(Ua(w0),tn(Zj),tn(I=>{if(!i)return I;const N=I.results||[];if(s.returnDocuments)return m?N[0]&&N[0].document:N.map(M=>M.document);const P=m?"documentId":"documentIds",O=m?N[0]&&N[0].id:N.map(M=>M.id);return{transactionId:I.transactionId,results:N,[P]:O}}))}function wd(n,e,t,r,s={}){const i={[r]:t},a=Object.assign({returnFirst:!0,returnDocuments:!0},s);return Ri(n,e,"mutate",{mutations:[i]},a)}const _l=n=>n.config().dataset!==void 0&&n.config().projectId!==void 0||n.config()["~experimental_resource"]!==void 0,IT=(n,e)=>_l(n)&&e.startsWith(qn(n,"query")),t9=(n,e)=>_l(n)&&e.startsWith(qn(n,"mutate")),n9=(n,e)=>_l(n)&&e.startsWith(qn(n,"doc","")),r9=(n,e)=>_l(n)&&e.startsWith(qn(n,"listen")),s9=(n,e)=>_l(n)&&e.startsWith(qn(n,"history","")),i9=(n,e)=>e.startsWith("/data/")||IT(n,e)||t9(n,e)||n9(n,e)||r9(n,e)||s9(n,e);function kl(n,e,t){const r=t.url||t.uri,s=n.config(),i=typeof t.canUseCdn>"u"?["GET","HEAD"].indexOf(t.method||"GET")>=0&&i9(n,r):t.canUseCdn;let a=(t.useCdn??s.useCdn)&&i;const l=t.tag&&s.requestTagPrefix?[s.requestTagPrefix,t.tag].join("."):t.tag||s.requestTagPrefix;if(l&&t.tag!==null&&(t.query={tag:aT(l),...t.query}),["GET","HEAD","POST"].indexOf(t.method||"GET")>=0&&IT(n,r)){const f=t.resultSourceMap??s.resultSourceMap;f!==void 0&&f!==!1&&(t.query={resultSourceMap:f,...t.query});const m=t.perspective||s.perspective;typeof m<"u"&&(m==="previewDrafts"&&Pj(),lT(m),t.query={perspective:Array.isArray(m)?m.join(","):m,...t.query},(Array.isArray(m)&&m.length>0||m==="previewDrafts"||m==="drafts")&&a&&(a=!1,Rj())),t.lastLiveEventId&&(t.query={...t.query,lastLiveEventId:t.lastLiveEventId}),t.returnQuery===!1&&(t.query={returnQuery:"false",...t.query}),a&&t.cacheMode=="noStale"&&(t.query={cacheMode:"noStale",...t.query})}const u=Yj(s,Object.assign({},t,{url:b0(n,r,a)})),d=new St(f=>e(u,s.requester).subscribe(f));return t.signal?d.pipe(a9(t.signal)):d}function qt(n,e,t){return kl(n,e,t).pipe(Ua(r=>r.type==="response"),tn(r=>r.body))}function qn(n,e,t){const r=n.config();if(r["~experimental_resource"]){oT(r);const a=c9(r),l=t!==void 0?`${e}/${t}`:e;return`${a}/${l}`.replace(/\/($|\?)/,"$1")}const s=Li(r),i=`/${e}/${s}`;return`/data${t!==void 0?`${i}/${t}`:i}`.replace(/\/($|\?)/,"$1")}function b0(n,e,t=!1){const{url:r,cdnUrl:s}=n.config();return`${t?s:r}/${e.replace(/^\//,"")}`}function a9(n){return e=>new St(t=>{const r=()=>t.error(l9(n));if(n&&n.aborted){r();return}const s=e.subscribe(t);return n.addEventListener("abort",r),()=>{n.removeEventListener("abort",r),s.unsubscribe()}})}const o9=!!globalThis.DOMException;function l9(n){if(o9)return new DOMException(n?.reason??"The operation was aborted.","AbortError");const e=new Error(n?.reason??"The operation was aborted.");return e.name="AbortError",e}const c9=n=>{if(!n["~experimental_resource"])throw new Error("`resource` must be provided to perform resource queries");const{type:e,id:t}=n["~experimental_resource"];switch(e){case"dataset":{const r=t.split(".");if(r.length!==2)throw new Error('Dataset ID must be in the format "project.dataset"');return`/projects/${r[0]}/datasets/${r[1]}`}case"canvas":return`/canvases/${t}`;case"media-library":return`/media-libraries/${t}`;case"dashboard":return`/dashboards/${t}`;default:throw new Error(`Unsupported resource type: ${e.toString()}`)}};function LT(n,e,t){const r=Li(n.config());return qt(n,e,{method:"POST",uri:`/agent/action/generate/${r}`,body:t})}function u9(n,e,t){const r=Li(n.config());return qt(n,e,{method:"POST",uri:`/agent/action/patch/${r}`,body:t})}function d9(n,e,t){const r=Li(n.config());return qt(n,e,{method:"POST",uri:`/agent/action/prompt/${r}`,body:t})}function RT(n,e,t){const r=Li(n.config());return qt(n,e,{method:"POST",uri:`/agent/action/transform/${r}`,body:t})}function PT(n,e,t){const r=Li(n.config());return qt(n,e,{method:"POST",uri:`/agent/action/translate/${r}`,body:t})}class f9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}generate(e){return LT(this.#t,this.#e,e)}transform(e){return RT(this.#t,this.#e,e)}translate(e){return PT(this.#t,this.#e,e)}}class h9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}generate(e){return He(LT(this.#t,this.#e,e))}transform(e){return He(RT(this.#t,this.#e,e))}translate(e){return He(PT(this.#t,this.#e,e))}prompt(e){return He(d9(this.#t,this.#e,e))}patch(e){return He(u9(this.#t,this.#e,e))}}class m9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}upload(e,t,r){return DT(this.#t,this.#e,e,t,r)}}class p9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}upload(e,t,r){const s=DT(this.#t,this.#e,e,t,r);return He(s.pipe(Ua(i=>i.type==="response"),tn(i=>i.body.document)))}}function DT(n,e,t,r,s={}){Tj(t);let i=s.extract||void 0;i&&!i.length&&(i=["none"]);const a=n.config(),l=x9(s,r),{tag:u,label:d,title:f,description:m,creditLine:g,filename:x,source:y}=l,w={label:d,title:f,description:m,filename:x,meta:i,creditLine:g};return y&&(w.sourceId=y.id,w.sourceName=y.name,w.sourceUrl=y.url),kl(n,e,{tag:u,method:"POST",timeout:l.timeout||0,uri:g9(a,t),headers:l.contentType?{"Content-Type":l.contentType}:{},query:w,body:r})}function g9(n,e){const t=e==="image"?"images":"files";if(n["~experimental_resource"]){const{type:s,id:i}=n["~experimental_resource"];switch(s){case"dataset":throw new Error("Assets are not supported for dataset resources, yet. Configure the client with `{projectId: <projectId>, dataset: <datasetId>}` instead.");case"canvas":return`/canvases/${i}/assets/${t}`;case"media-library":return`/media-libraries/${i}/upload`;case"dashboard":return`/dashboards/${i}/assets/${t}`;default:throw new Error(`Unsupported resource type: ${s.toString()}`)}}const r=Li(n);return`assets/${t}/${r}`}function x9(n,e){return typeof File>"u"||!(e instanceof File)?n:Object.assign({filename:n.preserveFilename===!1?void 0:e.name,contentType:e.type},n)}var y9=(n,e)=>Object.keys(e).concat(Object.keys(n)).reduce((t,r)=>(t[r]=typeof n[r]>"u"?e[r]:n[r],t),{});const v9=(n,e)=>e.reduce((t,r)=>(typeof n[r]>"u"||(t[r]=n[r]),t),{}),NT=KE(()=>xE(()=>import("./browser-CbDzLJli.js").then(n=>n.b),[])).pipe(tn(({default:n})=>n),J6(1));function jT(){return function(n){return n.pipe(Ku((e,t)=>e instanceof uT?W6(Sa({type:"reconnect"}),q6(1e3).pipe(Ei(()=>t))):VE(()=>e)))}}const w9=14800,b9=["includePreviousRevision","includeResult","includeMutations","includeAllVersions","visibility","effectFormat","tag"],S9={includeResult:!0};function OT(n,e,t={}){const{url:r,token:s,withCredentials:i,requestTagPrefix:a,headers:l}=this.config(),u=t.tag&&a?[a,t.tag].join("."):t.tag,d={...y9(t,S9),tag:u},f=v9(d,b9),m=gT({query:n,params:e,options:{tag:u,...f}}),g=`${r}${qn(this,"listen",m)}`;if(g.length>w9)return VE(()=>new Error("Query too large for listener"));const x=d.events?d.events:["mutation"],y={};return i&&(y.withCredentials=!0),(s||l)&&(y.headers={},s&&(y.headers.Authorization=`Bearer ${s}`),l&&Object.assign(y.headers,l)),dT(()=>(typeof EventSource>"u"||y.headers?NT:Sa(EventSource)).pipe(tn(w=>new w(g,y))),x).pipe(jT(),Ua(w=>x.includes(w.type)),tn(w=>({type:w.type,..."data"in w?w.data:{}})))}function E9(n,e){return T9(typeof n=="function"?{predicate:n,...e}:n)}function T9(n){return e=>{let t,r=!1;const{predicate:s,...i}=n,a=e.pipe(ej(u=>{n.predicate(u)&&(r=!0,t=u)}),WE(()=>{r=!1,t=void 0}),qE(i)),l=new St(u=>{r&&u.next(t),u.complete()});return Y6(a,l)}}const s2="2021-03-25";class MT{#t;constructor(e){this.#t=e}events({includeDrafts:e=!1,tag:t}={}){yi("live",this.#t.config());const{projectId:r,apiVersion:s,token:i,withCredentials:a,requestTagPrefix:l,headers:u}=this.#t.config(),d=s.replace(/^v/,"");if(d!=="X"&&d<s2)throw new Error(`The live events API requires API version ${s2} or later. The current API version is ${d}. Please update your API version to use this feature.`);if(e&&!i&&!a)throw new Error("The live events API requires a token or withCredentials when 'includeDrafts: true'. Please update your client configuration. The token should have the lowest possible access role.");const f=qn(this.#t,"live/events"),m=new URL(this.#t.getUrl(f,!1)),g=t&&l?[l,t].join("."):t;g&&m.searchParams.set("tag",g),e&&m.searchParams.set("includeDrafts","true");const x={};e&&a&&(x.withCredentials=!0),(e&&i||u)&&(x.headers={},e&&i&&(x.headers.Authorization=`Bearer ${i}`),u&&Object.assign(x.headers,u));const y=`${m.href}::${JSON.stringify(x)}`,w=rm.get(y);if(w)return w;const b=dT(()=>(typeof EventSource>"u"||x.headers?NT:Sa(EventSource)).pipe(tn(_=>new _(m.href,x))),["message","restart","welcome","reconnect","goaway"]),E=_9(m,{method:"OPTIONS",mode:"cors",credentials:x.withCredentials?"include":"omit",headers:x.headers}).pipe(Ku(()=>{throw new yj({projectId:r})})),T=b.pipe(jT(),Ei(_=>_.type==="reconnect"?E.pipe(Ei(()=>Sa(_))):Sa(_)),Ku(_=>E.pipe(Ei(()=>{throw _}))),tn(_=>{if(_.type==="message"){const{data:A,...I}=_;return{...I,tags:A.tags}}return _})).pipe(WE(()=>rm.delete(y)),E9({predicate:_=>_.type==="welcome"}));return rm.set(y,T),T}}function _9(n,e){return new St(t=>{const r=new AbortController,s=r.signal;return fetch(n,{...e,signal:r.signal}).then(i=>{t.next(i),t.complete()},i=>{s.aborted||t.error(i)}),()=>r.abort()})}const rm=new Map;class k9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}create(e,t){return Ea(this.#t,this.#e,"PUT",e,t)}edit(e,t){return Ea(this.#t,this.#e,"PATCH",e,t)}delete(e){return Ea(this.#t,this.#e,"DELETE",e)}list(){yi("dataset",this.#t.config());const e=this.#t.config(),t=e.projectId;let r="/datasets";return e.useProjectHostname===!1&&(r=`/projects/${t}/datasets`),qt(this.#t,this.#e,{uri:r,tag:null})}}class C9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}create(e,t){return yi("dataset",this.#t.config()),He(Ea(this.#t,this.#e,"PUT",e,t))}edit(e,t){return yi("dataset",this.#t.config()),He(Ea(this.#t,this.#e,"PATCH",e,t))}delete(e){return yi("dataset",this.#t.config()),He(Ea(this.#t,this.#e,"DELETE",e))}list(){yi("dataset",this.#t.config());const e=this.#t.config(),t=e.projectId;let r="/datasets";return e.useProjectHostname===!1&&(r=`/projects/${t}/datasets`),He(qt(this.#t,this.#e,{uri:r,tag:null}))}}function Ea(n,e,t,r,s){return yi("dataset",n.config()),sT(r),qt(n,e,{method:t,uri:`/datasets/${r}`,body:s,tag:null})}class FT{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getPlaybackInfo(e,t={}){const r=this.#t.config()["~experimental_resource"]?.id,{instanceId:s,libraryId:i}=R9(e),a=i||r;if(!a)throw new Error("Could not determine Media Library ID - you need to provide a valid Media Library ID in the client config or a Media Library GDR");const l=P9(s,a),u=D9(t);return qt(this.#t,this.#e,{method:"GET",uri:l,query:u})}}class A9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getPlaybackInfo(e,t={}){return He(new FT(this.#t.observable,this.#e).getPlaybackInfo(e,t))}}const I9=/^media-library:(ml[^:]+):([^:]+)$/;function L9(n){return typeof n=="object"&&"_ref"in n}function R9(n){const e=L9(n)?n._ref:n,t=I9.exec(e);if(t){const[,r,s]=t;return{libraryId:r,instanceId:s}}if(typeof n=="string"&&n.startsWith("video-"))return{instanceId:n};throw new Error(`Invalid video asset instance identifier "${e}": must be a valid video instance id or a Global Dataset Reference (GDR) to the video asset in the Media Library`)}function P9(n,e){return`/media-libraries/${e}/video/${n}/playback-info`}function D9(n){const e={};if(n.transformations){const{thumbnail:t,animated:r,storyboard:s}=n.transformations;t&&(t.width&&(e.thumbnailWidth=t.width),t.height&&(e.thumbnailHeight=t.height),t.time!==void 0&&(e.thumbnailTime=t.time),t.fit&&(e.thumbnailFit=t.fit),t.format&&(e.thumbnailFormat=t.format)),r&&(r.width&&(e.animatedWidth=r.width),r.height&&(e.animatedHeight=r.height),r.start!==void 0&&(e.animatedStart=r.start),r.end!==void 0&&(e.animatedEnd=r.end),r.fps&&(e.animatedFps=r.fps),r.format&&(e.animatedFormat=r.format)),s&&s.format&&(e.storyboardFormat=s.format)}return n.expiration&&(e.expiration=n.expiration),e}class N9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}list(e){const t={},r="/projects";return e?.includeMembers===!1&&(t.includeMembers="false"),e?.organizationId&&(t.organizationId=e.organizationId),qt(this.#t,this.#e,{uri:r,query:t})}getById(e){return qt(this.#t,this.#e,{uri:`/projects/${e}`})}}class j9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}list(e){const t={},r="/projects";return e?.includeMembers===!1&&(t.includeMembers="false"),e?.organizationId&&(t.organizationId=e.organizationId),He(qt(this.#t,this.#e,{uri:r,query:t}))}getById(e){return He(qt(this.#t,this.#e,{uri:`/projects/${e}`}))}}const i2=cj("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",8),qu=(n,e)=>e?Tl(n,e):JE(n);function Yu(n,{releaseId:e,publishedId:t,document:r}){if(t&&r._id){const s=qu(t,e);return kj(s,r),s}if(r._id){const s=pd(r._id),i=gd(r._id);if(!s&&!i)throw new Error(`\`${n}()\` requires a document with an \`_id\` that is a version or draft ID`);if(e){if(s)throw new Error(`\`${n}()\` was called with a document ID (\`${r._id}\`) that is a draft ID, but a release ID (\`${e}\`) was also provided.`);const a=eT(r._id);if(a!==e)throw new Error(`\`${n}()\` was called with a document ID (\`${r._id}\`) that is a version ID, but the release ID (\`${e}\`) does not match the document's version ID (\`${a}\`).`)}return r._id}if(t)return qu(t,e);throw new Error(`\`${n}()\` requires either a publishedId or a document with an \`_id\``)}const O9=(n,e)=>{if(typeof n=="object"&&n!==null&&("releaseId"in n||"metadata"in n)){const{releaseId:t=i2(),metadata:r={}}=n;return[t,r,e]}return[i2(),{},n]},BT=(n,e)=>{const[t,r,s]=O9(n,e),i={...r,releaseType:r.releaseType||"undecided"};return{action:{actionType:"sanity.action.release.create",releaseId:t,metadata:i},options:s}};class M9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}get({releaseId:e},t){return Na(this.#t,this.#e,`_.releases.${e}`,t)}create(e,t){const{action:r,options:s}=BT(e,t),{releaseId:i,metadata:a}=r;return mt(this.#t,this.#e,r,s).pipe(tn(l=>({...l,releaseId:i,metadata:a})))}edit({releaseId:e,patch:t},r){const s={actionType:"sanity.action.release.edit",releaseId:e,patch:t};return mt(this.#t,this.#e,s,r)}publish({releaseId:e},t){const r={actionType:"sanity.action.release.publish",releaseId:e};return mt(this.#t,this.#e,r,t)}archive({releaseId:e},t){const r={actionType:"sanity.action.release.archive",releaseId:e};return mt(this.#t,this.#e,r,t)}unarchive({releaseId:e},t){const r={actionType:"sanity.action.release.unarchive",releaseId:e};return mt(this.#t,this.#e,r,t)}schedule({releaseId:e,publishAt:t},r){const s={actionType:"sanity.action.release.schedule",releaseId:e,publishAt:t};return mt(this.#t,this.#e,s,r)}unschedule({releaseId:e},t){const r={actionType:"sanity.action.release.unschedule",releaseId:e};return mt(this.#t,this.#e,r,t)}delete({releaseId:e},t){const r={actionType:"sanity.action.release.delete",releaseId:e};return mt(this.#t,this.#e,r,t)}fetchDocuments({releaseId:e},t){return vT(this.#t,this.#e,e,t)}}class F9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}get({releaseId:e},t){return He(Na(this.#t,this.#e,`_.releases.${e}`,t))}async create(e,t){const{action:r,options:s}=BT(e,t),{releaseId:i,metadata:a}=r;return{...await He(mt(this.#t,this.#e,r,s)),releaseId:i,metadata:a}}edit({releaseId:e,patch:t},r){const s={actionType:"sanity.action.release.edit",releaseId:e,patch:t};return He(mt(this.#t,this.#e,s,r))}publish({releaseId:e},t){const r={actionType:"sanity.action.release.publish",releaseId:e};return He(mt(this.#t,this.#e,r,t))}archive({releaseId:e},t){const r={actionType:"sanity.action.release.archive",releaseId:e};return He(mt(this.#t,this.#e,r,t))}unarchive({releaseId:e},t){const r={actionType:"sanity.action.release.unarchive",releaseId:e};return He(mt(this.#t,this.#e,r,t))}schedule({releaseId:e,publishAt:t},r){const s={actionType:"sanity.action.release.schedule",releaseId:e,publishAt:t};return He(mt(this.#t,this.#e,s,r))}unschedule({releaseId:e},t){const r={actionType:"sanity.action.release.unschedule",releaseId:e};return He(mt(this.#t,this.#e,r,t))}delete({releaseId:e},t){const r={actionType:"sanity.action.release.delete",releaseId:e};return He(mt(this.#t,this.#e,r,t))}fetchDocuments({releaseId:e},t){return He(vT(this.#t,this.#e,e,t))}}class B9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getById(e){return qt(this.#t,this.#e,{uri:`/users/${e}`})}}class U9{#t;#e;constructor(e,t){this.#t=e,this.#e=t}getById(e){return He(qt(this.#t,this.#e,{uri:`/users/${e}`}))}}class Qu{assets;datasets;live;mediaLibrary;projects;users;agent;releases;#t;#e;listen=OT;constructor(e,t=qo){this.config(t),this.#e=e,this.assets=new m9(this,this.#e),this.datasets=new k9(this,this.#e),this.live=new MT(this),this.mediaLibrary={video:new FT(this,this.#e)},this.projects=new N9(this,this.#e),this.users=new B9(this,this.#e),this.agent={action:new f9(this,this.#e)},this.releases=new M9(this,this.#e)}clone(){return new Qu(this.#e,this.config())}config(e){if(e===void 0)return{...this.#t};if(this.#t&&this.#t.allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.#t=cT(e,this.#t||{}),this}withConfig(e){const t=this.config();return new Qu(this.#e,{...t,...e,stega:{...t.stega||{},...typeof e?.stega=="boolean"?{enabled:e.stega}:e?.stega||{}}})}fetch(e,t,r){return xT(this,this.#e,this.#t.stega,e,t,r)}getDocument(e,t){if(t?.includeAllVersions===!0)return Na(this,this.#e,e,{...t,includeAllVersions:!0});const r={signal:t?.signal,tag:t?.tag,releaseId:t?.releaseId,...t&&"includeAllVersions"in t?{includeAllVersions:!1}:{}};return Na(this,this.#e,e,r)}getDocuments(e,t){return yT(this,this.#e,e,t)}create(e,t){return wd(this,this.#e,e,"create",t)}createIfNotExists(e,t){return wT(this,this.#e,e,t)}createOrReplace(e,t){return bT(this,this.#e,e,t)}createVersion({document:e,publishedId:t,releaseId:r,baseId:s,ifBaseRevisionId:i},a){if(!e)return ET(this,this.#e,t,s,r,i,a);const l=Yu("createVersion",{document:e,publishedId:t,releaseId:r}),u={...e,_id:l},d=t||xd(e._id);return ST(this,this.#e,u,d,a)}delete(e,t){return TT(this,this.#e,e,t)}discardVersion({releaseId:e,publishedId:t},r,s){const i=qu(t,e);return _T(this,this.#e,i,r,s)}replaceVersion({document:e,publishedId:t,releaseId:r},s){const i=Yu("replaceVersion",{document:e,publishedId:t,releaseId:r}),a={...e,_id:i};return kT(this,this.#e,a,s)}unpublishVersion({releaseId:e,publishedId:t},r){const s=Tl(t,e);return CT(this,this.#e,s,t,r)}mutate(e,t){return AT(this,this.#e,e,t)}patch(e,t){return new Ti(e,t,this)}transaction(e){return new vd(e,this)}action(e,t){return mt(this,this.#e,e,t)}request(e){return qt(this,this.#e,e)}getUrl(e,t){return b0(this,e,t)}getDataUrl(e,t){return qn(this,e,t)}}class Xu{assets;datasets;live;mediaLibrary;projects;users;agent;releases;observable;#t;#e;listen=OT;constructor(e,t=qo){this.config(t),this.#e=e,this.assets=new p9(this,this.#e),this.datasets=new C9(this,this.#e),this.live=new MT(this),this.mediaLibrary={video:new A9(this,this.#e)},this.projects=new j9(this,this.#e),this.users=new U9(this,this.#e),this.agent={action:new h9(this,this.#e)},this.releases=new F9(this,this.#e),this.observable=new Qu(e,t)}clone(){return new Xu(this.#e,this.config())}config(e){if(e===void 0)return{...this.#t};if(this.#t&&this.#t.allowReconfigure===!1)throw new Error("Existing client instance cannot be reconfigured - use `withConfig(newConfig)` to return a new client");return this.observable&&this.observable.config(e),this.#t=cT(e,this.#t||{}),this}withConfig(e){const t=this.config();return new Xu(this.#e,{...t,...e,stega:{...t.stega||{},...typeof e?.stega=="boolean"?{enabled:e.stega}:e?.stega||{}}})}fetch(e,t,r){return He(xT(this,this.#e,this.#t.stega,e,t,r))}getDocument(e,t){if(t?.includeAllVersions===!0)return He(Na(this,this.#e,e,{...t,includeAllVersions:!0}));const r={signal:t?.signal,tag:t?.tag,releaseId:t?.releaseId,...t&&"includeAllVersions"in t?{includeAllVersions:!1}:{}};return He(Na(this,this.#e,e,r))}getDocuments(e,t){return He(yT(this,this.#e,e,t))}create(e,t){return He(wd(this,this.#e,e,"create",t))}createIfNotExists(e,t){return He(wT(this,this.#e,e,t))}createOrReplace(e,t){return He(bT(this,this.#e,e,t))}createVersion({document:e,publishedId:t,releaseId:r,baseId:s,ifBaseRevisionId:i},a){if(!e)return Jh(ET(this,this.#e,t,s,r,i,a));const l=Yu("createVersion",{document:e,publishedId:t,releaseId:r}),u={...e,_id:l},d=t||xd(e._id);return Jh(ST(this,this.#e,u,d,a))}delete(e,t){return He(TT(this,this.#e,e,t))}discardVersion({releaseId:e,publishedId:t},r,s){const i=qu(t,e);return He(_T(this,this.#e,i,r,s))}replaceVersion({document:e,publishedId:t,releaseId:r},s){const i=Yu("replaceVersion",{document:e,publishedId:t,releaseId:r}),a={...e,_id:i};return Jh(kT(this,this.#e,a,s))}unpublishVersion({releaseId:e,publishedId:t},r){const s=Tl(t,e);return He(CT(this,this.#e,s,t,r))}mutate(e,t){return He(AT(this,this.#e,e,t))}patch(e,t){return new Ms(e,t,this)}transaction(e){return new yd(e,this)}action(e,t){return He(mt(this,this.#e,e,t))}request(e){return He(qt(this,this.#e,e))}dataRequest(e,t,r){return He(Ri(this,this.#e,e,t,r))}getUrl(e,t){return b0(this,e,t)}getDataUrl(e,t){return qn(this,e,t)}}function $9(n,e){return{requester:J1(n),createClient:t=>{const r=J1(n,{ignoreWarnings:t.ignoreWarnings});return new e((s,i)=>(i||r)({maxRedirects:0,maxRetries:t.maxRetries,retryDelay:t.retryDelay,lineage:t.lineage,...s}),t)}}}var V9=[];const G9=$9(V9,Xu),H9=G9.createClient,a2="image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg";function K9(n){const[,e,t,r]=n.split("-");if(!e||!t||!r)throw new Error(`Malformed asset _ref '${n}'. Expected an id like "${a2}".`);const[s,i]=t.split("x"),a=+s,l=+i;if(!(isFinite(a)&&isFinite(l)))throw new Error(`Malformed asset _ref '${n}'. Expected an id like "${a2}".`);return{id:e,width:a,height:l,format:r}}const z9=n=>{const e=n;return e?typeof e._ref=="string":!1},W9=n=>{const e=n;return e?typeof e._id=="string":!1},q9=n=>{const e=n;return e&&e.asset?typeof e.asset.url=="string":!1},Y9=n=>{if(typeof n=="object"&&n!==null){const e=n;return e._upload&&(!e.asset||!e.asset._ref)}return!1};function Q9(n){if(!n)return null;let e;if(typeof n=="string"&&X9(n))e={asset:{_ref:o2(n)}};else if(typeof n=="string")e={asset:{_ref:n}};else if(z9(n))e={asset:n};else if(W9(n))e={asset:{_ref:n._id||""}};else if(q9(n))e={asset:{_ref:o2(n.asset.url)}};else if(typeof n.asset=="object")e={...n};else return null;const t=n;return t.crop&&(e.crop=t.crop),t.hotspot&&(e.hotspot=t.hotspot),Z9(e)}function X9(n){return/^https?:\/\//.test(`${n}`)}function o2(n){return`image-${n.split("/").slice(-1)[0]}`.replace(/\.([a-z]+)$/,"-$1")}function Z9(n){if(n.crop&&n.hotspot)return n;const e={...n};return e.crop||(e.crop={left:0,top:0,bottom:0,right:0}),e.hotspot||(e.hotspot={x:.5,y:.5,height:1,width:1}),e}const UT=[["width","w"],["height","h"],["format","fm"],["download","dl"],["blur","blur"],["sharpen","sharp"],["invert","invert"],["orientation","or"],["minHeight","min-h"],["maxHeight","max-h"],["minWidth","min-w"],["maxWidth","max-w"],["quality","q"],["fit","fit"],["crop","crop"],["saturation","sat"],["auto","auto"],["dpr","dpr"],["pad","pad"],["frame","frame"]];function J9(n){let e={...n||{}};const t=e.source;delete e.source;const r=Q9(t);if(!r){if(t&&Y9(t))return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8HwQACfsD/QNViZkAAAAASUVORK5CYII=";throw new Error(`Unable to resolve image URL from source (${JSON.stringify(t)})`)}const s=r.asset._ref||r.asset._id||"",i=K9(s),a=Math.round(r.crop.left*i.width),l=Math.round(r.crop.top*i.height),u={left:a,top:l,width:Math.round(i.width-r.crop.right*i.width-a),height:Math.round(i.height-r.crop.bottom*i.height-l)},d=r.hotspot.height*i.height/2,f=r.hotspot.width*i.width/2,m=r.hotspot.x*i.width,g=r.hotspot.y*i.height,x={left:m-f,top:g-d,right:m+f,bottom:g+d};return e.rect||e.focalPoint||e.ignoreImageParams||e.crop||(e={...e,...tO({crop:u,hotspot:x},e)}),eO({...e,asset:i})}function eO(n){const e=(n.baseUrl||"https://cdn.sanity.io").replace(/\/+$/,""),t=n.vanityName?`/${n.vanityName}`:"",r=`${n.asset.id}-${n.asset.width}x${n.asset.height}.${n.asset.format}${t}`,s=n.mediaLibraryId?`${e}/media-libraries/${n.mediaLibraryId}/images/${r}`:`${e}/images/${n.projectId}/${n.dataset}/${r}`,i=[];if(n.rect){const{left:l,top:u,width:d,height:f}=n.rect;(l!==0||u!==0||f!==n.asset.height||d!==n.asset.width)&&i.push(`rect=${l},${u},${d},${f}`)}n.bg&&i.push(`bg=${n.bg}`),n.focalPoint&&(i.push(`fp-x=${n.focalPoint.x}`),i.push(`fp-y=${n.focalPoint.y}`));const a=[n.flipHorizontal&&"h",n.flipVertical&&"v"].filter(Boolean).join("");return a&&i.push(`flip=${a}`),UT.forEach(l=>{const[u,d]=l;typeof n[u]<"u"?i.push(`${d}=${encodeURIComponent(n[u])}`):typeof n[d]<"u"&&i.push(`${d}=${encodeURIComponent(n[d])}`)}),i.length===0?s:`${s}?${i.join("&")}`}function tO(n,e){let t;const r=e.width,s=e.height;if(!(r&&s))return{width:r,height:s,rect:n.crop};const i=n.crop,a=n.hotspot,l=r/s;if(i.width/i.height>l){const u=Math.round(i.height),d=Math.round(u*l),f=Math.max(0,Math.round(i.top)),m=Math.round((a.right-a.left)/2+a.left);let g=Math.max(0,Math.round(m-d/2));g<i.left?g=i.left:g+d>i.left+i.width&&(g=i.left+i.width-d),t={left:g,top:f,width:d,height:u}}else{const u=i.width,d=Math.round(u/l),f=Math.max(0,Math.round(i.left)),m=Math.round((a.bottom-a.top)/2+a.top);let g=Math.max(0,Math.round(m-d/2));g<i.top?g=i.top:g+d>i.top+i.height&&(g=i.top+i.height-d),t={left:f,top:g,width:u,height:d}}return{width:r,height:s,rect:t}}const nO=["clip","crop","fill","fillmax","max","scale","min"],rO=["top","bottom","left","right","center","focalpoint","entropy"],sO=["format"];function iO(n){return n&&"config"in n?typeof n.config=="function":!1}function aO(n){return n&&"clientConfig"in n?typeof n.clientConfig=="object":!1}function l2(n){const{apiHost:e,projectId:t,dataset:r}=n,s={baseUrl:(e||"https://api.sanity.io").replace(/^https:\/\/api\./,"https://cdn.")},i=n["~experimental_resource"];if(i?.type==="media-library"){if(typeof i.id!="string"||i.id.length===0)throw new Error('Media library clients must include an id in "~experimental_resource"');return{...s,mediaLibraryId:i.id}}return{...s,projectId:t,dataset:r}}function oO(n){const e=UT;for(const t of e){const[r,s]=t;if(n===r||n===s)return r}return n}function $T(n){let e={};return iO(n)?e=l2(n.config()):aO(n)?e=l2(n.clientConfig):e=n||{},e}function lO(n,e){const t=$T(e);return new n(null,t)}function cO(n){return lO(Zu,n)}function uO(n,e){const t=e.baseUrl||n.baseUrl,r={baseUrl:t};for(const s in e)if(e.hasOwnProperty(s)){const i=oO(s);r[i]=e[s]}return{baseUrl:t,...r}}class Zu{options;constructor(e,t){this.options=e?{...e.options||{},...t||{}}:{...t||{}}}withOptions(e){const t=uO(this.options,e);return new Zu(this,t)}image(e){return this.withOptions({source:e})}dataset(e){return this.withOptions({dataset:e})}projectId(e){return this.withOptions({projectId:e})}withClient(e){const t=$T(e),r={...this.options};return delete r.baseUrl,delete r.projectId,delete r.dataset,delete r.mediaLibraryId,new Zu(null,{...t,...r})}bg(e){return this.withOptions({bg:e})}dpr(e){return this.withOptions(e&&e!==1?{dpr:e}:{})}width(e){return this.withOptions({width:e})}height(e){return this.withOptions({height:e})}focalPoint(e,t){return this.withOptions({focalPoint:{x:e,y:t}})}maxWidth(e){return this.withOptions({maxWidth:e})}minWidth(e){return this.withOptions({minWidth:e})}maxHeight(e){return this.withOptions({maxHeight:e})}minHeight(e){return this.withOptions({minHeight:e})}size(e,t){return this.withOptions({width:e,height:t})}blur(e){return this.withOptions({blur:e})}sharpen(e){return this.withOptions({sharpen:e})}rect(e,t,r,s){return this.withOptions({rect:{left:e,top:t,width:r,height:s}})}format(e){return this.withOptions({format:e})}invert(e){return this.withOptions({invert:e})}orientation(e){return this.withOptions({orientation:e})}quality(e){return this.withOptions({quality:e})}forceDownload(e){return this.withOptions({download:e})}flipHorizontal(){return this.withOptions({flipHorizontal:!0})}flipVertical(){return this.withOptions({flipVertical:!0})}ignoreImageParams(){return this.withOptions({ignoreImageParams:!0})}fit(e){if(nO.indexOf(e)===-1)throw new Error(`Invalid fit mode "${e}"`);return this.withOptions({fit:e})}crop(e){if(rO.indexOf(e)===-1)throw new Error(`Invalid crop mode "${e}"`);return this.withOptions({crop:e})}saturation(e){return this.withOptions({saturation:e})}auto(e){if(sO.indexOf(e)===-1)throw new Error(`Invalid auto mode "${e}"`);return this.withOptions({auto:e})}pad(e){return this.withOptions({pad:e})}vanityName(e){return this.withOptions({vanityName:e})}frame(e){if(e!==1)throw new Error(`Invalid frame value "${e}"`);return this.withOptions({frame:e})}url(){return J9(this.options)}toString(){return this.url()}}function dO(n){let e=!1,t;return(...r)=>(e||(t=n(...r),e=!0),t)}const fO=n=>dO((...e)=>{console.warn(n.join(" "),...e)}),hO=fO(["The default export of @sanity/image-url has been deprecated. Use the named export `createImageUrlBuilder` instead."]);function mO(n){return function(e){return hO(),n(e)}}const pO=mO(cO),it=H9({projectId:"am3v0x1c",dataset:"production",apiVersion:"2026-01-06",useCdn:!1}),gO=pO(it);function ze(n){return gO.image(n)}const xO=`
  *[_type == "project"] | order(order asc) {
    _id,
    title,
    "slug": slug.current,
    company,
    year,
    shortDescription,
    logo,
    heroImage,
    heroVideo,
    isPublished
  }
`,VT=`
  *[_type == "artPiece" && isPublished == true] | order(year desc, order asc) {
    _id,
    title,
    artType,
    image,
    medium,
    size,
    year,
    description
  }
`,GT=`
  *[_type == "sketchbook" && isPublished == true] | order(order asc) {
    _id,
    title,
    sidebarLabel,
    date,
    description,
    images[] {
      _key,
      asset,
      caption
    }
  }
`,HT=`
  *[_type == "mural" && isPublished == true] | order(order asc) {
    _id,
    title,
    sidebarLabel,
    location,
    date,
    description,
    images[] {
      _key,
      asset,
      caption
    }
  }
`,KT=`
  *[_type == "project" && company == $company][0] {
    _id,
    title,
    "slug": slug.current,
    company,
    year,
    shortDescription,
    logo,
    heroImage,
    heroVideo,
    metadata[] {
      _key,
      label,
      value,
      subValue
    },
    content[] {
      _key,
      _type,
      ...
    },
    relatedProjects[]-> {
      _id,
      title,
      "slug": slug.current,
      company,
      year,
      shortDescription,
      heroImage
    }
  }
`,zT=`
  *[_type == "experience" && isPublished == true] | order(order asc) {
    _id,
    company,
    role,
    logo,
    period,
    description
  }
`,WT=`
  *[_type == "community" && isPublished == true] | order(order asc) {
    _id,
    title,
    sidebarName,
    logo,
    description,
    instagramUrl,
    photos[] {
      _key,
      image,
      caption,
      rotation,
      orientation,
      yOffset,
      xOffset
    }
  }
`,qT=`
  *[_type == "shelfItem" && isPublished == true] | order(isFeatured desc, order asc) {
    _id,
    title,
    mediaType,
    cover,
    externalCoverUrl,
    author,
    year,
    rating,
    isFeatured,
    goodreadsUrl,
    letterboxdSlug,
    spotifyUrl
  }
`,YT=`
  *[_type == "loreItem" && isPublished == true] | order(order asc) {
    _id,
    headline,
    image,
    imageBackground,
    date,
    description,
    link,
    fullStory
  }
`,QT=`
  *[_type == "aboutQuote" && isPublished == true] | order(order asc) {
    _id,
    emoji,
    title,
    text,
    underlinedText,
    author
  }
`,XT=`
  *[_type == "shelfItem" && isPublished == true && mediaType == "book"] | order(isLibraryFavorite desc, year desc, order asc) {
    _id,
    title,
    author,
    cover,
    externalCoverUrl,
    rating,
    year,
    isLibraryFavorite,
    goodreadsUrl,
    review,
    dateRead
  }
`,ZT=`
  array::unique(*[_type == "shelfItem" && isPublished == true && mediaType == "book" && year != null].year) | order(@ desc)
`,yO=`
  *[_type == "experimentProject" && isPublished == true] | order(order asc) {
    _id,
    projectId,
    title,
    year,
    description,
    muxPlaybackId,
    xLink,
    tryItOutHref,
    toolCategories[] {
      label,
      tools
    }
  }
`,vO=`
  *[_type == "experimentProject" && projectId == $projectId][0] {
    _id,
    projectId,
    title,
    year,
    description,
    muxPlaybackId,
    xLink,
    tryItOutHref,
    toolCategories[] {
      label,
      tools
    }
  }
`,JT=new Map,wO=300*1e3;let sm=!1;function Ye(n){const e=JT.get(n);return e&&Date.now()-e.timestamp<wO?e.data:null}function cr(n,e){JT.set(n,{data:e,timestamp:Date.now()})}async function au(n){const e=`project:${n}`;if(!Ye(e))try{const t=await it.fetch(KT,{company:n});t&&cr(e,t)}catch(t){console.warn(`Failed to preload project ${n}:`,t)}}async function bO(){const n="art:pieces",e="art:sketchbooks",t="art:murals";if(!(Ye(n)&&Ye(e)&&Ye(t)))try{const[r,s,i]=await Promise.all([Ye(n)?Promise.resolve(null):it.fetch(VT),Ye(e)?Promise.resolve(null):it.fetch(GT),Ye(t)?Promise.resolve(null):it.fetch(HT)]);r&&cr(n,r),s&&cr(e,s),i&&cr(t,i)}catch(r){console.warn("Failed to preload art page:",r)}}async function SO(){const n={experiences:"about:experiences",communities:"about:communities",shelfItems:"about:shelfItems",quotes:"about:quotes",loreItems:"about:loreItems"};if(!(Ye(n.experiences)&&Ye(n.communities)&&Ye(n.shelfItems)&&Ye(n.quotes)&&Ye(n.loreItems)))try{const[e,t,r,s,i]=await Promise.all([Ye(n.experiences)?Promise.resolve(null):it.fetch(zT),Ye(n.communities)?Promise.resolve(null):it.fetch(WT),Ye(n.shelfItems)?Promise.resolve(null):it.fetch(qT),Ye(n.quotes)?Promise.resolve(null):it.fetch(QT),Ye(n.loreItems)?Promise.resolve(null):it.fetch(YT)]);e&&cr(n.experiences,e),t&&cr(n.communities,t),r&&cr(n.shelfItems,r),s&&cr(n.quotes,s),i&&cr(n.loreItems,i)}catch(e){console.warn("Failed to preload about page:",e)}}async function EO(){const n={books:"library:books",years:"library:years"};if(!(Ye(n.books)&&Ye(n.years)))try{const[e,t]=await Promise.all([Ye(n.books)?Promise.resolve(null):it.fetch(XT),Ye(n.years)?Promise.resolve(null):it.fetch(ZT)]);e&&cr(n.books,e),t&&cr(n.years,t)}catch(e){console.warn("Failed to preload library page:",e)}}function TO(){if(sm)return;sm=!0;const n=async()=>{await Promise.all([au("apple"),au("roblox"),au("adobe"),au("nasa"),bO(),SO(),EO()]),sm=!1};"requestIdleCallback"in window?requestIdleCallback(()=>n(),{timeout:3e3}):setTimeout(n,1e3)}function _O({card:n}){return h.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-6 py-12",children:[h.jsxs("div",{className:"flex flex-col gap-3",children:[n.label&&h.jsx("p",{className:"text-[#9ca3af] text-sm font-normal tracking-wide uppercase",children:n.label}),h.jsxs("p",{className:"text-xl font-normal text-[#111827]",children:[n.emoji&&h.jsx("span",{className:"mr-2",children:n.emoji}),n.title]})]}),n.image&&h.jsx("div",{className:"relative flex-shrink-0 w-full md:w-[340px] lg:w-[390px] rounded-[26px] overflow-hidden",children:h.jsx("img",{src:ze(n.image).width(780).url(),alt:n.title,className:"w-full h-auto object-cover rounded-[26px]"})})]})}function kO({cards:n}){return!n||n.length===0?null:h.jsx("div",{className:"flex flex-col px-8 md:px-[8%] xl:px-[175px] py-8",children:n.map(e=>h.jsx(_O,{card:e},e._key))})}let Yo=0,da=null;function CO(){Yo++,Yo===1&&(da={htmlOverflow:document.documentElement.style.overflow,bodyOverflow:document.body.style.overflow,scrollbarGutter:document.documentElement.style.scrollbarGutter},document.documentElement.style.scrollbarGutter="stable",document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden")}function AO(){Yo>0&&Yo--,Yo===0&&da&&(document.documentElement.style.overflow=da.htmlOverflow,document.body.style.overflow=da.bodyOverflow,document.documentElement.style.scrollbarGutter=da.scrollbarGutter,da=null)}function $a(n=!0){L.useEffect(()=>{if(n)return CO(),()=>{AO()}},[n])}function IO(n,e,t){if(!e)return n;const r=n.toLowerCase(),s=e.toLowerCase(),i=r.indexOf(s);if(i===-1)return n;const a=n.substring(0,i),l=n.substring(i,i+e.length),u=n.substring(i+e.length),d=t||"#3b82f6";return h.jsxs(h.Fragment,{children:[a,h.jsx("span",{style:{color:d},children:l}),u]})}function LO({label:n,title:e,highlightedText:t,highlightColor:r,subtitle:s,image:i,imageCaption:a,teamLabel:l,teamMembers:u,description:d}){const[f,m]=L.useState(!1);return $a(f),L.useEffect(()=>{const g=x=>{x.key==="Escape"&&f&&m(!1)};return f&&document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}},[f]),h.jsxs("div",{className:"px-8 md:px-[8%] xl:px-[175px] py-16 w-full",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_2fr] gap-12 md:gap-0",children:[h.jsxs("div",{className:"flex flex-col gap-12 md:col-start-1",children:[h.jsxs("div",{className:"flex flex-col",children:[n&&h.jsx("p",{className:"text-[#9ca3af] text-base pb-2",children:n}),e&&h.jsx("h3",{className:"text-2xl text-black",children:IO(e,t,r)}),s&&h.jsx("p",{className:"text-gray-500 text-xl",children:s})]}),i&&h.jsx("div",{className:"mt-8",children:h.jsx("div",{className:"relative inline-block transform -rotate-2 transition-transform hover:rotate-0 duration-300 cursor-pointer",onClick:()=>m(!0),children:h.jsx("img",{src:ze(i).width(600).url(),alt:e,className:"w-full max-w-[320px] h-auto rounded-lg"})})})]}),h.jsxs("div",{className:"flex flex-col gap-16 md:col-start-3",children:[u&&u.length>0&&h.jsxs("div",{className:"flex flex-col gap-2",children:[l&&h.jsx("p",{className:"text-[#9ca3af] text-base",children:l}),h.jsx("div",{className:"flex flex-col",children:u.map(g=>h.jsx("div",{children:g.link?h.jsx("a",{href:g.link,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 underline decoration-white underline-offset-2 hover:decoration-gray-300 transition-colors transition-100ms",children:g.name}):h.jsx("span",{className:"text-gray-500  underline decoration-[#d1d5db] underline-offset-2",children:g.name})},g._key))})]}),d&&d.length>0&&h.jsx("div",{className:"leading-normal text-gray-700 prose prose-p:my-4 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:d,components:{block:{normal:({children:g})=>h.jsx("p",{className:"mb-4 last:mb-0",children:g})},hardBreak:()=>h.jsx("br",{}),marks:{link:({value:g,children:x})=>h.jsx("a",{href:g?.href,target:"_blank",rel:"noopener noreferrer",className:"underline hover:opacity-70",children:x})}}})})]})]}),f&&i&&Mp.createPortal(h.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-[fadeIn_200ms_ease-out]",onClick:()=>m(!1),children:[h.jsx("div",{className:"absolute inset-0 bg-gray-100/95"}),h.jsx("button",{onClick:g=>{g.stopPropagation(),m(!1)},className:"fixed right-4 top-4 z-[10000] flex h-10 w-10 items-center justify-center transition-all duration-200 hover:scale-110 animate-[fadeSlideDown_300ms_ease-out]","aria-label":"Close expanded image",children:h.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M1 1L13 13M1 13L13 1",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round"})})}),h.jsxs("div",{className:"relative z-10 flex max-h-[85vh] max-w-[90vw] flex-col items-center animate-[scaleIn_300ms_ease-out]",onClick:g=>g.stopPropagation(),children:[h.jsx("img",{src:ze(i).width(1200).url(),alt:e,className:"max-h-[70vh] w-auto object-contain"}),a&&h.jsx("p",{className:"mt-6 max-w-[600px] text-center font-['DM_Sans'] text-base font-normal leading-relaxed text-gray-600 animate-[fadeSlideUp_300ms_ease-out_100ms_both]",style:{fontVariationSettings:"'opsz' 9"},children:a})]})]}),document.body)]})}function RO({section:n,renderHighlightedText:e,portableTextComponents:t}){const r=n.leftImageUrl?n.leftImageUrl:n.leftImage?ze(n.leftImage).width(800).url():null,s=n.rightImageUrl?n.rightImageUrl:n.rightImage?ze(n.rightImage).width(1200).url():null,a={small:"gap-12",medium:"gap-16",large:"gap-20"}[n.imageGap||"medium"],l={small:"w-1/5",medium:"w-2/5",large:"w-3/5"},u=l[n.leftImageSize||"medium"],d=l[n.rightImageSize||"large"],m={small:"w-4/5",medium:"w-3/5",large:"w-2/5"}[n.rightImageSize||"large"],g=n.layout!=="text-right",x=n.layout==="three-column",y=n.layout==="two-images";return h.jsx("div",{className:"content-stretch flex flex-col items-start justify-between px-8 md:px-[8%] xl:px-[175px] py-16 relative shrink-0 w-full",style:{backgroundColor:n.backgroundColor||"transparent"},children:y?h.jsxs("div",{className:J("flex flex-row w-full justify-center max-md:flex-col items-center",a),children:[r&&h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsx("div",{className:J("overflow-hidden h-60 flex items-center justify-center",n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:J("max-w-full max-h-full object-contain",n.rounded!==!1&&"rounded-[26px]"),alt:"",src:r})}),n.leftImageCaption&&h.jsx("p",{className:"text-sm text-center text-gray-500",children:n.leftImageCaption})]}),s&&h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsx("div",{className:J("overflow-hidden h-60 flex items-center justify-center max-md:h-auto",n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:J("max-w-full max-h-full object-contain",n.rounded!==!1&&"rounded-[26px]"),alt:"",src:s})}),n.rightImageCaption&&h.jsx("p",{className:"text-sm text-center text-gray-500",children:n.rightImageCaption})]})]}):x?h.jsxs("div",{className:J("flex w-full justify-center max-md:flex-col items-center gap-20",a),children:[r&&h.jsxs("div",{className:J("flex flex-col gap-3",u),children:[h.jsx("div",{className:J("overflow-hidden w-full h-60 flex items-center justify-center",n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:"max-w-full max-h-full object-contain",alt:"",src:r})}),n.leftImageCaption&&h.jsx("p",{className:"text-sm text-center text-gray-500",children:n.leftImageCaption})]}),h.jsxs("div",{className:J(m,"max-md:w-full shrink-0 flex flex-col justify-center gap-12"),children:[(n.label||n.heading)&&h.jsxs("div",{className:"flex flex-col gap-3",children:[n.label&&h.jsx("p",{className:"leading-5 uppercase text-[#9ca3af] text-base",children:n.label}),n.heading&&h.jsx("h3",{className:"leading-normal text-2xl text-black whitespace-pre-wrap",children:e(n.heading,n.highlightedText,n.highlightColor)})]}),n.description&&n.description.length>0&&h.jsx("div",{className:"leading-normal pb-1 text-[#4b5563] text-base whitespace-pre-wrap prose prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:n.description,components:t})})]}),s&&h.jsxs("div",{className:J("flex flex-col gap-3",d),children:[h.jsx("div",{className:J("overflow-hidden w-full h-60 flex items-center justify-center max-md:h-auto max-md:w-full",n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:"max-w-full max-h-full object-contain",alt:"",src:s})}),n.rightImageCaption&&h.jsx("p",{className:"text-sm text-center text-gray-500",children:n.rightImageCaption})]})]}):h.jsxs("div",{className:J("flex w-full justify-between max-md:flex-col gap-20 items-center",a,!g&&"flex-row-reverse"),children:[h.jsxs("div",{className:J(m,"max-md:w-full shrink-0 flex flex-col justify-center gap-12"),children:[(n.label||n.heading)&&h.jsxs("div",{className:"flex flex-col gap-3",children:[n.label&&h.jsx("p",{className:"leading-5 uppercase text-[#9ca3af] text-base",children:n.label}),n.heading&&h.jsx("h3",{className:"leading-normal text-2xl text-black whitespace-pre-wrap",children:e(n.heading,n.highlightedText,n.highlightColor)})]}),n.description&&n.description.length>0&&h.jsx("div",{className:"leading-normal pb-1 text-[#4b5563] text-base whitespace-pre-wrap prose prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:n.description,components:t})}),r&&h.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[h.jsx("div",{className:J("overflow-hidden w-full h-60",n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:"w-full h-full object-cover",alt:"",src:r})}),n.leftImageCaption&&h.jsx("p",{className:"text-sm text-center text-gray-500",children:n.leftImageCaption})]})]}),s&&h.jsxs("div",{className:J("flex flex-col gap-3",d),children:[h.jsx("div",{className:J("overflow-hidden w-full h-60 justify-center max-md:h-auto max-md:w-full",n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:"w-full h-full object-cover object-top",alt:"",src:s})}),n.rightImageCaption&&h.jsx("p",{className:"text-sm text-center text-gray-500",children:n.rightImageCaption})]})]})})}const PO="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.75%2010.5C4.16421%2010.5%204.5%2010.1642%204.5%209.75V5.56066L9.96967%2011.0303C10.2626%2011.3232%2010.7374%2011.3232%2011.0303%2011.0303C11.3232%2010.7374%2011.3232%2010.2626%2011.0303%209.96967L5.56066%204.5H9.75C10.1642%204.5%2010.5%204.16421%2010.5%203.75C10.5%203.33579%2010.1642%203%209.75%203H3.75C3.33579%203%203%203.33579%203%203.75V9.75C3%2010.1642%203.33579%2010.5%203.75%2010.5Z'%20fill='%234B5563'/%3e%3cpath%20d='M20.25%2013.5C19.8358%2013.5%2019.5%2013.8358%2019.5%2014.25V18.4393L14.0303%2012.9697C13.7374%2012.6768%2013.2626%2012.6768%2012.9697%2012.9697C12.6768%2013.2626%2012.6768%2013.7374%2012.9697%2014.0303L18.4393%2019.5H14.25C13.8358%2019.5%2013.5%2019.8358%2013.5%2020.25C13.5%2020.6642%2013.8358%2021%2014.25%2021H20.25C20.6642%2021%2021%2020.6642%2021%2020.25V14.25C21%2013.8358%2020.6642%2013.5%2020.25%2013.5Z'%20fill='%234B5563'/%3e%3c/svg%3e";function on(n,e,t){if(!e)return n;const r=n.toLowerCase(),s=e.toLowerCase(),i=r.indexOf(s);if(i===-1)return n;const a=n.substring(0,i),l=n.substring(i,i+e.length),u=n.substring(i+e.length),d=t||"#3b82f6";return h.jsxs(h.Fragment,{children:[a,h.jsx("span",{style:{color:d},children:l}),u]})}function ip(n,e){const t=a=>typeof a=="string"?a:Array.isArray(a)?a.map(t).join(""):"",r=a=>n?t(a).toLowerCase().includes(n.toLowerCase()):!1,s=a=>{if(!n)return a;const l=t(a),u=l.toLowerCase(),d=n.toLowerCase();return u.includes(d)?on(l,n,e):a},i=e||"#3b82f6";return{block:{h1:({children:a})=>h.jsx("h1",{className:"text-3xl font-semibold mb-4 mt-8 first:mt-0",children:s(a)}),h2:({children:a})=>h.jsx("h2",{className:"text-2xl font-medium mb-3 mt-6 first:mt-0",children:s(a)}),h3:({children:a})=>h.jsx("h3",{className:"text-xl font-medium mb-3 mt-5 first:mt-0",children:s(a)}),h4:({children:a})=>r(a)?h.jsx("h4",{className:"font-normal mb-2 mt-4 first:mt-0",style:{fontSize:"1.125rem",lineHeight:"1.75rem",color:i},children:a}):h.jsx("h4",{className:"text-lg font-normal mb-2 mt-4 first:mt-0",children:a}),normal:({children:a})=>h.jsx("p",{className:"mb-4 last:mb-0",children:a})},marks:{strong:({children:a})=>r(a)?h.jsx("strong",{className:"font-semibold",style:{color:i},children:a}):h.jsx("strong",{className:"font-semibold",children:a}),em:({children:a})=>h.jsx("em",{className:"italic",children:a}),code:({children:a})=>h.jsx("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded text-sm font-mono",children:a})},list:{bullet:({children:a})=>h.jsx("ul",{className:"list-disc ml-5 space-y-2 mb-4",children:a}),number:({children:a})=>h.jsx("ol",{className:"list-decimal ml-5 space-y-2 mb-4",children:a})}}}const wr=ip(),e_="unlockedProjects";function t_(){try{const n=sessionStorage.getItem(e_);return n?JSON.parse(n):[]}catch{return[]}}function DO(n){try{const e=t_();e.includes(n)||(e.push(n),sessionStorage.setItem(e_,JSON.stringify(e)))}catch{}}function NO(n){return t_().includes(n)}const jO=()=>h.jsx("svg",{className:"block size-full",viewBox:"0 0 16 16",fill:"none",children:h.jsx("path",{d:"M6 12L10 8L6 4",stroke:"#9CA3AF",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})});function OO({projectName:n,onWorkClick:e,isScrolled:t=!1,isPastHero:r=!1}){return h.jsxs("div",{className:J("flex items-center transition-all duration-300 ease-out",r?"opacity-0 pointer-events-none":"opacity-100"),children:[h.jsx("button",{onClick:e,className:J("flex items-center justify-center py-0.5 rounded-md transition-all duration-300 ease-out hover:bg-[#f3f4f6]",t?"opacity-0 pointer-events-none w-0 px-0 overflow-hidden":"opacity-100 px-1.5 ml-2"),children:h.jsx("span",{className:"font-['Figtree:Medium',sans-serif] font-medium text-sm leading-normal text-[#4b5563] whitespace-nowrap",children:"Work"})}),h.jsx("div",{className:"shrink-0 size-4",children:h.jsx(jO,{})}),h.jsx("div",{className:"flex items-center justify-center px-1 py-0.5",children:h.jsx("span",{className:"font-['Figtree:Medium',sans-serif] font-medium text-sm leading-normal text-[#1f2937]",children:n})})]})}function MO({videoId:n}){const e=L.useRef(null),t=L.useRef(null),r=L.useRef(null),[s,i]=L.useState(1),[a,l]=L.useState(!1),u=L.useRef(null),d=L.useRef(`yt-${n}-${Math.random().toString(36).substr(2,9)}`),f=`${d.current}-1`,m=`${d.current}-2`;return L.useEffect(()=>{if(window.YT&&window.YT.Player){l(!0);return}if(!document.querySelector('script[src="https://www.youtube.com/iframe_api"]')){const w=document.createElement("script");w.src="https://www.youtube.com/iframe_api",document.head.appendChild(w)}const x=setInterval(()=>{window.YT&&window.YT.Player&&(l(!0),clearInterval(x))},100),y=window.onYouTubeIframeAPIReady;return window.onYouTubeIframeAPIReady=()=>{y?.(),l(!0),clearInterval(x)},()=>{clearInterval(x),u.current&&clearInterval(u.current)}},[]),L.useEffect(()=>{if(!a||!window.YT?.Player)return;const g=(x,y,w)=>{y.current=new window.YT.Player(x,{videoId:n,playerVars:{autoplay:w?1:0,mute:1,controls:0,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0,playsinline:1,origin:window.location.origin},events:{onReady:b=>{w&&b.target.playVideo()}}})};return g(f,t,!0),g(m,r,!1),()=>{t.current?.destroy(),r.current?.destroy()}},[a,n,f,m]),L.useEffect(()=>{if(!a)return;const g=()=>{const x=s===1?t:r,y=s===1?r:t,w=x.current,b=y.current;if(!(!w||!b))try{const E=w.getCurrentTime?.(),T=w.getDuration?.();E&&T&&T>0&&E>=T-.3&&(b.seekTo(0,!0),b.playVideo(),i(s===1?2:1))}catch{}};return u.current=window.setInterval(g,50),()=>{u.current&&clearInterval(u.current)}},[a,s]),h.jsxs("div",{ref:e,className:"aspect-video w-full overflow-hidden rounded-3xl relative pointer-events-none",children:[h.jsx("div",{id:f,className:J("absolute inset-0 w-full h-full transition-opacity duration-200 scale-[1.5] [&>iframe]:w-full [&>iframe]:h-full",s===1?"opacity-100 z-10":"opacity-0 z-0")}),h.jsx("div",{id:m,className:J("absolute inset-0 w-full h-full transition-opacity duration-200 scale-[1.5] [&>iframe]:w-full [&>iframe]:h-full",s===2?"opacity-100 z-10":"opacity-0 z-0")})]})}const FO=()=>h.jsx("img",{src:PO,alt:"Expand",className:"block size-full"}),BO=()=>h.jsx("svg",{className:"block size-full",viewBox:"0 0 12 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 0C6.41421 0 6.75 0.335786 6.75 0.75V11.4393L10.7197 7.46967C11.0126 7.17678 11.4874 7.17678 11.7803 7.46967C12.0732 7.76256 12.0732 8.23744 11.7803 8.53033L6.53033 13.7803C6.23744 14.0732 5.76256 14.0732 5.46967 13.7803L0.21967 8.53033C-0.0732233 8.23744 -0.0732233 7.76256 0.21967 7.46967C0.512563 7.17678 0.987437 7.17678 1.28033 7.46967L5.25 11.4393V0.75C5.25 0.335786 5.58579 0 6 0Z",fill:"#9CA3AF"})}),UO=()=>h.jsxs("svg",{className:"block size-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("path",{d:"M12 5.25C4.5 5.25 1.5 12 1.5 12C1.5 12 4.5 18.75 12 18.75C19.5 18.75 22.5 12 22.5 12C22.5 12 19.5 5.25 12 5.25Z",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),h.jsx("path",{d:"M12 15.75C14.0711 15.75 15.75 14.0711 15.75 12C15.75 9.92893 14.0711 8.25 12 8.25C9.92893 8.25 8.25 9.92893 8.25 12C8.25 14.0711 9.92893 15.75 12 15.75Z",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),$O=()=>h.jsxs("svg",{className:"block size-full",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("path",{d:"M14.12 14.12C13.5646 14.6755 12.7998 14.9855 12 14.9855C11.2002 14.9855 10.4354 14.6755 9.88 14.12C9.32457 13.5646 9.0145 12.7998 9.0145 12C9.0145 11.2002 9.32457 10.4354 9.88 9.88",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),h.jsx("path",{d:"M4.5 4.5L19.5 19.5",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),h.jsx("path",{d:"M9.75 5.5C10.485 5.34 11.235 5.25 12 5.25C19.5 5.25 22.5 12 22.5 12C22.02 12.945 21.42 13.815 20.73 14.61",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"}),h.jsx("path",{d:"M17.94 17.94C16.23 19.17 14.16 19.875 12 19.875C4.5 19.875 1.5 13.125 1.5 13.125C2.505 11.205 3.975 9.54 5.775 8.355",stroke:"#9CA3AF",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),VO=()=>h.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("rect",{x:"8",y:"12",width:"44",height:"30",rx:"2",stroke:"#9ca3af",strokeWidth:"2",fill:"none"}),h.jsx("rect",{x:"12",y:"16",width:"36",height:"22",rx:"1",fill:"#e5e7eb"}),h.jsx("path",{d:"M4 42h52v2a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4v-2z",fill:"#d1d5db"})]});function GO({expectedPassword:n,onUnlock:e}){const[t,r]=L.useState(""),[s,i]=L.useState(!1),[a,l]=L.useState(!1),[u,d]=L.useState(!1);L.useEffect(()=>{const x=()=>{d(window.innerWidth<768)};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const f=x=>{x.preventDefault(),t===n?(i(!1),r(""),e?.()):i(!0)},m=x=>{r(x.target.value),s&&i(!1)},g=()=>{l(!a)};return h.jsxs("form",{onSubmit:f,className:"flex flex-col gap-2 w-full max-w-[313px]",children:[h.jsxs("div",{className:J("bg-white border border-solid content-stretch flex items-center justify-between pl-4 pr-3 py-2 relative rounded-full shrink-0 w-full transition-colors duration-200",s?"border-[#f87171]":"border-[#e5e7eb]"),children:[h.jsx("input",{type:a?"text":"password",placeholder:"Enter",value:t,onChange:m,className:"leading-5 relative shrink-0 text-black text-base bg-transparent border-none outline-none flex-1 placeholder:text-[#9ca3af]"}),h.jsxs("div",{className:"flex items-center gap-2.5",children:[h.jsx("button",{type:"button",onClick:g,className:J("relative shrink-0 size-[18px] hover:opacity-70 transition-all duration-200",t.length>0?"opacity-100":"opacity-0 pointer-events-none"),children:a?h.jsx($O,{}):h.jsx(UO,{})}),h.jsx("button",{type:"submit",className:"relative shrink-0 size-[14px] rotate-[-90deg] hover:opacity-70 transition-opacity",children:h.jsx(BO,{})})]})]}),h.jsx("div",{className:J("overflow-hidden transition-all duration-300 ease-out",s?"max-h-6 opacity-100":"max-h-0 opacity-0"),children:h.jsx("p",{className:"text-[#f87171] text-sm leading-5 px-2",children:"Please try again!"})})]})}function HO(){return h.jsx("div",{className:"h-px relative shrink-0 w-full",children:h.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})}function KO({projectId:n,onClose:e,onBack:t,onExpandToFullscreen:r,onCollapseFromFullscreen:s,initialFullscreen:i=!1,onProjectClick:a,onViewAllProjects:l}){const[u,d]=L.useState(!1),[f,m]=L.useState(!1),[g,x]=L.useState(!1),[y,w]=L.useState(!1),[b,E]=L.useState(!1),[T,_]=L.useState(null),[A,I]=L.useState(!0),[N,P]=L.useState(null),[O,M]=L.useState(()=>NO(n)),[D,B]=L.useState(!1);L.useEffect(()=>{const ne=()=>{B(window.innerWidth<768)};return ne(),window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[]);const q=Er.useRef(null),ie=Er.useRef(null),te=Er.useRef(null),re=Er.useRef(null),ee=Er.useRef(null),Q=i;L.useEffect(()=>{async function ne(){try{I(!0);const ae=`project:${n}`,ce=Ye(ae);if(ce){_(ce),P(null),I(!1);return}const _e=await it.fetch(KT,{company:n});_(_e),P(null)}catch(ae){console.error("Error fetching project:",ae),P("Failed to load project")}finally{I(!1)}}ne()},[n]),$a(!Q),L.useEffect(()=>{requestAnimationFrame(()=>{d(!0)})},[]),L.useEffect(()=>{const ne=q.current;if(!ne)return;let ae=null;const ce=(Ee,Le)=>{let oe=0,Re=Ee;for(;Re&&Re!==Le;)oe+=Re.offsetTop,Re=Re.offsetParent;return oe},_e=setTimeout(()=>{ae=()=>{const Ee=ne.scrollTop;if(x(Ee>20),re.current&&ee.current){const Le=ce(re.current,ne),oe=ce(ee.current,ne),Re=Ee;E(Re>=Le-200&&Re<oe-200)}},ae&&(ne.addEventListener("scroll",ae),ae())},100);return()=>{clearTimeout(_e),ae&&ne.removeEventListener("scroll",ae)}},[T,A]),L.useEffect(()=>{const ne=te.current,ae=q.current;if(!ne||!ae||!Q)return;const ce=new IntersectionObserver(_e=>{_e.forEach(Ee=>{const Le=Ee.boundingClientRect.top,oe=Ee.rootBounds?.top??0,Re=!Ee.isIntersecting&&Le<oe;w(Re)})},{root:ae,threshold:0,rootMargin:"0px 0px 0px 0px"});return ce.observe(ne),()=>ce.disconnect()},[Q,T]),L.useEffect(()=>{if(Q)return;const ne=ae=>{ae.key==="Escape"&&(ae.preventDefault(),G())};return document.addEventListener("keydown",ne),()=>document.removeEventListener("keydown",ne)},[Q]);const G=()=>{m(!0),d(!1),setTimeout(()=>{e()},300)},Y=()=>{r&&r()},Z=()=>{Q?l&&l():t&&(m(!0),d(!1),setTimeout(()=>{t()},300))},j=()=>{DO(n),M(!0);const ne=()=>{q.current&&(q.current.scrollTop=0,q.current.scrollTo({top:0,behavior:"instant"})),window.scrollTo(0,0),document.documentElement.scrollTop=0,document.body.scrollTop=0};!Q&&r?(r(),setTimeout(ne,50),setTimeout(ne,100),setTimeout(ne,200)):(ne(),setTimeout(ne,50),setTimeout(ne,100),setTimeout(ne,200),setTimeout(ne,300),setTimeout(ne,500))},$=ne=>{if(ne.preventDefault(),ee.current&&q.current){const ce=((_e,Ee)=>{let Le=0,oe=_e;for(;oe&&oe!==Ee;)Le+=oe.offsetTop,oe=oe.offsetParent;return Le})(ee.current,q.current);q.current.scrollTo({top:ce-20,behavior:"smooth"})}},fe=ne=>{a&&a(ne)};return h.jsxs("div",{className:J("fixed inset-0 z-50 flex items-center justify-center transition-all duration-500 ease-out",Q?"px-0":"px-8"),children:[h.jsx("div",{className:J("absolute inset-0 bg-black/20 transition-opacity duration-500",u&&!Q?"opacity-100":"opacity-0",Q&&"pointer-events-none"),onClick:G}),h.jsx("div",{className:J("relative bg-white flex flex-col overflow-hidden transition-all duration-500 ease-out",Q?"w-full h-full rounded-none":"rounded-[26px] w-[calc(100%*10/12)] max-md:w-full max-h-[80vh] sm:max-h-[90vh]",u?"opacity-100 translate-y-0":f?"opacity-0 translate-y-4":"opacity-0 translate-y-8"),children:h.jsxs("div",{className:"flex flex-col flex-1 min-h-0 relative",children:[!Q&&h.jsx("div",{className:"absolute top-0 left-0 right-0 flex items-start justify-start px-7 pt-6 pb-3 z-10",children:h.jsx("button",{onClick:Y,className:"content-stretch flex items-center justify-center relative shrink-0 size-6 cursor-pointer rounded-sm hover:bg-gray-200 transition-colors duration-200 ease-out text-[#4b5563]",children:h.jsx("div",{className:"relative shrink-0 size-[18px]",children:h.jsx(FO,{})})})}),h.jsx("a",{href:"#final-designs",onClick:$,className:J("fixed z-[100] font-medium text-gray-400 hover:text-blue-500 cursor-pointer leading-tight","transition-all duration-300 ease-in-out",b?"opacity-100":"opacity-0 pointer-events-none",Q?"top-16 left-14 max-md:left-6":"top-16 left-8"),children:h.jsxs("div",{className:"flex flex-col gap-0.5 items-start",children:[h.jsx("span",{className:"text-[0.8rem]",children:" SKIP TO"}),h.jsx("span",{className:"text-[0.8rem]",children:"DESIGNS"})]})}),h.jsxs("div",{ref:q,className:J("overflow-y-auto overflow-x-hidden flex-1",!Q&&"rounded-t-[26px]"),children:[Q&&h.jsx("div",{className:J("content-stretch flex flex-col items-start px-14 max-md:px-6 relative shrink-0 w-full md:sticky md:top-0 z-10 transition-all duration-300 ease-out",g?"py-4":"py-8"),children:h.jsxs("div",{className:"content-stretch flex gap-1.5 items-center relative shrink-0 w-full",children:[h.jsx("button",{onClick:Z,className:J("overflow-clip relative shrink-0 cursor-pointer hover:opacity-80 transition-all duration-300 ease-out p-0 border-0 bg-transparent",g?"size-7":"size-[44px]"),children:h.jsx("img",{src:"/logo.png",alt:"Michelle Liu",className:"size-full object-cover"})}),h.jsx(OO,{projectName:T?.title||n.charAt(0).toUpperCase()+n.slice(1),onWorkClick:l,isScrolled:g,isPastHero:y})]})}),A&&h.jsx("div",{className:"flex items-center justify-center py-32",children:h.jsx("div",{className:"text-gray-400",children:"Loading..."})}),N&&h.jsx("div",{className:"flex items-center justify-center py-32",children:h.jsx("div",{className:"text-red-500",children:N})}),!A&&!N&&T&&h.jsxs("div",{className:"flex flex-col pb-16",children:[O&&D&&h.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] px-8 text-center",children:[h.jsx(VO,{}),h.jsxs("p",{className:"text-[#6b7280] text-base leading-6 px-12 mt-4",children:["This page isn't available on mobile yet. You can view it on desktop instead! ",";)"]})]}),!(O&&D)&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-8 items-start justify-center px-8 md:px-[8%] xl:px-[175px] pt-32 pb-16 relative shrink-0 w-full",children:[T.logo&&h.jsx(Be,{variant:"fade",rootMargin:"0px",children:h.jsx("div",{className:"relative shrink-0 size-20 rounded-[16px] overflow-hidden",children:h.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",alt:"",src:ze(T.logo).width(160).height(160).url()})})}),h.jsxs("div",{className:"content-stretch flex flex-col gap-10 items-start relative shrink-0 w-full",children:[h.jsx(Be,{variant:"fade",delay:80,rootMargin:"0px",children:h.jsx("p",{className:"font-normal leading-5 relative shrink-0 text-4xl text-black",children:T.title})}),T.metadata&&T.metadata.length>0&&h.jsx("div",{className:"content-stretch flex gap-5 items-start relative shrink-0 w-full max-md:grid max-md:grid-cols-2 max-md:gap-4",children:T.metadata.map(ne=>h.jsx(Be,{variant:"fade",delay:160,rootMargin:"0px",className:"flex-[1_0_0] min-h-px min-w-px",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-3 items-start leading-5 relative shrink-0 text-base whitespace-pre-wrap",children:[h.jsx("p",{className:"font-medium relative shrink-0 text-[#9ca3af]",children:ne.label}),h.jsxs("p",{className:"font-normal relative shrink-0 text-black",children:[ne.value.map((ae,ce)=>h.jsxs(Er.Fragment,{children:[ae,ce<ne.value.length-1&&h.jsx("br",{})]},ce)),ne.subValue&&h.jsxs(h.Fragment,{children:[h.jsx("br",{}),h.jsx("span",{className:"italic text-gray-600",children:ne.subValue})]})]})]})},ne._key))})]}),h.jsx(Be,{variant:"fade",delay:400,rootMargin:"0px",className:"w-full",children:h.jsx(HO,{})}),T.heroVideo?h.jsx(Be,{delay:480,rootMargin:"0px",className:"w-full",children:h.jsx("div",{ref:ie,className:"content-stretch flex flex-col items-start overflow-clip relative rounded-[26px] shrink-0 w-full",children:h.jsxs("div",{className:"aspect-[1090/591] relative rounded-[26px] shrink-0 w-full overflow-hidden bg-gray-100",children:[T.heroImage&&h.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[26px] size-full",alt:"",src:ze(T.heroImage).width(1200).url()}),h.jsx(Os,{src:`https://stream.mux.com/${T.heroVideo}.m3u8`,className:"absolute inset-0 max-w-none object-cover rounded-[26px] size-full",autoPlay:!0,muted:!0,loop:!0,controls:!1,poster:T.heroImage?ze(T.heroImage).width(1200).url():void 0})]})})}):T.heroImage?h.jsx(Be,{delay:480,rootMargin:"0px",className:"w-full",children:h.jsx("div",{ref:ie,className:"content-stretch flex flex-col items-start overflow-clip relative rounded-[26px] shrink-0 w-full",children:h.jsx("div",{className:"aspect-[1090/591] relative rounded-[26px] shrink-0 w-full",children:h.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[26px] size-full",alt:"",src:ze(T.heroImage).width(1200).url()})})})}):null]}),(()=>{let ne=T.content||[];const ae=ce=>{if(ce._type==="protectedSection")return!O;const _e=ce.visibility||"both";return _e==="both"?!0:_e==="locked"?!O:_e==="unlocked"?O:!0};return ne=ne.filter(ae),ne.map(ce=>ce._type==="testimonialSection"?h.jsx(c2,{section:ce,isFullscreen:Q,isUnlocked:O,onUnlock:j,projectId:n,skipStartRef:re,skipEndRef:ee,scrollContainerRef:q,missionRef:te},ce._key):h.jsx(Be,{children:h.jsx(c2,{section:ce,isFullscreen:Q,isUnlocked:O,onUnlock:j,skipStartRef:re,skipEndRef:ee,scrollContainerRef:q,projectId:n,missionRef:te})},ce._key))})(),T.relatedProjects&&T.relatedProjects.length>0&&h.jsx(Be,{variant:"fade",children:h.jsx(p8,{projects:T.relatedProjects.map(ne=>({id:ne._id,title:ne.title,year:ne.year,description:ne.shortDescription||"",imageSrc:ne.heroImage?ze(ne.heroImage).width(800).height(434).url():""})),onProjectClick:ne=>{const ae=T.relatedProjects?.find(ce=>ce._id===ne.id);ae?.company&&fe(ae.company)},onViewAll:Q?l:void 0})})]})]}),!A&&!N&&!T&&h.jsx("div",{className:"flex items-center justify-center py-32",children:h.jsx("div",{className:"text-gray-400",children:"Project not found"})}),Q&&h.jsx(hd,{})]})]})})]})}const zO=()=>h.jsx("svg",{className:"block size-full",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.7803 14.7803C14.4874 15.0732 14.0126 15.0732 13.7197 14.7803L6.5 7.56066V13.25C6.5 13.6642 6.16421 14 5.75 14C5.33579 14 5 13.6642 5 13.25V5.75C5 5.33579 5.33579 5 5.75 5H13.25C13.6642 5 14 5.33579 14 5.75C14 6.16421 13.6642 6.5 13.25 6.5H7.56066L14.7803 13.7197C15.0732 14.0126 15.0732 14.4874 14.7803 14.7803Z",fill:"#9CA3AF"})}),WO=()=>h.jsx("svg",{className:"block size-full rotate-180",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.7803 14.7803C14.4874 15.0732 14.0126 15.0732 13.7197 14.7803L6.5 7.56066V13.25C6.5 13.6642 6.16421 14 5.75 14C5.33579 14 5 13.6642 5 13.25V5.75C5 5.33579 5.33579 5 5.75 5H13.25C13.6642 5 14 5.33579 14 5.75C14 6.16421 13.6642 6.5 13.25 6.5H7.56066L14.7803 13.7197C15.0732 14.0126 15.0732 14.4874 14.7803 14.7803Z",fill:"#9CA3AF"})});function qO({sectionLabel:n="Feedback",sectionTitle:e="Kind words from my manager",highlightedText:t,highlightColor:r,quote:s,fullQuote:i,authorName:a,authorTitle:l,authorCompany:u,authorImage:d,isFullscreen:f=!1}){const[m,g]=L.useState(!1),[x,y]=L.useState(!1),w=Er.useRef(null),b=()=>{const T=m;y(!0),g(!m),T&&w.current&&setTimeout(()=>{w.current?.scrollIntoView({behavior:"smooth",block:"start"})},50),setTimeout(()=>y(!1),400)},E=u?`${l}, ${u}`:l;return h.jsx("div",{ref:w,className:"content-stretch flex flex-col items-start justify-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full scroll-mt-8",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-[100px] max-md:gap-16 items-start relative shrink-0 w-full",children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-5 items-start relative shrink-0 w-full",children:[h.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] uppercase text-base",children:n}),h.jsx("p",{className:"leading-7 min-w-full relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:e&&on(e,t,r)})]}),h.jsxs("div",{className:J("content-stretch flex items-start relative shrink-0 w-full","justify-between",f&&"px-[111px]","max-md:flex-col max-md:gap-16 max-md:px-12"),children:[h.jsxs("div",{className:J("content-stretch flex relative shrink-0","flex-col gap-6 items-start w-[202px]","max-md:flex-row max-md:gap-8 max-md:items-center max-md:w-auto"),children:[h.jsx("div",{className:"relative rounded-full shrink-0 size-[120px] overflow-hidden bg-gray-100",children:d&&h.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",alt:a||"",src:ze(d).width(240).height(240).url()})}),h.jsxs("div",{className:"content-stretch flex flex-col gap-1 items-start leading-5 relative shrink-0 text-base max-md:flex-1",children:[h.jsx("p",{className:"relative shrink-0 text-black",children:a}),h.jsx("p",{className:"relative shrink-0 text-[#9ca3af]",children:E})]})]}),h.jsxs("div",{className:J("content-stretch flex flex-col gap-6 relative shrink-0","items-start justify-center","max-md:w-full"),children:[h.jsx("div",{className:J("absolute pointer-events-none","-top-[77px] -left-[77px] w-[121px] h-[120px]","max-md:-left-[50px] max-md:-top-[50px] max-md:w-[80px] max-md:h-[80px]"),children:h.jsx("img",{src:f8,alt:"",className:"w-full h-full object-contain"})}),h.jsxs("div",{className:"relative w-[424px] max-md:w-full",children:[!m&&h.jsx("div",{className:"leading-normal text-[#1f2937] text-xl whitespace-pre-wrap",children:h.jsx("p",{children:s})}),m&&h.jsx("div",{className:"leading-normal text-[#1f2937] text-xl whitespace-pre-wrap",children:i?.map((T,_)=>h.jsx("p",{className:_<(i?.length||0)-1?"mb-6":"",children:T},_))})]}),h.jsx("button",{onClick:b,className:J("relative shrink-0 cursor-pointer transition-colors duration-300 ease-out",m?"size-6 hover:opacity-70":"leading-5 text-[#9ca3af] text-base hover:text-[#6b7280] text-left"),children:m?h.jsxs("div",{className:"relative shrink-0 size-5",children:[h.jsx("span",{className:"hidden max-md:block",children:h.jsx(WO,{})}),h.jsx("span",{className:"block max-md:hidden",children:h.jsx(zO,{})})]}):i&&i.length>0?"Read more":null})]})]})]})})}function c2({section:n,isFullscreen:e=!1,isUnlocked:t=!1,onUnlock:r,skipStartRef:s,skipEndRef:i,scrollContainerRef:a,projectId:l,missionRef:u}){const f=(()=>{switch(n._type){case"missionSection":const m=n.missionDescription&&n.missionDescription.length>0;return n.missionImage?h.jsxs("div",{ref:u,className:"flex flex-col items-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[h.jsxs("div",{className:"flex flex-col gap-5 items-center text-center w-[410px] max-md:w-full",children:[h.jsx("p",{className:"leading-5 text-[#9ca3af] uppercase text-base",children:n.sectionLabel||"The Mission"}),h.jsx("p",{className:"leading-7 text-2xl text-black whitespace-pre-wrap text-pretty",children:on(n.missionTitle,n.highlightedText,n.highlightColor)})]}),h.jsx("div",{className:"relative mt-8 w-[410px] max-md:w-full",children:h.jsx("img",{src:ze(n.missionImage).width(820).url(),alt:"",className:"w-full h-auto object-cover"})}),m&&h.jsxs("div",{className:"flex flex-col gap-8 mt-8 w-[410px] max-md:w-full px-8 max-md:px-0",children:[h.jsx("div",{className:"leading-normal text-[#4b5563] text-base whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:n.missionDescription,components:wr})}),n.missionNote&&h.jsx("p",{className:"text-[#9ca3af] text-base italic leading-5",children:n.missionNote})]}),!m&&n.missionNote&&h.jsx("p",{className:"text-[#9ca3af] text-base italic leading-5 mt-8 w-[410px] max-md:w-full px-8 max-md:px-0",children:n.missionNote})]}):h.jsxs("div",{ref:u,className:J("content-stretch items-start px-8 md:px-[8%] xl:px-[175px] py-16 relative shrink-0 w-full",!m&&"flex flex-col gap-5 justify-center",m&&"grid grid-cols-[2fr_1fr_2fr] max-md:flex max-md:flex-col max-md:gap-8"),children:[h.jsxs("div",{className:J("content-stretch flex flex-col gap-5 items-start relative",!m&&"max-w-[646px] w-full",m&&"col-start-1"),children:[h.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af] uppercase text-base",children:n.sectionLabel||"The Mission"}),h.jsx("p",{className:"leading-7 w-full relative shrink-0 text-2xl text-black whitespace-pre-wrap text-pretty",children:on(n.missionTitle,n.highlightedText,n.highlightColor)})]}),m&&h.jsx("div",{className:"leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap col-start-3 max-md:col-start-auto max-md:w-full prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:n.missionDescription,components:wr})})]});case"protectedSection":if(!(n.visibility==="both"||n.visibility==="locked"&&!t||n.visibility==="unlocked"&&t||!n.visibility&&!t))return null;const y=!!(n.showPasswordProtection&&n.password);return h.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:h.jsx("div",{className:"bg-gray-100 content-stretch flex flex-col items-center justify-center overflow-clip p-16 max-md:p-8 relative rounded-[26px] shrink-0 w-full",children:h.jsxs("div",{className:J("content-stretch flex flex-col items-start relative shrink-0 w-full",y&&"gap-8"),children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-8 items-start justify-center relative shrink-0",children:[h.jsx("div",{className:"relative shrink-0 size-[60px]",children:h.jsx("div",{className:"absolute inset-0 rounded-full bg-white shadow-[0px_1px_3px_0px_rgba(0,0,0,0.08),0px_1px_2px_-1px_rgba(0,0,0,0.08)] flex items-center justify-center",children:h.jsx("img",{src:d8,alt:"",className:"w-[19px] h-[28px]"})})}),h.jsxs("div",{className:"content-stretch flex flex-col gap-2 items-start relative shrink-0 w-full",children:[h.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black",children:(n.title||(l==="apple"?"This work is confidential.":y?"This case study is password-protected.":"Confidential")).replace(/\n/g," ")}),h.jsxs("p",{className:"leading-6 relative shrink-0 text-[#9ca3af] text-lg",children:[l==="apple"?"Please ":y?"Curious? Feel free to ":n.message||"Interested? Please ",n.contactEmail?h.jsxs(h.Fragment,{children:[h.jsx("a",{href:`mailto:${n.contactEmail}`,className:"underline decoration-solid hover:text-blue-500 transition-colors",children:"email me"}),l==="apple"?" if you'd like to chat!":"!"]}):l==="apple"?"email me if you'd like to chat!":"email me!"]})]})]}),y&&!t&&h.jsx(GO,{expectedPassword:n.password||"",onUnlock:r})]})})});case"featureSection":const w=n.externalImageUrl?n.externalImageUrl:n.image?ze(n.image).width(2400).url():null,b=n.mediaType==="video"&&n.muxPlaybackId,E=n.layout==="stacked",T=n.mediaPosition==="left",A={small:"py-10",normal:"py-16",large:"py-20"}[n.verticalPadding||"normal"];return E?h.jsx("div",{className:"flex flex-col py-6",children:h.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] relative shrink-0 w-full",style:{backgroundColor:n.backgroundColor||"#f9fafb"},children:h.jsxs("div",{className:J("content-stretch flex flex-col justify-between relative shrink-0 w-full",A),children:[h.jsxs("div",{className:"flex flex-row items-start gap-32 w-full max-md:flex max-md:flex-col max-md:gap-8",children:[h.jsxs("div",{className:"content-stretch flex w-120 flex-col gap-3 items-start relative col-start-1",children:[(n.sectionNumber||n.sectionLabel)&&h.jsxs("div",{className:"flex items-center gap-2",children:[n.sectionNumber&&h.jsx("p",{className:"leading-5 relative shrink-0 text-[#3b82f6] uppercase text-base font-medium",children:n.sectionNumber}),n.sectionLabel&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-base",children:n.sectionLabel})]}),n.problemLabel&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-[#9ca3af] text-base",children:n.problemLabel}),n.heading&&h.jsx("p",{className:"leading-7 min-w-120 relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:on(n.heading,n.highlightedText,n.highlightColor)})]}),n.description&&n.description.length>0&&h.jsx("div",{className:"leading-normal max-w-120 relative text-gray-500 text-base whitespace-pre-wrap col-start-3 max-md:col-start-auto max-md:w-full prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:n.description,components:ip(n.descriptionHighlightedText,n.descriptionHighlightColor)})})]}),h.jsxs("div",{className:"w-full",children:[b&&h.jsx("div",{className:"w-full overflow-hidden rounded-[26px]",children:h.jsx("div",{className:"aspect-video w-full",children:h.jsx(Os,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-cover",controls:!1,autoPlay:!0,muted:!0,loop:!0})})}),!b&&w&&h.jsx("div",{className:"overflow-hidden rounded-[26px] w-full",children:h.jsx("img",{className:"w-full object-cover",alt:n.imageAlt||"",src:w})})]})]})})}):h.jsx("div",{className:"flex flex-col py-6",children:h.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] relative shrink-0 w-full",style:{backgroundColor:n.backgroundColor||"#f9fafb"},children:h.jsxs("div",{className:J("content-stretch items-center flex flex-col gap-32 relative shrink-0 w-full md:flex-row max-md:gap-8",T&&"md:flex-row-reverse",A),children:[h.jsxs("div",{className:"min-w-120 shrink-0 content-stretch flex flex-col gap-3 items-start relative col-start-1 max-md:w-full max-md:min-w-0",children:[(n.sectionNumber||n.sectionLabel)&&h.jsxs("div",{className:"flex items-center gap-2",children:[n.sectionNumber&&h.jsx("p",{className:"leading-5 relative shrink-0 text-[#3b82f6] text-base font-medium",children:n.sectionNumber}),n.sectionLabel&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-base",children:n.sectionLabel})]}),n.problemLabel&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-[#9ca3af] text-base",children:n.problemLabel}),n.heading&&h.jsx("p",{className:"leading-7 min-w-120 relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:on(n.heading,n.highlightedText,n.highlightColor)}),n.description&&n.description.length>0&&h.jsx("div",{className:"pt-6 max-w-120 whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 text-gray-500",children:h.jsx(vn,{value:n.description,components:ip(n.descriptionHighlightedText,n.descriptionHighlightColor)})})]}),h.jsxs("div",{className:"leading-5 max-w-120 flex-items-center relative text-[#4b5563] text-base whitespace-pre-wrap items-center flex flex-col gap-8",children:[b&&h.jsx("div",{className:"w-full min-w-200 overflow-hidden rounded-[26px] ",children:h.jsx("div",{className:"aspect-video w-full",children:h.jsx(Os,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-cover",controls:!1,autoPlay:!0,muted:!0,loop:!0})})}),!b&&w&&h.jsx("div",{className:"overflow-hidden rounded-[26px] w-full",children:h.jsx("img",{className:"w-full object-cover",alt:n.imageAlt||"",src:w})})]})]})})});case"gallerySection":const I=n.layout==="2-col"?"grid-cols-2":n.layout==="3-col"?"grid-cols-3":"grid-cols-4";return h.jsxs("div",{className:"content-stretch flex flex-col gap-4 px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[h.jsx("div",{className:`content-stretch grid gap-4 items-center relative w-full max-md:grid-cols-2 ${I}`,children:n.images?.map(xe=>h.jsx("div",{className:"aspect-[200/300] content-stretch flex flex-[1_0_0] flex-col items-start min-h-px min-w-px overflow-clip relative rounded-[26px] shadow-[0px_2px_8px_0px_#eaeaea] shrink-0",children:h.jsx("div",{className:"flex-[1_0_0] min-h-px min-w-px relative rounded-[26px] shrink-0 w-full",children:h.jsx("img",{className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[26px] size-full",alt:xe.alt||"",src:ze(xe).width(400).height(600).url()})})},xe._key))}),n.title&&h.jsx("p",{className:"font-normal pt-4 leading-5 relative shrink-0 text-gray-400 text-base text-center w-full",children:n.title})]});case"textSection":return n.layout==="two-col"?h.jsxs("div",{className:"flex gap-20 items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full max-md:flex-col max-md:gap-8",children:[h.jsxs("div",{className:"w-[49%] shrink-0 content-stretch flex flex-col gap-3 items-start relative max-md:w-full",children:[n.label&&h.jsx("p",{className:"leading-5 relative uppercase shrink-0 text-[#9ca3af] text-base",children:n.label}),n.heading&&h.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:on(n.heading,n.highlightedText,n.highlightColor)})]}),h.jsx("div",{className:"flex-1 leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap max-md:w-full prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:n.body&&h.jsx(vn,{value:n.body,components:wr})})]}):n.layout==="centered"?h.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.label&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-[#9ca3af] text-base text-center",children:n.label}),n.heading&&h.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black text-center whitespace-pre-line",children:on(n.heading,n.highlightedText,n.highlightColor)}),n.body&&h.jsx("div",{className:"leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap text-center prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 max-w-[600px]",children:h.jsx(vn,{value:n.body,components:wr})})]}):n.layout==="single-col"?h.jsx("div",{className:"content-stretch grid grid-cols-[2fr_1fr_2fr] items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full max-md:flex max-md:flex-col max-md:gap-8",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-3 items-start relative col-start-1",children:[n.label&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-[#9ca3af] text-base",children:n.label}),n.heading&&h.jsx("p",{className:"leading-7 min-w-full relative shrink-0 text-2xl text-black whitespace-pre-wrap",children:on(n.heading,n.highlightedText,n.highlightColor)}),n.body&&h.jsx("div",{className:"leading-normal pt-4 relative text-[#4b5563] max-w-100 text-base whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0 w-full",children:h.jsx(vn,{value:n.body,components:wr})})]})}):h.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.label&&h.jsx("p",{className:"leading-5 relative shrink-0 uppercase text-[#9ca3af] text-base",children:n.label}),n.heading&&h.jsx("p",{className:"leading-7 relative shrink-0 text-2xl text-black whitespace-pre-line",children:on(n.heading,n.highlightedText,n.highlightColor)}),n.body&&h.jsx("div",{className:"leading-normal relative text-[#4b5563] text-base whitespace-pre-wrap prose prose-p:my-6 prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2 first:prose-p:mt-0 last:prose-p:mb-0",children:h.jsx(vn,{value:n.body,components:wr})})]});case"imageSection":const N=n.externalImageUrl?n.externalImageUrl:n.image?ze(n.image).width(2400).url():null;if(!N)return null;const P={full:"w-full",large:"w-full max-w-[900px]",medium:"w-full max-w-[600px]",small:"w-full max-w-[400px]"},O=n.size||"large",M=P[O]||P.large;return h.jsxs("div",{className:J("content-stretch flex flex-col py-10 relative shrink-0 w-full",O==="full"?"items-start px-8 md:px-[8%] xl:px-[175px]":"items-center px-8"),children:[h.jsx("div",{className:J("overflow-hidden",M,n.rounded!==!1&&"rounded-[26px]"),children:h.jsx("img",{className:"w-full object-cover",alt:n.alt||"",src:N})}),n.caption&&h.jsx("p",{className:J("mt-3 text-center text-gray-400",M),children:n.caption})]});case"overlayImageSection":const D=n.externalBaseImageUrl?n.externalBaseImageUrl:n.baseImage?ze(n.baseImage).width(2400).url():null,B=n.externalOverlayImageUrl?n.externalOverlayImageUrl:n.overlayImage?ze(n.overlayImage).width(800).url():null;if(!D)return null;const q={full:"w-full",large:"w-full max-w-[900px]",medium:"w-full max-w-[600px]",small:"w-full max-w-[400px]"},ie=n.size||"large",te=q[ie]||q.large,re=n.overlaySize==="small"?"w-80":n.overlaySize==="large"?"w-120":"w-100",ee=n.overlayPosition?.x??50,Q=n.overlayPosition?.y??50,G=!!n.backgroundColor;return h.jsx("div",{className:J("content-stretch flex flex-col relative shrink-0 w-full",G&&"py-10"),children:h.jsx("div",{className:J("flex flex-col relative shrink-0 w-full",ie==="full"?"items-start px-8 md:px-[8%] xl:px-[175px]":"items-center px-8",!G&&"py-10"),style:{backgroundColor:n.backgroundColor||"transparent"},children:h.jsxs("div",{className:J("relative",te,n.rounded!==!1&&"rounded-[26px]"),children:[h.jsx("img",{className:J("w-full object-cover",n.rounded!==!1&&"rounded-[26px]"),alt:"",src:D}),B&&h.jsx("img",{src:B,alt:"",className:J("absolute",re,"pointer-events-none"),style:{left:`${ee}%`,top:`${Q}%`,transform:"translate(-50%, -50%)"}})]})})});case"videoSection":const Y=xe=>{const yt=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/];for(const dn of yt){const fr=xe.match(dn);if(fr)return fr[1]}return null},Z=xe=>{const yt=xe.match(/vimeo\.com\/(\d+)/);return yt?yt[1]:null},j=n.youtubeUrl?Y(n.youtubeUrl):null,$=n.vimeoUrl?Z(n.vimeoUrl):null,ne=(n.size||"full")==="medium"?"max-w-[800px]":"w-full";return h.jsx("div",{className:"content-stretch flex flex-col items-center px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",style:{backgroundColor:n.backgroundColor||"transparent"},children:h.jsxs("div",{className:J("w-full",ne),children:[n.videoType==="mux"&&n.muxPlaybackId&&h.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-3xl",children:h.jsx(Os,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"w-full h-full object-cover",controls:!1,autoPlay:!0,muted:!0,loop:!0,poster:n.posterImage?ze(n.posterImage).width(1200).url():`https://image.mux.com/${n.muxPlaybackId}/thumbnail.png`})}),n.videoType==="youtube"&&j&&h.jsx(MO,{videoId:j}),n.videoType==="vimeo"&&$&&h.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-3xl relative pointer-events-none",children:h.jsx("iframe",{src:`https://player.vimeo.com/video/${$}?autoplay=1&muted=1&loop=1&controls=0&background=1`,className:"absolute inset-0 w-full h-full scale-[1.5]",allow:"autoplay; fullscreen; picture-in-picture",title:n.title||"Video"})}),(n.title||n.caption)&&h.jsxs("div",{className:"flex flex-col items-center gap-2 mt-8 text-center",children:[n.title&&h.jsx("p",{className:"text-xl text-black",children:n.title}),n.caption&&h.jsx("p",{className:"text-base text-[#9ca3af]",children:n.caption})]})]})});case"testimonialSection":return h.jsx(qO,{sectionLabel:n.sectionLabel,sectionTitle:n.sectionTitle,highlightedText:n.highlightedText,highlightColor:n.highlightColor,quote:n.quote,fullQuote:n.fullQuote,authorName:n.authorName,authorTitle:n.authorTitle,authorCompany:n.authorCompany,authorImage:n.authorImage,isFullscreen:e});case"projectCardSection":return n.cards&&n.cards.length>0?h.jsx(kO,{cards:n.cards}):null;case"sideQuestSection":return h.jsx(LO,{label:n.label,title:n.title,highlightedText:n.highlightedText,highlightColor:n.highlightColor,subtitle:n.subtitle,image:n.image,imageCaption:n.imageCaption,teamLabel:n.teamLabel,teamMembers:n.teamMembers,description:n.description});case"dividerSection":return h.jsx("div",{className:"px-8 md:px-[8%] xl:px-[175px] py-8 w-full",children:h.jsx("div",{className:"h-px relative shrink-0 w-full",children:h.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})});case"phoneVideoSection":const ae=n.layout!=="video-right",ce=n.mediaType!=="gif",_e=n.externalGifUrl?n.externalGifUrl:n.gifImage?ze(n.gifImage).width(800).url():null;return h.jsx("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:h.jsxs("div",{className:J("flex items-center gap-20 w-full",ae?"flex-row":"flex-row-reverse","max-md:flex-col max-md:gap-8"),children:[h.jsxs("div",{className:"flex items-center justify-center w-[49%] aspect-[1/1] rounded-[26px] shrink-0 max-md:w-full max-md:h-auto max-md:aspect-square p-6",style:{backgroundColor:n.backgroundColor||"#000000"},children:[ce&&n.muxPlaybackId&&h.jsx("div",{className:"w-[90%] h-[90%] overflow-hidden rounded-3xl flex items-center justify-center",children:h.jsx(Os,{src:`https://stream.mux.com/${n.muxPlaybackId}.m3u8`,className:"max-h-full max-w-full object-contain rounded-3xl",controls:!1,autoPlay:!0,muted:!0,loop:!0})}),!ce&&_e&&h.jsx("div",{className:"w-[90%] h-[90%] overflow-hidden rounded-3xl flex items-center justify-center",children:h.jsx("img",{src:_e,alt:"",className:"max-h-full max-w-full object-contain"})})]}),h.jsxs("div",{className:"flex flex-col gap-6 flex-1",children:[n.emoji&&h.jsx("div",{className:"text-5xl",children:n.emoji}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[n.sectionNumber&&h.jsx("p",{className:"text-xl font-normal text-gray-400",children:n.sectionNumber}),n.heading&&h.jsx("h3",{className:"text-xl font-normal text-black leading-normal whitespace-pre-line",children:on(n.heading,n.highlightedText,n.highlightColor)})]}),n.subheading&&h.jsx("p",{className:"text-base text-gray-500 max-w-100 leading-normal whitespace-pre-line",children:n.subheading}),n.bulletPoints&&n.bulletPoints.length>0&&h.jsx("ul",{className:"flex flex-col gap-3",children:n.bulletPoints.map((xe,yt)=>h.jsxs("li",{className:"flex items-start gap-3 text-gray-600",children:[h.jsx("span",{className:"text-gray-600 mt-0.5 font-bold",children:""}),h.jsx("span",{className:"flex-1 leading-normal",children:xe})]},yt))})]})]})]})});case"learningsSection":return h.jsxs("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.sectionTitle&&h.jsx("h3",{className:"text-2xl font-normal text-black mb-8",children:n.sectionTitle}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 w-full",children:n.learnings?.map(xe=>h.jsxs("div",{className:"flex flex-col gap-3 py-6 px-6 rounded-3xl",children:[xe.emoji&&h.jsx("div",{className:"text-4xl",children:xe.emoji}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsx("h4",{className:"text-xl font-medium text-gray-700",children:xe.title}),xe.description&&h.jsx("p",{className:"text-base text-gray-400 leading-relaxed",children:xe.description})]})]},xe._key))})]});case"sectionTitleSection":const Ee=n.isSkipLinkStart?s:n.isSkipLinkEnd?i:void 0;return h.jsxs("div",{ref:Ee,"data-section-number":n.number,className:"content-stretch flex flex-col gap-5 items-start justify-center px-8 md:px-[8%] xl:px-[175px] py-16 relative shrink-0 w-full",children:[h.jsxs("div",{className:"content-stretch flex font-normal gap-5 items-start leading-7 relative shrink-0 text-2xl w-full",children:[n.number&&h.jsx("p",{className:"relative shrink-0",style:{color:n.numberColor||"#7fa2ff"},children:n.number}),n.title&&h.jsx("p",{className:"relative shrink-0",style:{color:n.titleColor||"#2e5ede"},children:n.title})]}),n.showLine!==!1&&h.jsx("div",{className:"h-px relative shrink-0 w-full",children:h.jsx("div",{className:"absolute inset-0",style:{backgroundColor:n.lineColor||"#e5e7eb"}})}),n.subtitle&&h.jsx("p",{className:"text-lg -mt-1 text-gray-400 font-normal whitespace-pre-wrap",children:n.subtitle})]});case"twoColumnTextImageSection":const Le=n.backgroundColor||"#FFFFFF",oe=n.imageUrl?n.imageUrl:n.image?ze(n.image).width(1200).url():null;return h.jsxs("div",{className:"content-stretch flex flex-col py-8 max-md:flex-col w-full relative shrink-0",children:[h.jsxs("div",{className:"max-md:w-full px-8 md:px-[8%] xl:px-[175px] flex flex-col ",children:[n.heading&&h.jsx("h2",{className:"text-lg font-normal text-gray-600 whitespace-pre-wrap",children:on(n.heading,n.highlightedText,n.highlightColor)}),n.textContent&&n.textContent.length>0&&h.jsx("div",{className:"text-base text-gray-600 leading-normal prose prose-ul:list-disc prose-ul:ml-5 prose-ul:space-y-2 prose-ol:list-decimal prose-ol:ml-5 prose-ol:space-y-2",children:h.jsx(vn,{value:n.textContent,components:wr})})]}),h.jsx("div",{className:"max-md:w-full relative -mt-3 max-md:min-h-[300px] flex items-center justify-center px-8 md:px-[8%] xl:px-[175px] py-8",children:oe&&h.jsx("div",{className:"inline-block rounded-3xl",style:{backgroundColor:Le},children:h.jsx("img",{src:oe,alt:"",className:"block max-w-full max-h-full object-contain rounded-lg"})})})]});case"statsCardSection":const Re=n.statColor||"#ec4899",We=n.titleColor||"#9ca3af",Ie={"2-col":"grid-cols-1 md:grid-cols-2","3-col":"grid-cols-1 md:grid-cols-3","4-col":"grid-cols-2 md:grid-cols-4"}[n.layout||"3-col"],Me=xe=>xe.split(/(\*\*[^*]+\*\*)/g).map((dn,fr)=>dn.startsWith("**")&&dn.endsWith("**")?h.jsx("strong",{className:"font-semibold",children:dn.slice(2,-2)},fr):dn);return h.jsxs("div",{className:"content-stretch flex flex-col items-start px-8 md:px-[8%] xl:px-[175px] py-10 relative shrink-0 w-full",children:[n.sectionTitle&&h.jsxs("div",{className:"flex items-center gap-6 w-full mb-10",children:[h.jsx("span",{className:"text-xl italic whitespace-nowrap",style:{color:We},children:n.sectionTitle}),n.showDividerLine!==!1&&h.jsx("div",{className:"flex-1 h-px bg-gray-200"})]}),n.cards&&n.cards.length>0&&h.jsx("div",{className:J("grid gap-8 w-full",Ie),children:n.cards.map(xe=>{const yt=xe.statColorOverride||Re;return h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("span",{className:"text-5xl font-light italic leading-none shrink-0",style:{color:yt},children:xe.statValue}),xe.description&&h.jsx("p",{className:"text-base text-gray-700 leading-snug pt-2",children:Me(xe.description)})]},xe._key)})})]});case"highlightCardSection":const we=n.backgroundColor||"transparent",Je={"2-col":"grid-cols-1 md:grid-cols-2 px-8 md:px-[8%] xl:px-[175px]","3-col":"grid-cols-1 md:grid-cols-2 gap-4 lg:grid-cols-3 px-8 md:px-[8%] xl:px-[175px]",stacked:"grid-cols-1"}[n.layout||"2-col"],Yt=(xe,yt)=>xe==="with-border"?"border border-gray-50 shadow-default rounded-3xl":xe==="no-bg"?"":yt?"rounded-3xl":"bg-gray-50 rounded-3xl",Et={square:"aspect-square",landscape:"aspect-video",portrait:"aspect-[3/4]",auto:""},nn={none:"rounded-none",small:"rounded-lg",medium:"rounded-xl",large:"rounded-2xl",full:"rounded-full"};return h.jsx("div",{className:"content-stretch flex flex-col px-0 pb-10 relative shrink-0 w-full",style:{backgroundColor:we},children:n.cards&&n.cards.length>0&&h.jsx("div",{className:J("grid w-full",Je,n.layout==="stacked"?"px-8 md:px-[8%] xl:px-[175px]":"",n.showDividers?"divide-y divide-gray-200 [&>*]:py-16":"gap-12"),children:n.cards.map(xe=>{const yt=xe.externalImageUrl?xe.externalImageUrl:xe.image?ze(xe.image).width(800).url():null,dn=Yt(n.cardStyle||"with-bg",xe.cardBackgroundColor),fr=Et[xe.imageAspectRatio||"landscape"],Ka=xe.cardLayout!=="side-by-side",za=xe.imagePosition!=="right",Pi=nn[xe.imageRoundedCorners||"medium"];return Ka?h.jsxs("div",{className:J("flex gap-6 p-12 py-16 items-start",za?"flex-col":"flex-col-reverse","max-md:flex-col",dn,n.showDividers&&"py-8"),style:{backgroundColor:xe.cardBackgroundColor},children:[yt&&h.jsx("div",{className:J("w-20 h-20 shrink-0 overflow-hidden max-md:w-full max-md:h-auto",Pi,!fr&&"max-md:aspect-video"),children:h.jsx("img",{src:yt,alt:"",className:"w-full h-full object-cover"})}),h.jsxs("div",{className:"flex flex-col gap-2 flex-1",children:[h.jsx("h3",{className:J(xe.headline.length<5?"text-3xl":"text-xl","font-normal leading-tight whitespace-pre-wrap"),style:{color:xe.headlineColor||"#111827"},children:on(xe.headline,xe.highlightedText,xe.highlightColor)}),xe.description&&xe.description.length>0&&h.jsx("div",{className:"text-base text-gray-600 leading-relaxed",children:h.jsx(vn,{value:xe.description,components:wr})})]})]},xe._key):h.jsxs("div",{className:J("flex flex-1 flex-row w-full gap-12 px-8 p-6",dn,n.showDividers&&"py-8"),style:{backgroundColor:xe.cardBackgroundColor},children:[h.jsx("h3",{className:J(xe.headline.length<5?"text-3xl":"text-xl","w-56 font-normal leading-normal whitespace-pre-wrap"),style:{color:xe.headlineColor||"#111827"},children:on(xe.headline,xe.highlightedText,xe.highlightColor)}),yt&&h.jsx("div",{className:J("h-24 shrink-0 object-center overflow-hidden",Pi),children:h.jsx("img",{src:yt,alt:"",className:"h-full w-auto object-contain"})}),h.jsx("div",{className:"flex flex-1 flex-col justify-center items-stretch",children:xe.description&&xe.description.length>0&&h.jsx("div",{className:"text-base text-gray-500 self-end max-w-120 leading-relaxed",children:h.jsx(vn,{value:xe.description,components:wr})})})]},xe._key)})})});case"sectionHeaderBar":const En=n.backgroundColor||"#fdf2f8",Fr=n.textColor||"#ec4899",cs={small:"w-8 h-8",medium:"w-12 h-12",large:"w-16 h-16"}[n.imageSize||"medium"],us={small:"py-4",normal:"py-6",large:"py-10"}[n.verticalPadding||"normal"],Ur=n.leftImageUrl?n.leftImageUrl:n.leftImage?ze(n.leftImage).width(128).height(128).url():null,ds=n.rightImageUrl?n.rightImageUrl:n.rightImage?ze(n.rightImage).width(128).height(128).url():null;return h.jsxs("div",{className:J("content-stretch flex items-center justify-between px-8 md:px-[8%] xl:px-[175px] relative shrink-0 w-full",us),style:{backgroundColor:En},children:[h.jsxs("div",{className:"flex items-center gap-4",children:[Ur&&h.jsx("div",{className:J("rounded-lg overflow-hidden shrink-0",cs),children:h.jsx("img",{src:Ur,alt:"",className:"w-full h-full object-cover"})}),n.number&&h.jsx("span",{className:"text-2xl font-normal",style:{color:Fr},children:n.number})]}),n.title&&h.jsx("span",{className:"text-2xl font-semibold",style:{color:Fr},children:n.title}),h.jsxs("div",{className:"flex items-center gap-4",children:[n.subtitle&&h.jsx("span",{className:"text-2xl font-normal",style:{color:Fr},children:n.subtitle}),ds&&h.jsx("div",{className:J("rounded-lg overflow-hidden shrink-0",cs),children:h.jsx("img",{src:ds,alt:"",className:"w-full h-full object-cover"})})]})]});case"tableOfContentsSection":const dr=n.backgroundColor||"#f3f4f6",rn=n.accentColor||"#ec4899",Ad=n.sectionNumber||n.sectionTitle||n.subtitle||n.hintText||n.sectionDescription;return h.jsxs("div",{className:"content-stretch flex flex-col items-start gap-12 px-6 md:px-6 xl:px-[175px] py-16 relative shrink-0 w-full",style:{backgroundColor:dr},children:[Ad&&h.jsxs("div",{className:"w-full mx-auto gap-2 flex flex-col items-start",children:[(n.sectionNumber||n.sectionTitle||n.subtitle)&&h.jsxs("div",{className:"flex items-center gap-4",children:[n.sectionNumber&&h.jsx("span",{className:"text-2xl font-normal",style:{color:rn},children:n.sectionNumber}),n.sectionTitle&&h.jsx("span",{className:"text-2xl font-semibold",style:{color:rn},children:n.sectionTitle}),n.subtitle&&h.jsx("span",{className:"text-2xl font-normal",style:{color:rn},children:n.subtitle})]}),n.hintText&&h.jsx("div",{className:"flex items-center text-gray-500",children:h.jsx("span",{className:"text-base",children:n.hintText})}),n.sectionDescription&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-full h-px bg-gray-300 mt-4"}),h.jsx("p",{className:"text-base text-gray-400 mt-4 whitespace-pre-wrap",children:n.sectionDescription})]})]}),n.items&&n.items.length>0&&h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 w-full",children:n.items.map(xe=>{const yt=xe.externalImageUrl?xe.externalImageUrl:xe.image?ze(xe.image).width(200).height(200).url():null;return h.jsxs("button",{type:"button",onClick:()=>{if(xe.targetSectionId&&a?.current){const dn=a.current.querySelector(`[data-section-number="${xe.targetSectionId}"]`);dn&&dn.scrollIntoView({behavior:"smooth",block:"start"})}},className:"flex flex-col items-start gap-3 p-8 py-12 bg-white rounded-3xl shadow-default hover:shadow-2xl hover:scale-[1.005] transition-all duration-200 cursor-pointer text-left group",children:[yt&&h.jsx("div",{className:"w-16 h-16 shadow-none rounded-xl overflow-hidden bg-gray-100",children:h.jsx("img",{src:yt,alt:"",className:"w-full h-full object-cover"})}),h.jsxs("div",{className:"flex flex-col gap-1",children:[xe.number&&h.jsx("span",{className:"text-xl text-gray-400",children:xe.number}),h.jsx("span",{className:"text-xl text-gray-900",children:xe.title})]})]},xe._key)})})]});case"twoColumnImageSection":return h.jsx(RO,{section:n,renderHighlightedText:on,portableTextComponents:wr});default:return null}})();return f?n._type==="testimonialSection"?f:h.jsx(Be,{children:f}):null}const n_=L.createContext({});function YO(n){const e=L.useRef(null);return e.current===null&&(e.current=n()),e.current}const S0=typeof window<"u",QO=S0?L.useLayoutEffect:L.useEffect,E0=L.createContext(null);function T0(n,e){n.indexOf(e)===-1&&n.push(e)}function _0(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Lr=(n,e,t)=>t>e?e:t<n?n:t;let k0=()=>{};const is={},r_=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function s_(n){return typeof n=="object"&&n!==null}const i_=n=>/^0[^.\s]+$/u.test(n);function C0(n){let e;return()=>(e===void 0&&(e=n()),e)}const Gn=n=>n,XO=(n,e)=>t=>e(n(t)),Cl=(...n)=>n.reduce(XO),ul=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class A0{constructor(){this.subscriptions=[]}add(e){return T0(this.subscriptions,e),()=>_0(this.subscriptions,e)}notify(e,t,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,t,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const es=n=>n*1e3,Vn=n=>n/1e3;function a_(n,e){return e?n*(1e3/e):0}const o_=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,ZO=1e-7,JO=12;function eM(n,e,t,r,s){let i,a,l=0;do a=e+(t-e)/2,i=o_(a,r,s)-n,i>0?t=a:e=a;while(Math.abs(i)>ZO&&++l<JO);return a}function Al(n,e,t,r){if(n===e&&t===r)return Gn;const s=i=>eM(i,0,1,n,t);return i=>i===0||i===1?i:o_(s(i),e,r)}const l_=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,c_=n=>e=>1-n(1-e),u_=Al(.33,1.53,.69,.99),I0=c_(u_),d_=l_(I0),f_=n=>(n*=2)<1?.5*I0(n):.5*(2-Math.pow(2,-10*(n-1))),L0=n=>1-Math.sin(Math.acos(n)),h_=c_(L0),m_=l_(L0),tM=Al(.42,0,1,1),nM=Al(0,0,.58,1),p_=Al(.42,0,.58,1),rM=n=>Array.isArray(n)&&typeof n[0]!="number",g_=n=>Array.isArray(n)&&typeof n[0]=="number",sM={linear:Gn,easeIn:tM,easeInOut:p_,easeOut:nM,circIn:L0,circInOut:m_,circOut:h_,backIn:I0,backInOut:d_,backOut:u_,anticipate:f_},iM=n=>typeof n=="string",u2=n=>{if(g_(n)){k0(n.length===4);const[e,t,r,s]=n;return Al(e,t,r,s)}else if(iM(n))return sM[n];return n},ou=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function aM(n,e){let t=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(f){a.has(f)&&(d.schedule(f),n()),f(l)}const d={schedule:(f,m=!1,g=!1)=>{const y=g&&s?t:r;return m&&a.add(f),y.has(f)||y.add(f),f},cancel:f=>{r.delete(f),a.delete(f)},process:f=>{if(l=f,s){i=!0;return}s=!0,[t,r]=[r,t],t.forEach(u),t.clear(),s=!1,i&&(i=!1,d.process(f))}};return d}const oM=40;function x_(n,e){let t=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>t=!0,a=ou.reduce((_,A)=>(_[A]=aM(i),_),{}),{setup:l,read:u,resolveKeyframes:d,preUpdate:f,update:m,preRender:g,render:x,postRender:y}=a,w=()=>{const _=is.useManualTiming?s.timestamp:performance.now();t=!1,is.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(_-s.timestamp,oM),1)),s.timestamp=_,s.isProcessing=!0,l.process(s),u.process(s),d.process(s),f.process(s),m.process(s),g.process(s),x.process(s),y.process(s),s.isProcessing=!1,t&&e&&(r=!1,n(w))},b=()=>{t=!0,r=!0,s.isProcessing||n(w)};return{schedule:ou.reduce((_,A)=>{const I=a[A];return _[A]=(N,P=!1,O=!1)=>(t||b(),I.schedule(N,P,O)),_},{}),cancel:_=>{for(let A=0;A<ou.length;A++)a[ou[A]].cancel(_)},state:s,steps:a}}const{schedule:lt,cancel:Ks,state:Ht,steps:im}=x_(typeof requestAnimationFrame<"u"?requestAnimationFrame:Gn,!0);let Eu;function lM(){Eu=void 0}const cn={now:()=>(Eu===void 0&&cn.set(Ht.isProcessing||is.useManualTiming?Ht.timestamp:performance.now()),Eu),set:n=>{Eu=n,queueMicrotask(lM)}},y_=n=>e=>typeof e=="string"&&e.startsWith(n),v_=y_("--"),cM=y_("var(--"),R0=n=>cM(n)?uM.test(n.split("/*")[0].trim()):!1,uM=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function d2(n){return typeof n!="string"?!1:n.split("/*")[0].includes("var(--")}const Va={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},dl={...Va,transform:n=>Lr(0,1,n)},lu={...Va,default:1},Qo=n=>Math.round(n*1e5)/1e5,P0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function dM(n){return n==null}const fM=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,D0=(n,e)=>t=>!!(typeof t=="string"&&fM.test(t)&&t.startsWith(n)||e&&!dM(t)&&Object.prototype.hasOwnProperty.call(t,e)),w_=(n,e,t)=>r=>{if(typeof r!="string")return r;const[s,i,a,l]=r.match(P0);return{[n]:parseFloat(s),[e]:parseFloat(i),[t]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},hM=n=>Lr(0,255,n),am={...Va,transform:n=>Math.round(hM(n))},vi={test:D0("rgb","red"),parse:w_("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+am.transform(n)+", "+am.transform(e)+", "+am.transform(t)+", "+Qo(dl.transform(r))+")"};function mM(n){let e="",t="",r="",s="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),s=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),s=n.substring(4,5),e+=e,t+=t,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const ap={test:D0("#"),parse:mM,transform:vi.transform},Il=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Ds=Il("deg"),Cr=Il("%"),be=Il("px"),pM=Il("vh"),gM=Il("vw"),f2={...Cr,parse:n=>Cr.parse(n)/100,transform:n=>Cr.transform(n*100)},ha={test:D0("hsl","hue"),parse:w_("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+Cr.transform(Qo(e))+", "+Cr.transform(Qo(t))+", "+Qo(dl.transform(r))+")"},It={test:n=>vi.test(n)||ap.test(n)||ha.test(n),parse:n=>vi.test(n)?vi.parse(n):ha.test(n)?ha.parse(n):ap.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?vi.transform(n):ha.transform(n),getAnimatableNone:n=>{const e=It.parse(n);return e.alpha=0,It.transform(e)}},xM=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function yM(n){return isNaN(n)&&typeof n=="string"&&(n.match(P0)?.length||0)+(n.match(xM)?.length||0)>0}const b_="number",S_="color",vM="var",wM="var(",h2="${}",bM=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function fl(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},s=[];let i=0;const l=e.replace(bM,u=>(It.test(u)?(r.color.push(i),s.push(S_),t.push(It.parse(u))):u.startsWith(wM)?(r.var.push(i),s.push(vM),t.push(u)):(r.number.push(i),s.push(b_),t.push(parseFloat(u))),++i,h2)).split(h2);return{values:t,split:l,indexes:r,types:s}}function E_(n){return fl(n).values}function T_(n){const{split:e,types:t}=fl(n),r=e.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=e[a],s[a]!==void 0){const l=t[a];l===b_?i+=Qo(s[a]):l===S_?i+=It.transform(s[a]):i+=s[a]}return i}}const SM=n=>typeof n=="number"?0:It.test(n)?It.getAnimatableNone(n):n;function EM(n){const e=E_(n);return T_(n)(e.map(SM))}const zs={test:yM,parse:E_,createTransformer:T_,getAnimatableNone:EM};function om(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function TM({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let s=0,i=0,a=0;if(!e)s=i=a=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;s=om(u,l,n+1/3),i=om(u,l,n),a=om(u,l,n-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function Ju(n,e){return t=>t>0?e:n}const gt=(n,e,t)=>n+(e-n)*t,lm=(n,e,t)=>{const r=n*n,s=t*(e*e-r)+r;return s<0?0:Math.sqrt(s)},_M=[ap,vi,ha],kM=n=>_M.find(e=>e.test(n));function m2(n){const e=kM(n);if(!e)return!1;let t=e.parse(n);return e===ha&&(t=TM(t)),t}const p2=(n,e)=>{const t=m2(n),r=m2(e);if(!t||!r)return Ju(n,e);const s={...t};return i=>(s.red=lm(t.red,r.red,i),s.green=lm(t.green,r.green,i),s.blue=lm(t.blue,r.blue,i),s.alpha=gt(t.alpha,r.alpha,i),vi.transform(s))},op=new Set(["none","hidden"]);function CM(n,e){return op.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function AM(n,e){return t=>gt(n,e,t)}function N0(n){return typeof n=="number"?AM:typeof n=="string"?R0(n)?Ju:It.test(n)?p2:RM:Array.isArray(n)?__:typeof n=="object"?It.test(n)?p2:IM:Ju}function __(n,e){const t=[...n],r=t.length,s=n.map((i,a)=>N0(i)(i,e[a]));return i=>{for(let a=0;a<r;a++)t[a]=s[a](i);return t}}function IM(n,e){const t={...n,...e},r={};for(const s in t)n[s]!==void 0&&e[s]!==void 0&&(r[s]=N0(n[s])(n[s],e[s]));return s=>{for(const i in r)t[i]=r[i](s);return t}}function LM(n,e){const t=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],a=n.indexes[i][r[i]],l=n.values[a]??0;t[s]=l,r[i]++}return t}const RM=(n,e)=>{const t=zs.createTransformer(e),r=fl(n),s=fl(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?op.has(n)&&!s.values.length||op.has(e)&&!r.values.length?CM(n,e):Cl(__(LM(r,s),s.values),t):Ju(n,e)};function k_(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?gt(n,e,t):N0(n)(n,e)}const PM=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>lt.update(e,t),stop:()=>Ks(e),now:()=>Ht.isProcessing?Ht.timestamp:cn.now()}},C_=(n,e,t=10)=>{let r="";const s=Math.max(Math.round(e/t),2);for(let i=0;i<s;i++)r+=Math.round(n(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},ed=2e4;function j0(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<ed;)e+=t,r=n.next(e);return e>=ed?1/0:e}function DM(n,e=100,t){const r=t({...n,keyframes:[0,e]}),s=Math.min(j0(r),ed);return{type:"keyframes",ease:i=>r.next(s*i).value/e,duration:Vn(s)}}const NM=5;function A_(n,e,t){const r=Math.max(e-NM,0);return a_(t-n(r),e-r)}const bt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},cm=.001;function jM({duration:n=bt.duration,bounce:e=bt.bounce,velocity:t=bt.velocity,mass:r=bt.mass}){let s,i,a=1-e;a=Lr(bt.minDamping,bt.maxDamping,a),n=Lr(bt.minDuration,bt.maxDuration,Vn(n)),a<1?(s=d=>{const f=d*a,m=f*n,g=f-t,x=lp(d,a),y=Math.exp(-m);return cm-g/x*y},i=d=>{const m=d*a*n,g=m*t+t,x=Math.pow(a,2)*Math.pow(d,2)*n,y=Math.exp(-m),w=lp(Math.pow(d,2),a);return(-s(d)+cm>0?-1:1)*((g-x)*y)/w}):(s=d=>{const f=Math.exp(-d*n),m=(d-t)*n+1;return-cm+f*m},i=d=>{const f=Math.exp(-d*n),m=(t-d)*(n*n);return f*m});const l=5/n,u=MM(s,i,l);if(n=es(n),isNaN(u))return{stiffness:bt.stiffness,damping:bt.damping,duration:n};{const d=Math.pow(u,2)*r;return{stiffness:d,damping:a*2*Math.sqrt(r*d),duration:n}}}const OM=12;function MM(n,e,t){let r=t;for(let s=1;s<OM;s++)r=r-n(r)/e(r);return r}function lp(n,e){return n*Math.sqrt(1-e*e)}const FM=["duration","bounce"],BM=["stiffness","damping","mass"];function g2(n,e){return e.some(t=>n[t]!==void 0)}function UM(n){let e={velocity:bt.velocity,stiffness:bt.stiffness,damping:bt.damping,mass:bt.mass,isResolvedFromDuration:!1,...n};if(!g2(n,BM)&&g2(n,FM))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),s=r*r,i=2*Lr(.05,1,1-(n.bounce||0))*Math.sqrt(s);e={...e,mass:bt.mass,stiffness:s,damping:i}}else{const t=jM(n);e={...e,...t,mass:bt.mass},e.isResolvedFromDuration=!0}return e}function td(n=bt.visualDuration,e=bt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:s}=t;const i=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],l={done:!1,value:i},{stiffness:u,damping:d,mass:f,duration:m,velocity:g,isResolvedFromDuration:x}=UM({...t,velocity:-Vn(t.velocity||0)}),y=g||0,w=d/(2*Math.sqrt(u*f)),b=a-i,E=Vn(Math.sqrt(u/f)),T=Math.abs(b)<5;r||(r=T?bt.restSpeed.granular:bt.restSpeed.default),s||(s=T?bt.restDelta.granular:bt.restDelta.default);let _;if(w<1){const I=lp(E,w);_=N=>{const P=Math.exp(-w*E*N);return a-P*((y+w*E*b)/I*Math.sin(I*N)+b*Math.cos(I*N))}}else if(w===1)_=I=>a-Math.exp(-E*I)*(b+(y+E*b)*I);else{const I=E*Math.sqrt(w*w-1);_=N=>{const P=Math.exp(-w*E*N),O=Math.min(I*N,300);return a-P*((y+w*E*b)*Math.sinh(O)+I*b*Math.cosh(O))/I}}const A={calculatedDuration:x&&m||null,next:I=>{const N=_(I);if(x)l.done=I>=m;else{let P=I===0?y:0;w<1&&(P=I===0?es(y):A_(_,I,N));const O=Math.abs(P)<=r,M=Math.abs(a-N)<=s;l.done=O&&M}return l.value=l.done?a:N,l},toString:()=>{const I=Math.min(j0(A),ed),N=C_(P=>A.next(I*P).value,I,30);return I+"ms "+N},toTransition:()=>{}};return A}td.applyToOptions=n=>{const e=DM(n,100,td);return n.ease=e.ease,n.duration=es(e.duration),n.type="keyframes",n};function cp({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:u,restDelta:d=.5,restSpeed:f}){const m=n[0],g={done:!1,value:m},x=O=>l!==void 0&&O<l||u!==void 0&&O>u,y=O=>l===void 0?u:u===void 0||Math.abs(l-O)<Math.abs(u-O)?l:u;let w=t*e;const b=m+w,E=a===void 0?b:a(b);E!==b&&(w=E-m);const T=O=>-w*Math.exp(-O/r),_=O=>E+T(O),A=O=>{const M=T(O),D=_(O);g.done=Math.abs(M)<=d,g.value=g.done?E:D};let I,N;const P=O=>{x(g.value)&&(I=O,N=td({keyframes:[g.value,y(g.value)],velocity:A_(_,O,g.value),damping:s,stiffness:i,restDelta:d,restSpeed:f}))};return P(0),{calculatedDuration:null,next:O=>{let M=!1;return!N&&I===void 0&&(M=!0,A(O),P(O)),I!==void 0&&O>=I?N.next(O-I):(!M&&A(O),g)}}}function $M(n,e,t){const r=[],s=t||is.mix||k_,i=n.length-1;for(let a=0;a<i;a++){let l=s(n[a],n[a+1]);if(e){const u=Array.isArray(e)?e[a]||Gn:e;l=Cl(u,l)}r.push(l)}return r}function VM(n,e,{clamp:t=!0,ease:r,mixer:s}={}){const i=n.length;if(k0(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[i-1]&&(n=[...n].reverse(),e=[...e].reverse());const l=$M(e,r,s),u=l.length,d=f=>{if(a&&f<n[0])return e[0];let m=0;if(u>1)for(;m<n.length-2&&!(f<n[m+1]);m++);const g=ul(n[m],n[m+1],f);return l[m](g)};return t?f=>d(Lr(n[0],n[i-1],f)):d}function GM(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const s=ul(0,e,r);n.push(gt(t,1,s))}}function HM(n){const e=[0];return GM(e,n.length-1),e}function KM(n,e){return n.map(t=>t*e)}function zM(n,e){return n.map(()=>e||p_).splice(0,n.length-1)}function Xo({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const s=rM(r)?r.map(u2):u2(r),i={done:!1,value:e[0]},a=KM(t&&t.length===e.length?t:HM(e),n),l=VM(a,e,{ease:Array.isArray(s)?s:zM(e,s)});return{calculatedDuration:n,next:u=>(i.value=l(u),i.done=u>=n,i)}}const WM=n=>n!==null;function O0(n,{repeat:e,repeatType:t="loop"},r,s=1){const i=n.filter(WM),l=s<0||e&&t!=="loop"&&e%2===1?0:i.length-1;return!l||r===void 0?i[l]:r}const qM={decay:cp,inertia:cp,tween:Xo,keyframes:Xo,spring:td};function I_(n){typeof n.type=="string"&&(n.type=qM[n.type])}class M0{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const YM=n=>n/100;class F0 extends M0{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==cn.now()&&this.tick(cn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;I_(e);const{type:t=Xo,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=e;let{keyframes:l}=e;const u=t||Xo;u!==Xo&&typeof l[0]!="number"&&(this.mixKeyframes=Cl(YM,k_(l[0],l[1])),l=[0,100]);const d=u({...e,keyframes:l});i==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...l].reverse(),velocity:-a})),d.calculatedDuration===null&&(d.calculatedDuration=j0(d));const{calculatedDuration:f}=d;this.calculatedDuration=f,this.resolvedDuration=f+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=d}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:l,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:f,repeat:m,repeatType:g,repeatDelay:x,type:y,onUpdate:w,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const E=this.currentTime-d*(this.playbackSpeed>=0?1:-1),T=this.playbackSpeed>=0?E<0:E>s;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,A=r;if(m){const O=Math.min(this.currentTime,s)/l;let M=Math.floor(O),D=O%1;!D&&O>=1&&(D=1),D===1&&M--,M=Math.min(M,m+1),!!(M%2)&&(g==="reverse"?(D=1-D,x&&(D-=x/l)):g==="mirror"&&(A=a)),_=Lr(0,1,D)*l}const I=T?{done:!1,value:f[0]}:A.next(_);i&&(I.value=i(I.value));let{done:N}=I;!T&&u!==null&&(N=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&N);return P&&y!==cp&&(I.value=O0(f,this.options,b,this.speed)),w&&w(I.value),P&&this.finish(),I}then(e,t){return this.finished.then(e,t)}get duration(){return Vn(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Vn(e)}get time(){return Vn(this.currentTime)}set time(e){e=es(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(cn.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Vn(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=PM,startTime:t}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(cn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function QM(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const wi=n=>n*180/Math.PI,up=n=>{const e=wi(Math.atan2(n[1],n[0]));return dp(e)},XM={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:up,rotateZ:up,skewX:n=>wi(Math.atan(n[1])),skewY:n=>wi(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},dp=n=>(n=n%360,n<0&&(n+=360),n),x2=up,y2=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),v2=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),ZM={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:y2,scaleY:v2,scale:n=>(y2(n)+v2(n))/2,rotateX:n=>dp(wi(Math.atan2(n[6],n[5]))),rotateY:n=>dp(wi(Math.atan2(-n[2],n[0]))),rotateZ:x2,rotate:x2,skewX:n=>wi(Math.atan(n[4])),skewY:n=>wi(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function fp(n){return n.includes("scale")?1:0}function hp(n,e){if(!n||n==="none")return fp(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(t)r=ZM,s=t;else{const l=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=XM,s=l}if(!s)return fp(e);const i=r[e],a=s[1].split(",").map(e7);return typeof i=="function"?i(a):a[i]}const JM=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return hp(t,e)};function e7(n){return parseFloat(n.trim())}const Ga=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ha=new Set(Ga),w2=n=>n===Va||n===be,t7=new Set(["x","y","z"]),n7=Ga.filter(n=>!t7.has(n));function r7(n){const e=[];return n7.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const Fs={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>hp(e,"x"),y:(n,{transform:e})=>hp(e,"y")};Fs.translateX=Fs.x;Fs.translateY=Fs.y;const _i=new Set;let mp=!1,pp=!1,gp=!1;function L_(){if(pp){const n=Array.from(_i).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const s=r7(r);s.length&&(t.set(r,s),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=t.get(r);s&&s.forEach(([i,a])=>{r.getValue(i)?.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}pp=!1,mp=!1,_i.forEach(n=>n.complete(gp)),_i.clear()}function R_(){_i.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(pp=!0)})}function s7(){gp=!0,R_(),L_(),gp=!1}class B0{constructor(e,t,r,s,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(_i.add(this),mp||(mp=!0,lt.read(R_),lt.resolveKeyframes(L_))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:s}=this;if(e[0]===null){const i=s?.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&t){const l=r.readValue(t,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}QM(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),_i.delete(this)}cancel(){this.state==="scheduled"&&(_i.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const i7=n=>n.startsWith("--");function a7(n,e,t){i7(e)?n.style.setProperty(e,t):n.style[e]=t}const o7=C0(()=>window.ScrollTimeline!==void 0),l7={};function c7(n,e){const t=C0(n);return()=>l7[e]??t()}const P_=c7(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Uo=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,b2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Uo([0,.65,.55,1]),circOut:Uo([.55,0,1,.45]),backIn:Uo([.31,.01,.66,-.59]),backOut:Uo([.33,1.53,.69,.99])};function D_(n,e){if(n)return typeof n=="function"?P_()?C_(n,e):"ease-out":g_(n)?Uo(n):Array.isArray(n)?n.map(t=>D_(t,e)||b2.easeOut):b2[n]}function u7(n,e,t,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:l="easeOut",times:u}={},d=void 0){const f={[e]:t};u&&(f.offset=u);const m=D_(l,s);Array.isArray(m)&&(f.easing=m);const g={delay:r,duration:s,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return d&&(g.pseudoElement=d),n.animate(f,g)}function N_(n){return typeof n=="function"&&"applyToOptions"in n}function d7({type:n,...e}){return N_(n)&&P_()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class f7 extends M0{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:t,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:l,onComplete:u}=e;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=e,k0(typeof e.type!="string");const d=d7(e);this.animation=u7(t,r,s,d,i),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const f=O0(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(f):a7(t,r,f),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Vn(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Vn(e)}get time(){return Vn(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=es(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&o7()?(this.animation.timeline=e,Gn):t(this)}}const j_={anticipate:f_,backInOut:d_,circInOut:m_};function h7(n){return n in j_}function m7(n){typeof n.ease=="string"&&h7(n.ease)&&(n.ease=j_[n.ease])}const um=10;class p7 extends f7{constructor(e){m7(e),I_(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const l=new F0({...a,autoplay:!1}),u=Math.max(um,cn.now()-this.startTime),d=Lr(0,um,u-um);t.setWithVelocity(l.sample(Math.max(0,u-d)).value,l.sample(u).value,d),l.stop()}}const S2=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(zs.test(n)||n==="0")&&!n.startsWith("url("));function g7(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function x7(n,e,t,r){const s=n[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=n[n.length-1],a=S2(s,e),l=S2(i,e);return!a||!l?!1:g7(n)||(t==="spring"||N_(t))&&r}function xp(n){n.duration=0,n.type="keyframes"}const y7=new Set(["opacity","clipPath","filter","transform"]),v7=C0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function w7(n){const{motionValue:e,name:t,repeatDelay:r,repeatType:s,damping:i,type:a}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:d}=e.owner.getProps();return v7()&&t&&y7.has(t)&&(t!=="transform"||!d)&&!u&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const b7=40;class S7 extends M0{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:l,name:u,motionValue:d,element:f,...m}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=cn.now();const g={autoplay:e,delay:t,type:r,repeat:s,repeatDelay:i,repeatType:a,name:u,motionValue:d,element:f,...m},x=f?.KeyframeResolver||B0;this.keyframeResolver=new x(l,(y,w,b)=>this.onKeyframesResolved(y,w,g,!b),u,d,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:l,delay:u,isHandoff:d,onUpdate:f}=r;this.resolvedAt=cn.now(),x7(e,i,a,l)||((is.instantAnimations||!u)&&f?.(O0(e,r,t)),e[0]=e[e.length-1],xp(r),r.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>b7?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},x=!d&&w7(g)?new p7({...g,element:g.motionValue.owner.current}):new F0(g);x.finished.then(()=>this.notifyFinished()).catch(Gn),this.pendingTimeline&&(this.stopTimeline=x.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=x}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),s7()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const E7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function T7(n){const e=E7.exec(n);if(!e)return[,];const[,t,r,s]=e;return[`--${t??r}`,s]}function O_(n,e,t=1){const[r,s]=T7(n);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const a=i.trim();return r_(a)?parseFloat(a):a}return R0(s)?O_(s,e,t+1):s}function U0(n,e){return n?.[e]??n?.default??n}const M_=new Set(["width","height","top","left","right","bottom",...Ga]),_7={test:n=>n==="auto",parse:n=>n},F_=n=>e=>e.test(n),B_=[Va,be,Cr,Ds,gM,pM,_7],E2=n=>B_.find(F_(n));function k7(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||i_(n):!0}const C7=new Set(["brightness","contrast","saturate","opacity"]);function A7(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(P0)||[];if(!r)return n;const s=t.replace(r,"");let i=C7.has(e)?1:0;return r!==t&&(i*=100),e+"("+i+s+")"}const I7=/\b([a-z-]*)\(.*?\)/gu,yp={...zs,getAnimatableNone:n=>{const e=n.match(I7);return e?e.map(A7).join(" "):n}},T2={...Va,transform:Math.round},L7={rotate:Ds,rotateX:Ds,rotateY:Ds,rotateZ:Ds,scale:lu,scaleX:lu,scaleY:lu,scaleZ:lu,skew:Ds,skewX:Ds,skewY:Ds,distance:be,translateX:be,translateY:be,translateZ:be,x:be,y:be,z:be,perspective:be,transformPerspective:be,opacity:dl,originX:f2,originY:f2,originZ:be},$0={borderWidth:be,borderTopWidth:be,borderRightWidth:be,borderBottomWidth:be,borderLeftWidth:be,borderRadius:be,radius:be,borderTopLeftRadius:be,borderTopRightRadius:be,borderBottomRightRadius:be,borderBottomLeftRadius:be,width:be,maxWidth:be,height:be,maxHeight:be,top:be,right:be,bottom:be,left:be,inset:be,insetBlock:be,insetBlockStart:be,insetBlockEnd:be,insetInline:be,insetInlineStart:be,insetInlineEnd:be,padding:be,paddingTop:be,paddingRight:be,paddingBottom:be,paddingLeft:be,paddingBlock:be,paddingBlockStart:be,paddingBlockEnd:be,paddingInline:be,paddingInlineStart:be,paddingInlineEnd:be,margin:be,marginTop:be,marginRight:be,marginBottom:be,marginLeft:be,marginBlock:be,marginBlockStart:be,marginBlockEnd:be,marginInline:be,marginInlineStart:be,marginInlineEnd:be,backgroundPositionX:be,backgroundPositionY:be,...L7,zIndex:T2,fillOpacity:dl,strokeOpacity:dl,numOctaves:T2},R7={...$0,color:It,backgroundColor:It,outlineColor:It,fill:It,stroke:It,borderColor:It,borderTopColor:It,borderRightColor:It,borderBottomColor:It,borderLeftColor:It,filter:yp,WebkitFilter:yp},U_=n=>R7[n];function $_(n,e){let t=U_(n);return t!==yp&&(t=zs),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const P7=new Set(["auto","none","0"]);function D7(n,e,t){let r=0,s;for(;r<n.length&&!s;){const i=n[r];typeof i=="string"&&!P7.has(i)&&fl(i).values.length&&(s=n[r]),r++}if(s&&t)for(const i of e)n[i]=$_(t,s)}class N7 extends B0{constructor(e,t,r,s,i){super(e,t,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let f=0;f<e.length;f++){let m=e[f];if(typeof m=="string"&&(m=m.trim(),R0(m))){const g=O_(m,t.current);g!==void 0&&(e[f]=g),f===e.length-1&&(this.finalKeyframe=m)}}if(this.resolveNoneKeyframes(),!M_.has(r)||e.length!==2)return;const[s,i]=e,a=E2(s),l=E2(i),u=d2(s),d=d2(i);if(u!==d&&Fs[r]){this.needsMeasurement=!0;return}if(a!==l)if(w2(a)&&w2(l))for(let f=0;f<e.length;f++){const m=e[f];typeof m=="string"&&(e[f]=parseFloat(m))}else Fs[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||k7(e[s]))&&r.push(s);r.length&&D7(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Fs[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const s=t[t.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(t);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=Fs[t](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function j7(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const s=t?.[n]??r.querySelectorAll(n);return s?Array.from(s):[]}return Array.from(n)}const V_=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function O7(n){return s_(n)&&"offsetHeight"in n}const _2=30,M7=n=>!isNaN(parseFloat(n));class F7{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const s=cn.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=cn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=M7(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new A0);const r=this.events[e].add(t);return e==="change"?()=>{r(),lt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=cn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>_2)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,_2);return a_(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ja(n,e){return new F7(n,e)}const{schedule:V0}=x_(queueMicrotask,!1),or={x:!1,y:!1};function G_(){return or.x||or.y}function B7(n){return n==="x"||n==="y"?or[n]?null:(or[n]=!0,()=>{or[n]=!1}):or.x||or.y?null:(or.x=or.y=!0,()=>{or.x=or.y=!1})}function H_(n,e){const t=j7(n),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[t,s,()=>r.abort()]}function k2(n){return!(n.pointerType==="touch"||G_())}function U7(n,e,t={}){const[r,s,i]=H_(n,t),a=l=>{if(!k2(l))return;const{target:u}=l,d=e(u,l);if(typeof d!="function"||!u)return;const f=m=>{k2(m)&&(d(m),u.removeEventListener("pointerleave",f))};u.addEventListener("pointerleave",f,s)};return r.forEach(l=>{l.addEventListener("pointerenter",a,s)}),i}const K_=(n,e)=>e?n===e?!0:K_(n,e.parentElement):!1,G0=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,$7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function z_(n){return $7.has(n.tagName)||n.isContentEditable===!0}const Tu=new WeakSet;function C2(n){return e=>{e.key==="Enter"&&n(e)}}function dm(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const V7=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=C2(()=>{if(Tu.has(t))return;dm(t,"down");const s=C2(()=>{dm(t,"up")}),i=()=>dm(t,"cancel");t.addEventListener("keyup",s,e),t.addEventListener("blur",i,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function A2(n){return G0(n)&&!G_()}function G7(n,e,t={}){const[r,s,i]=H_(n,t),a=l=>{const u=l.currentTarget;if(!A2(l))return;Tu.add(u);const d=e(u,l),f=(x,y)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",g),Tu.has(u)&&Tu.delete(u),A2(x)&&typeof d=="function"&&d(x,{success:y})},m=x=>{f(x,u===window||u===document||t.useGlobalTarget||K_(u,x.target))},g=x=>{f(x,!1)};window.addEventListener("pointerup",m,s),window.addEventListener("pointercancel",g,s)};return r.forEach(l=>{(t.useGlobalTarget?window:l).addEventListener("pointerdown",a,s),O7(l)&&(l.addEventListener("focus",d=>V7(d,s)),!z_(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),i}function W_(n){return s_(n)&&"ownerSVGElement"in n}function H7(n){return W_(n)&&n.tagName==="svg"}const en=n=>!!(n&&n.getVelocity),K7=[...B_,It,zs],z7=n=>K7.find(F_(n)),q_=L.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function W7(n=!0){const e=L.useContext(E0);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:s}=e,i=L.useId();L.useEffect(()=>{if(n)return s(i)},[n]);const a=L.useCallback(()=>n&&r&&r(i),[i,r,n]);return!t&&r?[!1,a]:[!0]}const Y_=L.createContext({strict:!1}),I2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Oa={};for(const n in I2)Oa[n]={isEnabled:e=>I2[n].some(t=>!!e[t])};function q7(n){for(const e in n)Oa[e]={...Oa[e],...n[e]}}const Y7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nd(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Y7.has(n)}let Q_=n=>!nd(n);function Q7(n){typeof n=="function"&&(Q_=e=>e.startsWith("on")?!nd(e):n(e))}try{Q7(require("@emotion/is-prop-valid").default)}catch{}function X7(n,e,t){const r={};for(const s in n)s==="values"&&typeof n.values=="object"||(Q_(s)||t===!0&&nd(s)||!e&&!nd(s)||n.draggable&&s.startsWith("onDrag"))&&(r[s]=n[s]);return r}const bd=L.createContext({});function Sd(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function hl(n){return typeof n=="string"||Array.isArray(n)}const H0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],K0=["initial",...H0];function Ed(n){return Sd(n.animate)||K0.some(e=>hl(n[e]))}function X_(n){return!!(Ed(n)||n.variants)}function Z7(n,e){if(Ed(n)){const{initial:t,animate:r}=n;return{initial:t===!1||hl(t)?t:void 0,animate:hl(r)?r:void 0}}return n.inherit!==!1?e:{}}function J7(n){const{initial:e,animate:t}=Z7(n,L.useContext(bd));return L.useMemo(()=>({initial:e,animate:t}),[L2(e),L2(t)])}function L2(n){return Array.isArray(n)?n.join(" "):n}function R2(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Oo={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(be.test(n))n=parseFloat(n);else return n;const t=R2(n,e.target.x),r=R2(n,e.target.y);return`${t}% ${r}%`}},eF={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,s=zs.parse(n);if(s.length>5)return r;const i=zs.createTransformer(n),a=typeof s[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;s[0+a]/=l,s[1+a]/=u;const d=gt(l,u,.5);return typeof s[2+a]=="number"&&(s[2+a]/=d),typeof s[3+a]=="number"&&(s[3+a]/=d),i(s)}},vp={borderRadius:{...Oo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Oo,borderTopRightRadius:Oo,borderBottomLeftRadius:Oo,borderBottomRightRadius:Oo,boxShadow:eF};function Z_(n,{layout:e,layoutId:t}){return Ha.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!vp[n]||n==="opacity")}const tF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},nF=Ga.length;function rF(n,e,t){let r="",s=!0;for(let i=0;i<nF;i++){const a=Ga[i],l=n[a];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(a.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const d=V_(l,$0[a]);if(!u){s=!1;const f=tF[a]||a;r+=`${f}(${d}) `}t&&(e[a]=d)}}return r=r.trim(),t?r=t(e,s?"":r):s&&(r="none"),r}function z0(n,e,t){const{style:r,vars:s,transformOrigin:i}=n;let a=!1,l=!1;for(const u in e){const d=e[u];if(Ha.has(u)){a=!0;continue}else if(v_(u)){s[u]=d;continue}else{const f=V_(d,$0[u]);u.startsWith("origin")?(l=!0,i[u]=f):r[u]=f}}if(e.transform||(a||t?r.transform=rF(e,n.transform,t):r.transform&&(r.transform="none")),l){const{originX:u="50%",originY:d="50%",originZ:f=0}=i;r.transformOrigin=`${u} ${d} ${f}`}}const W0=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function J_(n,e,t){for(const r in e)!en(e[r])&&!Z_(r,t)&&(n[r]=e[r])}function sF({transformTemplate:n},e){return L.useMemo(()=>{const t=W0();return z0(t,e,n),Object.assign({},t.vars,t.style)},[e])}function iF(n,e){const t=n.style||{},r={};return J_(r,t,n),Object.assign(r,sF(n,e)),r}function aF(n,e){const t={},r=iF(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const oF={offset:"stroke-dashoffset",array:"stroke-dasharray"},lF={offset:"strokeDashoffset",array:"strokeDasharray"};function cF(n,e,t=1,r=0,s=!0){n.pathLength=1;const i=s?oF:lF;n[i.offset]=be.transform(-r);const a=be.transform(e),l=be.transform(t);n[i.array]=`${a} ${l}`}const uF=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function ek(n,{attrX:e,attrY:t,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...l},u,d,f){if(z0(n,l,d),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:g}=n;m.transform&&(g.transform=m.transform,delete m.transform),(g.transform||m.transformOrigin)&&(g.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),g.transform&&(g.transformBox=f?.transformBox??"fill-box",delete m.transformBox);for(const x of uF)m[x]!==void 0&&(g[x]=m[x],delete m[x]);e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),r!==void 0&&(m.scale=r),s!==void 0&&cF(m,s,i,a,!1)}const tk=()=>({...W0(),attrs:{}}),nk=n=>typeof n=="string"&&n.toLowerCase()==="svg";function dF(n,e,t,r){const s=L.useMemo(()=>{const i=tk();return ek(i,e,nk(r),n.transformTemplate,n.style),{...i.attrs,style:{...i.style}}},[e]);if(n.style){const i={};J_(i,n.style,n),s.style={...i,...s.style}}return s}const fF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function q0(n){return typeof n!="string"||n.includes("-")?!1:!!(fF.indexOf(n)>-1||/[A-Z]/u.test(n))}function hF(n,e,t,{latestValues:r},s,i=!1,a){const u=(a??q0(n)?dF:aF)(e,r,s,n),d=X7(e,typeof n=="string",i),f=n!==L.Fragment?{...d,...u,ref:t}:{},{children:m}=e,g=L.useMemo(()=>en(m)?m.get():m,[m]);return L.createElement(n,{...f,children:g})}function P2(n){const e=[{},{}];return n?.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function Y0(n,e,t,r){if(typeof e=="function"){const[s,i]=P2(r);e=e(t!==void 0?t:n.custom,s,i)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[s,i]=P2(r);e=e(t!==void 0?t:n.custom,s,i)}return e}function _u(n){return en(n)?n.get():n}function mF({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,s){return{latestValues:pF(t,r,s,n),renderState:e()}}function pF(n,e,t,r){const s={},i=r(n,{});for(const g in i)s[g]=_u(i[g]);let{initial:a,animate:l}=n;const u=Ed(n),d=X_(n);e&&d&&!u&&n.inherit!==!1&&(a===void 0&&(a=e.initial),l===void 0&&(l=e.animate));let f=t?t.initial===!1:!1;f=f||a===!1;const m=f?l:a;if(m&&typeof m!="boolean"&&!Sd(m)){const g=Array.isArray(m)?m:[m];for(let x=0;x<g.length;x++){const y=Y0(n,g[x]);if(y){const{transitionEnd:w,transition:b,...E}=y;for(const T in E){let _=E[T];if(Array.isArray(_)){const A=f?_.length-1:0;_=_[A]}_!==null&&(s[T]=_)}for(const T in w)s[T]=w[T]}}}return s}const rk=n=>(e,t)=>{const r=L.useContext(bd),s=L.useContext(E0),i=()=>mF(n,e,r,s);return t?i():YO(i)};function Q0(n,e,t){const{style:r}=n,s={};for(const i in r)(en(r[i])||e.style&&en(e.style[i])||Z_(i,n)||t?.getValue(i)?.liveStyle!==void 0)&&(s[i]=r[i]);return s}const gF=rk({scrapeMotionValuesFromProps:Q0,createRenderState:W0});function sk(n,e,t){const r=Q0(n,e,t);for(const s in n)if(en(n[s])||en(e[s])){const i=Ga.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=n[s]}return r}const xF=rk({scrapeMotionValuesFromProps:sk,createRenderState:tk}),yF=Symbol.for("motionComponentSymbol");function vF(n,e,t){const r=L.useRef(t);L.useInsertionEffect(()=>{r.current=t});const s=L.useRef(null);return L.useCallback(i=>{i&&n.onMount?.(i),e&&(i?e.mount(i):e.unmount());const a=r.current;if(typeof a=="function")if(i){const l=a(i);typeof l=="function"&&(s.current=l)}else s.current?(s.current(),s.current=null):a(i);else a&&(a.current=i)},[e])}const X0=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),wF="framerAppearId",ik="data-"+X0(wF),ak=L.createContext({});function $o(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function bF(n,e,t,r,s,i){const{visualElement:a}=L.useContext(bd),l=L.useContext(Y_),u=L.useContext(E0),d=L.useContext(q_).reducedMotion,f=L.useRef(null);r=r||l.renderer,!f.current&&r&&(f.current=r(n,{visualState:e,parent:a,props:t,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d,isSVG:i}));const m=f.current,g=L.useContext(ak);m&&!m.projection&&s&&(m.type==="html"||m.type==="svg")&&SF(f.current,t,s,g);const x=L.useRef(!1);L.useInsertionEffect(()=>{m&&x.current&&m.update(t,u)});const y=t[ik],w=L.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return QO(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),w.current&&m.animationState&&m.animationState.animateChanges())}),L.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),w.current=!1),m.enteringChildren=void 0)}),m}function SF(n,e,t,r){const{layoutId:s,layout:i,drag:a,dragConstraints:l,layoutScroll:u,layoutRoot:d,layoutCrossfade:f}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:ok(n.parent)),n.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||l&&$o(l),visualElement:n,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:f,layoutScroll:u,layoutRoot:d})}function ok(n){if(n)return n.options.allowProjection!==!1?n.projection:ok(n.parent)}function fm(n,{forwardMotionProps:e=!1,type:t}={},r,s){r&&q7(r);const i=t?t==="svg":q0(n),a=i?xF:gF;function l(d,f){let m;const g={...L.useContext(q_),...d,layoutId:EF(d)},{isStatic:x}=g,y=J7(d),w=a(d,x);if(!x&&S0){TF();const b=_F(g);m=b.MeasureLayout,y.visualElement=bF(n,w,g,s,b.ProjectionNode,i)}return h.jsxs(bd.Provider,{value:y,children:[m&&y.visualElement?h.jsx(m,{visualElement:y.visualElement,...g}):null,hF(n,d,vF(w,y.visualElement,f),w,x,e,i)]})}l.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const u=L.forwardRef(l);return u[yF]=n,u}function EF({layoutId:n}){const e=L.useContext(n_).id;return e&&n!==void 0?e+"-"+n:n}function TF(n,e){L.useContext(Y_).strict}function _F(n){const{drag:e,layout:t}=Oa;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e?.isEnabled(n)||t?.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function kF(n,e){if(typeof Proxy>"u")return fm;const t=new Map,r=(i,a)=>fm(i,a,n,e),s=(i,a)=>r(i,a);return new Proxy(s,{get:(i,a)=>a==="create"?r:(t.has(a)||t.set(a,fm(a,void 0,n,e)),t.get(a))})}function lk({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function CF({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function AF(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function hm(n){return n===void 0||n===1}function wp({scale:n,scaleX:e,scaleY:t}){return!hm(n)||!hm(e)||!hm(t)}function pi(n){return wp(n)||ck(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function ck(n){return D2(n.x)||D2(n.y)}function D2(n){return n&&n!=="0%"}function rd(n,e,t){const r=n-t,s=e*r;return t+s}function N2(n,e,t,r,s){return s!==void 0&&(n=rd(n,s,r)),rd(n,t,r)+e}function bp(n,e=0,t=1,r,s){n.min=N2(n.min,e,t,r,s),n.max=N2(n.max,e,t,r,s)}function uk(n,{x:e,y:t}){bp(n.x,e.translate,e.scale,e.originPoint),bp(n.y,t.translate,t.scale,t.originPoint)}const j2=.999999999999,O2=1.0000000000001;function IF(n,e,t,r=!1){const s=t.length;if(!s)return;e.x=e.y=1;let i,a;for(let l=0;l<s;l++){i=t[l],a=i.projectionDelta;const{visualElement:u}=i.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&pa(n,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,uk(n,a)),r&&pi(i.latestValues)&&pa(n,i.latestValues))}e.x<O2&&e.x>j2&&(e.x=1),e.y<O2&&e.y>j2&&(e.y=1)}function ma(n,e){n.min=n.min+e,n.max=n.max+e}function M2(n,e,t,r,s=.5){const i=gt(n.min,n.max,s);bp(n,e,t,i,r)}function pa(n,e){M2(n.x,e.x,e.scaleX,e.scale,e.originX),M2(n.y,e.y,e.scaleY,e.scale,e.originY)}function dk(n,e){return lk(AF(n.getBoundingClientRect(),e))}function LF(n,e,t){const r=dk(n,t),{scroll:s}=e;return s&&(ma(r.x,s.offset.x),ma(r.y,s.offset.y)),r}const F2=()=>({translate:0,scale:1,origin:0,originPoint:0}),ga=()=>({x:F2(),y:F2()}),B2=()=>({min:0,max:0}),Pt=()=>({x:B2(),y:B2()}),Sp={current:null},fk={current:!1};function RF(){if(fk.current=!0,!!S0)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Sp.current=n.matches;n.addEventListener("change",e),e()}else Sp.current=!1}const PF=new WeakMap;function DF(n,e,t){for(const r in e){const s=e[r],i=t[r];if(en(s))n.addValue(r,s);else if(en(i))n.addValue(r,ja(s,{owner:n}));else if(i!==s)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=n.getStaticValue(r);n.addValue(r,ja(a!==void 0?a:s,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const U2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class NF{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=B0,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=cn.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,lt.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=a;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=Ed(t),this.isVariantNode=X_(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const g in m){const x=m[g];u[g]!==void 0&&en(x)&&x.set(u[g])}}mount(e){this.current=e,PF.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,r)=>this.bindToMotionValue(r,t)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(fk.current||RF(),this.shouldReduceMotion=Sp.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ks(this.notifyUpdate),Ks(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Ha.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&lt.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Oa){const t=Oa[e];if(!t)continue;const{isEnabled:r,Feature:s}=t;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Pt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<U2.length;r++){const s=U2[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=e[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=DF(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=ja(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(r_(r)||i_(r))?r=parseFloat(r):!z7(r)&&zs.test(t)&&(r=$_(e,t)),this.setBaseTarget(e,en(r)?r.get():r)),en(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const i=Y0(this.props,t,this.presenceContext?.custom);i&&(r=i[e])}if(t&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!en(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new A0),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){V0.render(this.render)}}class hk extends NF{constructor(){super(...arguments),this.KeyframeResolver=N7}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;en(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function mk(n,{style:e,vars:t},r,s){const i=n.style;let a;for(a in e)i[a]=e[a];s?.applyProjectionStyles(i,r);for(a in t)i.setProperty(a,t[a])}function jF(n){return window.getComputedStyle(n)}class OF extends hk{constructor(){super(...arguments),this.type="html",this.renderInstance=mk}readValueFromInstance(e,t){if(Ha.has(t))return this.projection?.isProjecting?fp(t):JM(e,t);{const r=jF(e),s=(v_(t)?r.getPropertyValue(t):r[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return dk(e,t)}build(e,t,r){z0(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return Q0(e,t,r)}}const pk=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function MF(n,e,t,r){mk(n,e,void 0,r);for(const s in e.attrs)n.setAttribute(pk.has(s)?s:X0(s),e.attrs[s])}class FF extends hk{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Pt}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Ha.has(t)){const r=U_(t);return r&&r.default||0}return t=pk.has(t)?t:X0(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return sk(e,t,r)}build(e,t,r){ek(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,s){MF(e,t,r,s)}mount(e){this.isSVGTag=nk(e.tagName),super.mount(e)}}const BF=(n,e)=>e.isSVG??q0(n)?new FF(e):new OF(e,{allowProjection:n!==L.Fragment});function Ta(n,e,t){const r=n.getProps();return Y0(r,e,t!==void 0?t:r.custom,n)}const Ep=n=>Array.isArray(n);function UF(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,ja(t))}function $F(n){return Ep(n)?n[n.length-1]||0:n}function VF(n,e){const t=Ta(n,e);let{transitionEnd:r={},transition:s={},...i}=t||{};i={...i,...r};for(const a in i){const l=$F(i[a]);UF(n,a,l)}}function GF(n){return!!(en(n)&&n.add)}function Tp(n,e){const t=n.getValue("willChange");if(GF(t))return t.add(e);if(!t&&is.WillChange){const r=new is.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function gk(n){return n.props[ik]}const HF=n=>n!==null;function KF(n,{repeat:e,repeatType:t="loop"},r){const s=n.filter(HF),i=e&&t!=="loop"&&e%2===1?0:s.length-1;return s[i]}const zF={type:"spring",stiffness:500,damping:25,restSpeed:10},WF=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),qF={type:"keyframes",duration:.8},YF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},QF=(n,{keyframes:e})=>e.length>2?qF:Ha.has(n)?n.startsWith("scale")?WF(e[1]):zF:YF;function XF({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:l,from:u,elapsed:d,...f}){return!!Object.keys(f).length}const Z0=(n,e,t,r={},s,i)=>a=>{const l=U0(r,n)||{},u=l.delay||r.delay||0;let{elapsed:d=0}=r;d=d-es(u);const f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-d,onUpdate:g=>{e.set(g),l.onUpdate&&l.onUpdate(g)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:n,motionValue:e,element:i?void 0:s};XF(l)||Object.assign(f,QF(n,f)),f.duration&&(f.duration=es(f.duration)),f.repeatDelay&&(f.repeatDelay=es(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(xp(f),f.delay===0&&(m=!0)),(is.instantAnimations||is.skipAnimations)&&(m=!0,xp(f),f.delay=0),f.allowFlatten=!l.type&&!l.ease,m&&!i&&e.get()!==void 0){const g=KF(f.keyframes,l);if(g!==void 0){lt.update(()=>{f.onUpdate(g),f.onComplete()});return}}return l.isSync?new F0(f):new S7(f)};function ZF({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function xk(n,e,{delay:t=0,transitionOverride:r,type:s}={}){let{transition:i=n.getDefaultTransition(),transitionEnd:a,...l}=e;r&&(i=r);const u=[],d=s&&n.animationState&&n.animationState.getState()[s];for(const f in l){const m=n.getValue(f,n.latestValues[f]??null),g=l[f];if(g===void 0||d&&ZF(d,f))continue;const x={delay:t,...U0(i||{},f)},y=m.get();if(y!==void 0&&!m.isAnimating&&!Array.isArray(g)&&g===y&&!x.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const E=gk(n);if(E){const T=window.MotionHandoffAnimation(E,f,lt);T!==null&&(x.startTime=T,w=!0)}}Tp(n,f),m.start(Z0(f,m,g,n.shouldReduceMotion&&M_.has(f)?{type:!1}:x,n,w));const b=m.animation;b&&u.push(b)}return a&&Promise.all(u).then(()=>{lt.update(()=>{a&&VF(n,a)})}),u}function yk(n,e,t,r=0,s=1){const i=Array.from(n).sort((d,f)=>d.sortNodePosition(f)).indexOf(e),a=n.size,l=(a-1)*r;return typeof t=="function"?t(i,a):s===1?i*r:l-i*r}function _p(n,e,t={}){const r=Ta(n,e,t.type==="exit"?n.presenceContext?.custom:void 0);let{transition:s=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(s=t.transitionOverride);const i=r?()=>Promise.all(xk(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:m}=s;return JF(n,e,u,d,f,m,t)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,d]=l==="beforeChildren"?[i,a]:[a,i];return u().then(()=>d())}else return Promise.all([i(),a(t.delay)])}function JF(n,e,t=0,r=0,s=0,i=1,a){const l=[];for(const u of n.variantChildren)u.notify("AnimationStart",e),l.push(_p(u,e,{...a,delay:t+(typeof r=="function"?0:r)+yk(n.variantChildren,u,r,s,i)}).then(()=>u.notify("AnimationComplete",e)));return Promise.all(l)}function eB(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>_p(n,i,t));r=Promise.all(s)}else if(typeof e=="string")r=_p(n,e,t);else{const s=typeof e=="function"?Ta(n,e,t.custom):e;r=Promise.all(xk(n,s,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function vk(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const tB=K0.length;function wk(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?wk(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<tB;t++){const r=K0[t],s=n.props[r];(hl(s)||s===!1)&&(e[r]=s)}return e}const nB=[...H0].reverse(),rB=H0.length;function sB(n){return e=>Promise.all(e.map(({animation:t,options:r})=>eB(n,t,r)))}function iB(n){let e=sB(n),t=$2(),r=!0;const s=u=>(d,f)=>{const m=Ta(n,f,u==="exit"?n.presenceContext?.custom:void 0);if(m){const{transition:g,transitionEnd:x,...y}=m;d={...d,...y,...x}}return d};function i(u){e=u(n)}function a(u){const{props:d}=n,f=wk(n.parent)||{},m=[],g=new Set;let x={},y=1/0;for(let b=0;b<rB;b++){const E=nB[b],T=t[E],_=d[E]!==void 0?d[E]:f[E],A=hl(_),I=E===u?T.isActive:null;I===!1&&(y=b);let N=_===f[E]&&_!==d[E]&&A;if(N&&r&&n.manuallyAnimateOnMount&&(N=!1),T.protectedKeys={...x},!T.isActive&&I===null||!_&&!T.prevProp||Sd(_)||typeof _=="boolean")continue;const P=aB(T.prevProp,_);let O=P||E===u&&T.isActive&&!N&&A||b>y&&A,M=!1;const D=Array.isArray(_)?_:[_];let B=D.reduce(s(E),{});I===!1&&(B={});const{prevResolvedValues:q={}}=T,ie={...q,...B},te=Q=>{O=!0,g.has(Q)&&(M=!0,g.delete(Q)),T.needsAnimating[Q]=!0;const G=n.getValue(Q);G&&(G.liveStyle=!1)};for(const Q in ie){const G=B[Q],Y=q[Q];if(x.hasOwnProperty(Q))continue;let Z=!1;Ep(G)&&Ep(Y)?Z=!vk(G,Y):Z=G!==Y,Z?G!=null?te(Q):g.add(Q):G!==void 0&&g.has(Q)?te(Q):T.protectedKeys[Q]=!0}T.prevProp=_,T.prevResolvedValues=B,T.isActive&&(x={...x,...B}),r&&n.blockInitialAnimation&&(O=!1);const re=N&&P;O&&(!re||M)&&m.push(...D.map(Q=>{const G={type:E};if(typeof Q=="string"&&r&&!re&&n.manuallyAnimateOnMount&&n.parent){const{parent:Y}=n,Z=Ta(Y,Q);if(Y.enteringChildren&&Z){const{delayChildren:j}=Z.transition||{};G.delay=yk(Y.enteringChildren,n,j)}}return{animation:Q,options:G}}))}if(g.size){const b={};if(typeof d.initial!="boolean"){const E=Ta(n,Array.isArray(d.initial)?d.initial[0]:d.initial);E&&E.transition&&(b.transition=E.transition)}g.forEach(E=>{const T=n.getBaseTarget(E),_=n.getValue(E);_&&(_.liveStyle=!0),b[E]=T??null}),m.push({animation:b})}let w=!!m.length;return r&&(d.initial===!1||d.initial===d.animate)&&!n.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(m):Promise.resolve()}function l(u,d){if(t[u].isActive===d)return Promise.resolve();n.variantChildren?.forEach(m=>m.animationState?.setActive(u,d)),t[u].isActive=d;const f=a(u);for(const m in t)t[m].protectedKeys={};return f}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>t,reset:()=>{t=$2()}}}function aB(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!vk(e,n):!1}function fi(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function $2(){return{animate:fi(!0),whileInView:fi(),whileHover:fi(),whileTap:fi(),whileDrag:fi(),whileFocus:fi(),exit:fi()}}class Ys{constructor(e){this.isMounted=!1,this.node=e}update(){}}class oB extends Ys{constructor(e){super(e),e.animationState||(e.animationState=iB(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Sd(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let lB=0;class cB extends Ys{constructor(){super(...arguments),this.id=lB++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);t&&!e&&s.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const uB={animation:{Feature:oB},exit:{Feature:cB}};function ml(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function Ll(n){return{point:{x:n.pageX,y:n.pageY}}}const dB=n=>e=>G0(e)&&n(e,Ll(e));function Zo(n,e,t,r){return ml(n,e,dB(t),r)}const bk=1e-4,fB=1-bk,hB=1+bk,Sk=.01,mB=0-Sk,pB=0+Sk;function un(n){return n.max-n.min}function gB(n,e,t){return Math.abs(n-e)<=t}function V2(n,e,t,r=.5){n.origin=r,n.originPoint=gt(e.min,e.max,n.origin),n.scale=un(t)/un(e),n.translate=gt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=fB&&n.scale<=hB||isNaN(n.scale))&&(n.scale=1),(n.translate>=mB&&n.translate<=pB||isNaN(n.translate))&&(n.translate=0)}function Jo(n,e,t,r){V2(n.x,e.x,t.x,r?r.originX:void 0),V2(n.y,e.y,t.y,r?r.originY:void 0)}function G2(n,e,t){n.min=t.min+e.min,n.max=n.min+un(e)}function xB(n,e,t){G2(n.x,e.x,t.x),G2(n.y,e.y,t.y)}function H2(n,e,t){n.min=e.min-t.min,n.max=n.min+un(e)}function sd(n,e,t){H2(n.x,e.x,t.x),H2(n.y,e.y,t.y)}function $n(n){return[n("x"),n("y")]}const Ek=({current:n})=>n?n.ownerDocument.defaultView:null,K2=(n,e)=>Math.abs(n-e);function yB(n,e){const t=K2(n.x,e.x),r=K2(n.y,e.y);return Math.sqrt(t**2+r**2)}const z2=new Set(["auto","scroll"]);class Tk{constructor(e,t,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=x=>{this.handleScroll(x.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=pm(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,w=yB(x.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!w)return;const{point:b}=x,{timestamp:E}=Ht;this.history.push({...b,timestamp:E});const{onStart:T,onMove:_}=this.handlers;y||(T&&T(this.lastMoveEvent,x),this.startEvent=this.lastMoveEvent),_&&_(this.lastMoveEvent,x)},this.handlePointerMove=(x,y)=>{this.lastMoveEvent=x,this.lastMoveEventInfo=mm(y,this.transformPagePoint),lt.update(this.updatePoint,!0)},this.handlePointerUp=(x,y)=>{this.end();const{onEnd:w,onSessionEnd:b,resumeAnimation:E}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=pm(x.type==="pointercancel"?this.lastMoveEventInfo:mm(y,this.transformPagePoint),this.history);this.startEvent&&w&&w(x,T),b&&b(x,T)},!G0(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=a,this.contextWindow=s||window;const u=Ll(e),d=mm(u,this.transformPagePoint),{point:f}=d,{timestamp:m}=Ht;this.history=[{...f,timestamp:m}];const{onSessionStart:g}=t;g&&g(e,pm(d,this.history)),this.removeListeners=Cl(Zo(this.contextWindow,"pointermove",this.handlePointerMove),Zo(this.contextWindow,"pointerup",this.handlePointerUp),Zo(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(e){let t=e.parentElement;for(;t;){const r=getComputedStyle(t);(z2.has(r.overflowX)||z2.has(r.overflowY))&&this.scrollPositions.set(t,{x:t.scrollLeft,y:t.scrollTop}),t=t.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const t=this.scrollPositions.get(e);if(!t)return;const r=e===window,s=r?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},i={x:s.x-t.x,y:s.y-t.y};i.x===0&&i.y===0||(r?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=i.x,this.lastMoveEventInfo.point.y+=i.y):this.history.length>0&&(this.history[0].x-=i.x,this.history[0].y-=i.y),this.scrollPositions.set(e,s),lt.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Ks(this.updatePoint)}}function mm(n,e){return e?{point:e(n.point)}:n}function W2(n,e){return{x:n.x-e.x,y:n.y-e.y}}function pm({point:n},e){return{point:n,delta:W2(n,_k(e)),offset:W2(n,vB(e)),velocity:wB(e,.1)}}function vB(n){return n[0]}function _k(n){return n[n.length-1]}function wB(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const s=_k(n);for(;t>=0&&(r=n[t],!(s.timestamp-r.timestamp>es(e)));)t--;if(!r)return{x:0,y:0};const i=Vn(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function bB(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?gt(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?gt(t,n,r.max):Math.min(n,t)),n}function q2(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function SB(n,{top:e,left:t,bottom:r,right:s}){return{x:q2(n.x,t,s),y:q2(n.y,e,r)}}function Y2(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function EB(n,e){return{x:Y2(n.x,e.x),y:Y2(n.y,e.y)}}function TB(n,e){let t=.5;const r=un(n),s=un(e);return s>r?t=ul(e.min,e.max-r,n.min):r>s&&(t=ul(n.min,n.max-s,e.min)),Lr(0,1,t)}function _B(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const kp=.35;function kB(n=kp){return n===!1?n=0:n===!0&&(n=kp),{x:Q2(n,"left","right"),y:Q2(n,"top","bottom")}}function Q2(n,e,t){return{min:X2(n,e),max:X2(n,t)}}function X2(n,e){return typeof n=="number"?n:n[e]||0}const CB=new WeakMap;class AB{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Pt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=m=>{t?(this.stopAnimation(),this.snapToCursor(Ll(m).point)):this.pauseAnimation()},a=(m,g)=>{this.stopAnimation();const{drag:x,dragPropagation:y,onDragStart:w}=this.getProps();if(x&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=B7(x),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$n(E=>{let T=this.getAxisMotionValue(E).get()||0;if(Cr.test(T)){const{projection:_}=this.visualElement;if(_&&_.layout){const A=_.layout.layoutBox[E];A&&(T=un(A)*(parseFloat(T)/100))}}this.originPoint[E]=T}),w&&lt.postRender(()=>w(m,g)),Tp(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},l=(m,g)=>{this.latestPointerEvent=m,this.latestPanInfo=g;const{dragPropagation:x,dragDirectionLock:y,onDirectionLock:w,onDrag:b}=this.getProps();if(!x&&!this.openDragLock)return;const{offset:E}=g;if(y&&this.currentDirection===null){this.currentDirection=IB(E),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),b&&b(m,g)},u=(m,g)=>{this.latestPointerEvent=m,this.latestPanInfo=g,this.stop(m,g),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>$n(m=>this.getAnimationState(m)==="paused"&&this.getAxisMotionValue(m).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new Tk(e,{onSessionStart:i,onStart:a,onMove:l,onSessionEnd:u,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:r,contextWindow:Ek(this.visualElement),element:this.visualElement.current})}stop(e,t){const r=e||this.latestPointerEvent,s=t||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:a}=s;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&lt.postRender(()=>l(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:s}=this.getProps();if(!r||!cu(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=bB(a,this.constraints[e],this.elastic[e])),i.set(a)}resolveConstraints(){const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;e&&$o(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=SB(r.layoutBox,e):this.constraints=!1,this.elastic=kB(t),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&$n(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=_B(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!$o(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=LF(r,s.root,this.visualElement.getTransformPagePoint());let a=EB(s.layout.layoutBox,i);if(t){const l=t(CF(a));this.hasMutatedConstraints=!!l,l&&(a=lk(l))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},d=$n(f=>{if(!cu(f,t,this.currentDirection))return;let m=u&&u[f]||{};a&&(m={min:0,max:0});const g=s?200:1e6,x=s?40:1e7,y={type:"inertia",velocity:r?e[f]:0,bounceStiffness:g,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...m};return this.startAxisValueAnimation(f,y)});return Promise.all(d).then(l)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return Tp(this.visualElement,e),r.start(Z0(e,r,0,t,this.visualElement,!1))}stopAnimation(){$n(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){$n(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[t];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){$n(t=>{const{drag:r}=this.getProps();if(!cu(t,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(t);if(s&&s.layout){const{min:a,max:l}=s.layout.layoutBox[t],u=i.get()||0;i.set(e[t]-gt(a,l,.5)+u)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!$o(t)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};$n(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const u=l.get();s[a]=TB({min:u,max:u},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),$n(a=>{if(!cu(a,e,null))return;const l=this.getAxisMotionValue(a),{min:u,max:d}=this.constraints[a];l.set(gt(u,d,s[a]))})}addListeners(){if(!this.visualElement.current)return;CB.set(this.visualElement,this);const e=this.visualElement.current,t=Zo(e,"pointerdown",u=>{const{drag:d,dragListener:f=!0}=this.getProps();d&&f&&!z_(u.target)&&this.start(u)}),r=()=>{const{dragConstraints:u}=this.getProps();$o(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),lt.read(r);const a=ml(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&($n(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())}));return()=>{a(),t(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=kp,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function cu(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function IB(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class LB extends Ys{constructor(e){super(e),this.removeGroupControls=Gn,this.removeListeners=Gn,this.controls=new AB(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Gn}update(){const{dragControls:e}=this.node.getProps(),{dragControls:t}=this.node.prevProps||{};e!==t&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}}const Z2=n=>(e,t)=>{n&&lt.postRender(()=>n(e,t))};class RB extends Ys{constructor(){super(...arguments),this.removePointerDownListener=Gn}onPointerDown(e){this.session=new Tk(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Ek(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Z2(e),onStart:Z2(t),onMove:r,onEnd:(i,a)=>{delete this.session,s&&lt.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Zo(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ku={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let gm=!1;class PB extends L.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;i&&(t.group&&t.group.add(i),r&&r.register&&s&&r.register(i),gm&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),ku.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,gm=!0,s||e.layoutDependency!==t||t===void 0||e.isPresent!==i?a.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?a.promote():a.relegate()||lt.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),V0.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:s}=e;gm=!0,s&&(s.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function kk(n){const[e,t]=W7(),r=L.useContext(n_);return h.jsx(PB,{...n,layoutGroup:r,switchLayoutGroup:L.useContext(ak),isPresent:e,safeToRemove:t})}function DB(n,e,t){const r=en(n)?n:ja(n);return r.start(Z0("",r,e,t)),r.animation}const NB=(n,e)=>n.depth-e.depth;class jB{constructor(){this.children=[],this.isDirty=!1}add(e){T0(this.children,e),this.isDirty=!0}remove(e){_0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(NB),this.isDirty=!1,this.children.forEach(e)}}function OB(n,e){const t=cn.now(),r=({timestamp:s})=>{const i=s-t;i>=e&&(Ks(r),n(i-e))};return lt.setup(r,!0),()=>Ks(r)}const Ck=["TopLeft","TopRight","BottomLeft","BottomRight"],MB=Ck.length,J2=n=>typeof n=="string"?parseFloat(n):n,ew=n=>typeof n=="number"||be.test(n);function FB(n,e,t,r,s,i){s?(n.opacity=gt(0,t.opacity??1,BB(r)),n.opacityExit=gt(e.opacity??1,0,UB(r))):i&&(n.opacity=gt(e.opacity??1,t.opacity??1,r));for(let a=0;a<MB;a++){const l=`border${Ck[a]}Radius`;let u=tw(e,l),d=tw(t,l);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||ew(u)===ew(d)?(n[l]=Math.max(gt(J2(u),J2(d),r),0),(Cr.test(d)||Cr.test(u))&&(n[l]+="%")):n[l]=d}(e.rotate||t.rotate)&&(n.rotate=gt(e.rotate||0,t.rotate||0,r))}function tw(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const BB=Ak(0,.5,h_),UB=Ak(.5,.95,Gn);function Ak(n,e,t){return r=>r<n?0:r>e?1:t(ul(n,e,r))}function nw(n,e){n.min=e.min,n.max=e.max}function rr(n,e){nw(n.x,e.x),nw(n.y,e.y)}function rw(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function sw(n,e,t,r,s){return n-=e,n=rd(n,1/t,r),s!==void 0&&(n=rd(n,1/s,r)),n}function $B(n,e=0,t=1,r=.5,s,i=n,a=n){if(Cr.test(e)&&(e=parseFloat(e),e=gt(a.min,a.max,e/100)-a.min),typeof e!="number")return;let l=gt(i.min,i.max,r);n===i&&(l-=e),n.min=sw(n.min,e,t,l,s),n.max=sw(n.max,e,t,l,s)}function iw(n,e,[t,r,s],i,a){$B(n,e[t],e[r],e[s],e.scale,i,a)}const VB=["x","scaleX","originX"],GB=["y","scaleY","originY"];function aw(n,e,t,r){iw(n.x,e,VB,t?t.x:void 0,r?r.x:void 0),iw(n.y,e,GB,t?t.y:void 0,r?r.y:void 0)}function ow(n){return n.translate===0&&n.scale===1}function Ik(n){return ow(n.x)&&ow(n.y)}function lw(n,e){return n.min===e.min&&n.max===e.max}function HB(n,e){return lw(n.x,e.x)&&lw(n.y,e.y)}function cw(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function Lk(n,e){return cw(n.x,e.x)&&cw(n.y,e.y)}function uw(n){return un(n.x)/un(n.y)}function dw(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class KB{constructor(){this.members=[]}add(e){T0(this.members,e),e.scheduleRender()}remove(e){if(_0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(s=>e===s);if(t===0)return!1;let r;for(let s=t;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function zB(n,e,t){let r="";const s=n.x.translate/e.x,i=n.y.translate/e.y,a=t?.z||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:f,rotateX:m,rotateY:g,skewX:x,skewY:y}=t;d&&(r=`perspective(${d}px) ${r}`),f&&(r+=`rotate(${f}deg) `),m&&(r+=`rotateX(${m}deg) `),g&&(r+=`rotateY(${g}deg) `),x&&(r+=`skewX(${x}deg) `),y&&(r+=`skewY(${y}deg) `)}const l=n.x.scale*e.x,u=n.y.scale*e.y;return(l!==1||u!==1)&&(r+=`scale(${l}, ${u})`),r||"none"}const xm=["","X","Y","Z"],WB=1e3;let qB=0;function ym(n,e,t,r){const{latestValues:s}=e;s[n]&&(t[n]=s[n],e.setStaticValue(n,0),r&&(r[n]=0))}function Rk(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=gk(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:s,layoutId:i}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",lt,!(s||i))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&Rk(r)}function Pk({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},l=e?.()){this.id=qB++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(XB),this.nodes.forEach(tU),this.nodes.forEach(nU),this.nodes.forEach(ZB)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new jB)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new A0),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const u=this.eventHandlers.get(a);u&&u.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=W_(a)&&!H7(a),this.instance=a;const{layoutId:l,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||l)&&(this.isLayoutDirty=!0),n){let f,m=0;const g=()=>this.root.updateBlockedByResize=!1;lt.read(()=>{m=window.innerWidth}),n(a,()=>{const x=window.innerWidth;x!==m&&(m=x,this.root.updateBlockedByResize=!0,f&&f(),f=OB(g,250),ku.hasAnimatedSinceResize&&(ku.hasAnimatedSinceResize=!1,this.nodes.forEach(mw)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeLayoutChanged:g,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||d.getDefaultTransition()||oU,{onLayoutAnimationStart:w,onLayoutAnimationComplete:b}=d.getProps(),E=!this.targetLayout||!Lk(this.targetLayout,x),T=!m&&g;if(this.options.layoutRoot||this.resumeFrom||T||m&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...U0(y,"layout"),onPlay:w,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(f,T)}else m||mw(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ks(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(rU),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Rk(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(fw);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(hw);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(eU),this.nodes.forEach(YB),this.nodes.forEach(QB)):this.nodes.forEach(hw),this.clearAllSnapshots();const l=cn.now();Ht.delta=Lr(0,1e3/60,l-Ht.timestamp),Ht.timestamp=l,Ht.isProcessing=!0,im.update.process(Ht),im.preRender.process(Ht),im.render.process(Ht),Ht.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,V0.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(JB),this.sharedNodes.forEach(sU)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!un(this.snapshot.measuredBox.x)&&!un(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Pt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!Ik(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;a&&this.instance&&(l||pi(this.latestValues)||f)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return a&&(u=this.removeTransform(u)),lU(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return Pt();const l=a.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(cU))){const{scroll:d}=this.root;d&&(ma(l.x,d.offset.x),ma(l.y,d.offset.y))}return l}removeElementScroll(a){const l=Pt();if(rr(l,a),this.scroll?.wasRoot)return l;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:m}=d;d!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&rr(l,a),ma(l.x,f.offset.x),ma(l.y,f.offset.y))}return l}applyTransform(a,l=!1){const u=Pt();rr(u,a);for(let d=0;d<this.path.length;d++){const f=this.path[d];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&pa(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),pi(f.latestValues)&&pa(u,f.latestValues)}return pi(this.latestValues)&&pa(u,this.latestValues),u}removeTransform(a){const l=Pt();rr(l,a);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!pi(d.latestValues))continue;wp(d.latestValues)&&d.updateSnapshot();const f=Pt(),m=d.measurePageBox();rr(f,m),aw(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,f)}return pi(this.latestValues)&&aw(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ht.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!this.layout||!(f||m))return;this.resolvedRelativeTargetAt=Ht.timestamp;const g=this.getClosestProjectingParent();g&&this.linkedParentVersion!==g.layoutVersion&&!g.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(g&&g.layout?this.createRelativeTarget(g,this.layout.layoutBox,g.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Pt(),this.targetWithTransforms=Pt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),xB(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):rr(this.target,this.layout.layoutBox),uk(this.target,this.targetDelta)):rr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?this.createRelativeTarget(g,this.target,g.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||wp(this.parent.latestValues)||ck(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,l,u){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Pt(),this.relativeTargetOrigin=Pt(),sd(this.relativeTargetOrigin,l,u),rr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const a=this.getLead(),l=!!this.resumingFrom||this!==a;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Ht.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;rr(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,g=this.treeScale.y;IF(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Pt());const{target:x}=a;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(rw(this.prevProjectionDelta.x,this.projectionDelta.x),rw(this.prevProjectionDelta.y,this.projectionDelta.y)),Jo(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==g||!dw(this.projectionDelta.x,this.prevProjectionDelta.x)||!dw(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.visualElement?.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ga(),this.projectionDelta=ga(),this.projectionDeltaWithTransform=ga()}setAnimationOrigin(a,l=!1){const u=this.snapshot,d=u?u.latestValues:{},f={...this.latestValues},m=ga();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const g=Pt(),x=u?u.source:void 0,y=this.layout?this.layout.source:void 0,w=x!==y,b=this.getStack(),E=!b||b.members.length<=1,T=!!(w&&!E&&this.options.crossfade===!0&&!this.path.some(aU));this.animationProgress=0;let _;this.mixTargetDelta=A=>{const I=A/1e3;pw(m.x,a.x,I),pw(m.y,a.y,I),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(sd(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),iU(this.relativeTarget,this.relativeTargetOrigin,g,I),_&&HB(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=Pt()),rr(_,this.relativeTarget)),w&&(this.animationValues=f,FB(f,d,this.latestValues,I,T,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=I},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ks(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lt.update(()=>{ku.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ja(0)),this.currentAnimation=DB(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(WB),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:u,layout:d,latestValues:f}=a;if(!(!l||!u||!d)){if(this!==a&&this.layout&&d&&Dk(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Pt();const m=un(this.layout.layoutBox.x);u.x.min=a.target.x.min,u.x.max=u.x.min+m;const g=un(this.layout.layoutBox.y);u.y.min=a.target.y.min,u.y.max=u.y.min+g}rr(l,u),pa(l,f),Jo(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new KB),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){const{layoutId:a}=this.options;return a?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:a}=this.options;return a?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:u}=a;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const d={};u.z&&ym("z",a,d,this.animationValues);for(let f=0;f<xm.length;f++)ym(`rotate${xm[f]}`,a,d,this.animationValues),ym(`skew${xm[f]}`,a,d,this.animationValues);a.render();for(const f in d)a.setStaticValue(f,d[f]),this.animationValues&&(this.animationValues[f]=d[f]);a.scheduleRender()}applyProjectionStyles(a,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=_u(l?.pointerEvents)||"",a.transform=u?u(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=_u(l?.pointerEvents)||""),this.hasProjected&&!pi(this.latestValues)&&(a.transform=u?u({},""):"none",this.hasProjected=!1);return}a.visibility="";const f=d.animationValues||d.latestValues;this.applyTransformsToTarget();let m=zB(this.projectionDeltaWithTransform,this.treeScale,f);u&&(m=u(f,m)),a.transform=m;const{x:g,y:x}=this.projectionDelta;a.transformOrigin=`${g.origin*100}% ${x.origin*100}% 0`,d.animationValues?a.opacity=d===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:a.opacity=d===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const y in vp){if(f[y]===void 0)continue;const{correct:w,applyTo:b,isCSSVariable:E}=vp[y],T=m==="none"?f[y]:w(f[y],d);if(b){const _=b.length;for(let A=0;A<_;A++)a[b[A]]=T}else E?this.options.visualElement.renderState.vars[y]=T:a[y]=T}this.options.layoutId&&(a.pointerEvents=d===this?_u(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>a.currentAnimation?.stop()),this.root.nodes.forEach(fw),this.root.sharedNodes.clear()}}}function YB(n){n.updateLayout()}function QB(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=n.layout,{animationType:s}=n.options,i=e.source!==n.layout.source;s==="size"?$n(f=>{const m=i?e.measuredBox[f]:e.layoutBox[f],g=un(m);m.min=t[f].min,m.max=m.min+g}):Dk(s,e.layoutBox,t)&&$n(f=>{const m=i?e.measuredBox[f]:e.layoutBox[f],g=un(t[f]);m.max=m.min+g,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+g)});const a=ga();Jo(a,t,e.layoutBox);const l=ga();i?Jo(l,n.applyTransform(r,!0),e.measuredBox):Jo(l,t,e.layoutBox);const u=!Ik(a);let d=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:g}=f;if(m&&g){const x=Pt();sd(x,e.layoutBox,m.layoutBox);const y=Pt();sd(y,t,g.layoutBox),Lk(x,y)||(d=!0),f.options.layoutRoot&&(n.relativeTarget=y,n.relativeTargetOrigin=x,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:t,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(n.isLead()){const{onExitComplete:t}=n.options;t&&t()}n.options.transition=void 0}function XB(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function ZB(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function JB(n){n.clearSnapshot()}function fw(n){n.clearMeasurements()}function hw(n){n.isLayoutDirty=!1}function eU(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function mw(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function tU(n){n.resolveTargetDelta()}function nU(n){n.calcProjection()}function rU(n){n.resetSkewAndRotation()}function sU(n){n.removeLeadSnapshot()}function pw(n,e,t){n.translate=gt(e.translate,0,t),n.scale=gt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function gw(n,e,t,r){n.min=gt(e.min,t.min,r),n.max=gt(e.max,t.max,r)}function iU(n,e,t,r){gw(n.x,e.x,t.x,r),gw(n.y,e.y,t.y,r)}function aU(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const oU={duration:.45,ease:[.4,0,.1,1]},xw=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),yw=xw("applewebkit/")&&!xw("chrome/")?Math.round:Gn;function vw(n){n.min=yw(n.min),n.max=yw(n.max)}function lU(n){vw(n.x),vw(n.y)}function Dk(n,e,t){return n==="position"||n==="preserve-aspect"&&!gB(uw(e),uw(t),.2)}function cU(n){return n!==n.root&&n.scroll?.wasRoot}const uU=Pk({attachResizeListener:(n,e)=>ml(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vm={current:void 0},Nk=Pk({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!vm.current){const n=new uU({});n.mount(window),n.setOptions({layoutScroll:!0}),vm.current=n}return vm.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),dU={pan:{Feature:RB},drag:{Feature:LB,ProjectionNode:Nk,MeasureLayout:kk}};function ww(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const s="onHover"+t,i=r[s];i&&lt.postRender(()=>i(e,Ll(e)))}class fU extends Ys{mount(){const{current:e}=this.node;e&&(this.unmount=U7(e,(t,r)=>(ww(this.node,r,"Start"),s=>ww(this.node,s,"End"))))}unmount(){}}class hU extends Ys{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Cl(ml(this.node.current,"focus",()=>this.onFocus()),ml(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function bw(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const s="onTap"+(t==="End"?"":t),i=r[s];i&&lt.postRender(()=>i(e,Ll(e)))}class mU extends Ys{mount(){const{current:e}=this.node;e&&(this.unmount=G7(e,(t,r)=>(bw(this.node,r,"Start"),(s,{success:i})=>bw(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Cp=new WeakMap,wm=new WeakMap,pU=n=>{const e=Cp.get(n.target);e&&e(n)},gU=n=>{n.forEach(pU)};function xU({root:n,...e}){const t=n||document;wm.has(t)||wm.set(t,{});const r=wm.get(t),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(gU,{root:n,...e})),r[s]}function yU(n,e,t){const r=xU(e);return Cp.set(n,t),r.observe(n),()=>{Cp.delete(n),r.unobserve(n)}}const vU={some:0,all:1};class wU extends Ys{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:s="some",once:i}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:vU[s]},l=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),g=d?f:m;g&&g(u)};return yU(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(bU(e,t))&&this.startObserver()}unmount(){}}function bU({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const SU={inView:{Feature:wU},tap:{Feature:mU},focus:{Feature:hU},hover:{Feature:fU}},EU={layout:{ProjectionNode:Nk,MeasureLayout:kk}},TU={...uB,...SU,...dU,...EU},bm=kF(TU,BF),_U="/assets/Rectangle%20Grain%201-BSzmpmNo.png";function Sw({additionalClassNames:n=""}){return h.jsx("img",{alt:"Michelle Liu Logo",className:J("object-contain pointer-events-none",n),src:Ia})}function J0({variant:n,heroAnimationPlayed:e=!1,children:t,nameAddon:r}){const s=Dr(),i=n==="work";return h.jsxs("div",{className:"content-stretch flex flex-col items-start relative shrink-0 w-full header-gradient",children:[h.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:`url(${_U})`,backgroundRepeat:"repeat",backgroundSize:"auto",opacity:.8}}),h.jsx("div",{className:"relative shrink-0 w-full",style:{zIndex:2},children:h.jsx("div",{className:"size-full",children:h.jsx("div",{className:"content-stretch flex flex-col items-start px-16 pt-8 pb-8 max-md:px-8 max-md:pt-8 max-md:pb-4 relative w-full",children:h.jsx("div",{className:"content-stretch flex items-start justify-between relative shrink-0 w-full",children:i?h.jsx(bm.div,{className:"relative shrink-0 size-11",initial:e?!1:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:h.jsx(Sw,{additionalClassNames:"size-full"})}):h.jsx(bm.button,{onClick:()=>s("/"),className:"relative shrink-0 size-11 cursor-pointer",initial:e?!1:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},whileHover:{scale:1.05},whileTap:{scale:.95},children:h.jsx(Sw,{additionalClassNames:"size-full"})})})})})}),h.jsx("div",{className:"relative shrink-0 w-full",style:{zIndex:2},children:h.jsx("div",{className:"size-full",children:h.jsx("div",{className:"content-stretch flex flex-col gap-4 items-start pb-6 pt-14 px-16 max-md:px-8 max-md:pt-20 max-md:pb-2 relative w-full max-md:h-[210px] md:h-[176px]",children:h.jsxs("div",{className:"content-stretch flex flex-col items-start relative shrink-0 w-full",children:[h.jsx(Be,{variant:"fade",rootMargin:"0px",disabled:e,children:r?h.jsxs("div",{className:"flex gap-3 items-baseline w-full",children:[h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal text-[#374151] text-4xl max-md:text-4xl",children:"michelle liu"}),r]}):h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-normal relative shrink-0 text-[#374151] text-4xl w-full max-md:text-4xl",children:"michelle liu"})}),t&&h.jsx(bm.div,{className:"font-['Figtree',sans-serif] font-normal tracking-wide leading-6 max-md:leading-5.5 text-[#9ca3af] text-lg max-md:text-base w-full max-md:max-w-86 whitespace-pre-wrap mt-1 max-md:mt-1",initial:{opacity:0,y:4,filter:"blur(0px)"},animate:{opacity:1,y:0,filter:"blur(0px)"},transition:{duration:.15,delay:0,ease:[.25,.46,.45,.94]},children:t})]})})})})]})}function Sm({text:n,active:e=!1,onClick:t}){return h.jsx("button",{onClick:t,className:J("content-stretch flex items-center justify-center px-3.5 pt-[5px] pb-[4px] relative rounded-full shrink-0 cursor-pointer transition-all duration-100 ease-out border border-transparent",!e&&"hover:bg-gray-200/40 hover:pt-[3px] hover:pb-[2px] hover:my-[2px]",e&&"bg-gray-200/60 backdrop-blur-md shadow-[0_2px_8px_rgba(0,0,0,0.06),inset_0_1px_1px_rgba(255,255,255,0.9),inset_0_-1px_1px_rgba(0,0,0,0.02)] !border-white/50"),children:h.jsx("p",{className:J("font-['Figtree',sans-serif] font-medium leading-normal tracking-[0.005em] relative shrink-0 text-[1.07em] text-nowrap",e?"text-[#4b5563]":"text-[#9ca3af]"),children:n})})}function eg({activeTab:n,heroAnimationPlayed:e=!1}){const t=Dr();return h.jsxs("div",{className:"content-stretch flex flex-col items-center pb-4 pt-0 px-0 relative shrink-0 w-full",children:[h.jsx(Be,{variant:"fade",delay:280,rootMargin:"0px",className:"relative shrink-0 w-full",disabled:e,children:h.jsx("div",{className:"size-full",children:h.jsx("div",{className:"content-stretch flex flex-col gap-3 items-start pb-0 pt-4 px-16 max-md:px-8 relative w-full",children:h.jsxs("div",{className:"content-stretch flex gap-1 items-start relative shrink-0",children:[h.jsx(Sm,{text:"Work",active:n==="work",onClick:()=>t("/")}),h.jsx(Sm,{text:"Art",active:n==="art",onClick:()=>t("/art")}),h.jsx(Sm,{text:"About",active:n==="about",onClick:()=>t("/about")})]})})})}),h.jsx("div",{className:"px-16 max-md:px-8 w-full pt-3",children:h.jsx("div",{className:"bg-zinc-100 h-px shrink-0 w-full"})})]})}function Mo({className:n,text:e,active:t=!1}){return h.jsxs("div",{className:J("flex flex-col w-full gap-2",n),children:[h.jsx("div",{className:"flex items-center justify-center px-0 py-0 w-full",children:h.jsx("p",{className:J("flex-1 font-normal leading-5 tracking-wide text-base whitespace-pre-wrap",t?"text-gray-600":"text-gray-400"),children:e})}),h.jsx("div",{className:"bg-gray-100 h-px w-full"})]})}function kU({className:n,data:e,onClick:t}){const[r,s]=L.useState(!1);return h.jsxs("button",{onClick:t,className:J("flex flex-col gap-2 items-start w-full cursor-pointer group text-left break-inside-avoid mb-5",n),children:[h.jsxs("div",{className:"relative w-full rounded-xl overflow-hidden",children:[h.jsx("div",{className:J("absolute inset-0 rounded-xl transition-opacity duration-500 ease-out",r?"opacity-0":"opacity-100 animate-shimmer")}),h.jsx("img",{src:e.imageSrc,alt:e.title,className:J("w-full h-auto rounded-xl object-contain transition-opacity duration-500 ease-out",r?"opacity-100":"opacity-0"),onLoad:()=>s(!0)})]}),h.jsxs("p",{className:"font-medium leading-[1.4] px-2 text-sm",children:[h.jsx("span",{className:"text-gray-500",children:e.title}),e.metadata&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-gray-400",children:", "}),h.jsx("span",{className:"text-gray-400",children:e.metadata})]})]})]})}function Em({className:n,items:e,onItemClick:t}){return h.jsx("div",{className:J("w-full max-w-full","grid grid-cols-2 gap-4 lg:block lg:columns-3",n),children:e.map(r=>h.jsx(Be,{className:"lg:break-inside-avoid lg:mb-4",children:h.jsx(kU,{data:r,onClick:()=>t?.(r)})},r.id))})}const Ew=[{id:"painting",label:"Painting"},{id:"conceptual",label:"Conceptual"},{id:"graphite",label:"Graphite"}];function CU({className:n,activeCategory:e,onCategoryClick:t,counts:r,sketchbookLabels:s=[],sketchbookImageCounts:i=[],activeSketchbookIndex:a,onSketchbookClick:l,muralLabels:u=[],activeMuralIndex:d,onMuralClick:f}){const m=Ew.some(w=>w.id===e),g=e==="sketchbook",x=e==="murals",y=(w,b)=>{const E=e===w.id,T=r?.[w.id],_=T!==void 0&&T>0&&!(w.id==="sketchbook"&&m);return h.jsx("button",{onClick:()=>t(w.id),className:J("flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors","pl-3"),children:h.jsxs("span",{className:J("text-base font-medium tracking-wide leading-5 text-left transition-colors",E?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:[w.label,_&&h.jsxs("span",{className:"text-gray-300 ml-1",children:["(",T,")"]})]})},w.id)};return h.jsxs("div",{className:J("flex flex-col gap-3 items-start",n),children:[h.jsx("button",{onClick:()=>t("painting"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",m?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Fine Art"})}),h.jsx("div",{className:J("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",m?"max-h-40 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:Ew.map(w=>y(w))}),h.jsx("button",{onClick:()=>t("sketchbook"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",g?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Sketchbook"})}),h.jsx("div",{className:J("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",g?"max-h-96 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:s.map((w,b)=>{const E=i[b];return h.jsx("button",{onClick:()=>l?.(b),className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:h.jsxs("span",{className:J("text-base font-medium tracking-wide leading-5 text-left transition-colors",a===b?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:[w,E!==void 0&&E>0&&h.jsxs("span",{className:"text-gray-300 ml-1",children:["(",E,")"]})]})},b)})}),h.jsx("button",{onClick:()=>t("murals"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",x?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Murals"})}),h.jsx("div",{className:J("flex flex-col gap-2 overflow-hidden transition-all duration-300 ease-in-out",x?"max-h-96 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:u.map((w,b)=>h.jsx("button",{onClick:()=>f?.(b),className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:h.jsx("span",{className:J("text-base font-medium tracking-wide text-left transition-colors",d===b?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:w})},b))})]})}function jk({className:n}){return h.jsx("svg",{className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:h.jsx("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function Ok({className:n}){return h.jsx("svg",{className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:h.jsx("path",{d:"M9 18L15 12L9 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function AU({image:n,onClick:e,onLoad:t}){const[r,s]=L.useState(!1);return h.jsxs("button",{onClick:e,className:"flex-none inline-flex h-[200px] md:h-[300px] lg:h-96 rounded-xl overflow-hidden cursor-pointer items-center justify-center relative",style:{width:"auto",minWidth:"150px"},children:[h.jsx("div",{className:J("absolute inset-0 rounded-xl transition-opacity duration-500 ease-out",r?"opacity-0":"opacity-100 animate-shimmer")}),h.jsx("img",{src:n.imageSrc,alt:"",className:J("block h-[200px] md:h-[300px] lg:h-96 w-auto max-w-none object-contain transition-opacity duration-500 ease-out",r?"opacity-100":"opacity-0"),style:{maxWidth:"unset"},onLoad:()=>{s(!0),t?.()}})]})}function IU({className:n,data:e,onImageClick:t}){const r=L.useRef(null),s=L.useRef(null),[i,a]=L.useState(e.images.length>1),[l,u]=L.useState(e.images.length>1),d=L.useMemo(()=>e.images.length<=1?e.images:[...e.images,...e.images,...e.images],[e.images]),f=L.useCallback(()=>{const x=r.current;!x||d.length<=e.images.length||(s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{s.current=requestAnimationFrame(()=>{const y=x.scrollWidth;if(!y)return;const w=y/3;x.scrollLeft=w})}))},[e.images.length,d.length]);L.useEffect(()=>{const x=e.images.length>1;a(x),u(x)},[e.images.length]),L.useEffect(()=>{const x=r.current;if(!x||d.length<=e.images.length)return;const y=()=>{const w=x.scrollWidth;if(!w)return;const b=w/3;x.scrollLeft<=b*.1?x.scrollLeft+=b:x.scrollLeft>=b*1.9&&(x.scrollLeft-=b)};return f(),x.addEventListener("scroll",y),window.addEventListener("resize",f),()=>{x.removeEventListener("scroll",y),window.removeEventListener("resize",f),s.current&&cancelAnimationFrame(s.current)}},[e.images.length,d.length,f]);const m=()=>{f()},g=x=>{const y=r.current;if(!y)return;const b=Math.min(y.clientWidth*.82,320)+16,E=x==="left"?y.scrollLeft-b:y.scrollLeft+b;y.scrollTo({left:E,behavior:"smooth"})};return h.jsxs("div",{className:J("flex flex-col gap-6 pb-6 w-full",n),children:[h.jsxs("div",{className:"flex flex-col font-medium items-start leading-[1.4] text-base",children:[h.jsx("p",{className:"text-gray-900 text-lg",children:e.title}),h.jsx("p",{className:"text-gray-400",children:e.date})]}),h.jsxs("div",{className:"relative w-full",children:[h.jsx("div",{ref:r,className:"flex gap-4 items-center justify-start overflow-x-auto w-full scrollbar-hide pb-1",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:d.map((x,y)=>h.jsx(AU,{image:x,onClick:()=>t?.(x),onLoad:m},`${x.id}-${y}`))}),h.jsx("button",{onClick:()=>g("left"),disabled:!i,className:J("absolute top-1/2 left-0 -translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",i?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll left",children:h.jsx(jk,{className:"size-5"})}),h.jsx("button",{onClick:()=>g("right"),disabled:!l,className:J("absolute top-1/2 right-0 translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",l?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll right",children:h.jsx(Ok,{className:"size-5"})})]})]})}function LU({image:n,onClick:e,onLoad:t}){const[r,s]=L.useState(!1);return h.jsxs("button",{onClick:e,className:"flex-none inline-flex h-[200px] md:h-[250px] lg:h-96 rounded-xl overflow-hidden cursor-pointer transition-transform duration-300 items-center justify-center relative",style:{width:"auto",minWidth:"150px"},children:[h.jsx("div",{className:J("absolute inset-0 rounded-xl transition-opacity duration-500 ease-out",r?"opacity-0":"opacity-100 animate-shimmer")}),h.jsx("img",{src:n.imageSrc,alt:"",className:J("block h-[200px] md:h-[250px] lg:h-96 w-auto max-w-none object-contain transition-opacity duration-500 ease-out",r?"opacity-100":"opacity-0"),style:{maxWidth:"unset"},onLoad:()=>{s(!0),t?.()}})]})}function RU({className:n,data:e,onImageClick:t}){const r=L.useRef(null),s=L.useRef(null),[i,a]=L.useState(e.images.length>1),[l,u]=L.useState(e.images.length>1),d=L.useMemo(()=>e.images.length<=1?e.images:[...e.images,...e.images,...e.images],[e.images]),f=L.useCallback(()=>{const x=r.current;!x||d.length<=e.images.length||(s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{s.current=requestAnimationFrame(()=>{const y=x.scrollWidth;if(!y)return;const w=y/3;x.scrollLeft=w})}))},[e.images.length,d.length]);L.useEffect(()=>{const x=e.images.length>1;a(x),u(x)},[e.images.length]),L.useEffect(()=>{const x=r.current;if(!x||d.length<=e.images.length)return;const y=()=>{const w=x.scrollWidth;if(!w)return;const b=w/3;x.scrollLeft<=b*.1?x.scrollLeft+=b:x.scrollLeft>=b*1.9&&(x.scrollLeft-=b)};return f(),x.addEventListener("scroll",y),window.addEventListener("resize",f),()=>{x.removeEventListener("scroll",y),window.removeEventListener("resize",f),s.current&&cancelAnimationFrame(s.current)}},[e.images.length,d.length,f]);const m=()=>{f()},g=x=>{const y=r.current;if(!y)return;const b=Math.min(y.clientWidth*.82,320)+16,E=x==="left"?y.scrollLeft-b:y.scrollLeft+b;y.scrollTo({left:E,behavior:"smooth"})};return h.jsxs("div",{className:J("flex flex-col gap-4 pb-12 w-full",n),children:[h.jsxs("div",{className:"flex flex-col items-start w-full",children:[h.jsx("p",{className:"font-medium leading-normal pt-4 text-gray-900 text-lg mb-4",children:e.title}),h.jsxs("div",{className:"flex flex-col md:flex-row font-normal gap-5 items-start text-base w-full",children:[h.jsxs("div",{className:"flex flex-col items-start w-[202px] flex-shrink-0",children:[h.jsx("p",{className:"text-gray-500 font-medium",children:e.location}),h.jsx("p",{className:"text-gray-400",children:e.date})]}),e.description&&h.jsx("p",{className:"font-normal leading-normal pb-4 text-gray-400 max-w-[366px] mb-2 whitespace-pre-wrap",children:e.description})]})]}),h.jsx("div",{className:"bg-zinc-100 h-px shrink-0 w-full mb-2"}),h.jsxs("div",{className:"relative w-full",children:[h.jsx("div",{ref:r,className:"flex gap-4 items-center justify-start overflow-x-auto w-full scrollbar-hide pb-1",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:d.map((x,y)=>h.jsx(LU,{image:x,onLoad:m,onClick:()=>t?.(x)},`${x.id}-${y}`))}),h.jsx("button",{onClick:()=>g("left"),disabled:!i,className:J("absolute top-1/2 left-0 -translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",i?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll left",children:h.jsx(jk,{className:"size-5"})}),h.jsx("button",{onClick:()=>g("right"),disabled:!l,className:J("absolute top-1/2 right-0 translate-x-1/2 -translate-y-1/2 z-10 size-9 flex items-center justify-center rounded-full border border-gray-200 bg-white shadow-sm transition-colors",l?"text-gray-600 hover:text-gray-800":"text-gray-300 cursor-default"),"aria-label":"Scroll right",children:h.jsx(Ok,{className:"size-5"})})]})]})}const PU=`
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-up {
  animation: fadeUp 400ms ease-out forwards;
}
`;function Tm(n){return n.map(e=>{const r=[e.medium,e.size,e.year].filter(Boolean).join(", ");return{id:e._id,imageSrc:e.image?ze(e.image).width(800).url():"",title:e.title,metadata:r||void 0}})}function DU(n){return n.map(e=>({id:e._id,title:e.title,sidebarLabel:e.sidebarLabel,date:e.date,images:e.images?.map(t=>({id:t._key,imageSrc:t.asset?ze(t).height(600).url():""}))||[]}))}function NU(n){return n.map(e=>({id:e._id,title:e.title,sidebarLabel:e.sidebarLabel,location:e.location,date:e.date,description:e.description,images:e.images?.map(t=>({id:t._key,imageSrc:t.asset?ze(t).height(600).url():""}))||[]}))}function jU(n){const e={painting:[],conceptual:[],graphite:[]};return n.forEach(t=>{t.artType&&e[t.artType]&&e[t.artType].push(t)}),e}function OU(){Dr();const[n,e]=L.useState("painting"),[t,r]=L.useState(void 0),[s,i]=L.useState(void 0),[a,l]=L.useState(()=>sessionStorage.getItem("heroAnimationPlayed")==="true");L.useEffect(()=>{if(!a){const te=setTimeout(()=>{sessionStorage.setItem("heroAnimationPlayed","true"),l(!0)},500);return()=>clearTimeout(te)}},[a]);const u=L.useRef(null),d=L.useRef(null),f=L.useRef(null),m=L.useRef(null),g=L.useRef(null),x=L.useRef([]),y=L.useRef([]),[w,b]=L.useState({painting:[],conceptual:[],graphite:[]}),[E,T]=L.useState([]),[_,A]=L.useState([]),[I,N]=L.useState(!0),[P,O]=L.useState(null);L.useEffect(()=>{async function te(){try{N(!0),O(null);const re=Ye("art:pieces"),ee=Ye("art:sketchbooks"),Q=Ye("art:murals"),[G,Y,Z]=await Promise.all([re??it.fetch(VT),ee??it.fetch(GT),Q??it.fetch(HT)]),j=jU(G||[]);b({painting:Tm(j.painting),conceptual:Tm(j.conceptual),graphite:Tm(j.graphite)}),T(DU(Y||[])),A(NU(Z||[]))}catch(re){console.error("Error fetching art data:",re),O("Failed to load art content. Please try again later.")}finally{N(!1)}}te()},[]);const M=te=>{e(te),te==="sketchbook"?(r(0),i(void 0)):te==="murals"?(i(0),r(void 0)):(r(void 0),i(void 0));const ee={painting:u,conceptual:d,graphite:f,sketchbook:m,murals:g}[te];ee?.current&&ee.current.scrollIntoView({behavior:"smooth",block:"start"})},D=te=>{e("sketchbook"),r(te),i(void 0);const re=x.current[te];re&&re.scrollIntoView({behavior:"smooth",block:"start"})},B=te=>{e("murals"),i(te),r(void 0);const re=y.current[te];re&&re.scrollIntoView({behavior:"smooth",block:"start"})};L.useEffect(()=>{const te=()=>{const re=[{id:"painting",ref:u},{id:"conceptual",ref:d},{id:"graphite",ref:f},{id:"sketchbook",ref:m},{id:"murals",ref:g}],ee=250;let Q=null;for(let G=re.length-1;G>=0;G--){const Y=re[G];if(Y.ref.current&&Y.ref.current.getBoundingClientRect().top<=ee){Q=Y.id;break}}if(!Q){for(const G of re)if(G.ref.current){const Y=G.ref.current.getBoundingClientRect();if(Y.top<window.innerHeight&&Y.bottom>0){Q=G.id;break}}}if(Q)if(e(Q),Q==="sketchbook"){let G=0;for(let Y=x.current.length-1;Y>=0;Y--){const Z=x.current[Y];if(Z&&Z.getBoundingClientRect().top<=ee){G=Y;break}}r(G),i(void 0)}else if(Q==="murals"){let G=0;for(let Y=y.current.length-1;Y>=0;Y--){const Z=y.current[Y];if(Z&&Z.getBoundingClientRect().top<=ee){G=Y;break}}i(G),r(void 0)}else r(void 0),i(void 0)};return window.addEventListener("scroll",te),te(),()=>window.removeEventListener("scroll",te)},[E.length,_.length]);const q=te=>{console.log("Art item clicked:",te)},ie={painting:w.painting.length,conceptual:w.conceptual.length,graphite:w.graphite.length,sketchbook:E.length,murals:_.length};return h.jsxs("div",{className:"bg-white flex flex-col items-center relative size-full min-h-screen",children:[h.jsx("style",{children:PU}),h.jsx(J0,{variant:"art",heroAnimationPlayed:a,nameAddon:h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal text-gray-500 text-xl whitespace-pre-wrap",children:"b. 2004"}),children:h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"hidden md:block",children:[h.jsx("p",{className:"mb-0",children:"Currently based in Los Angeles, CA."}),h.jsx("p",{children:"Also in between San Francisco & New York City."})]}),h.jsxs("div",{className:"md:hidden",children:[h.jsx("p",{className:"mb-0",children:"Currently based in Los Angeles, CA."}),h.jsx("p",{className:"mb-0",children:"Also in between San Francisco"}),h.jsx("p",{children:"& New York City."})]})]})}),h.jsx(eg,{activeTab:"art",heroAnimationPlayed:a}),h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start px-16 max-md:px-8 pt-2 relative shrink-0 w-full",children:[h.jsx("div",{className:"hidden lg:block lg:sticky lg:top-8 pb-8 w-[202px] shrink-0",children:h.jsx(CU,{activeCategory:n,onCategoryClick:M,counts:ie,sketchbookLabels:E.map(te=>te.sidebarLabel||te.title.split(" ")[0].toUpperCase()),sketchbookImageCounts:E.map(te=>te.images.length),activeSketchbookIndex:t,onSketchbookClick:D,muralLabels:_.map(te=>te.sidebarLabel||te.title.split(" ")[0].toUpperCase()),activeMuralIndex:s,onMuralClick:B})}),h.jsxs("div",{className:"flex-1 flex flex-col gap-12 items-start justify-center pb-8 min-w-0 w-full",children:[I&&h.jsx("div",{className:"flex items-center justify-center w-full py-20",children:h.jsxs("div",{className:"flex flex-col items-center gap-4",children:[h.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),h.jsx("p",{className:"text-gray-400 text-base",children:"Loading artwork..."})]})}),P&&!I&&h.jsx("div",{className:"flex items-center justify-center w-full py-20",children:h.jsxs("div",{className:"flex flex-col items-center gap-4 text-center",children:[h.jsx("p",{className:"text-gray-600 text-base",children:P}),h.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 text-sm transition-colors",children:"Try Again"})]})}),!I&&!P&&h.jsxs(h.Fragment,{children:[h.jsxs("section",{ref:u,className:"flex flex-col gap-4 items-start w-full",children:[h.jsx(Be,{variant:"fade",className:"w-full",children:h.jsx(Mo,{text:"Painting"})}),w.painting.length>0?h.jsx(Be,{delay:120,children:h.jsx(Em,{items:w.painting,onItemClick:q})}):h.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No paintings yet."})]}),h.jsxs("section",{ref:d,className:"flex flex-col gap-4 items-start w-full",children:[h.jsx(Be,{variant:"fade",className:"w-full",children:h.jsx(Mo,{text:"Conceptual"})}),w.conceptual.length>0?h.jsx(Be,{delay:120,children:h.jsx(Em,{items:w.conceptual,onItemClick:q})}):h.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No conceptual pieces yet."})]}),h.jsxs("section",{ref:f,className:"flex flex-col gap-4 items-start w-full",children:[h.jsx(Be,{variant:"fade",className:"w-full",children:h.jsx(Mo,{text:"Graphite"})}),w.graphite.length>0?h.jsx(Be,{delay:120,children:h.jsx(Em,{items:w.graphite,onItemClick:q})}):h.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No graphite drawings yet."})]}),h.jsxs("section",{ref:m,className:"flex flex-col gap-4 items-start w-full",children:[h.jsx(Be,{variant:"fade",className:"w-full",children:h.jsx(Mo,{className:"-mb-4",text:"Sketchbook"})}),E.length>0?h.jsx("div",{className:"flex flex-col gap-8 py-8 w-full",children:E.map((te,re)=>h.jsx(Be,{delay:re*120,children:h.jsx("div",{ref:ee=>{x.current[re]=ee},children:h.jsx(IU,{data:te})})},te.id))}):h.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No sketchbooks yet."})]}),h.jsxs("section",{ref:g,className:"flex flex-col gap-4 items-start w-full",children:[h.jsx(Be,{variant:"fade",className:"w-full",children:h.jsx(Mo,{className:"-mb-4",text:"Murals"})}),_.length>0?h.jsx("div",{className:"flex flex-col gap-8 py-8 w-full",children:_.map((te,re)=>h.jsx(Be,{delay:re*120,children:h.jsx("div",{ref:ee=>{y.current[re]=ee},children:h.jsx(RU,{data:te})})},te.id))}):h.jsx("p",{className:"text-gray-400 text-sm py-8",children:"No murals yet."})]})]})]})]}),h.jsx(hd,{})]})}function MU({text:n,underlinedText:e,isRevealed:t}){if(!e||!n.includes(e))return h.jsx(h.Fragment,{children:n});const r=n.indexOf(e),s=n.slice(0,r),i=n.slice(r+e.length);return h.jsxs(h.Fragment,{children:[s,h.jsx("span",{className:"quote-underline-wrapper",children:h.jsx("span",{className:J("quote-animated-underline",t&&"revealed"),children:e})}),i]})}function Ap({className:n,data:e,variant:t="default",aspectRatio:r,onClick:s,topRow:i=!1}){const a=e?.type||"Book",l=!!e?.imageSrc,u=r?r==="square":a==="Music",d=L.useRef(null),[f,m]=L.useState(!1);if(L.useEffect(()=>{if(a!=="Quote")return;const P=d.current;if(!P)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches){m(!0);return}const M=new IntersectionObserver(D=>{D.forEach(B=>{B.isIntersecting&&(setTimeout(()=>{m(!0)},400),M.unobserve(P))})},{threshold:.3,rootMargin:"0px"});return M.observe(P),()=>M.disconnect()},[a]),a==="Quote")return h.jsx("div",{ref:d,className:J("flex h-full min-h-[260px] md:min-h-[280px] flex-col items-start overflow-hidden rounded-3xl border border-gray-100 bg-white transition-shadow duration-200","shadow-[0px_4px_16px_0px_rgba(209,213,219,0.65)]","md:rounded-3xl",n),children:h.jsxs("div",{className:J("flex w-full flex-col gap-4 px-12 pb-12 md:gap-4 md:px-12 md:pb-12",i?"pt-14 md:pt-18":"pt-14 md:pt-14"),children:[e?.emoji&&h.jsx("p",{className:"font-['Figtree'] text-4xl",children:e.emoji}),e?.quoteTitle&&h.jsx("p",{className:"whitespace-pre-wrap font-['Figtree'] -mb-1 text-2xl tracking-[0.01em] font-medium text-gray-700",children:e.quoteTitle}),h.jsxs("div",{className:"flex flex-col items-start text-base tracking-[0.005em] md:text-base",children:[e?.quoteText&&h.jsx("p",{className:"font-['Figtree'] font-normal text-gray-500 mb-0.5",children:h.jsx(MU,{text:e.quoteText,underlinedText:e.quoteUnderlinedText,isRevealed:f})}),e?.quoteAuthor&&h.jsx("p",{className:"font-['Figtree'] font-normal text-gray-400",children:e.quoteAuthor})]})]})});const x=(()=>{if(a==="Book"&&e?.goodreadsUrl)return e.goodreadsUrl;if(a==="Music"&&e?.spotifyUrl)return e.spotifyUrl;if(a==="Movie"&&e?.letterboxdSlug)return`https://letterboxd.com/liumichelle/film/${e.letterboxdSlug}/`})(),[y,w]=L.useState(!1),[b,E]=L.useState(!1);L.useEffect(()=>{w(!1),E(!1)},[e?.imageSrc]);const T=L.useCallback(()=>{w(!0)},[]),_=L.useCallback(()=>{E(!0)},[]),A=l&&!y&&!b,I=J("relative overflow-hidden transition-transform hover:scale-[1.01]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",u?"aspect-square":"aspect-[210/310]",t==="default"&&"rounded-xl md:rounded-md",t==="expanded"&&"rounded-lg md:rounded-md",!l&&"bg-gray-300",x?"cursor-pointer":"",n),N=h.jsxs(h.Fragment,{children:[A&&h.jsx("div",{className:"absolute inset-0 animate-shimmer transition-opacity duration-500 ease-out"}),l&&h.jsx("img",{src:e.imageSrc,alt:e.title||"Media cover",className:J("absolute inset-0 h-full w-full object-cover transition-opacity duration-500 ease-out",y?"opacity-100":"opacity-0"),loading:"lazy",onLoad:T,onError:_})]});return x?h.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",className:J(I,"block"),title:e?.title,"aria-label":e?.title||"Media item",children:N}):h.jsx("button",{onClick:s,className:I,title:e?.title,"aria-label":e?.title||"Media item",children:N})}function FU({className:n,data:e,onClick:t}){const r=!!e.imageSrc,s=e.imageBackground||"#e3dff4",i=()=>{e.link?window.open(e.link,"_blank","noopener,noreferrer"):t&&t()};return h.jsxs("button",{onClick:i,className:J("group flex w-full flex-col items-start text-left","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2",n),children:[h.jsx("div",{className:"relative h-[140px] md:h-[200px] w-full shrink-0 rounded-2xl sm:rounded-3xl",children:r?h.jsx("img",{src:e.imageSrc,alt:e.headline,className:"absolute inset-0 h-full w-full rounded-2xl sm:rounded-3xl object-cover transition-transform duration-200 ease-out group-hover:scale-[1.01]",loading:"lazy"}):h.jsx("div",{className:"h-full w-full transition-transform duration-200 ease-out group-hover:scale-[1.01]",style:{backgroundColor:s}})}),h.jsxs("div",{className:"flex w-full flex-col px-1 font-['Figtree',sans-serif] pt-2 text-base tracking-[0.005em]",children:[h.jsxs("div",{className:"flex w-full items-start justify-between",children:[h.jsxs("div",{className:"flex flex-col md:flex-row md:gap-1 md:items-center md:flex-wrap",children:[h.jsx("span",{className:"text-gray-600 text-base font-medium md:text-lg",children:e.headline}),e.date&&h.jsxs(h.Fragment,{children:[h.jsxs("span",{className:"hidden md:inline text-gray-400 text-base font-normal",children:["  ",e.date]}),h.jsx("span",{className:"md:hidden text-gray-400 font-normal text-sm",children:e.date})]})]}),h.jsx("span",{className:"text-gray-700 text-sm opacity-100 md:opacity-0 transition-opacity duration-200 ease-out md:group-hover:opacity-100",children:h.jsx(Gs,{})})]}),e.description&&h.jsx("p",{className:"whitespace-pre-wrap font-normal text-sm sm:text-base tracking-[0.005em] leading-tight text-gray-400 md:opacity-0 md:translate-y-1 md:transition-all md:duration-300 md:ease-out md:group-hover:opacity-100 md:group-hover:translate-y-0",children:e.description})]})]})}function BU({className:n,data:e}){const t=e.photos||[],[r,s]=L.useState(null),i=[11,-2,-11,-9],a=r?t.find(l=>l.id===r):null;return $a(!!r),L.useEffect(()=>{const l=u=>{u.key==="Escape"&&r&&s(null)};return r&&document.addEventListener("keydown",l),()=>{document.removeEventListener("keydown",l)}},[r]),h.jsxs("div",{className:J("flex w-full flex-col gap-12 py-2",n),children:[h.jsxs("div",{className:"flex w-full shrink-0 flex-col gap-6 lg:hidden",children:[e.logoSrc&&h.jsx("div",{className:"relative h-16 w-16 shrink-0",children:h.jsx("img",{src:e.logoSrc,alt:`${e.title} logo`,className:"h-full w-full object-contain"})}),h.jsxs("div",{className:"flex w-full max-w-lg flex-col gap-4 whitespace-pre-wrap font-normal leading-[1.2]",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("h3",{className:"text-xl font-medium text-gray-600",children:e.title}),e.instagramUrl&&h.jsx("a",{href:e.instagramUrl,target:"_blank",rel:"noopener noreferrer",className:"flex h-6 w-6 items-center justify-center text-gray-500 transition-colors hover:text-gray-700","aria-label":`${e.title} Instagram`,children:h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("path",{d:"M10 1.80078C12.6719 1.80078 12.9883 1.8125 14.0391 1.85937C15.0156 1.90234 15.543 2.06641 15.8945 2.20313C16.3594 2.38281 16.6953 2.60156 17.043 2.94922C17.3945 3.30078 17.6094 3.63281 17.7891 4.09766C17.9258 4.44922 18.0898 4.98047 18.1328 5.95313C18.1797 7.00781 18.1914 7.32422 18.1914 9.99219C18.1914 12.6641 18.1797 12.9805 18.1328 14.0313C18.0898 15.0078 17.9258 15.5352 17.7891 15.8867C17.6094 16.3516 17.3906 16.6875 17.043 17.0352C16.6914 17.3867 16.3594 17.6016 15.8945 17.7813C15.543 17.918 15.0117 18.082 14.0391 18.125C12.9844 18.1719 12.668 18.1836 10 18.1836C7.32813 18.1836 7.01172 18.1719 5.96094 18.125C4.98438 18.082 4.45703 17.918 4.10547 17.7813C3.64063 17.6016 3.30469 17.3828 2.95703 17.0352C2.60547 16.6836 2.39063 16.3516 2.21094 15.8867C2.07422 15.5352 1.91016 15.0039 1.86719 14.0313C1.82031 12.9766 1.80859 12.6602 1.80859 9.99219C1.80859 7.32031 1.82031 7.00391 1.86719 5.95313C1.91016 4.97656 2.07422 4.44922 2.21094 4.09766C2.39063 3.63281 2.60938 3.29687 2.95703 2.94922C3.30859 2.59766 3.64063 2.38281 4.10547 2.20313C4.45703 2.06641 4.98828 1.90234 5.96094 1.85937C7.01172 1.8125 7.32813 1.80078 10 1.80078ZM10 0C7.28516 0 6.94531 0.0117188 5.87891 0.0585938C4.81641 0.105469 4.08594 0.277344 3.45313 0.523437C2.79297 0.78125 2.23438 1.12109 1.67969 1.67969C1.12109 2.23438 0.78125 2.79297 0.523438 3.44922C0.277344 4.08594 0.105469 4.8125 0.0585938 5.875C0.0117188 6.94531 0 7.28516 0 10C0 12.7148 0.0117188 13.0547 0.0585938 14.1211C0.105469 15.1836 0.277344 15.9141 0.523438 16.5469C0.78125 17.207 1.12109 17.7656 1.67969 18.3203C2.23438 18.875 2.79297 19.2188 3.44922 19.4727C4.08594 19.7188 4.8125 19.8906 5.875 19.9375C6.94141 19.9844 7.28125 19.9961 9.99609 19.9961C12.7109 19.9961 13.0508 19.9844 14.1172 19.9375C15.1797 19.8906 15.9102 19.7188 16.543 19.4727C17.1992 19.2188 17.7578 18.875 18.3125 18.3203C18.8672 17.7656 19.2109 17.207 19.4648 16.5508C19.7109 15.9141 19.8828 15.1875 19.9297 14.125C19.9766 13.0586 19.9883 12.7188 19.9883 10.0039C19.9883 7.28906 19.9766 6.94922 19.9297 5.88281C19.8828 4.82031 19.7109 4.08984 19.4648 3.45703C19.2188 2.79297 18.8789 2.23438 18.3203 1.67969C17.7656 1.125 17.207 0.78125 16.5508 0.527344C15.9141 0.28125 15.1875 0.109375 14.125 0.0625C13.0547 0.0117188 12.7148 0 10 0Z",fill:"currentColor"}),h.jsx("path",{d:"M10 4.86328C7.16406 4.86328 4.86328 7.16406 4.86328 10C4.86328 12.8359 7.16406 15.1367 10 15.1367C12.8359 15.1367 15.1367 12.8359 15.1367 10C15.1367 7.16406 12.8359 4.86328 10 4.86328ZM10 13.332C8.16016 13.332 6.66797 11.8398 6.66797 10C6.66797 8.16016 8.16016 6.66797 10 6.66797C11.8398 6.66797 13.332 8.16016 13.332 10C13.332 11.8398 11.8398 13.332 10 13.332Z",fill:"currentColor"}),h.jsx("path",{d:"M16.5391 4.66016C16.5391 5.32422 16 5.85938 15.3398 5.85938C14.6758 5.85938 14.1406 5.32031 14.1406 4.66016C14.1406 3.99609 14.6797 3.46094 15.3398 3.46094C16 3.46094 16.5391 4 16.5391 4.66016Z",fill:"currentColor"})]})})]}),e.description&&h.jsx("p",{className:"text-sm text-gray-400",children:e.description})]})]}),h.jsxs("div",{className:"hidden w-full items-start py-8 justify-between gap-12 lg:flex",children:[h.jsxs("div",{className:"flex shrink-0 items-center gap-4 xl:gap-8",children:[e.logoSrc&&h.jsx("div",{className:"relative h-[90px] w-[90px] shrink-0",children:h.jsx("img",{src:e.logoSrc,alt:`${e.title} logo`,className:"h-full w-full object-contain"})}),h.jsx("h3",{className:"text-2xl font-medium leading-[1.4] text-gray-600",children:e.title}),e.instagramUrl&&h.jsx("a",{href:e.instagramUrl,target:"_blank",rel:"noopener noreferrer",className:"flex h-6 w-6 items-center justify-center text-gray-400 transition-colors hover:text-gray-500","aria-label":`${e.title} Instagram`,children:h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("path",{d:"M10 1.80078C12.6719 1.80078 12.9883 1.8125 14.0391 1.85937C15.0156 1.90234 15.543 2.06641 15.8945 2.20313C16.3594 2.38281 16.6953 2.60156 17.043 2.94922C17.3945 3.30078 17.6094 3.63281 17.7891 4.09766C17.9258 4.44922 18.0898 4.98047 18.1328 5.95313C18.1797 7.00781 18.1914 7.32422 18.1914 9.99219C18.1914 12.6641 18.1797 12.9805 18.1328 14.0313C18.0898 15.0078 17.9258 15.5352 17.7891 15.8867C17.6094 16.3516 17.3906 16.6875 17.043 17.0352C16.6914 17.3867 16.3594 17.6016 15.8945 17.7813C15.543 17.918 15.0117 18.082 14.0391 18.125C12.9844 18.1719 12.668 18.1836 10 18.1836C7.32813 18.1836 7.01172 18.1719 5.96094 18.125C4.98438 18.082 4.45703 17.918 4.10547 17.7813C3.64063 17.6016 3.30469 17.3828 2.95703 17.0352C2.60547 16.6836 2.39063 16.3516 2.21094 15.8867C2.07422 15.5352 1.91016 15.0039 1.86719 14.0313C1.82031 12.9766 1.80859 12.6602 1.80859 9.99219C1.80859 7.32031 1.82031 7.00391 1.86719 5.95313C1.91016 4.97656 2.07422 4.44922 2.21094 4.09766C2.39063 3.63281 2.60938 3.29687 2.95703 2.94922C3.30859 2.59766 3.64063 2.38281 4.10547 2.20313C4.45703 2.06641 4.98828 1.90234 5.96094 1.85937C7.01172 1.8125 7.32813 1.80078 10 1.80078ZM10 0C7.28516 0 6.94531 0.0117188 5.87891 0.0585938C4.81641 0.105469 4.08594 0.277344 3.45313 0.523437C2.79297 0.78125 2.23438 1.12109 1.67969 1.67969C1.12109 2.23438 0.78125 2.79297 0.523438 3.44922C0.277344 4.08594 0.105469 4.8125 0.0585938 5.875C0.0117188 6.94531 0 7.28516 0 10C0 12.7148 0.0117188 13.0547 0.0585938 14.1211C0.105469 15.1836 0.277344 15.9141 0.523438 16.5469C0.78125 17.207 1.12109 17.7656 1.67969 18.3203C2.23438 18.875 2.79297 19.2188 3.44922 19.4727C4.08594 19.7188 4.8125 19.8906 5.875 19.9375C6.94141 19.9844 7.28125 19.9961 9.99609 19.9961C12.7109 19.9961 13.0508 19.9844 14.1172 19.9375C15.1797 19.8906 15.9102 19.7188 16.543 19.4727C17.1992 19.2188 17.7578 18.875 18.3125 18.3203C18.8672 17.7656 19.2109 17.207 19.4648 16.5508C19.7109 15.9141 19.8828 15.1875 19.9297 14.125C19.9766 13.0586 19.9883 12.7188 19.9883 10.0039C19.9883 7.28906 19.9766 6.94922 19.9297 5.88281C19.8828 4.82031 19.7109 4.08984 19.4648 3.45703C19.2188 2.79297 18.8789 2.23438 18.3203 1.67969C17.7656 1.125 17.207 0.78125 16.5508 0.527344C15.9141 0.28125 15.1875 0.109375 14.125 0.0625C13.0547 0.0117188 12.7148 0 10 0Z",fill:"currentColor"}),h.jsx("path",{d:"M10 4.86328C7.16406 4.86328 4.86328 7.16406 4.86328 10C4.86328 12.8359 7.16406 15.1367 10 15.1367C12.8359 15.1367 15.1367 12.8359 15.1367 10C15.1367 7.16406 12.8359 4.86328 10 4.86328ZM10 13.332C8.16016 13.332 6.66797 11.8398 6.66797 10C6.66797 8.16016 8.16016 6.66797 10 6.66797C11.8398 6.66797 13.332 8.16016 13.332 10C13.332 11.8398 11.8398 13.332 10 13.332Z",fill:"currentColor"}),h.jsx("path",{d:"M16.5391 4.66016C16.5391 5.32422 16 5.85938 15.3398 5.85938C14.6758 5.85938 14.1406 5.32031 14.1406 4.66016C14.1406 3.99609 14.6797 3.46094 15.3398 3.46094C16 3.46094 16.5391 4 16.5391 4.66016Z",fill:"currentColor"})]})})]}),e.description&&h.jsx("p",{className:"max-w-xs xl:max-w-sm mr-12 shrink-0 whitespace-pre-wrap text-base tracking-[0.005em] font-normal leading-[1.4] text-gray-400",children:e.description})]}),t.length>0&&h.jsxs("div",{className:"relative w-full shrink-0 px-4",children:[h.jsx("div",{className:"flex w-full flex-col items-center gap-10 lg:hidden",children:t.slice(0,4).map((l,u)=>{const d=l.rotation??i[u]??0,f=l.orientation==="vertical";return h.jsx("div",{className:"relative cursor-pointer",onClick:()=>s(l.id),children:h.jsxs("div",{className:"relative flex flex-col gap-1",style:{transform:`rotate(${d}deg)`},children:[h.jsxs("div",{className:"relative transition-transform duration-200 hover:scale-[1.01]",children:[h.jsx("div",{className:"absolute -inset-2 rounded-sm border border-gray-100 bg-white shadow-[0px_4px_8px_0px_rgba(0,0,0,0.15)]"}),h.jsx("div",{className:J("relative overflow-hidden rounded-sm",f?"h-52 w-44":"h-44 w-52"),children:h.jsx("img",{src:l.imageSrc,alt:l.caption||"Community photo",className:"h-full w-full object-cover",loading:"lazy"})})]}),l.caption&&h.jsx("p",{className:J("mt-3 font-['DM_Sans'] text-sm font-normal text-gray-500",f?"w-44":"w-52"),style:{fontVariationSettings:"'opsz' 9"},children:l.caption})]})},l.id)})}),h.jsx("div",{className:"hidden lg:grid xl:hidden grid-cols-2 gap-8 justify-items-center",children:t.slice(0,4).map((l,u)=>{const d=l.rotation??i[u]??0,f=l.orientation==="vertical";return h.jsx("div",{className:"relative cursor-pointer",onClick:()=>s(l.id),children:h.jsxs("div",{className:"relative flex flex-col gap-1",style:{transform:`rotate(${d}deg)`},children:[h.jsxs("div",{className:"relative transition-transform duration-200 hover:scale-[1.01]",children:[h.jsx("div",{className:"absolute -inset-2 rounded-sm border border-gray-100 bg-white shadow-[0px_4px_8px_0px_rgba(0,0,0,0.15)]"}),h.jsx("div",{className:J("relative overflow-hidden rounded-sm",f?"h-56 w-48":"h-48 w-56"),children:h.jsx("img",{src:l.imageSrc,alt:l.caption||"Community photo",className:"h-full w-full object-cover",loading:"lazy"})})]}),l.caption&&h.jsx("p",{className:J("mt-3 font-['DM_Sans'] text-sm font-normal text-gray-500",f?"w-48":"w-56"),style:{fontVariationSettings:"'opsz' 9"},children:l.caption})]})},l.id)})}),h.jsx("div",{className:"hidden h-[400px] w-full items-start justify-center xl:flex",children:t.slice(0,4).map((l,u)=>{const d=l.rotation??i[u]??0,f=l.orientation==="vertical",m=parseInt(l.yOffset||"0",10)*4,g=parseInt(l.xOffset||"0",10)*4,x=["","-ml-2","-ml-2","-ml-2"];return h.jsx("div",{className:J("cursor-pointer",x[u]),style:{transform:`translate(${g}px, ${m}px)`},onClick:()=>s(l.id),children:h.jsxs("div",{className:"relative flex flex-col gap-1",style:{transform:`rotate(${d}deg)`},children:[h.jsxs("div",{className:"relative transition-transform duration-200 hover:scale-[1.01]",children:[h.jsx("div",{className:"absolute -inset-2 rounded-sm border border-gray-100 bg-white shadow-[0px_4px_8px_0px_rgba(0,0,0,0.15)]"}),h.jsx("div",{className:J("relative overflow-hidden rounded-sm",f?"h-72 w-60":"h-60 w-72"),children:h.jsx("img",{src:l.imageSrc,alt:l.caption||"Community photo",className:"h-full w-full object-cover",loading:"lazy"})})]}),l.caption&&h.jsx("p",{className:J("mt-2 font-['DM_Sans'] text-sm font-normal leading-tight text-gray-500",f?"w-60":"w-72"),style:{fontVariationSettings:"'opsz' 9"},children:l.caption})]})},l.id)})})]}),a&&Mp.createPortal(h.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-[fadeIn_200ms_ease-out]",onClick:()=>s(null),children:[h.jsx("div",{className:"absolute inset-0 bg-gray-100/95"}),h.jsx("button",{onClick:l=>{l.stopPropagation(),s(null)},className:"fixed right-4 top-4 z-[10000] flex h-10 w-10 items-center justify-center transition-all duration-200 hover:scale-110 animate-[fadeSlideDown_300ms_ease-out]","aria-label":"Close expanded photo",children:h.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M1 1L13 13M1 13L13 1",stroke:"#9ca3af",strokeWidth:"2",strokeLinecap:"round"})})}),h.jsx("div",{className:"relative z-10 flex max-h-[85vh] max-w-[90vw] flex-col items-center animate-[scaleIn_300ms_ease-out]",onClick:l=>l.stopPropagation(),children:h.jsxs("div",{className:"relative flex flex-col items-center gap-1",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute -inset-3 rounded-sm border border-gray-100 bg-white shadow-[0px_8px_24px_0px_rgba(0,0,0,0.15)]"}),h.jsx("div",{className:J("relative overflow-hidden rounded-sm",a.orientation==="vertical"?"h-[65vh] max-h-[500px] w-auto":"h-auto max-h-[55vh] w-[80vw] max-w-[600px]"),children:h.jsx("img",{src:a.imageSrc,alt:a.caption||"Community photo",className:"h-full w-full object-contain"})})]}),a.caption&&h.jsx("p",{className:"mt-6 max-w-[600px] text-center font-['DM_Sans'] text-base tracking-[0.005em] font-normal leading-relaxed text-gray-600 animate-[fadeSlideUp_300ms_ease-out_100ms_both]",style:{fontVariationSettings:"'opsz' 9"},children:a.caption})]})})]}),document.body)]})}function UU({className:n,data:e}){return h.jsxs("div",{className:J("flex items-center gap-5 w-full",n),children:[h.jsx("div",{className:"relative h-20 w-20 shrink-0 overflow-hidden rounded-full md:h-24 md:w-24",children:e.logoSrc?h.jsx("img",{src:e.logoSrc,alt:`${e.company} logo`,className:"h-full w-full object-cover"}):h.jsx("div",{className:"h-full w-full bg-gray-200"})}),h.jsxs("div",{className:"flex flex-1 flex-col items-start",children:[h.jsx("p",{className:"whitespace-pre-wrap text-base tracking-[0.005em] text-lg font-medium leading-[1.4] text-gray-700",children:e.company}),h.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 text-base tracking-[0.005em] font-normal leading-[1.4]",children:[h.jsxs("span",{className:"text-gray-500",children:[e.role,e.period&&h.jsx("span",{className:"text-gray-400",children:","})]}),e.period&&h.jsx("span",{className:"text-gray-400 whitespace-nowrap",children:e.period})]})]})]})}const $U=[{id:"books",label:"Books"},{id:"music",label:"Music"},{id:"movies",label:"Movies"}];function VU({activeCategory:n,onCategoryClick:e,communityItems:t=[],activeCommunityId:r,onCommunityClick:s,activeShelfSubcategory:i,onShelfSubcategoryClick:a,shelfCounts:l}){const u=[{id:"hi",label:"Hi!"},{id:"experience",label:"Experience"}],d=n==="community",f=n==="shelf",m=t.filter(g=>g.sidebarName);return h.jsxs("nav",{className:"flex flex-col gap-3 items-start",children:[u.map(g=>h.jsx("button",{onClick:()=>e(g.id),className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",n===g.id?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:g.label})},g.id)),h.jsx("button",{onClick:()=>{e("community"),m.length>0&&s?.(m[0].id)},className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",d?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Community"})}),m.length>0&&h.jsx("div",{className:J("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",d?"max-h-96 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:m.map(g=>{const x=r===g.id;return h.jsx("button",{onClick:()=>{e("community"),s?.(g.id)},className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 text-left transition-colors",x?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:g.sidebarName})},g.id)})}),h.jsx("button",{onClick:()=>e("philosophy"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",n==="philosophy"?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:"Philosophy"})}),h.jsx("button",{onClick:()=>{e("shelf"),a?.("books")},className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",f?"text-gray-500":"text-gray-400 hover:text-gray-500"),children:"Shelf"})}),h.jsx("div",{className:J("flex flex-col gap-3 overflow-hidden transition-all duration-300 ease-in-out",f?"max-h-40 opacity-100 mt-0":"max-h-0 opacity-0 -mt-3"),children:$U.map(g=>{const x=i===g.id,y=l?.[g.id],w=y!==void 0&&y>0;return h.jsx("button",{onClick:()=>{e("shelf"),a?.(g.id)},className:"flex items-center px-0.5 py-0 rounded-full cursor-pointer transition-colors pl-3",children:h.jsxs("span",{className:J("text-base font-medium tracking-wide leading-5 text-left transition-colors",x?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:[g.label,w&&h.jsxs("span",{className:"text-gray-300 ml-1",children:["(",y,")"]})]})},g.id)})}),h.jsx("button",{onClick:()=>e("lore"),className:"flex items-center px-0.5 py-0 cursor-pointer",children:h.jsx("span",{className:J("text-base font-medium tracking-wide leading-5 transition-colors",n==="lore"?"text-blue-500":"text-gray-400 hover:text-gray-500"),children:"Lore"})})]})}function _m({className:n,title:e,count:t,mediaType:r,yearFilters:s=[],activeYear:i,onYearChange:a,externalLink:l,items:u,itemCount:d=5,onItemClick:f}){const m=i?u.filter(D=>D.year===i):u.filter(D=>D.isFeatured),g=i?m:m.slice(0,d),x=r==="music",[y,w]=L.useState(0),b=i||"featured",[E,T]=L.useState(!1),_=L.useRef(null),A=L.useRef(null),[I,N]=L.useState({top:0,left:0}),P=L.useRef(),O=()=>{P.current&&cancelAnimationFrame(P.current),P.current=requestAnimationFrame(()=>{if(A.current&&_.current){const D=A.current.getBoundingClientRect(),B=D.bottom+4,q=D.left;_.current.style.transform=`translate(${q}px, ${B}px)`}})},M=()=>{if(A.current){const D=A.current.getBoundingClientRect();N({top:D.bottom+4,left:D.left})}};return L.useEffect(()=>{if(E){const D=()=>{window.innerWidth>=1024&&T(!1)};return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)}},[E]),L.useEffect(()=>{if(E){M();const D=setTimeout(()=>{window.addEventListener("scroll",O,!0),window.addEventListener("resize",O)},0);return()=>{clearTimeout(D),window.removeEventListener("scroll",O,!0),window.removeEventListener("resize",O),P.current&&cancelAnimationFrame(P.current)}}},[E]),L.useEffect(()=>{function D(B){_.current&&!_.current.contains(B.target)&&A.current&&!A.current.contains(B.target)&&T(!1)}return E&&document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[E]),L.useEffect(()=>{w(D=>D+1)},[b]),h.jsxs("div",{className:J("flex w-full flex-col gap-1",n),children:[h.jsxs("div",{className:"relative flex w-full flex-col py-4",children:[h.jsxs("div",{className:"flex items-center pb-2",children:[s.length>0&&h.jsxs("div",{className:"relative lg:hidden shrink-0",children:[h.jsxs("button",{ref:A,onClick:()=>{E||M(),T(!E)},className:J("flex shrink-0 items-center gap-1.5 rounded-full px-3 py-1 transition-colors cursor-pointer","bg-gray-500/10"),children:[h.jsx("span",{className:"font-['Figtree',sans-serif] font-medium text-sm tracking-wide whitespace-nowrap text-gray-500",children:i?(()=>{const D=s.find(B=>B.year===i);return D?h.jsxs(h.Fragment,{children:[D.year,D.count!==void 0&&h.jsxs("span",{className:"text-gray-400",children:[" (",D.count,")"]})]}):i})():h.jsxs(h.Fragment,{children:[e,t!==void 0&&h.jsxs("span",{className:"text-gray-400",children:[" (",t,")"]})]})}),h.jsx("svg",{className:J("w-3 h-3 text-gray-400 transition-transform duration-200",E&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),E&&Mp.createPortal(h.jsx("div",{ref:_,className:"fixed bg-white rounded-lg shadow-lg border border-gray-100 z-[9999] min-w-[140px] animate-in fade-in slide-in-from-top-1 duration-200",style:{top:0,left:0,transform:`translate(${I.left}px, ${I.top}px)`,willChange:"transform"},children:h.jsxs("div",{className:"flex flex-col py-1.5 px-1.5",children:[h.jsx("button",{onClick:()=>{a?.(""),T(!1)},className:J("flex items-center px-3 py-1.5 rounded-md transition-colors text-left",i?"hover:bg-gray-50":"bg-gray-100"),children:h.jsxs("span",{className:J("font-['Figtree',sans-serif] font-medium text-sm tracking-wide",i?"text-gray-400":"text-gray-600"),children:[e,t!==void 0&&h.jsxs("span",{className:i?"text-gray-300":"text-gray-400",children:[" (",t,")"]})]})}),s.map(D=>{const B=i===D.year;return h.jsx("button",{onClick:()=>{a?.(D.year),T(!1)},className:J("flex items-center px-3 py-1.5 rounded-md transition-colors text-left",B?"bg-gray-100":"hover:bg-gray-50"),children:h.jsxs("span",{className:J("font-['Figtree',sans-serif] font-medium text-sm tracking-wide",B?"text-gray-600":"text-gray-400"),children:[D.year,D.count!==void 0&&h.jsxs("span",{className:B?"text-gray-400":"text-gray-300",children:[" ","(",D.count,")"]})]})},D.year)})]})}),document.body)]}),s.length===0&&h.jsx("button",{onClick:()=>a?.(""),className:J("flex lg:hidden shrink-0 items-center justify-center rounded-full px-3 py-1 transition-colors cursor-pointer",i?"hover:bg-gray-500/5":"bg-gray-500/10"),children:h.jsxs("span",{className:J("font-['Figtree',sans-serif] font-medium text-sm tracking-wide whitespace-nowrap",i?"text-gray-400":"text-gray-500"),children:[e,t!==void 0&&h.jsxs("span",{className:i?"text-gray-300":"text-gray-400",children:[" (",t,")"]})]})}),h.jsx("div",{className:"flex-1 lg:hidden"}),h.jsxs("div",{className:"hidden lg:flex items-center gap-1 min-w-0 overflow-hidden flex-1",children:[h.jsx("button",{onClick:()=>a?.(""),className:J("flex shrink-0 items-center justify-center rounded-full px-3 py-1 transition-colors cursor-pointer",i?"hover:bg-gray-500/5":"bg-gray-500/10"),children:h.jsxs("span",{className:J("font-['Figtree',sans-serif] font-medium text-base tracking-wide whitespace-nowrap",i?"text-gray-400":"text-gray-500"),children:[e,t!==void 0&&h.jsxs("span",{className:i?"text-gray-300":"text-gray-400",children:[" (",t,")"]})]})}),s.map(D=>{const B=i===D.year;return h.jsx("button",{onClick:()=>a?.(D.year),className:J("flex shrink-0 cursor-pointer items-center justify-center rounded-full px-3 py-1 transition-colors",B?"bg-gray-500/10":"hover:bg-gray-500/5"),children:h.jsxs("span",{className:J("font-['Figtree',sans-serif] text-base font-medium tracking-wide whitespace-nowrap",B?"text-gray-600":"text-gray-400"),children:[D.year,D.count!==void 0&&h.jsxs("span",{className:B?"text-gray-400":"text-gray-300",children:[" ","(",D.count,")"]})]})},D.year)})]}),l&&h.jsx("div",{className:"shrink-0 flex items-center pl-6 bg-gradient-to-r from-transparent to-white",children:h.jsx("a",{href:l.href,target:"_blank",rel:"noopener noreferrer",className:"cursor-pointer transition-colors bg-white",children:h.jsxs("span",{className:"font-['Figtree',sans-serif] text-sm md:text-base font-normal tracking-wide text-gray-400 hover:text-blue-500 transition-colors whitespace-nowrap",children:[l.label," ",h.jsx(Gs,{})]})})})]}),h.jsx("div",{className:"h-px w-full bg-gray-200"})]}),h.jsx("div",{children:g.length>0?i?h.jsx("div",{className:"grid grid-cols-5 md:grid-cols-10 gap-2 md:gap-3 w-full py-2",children:g.map((D,B)=>h.jsx("div",{className:"animate-shelf-item-fade-up",style:{animationDelay:`${Math.min(B*20,200)}ms`},children:h.jsx(Ap,{data:D,variant:"default",aspectRatio:x?"square":"portrait",onClick:()=>f?.(D),className:"w-full"})},D.id||B))}):h.jsx("div",{className:"grid grid-cols-5 md:flex md:justify-center gap-2 md:gap-6 w-full py-2 lg:px-[118px]",children:g.map((D,B)=>h.jsx("div",{className:"animate-shelf-item-fade-up w-full md:flex-1 md:min-w-0",style:{animationDelay:`${B*50}ms`},children:h.jsx(Ap,{data:D,variant:"default",aspectRatio:x?"square":"portrait",onClick:()=>f?.(D),className:"w-full h-full"})},D.id||B))}):h.jsx("div",{className:"flex w-full items-start py-2 animate-shelf-item-fade-up",children:h.jsxs("p",{className:"text-gray-400 text-sm py-4",children:["No ",r,"s added yet. Add them in Sanity Studio."]})})},y)]})}function Mk({hoverMode:n=!1,scrollExpandMode:e=!1,className:t}){const[r,s]=L.useState(!n&&!e),i=L.useRef(null),a=L.useRef(null),l=()=>{n&&(a.current&&(clearTimeout(a.current),a.current=null),s(!0))},u=()=>{n&&(a.current=setTimeout(()=>{s(!1)},100))};return L.useEffect(()=>{if(!e)return;const d=i.current;if(!d)return;const f=new IntersectionObserver(m=>{m.forEach(g=>{g.isIntersecting&&!r&&setTimeout(()=>{s(!0)},400)})},{threshold:.5});return f.observe(d),()=>{f.disconnect()}},[e,r]),h.jsxs("span",{ref:i,className:J("relative inline-flex items-center justify-center rounded-[999px] transition-all ease-in-out w-fit bg-[#ecfdf5]",n&&"align-middle -translate-y-[2px] [cursor:inherit] before:content-[''] before:absolute before:-inset-[2px] before:rounded-[999px] before:pointer-events-none",n&&(r?"gap-2 pl-1 pr-2.5 md:ml-2 duration-300":"md:gap-0 pl-1 md:pr-0 md:ml-2 duration-300"),e&&(r?"gap-1.5 pl-1.5 pr-2.5 py-0.5 duration-[800ms]":"gap-0 p-1 duration-[800ms]"),t),onMouseEnter:l,onMouseLeave:u,children:[h.jsxs("span",{className:"relative shrink-0 size-[16px] overflow-visible",children:[h.jsx("span",{className:r?"green-pulse-ring-off":"green-pulse-ring"}),h.jsx("svg",{className:"block size-full relative z-10",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 16 16",children:h.jsxs("g",{id:"Background",children:[h.jsx("rect",{fill:"var(--fill-0, #A7F3D0)",height:"16",rx:"8",width:"16"}),h.jsx("circle",{cx:"8",cy:"8",fill:"var(--fill-0, #10B981)",id:"Ellipse 1",r:"4"})]})})]}),h.jsxs("span",{className:J("font-['Figtree:Medium',sans-serif] font-normal text-emerald-500 text-base tracking-[0.005em] text-nowrap overflow-hidden transition-all ease-out",n&&"duration-300",e&&"duration-[800ms]",r?"max-w-[500px] opacity-100":"max-w-0 opacity-0"),children:[h.jsx("span",{children:"Working on something cool? Get in"})," ",h.jsx("a",{href:"mailto:michelletheresaliu@gmail.com",className:"[text-decoration-skip-ink:none] [text-underline-position:from-font] font-semibold text-emerald-500 hover:!text-emerald-600 transition-colors",children:"touch"}),"!"]})]})}const GU="/assets/Website%20Profile%20Pic-DPLDBdct.png",HU="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.69316%2014.9007C7.7133%2014.9124%207.72913%2014.9214%207.74034%2014.9277L7.75895%2014.9381C7.90753%2015.0196%208.09184%2015.019%208.24056%2014.9383L8.25966%2014.9277C8.27087%2014.9214%208.2867%2014.9124%208.30684%2014.9007C8.34711%2014.8774%208.40465%2014.8433%208.477%2014.7988C8.62164%2014.7097%208.82583%2014.5784%209.06974%2014.4061C9.55673%2014.0621%2010.2065%2013.5516%2010.8577%2012.8849C12.1538%2011.5579%2013.5%209.56411%2013.5%207C13.5%203.96243%2011.0376%201.5%208%201.5C4.96243%201.5%202.5%203.96243%202.5%207C2.5%209.56411%203.84622%2011.5579%205.1423%2012.8849C5.7935%2013.5516%206.44327%2014.0621%206.93026%2014.4061C7.17417%2014.5784%207.37836%2014.7097%207.523%2014.7988C7.59535%2014.8433%207.65289%2014.8774%207.69316%2014.9007ZM8%209C9.10457%209%2010%208.10457%2010%207C10%205.89543%209.10457%205%208%205C6.89543%205%206%205.89543%206%207C6%208.10457%206.89543%209%208%209Z'%20fill='%239CA3AF'/%3e%3c/svg%3e",KU="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.79888%201.87019C7.92652%201.81443%208.07162%201.81443%208.19926%201.87019C10.6785%202.95341%2013.0281%204.27758%2015.2187%205.81304C15.3772%205.92416%2015.4574%206.1168%2015.4244%206.30757C15.3915%206.49833%2015.2514%206.65294%2015.0648%206.70445C14.6081%206.83049%2014.1555%206.96623%2013.7069%207.1109C11.8862%207.69809%2010.1335%208.43692%208.46379%209.31252L8.46161%209.31366C8.3859%209.35337%208.31037%209.39336%208.23501%209.43362C8.08777%209.51229%207.91098%209.51229%207.76375%209.43362C7.68766%209.39297%207.6114%209.3526%207.53497%209.31252C6.70932%208.87956%205.86341%208.48004%204.99902%208.11576V7.96663C4.99902%207.87907%205.04397%207.80136%205.11351%207.75923C6.11692%207.15133%207.15194%206.59043%208.21551%206.07957C8.46443%205.96001%208.56929%205.6613%208.44973%205.41238C8.33017%205.16347%208.03145%205.0586%207.78254%205.17816C6.6897%205.70308%205.62626%206.27939%204.59535%206.90395C4.2931%207.08706%204.08991%207.38676%204.02307%207.72252C3.45312%207.50328%202.87568%207.29907%202.29122%207.11058C1.84267%206.96593%201.38998%206.83047%200.933386%206.70444C0.746773%206.65293%200.606664%206.49833%200.573717%206.30756C0.54077%206.11679%200.620906%205.92415%200.779432%205.81303C2.96999%204.27757%205.31967%202.95341%207.79888%201.87019Z'%20fill='%239CA3AF'/%3e%3cpath%20d='M8.70627%2010.3156C10.3322%209.44687%2012.0404%208.71245%2013.8162%208.12706C13.9057%209.07027%2013.9629%2010.0228%2013.9865%2010.9837C13.9916%2011.1898%2013.8696%2011.3779%2013.6793%2011.4574C11.7786%2012.251%209.9706%2013.2227%208.27632%2014.3518C8.1084%2014.4637%207.88968%2014.4637%207.72176%2014.3518C6.02747%2013.2227%204.21951%2012.251%202.31875%2011.4574C2.12846%2011.3779%202.00646%2011.1898%202.01154%2010.9837C2.03522%2010.0228%202.09236%209.07013%202.18187%208.12685C2.79587%208.32923%203.40179%208.54944%203.99902%208.78685V9.63378C3.70012%209.80669%203.49902%2010.1299%203.49902%2010.5C3.49902%2010.8302%203.65908%2011.123%203.90584%2011.3051C3.84616%2011.5589%203.75784%2011.8072%203.64087%2012.045C3.94267%2012.1874%204.24188%2012.3344%204.53842%2012.486C4.70731%2012.1425%204.82977%2011.7819%204.90579%2011.4138C5.25535%2011.258%205.49902%2010.9074%205.49902%2010.5C5.49902%2010.1299%205.29792%209.80669%204.99902%209.63378V9.20394C5.77996%209.54515%206.54492%209.91618%207.29248%2010.3156C7.7342%2010.5516%208.26455%2010.5516%208.70627%2010.3156Z'%20fill='%239CA3AF'/%3e%3cpath%20d='M2.97384%2012.9749C3.25326%2012.6954%203.4757%2012.3807%203.64087%2012.045C3.94267%2012.1874%204.24188%2012.3344%204.53842%2012.486C4.32605%2012.9179%204.04012%2013.3228%203.68095%2013.682C3.48568%2013.8772%203.1691%2013.8772%202.97384%2013.682C2.77858%2013.4867%202.77858%2013.1701%202.97384%2012.9749Z'%20fill='%239CA3AF'/%3e%3c/svg%3e",zU="data:image/svg+xml,%3csvg%20width='32'%20height='29'%20viewBox='0%200%2032%2029'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M15.5156%2028.6875C15.3594%2028.6875%2015.1719%2028.6406%2014.9531%2028.5469C14.7448%2028.4635%2014.5573%2028.3698%2014.3906%2028.2656C11.4531%2026.3906%208.90625%2024.4271%206.75%2022.375C4.59375%2020.3125%202.92708%2018.1979%201.75%2016.0312C0.583333%2013.8542%200%2011.6562%200%209.4375C0%208.05208%200.21875%206.78646%200.65625%205.64062C1.10417%204.48438%201.72396%203.48438%202.51562%202.64062C3.30729%201.79688%204.22917%201.14583%205.28125%200.6875C6.33333%200.229167%207.47396%200%208.70312%200C10.2344%200%2011.5781%200.390625%2012.7344%201.17188C13.8906%201.95312%2014.8177%202.98438%2015.5156%204.26562C16.224%202.97396%2017.1562%201.94271%2018.3125%201.17188C19.4688%200.390625%2020.8073%200%2022.3281%200C23.5573%200%2024.6979%200.229167%2025.75%200.6875C26.8125%201.14583%2027.7344%201.79688%2028.5156%202.64062C29.3073%203.48438%2029.9219%204.48438%2030.3594%205.64062C30.8073%206.78646%2031.0312%208.05208%2031.0312%209.4375C31.0312%2011.6562%2030.4427%2013.8542%2029.2656%2016.0312C28.099%2018.1979%2026.4375%2020.3125%2024.2812%2022.375C22.1354%2024.4271%2019.5938%2026.3906%2016.6562%2028.2656C16.4896%2028.3698%2016.2969%2028.4635%2016.0781%2028.5469C15.8698%2028.6406%2015.6823%2028.6875%2015.5156%2028.6875Z'%20fill='black'/%3e%3c/svg%3e",WU=`
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-up {
  animation: fadeUp 400ms ease-out forwards;
}
`;function qU({imageSrc:n,caption:e}){return h.jsxs("div",{className:"flex flex-col gap-3 w-72 md:w-76",children:[h.jsx("div",{className:"rounded-lg overflow-hidden",children:n?h.jsx("img",{src:n,alt:"Michelle Liu",className:"w-full h-auto rounded-lg"}):h.jsx("div",{className:"w-full aspect-[3/4] bg-gradient-to-br from-gray-200 to-gray-300 rounded-lg"})}),e&&h.jsx("div",{className:"px-6",children:h.jsx("p",{className:"text-sm text-gray-400 text-center",children:e})})]})}function YU(n){return n.map(e=>({id:e._id,logoSrc:e.logo?ze(e.logo).width(200).url():void 0,company:e.company,role:e.role,period:e.period}))}function QU(n){return n.map(e=>({id:e._id,logoSrc:e.logo?ze(e.logo).width(200).url():void 0,title:e.title,sidebarName:e.sidebarName,description:e.description,instagramUrl:e.instagramUrl,photos:e.photos?.map(t=>({id:t._key,imageSrc:t.image?ze(t.image).width(1200).quality(90).url():"",caption:t.caption,rotation:t.rotation,orientation:t.orientation,yOffset:t.yOffset,xOffset:t.xOffset}))}))}function XU(n){return n.map(e=>({id:e._id,imageSrc:e.cover?ze(e.cover).width(300).url():e.externalCoverUrl||void 0,title:e.title,type:e.mediaType==="book"?"Book":e.mediaType==="music"?"Music":e.mediaType==="movie"?"Movie":"Book",year:e.year,isFeatured:e.isFeatured,goodreadsUrl:e.goodreadsUrl,letterboxdSlug:e.letterboxdSlug,spotifyUrl:e.spotifyUrl}))}function ZU(n){return n.map(e=>({id:e._id,imageSrc:e.image?ze(e.image).width(600).url():void 0,imageBackground:e.imageBackground,headline:e.headline,date:e.date,description:e.description,link:e.link}))}function JU(n){return n.map(e=>({id:e._id,type:"Quote",emoji:e.emoji,quoteTitle:e.title,quoteText:e.text,quoteUnderlinedText:e.underlinedText,quoteAuthor:e.author}))}function e$(){Dr();const[n,e]=L.useState(()=>sessionStorage.getItem("heroAnimationPlayed")==="true");L.useEffect(()=>{if(!n){const oe=setTimeout(()=>{sessionStorage.setItem("heroAnimationPlayed","true"),e(!0)},500);return()=>clearTimeout(oe)}},[n]);const[t,r]=L.useState("hi"),s=L.useRef(null),i=L.useRef(null),a=L.useRef(null),l=L.useRef(null),u=L.useRef(null),d=L.useRef(null),f=L.useRef({}),m=L.useRef(null),g=L.useRef(null),x=L.useRef(null),[y,w]=L.useState(),[b,E]=L.useState("books"),[T,_]=L.useState([]),[A,I]=L.useState([]),[N,P]=L.useState([]),[O,M]=L.useState([]),[D,B]=L.useState([]),[q,ie]=L.useState(!0),[te,re]=L.useState(),[ee,Q]=L.useState(),[G,Y]=L.useState();L.useEffect(()=>{async function oe(){try{ie(!0);const Re=Ye("about:experiences"),We=Ye("about:communities"),ge=Ye("about:shelfItems"),Ie=Ye("about:quotes"),Me=Ye("about:loreItems"),[we,Ue,Je,Yt,Et]=await Promise.all([Re??it.fetch(zT),We??it.fetch(WT),ge??it.fetch(qT),Ie??it.fetch(QT),Me??it.fetch(YT)]);_(YU(we||[])),I(QU(Ue||[])),P(XU(Je||[])),M(JU(Yt||[])),B(ZU(Et||[]))}catch(Re){console.error("Error fetching about data:",Re)}finally{ie(!1)}}oe()},[]),L.useEffect(()=>{if(A.length>0&&!y){const oe=A.find(Re=>Re.sidebarName);oe&&w(oe.id)}},[A,y]);const Z=oe=>{r(oe);const We={hi:s,experience:i,community:a,philosophy:l,shelf:u,lore:d}[oe];We?.current&&We.current.scrollIntoView({behavior:"smooth",block:"start"})},j=oe=>{w(oe);const Re=f.current[oe];Re?Re.scrollIntoView({behavior:"smooth",block:"start"}):a?.current&&a.current.scrollIntoView({behavior:"smooth",block:"start"})},$=oe=>{E(oe);const We={books:m,music:g,movies:x}[oe];We?.current&&We.current.scrollIntoView({behavior:"smooth",block:"start"})};L.useEffect(()=>{const oe=()=>{const Re=[{id:"hi",ref:s},{id:"experience",ref:i},{id:"community",ref:a},{id:"philosophy",ref:l},{id:"shelf",ref:u},{id:"lore",ref:d}],We=250;let ge=null;for(let Ie=Re.length-1;Ie>=0;Ie--){const Me=Re[Ie];if(Me.ref.current&&Me.ref.current.getBoundingClientRect().top<=We){ge=Me.id;break}}if(!ge){for(const Ie of Re)if(Ie.ref.current){const Me=Ie.ref.current.getBoundingClientRect();if(Me.top<window.innerHeight&&Me.bottom>0){ge=Ie.id;break}}}if(ge){if(r(ge),ge==="community"){const Ie=A.filter(we=>we.sidebarName);let Me=null;for(let we=Ie.length-1;we>=0;we--){const Ue=Ie[we],Je=f.current[Ue.id];if(Je&&Je.getBoundingClientRect().top<=We){Me=Ue.id;break}}if(!Me)for(const we of Ie){const Ue=f.current[we.id];if(Ue){const Je=Ue.getBoundingClientRect();if(Je.top<window.innerHeight&&Je.bottom>0){Me=we.id;break}}}Me&&w(Me)}if(ge==="shelf"){const Ie=[{id:"books",ref:m},{id:"music",ref:g},{id:"movies",ref:x}];let Me=null;for(let we=Ie.length-1;we>=0;we--){const Ue=Ie[we];if(Ue.ref.current&&Ue.ref.current.getBoundingClientRect().top<=We){Me=Ue.id;break}}if(!Me){for(const we of Ie)if(we.ref.current){const Ue=we.ref.current.getBoundingClientRect();if(Ue.top<window.innerHeight&&Ue.bottom>0){Me=we.id;break}}}Me&&E(Me)}}};return window.addEventListener("scroll",oe),oe(),()=>window.removeEventListener("scroll",oe)},[A]);const fe=N.filter(oe=>oe.type==="Book"),ne=N.filter(oe=>oe.type==="Music"),ae=N.filter(oe=>oe.type==="Movie"),ce=oe=>{const Re={};return oe.forEach(We=>{We.year&&(Re[We.year]=(Re[We.year]||0)+1)}),Object.entries(Re).filter(([We])=>Number(We)>=2020).sort(([We],[ge])=>Number(ge)-Number(We)).map(([We,ge])=>({year:We,count:ge}))},_e=ce(fe),Ee=ce(ne),Le=ce(ae);return h.jsxs("div",{className:"bg-white flex flex-col items-center relative size-full min-h-screen",children:[h.jsx("style",{children:WU}),h.jsx(J0,{variant:"about",heroAnimationPlayed:n,children:h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"hidden md:block",children:[h.jsx("p",{children:"Product, design, <dev>, & everything in between."}),h.jsx("p",{children:"Graduating from UCLA in June 2026. "})]}),h.jsxs("div",{className:"md:hidden",children:[h.jsx("p",{className:"mb-0",children:"Product, design, <dev>,"}),h.jsx("p",{children:" & everything in between."}),h.jsx("p",{children:"Graduating from UCLA in June 2026. "})]})]})}),h.jsx(eg,{activeTab:"about",heroAnimationPlayed:n}),h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start px-16 max-md:px-8 pt-2 relative shrink-0 w-full",children:[h.jsx("div",{className:"hidden lg:block lg:sticky lg:top-8 pb-4 lg:pb-8 w-[202px] shrink-0",children:h.jsx(VU,{activeCategory:t,onCategoryClick:Z,communityItems:A.filter(oe=>oe.sidebarName).map(oe=>({id:oe.id,sidebarName:oe.sidebarName})),activeCommunityId:y,onCommunityClick:j,activeShelfSubcategory:b,onShelfSubcategoryClick:$,shelfCounts:{books:fe.length,music:ne.length,movies:ae.length}})}),h.jsxs("div",{className:"flex-1 flex flex-col gap-20 items-start pb-8 min-w-0 w-full",children:[h.jsxs("section",{ref:s,className:"flex flex-col md:flex-row gap-10 md:gap-16 items-center w-full max-w-5xl scroll-mt-8",children:[h.jsx(Be,{delay:100,children:h.jsx("div",{className:"shrink-0",children:h.jsx(qU,{imageSrc:GU,caption:h.jsxs(h.Fragment,{children:["A visit to the studio of one of my absolute favorite artists,"," ",h.jsx("a",{href:"https://artsandculture.google.com/story/artist-spotlight-hung-liu-national-museum-of-women-in-the-arts/3wVRJQ12cc4OEA?hl=en",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-700 transition-colors",children:"Hung Liu"})]})})})}),h.jsxs("div",{className:"flex flex-col pt-8 gap-6 flex-1",children:[h.jsx(Be,{variant:"fade",delay:150,children:h.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-3xl md:text-3xl",children:"Hi, I'm Michelle!"})}),h.jsx(Be,{variant:"fade",delay:200,children:h.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-6 text-base tracking-[0.005em] text-gray-400",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("img",{src:HU,alt:"",className:"w-4 h-4"}),h.jsx("span",{className:"text-gray-400",children:"SF  LA  NYC"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("img",{src:KU,alt:"",className:"w-4 h-4"}),h.jsx("span",{className:"text-gray-400",children:"B.A. Art, B.S. Cognitive Science  UCLA '26"})]})]})}),h.jsx(Be,{variant:"fade",delay:250,children:h.jsxs("div",{className:"flex flex-col gap-4 text-gray-600 text-base tracking-[0.005em] leading-relaxed",children:[h.jsx("p",{children:"I love art, business, technology, & the ways that they can work together to create extraordinary products for people."}),h.jsxs("p",{children:["I believe thoughtful design makes life more intuitive (& beautiful). I want to bring more of it into the worldwhether through my creations or the communities I'm helping to build. I like to think of it as my ",h.jsx("a",{href:"https://en.wikipedia.org/wiki/Ikigai",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 font-semibold no-underline hover:text-blue-600 transition-colors",children:"ikigai"}),": the constant pursuit of an intersection between passion, profession, & personal mission."]}),h.jsx("p",{children:"I also love discovering new hidden food spots, getting excited about beautifully designed stationery, & listening to audiobooks on long drives."}),h.jsxs("p",{children:["3 words to describe me: ",h.jsx("em",{children:"Golden Retriever Energy."})," (even on the bad days)"]})]})}),h.jsx(Be,{variant:"fade",delay:300,children:h.jsx(Mk,{scrollExpandMode:!0,className:"mt-2"})})]})]}),h.jsxs("section",{ref:i,className:"flex flex-col gap-16 md:flex-row md:justify-between md:gap-0 w-full scroll-mt-8",children:[h.jsx(Be,{variant:"fade",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-700 text-3xl leading-normal shrink-0",children:"Experience"}),h.jsxs("a",{href:"https://drive.google.com/file/d/1JPVZsAg6QSwS9He0bc2cMdVohcBQYD0W/view?usp=sharing",target:"_blank",rel:"noopener noreferrer",className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg hover:text-blue-500 transition-colors",children:["Resume ",h.jsx(Gs,{})]})]})}),q?h.jsxs("div",{className:"flex items-center gap-3 py-4",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),h.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):T.length>0?h.jsx("div",{className:"flex flex-col gap-8 md:gap-8 w-full md:w-[560px]",children:T.map((oe,Re)=>h.jsx(Be,{delay:Re*80,children:h.jsx(UU,{data:oe})},oe.id))}):h.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add experience items in Sanity Studio."})]}),h.jsxs("section",{ref:a,className:"flex flex-col gap-8 w-full scroll-mt-8",children:[h.jsx(Be,{variant:"fade",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-3xl leading-normal shrink-0",children:"My Communities"}),h.jsxs("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg flex items-center gap-1.5",children:["The people who make it all worth it",h.jsx("img",{src:zU,alt:"",className:"w-[12px] h-[12px]",style:{filter:"brightness(0) saturate(100%) invert(83%) sepia(8%) saturate(293%) hue-rotate(177deg) brightness(91%) contrast(87%)"}})]})]})}),q?h.jsxs("div",{className:"flex items-center gap-3 py-4",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),h.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):A.length>0?h.jsx("div",{className:"flex flex-col gap-12 pt-4",children:A.map((oe,Re)=>h.jsx("div",{ref:We=>{f.current[oe.id]=We},className:"scroll-mt-8",children:h.jsxs(Be,{delay:Re*100,children:[h.jsx(BU,{data:oe}),Re<A.length-1&&h.jsx("div",{className:"mt-12 h-px w-full bg-gray-200"})]})},oe.id))}):h.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add community items in Sanity Studio."})]}),h.jsxs("section",{ref:l,className:"flex flex-col gap-12 w-full scroll-mt-8",children:[h.jsx(Be,{variant:"fade",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-3xl leading-normal shrink-0",children:"My Favorite Quotes"}),h.jsx("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg",children:"a.k.a. my Design ( + Life ) Philosophy"})]})}),O.length>0?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:grid-rows-[1fr_1fr]",children:O.map((oe,Re)=>h.jsx(Be,{delay:Re*80,className:"h-full",children:h.jsx(Ap,{data:oe,className:"h-full",topRow:Re<2})},oe.id))}):h.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add quotes in Sanity Studio."})]}),h.jsxs("section",{ref:u,className:"flex flex-col gap-6 w-full scroll-mt-8",children:[h.jsx(Be,{variant:"fade",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-3xl leading-normal shrink-0",children:"Shelf"}),h.jsx("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg",children:" - Favorites"})]})}),q?h.jsxs("div",{className:"flex items-center gap-3 py-4",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),h.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):h.jsxs("div",{className:"flex flex-col gap-8",children:[h.jsx("div",{ref:m,className:"scroll-mt-8",children:h.jsx(Be,{delay:100,children:h.jsx(_m,{title:" Books",count:fe.filter(oe=>oe.isFeatured).length,mediaType:"book",yearFilters:_e,activeYear:te,onYearChange:oe=>re(oe||void 0),externalLink:{label:"Goodreads",href:"https://www.goodreads.com/user/show/126741914-michelletliu"},items:fe,itemCount:5,onItemClick:oe=>console.log("Book clicked:",oe)})})}),h.jsx("div",{ref:g,className:"scroll-mt-8",children:h.jsx(Be,{delay:200,children:h.jsx(_m,{title:" Music",count:ne.filter(oe=>oe.isFeatured).length,mediaType:"music",yearFilters:Ee,activeYear:ee,onYearChange:oe=>Q(oe||void 0),externalLink:{label:"Spotify",href:"https://open.spotify.com/user/i4stx92bb6e14vmhqe5tl8az6?si=3b9ee8fc1b3a4784"},items:ne,itemCount:5,onItemClick:oe=>console.log("Music clicked:",oe)})})}),h.jsx("div",{ref:x,className:"scroll-mt-8",children:h.jsx(Be,{delay:300,children:h.jsx(_m,{title:" Movies",count:ae.filter(oe=>oe.isFeatured).length,mediaType:"movie",yearFilters:Le,activeYear:G,onYearChange:oe=>Y(oe||void 0),externalLink:{label:"Letterboxd",href:"https://letterboxd.com/LiuMichelle/"},items:ae,itemCount:5,onItemClick:oe=>{oe.letterboxdSlug&&window.open(`https://letterboxd.com/liumichelle/film/${oe.letterboxdSlug}/`,"_blank")}})})})]})]}),h.jsxs("section",{ref:d,className:"flex flex-col gap-12 w-full scroll-mt-8",children:[h.jsx(Be,{variant:"fade",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"font-['Figtree',sans-serif] font-medium text-gray-600 text-3xl leading-normal shrink-0",children:"Lore "}),h.jsx("p",{className:"font-['Figtree',sans-serif] tracking-wide font-normal text-gray-400 text-lg",children:"Fun snippets from past lives"})]})}),q?h.jsxs("div",{className:"flex items-center gap-3 py-4",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-gray-200 border-t-gray-400 rounded-full animate-spin"}),h.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})]}):D.length>0?h.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-6 md:gap-6",children:D.map((oe,Re)=>h.jsx(Be,{delay:Re*80,children:h.jsx(FU,{data:oe,onClick:()=>console.log("Lore clicked:",oe)})},oe.id))}):h.jsx("p",{className:"text-gray-400 text-sm py-4",children:"Add lore items in Sanity Studio."})]})]})]}),h.jsx(hd,{})]})}function t$(n,e){return n[13]=1,n[14]=e>>8,n[15]=e&255,n[16]=e>>8,n[17]=e&255,n}const Fk=112,Bk=72,Uk=89,$k=115;let km;function n$(){const n=new Int32Array(256);for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;n[e]=t}return n}function r$(n){let e=-1;km||(km=n$());for(let t=0;t<n.length;t++)e=km[(e^n[t])&255]^e>>>8;return e^-1}function s$(n){const e=n.length-1;for(let t=e;t>=4;t--)if(n[t-4]===9&&n[t-3]===Fk&&n[t-2]===Bk&&n[t-1]===Uk&&n[t]===$k)return t-3;return 0}function i$(n,e,t=!1){const r=new Uint8Array(13);e*=39.3701,r[0]=Fk,r[1]=Bk,r[2]=Uk,r[3]=$k,r[4]=e>>>24,r[5]=e>>>16,r[6]=e>>>8,r[7]=e&255,r[8]=r[4],r[9]=r[5],r[10]=r[6],r[11]=r[7],r[12]=1;const s=r$(r),i=new Uint8Array(4);if(i[0]=s>>>24,i[1]=s>>>16,i[2]=s>>>8,i[3]=s&255,t){const a=s$(n);return n.set(r,a),n.set(i,a+13),n}else{const a=new Uint8Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=9;const l=new Uint8Array(54);return l.set(n,0),l.set(a,33),l.set(r,37),l.set(i,50),l}}const a$="AAlwSFlz",o$="AAAJcEhZ",l$="AAAACXBI";function c$(n){let e=n.indexOf(a$);return e===-1&&(e=n.indexOf(o$)),e===-1&&(e=n.indexOf(l$)),e}const Vk="[modern-screenshot]",Ws=typeof window<"u",u$=Ws&&"Worker"in window,d$=Ws&&"atob"in window,f$=Ws&&"btoa"in window,tg=Ws?window.navigator?.userAgent:"",Gk=tg.includes("Chrome"),id=tg.includes("AppleWebKit")&&!Gk,ng=tg.includes("Firefox"),h$=n=>n&&"__CONTEXT__"in n,m$=n=>n.constructor.name==="CSSFontFaceRule",p$=n=>n.constructor.name==="CSSImportRule",Rr=n=>n.nodeType===1,Rl=n=>typeof n.className=="object",Hk=n=>n.tagName==="image",g$=n=>n.tagName==="use",pl=n=>Rr(n)&&typeof n.style<"u"&&!Rl(n),x$=n=>n.nodeType===8,y$=n=>n.nodeType===3,Ma=n=>n.tagName==="IMG",Td=n=>n.tagName==="VIDEO",v$=n=>n.tagName==="CANVAS",w$=n=>n.tagName==="TEXTAREA",b$=n=>n.tagName==="INPUT",S$=n=>n.tagName==="STYLE",E$=n=>n.tagName==="SCRIPT",T$=n=>n.tagName==="SELECT",_$=n=>n.tagName==="SLOT",k$=n=>n.tagName==="IFRAME",C$=(...n)=>console.warn(Vk,...n);function A$(n){const e=n?.createElement?.("canvas");return e&&(e.height=e.width=1),!!e&&"toDataURL"in e&&!!e.toDataURL("image/webp").includes("image/webp")}const Ip=n=>n.startsWith("data:");function Kk(n,e){if(n.match(/^[a-z]+:\/\//i))return n;if(Ws&&n.match(/^\/\//))return window.location.protocol+n;if(n.match(/^[a-z]+:/i)||!Ws)return n;const t=_d().implementation.createHTMLDocument(),r=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(r),t.body.appendChild(s),e&&(r.href=e),s.href=n,s.href}function _d(n){return(n&&Rr(n)?n?.ownerDocument:n)??window.document}const kd="http://www.w3.org/2000/svg";function I$(n,e,t){const r=_d(t).createElementNS(kd,"svg");return r.setAttributeNS(null,"width",n.toString()),r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"viewBox",`0 0 ${n} ${e}`),r}function L$(n,e){let t=new XMLSerializer().serializeToString(n);return e&&(t=t.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}function R$(n,e){return new Promise((t,r)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=()=>r(s.error),s.onabort=()=>r(new Error(`Failed read blob to ${e}`)),s.readAsDataURL(n)})}const P$=n=>R$(n,"dataUrl");function _a(n,e){const t=_d(e).createElement("img");return t.decoding="sync",t.loading="eager",t.src=n,t}function gl(n,e){return new Promise(t=>{const{timeout:r,ownerDocument:s,onError:i,onWarn:a}=e??{},l=typeof n=="string"?_a(n,_d(s)):n;let u=null,d=null;function f(){t(l),u&&clearTimeout(u),d?.()}if(r&&(u=setTimeout(f,r)),Td(l)){const m=l.currentSrc||l.src;if(!m)return l.poster?gl(l.poster,e).then(t):f();if(l.readyState>=2)return f();const g=f,x=y=>{a?.("Failed video load",m,y),i?.(y),f()};d=()=>{l.removeEventListener("loadeddata",g),l.removeEventListener("error",x)},l.addEventListener("loadeddata",g,{once:!0}),l.addEventListener("error",x,{once:!0})}else{const m=Hk(l)?l.href.baseVal:l.currentSrc||l.src;if(!m)return f();const g=async()=>{if(Ma(l)&&"decode"in l)try{await l.decode()}catch(y){a?.("Failed to decode image, trying to render anyway",l.dataset.originalSrc||m,y)}f()},x=y=>{a?.("Failed image load",l.dataset.originalSrc||m,y),f()};if(Ma(l)&&l.complete)return g();d=()=>{l.removeEventListener("load",g),l.removeEventListener("error",x)},l.addEventListener("load",g,{once:!0}),l.addEventListener("error",x,{once:!0})}})}async function D$(n,e){pl(n)&&(Ma(n)||Td(n)?await gl(n,e):await Promise.all(["img","video"].flatMap(t=>Array.from(n.querySelectorAll(t)).map(r=>gl(r,e)))))}const zk=(function(){let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Wk(n){return n?.split(",").map(e=>e.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let Tw=0;function N$(n){const e=`${Vk}[#${Tw}]`;return Tw++,{time:t=>n&&console.time(`${e} ${t}`),timeEnd:t=>n&&console.timeEnd(`${e} ${t}`),warn:(...t)=>n&&C$(...t)}}function j$(n){return{cache:n?"no-cache":"force-cache"}}async function Cd(n,e){return h$(n)?n:O$(n,{...e,autoDestruct:!0})}async function O$(n,e){const{scale:t=1,workerUrl:r,workerNumber:s=1}=e||{},i=!!e?.debug,a=e?.features??!0,l=n.ownerDocument??(Ws?window.document:void 0),u=n.ownerDocument?.defaultView??(Ws?window:void 0),d=new Map,f={width:0,height:0,quality:1,type:"image/png",scale:t,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:i,fetch:{requestInit:j$(e?.fetch?.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...e?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:s,onCloneEachNode:null,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...e,__CONTEXT__:!0,log:N$(i),node:n,ownerDocument:l,ownerWindow:u,dpi:t===1?null:96*t,svgStyleElement:qk(l),svgDefsElement:l?.createElementNS(kd,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:u$&&r&&s?s:0})].map(()=>{try{const x=new Worker(r);return x.onmessage=async y=>{const{url:w,result:b}=y.data;b?d.get(w)?.resolve?.(b):d.get(w)?.reject?.(new Error(`Error receiving message from worker: ${w}`))},x.onmessageerror=y=>{const{url:w}=y.data;d.get(w)?.reject?.(new Error(`Error receiving message from worker: ${w}`))},x}catch(x){return f.log.warn("Failed to new Worker",x),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[A$(l)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:d,drawImageCount:0,tasks:[],features:a,isEnable:x=>x==="restoreScrollPosition"?typeof a=="boolean"?!1:a[x]??!1:typeof a=="boolean"?a:a[x]??!0,shadowRoots:[]};f.log.time("wait until load"),await D$(n,{timeout:f.timeout,onWarn:f.log.warn}),f.log.timeEnd("wait until load");const{width:m,height:g}=M$(n,f);return f.width=m,f.height=g,f}function qk(n){if(!n)return;const e=n.createElement("style"),t=e.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return e.appendChild(t),e}function M$(n,e){let{width:t,height:r}=e;if(Rr(n)&&(!t||!r)){const s=n.getBoundingClientRect();t=t||s.width||Number(n.getAttribute("width"))||0,r=r||s.height||Number(n.getAttribute("height"))||0}return{width:t,height:r}}async function F$(n,e){const{log:t,timeout:r,drawImageCount:s,drawImageInterval:i}=e;t.time("image to canvas");const a=await gl(n,{timeout:r,onWarn:e.log.warn}),{canvas:l,context2d:u}=B$(n.ownerDocument,e),d=()=>{try{u?.drawImage(a,0,0,l.width,l.height)}catch(f){e.log.warn("Failed to drawImage",f)}};if(d(),e.isEnable("fixSvgXmlDecode"))for(let f=0;f<s;f++)await new Promise(m=>{setTimeout(()=>{u?.clearRect(0,0,l.width,l.height),d(),m()},f+i)});return e.drawImageCount=0,t.timeEnd("image to canvas"),l}function B$(n,e){const{width:t,height:r,scale:s,backgroundColor:i,maximumCanvasSize:a}=e,l=n.createElement("canvas");l.width=Math.floor(t*s),l.height=Math.floor(r*s),l.style.width=`${t}px`,l.style.height=`${r}px`,a&&(l.width>a||l.height>a)&&(l.width>a&&l.height>a?l.width>l.height?(l.height*=a/l.width,l.width=a):(l.width*=a/l.height,l.height=a):l.width>a?(l.height*=a/l.width,l.width=a):(l.width*=a/l.height,l.height=a));const u=l.getContext("2d");return u&&i&&(u.fillStyle=i,u.fillRect(0,0,l.width,l.height)),{canvas:l,context2d:u}}function Yk(n,e){if(n.ownerDocument)try{const i=n.toDataURL();if(i!=="data:,")return _a(i,n.ownerDocument)}catch(i){e.log.warn("Failed to clone canvas",i)}const t=n.cloneNode(!1),r=n.getContext("2d"),s=t.getContext("2d");try{return r&&s&&s.putImageData(r.getImageData(0,0,n.width,n.height),0,0),t}catch(i){e.log.warn("Failed to clone canvas",i)}return t}function U$(n,e){try{if(n?.contentDocument?.body)return rg(n.contentDocument.body,e)}catch(t){e.log.warn("Failed to clone iframe",t)}return n.cloneNode(!1)}function $$(n){const e=n.cloneNode(!1);return n.currentSrc&&n.currentSrc!==n.src&&(e.src=n.currentSrc,e.srcset=""),e.loading==="lazy"&&(e.loading="eager"),e}async function V$(n,e){if(n.ownerDocument&&!n.currentSrc&&n.poster)return _a(n.poster,n.ownerDocument);const t=n.cloneNode(!1);t.crossOrigin="anonymous",n.currentSrc&&n.currentSrc!==n.src&&(t.src=n.currentSrc);const r=t.ownerDocument;if(r){let s=!0;if(await gl(t,{onError:()=>s=!1,onWarn:e.log.warn}),!s)return n.poster?_a(n.poster,n.ownerDocument):t;t.currentTime=n.currentTime,await new Promise(a=>{t.addEventListener("seeked",a,{once:!0})});const i=r.createElement("canvas");i.width=n.offsetWidth,i.height=n.offsetHeight;try{const a=i.getContext("2d");a&&a.drawImage(t,0,0,i.width,i.height)}catch(a){return e.log.warn("Failed to clone video",a),n.poster?_a(n.poster,n.ownerDocument):t}return Yk(i,e)}return t}function G$(n,e){return v$(n)?Yk(n,e):k$(n)?U$(n,e):Ma(n)?$$(n):Td(n)?V$(n,e):n.cloneNode(!1)}function H$(n){let e=n.sandbox;if(!e){const{ownerDocument:t}=n;try{t&&(e=t.createElement("iframe"),e.id=`__SANDBOX__${zk()}`,e.width="0",e.height="0",e.style.visibility="hidden",e.style.position="fixed",t.body.appendChild(e),e.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',n.sandbox=e)}catch(r){n.log.warn("Failed to getSandBox",r)}}return e}const K$=["width","height","-webkit-text-fill-color"],z$=["stroke","fill"];function Qk(n,e,t){const{defaultComputedStyles:r}=t,s=n.nodeName.toLowerCase(),i=Rl(n)&&s!=="svg",a=i?z$.map(w=>[w,n.getAttribute(w)]).filter(([,w])=>w!==null):[],l=[i&&"svg",s,a.map((w,b)=>`${w}=${b}`).join(","),e].filter(Boolean).join(":");if(r.has(l))return r.get(l);const d=H$(t)?.contentWindow;if(!d)return new Map;const f=d?.document;let m,g;i?(m=f.createElementNS(kd,"svg"),g=m.ownerDocument.createElementNS(m.namespaceURI,s),a.forEach(([w,b])=>{g.setAttributeNS(null,w,b)}),m.appendChild(g)):m=g=f.createElement(s),g.textContent=" ",f.body.appendChild(m);const x=d.getComputedStyle(g,e),y=new Map;for(let w=x.length,b=0;b<w;b++){const E=x.item(b);K$.includes(E)||y.set(E,x.getPropertyValue(E))}return f.body.removeChild(m),r.set(l,y),y}function Xk(n,e,t){const r=new Map,s=[],i=new Map;if(t)for(const l of t)a(l);else for(let l=n.length,u=0;u<l;u++){const d=n.item(u);a(d)}for(let l=s.length,u=0;u<l;u++)i.get(s[u])?.forEach((d,f)=>r.set(f,d));function a(l){const u=n.getPropertyValue(l),d=n.getPropertyPriority(l),f=l.lastIndexOf("-"),m=f>-1?l.substring(0,f):void 0;if(m){let g=i.get(m);g||(g=new Map,i.set(m,g)),g.set(l,[u,d])}e.get(l)===u&&!d||(m?s.push(m):r.set(l,[u,d]))}return r}function W$(n,e,t,r){const{ownerWindow:s,includeStyleProperties:i,currentParentNodeStyle:a}=r,l=e.style,u=s.getComputedStyle(n),d=Qk(n,null,r);a?.forEach((m,g)=>{d.delete(g)});const f=Xk(u,d,i);f.delete("transition-property"),f.delete("all"),f.delete("d"),f.delete("content"),t&&(f.delete("margin-top"),f.delete("margin-right"),f.delete("margin-bottom"),f.delete("margin-left"),f.delete("margin-block-start"),f.delete("margin-block-end"),f.delete("margin-inline-start"),f.delete("margin-inline-end"),f.set("box-sizing",["border-box",""])),f.get("background-clip")?.[0]==="text"&&e.classList.add("______background-clip--text"),Gk&&(f.has("font-kerning")||f.set("font-kerning",["normal",""]),(f.get("overflow-x")?.[0]==="hidden"||f.get("overflow-y")?.[0]==="hidden")&&f.get("text-overflow")?.[0]==="ellipsis"&&n.scrollWidth===n.clientWidth&&f.set("text-overflow",["clip",""]));for(let m=l.length,g=0;g<m;g++)l.removeProperty(l.item(g));return f.forEach(([m,g],x)=>{l.setProperty(x,m,g)}),f}function q$(n,e){(w$(n)||b$(n)||T$(n))&&e.setAttribute("value",n.value)}const Y$=["::before","::after"],Q$=["::-webkit-scrollbar","::-webkit-scrollbar-button","::-webkit-scrollbar-thumb","::-webkit-scrollbar-track","::-webkit-scrollbar-track-piece","::-webkit-scrollbar-corner","::-webkit-resizer"];function X$(n,e,t,r,s){const{ownerWindow:i,svgStyleElement:a,svgStyles:l,currentNodeStyle:u}=r;if(!a||!i)return;function d(f){const m=i.getComputedStyle(n,f);let g=m.getPropertyValue("content");if(!g||g==="none")return;s?.(g),g=g.replace(/(')|(")|(counter\(.+\))/g,"");const x=[zk()],y=Qk(n,f,r);u?.forEach((_,A)=>{y.delete(A)});const w=Xk(m,y,r.includeStyleProperties);w.delete("content"),w.delete("-webkit-locale"),w.get("background-clip")?.[0]==="text"&&e.classList.add("______background-clip--text");const b=[`content: '${g}';`];if(w.forEach(([_,A],I)=>{b.push(`${I}: ${_}${A?" !important":""};`)}),b.length===1)return;try{e.className=[e.className,...x].join(" ")}catch(_){r.log.warn("Failed to copyPseudoClass",_);return}const E=b.join(`
  `);let T=l.get(E);T||(T=[],l.set(E,T)),T.push(`.${x[0]}${f}`)}Y$.forEach(d),t&&Q$.forEach(d)}const _w=new Set(["symbol"]);async function kw(n,e,t,r,s){if(Rr(t)&&(S$(t)||E$(t))||r.filter&&!r.filter(t))return;_w.has(e.nodeName)||_w.has(t.nodeName)?r.currentParentNodeStyle=void 0:r.currentParentNodeStyle=r.currentNodeStyle;const i=await rg(t,r,!1,s);r.isEnable("restoreScrollPosition")&&Z$(n,i),e.appendChild(i)}async function Cw(n,e,t,r){let s=n.firstChild;Rr(n)&&n.shadowRoot&&(s=n.shadowRoot?.firstChild,t.shadowRoots.push(n.shadowRoot));for(let i=s;i;i=i.nextSibling)if(!x$(i))if(Rr(i)&&_$(i)&&typeof i.assignedNodes=="function"){const a=i.assignedNodes();for(let l=0;l<a.length;l++)await kw(n,e,a[l],t,r)}else await kw(n,e,i,t,r)}function Z$(n,e){if(!pl(n)||!pl(e))return;const{scrollTop:t,scrollLeft:r}=n;if(!t&&!r)return;const{transform:s}=e.style,i=new DOMMatrix(s),{a,b:l,c:u,d}=i;i.a=1,i.b=0,i.c=0,i.d=1,i.translateSelf(-r,-t),i.a=a,i.b=l,i.c=u,i.d=d,e.style.transform=i.toString()}function J$(n,e){const{backgroundColor:t,width:r,height:s,style:i}=e,a=n.style;if(t&&a.setProperty("background-color",t,"important"),r&&a.setProperty("width",`${r}px`,"important"),s&&a.setProperty("height",`${s}px`,"important"),i)for(const l in i)a[l]=i[l]}const eV=/^[\w-:]+$/;async function rg(n,e,t=!1,r){const{ownerDocument:s,ownerWindow:i,fontFamilies:a,onCloneEachNode:l}=e;if(s&&y$(n))return r&&/\S/.test(n.data)&&r(n.data),s.createTextNode(n.data);if(s&&i&&Rr(n)&&(pl(n)||Rl(n))){const d=await G$(n,e);if(e.isEnable("removeAbnormalAttributes")){const w=d.getAttributeNames();for(let b=w.length,E=0;E<b;E++){const T=w[E];eV.test(T)||d.removeAttribute(T)}}const f=e.currentNodeStyle=W$(n,d,t,e);t&&J$(d,e);let m=!1;if(e.isEnable("copyScrollbar")){const w=[f.get("overflow-x")?.[0],f.get("overflow-y")?.[0]];m=w.includes("scroll")||(w.includes("auto")||w.includes("overlay"))&&(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)}const g=f.get("text-transform")?.[0],x=Wk(f.get("font-family")?.[0]),y=x?w=>{g==="uppercase"?w=w.toUpperCase():g==="lowercase"?w=w.toLowerCase():g==="capitalize"&&(w=w[0].toUpperCase()+w.substring(1)),x.forEach(b=>{let E=a.get(b);E||a.set(b,E=new Set),w.split("").forEach(T=>E.add(T))})}:void 0;return X$(n,d,m,e,y),q$(n,d),Td(n)||await Cw(n,d,e,y),await l?.(d),d}const u=n.cloneNode(!1);return await Cw(n,u,e),await l?.(u),u}function tV(n){if(n.ownerDocument=void 0,n.ownerWindow=void 0,n.svgStyleElement=void 0,n.svgDefsElement=void 0,n.svgStyles.clear(),n.defaultComputedStyles.clear(),n.sandbox){try{n.sandbox.remove()}catch(e){n.log.warn("Failed to destroyContext",e)}n.sandbox=void 0}n.workers=[],n.fontFamilies.clear(),n.fontCssTexts.clear(),n.requests.clear(),n.tasks=[],n.shadowRoots=[]}function nV(n){const{url:e,timeout:t,responseType:r,...s}=n,i=new AbortController,a=t?setTimeout(()=>i.abort(),t):void 0;return fetch(e,{signal:i.signal,...s}).then(l=>{if(!l.ok)throw new Error("Failed fetch, not 2xx response",{cause:l});switch(r){case"arrayBuffer":return l.arrayBuffer();case"dataUrl":return l.blob().then(P$);case"text":default:return l.text()}}).finally(()=>clearTimeout(a))}function xl(n,e){const{url:t,requestType:r="text",responseType:s="text",imageDom:i}=e;let a=t;const{timeout:l,acceptOfImage:u,requests:d,fetchFn:f,fetch:{requestInit:m,bypassingCache:g,placeholderImage:x},font:y,workers:w,fontFamilies:b}=n;r==="image"&&(id||ng)&&n.drawImageCount++;let E=d.get(t);if(!E){g&&g instanceof RegExp&&g.test(a)&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());const T=r.startsWith("font")&&y&&y.minify,_=new Set;T&&r.split(";")[1].split(",").forEach(P=>{b.has(P)&&b.get(P).forEach(O=>_.add(O))});const A=T&&_.size,I={url:a,timeout:l,responseType:A?"arrayBuffer":s,headers:r==="image"?{accept:u}:void 0,...m};E={type:r,resolve:void 0,reject:void 0,response:null},E.response=(async()=>{if(f&&r==="image"){const N=await f(t);if(N)return N}return!id&&t.startsWith("http")&&w.length?new Promise((N,P)=>{w[d.size&w.length-1].postMessage({rawUrl:t,...I}),E.resolve=N,E.reject=P}):nV(I)})().catch(N=>{if(d.delete(t),r==="image"&&x)return n.log.warn("Failed to fetch image base64, trying to use placeholder image",a),typeof x=="string"?x:x(i);throw N}),d.set(t,E)}return E.response}async function Zk(n,e,t,r){if(!Jk(n))return n;for(const[s,i]of rV(n,e))try{const a=await xl(t,{url:i,requestType:r?"image":"text",responseType:"dataUrl"});n=n.replace(sV(s),`$1${a}$3`)}catch(a){t.log.warn("Failed to fetch css data url",s,a)}return n}function Jk(n){return/url\((['"]?)([^'"]+?)\1\)/.test(n)}const eC=/url\((['"]?)([^'"]+?)\1\)/g;function rV(n,e){const t=[];return n.replace(eC,(r,s,i)=>(t.push([i,Kk(i,e)]),r)),t.filter(([r])=>!Ip(r))}function sV(n){const e=n.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}const iV=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function aV(n,e){return iV.map(t=>{const r=n.getPropertyValue(t);return!r||r==="none"?null:((id||ng)&&e.drawImageCount++,Zk(r,null,e,!0).then(s=>{!s||r===s||n.setProperty(t,s,n.getPropertyPriority(t))}))}).filter(Boolean)}function oV(n,e){if(Ma(n)){const t=n.currentSrc||n.src;if(!Ip(t))return[xl(e,{url:t,imageDom:n,requestType:"image",responseType:"dataUrl"}).then(r=>{r&&(n.srcset="",n.dataset.originalSrc=t,n.src=r||"")})];(id||ng)&&e.drawImageCount++}else if(Rl(n)&&!Ip(n.href.baseVal)){const t=n.href.baseVal;return[xl(e,{url:t,imageDom:n,requestType:"image",responseType:"dataUrl"}).then(r=>{r&&(n.dataset.originalSrc=t,n.href.baseVal=r||"")})]}return[]}function lV(n,e){const{ownerDocument:t,svgDefsElement:r}=e,s=n.getAttribute("href")??n.getAttribute("xlink:href");if(!s)return[];const[i,a]=s.split("#");if(a){const l=`#${a}`,u=e.shadowRoots.reduce((d,f)=>d??f.querySelector(`svg ${l}`),t?.querySelector(`svg ${l}`));if(i&&n.setAttribute("href",l),r?.querySelector(l))return[];if(u)return r?.appendChild(u.cloneNode(!0)),[];if(i)return[xl(e,{url:i,responseType:"text"}).then(d=>{r?.insertAdjacentHTML("beforeend",d)})]}return[]}function tC(n,e){const{tasks:t}=e;Rr(n)&&((Ma(n)||Hk(n))&&t.push(...oV(n,e)),g$(n)&&t.push(...lV(n,e))),pl(n)&&t.push(...aV(n.style,e)),n.childNodes.forEach(r=>{tC(r,e)})}async function cV(n,e){const{ownerDocument:t,svgStyleElement:r,fontFamilies:s,fontCssTexts:i,tasks:a,font:l}=e;if(!(!t||!r||!s.size))if(l&&l.cssText){const u=Iw(l.cssText,e);r.appendChild(t.createTextNode(`${u}
`))}else{const u=Array.from(t.styleSheets).filter(f=>{try{return"cssRules"in f&&!!f.cssRules.length}catch(m){return e.log.warn(`Error while reading CSS rules from ${f.href}`,m),!1}});await Promise.all(u.flatMap(f=>Array.from(f.cssRules).map(async(m,g)=>{if(p$(m)){let x=g+1;const y=m.href;let w="";try{w=await xl(e,{url:y,requestType:"text",responseType:"text"})}catch(E){e.log.warn(`Error fetch remote css import from ${y}`,E)}const b=w.replace(eC,(E,T,_)=>E.replace(_,Kk(_,y)));for(const E of dV(b))try{f.insertRule(E,E.startsWith("@import")?x+=1:f.cssRules.length)}catch(T){e.log.warn("Error inserting rule from remote css import",{rule:E,error:T})}}}))),u.flatMap(f=>Array.from(f.cssRules)).filter(f=>m$(f)&&Jk(f.style.getPropertyValue("src"))&&Wk(f.style.getPropertyValue("font-family"))?.some(m=>s.has(m))).forEach(f=>{const m=f,g=i.get(m.cssText);g?r.appendChild(t.createTextNode(`${g}
`)):a.push(Zk(m.cssText,m.parentStyleSheet?m.parentStyleSheet.href:null,e).then(x=>{x=Iw(x,e),i.set(m.cssText,x),r.appendChild(t.createTextNode(`${x}
`))}))})}}const uV=/(\/\*[\s\S]*?\*\/)/g,Aw=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function dV(n){if(n==null)return[];const e=[];let t=n.replace(uV,"");for(;;){const i=Aw.exec(t);if(!i)break;e.push(i[0])}t=t.replace(Aw,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let i=r.exec(t);if(i)s.lastIndex=r.lastIndex;else if(i=s.exec(t),i)r.lastIndex=s.lastIndex;else break;e.push(i[0])}return e}const fV=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,hV=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Iw(n,e){const{font:t}=e,r=t?t?.preferredFormat:void 0;return r?n.replace(hV,s=>{for(;;){const[i,,a]=fV.exec(s)||[];if(!a)return"";if(a===r)return`src: ${i};`}}):n}async function mV(n,e){const t=await Cd(n,e);if(Rr(t.node)&&Rl(t.node))return t.node;const{ownerDocument:r,log:s,tasks:i,svgStyleElement:a,svgDefsElement:l,svgStyles:u,font:d,progress:f,autoDestruct:m,onCloneNode:g,onEmbedNode:x,onCreateForeignObjectSvg:y}=t;s.time("clone node");const w=await rg(t.node,t,!0);if(a&&r){let A="";u.forEach((I,N)=>{A+=`${I.join(`,
`)} {
  ${N}
}
`}),a.appendChild(r.createTextNode(A))}s.timeEnd("clone node"),await g?.(w),d!==!1&&Rr(w)&&(s.time("embed web font"),await cV(w,t),s.timeEnd("embed web font")),s.time("embed node"),tC(w,t);const b=i.length;let E=0;const T=async()=>{for(;;){const A=i.pop();if(!A)break;try{await A}catch(I){t.log.warn("Failed to run task",I)}f?.(++E,b)}};f?.(E,b),await Promise.all([...Array.from({length:4})].map(T)),s.timeEnd("embed node"),await x?.(w);const _=pV(w,t);return l&&_.insertBefore(l,_.children[0]),a&&_.insertBefore(a,_.children[0]),m&&tV(t),await y?.(_),_}function pV(n,e){const{width:t,height:r}=e,s=I$(t,r,n.ownerDocument),i=s.ownerDocument.createElementNS(s.namespaceURI,"foreignObject");return i.setAttributeNS(null,"x","0%"),i.setAttributeNS(null,"y","0%"),i.setAttributeNS(null,"width","100%"),i.setAttributeNS(null,"height","100%"),i.append(n),s.appendChild(i),s}async function gV(n,e){const t=await Cd(n,e),r=await mV(t),s=L$(r,t.isEnable("removeControlCharacter"));t.autoDestruct||(t.svgStyleElement=qk(t.ownerDocument),t.svgDefsElement=t.ownerDocument?.createElementNS(kd,"defs"),t.svgStyles.clear());const i=_a(s,r.ownerDocument);return await F$(i,t)}async function xV(n,e){const t=await Cd(n,e),{log:r,quality:s,type:i,dpi:a}=t,l=await gV(t);r.time("canvas to data url");let u=l.toDataURL(i,s);if(["image/png","image/jpeg"].includes(i)&&a&&d$&&f$){const[d,f]=u.split(",");let m=0,g=!1;if(i==="image/png"){const _=c$(f);_>=0?(m=Math.ceil((_+28)/3)*4,g=!0):m=33/3*4}else i==="image/jpeg"&&(m=18/3*4);const x=f.substring(0,m),y=f.substring(m),w=window.atob(x),b=new Uint8Array(w.length);for(let _=0;_<b.length;_++)b[_]=w.charCodeAt(_);const E=i==="image/png"?i$(b,a,g):t$(b,a),T=window.btoa(String.fromCharCode(...E));u=[d,",",T,y].join("")}return r.timeEnd("canvas to data url"),u}async function nC(n,e){return xV(await Cd(n,{...e,type:"image/png"}))}const yV="/assets/fcadb86f9e7ac3194098e501064eb43213cdfff1-CAqEyYq2.png",vV="/assets/dd3b1a5ed7db644c197314328f647774bd86226e-gTVcV44l.png",wV="/assets/f81f194aee98efdd62a97e659006efa986492874-Cw7hLurS.png",bV="/assets/7d8c54338d14a1f9afdfff1bec90c42375e5050e-yQmd-iJ8.png",SV="/assets/a643fce02520f3d992e6b432fa72fab473a1ca7e-Crr1K7le.png";function EV(){return h.jsx("svg",{width:"20",height:"20",viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M12.4512 24.9023C10.734 24.9023 9.12272 24.5768 7.61719 23.9258C6.11165 23.2829 4.78923 22.3918 3.6499 21.2524C2.51058 20.1131 1.6154 18.7907 0.964355 17.2852C0.321452 15.7796 0 14.1683 0 12.4512C0 10.734 0.321452 9.12272 0.964355 7.61719C1.6154 6.11165 2.51058 4.78923 3.6499 3.6499C4.78923 2.50244 6.11165 1.60726 7.61719 0.964355C9.12272 0.321452 10.734 0 12.4512 0C14.1683 0 15.7796 0.321452 17.2852 0.964355C18.7907 1.60726 20.1131 2.50244 21.2524 3.6499C22.3918 4.78923 23.2829 6.11165 23.9258 7.61719C24.5768 9.12272 24.9023 10.734 24.9023 12.4512C24.9023 14.1683 24.5768 15.7796 23.9258 17.2852C23.2829 18.7907 22.3918 20.1131 21.2524 21.2524C20.1131 22.3918 18.7907 23.2829 17.2852 23.9258C15.7796 24.5768 14.1683 24.9023 12.4512 24.9023ZM12.4512 22.8271C13.8835 22.8271 15.2262 22.5586 16.4795 22.0215C17.7327 21.4844 18.8354 20.7397 19.7876 19.7876C20.7397 18.8354 21.4844 17.7327 22.0215 16.4795C22.5586 15.2262 22.8271 13.8835 22.8271 12.4512C22.8271 11.0189 22.5586 9.67611 22.0215 8.42285C21.4844 7.16146 20.7397 6.05876 19.7876 5.11475C18.8354 4.1626 17.7327 3.41797 16.4795 2.88086C15.2262 2.34375 13.8835 2.0752 12.4512 2.0752C11.0189 2.0752 9.67611 2.34375 8.42285 2.88086C7.1696 3.41797 6.06689 4.1626 5.11475 5.11475C4.1626 6.05876 3.41797 7.16146 2.88086 8.42285C2.34375 9.67611 2.0752 11.0189 2.0752 12.4512C2.0752 13.8835 2.34375 15.2262 2.88086 16.4795C3.41797 17.7327 4.1626 18.8354 5.11475 19.7876C6.06689 20.7397 7.1696 21.4844 8.42285 22.0215C9.67611 22.5586 11.0189 22.8271 12.4512 22.8271ZM10.3149 19.2749C10.0627 19.2749 9.85107 19.1935 9.68018 19.0308C9.50928 18.868 9.42383 18.6646 9.42383 18.4204C9.42383 18.1763 9.50928 17.9728 9.68018 17.8101C9.85107 17.6473 10.0627 17.5659 10.3149 17.5659H11.8286V11.9629H10.5225C10.2702 11.9629 10.0586 11.8815 9.8877 11.7188C9.7168 11.556 9.63135 11.3525 9.63135 11.1084C9.63135 10.8643 9.7168 10.6608 9.8877 10.498C10.0586 10.3353 10.2702 10.2539 10.5225 10.2539H12.8174C13.1266 10.2539 13.3626 10.3556 13.5254 10.5591C13.6882 10.7544 13.7695 11.0189 13.7695 11.3525V17.5659H15.2832C15.5355 17.5659 15.7471 17.6473 15.918 17.8101C16.0889 17.9728 16.1743 18.1763 16.1743 18.4204C16.1743 18.6646 16.0889 18.868 15.918 19.0308C15.7471 19.1935 15.5355 19.2749 15.2832 19.2749H10.3149ZM12.3413 8.21533C11.9019 8.21533 11.5275 8.06071 11.2183 7.75146C10.909 7.44222 10.7544 7.06787 10.7544 6.62842C10.7544 6.18083 10.909 5.80241 11.2183 5.49316C11.5275 5.18392 11.9019 5.0293 12.3413 5.0293C12.7889 5.0293 13.1632 5.18392 13.4644 5.49316C13.7736 5.80241 13.9282 6.18083 13.9282 6.62842C13.9282 7.06787 13.7736 7.44222 13.4644 7.75146C13.1632 8.06071 12.7889 8.21533 12.3413 8.21533Z",fill:"currentColor"})})}const Lw="M10.6862 7.6055L17.3844 0H15.8002L9.97941 6.60311L5.36277 0H0.178833L7.19548 9.9737L0.178833 17.9454H1.76308L7.90171 10.9761L12.7696 17.9454H17.9536L10.6858 7.6055H10.6862ZM8.7057 10.0639L7.99222 9.06869L2.33673 1.16544H4.60063L9.33802 7.5516L10.0515 8.54678L15.8011 16.8348H13.5372L8.7057 10.0643V10.0639Z";function TV(){return h.jsx("div",{className:"h-px relative shrink-0 w-full",children:h.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})}function _V({categories:n}){return!n||n.length===0?null:h.jsxs(h.Fragment,{children:[h.jsx(TV,{}),h.jsx("div",{className:"font-['Figtree',sans-serif] font-normal gap-3 grid grid-cols-4 max-md:grid-cols-2 max-md:gap-y-6 relative shrink-0 text-[15px] w-full mt-2",children:n.map((e,t)=>h.jsxs("div",{className:"content-stretch flex flex-col gap-2 items-start justify-start relative shrink-0",children:[h.jsx("p",{className:"leading-5 text-sm relative shrink-0 text-[#9ca3af]",children:e.label}),h.jsx("div",{className:"content-stretch flex flex-col gap-1 items-start leading-[0] relative shrink-0 text-gray-500",children:e.tools.map((r,s)=>h.jsx("div",{className:"flex flex-col justify-center relative shrink-0",children:h.jsx("p",{className:"leading-[21px] whitespace-nowrap",children:r})},s))})]},t))})]})}function sg({project:n}){const[e,t]=L.useState(!1),[r,s]=L.useState(!1),[i,a]=L.useState(!1),[l,u]=L.useState(!1);$a(e),L.useEffect(()=>{if(e){requestAnimationFrame(()=>{s(!0)});const m=setTimeout(()=>{u(!0)},350);return()=>clearTimeout(m)}else s(!1),u(!1)},[e]),L.useEffect(()=>{if(!e)return;const m=g=>{g.key==="Escape"&&(g.preventDefault(),f())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e]);const d=()=>{t(!0),a(!1)},f=()=>{a(!0),s(!1),setTimeout(()=>{t(!1),a(!1)},300)};return h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:d,className:"absolute top-8 right-8 md:right-16 z-40 cursor-pointer transition-opacity duration-200 hover:opacity-70 text-gray-400","aria-label":"Project info",children:h.jsx(EV,{})}),e&&h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-8",children:[h.jsx("div",{className:`absolute inset-0 bg-black/20 transition-opacity duration-300 ${r?"opacity-100":"opacity-0"}`,onClick:f}),h.jsx("div",{className:`relative bg-white rounded-3xl flex flex-col w-[calc(100%*6/12)] max-md:w-[95%] transition-all duration-300 ease-out ${r?"opacity-100 translate-y-0":i?"opacity-0 translate-y-4":"opacity-0 translate-y-8"}`,children:h.jsxs("div",{className:"content-stretch flex flex-col max-md:gap-3 gap-4 items-start px-8 max-md:px-6 pt-6 pb-8 max-md:py-5 relative shrink-0 w-full",children:[h.jsxs("div",{className:"w-full flex flex-col gap-1",children:[h.jsxs("div",{className:"flex items-center justify-between w-full",children:[h.jsxs("div",{className:"content-stretch flex gap-[6px] items-center relative shrink-0",children:[h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-lg text-black",children:n.title}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] relative shrink-0 text-[#9ca3af] text-base",children:""}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-[#9ca3af] text-lg",children:n.year})]}),n.xLink&&h.jsxs("a",{href:n.xLink,target:"_blank",rel:"noopener noreferrer",className:"hidden md:flex bg-blue-500 border border-blue-400 border-solid gap-1 items-center justify-center px-3 py-1 relative rounded-full shrink-0 cursor-pointer hover:bg-blue-400 hover:border-blue-300 transition-colors duration-200 ease-out mt-1",children:[h.jsx("span",{className:"font-['Manrope',sans-serif] font-semibold leading-normal relative shrink-0 text-sm text-white whitespace-nowrap",children:"View on"}),h.jsx("svg",{className:"block w-[12px] h-[12px] fill-white",viewBox:"0 0 19 18",children:h.jsx("path",{d:Lw})}),h.jsx("span",{className:"text-white",children:h.jsx(Gs,{})})]})]}),h.jsx("div",{className:"content-stretch -mt-1.5 flex gap-2 items-start relative w-full max-md:mt-0 -mt-1 mb-1",children:h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative text-[#6b7280] text-base",children:n.description})})]}),n.xLink&&h.jsxs("a",{href:n.xLink,target:"_blank",rel:"noopener noreferrer",className:"md:hidden mb-2 bg-blue-500 border border-blue-400 border-solid flex gap-1 items-center justify-center px-3 py-1 relative rounded-full shrink-0 -mt-1 cursor-pointer hover:bg-blue-400 hover:border-blue-300 transition-colors duration-200 ease-out",children:[h.jsx("span",{className:"font-['Manrope',sans-serif] font-semibold leading-normal relative shrink-0 text-sm text-white whitespace-nowrap",children:"View on"}),h.jsx("svg",{className:"block w-[12px] h-[12px] fill-white",viewBox:"0 0 19 18",children:h.jsx("path",{d:Lw})}),h.jsx("span",{className:"text-white",children:h.jsx(Gs,{})})]}),n.toolCategories&&n.toolCategories.length>0&&h.jsx(_V,{categories:n.toolCategories}),h.jsxs("div",{className:"relative rounded-[16px] border border-gray-100 border-solid w-full aspect-[1097/616] overflow-hidden bg-gray-100 shrink-0 mt-3",children:[h.jsx("img",{alt:"",className:"absolute object-cover size-full rounded-[16px]",src:n.imageSrc}),n.videoSrc&&l&&h.jsx(Os,{src:n.videoSrc,className:"absolute object-cover size-full rounded-[16px]",autoPlay:!0,muted:!0,loop:!0,controls:!1,muxEnvKey:"e4cc19a78gcf0tbtfmu4m7ruf"},n.id)]})]})})]})]})}function kV(n){return{imageSrc:`https://image.mux.com/${n}/thumbnail.png`,videoSrc:`https://stream.mux.com/${n}.m3u8`}}function ig(n,e){const[t,r]=L.useState(e);return L.useEffect(()=>{async function s(){try{const i=await it.fetch(vO,{projectId:n});if(i){const a=i.muxPlaybackId?kV(i.muxPlaybackId):{imageSrc:e.imageSrc,videoSrc:e.videoSrc};r({id:i.projectId,title:i.title,year:i.year,description:i.description,imageSrc:a.imageSrc,videoSrc:a.videoSrc,xLink:i.xLink||e.xLink,tryItOutHref:i.tryItOutHref||e.tryItOutHref,toolCategories:i.toolCategories||e.toolCategories})}}catch(i){console.error(`Error fetching experiment project ${n}:`,i)}}s()},[n,e]),t}const CV={id:"polaroid",title:"Polaroid Studio",year:"2025",description:"A digital way to customize your own polaroid.",imageSrc:"https://image.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w/thumbnail.png",videoSrc:"https://stream.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w.m3u8",xLink:"https://x.com/michelletliu/status/1991201412072734777",tryItOutHref:"/polaroid",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]};let Lp=!1,uu=null;function Cm(n){uu&&(clearTimeout(uu),uu=null),n?Lp=!0:uu=setTimeout(()=>{Lp=!1},150)}function ad({label:n,children:e,offsetY:t=0}){const[r,s]=L.useState(!1),[i,a]=L.useState(!1),[l,u]=L.useState(!1),d=L.useRef(null),f=()=>{d.current&&clearTimeout(d.current),a(!1),Lp?(u(!0),s(!0),Cm(!0)):(u(!1),d.current=setTimeout(()=>{s(!0),Cm(!0)},800))},m=()=>{d.current&&(clearTimeout(d.current),d.current=null),r&&(Cm(!1),l?(s(!1),u(!1)):(a(!0),setTimeout(()=>{s(!1),a(!1)},125)))};return h.jsxs("div",{className:"relative inline-flex",onMouseEnter:f,onMouseLeave:m,children:[e,r&&h.jsxs("div",{className:"tooltip absolute left-1/2 px-2.5 py-1.5 bg-gray-800 text-white text-[13px] font-medium rounded-md whitespace-nowrap pointer-events-none z-[9999] -translate-x-1/2","data-ending-style":i?"":void 0,"data-instant":l?"":void 0,style:{bottom:`calc(100% + 8px - ${t}px)`,"--transform-origin":"center bottom"},children:[n,h.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[5px] border-t-gray-800"})]})]})}const Rw=[{id:"red",name:"Red",fill:"#FF383C",fillHover:"#E32226",tint:"rgba(255, 56, 60, 0.15)",border:"#f0c8c9"},{id:"orange",name:"Orange",fill:"#FF8D28",fillHover:"#E67A1C",tint:"rgba(255, 141, 40, 0.15)",border:"#ffe0c8"},{id:"yellow",name:"Yellow",fill:"#FFCC00",fillHover:"#E6B800",tint:"rgba(255, 204, 0, 0.15)",border:"#fff2cc"},{id:"green",name:"Green",fill:"#34C759",fillHover:"#2DB04C",tint:"rgba(52, 199, 89, 0.15)",border:"#d4eedd"},{id:"cyan",name:"Cyan",fill:"#00C3D0",fillHover:"#00A8B5",tint:"rgba(0, 195, 208, 0.1)",border:"#c5f0e7"},{id:"blue",name:"Blue",fill:"#0088FF",fillHover:"#0070D9",tint:"rgba(0, 136, 255, 0.15)",border:"#cce5ff"},{id:"purple",name:"Purple",fill:"#6155F5",fillHover:"#4E3FE0",tint:"rgba(97, 85, 245, 0.15)",border:"#d1d0e0"}];function AV({color:n,isSelected:e,onClick:t}){const[r,s]=L.useState(!1);return e?h.jsx(ad,{label:n.name,offsetY:-5,children:h.jsx("button",{onClick:t,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),className:"relative shrink-0 size-[30px] cursor-pointer group","aria-label":`Select ${n.name} color`,children:h.jsx("div",{className:"absolute inset-[-20%]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 42 42",children:h.jsxs("g",{children:[h.jsx("circle",{cx:"21",cy:"21",fill:r?n.fillHover:n.fill,opacity:"0.7",r:"15",className:"transition-all duration-200"}),h.jsx("circle",{cx:"21",cy:"21",opacity:"0.7",r:"19.5",stroke:"#0088FF",strokeWidth:"3"})]})})})})}):h.jsx(ad,{label:n.name,offsetY:-5,children:h.jsx("button",{onClick:t,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),className:"relative shrink-0 size-[30px] cursor-pointer group","aria-label":`Select ${n.name} color`,children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 30 30",children:h.jsx("g",{opacity:"0.7",children:h.jsx("circle",{cx:"15",cy:"15",fill:r?n.fillHover:n.fill,r:"15",className:"transition-all duration-200"})})})})})}function IV(){const n=Dr(),e=ig("polaroid",CV),[t,r]=L.useState(null),[s,i]=L.useState(!1),[a,l]=L.useState(!1),[u,d]=L.useState(""),[f,m]=L.useState(!1),[g,x]=L.useState(!1),[y,w]=L.useState(!1),[b,E]=L.useState(!1),[T,_]=L.useState(!1),[A,I]=L.useState(!1),[N,P]=L.useState(!1),[O,M]=L.useState(null),[D,B]=L.useState(!1),[q,ie]=L.useState(null),[te,re]=L.useState(!1),[ee,Q]=L.useState(!1),[G,Y]=L.useState(!0),Z=L.useRef(null),j=L.useRef(null);L.useEffect(()=>{const ge=setTimeout(()=>{Y(!1)},50);return()=>clearTimeout(ge)},[]);const $=()=>{Q(!0),setTimeout(()=>{n("/")},280)};L.useEffect(()=>{const ge=new URLSearchParams(window.location.search),Ie=ge.get("color");if(Ie){const Ue=Rw.find(Je=>Je.id===Ie);Ue&&r(Ue)}const Me=ge.get("caption");Me&&(d(decodeURIComponent(Me)),l(!0)),ge.get("date")==="true"&&i(!0)},[]);const fe=L.useRef(null);L.useEffect(()=>{const ge=()=>{te&&setTimeout(()=>{re(!1),P(!1)},100)};return window.addEventListener("focus",ge),()=>window.removeEventListener("focus",ge)},[te]);const ne=new Date().toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}).replace(/\//g,"."),ae=()=>{r(null),i(!1),l(!1),d(""),m(!1),ie(null)},ce=async()=>{if(fe.current)try{const ge=await nC(fe.current,{scale:3,backgroundColor:null}),Ie=document.createElement("a");Ie.href=ge,Ie.download=`PolaroidStudio${ne}.png`,document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie),E(!0),setTimeout(()=>E(!1),2e3)}catch(ge){console.error("Failed to download polaroid:",ge)}},_e=()=>{const ge=window.location.origin+window.location.pathname,Ie=new URLSearchParams;return t&&Ie.set("color",t.id),u&&Ie.set("caption",encodeURIComponent(u)),s&&Ie.set("date","true"),Ie.toString()?`${ge}?${Ie.toString()}`:ge},Ee=async()=>{const ge=_e();try{await navigator.clipboard.writeText(ge),w(!0),setTimeout(()=>w(!1),2e3)}catch{const Me=document.createElement("textarea");Me.value=ge,Me.style.position="fixed",Me.style.left="-999999px",document.body.appendChild(Me),Me.select();try{document.execCommand("copy"),w(!0),setTimeout(()=>w(!1),2e3)}catch(we){console.error("Failed to copy link:",we)}document.body.removeChild(Me)}},Le=async ge=>{const Ie=_e(),Me="Check out my Polaroid!",we={Instagram:"https://www.instagram.com/",Messages:`sms:&body=${encodeURIComponent(Me+" "+Ie)}`,AirDrop:Ie,LinkedIn:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(Ie)}`,Mail:`mailto:?subject=${encodeURIComponent(Me)}&body=${encodeURIComponent(Ie)}`,X:`https://twitter.com/intent/tweet?text=${encodeURIComponent(Me)}&url=${encodeURIComponent(Ie)}`};if((ge==="AirDrop"||ge==="Messages")&&navigator.share)try{await navigator.share({title:Me,text:Me,url:Ie});return}catch{console.log("Share cancelled or failed"),ge==="Messages"&&(window.location.href=we[ge]);return}if(ge==="Instagram"){alert("Instagram sharing would open the Instagram app here. Link copied to clipboard!");return}we[ge]&&(ge==="Messages"?window.location.href=we[ge]:window.open(we[ge],"_blank"))},oe=()=>{if(B(!0),q){const ge=setTimeout(()=>{P(!0)},50);M(ge)}},Re=()=>{B(!1),O&&(clearTimeout(O),M(null)),te||P(!1)},We=ge=>{const Ie=ge.target.files?.[0];if(Ie){if(!Ie.type.startsWith("image/")){alert("Please upload an image file (e.g., .jpg, .png, .gif)"),re(!1),P(!1);return}const Me=new FileReader;Me.onload=we=>{ie(we.target?.result),re(!1),P(!1),j.current&&(j.current.value="")},Me.onerror=()=>{console.error("Error reading file"),alert("Error reading file. Please try again."),re(!1),P(!1)},Me.readAsDataURL(Ie)}};return h.jsxs(h.Fragment,{children:[h.jsx("button",{ref:Z,onClick:$,className:"fixed top-8 left-8 md:left-16 z-40 cursor-pointer transition-opacity duration-200 hover:opacity-80","aria-label":"Go back to home",children:h.jsx("img",{src:Ia,alt:"Michelle Liu Logo",className:"w-[44px] h-[44px] object-contain"})}),h.jsx(sg,{project:e}),h.jsxs("div",{className:`polaroid-page-container relative w-full min-h-screen min-h-[100dvh] px-4 flex flex-col items-center transition-all ${ee?"opacity-0 scale-[0.985]":G?"opacity-0 scale-[1.01]":"opacity-100 scale-100"}`,style:{backgroundImage:"linear-gradient(133.216deg, rgba(151, 191, 255, 0.2) 10.334%, rgba(151, 191, 255, 0) 94.005%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)",transitionDuration:ee?"280ms":"300ms",transitionTimingFunction:ee?"cubic-bezier(0.4, 0, 0.2, 1)":"ease-out"},onClick:()=>{_(!1),I(!1)},children:[h.jsxs("div",{className:"flex flex-col gap-[32px] md:gap-[48px] items-center w-full max-w-[583px] my-auto py-[100px] md:py-[120px]",children:[h.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center relative shrink-0 text-2xl md:text-3rxl text-black text-center text-nowrap",style:{fontVariationSettings:"'wdth' 100"},children:h.jsxs("p",{className:"",children:[h.jsx("span",{children:"Polaroid "}),h.jsx("span",{className:"text-gray-400",children:"Studio"})]})}),h.jsxs("div",{ref:fe,className:"content-stretch flex h-[320px] md:h-[393.22px] items-center justify-center relative rounded-[5.5px] md:rounded-[6.78px] shadow-[0px_2.5px_16px_0px_rgba(0,0,0,0.08)] md:shadow-[0px_3.39px_20.339px_0px_rgba(0,0,0,0.08)] shrink-0 w-[274px] md:w-[337.288px] transition-transform duration-300 ease-out hover:rotate-2",children:[h.jsx("div",{className:"h-[320px] md:h-[393.22px] relative rounded-[5.5px] md:rounded-[6.78px] shrink-0 w-[274px] md:w-[337.288px]",children:h.jsxs("div",{className:"absolute contents left-0 top-0",children:[h.jsx("div",{className:"absolute contents left-0 top-0",children:h.jsx("div",{className:"absolute blur-[0.25px] filter h-full left-0 rounded-[5.5px] md:rounded-[6.78px] top-0 w-full",style:{backgroundColor:t?t.tint:"white"},children:h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-[-1px] pointer-events-none rounded-[6.88px] md:rounded-[8.475px]",style:{borderColor:t?t.border:void 0}})})}),h.jsx("div",{className:"absolute content-stretch flex items-center left-0 pb-[62px] md:pb-[76.271px] pt-[16.5px] md:pt-[20.339px] px-[16.5px] md:px-[20.339px] rounded-[5.5px] md:rounded-[6.78px] top-0",style:{backgroundColor:t?t.tint:"white"},children:h.jsxs("div",{className:"relative rounded-[2.75px] md:rounded-[3.39px] shrink-0 w-[241px] h-[241px] md:w-[296.61px] md:h-[296.61px]",onMouseEnter:oe,onMouseLeave:Re,children:[h.jsx("div",{className:"overflow-clip relative rounded-[inherit] size-full",children:q?h.jsx("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden rounded-[4.7px] md:rounded-[5.773px] bg-[#f5f5f5]",children:h.jsx("img",{alt:"Polaroid photo",className:"max-w-full max-h-full w-auto h-auto object-contain",src:q})}):h.jsx("button",{type:"button",onClick:()=>{re(!0),j.current?.click()},className:"absolute inset-0 rounded-[4.7px] md:rounded-[5.773px] flex items-center justify-center cursor-pointer transition-colors duration-200",style:{backgroundColor:D?"#e5e7eb":"#f3f4f6"},children:h.jsx("div",{className:"rounded-full w-[162px] h-[162px] md:w-[200px] md:h-[200px] flex items-center justify-center transition-colors duration-200",style:{backgroundColor:D?"#d1d5db":"#e5e7eb"},children:h.jsxs("svg",{width:"65",height:"65",viewBox:"0 0 24 24",fill:"none",stroke:D?"#6b7280":"#9ca3af",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"md:w-[80px] md:h-[80px] transition-colors duration-200",children:[h.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),h.jsx("polyline",{points:"17 8 12 3 7 8"}),h.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})})})}),h.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:We,className:"sr-only","aria-hidden":"true"}),N&&q&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"absolute bg-[rgba(196,196,196,0.5)] inset-0 rounded-[3.39px] transition-all duration-150 ease-out animate-fade-in-fast"}),h.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10",children:h.jsx("button",{type:"button",onClick:()=>{re(!0),j.current?.click()},className:"cursor-pointer block transition-all duration-150 ease-out animate-scale-in-fast",children:h.jsxs("div",{className:"bg-gray-50 hover:!bg-gray-200 content-stretch flex gap-[12px] items-center px-6 py-3 rounded-[999px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)] hover:shadow-[0px_4px_12px_0px_rgba(0,0,0,0.1)] transition-all duration-300 ease-in-out",children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[999px]"}),h.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(60,60,67,0.6)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),h.jsx("polyline",{points:"17 8 12 3 7 8"}),h.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),h.jsx("span",{className:"font-['SF_Pro','-apple-system',sans-serif] text-[17px] text-[rgba(60,60,67,0.6)] whitespace-nowrap",children:"Upload New"})]})})})]}),h.jsx("div",{"aria-hidden":"true",className:"absolute border-[0.847px] border-solid border-gray-200/50 inset-0 pointer-events-none rounded-[3.39px]",style:{borderColor:t?`${t.fill}4D`:void 0}})]})})]})}),s&&h.jsx("div",{className:"absolute flex flex-col justify-center leading-[0] left-[229.7px] md:left-[282.7px] not-italic text-[13.8px] md:text-[16.949px] text-[rgba(0,0,0,0.4)] text-center text-nowrap top-[301.5px] md:top-[370.72px] tracking-[0.15em] -translate-x-1/2 -translate-y-1/2",style:{fontFamily:"'Courier New', monospace"},children:h.jsx("p",{className:"leading-[23.4px] md:leading-[28.814px]",children:ne})}),a&&h.jsx("div",{className:"absolute content-stretch flex items-center left-[10px] md:left-[12.3px] px-[6.5px] md:px-[8px] py-[3.25px] md:py-[4px] top-[260.2px] md:top-[320.29px]",children:h.jsxs("div",{className:"content-stretch flex items-center relative shrink-0",children:[h.jsx("div",{className:"flex flex-col justify-center leading-[0] not-italic relative shrink-0 text-[14.6px] md:text-[18px] text-black text-center text-nowrap tracking-[0.15em]",style:{fontFamily:"'Courier New', monospace"},children:h.jsx("p",{className:"leading-[24.4px] md:leading-[30px]",children:u})}),f&&h.jsx("div",{className:"h-[24.4px] md:h-[30px] relative shrink-0 w-[1.6px] md:w-[2px] ml-[1.6px] md:ml-[2px] animate-blink",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 2 30",children:h.jsx("path",{d:"M1 2L1 28",stroke:"#0088FF",strokeLinecap:"round",strokeWidth:"2"})})}),h.jsx("input",{type:"text",value:u,onChange:ge=>d(ge.target.value),onFocus:()=>m(!0),onBlur:()=>{m(!1),u.trim()===""&&(l(!1),I(!1))},onKeyDown:ge=>{ge.key==="Enter"&&(ge.preventDefault(),I(!1),ge.currentTarget.blur())},placeholder:"",className:"absolute inset-0 opacity-0 cursor-text",style:{width:"300px"},maxLength:20})]})})]}),h.jsxs("div",{className:"content-stretch flex flex-col gap-[36px] items-center relative shrink-0",children:[h.jsx("div",{className:"content-stretch flex items-center px-[8px] py-0 relative rounded-[16px] shrink-0 w-full justify-center",children:h.jsxs("div",{className:"content-stretch flex md:flex-row flex-col gap-[10px] items-center justify-center relative shrink-0",children:[h.jsxs("div",{className:"bg-white content-stretch flex items-center md:p-[10px] p-[8px] relative rounded-[1000px] shrink-0 shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)] overflow-visible",children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/80 border-solid inset-0 pointer-events-none rounded-[1000px]"}),h.jsx("div",{className:"content-stretch flex md:gap-[18px] gap-[12px] items-center relative shrink-0 overflow-visible",children:Rw.map(ge=>h.jsx(AV,{color:ge,isSelected:t?.id===ge.id,onClick:()=>r(ge)},ge.id))})]}),h.jsxs("div",{className:"flex gap-[10px] items-center",children:[h.jsx(ad,{label:"Date",children:h.jsxs("div",{className:"bg-white content-stretch flex items-center p-[5px] relative rounded-[1000px] shrink-0 shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)]",children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/80 border-solid inset-0 pointer-events-none rounded-[1000px]"}),h.jsx("button",{onClick:ge=>{ge.stopPropagation(),i(!s),s||(_(!0),I(!1))},className:`relative rounded-[999px] shrink-0 size-[40px] cursor-pointer transition-all duration-300 ${s&&T?"bg-[#0088FF]":s?"bg-[#e5e7eb] hover:bg-[#d1d5db]":"bg-transparent hover:bg-[#e5e5e5]"}`,"aria-label":"Toggle date",children:h.jsx("div",{className:"absolute inset-0 flex items-center justify-center transition-colors duration-300",children:h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:s&&T?"white":s?"#1f2937":"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),h.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),h.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),h.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})})})]})}),h.jsx(ad,{label:"Caption",children:h.jsxs("div",{className:"bg-white content-stretch flex items-center p-[5px] relative rounded-[1000px] shrink-0 shadow-[0px_2px_8px_0px_rgba(0,0,0,0.06)]",children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/80 border-solid inset-0 pointer-events-none rounded-[1000px]"}),h.jsx("button",{onClick:ge=>{ge.stopPropagation(),a?(l(!1),I(!1)):(l(!0),I(!0),_(!1),setTimeout(()=>{const Ie=document.querySelector('input[type="text"]');Ie&&Ie.focus()},100))},className:`relative rounded-[999px] shrink-0 size-[40px] cursor-pointer transition-all duration-300 ${a&&A?"bg-[#0088FF]":a?"bg-[#e5e7eb] hover:bg-[#d1d5db]":"bg-transparent hover:bg-[#e5e5e5]"}`,"aria-label":"Toggle text",children:h.jsx("div",{className:"absolute inset-0 flex items-center justify-center transition-colors duration-300",children:h.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:a&&A?"white":a?"#1f2937":"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("polyline",{points:"4 7 4 4 20 4 20 7"}),h.jsx("line",{x1:"9",y1:"20",x2:"15",y2:"20"}),h.jsx("line",{x1:"12",y1:"4",x2:"12",y2:"20"})]})})})]})})]})]})}),h.jsxs("div",{className:"content-stretch flex gap-[24px] items-center relative shrink-0",children:[h.jsxs("button",{className:"flex items-center gap-[8px] px-6 py-3 text-[17px] text-[rgba(60,60,67,0.5)] cursor-pointer rounded-[999px] hover:bg-[rgba(0,0,0,0.05)] transition-colors",onClick:ae,children:[h.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),h.jsx("path",{d:"M3 3v5h5"})]}),h.jsx("span",{className:"font-['SF_Pro','-apple-system',sans-serif]",children:"Restart"})]}),h.jsxs("button",{className:`rounded-[999px] flex items-center gap-[8px] px-6 py-3 text-[17px] text-white transition-colors ${q?"bg-black cursor-pointer hover:bg-[rgba(0,0,0,0.8)]":"bg-gray-800 cursor-not-allowed opacity-50"}`,onClick:()=>q&&x(!0),disabled:!q,children:[h.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),h.jsx("polyline",{points:"16 6 12 2 8 6"}),h.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]}),h.jsx("span",{className:"font-['SF_Pro','-apple-system',sans-serif]",children:"Share"})]})]})]})]}),g&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"fixed inset-0 transition-opacity cursor-pointer z-40",style:{backgroundImage:"linear-gradient(90deg, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.05) 100%), linear-gradient(90deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.25) 100%)",opacity:.4},onClick:()=>x(!1)}),h.jsxs("div",{className:"fixed bg-white left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 rounded-[26px] z-50 max-h-[calc(100vh-40px)] max-h-[calc(100dvh-40px)] overflow-y-auto w-[calc(100%-32px)] sm:w-auto sm:min-w-[400px] md:min-w-[530px]",children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-[24px] sm:gap-[32px] items-center overflow-clip px-[20px] sm:px-[28px] md:px-[36px] py-[24px] sm:py-[30px] pb-[32px] sm:pb-[40px] relative rounded-[inherit] w-full sm:min-w-[400px] md:min-w-[530px]",children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-[36px] items-center relative shrink-0 w-full",children:[h.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center leading-[0] min-w-full relative shrink-0 text-[22px] text-black tracking-[-0.26px] w-[min-content]",style:{fontVariationSettings:"'wdth' 100"},children:h.jsx("p",{className:"leading-[28px]",children:"Share Polaroid"})}),h.jsx("div",{className:"relative shrink-0 h-[198px] sm:h-[254.237px] w-[170px] sm:w-[218.074px]",style:{perspective:"800px"},children:h.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 transition-transform duration-300 ease-out scale-[0.78] sm:scale-100 origin-top hover:[transform:rotateY(-8deg)_rotateX(2deg)]",style:{width:"218.074px",height:"254.237px"},children:h.jsx("div",{className:"absolute content-stretch flex items-center justify-center left-0 rounded-[4.383px] shadow-[0px_2.192px_13.15px_0px_rgba(0,0,0,0.15)] top-0 w-[218.074px]",children:h.jsx("div",{className:"h-[254.237px] relative rounded-[4.383px] shrink-0 w-[218.074px]",children:h.jsxs("div",{className:"absolute contents left-0 top-0",children:[h.jsx("div",{className:"absolute contents left-0 top-0",children:h.jsx("div",{className:"absolute blur-[0.162px] filter h-[254.237px] left-0 rounded-[4.383px] top-0 w-[218.074px]",style:{backgroundColor:t?t.tint:"white"},children:h.jsx("div",{"aria-hidden":"true",className:"absolute border-[1.096px] border-solid border-gray-200/50 inset-[-1.096px] pointer-events-none rounded-[5.479px]",style:{borderColor:t?t.border:void 0}})})}),h.jsx("div",{className:"absolute content-stretch flex items-center left-0 pb-[49.313px] pt-[13.15px] px-[13.15px] rounded-[4.383px] top-0",style:{backgroundColor:t?t.tint:"white"},children:h.jsxs("div",{className:"relative rounded-[2.192px] shrink-0 size-[191.774px]",children:[h.jsx("div",{className:"overflow-clip relative rounded-[inherit] size-full",children:q?h.jsx("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden rounded-[3.733px] bg-[#f5f5f5]",children:h.jsx("img",{alt:"Polaroid photo",className:"max-w-full max-h-full w-auto h-auto object-contain",src:q})}):h.jsx("div",{className:"absolute inset-0 bg-[#f3f4f6] rounded-[3.733px] flex items-center justify-center",children:h.jsx("div",{className:"bg-[#e5e7eb] rounded-full w-[130px] h-[130px] flex items-center justify-center",children:h.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 24 24",fill:"none",stroke:"#9ca3af",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),h.jsx("polyline",{points:"17 8 12 3 7 8"}),h.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})})})}),h.jsx("div",{"aria-hidden":"true",className:"absolute border-[0.548px] border-solid border-gray-200/50 inset-0 pointer-events-none rounded-[2.192px]",style:{borderColor:t?`${t.fill}4D`:void 0}})]})}),s&&h.jsx("div",{className:"absolute flex flex-col justify-center leading-[0] left-[182.78px] not-italic text-[10.959px] text-[rgba(0,0,0,0.4)] text-center text-nowrap top-[239.88px] tracking-[0.15em] -translate-x-1/2 -translate-y-1/2",style:{fontFamily:"'Courier New', monospace"},children:h.jsx("p",{className:"leading-[18.629px]",children:ne})}),u&&h.jsx("div",{className:"absolute content-stretch flex items-center left-[8.07px] px-[5.172px] py-[2.586px] top-[207.15px] w-[104.741px]",children:h.jsx("div",{className:"content-stretch flex items-center relative shrink-0",children:h.jsx("div",{className:"flex flex-col justify-center leading-[0] not-italic relative shrink-0 text-[12.931px] text-black text-center text-nowrap tracking-[0.15em]",style:{fontFamily:"'Courier New', monospace"},children:h.jsx("p",{className:"leading-[21.983px]",children:u})})})})]})})})})}),h.jsxs("div",{className:"content-stretch flex gap-[16px] sm:gap-[24px] items-center relative shrink-0 w-full",children:[h.jsxs("button",{onClick:Ee,className:"group basis-0 bg-white grow h-[120px] sm:h-[140px] min-h-px min-w-px relative rounded-[16px] shrink-0 cursor-pointer hover:bg-gray-50 transition-all duration-300 ease-in-out",style:{backgroundImage:y?"linear-gradient(90deg, rgba(0, 0, 0, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)":void 0},children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[16px]"}),h.jsx("div",{className:"flex flex-col items-center size-full",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-[7px] items-center p-[24px] relative size-full",children:[h.jsxs("div",{className:"relative shrink-0 size-[70px]",children:[h.jsx("div",{className:`absolute bg-gray-100 group-hover:bg-gray-200 flex items-center justify-center rounded-full size-[70px] transition-all duration-300 ease-in-out ${y?"opacity-0 scale-75":"opacity-100 scale-100"}`,children:h.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),h.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}),h.jsx("div",{className:`absolute bg-[#08f] flex items-center justify-center left-[-2px] rounded-full size-[74px] top-[-2px] transition-all duration-300 ease-in-out ${y?"opacity-100 scale-100":"opacity-0 scale-75"}`,children:h.jsx("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),h.jsxs("div",{className:"relative h-[20px] overflow-visible",children:[h.jsx("p",{className:`font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${y?"opacity-0 translate-y-[-5px]":"opacity-100 translate-y-0"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Copy Link"}),h.jsx("p",{className:`absolute left-0 right-0 top-0 font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${y?"opacity-100 translate-y-0":"opacity-0 translate-y-[5px]"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Saved!"})]})]})})]}),h.jsxs("button",{onClick:ce,className:"group basis-0 bg-white grow h-[120px] sm:h-[140px] min-h-px min-w-px relative rounded-[16px] shrink-0 cursor-pointer hover:bg-gray-50 transition-all duration-300 ease-in-out",style:{backgroundImage:b?"linear-gradient(90deg, rgba(0, 0, 0, 0.03) 0%, rgba(0, 0, 0, 0.03) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)":void 0},children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[16px]"}),h.jsx("div",{className:"flex flex-col items-center size-full",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-[7px] items-center p-[24px] relative size-full",children:[h.jsxs("div",{className:"relative shrink-0 size-[70px]",children:[h.jsx("div",{className:`absolute bg-gray-100 group-hover:bg-gray-200 flex items-center justify-center rounded-full size-[70px] transition-all duration-300 ease-in-out ${b?"opacity-0 scale-75":"opacity-100 scale-100"}`,children:h.jsxs("svg",{width:"25",height:"25",viewBox:"0 0 24 24",fill:"none",stroke:"#333",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),h.jsx("polyline",{points:"7 10 12 15 17 10"}),h.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),h.jsx("div",{className:`absolute bg-[#08f] flex items-center justify-center rounded-full size-[70px] transition-all duration-300 ease-in-out ${b?"opacity-100 scale-100":"opacity-0 scale-75"}`,children:h.jsx("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),h.jsxs("div",{className:"relative h-[15px]",children:[h.jsx("p",{className:`font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${b?"opacity-0 translate-y-[-5px]":"opacity-100 translate-y-0"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Download"}),h.jsx("p",{className:`absolute left-0 right-0 top-0 font-['SF_Pro:Regular',sans-serif] font-normal leading-[15px] text-gray-500 text-[13px] text-center tracking-[-0.1px] transition-all duration-300 ease-in-out ${b?"opacity-100 translate-y-0":"opacity-0 translate-y-[5px]"}`,style:{fontVariationSettings:"'wdth' 100"},children:"Saved!"})]})]})})]})]})]}),h.jsx("button",{onClick:()=>x(!1),className:"absolute bg-white right-[17px] rounded-full size-[32px] top-[17px] cursor-pointer hover:bg-gray-100 transition-colors flex items-center justify-center",children:h.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"rgba(20,20,20,0.5)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),h.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),h.jsx("div",{className:"overflow-x-auto overflow-y-hidden w-[calc(100%+40px)] sm:w-auto md:w-[530px] mx-[-20px] sm:mx-0 scrollbar-hide",children:h.jsxs("div",{className:"content-stretch flex gap-[20px] sm:gap-[28px] items-start justify-start sm:justify-center pb-0 pt-0 px-[20px] sm:px-[4px] relative shrink-0 w-max sm:w-full",children:[h.jsxs("button",{onClick:()=>Le("Instagram"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[h.jsx("div",{className:"relative rounded-[18.928px] shrink-0 size-[69.402px]",children:h.jsx("img",{alt:"Instagram",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[18.928px] size-full",src:yV})}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"Instagram"})]}),h.jsxs("button",{onClick:()=>Le("LinkedIn"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[h.jsx("div",{className:"relative rounded-[17.35px] shrink-0 size-[69.402px]",children:h.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none rounded-[17.35px]",children:h.jsx("img",{alt:"LinkedIn",className:"absolute h-[1236.21%] left-[-168.97%] max-w-none top-[-256.03%] w-[568.97%]",src:wV})})}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"LinkedIn"})]}),h.jsxs("button",{onClick:()=>Le("Mail"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 cursor-pointer hover:brightness-90 transition-all",children:[h.jsx("div",{className:"relative rounded-[15px] shrink-0 size-[70px]",children:h.jsx("img",{alt:"Mail",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[15px] size-full",src:bV})}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px]",style:{fontVariationSettings:"'wdth' 100"},children:"Mail"})]}),h.jsxs("button",{onClick:()=>Le("X"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[h.jsx("div",{className:"h-[70px] relative rounded-[17.949px] shrink-0 w-[69.402px]",children:h.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none rounded-[17.949px]",children:h.jsx("img",{alt:"X",className:"absolute h-[1225.64%] left-[-39.66%] max-w-none top-[-671.79%] w-[568.97%]",src:SV})})}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"X"})]}),h.jsxs("button",{onClick:()=>Le("Messages"),className:"content-stretch flex flex-col gap-[8px] items-center pb-[2px] pt-0 px-0 relative shrink-0 w-[78px] cursor-pointer hover:brightness-90 transition-all",children:[h.jsx("div",{className:"relative rounded-[18.928px] shrink-0 size-[69.402px]",children:h.jsx("img",{alt:"Messages",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[18.928px] size-full",src:vV})}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal h-[13px] leading-[13px] overflow-hidden text-ellipsis relative shrink-0 text-[11px] text-gray-500 text-center text-nowrap tracking-[0.06px] w-full",style:{fontVariationSettings:"'wdth' 100"},children:"Messages"})]})]})})]}),h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200/50 border-solid inset-0 pointer-events-none rounded-[26px]"})]})]}),h.jsx("style",{children:`
        @keyframes blink {
          0%, 49% { opacity: 1; }
          50%, 100% { opacity: 0; }
        }
        .animate-blink {
          animation: blink 1s infinite;
        }
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes scaleInCentered {
          from { 
            opacity: 0; 
            transform: scale(0.9);
          }
          to { 
            opacity: 1; 
            transform: scale(1);
          }
        }
        .animate-fade-in {
          animation: fadeIn 0.4s ease-in-out forwards;
        }
        .animate-scale-in-centered {
          animation: scaleInCentered 0.4s ease-in-out forwards;
        }
        .animate-fade-in-fast {
          animation: fadeIn 0.15s ease-out forwards;
        }
        .animate-scale-in-fast {
          animation: scaleInCentered 0.15s ease-out forwards;
        }
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
        .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        /* Polaroid page container - enable scrolling when content overflows */
        .polaroid-page-container {
          overflow-y: auto;
        }
      `})]})]})}function LV({book:n,onClick:e}){return h.jsxs("button",{onClick:e,className:"relative flex flex-col items-center w-[120px] sm:w-[136px] md:w-[148px] lg:w-[160px] h-[250px] sm:h-[280px] md:h-[320px] lg:h-[350px] group overflow-visible cursor-pointer",children:[h.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-0 h-[172px] sm:h-[197px] md:h-[222px] lg:h-[246.753px] w-[120px] sm:w-[136px] md:w-[148px] lg:w-[160px] rounded-sm shadow-[0px_4px_12px_0px_rgba(0,0,0,0.1)] transition-all duration-[400ms] ease-out group-hover:top-[-12px] group-hover:sm:top-[-14px] group-hover:md:top-[-16px] group-hover:lg:top-[-18px] group-hover:h-[176px] group-hover:sm:h-[202px] group-hover:md:h-[227px] group-hover:lg:h-[253px] group-hover:w-[123px] group-hover:sm:w-[139px] group-hover:md:w-[152px] group-hover:lg:w-[164px] group-hover:shadow-none",children:h.jsx("img",{alt:`${n.title} by ${n.author}`,className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-sm size-full",src:n.coverImage})}),h.jsxs("div",{className:"absolute top-[175px] sm:top-[200px] md:top-[225px] lg:top-[250px] left-1/2 -translate-x-1/2 w-[130px] sm:w-[140px] md:w-[150px] lg:w-[160px] flex flex-col items-center text-center leading-[0] opacity-0 transition-opacity duration-[400ms] ease-out group-hover:opacity-100",children:[h.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-medium justify-center relative shrink-0 text-base text-black",style:{fontVariationSettings:"'wdth' 100"},children:h.jsx("p",{className:"leading-normal line-clamp-2",children:n.title})}),h.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center relative shrink-0 text-base text-gray-500",style:{fontVariationSettings:"'wdth' 100"},children:h.jsx("p",{className:"leading-normal",children:n.author})}),h.jsxs("p",{className:"font-['DM_Sans:Medium','Noto_Sans_Symbols2:Regular',sans-serif] leading-normal not-italic relative shrink-0 text-[14px] sm:text-[15px] md:text-[16px] lg:text-[17px] text-black text-nowrap",children:[h.jsx("span",{className:"text-gray-500",children:"".repeat(n.rating)}),h.jsx("span",{className:"text-gray-200",children:"".repeat(5-n.rating)})]})]})]})}function RV(n){return n.split(/\n*-{3,}\n*/g).flatMap((t,r)=>{const s=[],i=t.trim();if(!i)return s;r>0&&s.push(h.jsx("div",{className:"w-full h-px bg-black/10 my-10"},`hr-${r}`));const a=/(\*\*[^*]+\*\*|\*[^*]+\*|<b>[^<]+<\/b>|<i>[^<]+<\/i>)/g;return i.split(a).forEach((u,d)=>{if(!u)return;const f=`${r}-${d}`;u.startsWith("**")&&u.endsWith("**")?s.push(h.jsx("strong",{children:u.slice(2,-2)},f)):u.startsWith("*")&&u.endsWith("*")&&!u.startsWith("**")?s.push(h.jsx("em",{children:u.slice(1,-1)},f)):u.startsWith("<b>")&&u.endsWith("</b>")?s.push(h.jsx("strong",{children:u.slice(3,-4)},f)):u.startsWith("<i>")&&u.endsWith("</i>")?s.push(h.jsx("em",{children:u.slice(3,-4)},f)):s.push(h.jsx("span",{children:u},f))}),s})}function PV({book:n,onClose:e}){const[t,r]=L.useState(!1);$a();const s=()=>{r(!0),setTimeout(()=>{e()},200)};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:`fixed inset-0 z-40 ${t?"animate-overlay-out":"animate-overlay-in"}`,style:{backgroundImage:"linear-gradient(90deg, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.05) 100%), linear-gradient(90deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.25) 100%)"},onClick:s}),h.jsxs("div",{className:`fixed left-1/2 top-1/2 z-50 flex flex-col gap-6 sm:gap-8 md:gap-10 p-6 sm:p-10 md:p-16 lg:p-20 rounded-2xl w-[calc(100vw-32px)] sm:w-[calc(100vw-80px)] md:w-[min(1137px,90vw)] max-h-[80vh] sm:max-h-[90vh] overflow-y-auto bg-white border border-[rgba(0,0,0,0.1)] shadow-[0px_4px_36px_0px_rgba(0,0,0,0.15)] ${t?"animate-modal-scale-out":"animate-modal-scale-in"}`,children:[h.jsxs("div",{className:"flex flex-col sm:flex-row gap-8 sm:gap-9 md:gap-11 w-full",children:[h.jsx("div",{className:"w-[142px] h-[219px] shrink-0 mx-auto sm:mx-0 group cursor-pointer",children:h.jsx("img",{alt:`${n.title} by ${n.author}`,className:"w-full h-full object-cover rounded-md shadow-[0px_4px_12px_0px_rgba(0,0,0,0.1)] transition-transform duration-300 group-hover:rotate-[1deg]",src:n.coverImage})}),h.jsxs("div",{className:"flex flex-col gap-6 sm:gap-7 md:gap-8 flex-1 text-center sm:text-left",children:[h.jsxs("div",{className:"flex flex-col gap-0.5",children:[h.jsx("h2",{className:"font-['SF_Pro:Regular',sans-serif] font-medium text-xl text-black",style:{fontVariationSettings:"'wdth' 100"},children:n.title}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-lg text-gray-500",style:{fontVariationSettings:"'wdth' 100"},children:n.author})]}),h.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[n.rating>0&&h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-6 md:gap-8 lg:gap-10 items-center sm:items-center",children:[h.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400 sm:w-[88px] shrink-0",style:{fontVariationSettings:"'wdth' 100"},children:"Rating"}),h.jsxs("span",{className:"font-['DM_Sans:Medium','Noto_Sans_Symbols2:Regular',sans-serif] text-lg sm:text-[19px] md:text-xl",children:[h.jsx("span",{className:"text-gray-600",children:"".repeat(n.rating)}),h.jsx("span",{className:"text-gray-200",children:"".repeat(5-n.rating)})]})]}),(n.isFavorite||n.year)&&h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-6 md:gap-8 lg:gap-10 items-center sm:items-center",children:[h.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400 sm:w-[88px] shrink-0",style:{fontVariationSettings:"'wdth' 100"},children:"Shelf"}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.isFavorite&&h.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full font-medium font-['SF_Pro:Regular',sans-serif] text-base sm:text-[16px] text-gray-600",style:{fontVariationSettings:"'wdth' 100"},children:"favorites"}),n.year&&h.jsx("span",{className:"bg-gray-100 px-3 py-1 rounded-full font-medium font-['SF_Pro:Regular',sans-serif] text-base sm:text-[16px] text-gray-600",style:{fontVariationSettings:"'wdth' 100"},children:n.year})]})]}),n.dateRead&&h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-6 md:gap-8 lg:gap-10 items-center sm:items-center",children:[h.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400 sm:w-[88px] shrink-0",style:{fontVariationSettings:"'wdth' 100"},children:"Date Read"}),h.jsx("span",{className:"font-['SF_Pro:Regular',sans-serif] text-base text-gray-600",style:{fontVariationSettings:"'wdth' 100"},children:new Date(n.dateRead).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]}),n.review&&h.jsx("div",{className:"w-full bg-gray-200",style:{height:"1px",flexShrink:0}}),n.review&&h.jsxs("div",{className:"flex flex-col gap-4 -mt-2 sm:gap-6 w-full",children:[h.jsx("span",{className:"font-['SF_Pro:Medium',sans-serif] font-medium text-base text-gray-400",style:{fontVariationSettings:"'wdth' 100"},children:"Review"}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-lg text-black leading-relaxed whitespace-pre-wrap",style:{fontVariationSettings:"'wdth' 100"},children:RV(n.review)})]})]})]})}function DV({className:n=""}){return h.jsx("svg",{className:n,width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M9 1V17M1 9H17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}function NV({className:n=""}){return h.jsx("svg",{className:n,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{d:"M18.5 1.5L9 11M18.5 1.5L12.5 18.5L9 11M18.5 1.5L1.5 7.5L9 11",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}function jV({className:n=""}){return h.jsxs("svg",{className:n,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[h.jsx("circle",{cx:"10",cy:"10",r:"8.5",stroke:"currentColor",strokeWidth:"1.5"}),h.jsx("circle",{cx:"7",cy:"8",r:"1.25",fill:"currentColor"}),h.jsx("circle",{cx:"13",cy:"8",r:"1.25",fill:"currentColor"}),h.jsx("path",{d:"M6.5 12.5C7 13.5 8.3 14.5 10 14.5C11.7 14.5 13 13.5 13.5 12.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function OV({onClose:n,onAddBook:e}){const[t,r]=L.useState(""),[s,i]=L.useState(!1),a=()=>{t.trim()&&(e(t),i(!0),setTimeout(()=>{r(""),i(!1),n()},2e3))},l=u=>{u.key==="Enter"&&!s&&a()};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"fixed inset-0 z-40",onClick:n}),h.jsxs("div",{className:"absolute right-0 top-[calc(100%+12px)] z-50 bg-white rounded-[16px] w-[calc(100vw-40px)] sm:w-[420px] max-w-[420px] animate-modal-in",children:[h.jsx("div",{"aria-hidden":"true",className:"absolute border border-gray-200 border-solid inset-0 pointer-events-none rounded-[16px] shadow-sm"}),h.jsxs("div",{className:"content-stretch flex flex-col gap-4 items-start p-[24px] relative w-full",children:[h.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center leading-[0] relative shrink-0 text-lg text-black w-full",style:{fontVariationSettings:"'wdth' 100"},children:h.jsxs("p",{className:"leading-[25px]",children:["Have a book suggestion?",h.jsx("br",{}),h.jsx("span",{className:"text-gray-500",children:"Drop it here! I'll check it out :) "})]})}),h.jsxs("div",{className:"content-stretch flex gap-2.5 items-center relative shrink-0 w-full",children:[h.jsxs("div",{className:"basis-0 bg-[#f5f5f5] grow h-[40px] min-h-px min-w-px relative rounded-[999px] shrink-0",children:[h.jsx("div",{"aria-hidden":"true",className:`absolute border-[1.5px] border-solid inset-0 pointer-events-none rounded-[999px] transition-colors duration-300 ${s?"border-[rgba(0,0,0,0.1)]":"border-[#2883de]"}`}),h.jsx("div",{className:"flex flex-row items-center size-full",children:h.jsx("div",{className:"content-stretch flex items-center px-[14px] relative size-full",children:s?h.jsx("div",{className:"content-stretch flex items-center relative shrink-0",children:h.jsx("div",{className:"flex flex-col font-['SF_Pro:Regular',sans-serif] font-normal justify-center relative shrink-0 text-[15px] text-[#2883de] text-nowrap transition-opacity duration-300",style:{fontVariationSettings:"'wdth' 100"},children:h.jsx("p",{children:"Thank you!"})})}):h.jsx("input",{type:"text",value:t,onChange:u=>r(u.target.value),onKeyDown:l,placeholder:"",className:"w-full bg-transparent outline-none font-['SF_Pro:Regular',sans-serif] font-normal text-[15px] text-[rgba(0,0,0,0.8)] transition-opacity duration-300",style:{fontVariationSettings:"'wdth' 100"},autoFocus:!0})})})]}),h.jsx("button",{onClick:a,disabled:!t.trim()||s,className:`flex items-center justify-center rounded-full shrink-0 size-[40px] transition-all duration-300 ${s?"bg-[#2883de]":"bg-[#2883de] hover:bg-[#2070ba]"} disabled:opacity-50 disabled:cursor-not-allowed`,children:h.jsx("div",{className:"flex items-center justify-center text-white",children:s?h.jsx(jV,{className:"w-[18px] h-[18px]"}):h.jsx(NV,{className:"w-[18px] h-[18px]"})})})]})]})]})]})}const MV={id:"library",title:"Personal Library",year:"2025",description:"My dream digital bookshelf",imageSrc:"https://image.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo/thumbnail.png",videoSrc:"https://stream.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo.m3u8",xLink:"https://x.com/michelletliu/status/1981030966044061894",tryItOutHref:"/library",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]};function FV(n){let e="";return n.cover?.asset?e=ze(n.cover).width(400).url():n.externalCoverUrl&&(e=n.externalCoverUrl),{id:n._id,title:n.title,author:n.author||"Unknown Author",coverImage:e,rating:n.rating||0,year:n.year,isFavorite:n.isLibraryFavorite||!1,goodreadsUrl:n.goodreadsUrl,review:n.review,dateRead:n.dateRead}}function BV(){const n=Dr(),e=ig("library",MV),[t,r]=L.useState([]),[s,i]=L.useState([{value:"favorites",label:"favorites",isFavorites:!0}]),[a,l]=L.useState("favorites"),[u,d]=L.useState(null),[f,m]=L.useState(!1),[g,x]=L.useState(!1),[y,w]=L.useState(!1),[b,E]=L.useState(!1),[T,_]=L.useState(!0),[A,I]=L.useState(!0),N=L.useRef(null),P=L.useRef(null);L.useEffect(()=>{g?requestAnimationFrame(()=>{w(!0)}):w(!1)},[g]),L.useEffect(()=>{function B(q){P.current&&!P.current.contains(q.target)&&x(!1)}return g&&document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[g]),L.useEffect(()=>{async function B(){try{const q=Ye("library:books"),ie=Ye("library:years"),[te,re]=await Promise.all([q?Promise.resolve(q):it.fetch(XT),ie?Promise.resolve(ie):it.fetch(ZT)]),ee=te.map(FV);r(ee);const Q=[{value:"favorites",label:"favorites",isFavorites:!0},{value:"all",label:"all",isAll:!0},...re.map(G=>({value:G,label:G}))];i(Q)}catch(q){console.error("Error fetching books:",q)}finally{I(!1)}}B()},[]);const O=a==="all"?t:a==="favorites"?t.filter(B=>B.isFavorite):t.filter(B=>B.year===a);L.useEffect(()=>{const B=setTimeout(()=>{_(!1)},50);return()=>clearTimeout(B)},[]);const M=()=>{E(!0),setTimeout(()=>{n("/")},280)},D=B=>{console.log("Book suggestion:",B)};return h.jsxs(h.Fragment,{children:[h.jsx(sg,{project:e}),h.jsx("div",{className:"absolute top-0 left-0 pt-8 px-8 md:px-16 z-10",children:h.jsx("button",{ref:N,onClick:M,className:"cursor-pointer transition-opacity duration-200 hover:opacity-80","aria-label":"Go back to home",children:h.jsx("img",{src:Ia,alt:"Michelle Liu Logo",className:"size-[44px] object-contain"})})}),h.jsxs("div",{className:`relative min-h-screen w-full bg-white transition-all ${b?"opacity-0 scale-[0.985]":T?"opacity-0 scale-[1.01]":"opacity-100 scale-100"}`,style:{backgroundImage:"linear-gradient(90deg, rgba(0, 0, 0, 0.02) 0%, rgba(0, 0, 0, 0.02) 100%), linear-gradient(90deg, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 100%)",transitionDuration:b?"280ms":"300ms",transitionTimingFunction:b?"cubic-bezier(0.4, 0, 0.2, 1)":"ease-out"},children:[h.jsx("div",{className:"pt-8 px-8 md:px-16",children:h.jsxs("div",{className:"flex flex-col gap-10 md:gap-12 items-start pb-5 md:pb-6",children:[h.jsx("div",{className:"size-[44px] shrink-0"}),h.jsxs("div",{className:"flex items-start justify-between w-full",children:[h.jsxs("div",{className:"flex flex-col gap-3 items-start shrink-0",children:[h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] font-normal leading-[34px] relative shrink-0 text-[28px] text-black",style:{fontVariationSettings:"'wdth' 100"},children:"library"}),h.jsxs("div",{className:"relative",ref:P,children:[h.jsxs("button",{onClick:()=>x(!g),className:"flex shrink-0 items-center gap-1.5 rounded-full px-3 py-1.5 transition-colors cursor-pointer bg-gray-500/10",children:[h.jsxs("span",{className:"font-['Figtree',sans-serif] font-medium text-base tracking-[0.01em] whitespace-nowrap text-gray-500",children:[a,h.jsxs("span",{className:"text-gray-400",children:[" (",O.length,")"]})]}),h.jsx("svg",{className:J("w-3 h-3 text-gray-400 transition-transform duration-200",g&&"rotate-180"),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),h.jsx("div",{className:J("absolute left-0 top-[calc(100%+4px)] bg-white rounded-lg shadow-lg border border-gray-100 z-50 w-36 transition-all duration-200 ease-out max-h-[300px] overflow-y-auto",g?"pointer-events-auto":"pointer-events-none",y?"opacity-100 translate-y-0":"opacity-0 -translate-y-1"),children:h.jsx("div",{className:"flex flex-col py-1.5 px-1.5",children:s.map(B=>{const q=a===B.value,ie=B.isFavorites?t.filter(te=>te.isFavorite).length:B.isAll?t.length:t.filter(te=>te.year===B.value).length;return h.jsx("button",{onClick:()=>{l(B.value),x(!1)},className:J("flex items-center px-3 py-1.5 rounded-md transition-colors text-left",q?"bg-gray-100":"hover:bg-gray-50"),children:h.jsxs("span",{className:J("font-['Figtree',sans-serif] font-medium text-base tracking-[0.01em]",q?"text-gray-600":"text-gray-400"),children:[B.label,h.jsxs("span",{className:q?"text-gray-400":"text-gray-300",children:[" ","(",ie,")"]})]})},B.value)})})})]})]}),h.jsxs("div",{className:"relative",children:[h.jsx("button",{onClick:()=>m(!f),className:"bg-gray-500/10 content-stretch flex items-center justify-center rounded-full size-[36px] hover:bg-[rgba(0,0,0,0.1)] transition-all duration-300",children:h.jsx("div",{className:`flex items-center justify-center text-gray-400 transition-transform duration-300 ${f?"rotate-45":"rotate-0"}`,children:h.jsx(DV,{className:"w-[14px] h-[14px]"})})}),f&&h.jsx(OV,{onClose:()=>m(!1),onAddBook:D})]})]})]})}),h.jsx("div",{className:"pt-6 md:pt-8 px-8 md:px-16 pb-[60px] md:pb-[100px]",children:h.jsx("div",{children:A?h.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:h.jsxs("div",{className:"flex flex-col items-center gap-4",children:[h.jsx("div",{className:"w-8 h-8 border-2 border-[#e7e5e4] border-t-[#57534e] rounded-full animate-spin"}),h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-[16px] text-[rgba(0,0,0,0.4)]",children:"Loading books..."})]})}):O.length===0?h.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:h.jsx("p",{className:"font-['SF_Pro:Regular',sans-serif] text-[18px] text-[rgba(0,0,0,0.4)]",children:"No books on this shelf yet."})}):h.jsx("div",{className:"grid grid-cols-[repeat(3,auto)] md:grid-cols-[repeat(6,auto)] gap-y-14 sm:gap-y-12 md:gap-y-8 justify-between",children:O.map(B=>h.jsx(LV,{book:B,onClick:()=>d(B)},B.id))})})})]}),u&&h.jsx(PV,{book:u,onClose:()=>d(null)})]})}const UV="data:image/svg+xml,%3csvg%20width='38'%20height='63'%20viewBox='0%200%2038%2063'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.96875%2062.0215C5.58594%2062.0215%203.66211%2061.3184%202.19727%2059.9121C0.732422%2058.5254%200%2056.6895%200%2054.4043V7.61719C0%205.33203%200.732422%203.49609%202.19727%202.10938C3.66211%200.703125%205.58594%200%207.96875%200H29.6777C32.0801%200%2034.0039%200.703125%2035.4492%202.10938C36.9141%203.49609%2037.6465%205.33203%2037.6465%207.61719V54.4043C37.6465%2056.6895%2036.9141%2058.5254%2035.4492%2059.9121C34.0039%2061.3184%2032.0801%2062.0215%2029.6777%2062.0215H7.96875ZM8.58398%2057.3047H29.0918C30.3223%2057.3047%2031.2695%2056.9824%2031.9336%2056.3379C32.5977%2055.7129%2032.9297%2054.8145%2032.9297%2053.6426V8.37891C32.9297%207.20703%2032.5977%206.30859%2031.9336%205.68359C31.2695%205.03906%2030.3223%204.7168%2029.0918%204.7168H8.58398C7.33398%204.7168%206.37695%205.03906%205.71289%205.68359C5.04883%206.30859%204.7168%207.20703%204.7168%208.37891V53.6426C4.7168%2054.8145%205.04883%2055.7129%205.71289%2056.3379C6.37695%2056.9824%207.33398%2057.3047%208.58398%2057.3047ZM12.627%2055.166C12.2363%2055.166%2011.9043%2055.0391%2011.6309%2054.7852C11.377%2054.5312%2011.25%2054.1992%2011.25%2053.7891C11.25%2053.3789%2011.377%2053.0469%2011.6309%2052.793C11.9043%2052.5586%2012.2363%2052.4414%2012.627%2052.4414H25.0781C25.4688%2052.4414%2025.791%2052.5586%2026.0449%2052.793C26.2988%2053.0469%2026.4258%2053.3789%2026.4258%2053.7891C26.4258%2054.1992%2026.2988%2054.5312%2026.0449%2054.7852C25.791%2055.0391%2025.4688%2055.166%2025.0781%2055.166H12.627ZM15.293%2010.9277C14.707%2010.9277%2014.209%2010.7324%2013.7988%2010.3418C13.4082%209.93164%2013.2129%209.43359%2013.2129%208.84766C13.2129%208.28125%2013.4082%207.80273%2013.7988%207.41211C14.209%207.00195%2014.707%206.79688%2015.293%206.79688H22.3828C22.9492%206.79688%2023.4277%207.00195%2023.8184%207.41211C24.2285%207.80273%2024.4336%208.28125%2024.4336%208.84766C24.4336%209.43359%2024.2285%209.93164%2023.8184%2010.3418C23.4277%2010.7324%2022.9492%2010.9277%2022.3828%2010.9277H15.293Z'%20fill='%238E8E93'/%3e%3c/svg%3e",$V="data:image/svg+xml,%3csvg%20width='22'%20height='27'%20viewBox='0%200%2022%2027'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M5.10254%2026.0986C3.4668%2026.0986%202.2054%2025.6551%201.31836%2024.7681C0.439453%2023.8892%200%2022.6318%200%2020.9961V11.5967C0%209.9528%200.439453%208.69141%201.31836%207.8125C2.2054%206.93359%203.4668%206.49414%205.10254%206.49414H7.56836V8.45947H5.10254C4.10156%208.45947%203.32845%208.7321%202.7832%209.27734C2.23796%209.82259%201.96533%2010.5957%201.96533%2011.5967V20.9961C1.96533%2021.9971%202.23796%2022.7702%202.7832%2023.3154C3.32845%2023.8607%204.10156%2024.1333%205.10254%2024.1333H16.5527C17.5618%2024.1333%2018.339%2023.8607%2018.8843%2023.3154C19.4295%2022.7702%2019.7021%2021.9971%2019.7021%2020.9961V11.5967C19.7021%2010.5957%2019.4295%209.82259%2018.8843%209.27734C18.339%208.7321%2017.5618%208.45947%2016.5527%208.45947H14.0869V6.49414H16.5527C18.1966%206.49414%2019.458%206.93359%2020.3369%207.8125C21.224%208.69141%2021.6675%209.9528%2021.6675%2011.5967V20.9961C21.6675%2022.6318%2021.224%2023.8892%2020.3369%2024.7681C19.458%2025.6551%2018.1966%2026.0986%2016.5527%2026.0986H5.10254ZM10.8398%200C11.1003%200%2011.3241%200.0935872%2011.5112%200.280762C11.7065%200.467936%2011.8042%200.687663%2011.8042%200.939941V13.3545L11.6577%2016.6504C11.6414%2016.8701%2011.556%2017.0614%2011.4014%2017.2241C11.2467%2017.3869%2011.0596%2017.4683%2010.8398%2017.4683C10.612%2017.4683%2010.4207%2017.3869%2010.2661%2017.2241C10.1115%2017.0614%2010.026%2016.8701%2010.0098%2016.6504L9.86328%2013.3545V0.939941C9.86328%200.687663%209.95687%200.467936%2010.144%200.280762C10.3394%200.0935872%2010.5713%200%2010.8398%200ZM6.68945%2012.1582C6.96615%2012.1582%207.18994%2012.2559%207.36084%2012.4512L9.25293%2014.4653L10.8398%2016.1377L12.4146%2014.4653L14.3066%2012.4512C14.4694%2012.2559%2014.6891%2012.1582%2014.9658%2012.1582C15.2181%2012.1582%2015.4297%2012.2396%2015.6006%2012.4023C15.7715%2012.5651%2015.8569%2012.7686%2015.8569%2013.0127C15.8569%2013.2487%2015.7593%2013.4644%2015.564%2013.6597L11.5356%2017.5415C11.4136%2017.6636%2011.2956%2017.749%2011.1816%2017.7979C11.0758%2017.8385%2010.9619%2017.8589%2010.8398%2017.8589C10.7096%2017.8589%2010.5876%2017.8385%2010.4736%2017.7979C10.3678%2017.749%2010.2539%2017.6636%2010.1318%2017.5415L6.10352%2013.6597C5.9082%2013.4644%205.81055%2013.2487%205.81055%2013.0127C5.81055%2012.7686%205.89193%2012.5651%206.05469%2012.4023C6.22559%2012.2396%206.43717%2012.1582%206.68945%2012.1582Z'%20fill='%23333333'/%3e%3c/svg%3e",VV="data:image/svg+xml,%3csvg%20width='26'%20height='26'%20viewBox='0%200%2026%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M15.2832%2025.5737C14.7135%2025.5737%2014.3026%2025.3703%2014.0503%2024.9634C13.798%2024.5565%2013.5824%2024.0479%2013.4033%2023.4375L10.8398%2014.7339L2.02637%2012.146C1.44043%2011.967%200.956217%2011.7554%200.57373%2011.5112C0.191243%2011.259%200%2010.8521%200%2010.2905C0%209.85107%200.174967%209.47266%200.524902%209.15527C0.874837%208.83789%201.30615%208.58154%201.81885%208.38623L22.8149%200.341797C23.0998%200.236003%2023.3643%200.154622%2023.6084%200.0976562C23.8607%200.0325521%2024.0885%200%2024.292%200C24.6908%200%2025.0041%200.113932%2025.2319%200.341797C25.4598%200.569661%2025.5737%200.882975%2025.5737%201.28174C25.5737%201.49333%2025.5412%201.72119%2025.4761%201.96533C25.4191%202.20947%2025.3377%202.47396%2025.2319%202.75879L17.2363%2023.645C17.0085%2024.231%2016.7358%2024.6989%2016.4185%2025.0488C16.1011%2025.3988%2015.7227%2025.5737%2015.2832%2025.5737ZM11.3892%2012.8784L19.7876%204.47998C20.1213%204.14632%2020.516%203.79232%2020.9717%203.41797C21.4274%203.04362%2021.8587%202.69368%2022.2656%202.36816C21.8099%202.57975%2021.346%202.79948%2020.874%203.02734C20.4102%203.24707%2019.9341%203.45052%2019.4458%203.6377L2.94189%209.8877C2.85238%209.92025%202.79134%209.95687%202.75879%209.99756C2.72624%2010.0301%202.70996%2010.0667%202.70996%2010.1074C2.70996%2010.1481%202.72624%2010.1847%202.75879%2010.2173C2.79948%2010.2498%202.86865%2010.2783%202.96631%2010.3027L11.3892%2012.8784ZM15.4785%2022.8882C15.5192%2022.8882%2015.5558%2022.8678%2015.5884%2022.8271C15.6209%2022.7865%2015.6535%2022.7214%2015.686%2022.6318L21.936%206.12793C22.1232%205.63151%2022.3307%205.1473%2022.5586%204.67529C22.7865%204.20329%2023.0062%203.73535%2023.2178%203.27148C22.8923%203.68652%2022.5382%204.12598%2022.1558%204.58984C21.7814%205.05371%2021.4274%205.45247%2021.0938%205.78613L12.6953%2014.1846L15.271%2022.6074C15.3035%2022.7051%2015.332%2022.7743%2015.3564%2022.8149C15.389%2022.8638%2015.4297%2022.8882%2015.4785%2022.8882Z'%20fill='%23333333'/%3e%3c/svg%3e",Pw="data:image/svg+xml,%3csvg%20width='22'%20height='21'%20viewBox='0%200%2022%2021'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.95898%2020.8618C7.47884%2020.8618%207.05566%2020.6258%206.68945%2020.1538L0.354004%2012.085C0.231934%2011.9385%200.142415%2011.792%200.0854492%2011.6455C0.0284831%2011.4909%200%2011.3403%200%2011.1938C0%2010.8602%200.109863%2010.5876%200.32959%2010.376C0.549316%2010.1562%200.830078%2010.0464%201.17188%2010.0464C1.57878%2010.0464%201.92871%2010.2458%202.22168%2010.6445L7.91016%2018.0908L18.8721%200.622559C19.0186%200.394694%2019.1691%200.236003%2019.3237%200.146484C19.4784%200.0488281%2019.6777%200%2019.9219%200C20.2555%200%2020.5241%200.101725%2020.7275%200.305176C20.931%200.508626%2021.0327%200.777181%2021.0327%201.11084C21.0327%201.25732%2021.0083%201.40381%2020.9595%201.55029C20.9106%201.68864%2020.8333%201.84326%2020.7275%202.01416L9.19189%2020.1782C8.89079%2020.634%208.47982%2020.8618%207.95898%2020.8618Z'%20fill='white'/%3e%3c/svg%3e",GV="data:image/svg+xml,%3csvg%20width='36'%20height='45'%20viewBox='0%200%2036%2045'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M10.9375%209.51172C10.4948%209.51172%2010.1172%209.36849%209.80469%209.08203C9.49219%208.78255%209.33594%208.40495%209.33594%207.94922C9.33594%207.51953%209.51172%207.13542%209.86328%206.79688L16.2695%200.605469C16.5169%200.371094%2016.7513%200.214844%2016.9727%200.136719C17.194%200.0455729%2017.4219%200%2017.6562%200C17.8906%200%2018.1185%200.0455729%2018.3398%200.136719C18.5612%200.214844%2018.7891%200.371094%2019.0234%200.605469L25.4492%206.79688C25.7878%207.13542%2025.957%207.51953%2025.957%207.94922C25.957%208.40495%2025.7943%208.78255%2025.4688%209.08203C25.1562%209.36849%2024.7786%209.51172%2024.3359%209.51172C23.8542%209.51172%2023.4505%209.32943%2023.125%208.96484L20.3516%205.99609L17.6562%202.73438L14.9609%205.99609L12.168%208.96484C11.8555%209.32943%2011.4453%209.51172%2010.9375%209.51172ZM17.6562%2029.0234C17.1615%2029.0234%2016.7318%2028.8477%2016.3672%2028.4961C16.0156%2028.1445%2015.8398%2027.7344%2015.8398%2027.2656V7.65625L16.1719%202.05078C16.1979%201.63411%2016.3477%201.28255%2016.6211%200.996094C16.9076%200.696615%2017.2526%200.546875%2017.6562%200.546875C18.0599%200.546875%2018.3984%200.696615%2018.6719%200.996094C18.9583%201.28255%2019.1146%201.63411%2019.1406%202.05078L19.4727%207.65625V27.2656C19.4727%2027.7344%2019.2904%2028.1445%2018.9258%2028.4961C18.5742%2028.8477%2018.151%2029.0234%2017.6562%2029.0234ZM8.37891%2044.7656C5.69661%2044.7656%203.6263%2044.0365%202.16797%2042.5781C0.722656%2041.1328%200%2039.069%200%2036.3867V21.3281C0%2018.6328%200.722656%2016.569%202.16797%2015.1367C3.6263%2013.6914%205.69661%2012.9688%208.37891%2012.9688H12.1484V16.7969H8.47656C6.99219%2016.7969%205.84635%2017.2005%205.03906%2018.0078C4.24479%2018.8021%203.84766%2019.9479%203.84766%2021.4453V36.2891C3.84766%2037.7734%204.24479%2038.9193%205.03906%2039.7266C5.84635%2040.5339%206.99219%2040.9375%208.47656%2040.9375H26.8164C28.3138%2040.9375%2029.4596%2040.5339%2030.2539%2039.7266C31.0612%2038.9193%2031.4648%2037.7734%2031.4648%2036.2891V21.4453C31.4648%2019.9479%2031.0612%2018.8021%2030.2539%2018.0078C29.4596%2017.2005%2028.3138%2016.7969%2026.8164%2016.7969H23.1445V12.9688H26.9141C29.6094%2012.9688%2031.6797%2013.6914%2033.125%2015.1367C34.5833%2016.569%2035.3125%2018.6328%2035.3125%2021.3281V36.3867C35.3125%2039.069%2034.5833%2041.1328%2033.125%2042.5781C31.6797%2044.0365%2029.6094%2044.7656%2026.9141%2044.7656H8.37891Z'%20fill='black'/%3e%3c/svg%3e",HV="/assets/instagram-BAfPHvRX.png",KV="/assets/twitter-1-SPtnoy.png",zV="/assets/linkedin-D3pGG8zE.png",WV="/assets/messages-tmRng59Q.png",qV="/assets/calendar-BZ6cGAyF.png",YV="/assets/slack-DrWrcsRW.png",QV="/assets/notes-B6EEn3ES.png",XV="/assets/mail-miar2BXo.png",ZV="/assets/notion-hvFiL_BP.png",JV="/assets/youtube-SzevVajt.png",eG="/assets/netflix-1F7-iVFf.png",tG="/assets/spotify-DfBfDYWl.png",nG={id:"screentime",title:"Screentime Receipt",year:"2025",description:"A receipt for your daily or weekly screentime.",imageSrc:"https://image.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI/thumbnail.png",videoSrc:"https://stream.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI.m3u8",xLink:"https://x.com/michelletliu/status/2000987498550383032",tryItOutHref:"/screentime",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]},Bn={instagram:HV,twitter:KV,linkedin:zV,messages:WV,calendar:qV,slack:YV,notes:QV,mail:XV,notion:ZV,youtube:JV,netflix:eG,spotify:tG},Am={cellular:"M19.2 1.14623C19.2 0.513183 18.7224 0 18.1333 0H17.0667C16.4776 0 16 0.513183 16 1.14623V11.0802C16 11.7132 16.4776 12.2264 17.0667 12.2264H18.1333C18.7224 12.2264 19.2 11.7132 19.2 11.0802V1.14623ZM11.7659 2.44528H12.8326C13.4217 2.44528 13.8992 2.97078 13.8992 3.61902V11.0527C13.8992 11.7009 13.4217 12.2264 12.8326 12.2264H11.7659C11.1768 12.2264 10.6992 11.7009 10.6992 11.0527V3.61902C10.6992 2.97078 11.1768 2.44528 11.7659 2.44528ZM7.43411 5.09433H6.36745C5.77834 5.09433 5.30078 5.62652 5.30078 6.28301V11.0377C5.30078 11.6942 5.77834 12.2264 6.36745 12.2264H7.43411C8.02322 12.2264 8.50078 11.6942 8.50078 11.0377V6.28301C8.50078 5.62652 8.02322 5.09433 7.43411 5.09433ZM2.13333 7.53962H1.06667C0.477563 7.53962 0 8.06421 0 8.71132V11.0547C0 11.7018 0.477563 12.2264 1.06667 12.2264H2.13333C2.72244 12.2264 3.2 11.7018 3.2 11.0547V8.71132C3.2 8.06421 2.72244 7.53962 2.13333 7.53962Z",wifi:"M8.5713 2.46628C11.0584 2.46639 13.4504 3.38847 15.2529 5.04195C15.3887 5.1696 15.6056 5.16799 15.7393 5.03834L17.0368 3.77487C17.1045 3.70911 17.1422 3.62004 17.1417 3.52735C17.1411 3.43467 17.1023 3.34603 17.0338 3.28104C12.3028 -1.09368 4.83907 -1.09368 0.108056 3.28104C0.039524 3.34598 0.000639766 3.4346 7.82398e-06 3.52728C-0.000624118 3.61996 0.0370483 3.70906 0.104689 3.77487L1.40255 5.03834C1.53615 5.16819 1.75327 5.1698 1.88893 5.04195C3.69167 3.38836 6.08395 2.46628 8.5713 2.46628ZM8.56795 6.68656C9.92527 6.68647 11.2341 7.19821 12.2403 8.12234C12.3763 8.2535 12.5907 8.25065 12.7234 8.11593L14.0106 6.79663C14.0784 6.72742 14.1161 6.63355 14.1151 6.53599C14.1141 6.43844 14.0746 6.34536 14.0054 6.27757C10.9416 3.38672 6.19688 3.38672 3.13305 6.27757C3.06384 6.34536 3.02435 6.43849 3.02345 6.53607C3.02254 6.63365 3.06028 6.72752 3.12822 6.79663L4.41513 8.11593C4.54778 8.25065 4.76215 8.2535 4.89823 8.12234C5.90368 7.19882 7.21152 6.68713 8.56795 6.68656ZM11.0924 9.48011C11.0943 9.58546 11.0572 9.68703 10.9899 9.76084L8.81327 12.2156C8.74946 12.2877 8.66247 12.3283 8.5717 12.3283C8.48093 12.3283 8.39394 12.2877 8.33013 12.2156L6.1531 9.76084C6.08585 9.68697 6.04886 9.58537 6.05085 9.48002C6.05284 9.37467 6.09365 9.27491 6.16364 9.20429C7.55374 7.8904 9.58966 7.8904 10.9798 9.20429C11.0497 9.27497 11.0904 9.37476 11.0924 9.48011Z",batteryCap:"M26 4.78113V8.8566C26.8047 8.51143 27.328 7.70847 27.328 6.81886C27.328 5.92926 26.8047 5.1263 26 4.78113"};function Un(n,e){return Math.floor(Math.random()*(e-n+1))+n}function Dw(n){const e=String(n.getMonth()+1).padStart(2,"0"),t=String(n.getDate()).padStart(2,"0"),r=String(n.getFullYear()).slice(-2);return`${e}/${t}/${r}`}function Im(n){const e=Math.floor(n/60),t=n%60;return e===0?`${t}m`:`${e}h ${t}m`}function Nw(n){const e=new Date,t=Dw(e);let r;if(n==="weekly"){const a=new Date(e);a.setDate(a.getDate()-7),r=Dw(a)}else r=t;const s=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),i=n==="weekly"?7:1;return{period:n,startDate:r,endDate:t,generatedTime:s,categories:[{name:"SOCIAL & COMMUNICATION",apps:[{name:"INSTAGRAM",category:"SOCIAL MEDIA",minutes:Un(30,180)*i,icon:Bn.instagram},{name:"TWITTER/X",category:"SOCIAL MEDIA",minutes:Un(20,120)*i,icon:Bn.twitter},{name:"LINKEDIN",category:"SOCIAL MEDIA",minutes:Un(40,200)*i,icon:Bn.linkedin},{name:"MESSAGES",category:"COMMUNICATION",minutes:Un(10,60)*i,icon:Bn.messages}]},{name:"WORK & PRODUCTIVITY",apps:[{name:"CALENDAR",category:"PRODUCTIVITY",minutes:Un(10,40)*i,icon:Bn.calendar},{name:"SLACK",category:"WORK",minutes:Un(60,180)*i,icon:Bn.slack},{name:"NOTES",category:"PRODUCTIVITY",minutes:Un(5,30)*i,icon:Bn.notes},{name:"MAIL",category:"WORK",minutes:Un(30,90)*i,icon:Bn.mail},{name:"NOTION",category:"PRODUCTIVITY",minutes:Un(20,80)*i,icon:Bn.notion}]},{name:"ENTERTAINMENT",apps:[{name:"YOUTUBE",category:"ENTERTAINMENT",minutes:Un(60,240)*i,icon:Bn.youtube},{name:"NETFLIX",category:"STREAMING",minutes:Un(30,150)*i,icon:Bn.netflix},{name:"SPOTIFY",category:"MUSIC",minutes:Un(60,300)*i,icon:Bn.spotify}]}]}}function rG(n){const e=n/60;return e<2?{main:"IMPRESSIVE!",message:"You're crushing it! "}:e<4?{main:"NICE WORK!",message:"You're doing great! "}:e<6?{main:"NOT BAD!",message:`Pretty good! 
Maybe add a walk to your day?`}:e<10?{main:"TIME FOR A BREAK!",message:"Go touch some grass "}:e<15?{main:"TIME FOR A BREAK!",message:"Your eyes need a rest! "}:e<20?{main:"EMERGENCY!",message:"Touch grass IMMEDIATELY "}:{main:"ARE YOU OKAY?",message:"There's a world outside! "}}function sG(){const n=new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!1});return h.jsxs("div",{className:"md:hidden",children:[h.jsx("div",{className:"absolute bg-gradient-to-b from-[#f3f4f6] from-[32.87%] h-[108px] left-1/2 to-transparent top-0 -translate-x-1/2 w-[402px] max-w-full"}),h.jsxs("div",{className:"absolute flex gap-[154px] items-center justify-center left-1/2 pb-[19px] pt-[21px] px-[16px] top-0 -translate-x-1/2 w-[402px] max-w-full",children:[h.jsx("div",{className:"basis-0 flex grow h-[22px] items-center justify-center min-h-px min-w-px pb-0 pt-[2px] px-0 relative shrink-0",children:h.jsx("p",{className:"font-mono font-semibold leading-[22px] relative shrink-0 text-[17px] text-black text-center text-nowrap",children:n})}),h.jsxs("div",{className:"basis-0 flex gap-[7px] grow h-[22px] items-center justify-center min-h-px min-w-px pb-0 pt-px px-0 relative shrink-0",children:[h.jsx("div",{className:"relative shrink-0 h-[12.226px] w-[19.2px]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 19.2 12.2264",children:h.jsx("path",{clipRule:"evenodd",d:Am.cellular,fill:"black",fillRule:"evenodd"})})}),h.jsx("div",{className:"relative shrink-0 h-[12.328px] w-[17.142px]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 17.1417 12.3283",children:h.jsx("path",{clipRule:"evenodd",d:Am.wifi,fill:"black",fillRule:"evenodd"})})}),h.jsx("div",{className:"h-[13px] relative shrink-0 w-[27.328px]",children:h.jsxs("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 27.328 13",children:[h.jsx("rect",{height:"12",opacity:"0.35",rx:"3.8",stroke:"black",width:"24",x:"0.5",y:"0.5"}),h.jsx("path",{d:Am.batteryCap,fill:"black",opacity:"0.4"}),h.jsx("rect",{fill:"black",height:"9",rx:"2.5",width:"21",x:"2",y:"2"})]})})]})]})]})}function iG({additionalClassNames:n=""}){return h.jsx("div",{className:`md:hidden absolute h-[34px] left-1/2 -translate-x-1/2 w-[400px] max-w-full ${n}`,children:h.jsx("div",{className:"absolute bottom-[8px] flex h-[5px] items-center justify-center left-1/2 -translate-x-1/2 w-[144px]",children:h.jsx("div",{className:"flex-none rotate-180 scale-y-[-1]",children:h.jsx("div",{className:"bg-black h-[5px] rounded-[100px] w-[144px]"})})})})}function aG({period:n,onPeriodChange:e,onGenerate:t,onUploadClick:r}){return h.jsxs("div",{className:"absolute flex flex-col items-center gap-3 justify-center size-full",children:[h.jsxs("div",{className:"bg-white flex flex-col gap-[24px] items-center px-[48px] py-[32px] rounded-[26px] shadow-[0px_2px_8px_rgba(0,0,0,0.1)] max-w-[90%]",children:[h.jsx("div",{className:"bg-[rgba(116,116,128,0.08)] flex flex-col items-center justify-center p-[10px] relative rounded-full shrink-0 size-[120px]",children:h.jsx("img",{src:UV,alt:"Phone",className:"w-[38px] h-[63px]"})}),h.jsxs("div",{className:"font-mono leading-[28px] relative shrink-0 text-[22px] text-black text-center text-nowrap",children:[h.jsx("p",{className:"mb-0",children:"SCREEN TIME"}),h.jsx("p",{children:"RECEIPT"})]}),h.jsx("div",{className:"flex items-start relative shrink-0",children:h.jsxs("div",{className:"bg-[rgba(118,118,128,0.12)] flex h-[36px] items-center justify-center overflow-clip px-[8px] py-[4px] relative rounded-[100px] shrink-0 w-[209px]",children:[h.jsx("button",{onClick:()=>e("daily"),className:"basis-0 grow h-full min-h-px min-w-px relative rounded-[7px] shrink-0 cursor-pointer",children:h.jsx("div",{className:"flex flex-row items-center size-full",children:h.jsxs("div",{className:"flex items-center px-[10px] py-[2px] relative size-full",children:[n==="daily"&&h.jsx("div",{className:"absolute bg-white inset-[0_-4.5px_0_-4px] rounded-[20px] shadow-[0px_2px_20px_rgba(0,0,0,0.06)]"}),h.jsx("p",{className:`basis-0 font-mono ${n==="daily"?"font-semibold":"font-medium"} grow leading-[18px] min-h-px min-w-px overflow-ellipsis overflow-hidden relative shrink-0 text-[14px] text-black text-center text-nowrap tracking-[-0.08px]`,children:"Daily"})]})})}),h.jsx("button",{onClick:()=>e("weekly"),className:"basis-0 grow h-full min-h-px min-w-px relative shrink-0 cursor-pointer",children:h.jsx("div",{className:"flex flex-row items-center size-full",children:h.jsxs("div",{className:"flex items-center px-[10px] py-[3px] relative size-full",children:[n==="weekly"&&h.jsx("div",{className:"absolute bg-white inset-[0_-4.5px_0_-4px] rounded-[20px] shadow-[0px_2px_20px_rgba(0,0,0,0.06)]"}),h.jsx("p",{className:`basis-0 font-mono ${n==="weekly"?"font-semibold":"font-medium"} grow leading-[18px] min-h-px min-w-px overflow-ellipsis overflow-hidden relative shrink-0 text-[14px] text-black text-center text-nowrap`,children:"Weekly"})]})})})]})}),h.jsx("div",{className:"flex flex-col gap-3",children:h.jsx("button",{onClick:t,className:"bg-zinc-900 flex items-center justify-center px-6 py-[10px] relative rounded-full shrink-0 cursor-pointer hover:bg-zinc-700 transition-colors w-full",children:h.jsx("p",{className:"font-mono leading-normal relative shrink-0 text-[15px] text-center text-nowrap text-white tracking-[0.75px]",children:"GENERATE"})})})]}),h.jsxs("button",{onClick:r,className:"flex items-center justify-center gap-3.5 px-6 py-2 relative shrink-0 cursor-pointer transition-colors group",children:[h.jsx("img",{src:GV,alt:"",className:"h-[15px] w-auto opacity-50 group-hover:opacity-70 transition-opacity"}),h.jsx("p",{className:"font-mono leading-normal relative shrink-0 text-[15px] text-center text-nowrap text-gray-500 group-hover:text-gray-700 tracking-[0.5px] transition-colors",children:"UPLOAD YOUR OWN DATA"})]})]})}function oG({appName:n,icon:e}){const t="relative shrink-0 size-[44px]";switch(n){case"INSTAGRAM":return h.jsx("div",{className:`${t} rounded-[12px]`,children:h.jsx("img",{alt:"",className:"absolute inset-0 max-w-none object-cover pointer-events-none rounded-[12px] size-full",src:e})});case"TWITTER/X":return h.jsx("div",{className:"h-[44.379px] relative rounded-[11.379px] shrink-0 w-[44px] overflow-hidden",children:h.jsx("img",{alt:"",className:"absolute h-[1225.64%] left-[-39.66%] max-w-none top-[-671.79%] w-[568.97%]",src:e})});case"LINKEDIN":return h.jsx("div",{className:`${t} rounded-[11px] overflow-hidden`,children:h.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-168.97%] max-w-none top-[-256.03%] w-[568.97%]",src:e})});case"MESSAGES":return h.jsx("div",{className:t,children:h.jsx("img",{alt:"",className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",src:e})});case"CALENDAR":return h.jsx("div",{className:`${t} rounded-[10.891px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] overflow-hidden`,children:h.jsx("img",{alt:"",className:"absolute h-[1419.8%] left-[-500.99%] max-w-none top-[-301.98%] w-[653.47%]",src:e})});case"SLACK":return h.jsx("div",{className:"h-[44px] relative rounded-[11.759px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] shrink-0 w-[44.379px] overflow-hidden",children:h.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-167.52%] max-w-none top-[-115.52%] w-[564.1%]",src:e})});case"NOTES":return h.jsx("div",{className:t,children:h.jsx("img",{alt:"",className:"absolute inset-0 max-w-none object-cover pointer-events-none size-full",src:e})});case"MAIL":return h.jsx("div",{className:"h-[44px] relative shrink-0 w-[44.25px] overflow-hidden",children:h.jsx("img",{alt:"",className:"absolute h-[814.77%] left-[-16.95%] max-w-none top-[-107.95%] w-[372.88%]",src:e})});case"NOTION":return h.jsx("div",{className:`${t} rounded-[11.327px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] overflow-hidden`,children:h.jsx("img",{alt:"",className:"absolute h-[1419.8%] left-[-351.49%] max-w-none top-[-301.98%] w-[653.47%]",src:e})});case"YOUTUBE":return h.jsx("div",{className:"h-[44px] relative rounded-[11.658px] shadow-[0px_2px_8px_rgba(0,0,0,0.15)] shrink-0 w-[43.624px] overflow-hidden",children:h.jsx("img",{alt:"",className:"absolute h-[1225.64%] left-[-300%] max-w-none top-[-811.11%] w-[568.97%]",src:e})});case"NETFLIX":return h.jsx("div",{className:"h-[43.254px] relative rounded-[11.186px] shrink-0 w-[44px] overflow-hidden",children:h.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-422.03%] max-w-none top-[-818.1%] w-[559.32%]",src:e})});case"SPOTIFY":return h.jsx("div",{className:"h-[43.254px] relative rounded-[10.814px] shrink-0 w-[44px] overflow-hidden",children:h.jsx("img",{alt:"",className:"absolute h-[1236.21%] left-[-294.07%] max-w-none top-[-115.52%] w-[559.32%]",src:e})});default:return h.jsx("div",{className:`${t} rounded-[12px] overflow-hidden`,children:h.jsx("img",{alt:"",className:"max-w-none object-cover pointer-events-none size-full",src:e})})}}function lG({data:n,onSave:e,onShare:t,onGenerateNew:r}){const[s,i]=L.useState(!1),[a,l]=L.useState(!1),[u,d]=L.useState(!1),f=L.useRef(null),m=n.categories.reduce((w,b)=>w+b.apps.reduce((E,T)=>E+T.minutes,0),0),g=async()=>{if(!(!f.current||u)){d(!0);try{const w=await nC(f.current,{scale:3,backgroundColor:"#ffffff"}),b=document.createElement("a");b.href=w;const E=new Date().toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}).replace(/\//g,".");b.download=`ScreenTimeReceipt_${E}.png`,document.body.appendChild(b),b.click(),document.body.removeChild(b),d(!1),i(!0),setTimeout(()=>i(!1),2e3)}catch(w){console.error("Failed to save receipt:",w),d(!1)}}},x=async()=>{if(navigator.share)try{await navigator.share({title:"Screen Time Receipt",text:`Check out my ${n.period==="weekly"?"weekly":"daily"} screen time receipt!`,url:window.location.href}),l(!0),setTimeout(()=>l(!1),2e3)}catch(w){console.log("Share cancelled:",w)}else t(),l(!0),setTimeout(()=>l(!1),2e3)},y=rG(m);return h.jsxs("div",{className:"absolute flex flex-col gap-[24px] items-center left-1/2 top-[86px] md:top-[40px] -translate-x-1/2 w-[337px] max-w-[90%] pb-[100px] animate-slide-in transition-transform duration-400",children:[h.jsx("div",{ref:f,className:"bg-white relative shadow-md shrink-0 w-full border border-gray-200",children:h.jsx("div",{className:"flex flex-col items-center size-full",children:h.jsxs("div",{className:"flex flex-col gap-[32px] items-center px-[24px] py-[32px] relative w-full",children:[h.jsx("div",{className:"flex flex-col gap-[24px] items-center relative shrink-0 w-full",children:h.jsxs("div",{className:"flex flex-col font-mono gap-[4px] items-center relative shrink-0 text-center w-[201px] max-w-full",children:[h.jsx("p",{className:"leading-[22px] min-w-full relative shrink-0 text-[17px] text-black font-semibold",children:"DIGITAL RECEIPT"}),h.jsxs("p",{className:"leading-[22px] relative shrink-0 text-[13px] text-gray-400 text-nowrap",children:[n.period==="weekly"?"Weekly":"Daily"," Screen Time Summary"]}),h.jsxs("div",{className:"leading-[22px] relative shrink-0 text-[13px] text-gray-500 text-nowrap",children:[h.jsxs("p",{className:"mb-0",children:[n.startDate," - ",n.endDate]}),h.jsxs("p",{children:["Generated ",n.generatedTime]})]})]})}),n.categories.map((w,b)=>{const E=w.apps.reduce((T,_)=>T+_.minutes,0);return h.jsxs("div",{className:"flex flex-col gap-[16px] items-start relative shrink-0 w-full",children:[h.jsxs("div",{className:"flex flex-col gap-[4px] items-start relative shrink-0 w-full",children:[h.jsx("p",{className:"font-mono leading-[22px] font-semibold relative shrink-0 text-[13px] text-black w-full",children:w.name}),h.jsx("div",{className:"h-0 relative shrink-0 w-full",children:h.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:h.jsx("line",{stroke:"gray",strokeOpacity:"0.3",x2:"289",y1:"0.5",y2:"0.5"})})})})]}),w.apps.map((T,_)=>h.jsxs("div",{className:"flex gap-[16px] items-center relative shrink-0 w-full",children:[h.jsx(oG,{appName:T.name,icon:T.icon}),h.jsxs("div",{className:"basis-0 flex font-mono grow items-start justify-between leading-[22px] min-h-px min-w-px relative shrink-0 text-[13px]",children:[h.jsxs("div",{className:"flex flex-col items-start relative shrink-0 w-[97px]",children:[h.jsx("p",{className:"min-w-full relative shrink-0 text-black font-semibold",children:T.name}),h.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.4)] text-center text-nowrap",children:T.category})]}),h.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.4)] text-center text-nowrap font-semibold",children:Im(T.minutes)})]})]},_)),h.jsxs("div",{className:"flex flex-col gap-[8px] items-start relative shrink-0 w-full",children:[h.jsx("div",{className:"h-0 relative shrink-0 w-full",children:h.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:h.jsx("line",{stroke:"black",strokeDasharray:"2 2",strokeOpacity:"0.3",x2:"289",y1:"0.5",y2:"0.5"})})})}),h.jsxs("div",{className:"flex font-mono items-start justify-between leading-[22px] relative shrink-0 text-[13px] w-full font-semibold",children:[h.jsx("p",{className:"relative self-stretch shrink-0 text-[rgba(0,0,0,0.5)] w-[97px]",children:"SUBTOTAL:"}),h.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.4)] text-center text-nowrap",children:Im(E)})]})]})]},b)}),h.jsxs("div",{className:"flex flex-col gap-[24px] items-center relative shrink-0 w-full",children:[h.jsxs("div",{className:"flex flex-col gap-[14px] items-start relative shrink-0 w-full",children:[h.jsx("div",{className:"h-0 relative shrink-0 w-full",children:h.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:h.jsx("line",{stroke:"black",strokeDasharray:"6 3",x2:"289",y1:"0.5",y2:"0.5"})})})}),h.jsxs("div",{className:"flex font-mono items-start justify-between leading-[22px] relative shrink-0 text-[17px] text-nowrap w-full font-semibold",children:[h.jsx("p",{className:"relative shrink-0 text-black",children:"GRAND TOTAL:"}),h.jsx("p",{className:"relative shrink-0 text-[rgba(0,0,0,0.8)] text-center",children:Im(m)})]}),h.jsx("div",{className:"h-0 relative shrink-0 w-full",children:h.jsx("div",{className:"absolute inset-[-1px_0_0_0]",children:h.jsx("svg",{className:"block size-full",fill:"none",preserveAspectRatio:"none",viewBox:"0 0 289 1",children:h.jsx("line",{stroke:"black",strokeDasharray:"6 3",x2:"289",y1:"0.5",y2:"0.5"})})})})]}),h.jsxs("div",{className:"flex flex-col font-mono gap-[16px] items-start relative shrink-0 text-center w-full ",children:[h.jsx("p",{className:"leading-[22px] relative shrink-0 text-[17px] font-semibold text-gray-500 w-full",children:y.main}),h.jsxs("div",{className:"leading-[22px] relative shrink-0 text-[15px] text-gray-400 font-medium w-full whitespace-pre-line",children:[h.jsx("p",{className:"mb-0",children:"Recommendation:"}),h.jsx("p",{children:y.message})]})]})]})]})})}),h.jsxs("div",{className:"flex gap-[24px] items-center justify-center px-0 py-[16px] relative shrink-0 w-full",children:[h.jsx("button",{onClick:g,disabled:u,className:"flex flex-col items-start relative shrink-0 cursor-pointer group disabled:cursor-default",children:h.jsxs("div",{className:"flex flex-col gap-[7px] items-center relative shrink-0 w-[78px]",children:[h.jsx("div",{className:`flex items-center justify-center relative rounded-full shrink-0 size-[70px] transition-colors ${s?"bg-[#08f]":u?"bg-[#ededed]":"bg-[#ededed] group-hover:bg-[#e0e0e0]"}`,children:u?h.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-500 rounded-full animate-spin"}):s?h.jsx("img",{src:Pw,alt:"Saved",className:"w-[22px] h-[21px]"}):h.jsx("img",{src:$V,alt:"Save",className:"w-[22px] h-[27px]"})}),h.jsx("p",{className:"font-mono font-normal leading-[15px] overflow-ellipsis overflow-hidden relative shrink-0 text-[#333] text-[13px] text-center text-nowrap tracking-[-0.1px]",children:u?"Saving...":s?"Saved":"Save"})]})}),h.jsx("button",{onClick:x,className:"flex flex-col items-start relative shrink-0 cursor-pointer group",children:h.jsxs("div",{className:"flex flex-col gap-[7px] items-center relative shrink-0 w-[78px]",children:[h.jsx("div",{className:`flex items-center justify-center relative rounded-full shrink-0 size-[70px] transition-colors ${a?"bg-[#08f]":"bg-[#ededed] group-hover:bg-[#e0e0e0]"}`,children:a?h.jsx("img",{src:Pw,alt:"Shared",className:"w-[22px] h-[21px]"}):h.jsx("img",{src:VV,alt:"Share",className:"w-[26px] h-[26px]"})}),h.jsx("p",{className:"font-mono font-normal leading-[15px] overflow-ellipsis overflow-hidden relative shrink-0 text-[#333] text-[13px] text-center text-nowrap tracking-[-0.1px]",children:a?"Shared":"Share"})]})})]}),h.jsx("button",{onClick:r,className:"h-[22px] relative shrink-0 w-[204px] cursor-pointer",children:h.jsx("p",{className:"absolute font-mono inset-0 leading-[22px] text-[15px] text-[rgba(0,0,0,0.5)] text-center text-nowrap hover:text-[rgba(0,0,0,0.7)] transition-colors font-semibold",children:" Generate New Receipt"})})]})}function cG({onClose:n}){const e=[{name:"Ashley",emoji:""},{name:"Jordan",emoji:""},{name:"Gary and Tasha",emoji:""},{name:"Steven",emoji:""}],t=[{name:"AirDrop",icon:"",color:"bg-blue-500"},{name:"Messages",icon:"",color:"bg-green-500"},{name:"Mail",icon:"",color:"bg-blue-400"},{name:"Notes",icon:"",color:"bg-yellow-300"}],r=[{name:"Copy",icon:""},{name:"Add to Favorites",icon:""},{name:"Add to Reading List",icon:""},{name:"Add Bookmark",icon:""}],s=i=>{alert(`${i} clicked! (This is a demo)`),n()};return h.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/20 animate-fade-in",onClick:n,children:h.jsxs("div",{className:"bg-white rounded-t-[20px] w-full max-w-[402px] pb-8 animate-slide-in max-h-[90vh] overflow-y-auto",onClick:i=>i.stopPropagation(),children:[h.jsx("div",{className:"flex items-center justify-center px-8 py-3 border-b border-gray-200",children:h.jsx("h3",{className:"font-mono text-[15px] font-semibold",children:"Screen Time Receipt"})}),h.jsx("p",{className:"text-center text-[13px] text-gray-400 font-mono py-2",children:"Weekly Time Summary"}),h.jsx("div",{className:"px-8 py-3",children:h.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:e.map((i,a)=>h.jsxs("button",{className:"flex flex-col items-center gap-1 min-w-[60px]",children:[h.jsx("div",{className:"w-[60px] h-[60px] rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-3xl",children:i.emoji}),h.jsx("span",{className:"text-[11px] text-gray-700 font-mono truncate w-full text-center",children:i.name})]},a))})}),h.jsx("div",{className:"px-8 py-3 border-t border-gray-200",children:h.jsx("div",{className:"flex gap-4 justify-around",children:t.map((i,a)=>h.jsxs("button",{className:"flex flex-col items-center gap-1",children:[h.jsx("div",{className:`w-[60px] h-[60px] rounded-[15px] ${i.color} flex items-center justify-center text-3xl shadow-sm`,children:i.icon}),h.jsx("span",{className:"text-[11px] text-gray-700 font-mono",children:i.name})]},a))})}),h.jsx("div",{className:"px-8 py-3 border-t border-gray-200 space-y-1",children:r.map((i,a)=>h.jsxs("button",{className:"flex items-center gap-3 w-full py-3 px-2 hover:bg-gray-100 rounded-lg transition-colors",onClick:()=>s(i.name),children:[h.jsx("span",{className:"text-2xl",children:i.icon}),h.jsx("span",{className:"text-[15px] text-gray-900 font-mono",children:i.name})]},a))})]})})}function uG({onClose:n,onUploadSuccess:e}){const[t,r]=L.useState(null),[s,i]=L.useState(!1),a=l=>{const u=l.target.files?.[0];if(!u)return;if(!u.type.startsWith("image/")){r("Please upload an image file (PNG, JPG, etc.)");return}if(u.size>10*1024*1024){r("Image is too large. Please upload a file under 10MB.");return}r(null),i(!0);const d=new FileReader;d.onload=f=>{const m=new Image;m.onload=()=>{const g=m.height>m.width,x=m.width>=300&&m.height>=400;if(!g){i(!1),r("Please upload a portrait screenshot from your phone's Screen Time settings.");return}if(!x){i(!1),r("Image is too small. Please upload a full-resolution screenshot.");return}setTimeout(()=>{i(!1),e()},500)},m.onerror=()=>{i(!1),r("Could not read the image. Please try a different file.")},m.src=f.target?.result},d.onerror=()=>{i(!1),r("Could not read the file. Please try again.")},d.readAsDataURL(u)};return h.jsx("div",{className:"fixed inset-0 z-10000 flex items-center justify-center bg-black/5 animate-fade-in p-4",onClick:n,children:h.jsxs("div",{className:"bg-white rounded-[20px] py-2 pb-4 w-full max-w-[500px] max-h-[90vh] overflow-y-auto shadow-md animate-slide-in",onClick:l=>l.stopPropagation(),children:[h.jsx("div",{className:"top-0 bg-white flex items-center justify-center px-12 pt-8 rounded-t-[20px]",children:h.jsx("h2",{className:"font-mono text-lg text-black font-semibold",children:"Upload Your Screen Time Data"})}),h.jsxs("div",{className:"px-12 py-6 space-y-6 font-mono text-[15px]",children:[h.jsx("div",{className:"border-t border-gray-200"}),h.jsxs("div",{className:"space-y-3",children:[h.jsx("h3",{className:"font-['Figtree'] text-base text-black font-semibold",children:"iPhone"}),h.jsxs("ol",{className:"font-['Figtree'] space-y-3 pl-10 list-decimal text-gray-500 leading-normal",children:[h.jsxs("li",{children:["Open ",h.jsx("strong",{children:"Settings"})]}),h.jsxs("li",{children:["Scroll down and tap ",h.jsx("strong",{children:"Screen Time"})]}),h.jsxs("li",{children:["Tap ",h.jsx("strong",{children:"See All Activity"})]}),h.jsxs("li",{children:["Choose ",h.jsx("strong",{children:"Week"})," or ",h.jsx("strong",{children:"Day"})," at the top"]}),h.jsx("li",{children:"Take a screenshot (Side Button + Volume Up)"})]})]}),h.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-3",children:[h.jsx("h3",{className:"font-mono text-base text-black font-semibold",children:"Android"}),h.jsxs("ol",{className:"font-['Figtree'] space-y-3 pl-10 list-decimal text-gray-500 leading-normal",children:[h.jsxs("li",{children:["Open ",h.jsx("strong",{children:"Settings"})]}),h.jsxs("li",{children:["Tap ",h.jsx("strong",{children:"Digital Wellbeing & parental controls"})]}),h.jsx("li",{children:"Tap the graph to see your screen time details"}),h.jsx("li",{children:"Take a screenshot (Power + Volume Down)"})]})]}),t&&h.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[h.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-red-100 flex items-center justify-center mt-0.5",children:h.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#ef4444",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),h.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-['Figtree'] text-sm text-red-800 font-medium",children:"Upload failed"}),h.jsx("p",{className:"font-['Figtree'] text-sm text-red-600 mt-0.5",children:t})]}),h.jsx("button",{onClick:()=>r(null),className:"flex-shrink-0 text-red-400 hover:text-red-600 transition-colors",children:h.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),h.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),h.jsxs("label",{className:"block",children:[h.jsx("div",{className:`${s?"bg-gray-400":"bg-[#404040] hover:bg-[#333]"} transition-colors flex items-center justify-center px-[20px] py-[12px] rounded-full cursor-pointer`,children:h.jsx("p",{className:"font-mono text-[15px] text-center text-white tracking-[0.75px]",children:s?"PROCESSING...":"UPLOAD SCREENSHOT"})}),h.jsx("input",{type:"file",accept:"image/*",className:"hidden",disabled:s,onChange:a})]})]})]})})}function dG(){const n=Dr(),e=ig("screentime",nG),[t,r]=L.useState("generate"),[s,i]=L.useState("daily"),[a,l]=L.useState(null),[u,d]=L.useState(!1),[f,m]=L.useState(!0);L.useEffect(()=>{const I=setTimeout(()=>{m(!1)},50);return()=>clearTimeout(I)},[]);const g=()=>{d(!0),setTimeout(()=>{n("/")},280)},x=()=>{const I=Nw(s);l(I),r("receipt")},y=()=>{alert("Receipt saved! (This is a demo - in a real app, this would save to your device)")},w=async()=>{if(navigator.share)try{await navigator.share({title:"Screen Time Receipt",text:`Check out my ${s==="weekly"?"weekly":"daily"} screen time receipt!`,url:window.location.href})}catch(I){console.log("Share cancelled or failed:",I)}else r("share")},b=()=>{r("receipt")},E=()=>{r("generate"),l(null)},T=()=>{r("upload")},_=()=>{r("generate")},A=()=>{const I=Nw(s);l(I),r("receipt")};return h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:g,className:"fixed top-8 left-8 md:left-16 z-40 cursor-pointer transition-opacity duration-200 hover:opacity-80","aria-label":"Go back to home",children:h.jsx("img",{src:Ia,alt:"Michelle Liu Logo",className:"w-[44px] h-[44px] object-contain"})}),h.jsx(sg,{project:e}),h.jsx("div",{className:`screentime-page-container relative w-full min-h-screen min-h-[100dvh] px-4 flex flex-col items-center transition-all ${u?"opacity-0 scale-[0.985]":f?"opacity-0 scale-[1.01]":"opacity-100 scale-100"}`,style:{backgroundColor:"#f3f4f6",transitionDuration:u?"280ms":"300ms",transitionTimingFunction:u?"cubic-bezier(0.4, 0, 0.2, 1)":"ease-out"},children:h.jsxs("div",{className:"relative w-full max-w-[402px] min-h-screen mx-auto bg-[#f3f4f6]",children:[h.jsx("div",{className:"hidden md:block",children:h.jsx(sG,{})}),h.jsx(iG,{additionalClassNames:"bottom-0"}),t==="generate"&&h.jsx(aG,{period:s,onPeriodChange:i,onGenerate:x,onUploadClick:T}),t==="receipt"&&a&&h.jsx(lG,{data:a,onSave:y,onShare:w,onGenerateNew:E}),t==="share"&&h.jsx(cG,{onClose:b}),t==="upload"&&h.jsx(uG,{onClose:_,onUploadSuccess:A})]})}),h.jsx("style",{children:`
        .screentime-page-container {
          overflow-y: auto;
        }
        
        .screentime-page-container,
        .screentime-page-container * {
          font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
        }
        
        @keyframes slideInFromBottom {
          0% {
            transform: translateY(100%);
            opacity: 0;
          }
          100% {
            transform: translateY(0);
            opacity: 1;
          }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        .animate-slide-in {
          animation: slideInFromBottom 1.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        .animate-fade-in {
          animation: fadeIn 0.2s ease-out;
        }
      `})]})}function jw({href:n="/polaroid",onClick:e,className:t=""}){const r=()=>{e?e():window.location.href=n};return h.jsx("button",{onClick:r,className:`bg-blue-500 border border-blue-400 border-solid content-stretch flex gap-1.5 items-center justify-center px-4 py-1.5 relative rounded-full shrink-0 cursor-pointer hover:bg-blue-400 hover:border-blue-300 transition-colors duration-200 ease-out ${t}`,children:h.jsx("span",{className:"font-['Manrope',sans-serif] font-semibold leading-normal relative shrink-0 text-base text-white whitespace-nowrap",children:"Try It Out!"})})}function fG(){if(typeof window>"u")return;const n=navigator.userAgent,e=/Windows/.test(n),t=/Firefox/.test(n),r=/Safari/.test(n)&&!/Chrome/.test(n),s="ontouchstart"in window||navigator.maxTouchPoints>0,i=/Mac/.test(n);if(console.log(" Custom Cursor Status:",{platform:e?"Windows":i?"macOS":"Other",browser:t?"Firefox":r?"Safari":"Chrome/Other",touchDevice:s,expectedCursor:e?"32x32 (small)":"40x40/46x46 (large)",note:"If cursor looks wrong, check Network tab for failed SVG loads"}),s){console.log(" Touch device detected - using system cursor");return}(async()=>{const l=[{name:"default-large",path:"/src/assets/cursor-default.svg"},{name:"default-small",path:"/src/assets/cursor-default-small.svg"},{name:"hover-large",path:"/src/assets/cursor-hover.svg"},{name:"hover-small",path:"/src/assets/cursor-hover-small.svg"}],u=await Promise.all(l.map(m=>new Promise(g=>{const x=new Image;x.onload=()=>g({...m,loaded:!0}),x.onerror=()=>g({...m,loaded:!1}),x.src=m.path}))),d=u.filter(m=>m.loaded).length,f=u.filter(m=>!m.loaded);f.length>0?(console.warn(" Some cursors failed to load:",f.map(m=>m.name)),console.log(" This might cause cursor to appear as system default")):console.log(` All ${d} cursor files loaded successfully`),setTimeout(()=>{const x=window.getComputedStyle(document.body).getPropertyValue("cursor").includes("cursor-default");console.log(" Cursor application check:",{hasCustomCursor:x,cursorValue:x?"Custom cursor active ":"System cursor (fallback)",reason:!x&&e?"Might be Windows 32x32 limit issue":"Check CSS and file paths"}),document.body.setAttribute("data-cursor-status",x?"custom":"system")},100)})(),e?console.log(" Windows detected: Using 32x32px cursors (Windows size limit)"):i&&console.log(" macOS detected: Using 40x40/46x46px cursors"),t&&console.log(" Firefox: Custom cursors active with enhanced compatibility")}function hG(){const n=document.body,t=window.getComputedStyle(n).getPropertyValue("cursor"),r={cursorValue:t,hasCustomCursor:t.includes("cursor-default"),platform:/Windows/.test(navigator.userAgent)?"Windows":/Mac/.test(navigator.userAgent)?"macOS":"Other",browser:navigator.userAgent,recommendation:""};return r.hasCustomCursor?r.recommendation="Custom cursor is active ":r.recommendation="Custom cursor not active. Check: 1) File paths in CSS, 2) Cursor size limits, 3) Browser console for errors",console.table(r),r}typeof window<"u"&&(window.debugCursor=hG);const mG=`
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.animate-fade-up {
  animation: fadeUp 400ms ease-out forwards;
}
`;function Ow(n){return{imageSrc:`https://image.mux.com/${n}/thumbnail.png`,videoSrc:`https://stream.mux.com/${n}.m3u8`}}const Mw=[{id:"apple",title:"Apple",year:"2025",description:"Designing new features to drive engagement and user delight.",imageSrc:"",videoSrc:""},{id:"roblox",title:"Roblox",year:"2024",description:"Reimagining the future of social gameplay and user communication.",imageSrc:"",videoSrc:""},{id:"adobe",title:"Adobe",year:"2023",description:"Product strategy to drive user acquisition on college campuses.",imageSrc:"",videoSrc:""},{id:"nasa",title:"NASA JPL",year:"2023-24",description:"Daring (& designing) mighty things at NASA's in-house DesignLab.",imageSrc:"",videoSrc:""},{id:"polaroid",title:"Polaroid Studio",year:"2025",description:"A digital way to customize your own polaroid.",imageSrc:"https://image.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w/thumbnail.png",videoSrc:"https://stream.mux.com/XJFJ1P3u9pKsFYvH9lTtOp4gPRydSpMkRrX9dRmNE5w.m3u8",xLink:"https://x.com/michelletliu/status/1991201412072734777",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]},{id:"screentime",title:"Screentime Receipt",year:"2025",description:"A receipt for your daily or weekly screentime.",imageSrc:"https://image.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI/thumbnail.png",videoSrc:"https://stream.mux.com/AdZWDHKkfyhXntZy01keNYtPB7Q6w8GxeaUWmP8501SLI.m3u8",xLink:"https://x.com/michelletliu/status/2000987498550383032",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]},{id:"sketchbook",title:"Digital Sketchbook",year:"2025",description:"A digital home for sketches and visual journaling. Live app coming soon!",imageSrc:"https://image.mux.com/iEo013MYI028Zit3nPTJetFvqbgweCC8e2NHbY702qsQBg/thumbnail.png",videoSrc:"https://stream.mux.com/iEo013MYI028Zit3nPTJetFvqbgweCC8e2NHbY702qsQBg.m3u8",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]},{id:"library",title:"Personal Library",year:"2025",description:"My dream digital bookshelf",imageSrc:"https://image.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo/thumbnail.png",videoSrc:"https://stream.mux.com/a3NxNdblQi02JVCg0177eEWZRycP1BduGb2pt7o00FUPfo.m3u8",xLink:"https://x.com/michelletliu/status/1981030966044061894",toolCategories:[{label:"Design",tools:["Figma"]},{label:"Frontend",tools:["TypeScript","React","Vite"]},{label:"Styling",tools:["Tailwind CSS"]},{label:"AI",tools:["Figma Make","Cursor"]}]}],Fw=Er.memo(function({imageSrc:e,videoSrc:t}){const r=L.useRef(null),[s,i]=L.useState(!1),[a,l]=L.useState(!1),[u,d]=L.useState(!1);return L.useEffect(()=>{const f=r.current;if(!f)return;const m=new IntersectionObserver(g=>{g.forEach(x=>{x.isIntersecting&&(i(!0),setTimeout(()=>l(!0),100),m.disconnect())})},{threshold:.1,rootMargin:"100px"});return m.observe(f),()=>m.disconnect()},[]),t?h.jsxs("div",{ref:r,className:"aspect-[678/367.625] relative rounded-[26px] shrink-0 w-full overflow-hidden bg-[#e5e7eb]",children:[s&&a&&h.jsx(Os,{src:t,className:J("absolute max-w-none object-cover rounded-[26px] size-full transition-opacity duration-500 ease-out",u?"opacity-100":"opacity-0 invisible"),autoPlay:!0,muted:!0,loop:!0,controls:!1,muxEnvKey:"e4cc19a78gcf0tbtfmu4m7ruf",onLoaded:()=>d(!0)}),h.jsx("div",{className:J("absolute inset-0 rounded-[26px] transition-opacity duration-500 ease-out bg-[#e5e7eb] z-10 pointer-events-none",u?"opacity-0":"opacity-100 animate-shimmer")})]}):e?h.jsx("div",{ref:r,className:"aspect-[678/367.625] relative rounded-[26px] shrink-0 w-full",children:h.jsx("img",{alt:"",className:"absolute max-w-none object-cover rounded-[26px] size-full",src:e,loading:"lazy"})}):h.jsx("div",{ref:r,className:"aspect-[678/367.625] relative rounded-[26px] shrink-0 w-full overflow-hidden bg-[#e5e7eb]",children:h.jsx("div",{className:"absolute inset-0 rounded-[26px] bg-[#e5e7eb] animate-shimmer"})})}),Bw=Er.memo(function({project:e,onProjectClick:t,featured:r=!1}){const s=e.id==="polaroid"||e.id==="library"||e.id==="screentime",i=()=>{s?window.location.href=e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library":t(e.id)};return r?h.jsxs("button",{onClick:i,className:"content-stretch flex flex-col gap-3 items-start relative shrink-0 w-full cursor-pointer group project-card",children:[h.jsxs("div",{className:"content-stretch flex flex-col items-start justify-end overflow-clip relative rounded-[26px] shrink-0 w-full transition-transform duration-300 group-hover:scale-[0.99]",children:[h.jsx(Fw,{imageSrc:e.imageSrc,videoSrc:e.videoSrc}),h.jsx("div",{className:"absolute bottom-0 left-0 p-3 hidden md:block",children:h.jsx("div",{className:"bg-white border border-[#f3f4f6] border-solid flex items-center justify-center px-3 pt-[5px] pb-[4.8px] rounded-full",children:h.jsxs("p",{className:"font-['Figtree',sans-serif] font-medium tracking-[0.005em] leading-[1.4] text-[#111827] text-base",children:[h.jsx("span",{children:e.title}),!s&&h.jsxs("span",{className:"text-[#9ca3af]",children:["  ",e.year]}),s&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-[#9ca3af] opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"  "}),h.jsx("a",{href:e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library",onClick:a=>a.stopPropagation(),className:"text-blue-400 hover:text-blue-300 opacity-0 group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"Try It Out!"})]})]})})})]}),h.jsx("div",{className:"hidden md:flex content-stretch items-start px-[13px] py-0 -mt-1 relative shrink-0 w-full",children:h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-[1] text-[#9ca3af] text-base tracking-[0.005em] text-left project-hover-text",children:e.description})}),h.jsxs("div",{className:"md:hidden content-stretch flex flex-col font-['Figtree',sans-serif] font-normal items-start leading-[1.4] px-[13px] py-0 relative shrink-0 text-base tracking-[0.01em] gap-1",children:[h.jsxs("p",{className:"relative shrink-0 text-[#111827] text-left project-hover-text",children:[h.jsx("span",{children:e.title}),!s&&h.jsxs("span",{className:"text-[#9ca3af]",children:["  ",e.year]}),s&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-[#9ca3af]",children:"  "}),h.jsx("a",{href:e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library",onClick:a=>a.stopPropagation(),className:"text-blue-400 hover:text-blue-300",children:"Try It Out!"})]})]}),h.jsx("p",{className:"relative shrink-0 text-[#9ca3af] w-full text-left font-normal leading-[1.3]",children:e.description})]})]}):h.jsxs("button",{onClick:i,className:"content-stretch flex flex-col gap-3 items-start relative shrink-0 w-full cursor-pointer group project-card",children:[h.jsx("div",{className:"content-stretch flex flex-col items-start overflow-clip relative rounded-[26px] shrink-0 w-full transition-transform duration-300 group-hover:scale-[0.99]",children:h.jsx(Fw,{imageSrc:e.imageSrc,videoSrc:e.videoSrc})}),h.jsx("div",{className:"content-stretch flex font-['Figtree',sans-serif] -mt-1 font-normal items-start leading-[1.4] px-[13px] py-0 relative shrink-0 text-base tracking-[0.005em] w-full",children:h.jsxs("p",{className:"relative shrink-0 text-[#111827] text-left project-hover-text",children:[h.jsx("span",{children:e.title}),!s&&h.jsxs("span",{className:"text-[#9ca3af]",children:["  ",e.year]}),s&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-[#9ca3af] md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"  "}),h.jsx("a",{href:e.id==="polaroid"?"/polaroid":e.id==="screentime"?"/screentime":"/library",onClick:a=>a.stopPropagation(),className:"text-blue-400 hover:text-blue-300 md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300 ease-out",children:"Try It Out!"})]})]})})]})});function pG(){return h.jsx("div",{className:"h-px relative shrink-0 w-full",children:h.jsx("div",{className:"absolute bg-[#e5e7eb] inset-0"})})}function gG({categories:n}){return!n||n.length===0?null:h.jsxs(h.Fragment,{children:[h.jsx(pG,{}),h.jsx("div",{className:"font-['Figtree',sans-serif] font-normal gap-4 grid grid-cols-4 max-md:grid-cols-2 max-md:gap-y-4 relative shrink-0 text-[15px] w-full mt-2",children:n.map((e,t)=>h.jsxs("div",{className:"content-stretch flex flex-col gap-2 items-start justify-start relative shrink-0",children:[h.jsx("p",{className:"leading-5 relative shrink-0 text-[#9ca3af]",children:e.label}),h.jsx("div",{className:"content-stretch flex flex-col gap-1 items-start leading-[0] relative shrink-0 text-[#4b5563] tracking-[-0.31px]",children:e.tools.map((r,s)=>h.jsx("div",{className:"flex flex-col justify-center relative shrink-0",children:h.jsx("p",{className:"leading-[21px] whitespace-nowrap",children:r})},s))})]},t))})]})}function xG({project:n,onClose:e}){Dr();const[t,r]=L.useState(!1),[s,i]=L.useState(!1),[a,l]=L.useState(!1);$a(),L.useEffect(()=>{requestAnimationFrame(()=>{r(!0)});const d=setTimeout(()=>{l(!0)},350);return()=>clearTimeout(d)},[]),L.useEffect(()=>{const d=f=>{f.key==="Escape"&&(f.preventDefault(),u())};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[]);const u=()=>{i(!0),r(!1),setTimeout(()=>{e()},300)};return h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-8",children:[h.jsx("div",{className:`absolute inset-0 bg-black/20 transition-opacity duration-300 ${t?"opacity-100":"opacity-0"}`,onClick:u}),h.jsx("div",{className:J("relative bg-white rounded-[26px] flex flex-col w-[calc(100%*10/12)] max-md:w-full max-h-[90vh] overflow-hidden transition-all duration-300 ease-out",t?"opacity-100 translate-y-0":s?"opacity-0 translate-y-4":"opacity-0 translate-y-8"),children:h.jsx("div",{className:"flex flex-col flex-1 min-h-0 pt-6 max-md:pt-4",children:h.jsx("div",{className:"overflow-y-auto flex-1",children:h.jsxs("div",{className:"content-stretch flex flex-col gap-5 items-start px-44 max-md:px-10 pt-16 max-md:pt-4 pb-8 max-md:pb-10 relative shrink-0 w-full",children:[h.jsxs("div",{className:"hidden md:flex gap-2 items-start relative shrink-0 w-full",children:[h.jsxs("div",{className:"content-stretch flex flex-[1_0_0] flex-col gap-[6px] items-start min-h-px min-w-px relative shrink-0",children:[h.jsx("div",{className:"content-stretch flex items-start relative shrink-0 w-full",children:h.jsxs("div",{className:"content-stretch flex gap-[6px] items-center relative shrink-0",children:[h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-xl text-black",children:n.title}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] relative shrink-0 text-[#9ca3af] text-base tracking-[0.005em]",children:""}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-[#9ca3af] text-xl",children:n.year})]})}),h.jsx("div",{className:"content-stretch flex gap-2 items-start relative w-full",children:h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative text-[#6b7280] text-base tracking-[0.005em]",children:n.description})})]}),(n.id==="polaroid"||n.id==="library"||n.id==="screentime")&&h.jsx(jw,{href:n.id==="polaroid"?"/polaroid":n.id==="screentime"?"/screentime":"/library"})]}),h.jsxs("div",{className:"md:hidden flex flex-col gap-3 items-start relative shrink-0 w-full",children:[h.jsxs("div",{className:"content-stretch flex flex-col gap-[6px] items-start relative shrink-0 w-full",children:[h.jsx("div",{className:"content-stretch flex items-start relative shrink-0 w-full",children:h.jsxs("div",{className:"content-stretch flex gap-[6px] items-center relative shrink-0",children:[h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-xl text-black",children:n.title}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-medium leading-[1.4] relative shrink-0 text-[#9ca3af] text-base tracking-[0.005em]",children:""}),h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-normal relative shrink-0 text-[#9ca3af] text-xl",children:n.year})]})}),h.jsx("div",{className:"content-stretch flex gap-2 items-start relative w-full",children:h.jsx("p",{className:"font-['Figtree',sans-serif] font-normal leading-5 relative text-[#6b7280] text-base tracking-[0.005em]",children:n.description})})]}),(n.id==="polaroid"||n.id==="library"||n.id==="screentime")&&h.jsx(jw,{href:n.id==="polaroid"?"/polaroid":n.id==="screentime"?"/screentime":"/library"})]}),n.xLink&&h.jsxs("a",{href:n.xLink,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-500 border border-blue-400 border-solid content-stretch flex gap-1 items-center justify-center px-4 py-1.5 relative rounded-full shrink-0 cursor-pointer hover:bg-blue-400 hover:border-blue-300 transition-colors duration-200 ease-out mt-1",children:[h.jsx("span",{className:"font-['Manrope',sans-serif] font-semibold leading-normal relative shrink-0 text-base tracking-[0.005em] text-white whitespace-nowrap",children:"View on"}),h.jsx("svg",{className:"block w-[14px] h-[14px] fill-white",viewBox:"0 0 19 18",children:h.jsx("path",{d:hi.p16308a80})}),h.jsx("span",{className:"text-white",children:h.jsx(Gs,{})})]}),n.toolCategories&&n.toolCategories.length>0&&h.jsx(gG,{categories:n.toolCategories}),h.jsxs("div",{className:"relative rounded-[16px] w-full aspect-[1097/616] overflow-hidden bg-gray-100 shrink-0 mt-3",children:[h.jsx("img",{alt:"",className:"absolute object-cover size-full rounded-[16px]",src:n.imageSrc}),n.videoSrc&&a&&h.jsx(Os,{src:n.videoSrc,className:"absolute object-cover size-full rounded-[16px]",autoPlay:!0,muted:!0,loop:!0,controls:!1,muxEnvKey:"e4cc19a78gcf0tbtfmu4m7ruf"},n.id)]})]})})})})]})}const Uw=["polaroid","screentime","sketchbook","library"],yG=["apple","roblox","adobe","nasa"];function vG(){const n=Dr(),{slug:e,mode:t}=VI(),[r,s]=L.useState(Mw),[i,a]=L.useState(()=>sessionStorage.getItem("heroAnimationPlayed")==="true");L.useEffect(()=>{async function w(){try{const[b,E]=await Promise.all([it.fetch(xO),it.fetch(yO)]),T={};b.forEach(I=>{I.company&&I.heroVideo&&(T[I.company]=I.heroVideo)});const _={};E.forEach(I=>{I.projectId&&(_[I.projectId]=I)});const A=Mw.map(I=>{if(yG.includes(I.id)){const N=T[I.id];if(N){const P=Ow(N);return{...I,imageSrc:P.imageSrc,videoSrc:P.videoSrc}}}if(Uw.includes(I.id)){const N=_[I.id];if(N){const P=N.muxPlaybackId?Ow(N.muxPlaybackId):{imageSrc:I.imageSrc,videoSrc:I.videoSrc};return{...I,title:N.title,year:N.year,description:N.description,imageSrc:P.imageSrc,videoSrc:P.videoSrc,xLink:N.xLink||I.xLink,toolCategories:N.toolCategories||I.toolCategories}}}return I});s(A)}catch(b){console.error("Error fetching Sanity projects:",b)}}w()},[]),L.useEffect(()=>{if(!i){const w=setTimeout(()=>{sessionStorage.setItem("heroAnimationPlayed","true"),a(!0)},500);return()=>clearTimeout(w)}},[i]),L.useEffect(()=>{TO()},[]);const l=e&&r.find(w=>w.id===e)||null,u=t==="full",d=L.useCallback(w=>{const E=window.innerWidth<768&&w!=="sketchbook";n(E?`/project/${w}/full`:`/project/${w}`)},[n]),f=()=>{n("/")},m=()=>{e&&n(`/project/${e}/full`)},g=()=>{e&&n(`/project/${e}`)},x=w=>{const b=u?`/project/${w}/full`:`/project/${w}`;n(b)},y=()=>{n("/"),window.scrollTo({top:0,behavior:"smooth"})};return h.jsxs("div",{className:"bg-white content-stretch flex flex-col items-center relative size-full min-h-screen",children:[h.jsx("style",{children:mG}),h.jsx("svg",{width:"0",height:"0",className:"absolute",children:h.jsx("defs",{children:h.jsxs("linearGradient",{id:"socialGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[h.jsx("stop",{offset:"0%",stopColor:"#D79FE8",children:h.jsx("animate",{attributeName:"stop-color",values:"#D79FE8; #4DACEA; #13B2EB; #D79FE8",dur:"3.5s",repeatCount:"indefinite"})}),h.jsx("stop",{offset:"50%",stopColor:"#4DACEA",children:h.jsx("animate",{attributeName:"stop-color",values:"#4DACEA; #13B2EB; #D79FE8; #4DACEA",dur:"3.5s",repeatCount:"indefinite"})}),h.jsx("stop",{offset:"100%",stopColor:"#13B2EB",children:h.jsx("animate",{attributeName:"stop-color",values:"#13B2EB; #D79FE8; #4DACEA; #13B2EB",dur:"3.5s",repeatCount:"indefinite"})})]})})}),h.jsx(J0,{variant:"work",heroAnimationPlayed:i,children:h.jsx(h.Fragment,{children:h.jsxs("div",{children:[h.jsxs("span",{children:["Designing useful products to spark moments of"," "]}),h.jsx("span",{children:"delight"}),h.jsx("span",{children:" & "}),h.jsx("span",{className:"gradient-text-animated",children:"human connection. "}),h.jsxs("span",{children:[h.jsx("br",{"aria-hidden":"true"}),"Previously at "]}),h.jsx("span",{className:"text-[#374151]",style:{fontVariationSettings:"'wdth' 100"}}),h.jsx("span",{className:"font-['Figtree',sans-serif] text-[#374151]",children:""}),h.jsx("span",{children:", "}),h.jsx("span",{className:"text-[#374151]",children:"Roblox"}),h.jsx("span",{children:", & "}),h.jsx("span",{className:"text-[#374151]",children:"NASA"}),h.jsx("span",{children:"."}),h.jsx(Mk,{hoverMode:!0,className:"max-md:hidden"})]})})}),h.jsx(eg,{activeTab:"work",heroAnimationPlayed:i}),h.jsx("div",{className:"hidden md:grid gap-6 grid-cols-2 px-16 pt-2.5 pb-2 relative shrink-0 w-full",children:r.map((w,b)=>h.jsx(Be,{delay:Math.min(Math.floor(b/2)*80,320),className:"w-full",rootMargin:"0px 0px -100px 0px",children:h.jsx(Bw,{project:w,onProjectClick:d,featured:b<4})},w.id))}),h.jsx("div",{className:"md:hidden flex flex-col gap-8 px-8 py-4 relative shrink-0 w-full",children:r.map((w,b)=>h.jsx(Be,{delay:Math.min(b*60,300),rootMargin:"0px 0px -50px 0px",children:h.jsx(Bw,{project:w,onProjectClick:d,featured:b<4})},w.id))}),h.jsx(hd,{}),l&&(Uw.includes(l.id)?h.jsx(xG,{project:l,onClose:f}):h.jsx(KO,{projectId:l.id,onClose:f,onBack:u?g:f,onExpandToFullscreen:m,onCollapseFromFullscreen:g,initialFullscreen:u,onProjectClick:w=>{x(w)},onViewAllProjects:y},l.id))]})}function wG(){return L.useEffect(()=>{fG()},[]),h.jsxs(rL,{children:[h.jsxs(br,{path:"/",element:h.jsx(vG,{}),children:[h.jsx(br,{index:!0,element:null}),h.jsx(br,{path:"project/:slug",element:null}),h.jsx(br,{path:"project/:slug/:mode",element:null})]}),h.jsx(br,{path:"/art",element:h.jsx(OU,{})}),h.jsx(br,{path:"/about",element:h.jsx(e$,{})}),h.jsx(br,{path:"/polaroid",element:h.jsx(IV,{})}),h.jsx(br,{path:"/library",element:h.jsx(BV,{})}),h.jsx(br,{path:"/screentime",element:h.jsx(dG,{})})]})}console.log(" thanks for stopping by! say hi: michelletheresaliu@gmail.com");iI.createRoot(document.getElementById("root")).render(h.jsx(CL,{children:h.jsx(wG,{})}));export{XA as g,YE as i};
